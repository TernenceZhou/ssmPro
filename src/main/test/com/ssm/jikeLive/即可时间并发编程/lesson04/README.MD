04 | 互斥锁（下）：如何用一把锁保护多个资源？
细粒度锁可以优化性能但是好处的同时带来了死锁的问题
https://time.geekbang.org/column/article/84601



总结：

    “原子性”的本质是什么？其实不是不可分割，不可分割只是外在表现，其本质是多个资源间有一致性的要求，操作的中间状态对外不可见。
    例如，在 32 位的机器上写 long 型变量有中间状态（只写了 64 位中的 32 位），在银行转账的操作中也有中间状态（账户 A 减少了 100，账户 B 还没来得及发生变化）。所以解决原子性问题，是要保证中间状态对外不可见。