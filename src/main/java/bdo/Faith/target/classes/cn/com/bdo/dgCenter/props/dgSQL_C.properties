#\u590D\u5236\u524D\u7F6E\u9879\u76EE\u79D1\u76EE\u6811\u8282\u70B9
#DG_I00001=INSERT INTO bdo_dg.dg_subjecttree ( customerId, projectId, parentId, subjectId, workpaperId, indexId, fileIndexId, nodeName, nodeType, userSubjectId, userSubjectName, tbSubjectCode, tbSubjectId, tbSubjectName, sE, sC, sA, sV, sP, csE, csC, csA, csV, csP, plansE, plansC, plansA, plansV, plansP, plancsE, plancsC, plancsA, plancsV, plancsP, PROGRAM_APPLICATION_ID, PROGRAM_ID, ACTIVE_FLAG, CREATED_BY, LAST_UPDATED_BY, CREATION_DATE, LAST_UPDATE_DATE ) SELECT {targetCustomerId} AS customerId, {targetProjectId} AS projectId, {parentId} as parentId, a.subjectId, a.workpaperId, a.indexId, a.fileIndexId, a.nodeName, a.nodeType, a.userSubjectId, a.userSubjectName, a.tbSubjectCode, a.tbSubjectId, a.tbSubjectName, a.sE, a.sC, a.sA, a.sV, a.sP, a.csE, a.csC, a.csA, a.csV, a.csP, a.plansE, a.plansC, a.plansA, a.plansV, a.plansP, a.plancsE, a.plancsC, a.plancsA, a.plancsV, a.plancsP, a.PROGRAM_APPLICATION_ID, a.PROGRAM_ID, a.ACTIVE_FLAG, {userId} AS CREATED_BY, {userId} AS LAST_UPDATED_BY, NOW() AS CREATION_DATE, NOW() AS LAST_UPDATE_DATE FROM bdo_dg.dg_subjecttree a WHERE a.customerId = {srcCustomerId} AND a.projectId = {srcProjectId} AND a.nodeType = 'SUBJECT' and ( a.tbSubjectName = '{tbSubjectName}' and ( a.tbSubjectCode = '{tbSubjectCode}' or a.tbSubjectId = '{tbSubjectId}' ) )
#\u590D\u5236\u524D\u7F6E\u9879\u76EE\u5BA1\u8BA1\u7A0B\u5E8F
#DG_I00002=INSERT INTO bdo_dg.dg_auditprogram ( departmentId, customerId, projectId, parentId, typeId, LEVEL, indexId, subjecttreeId, auditprogramId, subjectId, subjectName, programNamePre, programNameAft, auditDesc, auditConclusion, confirmStatusPre, confirmStatusPreName, confirmStatusAft, confirmStatusAftName, csE, csC, csA, csV, csP, sE, sC, sA, sV, sP, csEOriginal, csCOriginal, csAOriginal, csVOriginal, csPOriginal, sEOriginal, sCOriginal, sAOriginal, sVOriginal, sPOriginal, updateFlag, customizeFlag, reason, remark, dgName, STATUS, dgparam, PROGRAM_APPLICATION_ID, PROGRAM_ID, ACTIVE_FLAG, CREATED_BY, LAST_UPDATED_BY, CREATION_DATE, LAST_UPDATE_DATE ) SELECT a.departmentId, {targetCustomerId} AS customerId, {targetProjectId} AS projectId, null as parentId, a.typeId, a.LEVEL, a.indexId, b.autoId as subjecttreeId, a.auditprogramId, a.subjectId, a.subjectName, a.programNamePre, a.programNameAft, a.auditDesc, a.auditConclusion, a.confirmStatusPre, a.confirmStatusPreName, a.confirmStatusAft, a.confirmStatusAftName, a.csE, a.csC, a.csA, a.csV, a.csP, a.sE, a.sC, a.sA, a.sV, a.sP, a.csEOriginal, a.csCOriginal, a.csAOriginal, a.csVOriginal, a.csPOriginal, a.sEOriginal, a.sCOriginal, a.sAOriginal, a.sVOriginal, a.sPOriginal, a.updateFlag, a.customizeFlag, a.reason, a.remark, a.dgName, a.STATUS, a.dgparam, a.PROGRAM_APPLICATION_ID, a.PROGRAM_ID, a.ACTIVE_FLAG, {userId} AS CREATED_BY, {userId} AS LAST_UPDATED_BY, NOW() AS CREATION_DATE, NOW() AS LAST_UPDATE_DATE FROM bdo_dg.dg_auditprogram a left join bdo_dg.dg_subjecttree b on b.customerId = {targetCustomerId} and b.projectId = {targetProjectId} and a.subjectId = b.subjectId and b.nodeType = 'SUBJECT' AND ( b.tbSubjectName = '{tbSubjectName}' AND ( b.tbSubjectCode = '{tbSubjectCode}' OR b.tbSubjectId = '{tbSubjectId}' ) ) WHERE a.customerId = {srcCustomerId} AND a.projectId = {srcProjectId} and a.LEVEL = 0 and a.customizeFlag != '1'
