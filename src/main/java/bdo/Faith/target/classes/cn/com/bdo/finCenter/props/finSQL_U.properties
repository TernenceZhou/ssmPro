#\u66F4\u65B0fin_tasklist
AU000021=UPDATE bdo_fin.fin_tasklist SET customerId={customerId},year={yyyy},uploadUser={uploadUser},checkoutResult={checkoutResult},CREATION_DATE={CREATION_DATE},CREATED_BY={CREATED_BY},LAST_UPDATE_DATE={LAST_UPDATE_DATE},LAST_UPDATED_BY={LAST_UPDATED_BY} WHERE customerId={customerId} AND year={yyyy}
#\u66F4\u65B0\u5BA2\u6237\u72B6\u6001
AU000027=UPDATE bdo_fin.fin_customer SET status = ? WHERE customerId = ?
#\u66F4\u65B0\u4E0A\u7EA7\u79D1\u76EE\u671F\u521D\u671F\u672B
AU100001=UPDATE bdo_fin.fin_accountall t1 INNER JOIN (SELECT customerId,subYearMonth,subMonth,dataName,SUM(debitRemain) AS debitRemain,SUM(creditRemain) AS creditRemain,SUM(remain) AS remain,SUM(debitBalance) AS debitBalance,SUM(creditBalance) AS creditBalance,SUM(balance) AS balance,SUM(debitRemainF) AS debitRemainF,SUM(creditRemainF) AS creditRemainF,SUM(remainF) AS remainF,SUM(debitBalanceF) AS debitBalanceF,SUM(creditBalanceF) AS creditBalanceF,SUM(balanceF) AS balanceF FROM bdo_fin.fin_accountall WHERE isLeaf1 = 1 AND customerId = {customerId} AND subYearMonth = {yyyy} AND subjectId IN (SELECT a1.subjectId FROM bdo_fin.fin_accpkgsubject a1 WHERE a1.customerId = {customerId} AND a1.yyyy = {yyyy} AND a1.isLeaf = 1 AND a1.subjectFullId LIKE '{subjectId}/%') GROUP BY customerId,subYearMonth,subMonth,dataName) t2 ON t1.customerId = t2.customerId AND t1.subYearMonth = t2.subYearMonth AND t1.subMonth = t2.subMonth AND t1.dataName = t2.dataName SET t1.debitRemain = t2.debitRemain,t1.creditRemain = t2.creditRemain,t1.remain = t2.remain,t1.debitBalance = t2.debitBalance,t1.creditBalance = t2.creditBalance,t1.balance = t2.balance,t1.debitRemainF = t2.debitRemainF,t1.creditRemainF = t2.creditRemainF,t1.remainF = t2.remainF,t1.debitBalanceF = t2.debitBalanceF,t1.creditBalanceF = t2.creditBalanceF,t1.balanceF = t2.balanceF WHERE t1.customerId = {customerId} AND t1.subYearMonth = {yyyy} AND t1.subjectId = {subjectId}
AU100002=UPDATE bdo_fin.fin_account t1 INNER JOIN (SELECT customerId,subYearMonth,subMonth,SUM(debitRemain) AS debitRemain,SUM(creditRemain) AS creditRemain,SUM(remain) AS remain,SUM(debitBalance) AS debitBalance,SUM(creditBalance) AS creditBalance,SUM(balance) AS balance FROM bdo_fin.fin_account WHERE isLeaf1 = 1 AND customerId = {customerId} AND subYearMonth = {yyyy} AND subjectId IN (SELECT a1.subjectId FROM bdo_fin.fin_accpkgsubject a1 WHERE a1.customerId = {customerId} AND a1.yyyy = {yyyy} AND a1.isLeaf = 1 AND a1.subjectFullId LIKE '{subjectId}/%') GROUP BY customerId,subYearMonth,subMonth) t2 ON t1.customerId = t2.customerId AND t1.subYearMonth = t2.subYearMonth AND t1.subMonth = t2.subMonth SET t1.debitRemain = t2.debitRemain,t1.creditRemain = t2.creditRemain,t1.remain = t2.remain,t1.debitBalance = t2.debitBalance,t1.creditBalance = t2.creditBalance,t1.balance = t2.balance WHERE t1.customerId = {customerId} AND t1.subYearMonth = {yyyy} AND t1.subjectId = {subjectId}
AU100003=UPDATE bdo_fin.fin_assitementryaccall t1 INNER JOIN (SELECT customerId,subYearMonth,subMonth,accId,dataName,SUM(debitRemain) AS debitRemain,SUM(creditRemain) AS creditRemain,SUM(remain) AS remain,SUM(debitBalance) AS debitBalance,SUM(creditBalance) AS creditBalance,SUM(balance) AS balance,SUM(debitRemainF) AS debitRemainF,SUM(creditRemainF) AS creditRemainF,SUM(remainF) AS remainF,SUM(debitBalanceF) AS debitBalanceF,SUM(creditBalanceF) AS creditBalanceF,SUM(balanceF) AS balanceF FROM bdo_fin.fin_assitementryaccall WHERE isLeaf1 = 1 AND customerId = {customerId} AND subYearMonth = {yyyy} AND accId = {subjectId} AND assItemId IN (SELECT a2.assItemId FROM bdo_fin.fin_assitem a1,bdo_fin.fin_assitem a2 WHERE a1.customerId = {customerId} AND a1.yyyy = {yyyy} AND a1.accId = {subjectId} AND a1.assItemId = {assItemId} AND a1.customerId = a2.customerId AND a1.yyyy = a2.yyyy AND a1.accId = a2.accId AND a2.assItemFullId LIKE CONCAT(a1.assItemFullId,'|%')) GROUP BY customerId,subYearMonth,subMonth,accId,dataName) t2 ON t1.customerId = t2.customerId AND t1.subYearMonth = t2.subYearMonth AND t1.subMonth = t2.subMonth AND t1.accId = t2.accId AND t1.dataName = t2.dataName SET t1.debitRemain = t2.debitRemain,t1.creditRemain = t2.creditRemain,t1.remain = t2.remain,t1.debitBalance = t2.debitBalance,t1.creditBalance = t2.creditBalance,t1.balance = t2.balance,t1.debitRemainF = t2.debitRemainF,t1.creditRemainF = t2.creditRemainF,t1.remainF = t2.remainF,t1.debitBalanceF = t2.debitBalanceF,t1.creditBalanceF = t2.creditBalanceF,t1.balanceF = t2.balanceF WHERE t1.customerId = {customerId} AND t1.subYearMonth = {yyyy} AND t1.accId = {subjectId} AND t1.assItemId = {assItemId}
AU100004=UPDATE bdo_fin.fin_assitementryacc t1 INNER JOIN (SELECT customerId,subYearMonth,subMonth,accId,dataName,SUM(debitRemain) AS debitRemain,SUM(creditRemain) AS creditRemain,SUM(remain) AS remain,SUM(debitBalance) AS debitBalance,SUM(creditBalance) AS creditBalance,SUM(balance) AS balance FROM bdo_fin.fin_assitementryacc WHERE isLeaf1 = 1 AND customerId = {customerId} AND subYearMonth = {yyyy} AND accId = {subjectId} AND assItemId IN (SELECT a2.assItemId FROM bdo_fin.fin_assitem a1,bdo_fin.fin_assitem a2 WHERE a1.customerId = {customerId} AND a1.yyyy = {yyyy} AND a1.accId = {subjectId} AND a1.assItemId = {assItemId} AND a1.customerId = a2.customerId AND a1.yyyy = a2.yyyy AND a1.accId = a2.accId AND a2.assItemFullId LIKE CONCAT(a1.assItemFullId,'|%')) GROUP BY customerId,subYearMonth,subMonth,accId,dataName) t2 ON t1.customerId = t2.customerId AND t1.subYearMonth = t2.subYearMonth AND t1.subMonth = t2.subMonth AND t1.accId = t2.accId AND t1.dataName = t2.dataName SET t1.debitRemain = t2.debitRemain,t1.creditRemain = t2.creditRemain,t1.remain = t2.remain,t1.debitBalance = t2.debitBalance,t1.creditBalance = t2.creditBalance,t1.balance = t2.balance WHERE t1.customerId = {customerId} AND t1.subYearMonth = {yyyy} AND t1.accId = {subjectId} AND t1.assItemId = {assItemId}

FINU00026=UPDATE {lockDbName}.fin_accpkgsubject a SET a.subjectFullId = a.subjectId,a.subjectFullName = a.subjectName WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND a.level1 = {subjectLevel} AND a.subjectId IN ({subjectId})
FINU00027=UPDATE {lockDbName}.fin_accpkgsubject a LEFT JOIN {lockDbName}.fin_accpkgsubject b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.parentSubjectId SET a.subjectFullId = CONCAT(b.subjectFullId,'/',a.subjectId),a.subjectFullName = CONCAT(b.subjectFullName,'/',a.subjectName) WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND a.level1 = {subjectLevel} AND a.subjectId IN ({subjectId})
FINU00028=UPDATE {lockDbName}.fin_accpkgsubject a LEFT JOIN (SELECT a.subjectId,SUM(IF(b.subjectId IS NULL,0,1))=0 AS isLeaf1 FROM {lockDbName}.fin_accpkgsubject a LEFT JOIN {lockDbName}.fin_accpkgsubject b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.parentSubjectId = a.subjectId WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND a.subjectId IN ({subjectId}) GROUP BY a.subjectId) b ON b.subjectId = a.subjectId SET a.isLeaf1 = b.isLeaf1 WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND a.subjectId IN ({subjectId})
FINU00029=UPDATE {lockDbName}.fin_account a LEFT JOIN {lockDbName}.fin_accpkgsubject b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId SET a.subjectName = b.subjectName,a.subjectFullName = b.subjectFullName,a.isLeaf1 = b.isLeaf1,a.level1 = b.level1 WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND a.subjectId IN ({subjectId})
FINU00030=UPDATE {lockDbName}.fin_accountall a LEFT JOIN {lockDbName}.fin_accpkgsubject b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId SET a.subjectName = b.subjectName,a.subjectFullName = b.subjectFullName,a.isLeaf1 = b.isLeaf1,a.level1 = b.level1 WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND a.subjectId IN ({subjectId})
FINU00031=UPDATE {lockDbName}.fin_assitem a LEFT JOIN {lockDbName}.fin_accpkgsubject b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId SET a.subjectName = b.subjectName,a.subjectFullName = b.subjectFullName,a.subjectFullId = b.subjectFullId WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND a.subjectId IN ({subjectId})
FINU00032=UPDATE {lockDbName}.fin_assitementryacc a LEFT JOIN {lockDbName}.fin_accpkgsubject b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId SET a.subjectName = b.subjectName,a.subjectFullName = b.subjectFullName WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND a.subjectId IN ({subjectId})
FINU00033=UPDATE {lockDbName}.fin_assitementryaccall a LEFT JOIN {lockDbName}.fin_accpkgsubject b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId SET a.subjectName = b.subjectName,a.subjectFullName = b.subjectFullName WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND a.subjectId IN ({subjectId})
FINU00034=UPDATE {lockDbName}.fin_subjectentry a LEFT JOIN {lockDbName}.fin_accpkgsubject b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId SET a.subjectName = b.subjectName,a.subjectFullName = b.subjectFullName WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND a.subjectId IN ({subjectId})
FINU00035=UPDATE {lockDbName}.fin_assitementry a LEFT JOIN {lockDbName}.fin_accpkgsubject b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId SET a.subjectName = b.subjectName,a.subjectFullName = b.subjectFullName WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND a.subjectId IN ({subjectId})
FINU00036=UPDATE {lockDbName}.fin_account a INNER JOIN (SELECT b.parentSubjectId AS subjectId,a.subMonth,SUM(debitRemain) AS debitRemain,SUM(creditRemain) AS creditRemain,SUM(remain) AS remain,SUM(debitOcc) AS debitOcc,SUM(creditOcc) AS creditOcc,SUM(tranDebitOcc) AS tranDebitOcc,SUM(tranCreditOcc) AS tranCreditOcc,SUM(debitOccNoTran) AS debitOccNoTran,SUM(creditOccNoTran) AS creditOccNoTran,SUM(debitTotalOcc) AS debitTotalOcc,SUM(creditTotalOcc) AS creditTotalOcc,SUM(debitBalance) AS debitBalance,SUM(creditBalance) AS creditBalance,SUM(balance) AS balance FROM {lockDbName}.fin_account a LEFT JOIN {lockDbName}.fin_accpkgsubject b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND b.level1 = {subjectLevel} AND a.subjectId IN ({subjectId}) GROUP BY b.parentSubjectId,a.subMonth) b ON b.subjectId = a.subjectId AND b.subMonth = a.subMonth SET a.debitRemain = b.debitRemain,a.creditRemain = b.creditRemain,a.remain = b.remain,a.debitOcc = b.debitOcc,a.creditOcc = b.creditOcc,a.tranDebitOcc = b.tranDebitOcc,a.tranCreditOcc = b.tranCreditOcc,a.debitOccNoTran = b.debitOccNoTran,a.creditOccNoTran = b.creditOccNoTran,a.debitTotalOcc = b.debitTotalOcc,a.creditTotalOcc = b.creditTotalOcc,a.debitBalance = b.debitBalance,a.creditBalance = b.creditBalance,a.balance = b.balance WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy}
FINU00037=UPDATE {lockDbName}.fin_accountall a INNER JOIN (SELECT b.parentSubjectId AS subjectId,a.subMonth,a.currency,SUM(debitRemain) AS debitRemain,SUM(creditRemain) AS creditRemain,SUM(remain) AS remain,SUM(debitOcc) AS debitOcc,SUM(creditOcc) AS creditOcc,SUM(tranDebitOcc) AS tranDebitOcc,SUM(tranCreditOcc) AS tranCreditOcc,SUM(debitOccNoTran) AS debitOccNoTran,SUM(creditOccNoTran) AS creditOccNoTran,SUM(debitTotalOcc) AS debitTotalOcc,SUM(creditTotalOcc) AS creditTotalOcc,SUM(debitBalance) AS debitBalance,SUM(creditBalance) AS creditBalance,SUM(balance) AS balance,SUM(debitRemainF) AS debitRemainF,SUM(creditRemainF) AS creditRemainF,SUM(remainF) AS remainF,SUM(debitOccF) AS debitOccF,SUM(creditOccF) AS creditOccF,SUM(tranDebitOccF) AS tranDebitOccF,SUM(tranCreditOccF) AS tranCreditOccF,SUM(debitOccNoTranF) AS debitOccNoTranF,SUM(creditOccNoTranF) AS creditOccNoTranF,SUM(debitTotalOccF) AS debitTotalOccF,SUM(creditTotalOccF) AS creditTotalOccF,SUM(debitBalanceF) AS debitBalanceF,SUM(creditBalanceF) AS creditBalanceF,SUM(balanceF) AS balanceF FROM {lockDbName}.fin_accountall a LEFT JOIN {lockDbName}.fin_accpkgsubject b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND b.level1 = {subjectLevel} AND a.subjectId IN ({subjectId}) GROUP BY b.parentSubjectId,a.subMonth,a.currency) b ON b.subjectId = a.subjectId AND b.subMonth = a.subMonth AND b.currency = a.currency SET a.debitRemain = b.debitRemain,a.creditRemain = b.creditRemain,a.remain = b.remain,a.debitOcc = b.debitOcc,a.creditOcc = b.creditOcc,a.tranDebitOcc = b.tranDebitOcc,a.tranCreditOcc = b.tranCreditOcc,a.debitOccNoTran = b.debitOccNoTran,a.creditOccNoTran = b.creditOccNoTran,a.debitTotalOcc = b.debitTotalOcc,a.creditTotalOcc = b.creditTotalOcc,a.debitBalance = b.debitBalance,a.creditBalance = b.creditBalance,a.balance = b.balance,a.debitRemainF = b.debitRemainF,a.creditRemainF = b.creditRemainF,a.remainF = b.remainF,a.debitOccF = b.debitOccF,a.creditOccF = b.creditOccF,a.tranDebitOccF = b.tranDebitOccF,a.tranCreditOccF = b.tranCreditOccF,a.debitOccNoTranF = b.debitOccNoTranF,a.creditOccNoTranF = b.creditOccNoTranF,a.debitTotalOccF = b.debitTotalOccF,a.creditTotalOccF = b.creditTotalOccF,a.debitBalanceF = b.debitBalanceF,a.creditBalanceF = b.creditBalanceF,a.balanceF = b.balanceF WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy}
