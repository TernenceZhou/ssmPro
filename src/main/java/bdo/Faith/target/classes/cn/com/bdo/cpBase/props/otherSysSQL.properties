#HR\u90E8\u95E8\u6811
other.S100001=SELECT DISTINCT 'department_' + a.DEPT_CODE AS id, a.CONTENT AS label, a.pdept_code AS parentId, CASE when b.DEPT_CODE is null then 'true' else 'false' end AS leaf, a.DEPT_CODE AS VALUE, 'department' AS typeName FROM V_deptcode a LEFT JOIN V_deptcode b ON a.DEPT_CODE = b.pdept_code WHERE 1 = 1 /*START #param1# and a.pdept_code = '{param1}' #param1# END*/ /*START #param18# AND (a.DEPT_CODE = '{param18}' OR a.CONTENT = '{param18}') #param18# END*/ /*START #param19# AND a.CONTENT like '%{param19}%' #param19# END*/ ORDER BY a.DEPT_CODE
other.S100002=SELECT DISTINCT 'department_' + a.DEPT_CODE AS id, a.CONTENT AS label, a.pdept_code AS parentId, CASE when b.DEPT_CODE is null then 'true' else 'false' end AS leaf, a.DEPT_CODE AS VALUE, 'department' AS typeName FROM V_deptcode a LEFT JOIN V_deptcode b ON a.DEPT_CODE = b.pdept_code WHERE a.pdept_code = 'ROOT' /*START #param1# and a.pdept_code = '{param1}' #param1# END*/ /*START #param18# AND (a.DEPT_CODE = '{param18}' OR a.CONTENT = '{param18}') #param18# END*/ /*START #param19# AND a.CONTENT like '%{param19}%' #param19# END*/ ORDER BY a.DEPT_CODE
other.S100003=SELECT a.DEPT_ID, a.DEPT_CODE, a.CONTENT FROM V_deptcode a WHERE a.DEPT_CODE = ?
other.S100004=WITH temp (dept_id, parent, dept_code, DEPTCODE027, CONTENT, DEPTCODE018, DEPTCODE019, DEPTCODE022, DEPTCODE023, DEPTCODE024, DEPTCODE025, grade, dept_id_path, dept_code_path, dept_name_path) AS (SELECT dept.dept_id, dept.parent, dept.dept_code, dept.DEPTCODE027, dept.CONTENT, dept.DEPTCODE018, dept.DEPTCODE019, dept.DEPTCODE022, dept.DEPTCODE023, dept.DEPTCODE024, dept.DEPTCODE025, dept.grade, dept_id_path =Cast(Concat(dept.dept_id, '') AS NVARCHAR(max)), dept_code_path=Cast(dept.dept_code AS NVARCHAR(max)), dept_name_path=Cast(dept.CONTENT AS NVARCHAR(max)) FROM DEPTCODE dept WHERE dept.dept_id = 1 UNION ALL SELECT dept.dept_id, dept.parent, dept.dept_code, dept.DEPTCODE027, dept.CONTENT, dept.DEPTCODE018, dept.DEPTCODE019, dept.DEPTCODE022, dept.DEPTCODE023, dept.DEPTCODE024, dept.DEPTCODE025, dept.grade, Cast(Concat(temp.dept_id_path, ',', dept.dept_id) AS NVARCHAR(max)) AS dept_id_path, Cast(temp.dept_code_path + ',' + dept.dept_code AS NVARCHAR(max)) AS dept_code_path, Cast(temp.dept_name_path + '/' + dept.CONTENT AS NVARCHAR(max)) AS dept_name_path FROM temp INNER JOIN DEPTCODE dept ON dept.parent = temp.dept_code) SELECT dept_id as deptId,dept_code as deptCode,content as deptName,grade as deptLevel,dept_id_path as deptIdPath,dept_code_path deptCodePath,dept_name_path as deptNamePath,DEPTCODE019 as deptOrganization FROM temp WHERE dept_id in({hrDeptIds}) 
other.S100005=SELECT deptmanagerid as hrDeptManagerId FROM v_deptmanage where auditdeptId = {hrDeparmentId}
#e\u7533\u901Adb\u6570\u636E
#\u83B7\u53D6\u5F85\u5BFC\u5165\u7684\u8D26\u5957
other.E100000=SELECT accPackageId,accPackageType,customerId,accPackageYear,userId,subjectCodeRule,currName,property FROM c_accpackage WHERE isImported = 0 
#\u83B7\u53D6\u6307\u5B9A\u8D26\u5957
other.E100001=SELECT accPackageId,accPackageType,customerId,accPackageYear,userId,subjectCodeRule,currName,property FROM c_accpackage WHERE isImported = 0 and accPackageId in ({accPackageId})
#c_account\u8868
#other.E100002=SELECT accPackageId, {customerId} AS customerId, subjectId, accName , subYearMonth, subMonth, assSign, dataName, debitRemain, creditRemain, debitOcc, creditOcc,(debitRemain+creditRemain) * direction AS remain,balance, debitTotalOcc, creditTotalOcc, accSign, direction, debitBalance, creditBalance, isLeaf1, level1, subjectFullName1, subjectfullname2, direction2, tokenid, standname FROM asdb_{customerId}.c_account WHERE accPackageId = {accPackageId} ORDER BY subjectId,subYearMonth,subMonth
other.E100002=SELECT accPackageId, {customerId} AS customerId, a.subjectId, accName, subYearMonth, subMonth, assSign, dataName, debitRemain, creditRemain, debitOcc, creditOcc, IFNULL(b.tranDebitOccur, 0.00) AS tranDebitOcc, IFNULL(b.tranCreditOccur, 0.00) AS tranCreditOcc, (debitRemain + creditRemain) * direction AS remain, balance, debitTotalOcc, creditTotalOcc, accSign, direction, debitBalance, creditBalance, isLeaf1, level1, subjectFullName1, subjectfullname2, direction2, tokenid, standname FROM asdb_{customerId}.c_account a LEFT JOIN (SELECT subjectId, MONTH(VchDate) AS month, IF(Dirction = 1, SUM(OccurValue * (- 1)), 0) AS tranDebitOccur, IF(Dirction = - 1, SUM(OccurValue * (- 1)), 0) AS tranCreditOccur FROM asdb_{customerId}.c_subjectentry WHERE accPackageId ={accPackageId} AND LOCATE('2',Property) > 0 GROUP BY SubjectID,MONTH(VchDate)) b ON a.subjectId = b.subjectId AND a.subMonth = b.month WHERE accPackageId = {accPackageId}
#c_accountall\u8868
other.E100003=SELECT accPackageId, {customerId} AS customerId, a.subjectId, accName, subYearMonth, subMonth, assSign, dataName, debitRemain, creditRemain, debitOcc, creditOcc, b.tranDebitOccur AS tranDebitOcc, b.tranCreditOccur AS tranCreditOcc, (debitRemain + creditRemain) * direction AS remain, balance, debitTotalOcc, creditTotalOcc, accSign, direction, debitBalance, creditBalance, isLeaf1, level1, subjectFullName1, subjectfullName2, direction2, tokenid, standName, debitRemainF, creditRemainF, debitOccF, creditOccF, b.tranDebitOccurF AS tranDebitOccF, b.tranCreditOccurF AS tranCreditOccF, (debitRemainF + creditRemainF) * direction AS remainF, balanceF, debitTotalOccF, creditTotalOccF, debitBalanceF, creditBalanceF FROM asdb_{customerId}.c_accountall a LEFT JOIN (SELECT subjectId, MONTH(VchDate) AS MONTH, IF(Dirction = 1, SUM(OccurValue * (- 1)), 0) AS tranDebitOccur, IF(Dirction = - 1, SUM(OccurValue * (- 1)), 0) AS tranCreditOccur, IF(Dirction = 1, SUM(currValue * (- 1)), 0) AS tranDebitOccurF, IF(Dirction = - 1, SUM(currValue * (- 1)), 0) AS tranCreditOccurF FROM asdb_{customerId}.c_subjectentry WHERE accPackageId = {accPackageId} AND LOCATE('2', Property) > 0 GROUP BY SubjectID, MONTH(VchDate)) b on a.subjectId = b.subjectId AND a.subMonth = b.month WHERE accPackageId = {accPackageId} ORDER BY a.subjectId, subYearMonth, subMonth
#c_assitem\u8868
other.E100004=SELECT accPackageId, {customerId} AS customerId, RIGHT(accPackageId, 4) + 0 AS yyyy, a.accId, a.assItemId, a.assItemName, assTotalName, parentAssItemId, IFNULL(b.debitRemain, 0.00) AS debitRemain, IFNULL(b.creditRemain, 0.00) AS creditRemain, IFNULL(b.debittotalocc, 0.00) AS debittotalocc, IFNULL(b.credittotalocc, 0.00) AS credittotalocc,IFNULL(c.tranDebitOccur, 0.00) AS tranDebitTotalOcc,IFNULL(c.tranCreditOccur, 0.00) AS tranCreditTotalOcc, IFNULL(b.debitbalance, 0.00) AS debitbalance, IFNULL(b.creditbalance, 0.00) AS creditbalance, b.remain, IFNULL(b.balance, 0.00) AS balance, isLeaf, level0, uomUnit, curr, b.direction, property FROM asdb_{customerId}.c_assitem a LEFT JOIN (SELECT a.accId, a.assItemId, a.assItemName, ( IFNULL(b.debitRemain, 0.00) + IFNULL(b.creditRemain, 0.00) ) * b.direction AS remain, IFNULL(a.debitremain, 0.00) AS debitremain, IFNULL(a.creditremain, 0.00) AS creditremain, IFNULL(b.debittotalocc, 0.00) AS debittotalocc, IFNULL(b.credittotalocc, 0.00) AS credittotalocc, IFNULL(b.debitbalance, 0.00) AS debitbalance, IFNULL(b.creditbalance, 0.00) AS creditbalance, b.direction, b.Balance AS Balance FROM asdb_{customerId}.c_assitementryacc a INNER JOIN asdb_{customerId}.c_assitementryacc b ON a.accpackageid = b.accpackageid AND a.accId = b.accId AND a.assItemId = b.assItemId AND a.submonth = 1 AND b.submonth = 12 AND a.accPackageId = {accPackageId} AND b.accPackageId = {accPackageId}) b ON a.accId = b.accId AND a.assItemId = b.assItemId LEFT JOIN (SELECT subjectId,assItemId, IF(Dirction = 1, SUM(assItemSum * (- 1)), 0) AS tranDebitOccur, IF(Dirction = - 1, SUM(assItemSum * (- 1)), 0) AS tranCreditOccur FROM asdb_{customerId}.c_assitementry WHERE accPackageId = {accPackageId} AND LOCATE('2', Property) > 0 GROUP BY subjectId,assItemId ) c ON a.accId = c.subjectId AND a.assItemId=c.assItemId WHERE accPackageId = {accPackageId}
#c_assitementryacc
other.E100005=SELECT accPackageId, {customerId} AS customerId, accId, a.assItemId, assItemName, subYearMonth, subMonth, debitRemain, creditRemain, debitOcc, creditOcc, ifnull(b.tranDebitOccur,0.00) AS tranDebitOcc , ifnull(b.tranCreditOccur,0.00) AS tranCreditOcc, (debitRemain + creditRemain) * direction AS remain, balance, debitTotalOcc, creditTotalOcc, direction, debitBalance, creditBalance, isLeaf1, level1, assTotalName1, dataName, accSign, direction2 FROM asdb_{customerId}.c_assitementryacc a LEFT JOIN (SELECT subjectId, assItemId, MONTH(VchDate) AS MONTH, IF(Dirction = 1, SUM(assItemSum * (- 1)), 0) AS tranDebitOccur, IF(Dirction = - 1, SUM(assItemSum * (- 1)), 0) AS tranCreditOccur FROM asdb_{customerId}.c_assitementry WHERE accPackageId = {accPackageId} AND LOCATE('2', Property) > 0 GROUP BY SubjectID,assItemId, MONTH(vchDate)) b ON a.accId = b.subjectId AND a.assItemId = b.assItemId AND a.subMonth = b.month WHERE accPackageID = {accPackageID}
#c_assitementryaccall\u8868
other.E100006=SELECT accPackageId, {customerId} AS customerId, accId, a.assItemId, assItemName, subYearMonth, subMonth, debitRemain, creditRemain, debitOcc, creditOcc, ifnull(b.tranDebitOccur,0.00) AS tranDebitOcc , ifnull(b.tranCreditOccur,0.00) AS tranCreditOcc, (debitRemain + creditRemain) * direction AS remain, balance, debitTotalOcc, creditTotalOcc, direction, debitBalance, creditBalance, isLeaf1, level1, assTotalName1, dataName, accSign, direction2, debitRemainF, creditRemainF, debitOccF, creditOccF,ifnull(b.tranDebitOccurF,0.00) AS tranDebitOccF , ifnull(b.tranCreditOccurF,0.00) AS tranCreditOccF, (debitRemainF + creditRemainF) * direction AS remainF, balanceF, debitTotalOccF, creditTotalOccF, debitBalanceF, creditBalanceF FROM asdb_{customerId}.c_assitementryaccall a LEFT JOIN (SELECT subjectId, assItemId, MONTH(VchDate) AS MONTH, IF(Dirction = 1, SUM(assItemSum * (- 1)), 0) AS tranDebitOccur, IF(Dirction = - 1, SUM(assItemSum * (- 1)), 0) AS tranCreditOccur, IF(Dirction = 1, SUM(currValue * (- 1)), 0) AS tranDebitOccurF, IF(Dirction = - 1, SUM(currValue * (- 1)), 0) AS tranCreditOccurF FROM asdb_{customerId}.c_assitementry WHERE accPackageId = {accPackageId} AND LOCATE('2', Property) > 0 GROUP BY SubjectID,assItemId, MONTH(vchDate)) b ON a.accId = b.subjectId AND a.assItemId = b.assItemId AND a.subMonth = b.MONTH WHERE a.accPackageId = {accPackageId}
#c_subjectentry\u8868
other.E100007=SELECT accPackageId, {customerId} as customerId, RIGHT(accPackageId,4) + 0 as yyyy,MONTH(vchDate) as month, voucherId, oldVoucherId, typeId, vchDate, serail, summary, subjectId, dirction, occurValue, currRate, currValue, currency, quantity, unitPrice, unitName, bankId, property, subjectname1, subjectFullName1, debitsubjects, creditsubjects, voucherFillUser, voucherAuditUser, voucherKeepUser, voucherAffixCount, voucherDebitOcc, voucherCreditOcc, voucherDirector, tokenId, standName FROM asdb_{customerId}.c_subjectentry WHERE accPackageId = {accPackageId}
#c_subjectassitem\u8868
other.E100008=SELECT accPackageId, {customerId} as customerId, RIGHT(accPackageId,4) + 0 as yyyy, subjectId, subjectFullName1, subjectFullName2, assitemId, assTotalName1, ifEqual, property FROM asdb_{customerId}.c_subjectassitem WHERE accPackageId ={accPackageId}
#c_assitementry\u8868
other.E100009=SELECT accPackageId, {customerId} as customerId, RIGHT(accPackageId,4) + 0 as yyyy, subjectId, voucherId, oldvoucherId, vchDate, typeId, serail, assItemId, summary, dirction, assItemSum, currRate, currValue, currency, quantity, unitPrice, unitName, property FROM asdb_{customerId}.c_assitementry WHERE accPackageId = {accPackageId}
#c_accpkgsubject\u8868
#other.E100010=SELECT accPackageId, {customerId} AS customerId, RIGHT(accPackageId, 4) + 0 AS yyyy, subjectCode, a.subjectId, parentSubjectCode, parentSubjectId, subjectName, subjectFullName, assistCode, uomUnit, currency, isLeaf, level0,IFNULL(b.debitRemain,0.00) AS debitRemain, IFNULL(b.creditRemain,0.00) AS creditRemain, IFNULL(b.debittotalocc,0.00) AS debittotalocc, IFNULL(b.credittotalocc,0.00) AS credittotalocc, IFNULL(b.debitbalance,0.00) AS debitbalance, IFNULL(b.creditbalance,0.00) AS creditbalance, b.remain, IFNULL(b.balance,0.00) AS balance, essentiality1, essentiality2, essentiality3,b.direction, property FROM asdb_{customerId}.c_accpkgsubject a LEFT JOIN (SELECT a.subjectid, a.accname, (IFNULL(b.debitRemain,0.00)+IFNULL(b.creditRemain,0.00)) * b.direction AS remain, IFNULL(a.debitremain, 0.00) AS debitremain, IFNULL(a.creditremain, 0.00) AS creditremain, IFNULL(b.debittotalocc, 0.00) AS debittotalocc, IFNULL(b.credittotalocc, 0.00) AS credittotalocc, IFNULL(b.debitbalance, 0.00) AS debitbalance, IFNULL(b.creditbalance, 0.00) AS creditbalance, b.direction, b.Balance AS balance FROM asdb_{customerId}.c_account a INNER JOIN asdb_{customerId}.c_account b ON a.accpackageid = b.accpackageid AND a.subjectid = b.subjectid AND a.submonth = 1 AND b.submonth = 12 AND a.accPackageId = {accPackageId} AND b.accPackageId = {accPackageId}) b ON a.subjectid = b.subjectid WHERE accPackageId = {accPackageId}
other.E100010=SELECT accPackageId, {customerId} AS customerId, RIGHT(accPackageId, 4) + 0 AS yyyy, subjectCode, a.subjectId, parentSubjectCode, parentSubjectId, subjectName, subjectFullName, assistCode, uomUnit, currency, isLeaf, level0, IFNULL(b.debitRemain, 0.00) AS debitRemain, IFNULL(b.creditRemain, 0.00) AS creditRemain, IFNULL(b.debittotalocc, 0.00) AS debittotalocc, IFNULL(b.credittotalocc, 0.00) AS credittotalocc, IFNULL(c.tranDebitTotalOccur, 0.00) AS tranDebitTotalOcc, IFNULL(c.tranCreditTotalOccur, 0.00) AS tranCreditTotalOcc, IFNULL(b.debitbalance, 0.00) AS debitbalance, IFNULL(b.creditbalance, 0.00) AS creditbalance, b.remain, IFNULL(b.balance, 0.00) AS balance, essentiality1, essentiality2, essentiality3, b.direction, property FROM asdb_{customerId}.c_accpkgsubject a LEFT JOIN (SELECT a.subjectid, a.accname, ( IFNULL(a.debitRemain, 0.00) + IFNULL(a.creditRemain, 0.00) ) * b.direction AS remain, IFNULL(a.debitremain, 0.00) AS debitremain, IFNULL(a.creditremain, 0.00) AS creditremain, IFNULL(b.debittotalocc, 0.00) AS debittotalocc, IFNULL(b.credittotalocc, 0.00) AS credittotalocc, IFNULL(b.debitbalance, 0.00) AS debitbalance, IFNULL(b.creditbalance, 0.00) AS creditbalance, b.direction, b.Balance AS balance FROM asdb_{customerId}.c_account a INNER JOIN asdb_{customerId}.c_account b ON a.accpackageid = b.accpackageid AND a.subjectid = b.subjectid AND a.submonth = 1 AND b.submonth = 12 AND a.accPackageId = {accPackageId} AND b.accPackageId = {accPackageId}) b ON a.subjectid = b.subjectid LEFT JOIN (SELECT subjectId, IF(dirction = 1, SUM(occurValue * (- 1)), 0) AS tranDebitTotalOccur, IF(dirction = - 1, SUM(occurValue * (- 1)), 0) AS tranCreditTotalOccur FROM asdb_{customerId}.c_subjectentry WHERE accPackageId = {accPackageId} AND LOCATE('2',property) > 0 GROUP BY subjectId) c ON a.subjectId = c.subjectId WHERE accPackageId = {accPackageId}
#c_voucher
other.E100011=SELECT accPackageId, {customerId} AS customerId, RIGHT(accPackageId, 4) + 0 AS yyyy,MONTH(vchDate) as month, voucherId, typeId, vchDate, fillUser, auditUser, keepUser, director, affixCount, description, doubtUserId, property, debitocc, creditocc FROM asdb_{customerId}.c_voucher
#\u66F4\u65B0\u5BFC\u5165\u72B6\u6001\u8868
other.E100012=UPDATE c_accpackage SET isImported = {state} WHERE accPackageId = {accPackageId}
#E\u5BA1\u901A\u6570\u636E\u5BFC\u5165
other.E200001=SELECT group_concat(distinct jobrunflag) FROM asdb.k_tasklist WHERE isImported='1'
other.E200002=SELECT group_concat(distinct id) FROM asdb.k_tasklist WHERE isImported='0' AND state = '\u5BFC\u5165\u5B8C\u6210' and errorCount < 3
#other.E200003=SELECT group_concat(distinct libFlag) FROM bdo_fin.fin_importlist WHERE importState='3' AND ACTIVE_FLAG = '1'
other.E200005=SELECT id,uploadUser,uploadCustomer,path,beginTime,endTime,state,headway,fileName,checkoutResult,accPackageId,customerId,accPackageYear,isImported,jobrunflag,errorCount FROM asdb.k_tasklist where 1=1 /*START #param1# AND isImported = {param1} #param1# END*/ /*START #param2# AND uploadCustomer like CONCAT('%','{param2}','%') #param2# END*/
#\u83B7\u53D6E\u5BA1\u901AETL\u5F02\u5E38\u4EFB\u52A1
other.E200006=select '\u51FA\u95193\u6B21\uFF1A' type,t.id,t.uploadCustomer from asdb.k_tasklist t where errorCount >=3 and isSend='0' union select '\u89E3\u6790\u65F6\u95F4\u8FC7\u957F\uFF1A' type,t.id,t.uploadCustomer from asdb.k_tasklist t  where isImported = '1' and TIMESTAMPDIFF(MINUTE,beginTime,SYSDATE()) > 120 and isSend='0'
other.E200007=UPDATE asdb.k_tasklist SET jobrunflag = {jobrunflag} WHERE id = {id}
#\u66F4\u65B0E\u5BA1\u901A\u4EFB\u52A1\u8868 \u662F\u5426\u53D1\u9001\u901A\u77E5
other.E200008=UPDATE asdb.k_tasklist SET isSend = {isSend} WHERE id in ({id})
#\u67E5\u8BE2E\u5BA1\u901A\u4EFB\u52A1\u5BFC\u5165\u5B8C\u6210\u672A\u540C\u6B65\u8FC7\u7684\u8BB0\u5F55
other.E200009=SELECT GROUP_CONCAT(id) AS id,uploadUser FROM asdb.k_tasklist WHERE isImported = '2' AND synCustomer <> '2' GROUP BY uploadUser
#\u66F4\u65B0E\u5BA1\u901A\u4EFB\u52A1\u8868 \u662F\u5426\u540C\u6B65
other.E200010=UPDATE asdb.k_tasklist SET synCustomer = {synCustomer} WHERE id IN ({id})
other.E200011=SELECT id, customerId, CONCAT('asdb_',customerId) dbName FROM asdb.k_tasklist where endTime < DATE_SUB(SYSDATE(),INTERVAL '7' day) and clearStatus = '0' AND customerId NOT IN (SELECT DISTINCT customerId FROM asdb.k_tasklist WHERE endTime IS NULL AND beginTime >= DATE_SUB(SYSDATE(),INTERVAL '7' day) AND CustomerID IS NOT NULL)
other.E200012=DELETE FROM asdb.k_bdocustomer where departid  = {customerId}
other.E200013=DROP DATABASE if exists {dbName}
other.E200014=UPDATE asdb.k_tasklist SET clearStatus = '1' WHERE id = {id}
other.E200015=SELECT t1.id,t2.customerId as customerIdNew,t1.customerId,t1.accPackageYear,t1.uploadUser,t1.uploadCustomer FROM asdb.k_tasklist t1,asdb.k_bdocustomer t2 WHERE t1.isimported = '2' AND isAnalysis = '0' AND synCustomer = '2' AND t1.customerId = t2.departid /*START #analysisId# AND t2.customerId NOT IN ({analysisId}) #analysisId# END*/ order by t1.id
other.E200016=UPDATE asdb.k_tasklist SET isAnalysis = {isAnalysis} WHERE id IN ({id})
#\u9F0E\u4FE1\u8BFA\u5BFC\u5165
other.E300001=SELECT DISTINCT(id) FROM bdo_fin.b_task WHERE TaskState = 3 AND IFNULL(errorCount, 0) < 3 AND UserName <> 'admin' AND IFNULL(jobrunflag,'') = ''
other.E300002=SELECT GROUP_CONCAT(DISTINCT jobrunflag) FROM bdo_fin.b_task WHERE TaskState = 5
other.E300003=UPDATE bdo_fin.b_task SET jobrunflag = {jobrunflag} WHERE id = {id}
#\u83B7\u53D6\u9F0E\u4FE1\u8BFAETL\u5F02\u5E38\u4EFB\u52A1
other.E300004=SELECT '\u51FA\u95193\u6B21: ' AS type,t.id,t.CustomName AS uploadCustomer FROM bdo_fin.b_task t WHERE errorCount >= 3 AND IFNULL(isSend,0) = '0' UNION SELECT '\u89E3\u6790\u65F6\u95F4\u8FC7\u957F: ' AS type,t.id,t.CustomName AS uploadCustomer FROM bdo_fin.b_task t WHERE TaskState = '5' AND TIMESTAMPDIFF(MINUTE,etlStartTime,NOW()) > 120 AND IFNULL(isSend,0) = '0'
#\u66F4\u65B0\u9F0E\u4FE1\u8BFA\u4EFB\u52A1\u8868 \u662F\u5426\u53D1\u9001\u901A\u77E5
other.E300005=UPDATE bdo_fin.b_task SET isSend = {isSend} WHERE id IN ({id})
#\u67E5\u8BE2\u9F0E\u4FE1\u8BFA\u4EFB\u52A1\u5BFC\u5165\u5B8C\u6210\u672A\u540C\u6B65\u8FC7\u7684\u8BB0\u5F55
other.E300006=SELECT GROUP_CONCAT(id) AS id,UserName AS uploadUser FROM bdo_fin.b_task WHERE TaskState = 6 AND IFNULL(synCustomer,'0') <> '2' GROUP BY UserName
#\u66F4\u65B0\u9F0E\u4FE1\u8BFA\u4EFB\u52A1\u8868 \u662F\u5426\u540C\u6B65
other.E300007=UPDATE bdo_fin.b_task SET synCustomer = {synCustomer} WHERE id IN ({id})
#\u67E5\u8BE2\u9F0E\u4FE1\u8BFA\u4EFB\u52A1\u5BFC\u5165\u5B8C\u6210\u672A\u5206\u6790\u8FC7\u7684\u8BB0\u5F55
other.E300008=SELECT id,CustomId,AccountYear,UserName AS uploadUser,CustomName FROM bdo_fin.b_task WHERE TaskState = 6 AND isAnalysis = '0' /*START #analysisId# AND CustomId NOT IN ({analysisId}) #analysisId# END*/ order by id
#\u66F4\u65B0\u9F0E\u4FE1\u8BFA\u4EFB\u52A1\u5BFC\u5165\u5B8C\u6210\u5206\u6790\u72B6\u6001
other.E300009=UPDATE bdo_fin.b_task SET isAnalysis = {isAnalysis} WHERE id IN ({id})
#\u83B7\u53D6\u7528\u6237\u53EF\u8BBF\u95EE\u7684\u5BA2\u6237\u5217\u8868
#\u9879\u76EE\u7BA1\u7406\u7CFB\u7EDFS000140
#other.C00001=SELECT GROUP_CONCAT(DISTINCT a.id) FROM (SELECT a.restcustomerid AS id FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.customerid = b.CustomerId INNER JOIN asdb.z_projectmember c ON c.projectid = b.projectid INNER JOIN bdo_base.base_user d ON c.memberid = d.id WHERE d.hrloginid = '{param1}' AND a.restcustomerid > '' UNION SELECT a.restcustomerid AS id FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.customerid = b.CustomerId INNER JOIN asdb.z_projectpeople c ON c.projectid = b.projectid INNER JOIN bdo_base.base_user d ON c.managerid = d.id WHERE d.hrloginid = '{param1}' AND a.restcustomerid > '' UNION SELECT a.restcustomerid AS id FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.customerid = b.CustomerId INNER JOIN asdb.z_projectpeople c ON c.projectid = b.projectid INNER JOIN bdo_base.base_user d ON c.audit2 = d.id WHERE d.hrloginid = '{param1}' AND a.restcustomerid > '' UNION SELECT a.restcustomerid AS id FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.customerid = b.CustomerId INNER JOIN asdb.z_projectpeople c ON c.projectid = b.projectid INNER JOIN bdo_base.base_user d ON c.audit1 = d.id WHERE d.hrloginid = '{param1}' AND a.restcustomerid > '' UNION SELECT a.restcustomerid AS id FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.customerid = b.CustomerId INNER JOIN asdb.z_projectpeople c ON c.projectid = b.projectid INNER JOIN bdo_base.base_user d ON c.audit3 = d.id WHERE d.hrloginid = '{param1}' AND a.restcustomerid > '' UNION SELECT a.restcustomerid AS id FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.customerid = b.CustomerId INNER JOIN asdb.z_projectpeople c ON c.projectid = b.projectid INNER JOIN bdo_base.base_user d ON c.audit4 = d.id WHERE d.hrloginid = '{param1}' AND a.restcustomerid > '') a\
other.C00001=SELECT GROUP_CONCAT(DISTINCT a.restcustomerid) FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.customerid = b.CustomerId left JOIN asdb.z_projectmember c ON c.projectid = b.projectid LEFT JOIN asdb.z_projectpeople e ON e.projectid = b.projectid inner JOIN bdo_base.base_user f ON f.hrLoginId = '{param1}' AND f.id IN (e.audit1, e.audit2, e.audit3, e.audit4, e.managerid, e.gongshi1, e.gongshi2, c.memberId) WHERE a.restcustomerid > '' 
#\u5BA2\u6237\u7BA1\u7406\u7CFB\u7EDFother.F000002
other.C00002=SELECT a.customerId as value,CONCAT('[\u5BA1]',a.customerName) as label FROM bdo_cus.cus_customerinfo_basic a WHERE a.customerId in ({param1}) ORDER BY a.customerId ASC
#\u5BA2\u6237ID
other.C00003=SELECT group_concat(DISTINCT customerid) FROM bdo_fin.fin_account WHERE customerid IN ({param1}) 
#\u62A5\u8868\u5206\u6790\u9ED8\u8BA4\u663E\u793A\u884C\u4E1A
other.C00004=SELECT a.industryclassification,a.industryclassificationcode, a.industrycategory,a.industrycategorycode, (CASE WHEN (ISNULL(a.industrycategory)=1) || (LENGTH(trim(a.industrycategory))=0) THEN a.industryclassification ELSE a.industrycategory END)as aa, (CASE WHEN (ISNULL(a.industrycategorycode)=1) || (LENGTH(trim(a.industrycategorycode))=0) THEN CONCAT(upper(a.industryclassificationcode),'-GB') ELSE CONCAT(UPPER(a.industryclassificationcode),a.industrycategorycode,'-GB') END)as aacode FROM bdo_cus.cus_customerinfo_basic a WHERE 1 = 1 AND a.customerType != 2 and a.customerId = {param1}
#\u67E5\u8BE2bdo\u5BA2\u6237
other.C00005=SELECT a.customerName AS company_name, a.stock AS stock_code, a.incorporationDate AS inception_date, a.type AS sec_type, a.register AS regcapital, a.corporation AS chairman, a.registerAddress AS address, a.communicationaddress AS office, a.postcode AS zipcode, a.Phone AS telephone, a.email AS fax, IFNULL(webSite,'') AS website FROM bdo_cus.cus_customerinfo_basic a WHERE customerId = ?
#\u5BA2\u623720\u6761
other.C00006=SELECT customerId AS companyid,customerName AS company_name FROM bdo_cus.cus_customerinfo_basic WHERE customerName LIKE '%{companyName}%' ORDER BY customerId DESC LIMIT 20
#\u5BA2\u6237\u9879\u76EE\u4E0B\u62C9\u6846
other.P00001=SELECT projectId AS VALUE,concat(projectId,'-',projectName) AS label FROM asdb.z_project a INNER JOIN bdo_cus.cus_customerinfo b  ON a.customerid = b.CustomerId WHERE b.restcustomerid = {customerId} ORDER BY projectId DESC
#\u9879\u76EE\u67E5\u8BE2
other.P00002=SELECT auditTimeBegin AS auditStartDate, auditTimeEnd AS auditEndDate, projectId, CONCAT(projectId, '-', projectName) as projectName, projectYear, b.restcustomerId AS customerId FROM asdb.z_project a LEFT JOIN bdo_cus.cus_customerinfo b ON a.customerId=b.customerId WHERE projectId = {projectId} 
#DG\u9879\u76EE\u9879\u76EE\u9996\u9875\uFF0C\u67E5\u8BE2\u9879\u76EE\u4FE1\u606F
#other.P00003=SELECT a.projectId, a.finalResults, a.financeReportType, c.restCustomerId AS customerId, a.auditTimeBegin, a.auditTimeEnd, a.state AS projectState, b.signUser, b.managerId, b.audit1, b.audit2, cb.customerName, a.projectName, d.name AS signUserName, e.name AS managerName, f.name AS audit1Name, g.name AS audit2Name, k.name AS audit3Name, l.name AS audit4Name, h.name AS signUser2Name, i.name AS signUser3Name, d.hrloginId AS signUserLoginName, e.hrloginId AS managerLoginName, f.hrloginId AS audit1LoginName, g.hrloginId AS audit2LoginName, k.hrloginId AS audit3LoginName, l.hrloginId AS audit4LoginName, h.hrloginId as signUser2LoginName, i.hrloginId AS signUser3LoginName, j.hrloginId as qfUserLoginName FROM z_project a LEFT JOIN z_projectpeople b ON b.projectId = a.projectId LEFT JOIN bdo_cus.cus_customerinfo c ON c.customerId = a.customerId LEFT JOIN bdo_cus.cus_customerinfo_basic cb ON cb.customerId = c.restCustomerId LEFT JOIN bdo_base.base_user d ON d.id = b.signUser LEFT JOIN bdo_base.base_user e ON e.id = b.managerId LEFT JOIN bdo_base.base_user f ON f.id = b.audit1 LEFT JOIN bdo_base.base_user g ON g.id = b.audit2 LEFT JOIN bdo_base.base_user h ON h.id = b.signUser2 LEFT JOIN bdo_base.base_user i ON i.id = b.signUser3 LEFT JOIN bdo_base.base_user j ON j.id = b.qfUser LEFT JOIN bdo_base.base_user k ON k.id = b.audit3 LEFT JOIN bdo_base.base_user l ON l.id = b.audit4 WHERE a.projectId = {projectId} 
other.P00003=SELECT a.projectId, a.finalResults, a.financeReportType, c.restCustomerId AS customerId, a.auditTimeBegin, a.auditTimeEnd, a.state AS projectState, b.signUser, b.managerId, b.audit1, b.audit2, cb.customerName, a.projectName, max(if(d.id = b.signUser, d.name, '')) as signUserName, max(if(d.id = b.signUser2, d.name, '')) as signUser2Name, max(if(d.id = b.signUser3, d.name, '')) as signUser3Name, max(if(d.id = b.qfUser, d.name, '')) as qfUserName, max(if(d.id = b.managerId, d.name, '')) as managerName, max(if(d.id = b.audit1, d.name, '')) as audit1Name, max(if(d.id = b.audit2, d.name, '')) as audit2Name, max(if(d.id = b.audit3, d.name, '')) as audit3Name, max(if(d.id = b.audit4, d.name, '')) as audit4Name, max(if(d.id = b.gongshi1, d.name, '')) as gongshi1Name, max(if(d.id = b.gongshi2, d.name, '')) as gongshi2Name, max(if(d.id = b.signUser, d.hrloginId, '')) as signUserLoginName, max(if(d.id = b.signUser2, d.hrloginId, '')) as signUser2LoginName, max(if(d.id = b.signUser3, d.hrloginId, '')) as signUser3LoginName, max(if(d.id = b.qfUser, d.hrloginId, '')) as qfUserLoginName, max(if(d.id = b.managerId, d.hrloginId, '')) as managerLoginName, max(if(d.id = b.audit1, d.hrloginId, '')) as audit1LoginName, max(if(d.id = b.audit2, d.hrloginId, '')) as audit2LoginName, max(if(d.id = b.audit3, d.hrloginId, '')) as audit3LoginName, max(if(d.id = b.audit4, d.hrloginId, '')) as audit4LoginName, max(if(d.id = b.gongshi1, d.hrloginId, '')) as gongshi1LoginName, max(if(d.id = b.gongshi2, d.hrloginId, '')) as gongshi2LoginName,pext.s21 AS isNeedReport FROM z_project a LEFT JOIN z_projectpeople b ON b.projectId = a.projectId LEFT JOIN bdo_cus.cus_customerinfo c ON c.customerId = a.customerId LEFT JOIN bdo_cus.cus_customerinfo_basic cb ON cb.customerId = c.restCustomerId LEFT JOIN bdo_base.base_user d ON d.id in (b.signUser,b.signUser2,b.signUser3,b.qfUser,b.managerId,b.audit1,b.audit2,b.audit3,b.audit4,b.gongshi1,b.gongshi2) LEFT JOIN asdb.z_projectext pext ON pext.projectId = a.projectId WHERE a.projectId = {projectId} 
#other.P00003=SELECT a.projectId, a.customerId, b.signUser, b.managerId, b.audit1, c.customerName, a.projectName, d.name AS singUserName, e.name AS managerName, f.name AS audit1Name FROM z_project a LEFT JOIN z_projectpeople b ON b.projectId = a.projectId LEFT JOIN bdo_cus.cus_customerinfo c ON c.customerId = a.customerId LEFT JOIN bdo_base.base_user d ON d.id = b.signUser LEFT JOIN bdo_base.base_user e ON e.id = b.managerId LEFT JOIN bdo_base.base_user f ON f.id = b.audit1 WHERE a.projectId = {projectId}
#DG\u9879\u76EE\u9879\u76EE\u9996\u9875\uFF0C\u67E5\u8BE2\u9879\u76EE\u6210\u5458\u4FE1\u606F
other.P00004=SELECT a.projectId, b.id AS memberId, b.hrId AS memberHrId, b.name AS memberName, b.hrloginId AS memberLoginName FROM asdb.z_projectmember a LEFT JOIN bdo_base.base_user b ON b.id = a.memberId WHERE a.projectId = {projectId}
#\u67E5\u8BE2\u524D\u63A8\u9879\u76EE
other.P00005=SELECT a.projectId, a.projectName, a.customerId, a.auditPara, a.projectYear FROM asdb.z_project a INNER JOIN ( SELECT customerid, auditpara, projectyear FROM asdb.z_project WHERE projectid = {projectId} ) b ON a.customerid = b.customerid AND a.auditpara = b.auditpara AND a.projectyear = (b.projectyear - 1)
#\u83B7\u53D6\u7528\u6237\u5BA2\u6237\u9879\u76EE
#other.P00006=SELECT DISTINCT b.projectId, b.projectName, a.restcustomerid FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.customerid = b.CustomerId LEFT JOIN asdb.z_projectmember c ON c.projectid = b.projectid LEFT JOIN asdb.z_projectpeople e ON e.projectid = b.projectid INNER JOIN bdo_base.base_user f ON f.hrLoginId = '{param1}' AND f.id IN ( e.signUser, e.signUser1, e.signUser2, e.signUser3, e.audit1, e.audit2, e.audit3, e.audit4, e.audit5, e.qfUser, e.managerid, e.gongshi1, e.gongshi2, c.memberId ) WHERE a.restcustomerid > '' ORDER BY projectId DESC
#other.P00006=SELECT DISTINCT b.projectId, b.projectName, a.restcustomerid FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.customerid = b.CustomerId LEFT JOIN asdb.z_projectext pext ON pext.s61 = 1 AND pext.projectId = b.projectId LEFT JOIN asdb.z_projectmember c ON c.projectid = b.projectid LEFT JOIN asdb.z_projectpeople e ON e.projectid = b.projectid INNER JOIN bdo_base.base_user f ON f.hrLoginId = '{param1}' AND f.id IN ( e.signUser, e.signUser1, e.signUser2, e.signUser3, e.audit1, e.audit2, e.audit3, e.audit4, e.audit5, e.qfUser, e.managerid, e.gongshi1, e.gongshi2, c.memberId ) WHERE a.restcustomerid > '' AND pext.projectId IS NOT NULL ORDER BY projectId DESC
#other.P00006=SELECT DISTINCT b.projectId, b.projectName, a.restcustomerid, a.customerName, pext.s61, dp2.hrDeptCode AS office FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.customerid = b.CustomerId LEFT JOIN asdb.z_projectext pext ON pext.projectId = b.projectId LEFT JOIN asdb.z_projectmember c ON c.projectid = b.projectid LEFT JOIN asdb.z_projectpeople e ON e.projectid = b.projectid INNER JOIN bdo_base.base_user f ON f.hrLoginId = '{param1}' AND f.id IN ( e.signUser, e.signUser1, e.signUser2, e.signUser3, e.audit1, e.audit2, e.audit3, e.audit4, e.audit5, e.qfUser, e.managerid, e.gongshi1, e.gongshi2, c.memberId ) LEFT JOIN bdo_base.base_department dp1 ON dp1.autoid = b.departmentid LEFT JOIN bdo_base.base_department dp2 ON dp2.autoid = dp1.firstItemId WHERE a.restcustomerid > '' ORDER BY projectId DESC
other.P00006=SELECT DISTINCT b.projectId, CONCAT('[\u5BA1]',b.projectName) AS projectName, a.restcustomerid, CONCAT('[\u5BA1]',a.customerName) AS customerName, pext.s61, dp2.hrDeptCode AS office, pext.s21 AS isNeedReport from (select f.id, e.projectId from bdo_base.base_user f left join asdb.z_projectpeople e on f.id IN ( e.signUser, e.signUser1, e.signUser2, e.signUser3, e.audit1, e.audit2, e.audit3, e.audit4, e.audit5, e.qfUser, e.managerid, e.gongshi1, e.gongshi2 ) where f.hrLoginId = '{param1}' union select f.id, c.projectId from bdo_base.base_user f LEFT JOIN asdb.z_projectmember c ON f.id = c.memberId where f.hrLoginId = '{param1}') f left join asdb.z_project b on b.projectId = f.projectId LEFT JOIN asdb.z_projectext pext ON pext.projectId = f.projectId left join bdo_cus.cus_customerinfo a ON a.customerId = b.customerId LEFT JOIN bdo_base.base_department dp1 ON dp1.autoid = b.departmentid LEFT JOIN bdo_base.base_department dp2 ON dp2.autoid = dp1.firstItemId where a.restcustomerid is not null AND b.isClose = '0' ORDER BY b.projectId DESC
#\u83B7\u53D6\u7528\u6237\u5BA2\u6237
other.P00007=SELECT GROUP_CONCAT(DISTINCT a.restcustomerid) AS customerId FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.customerid = b.CustomerId LEFT JOIN asdb.z_projectmember c ON c.projectid = b.projectid LEFT JOIN asdb.z_projectpeople e ON e.projectid = b.projectid INNER JOIN bdo_base.base_user f ON f.hrLoginId = '{param1}' AND f.id IN ( e.audit1, e.audit2, e.audit3, e.audit4, e.managerid, e.gongshi1, e.gongshi2, c.memberId ) WHERE a.restcustomerid > ''
#\u83B7\u53D6\u7528\u6237\u5BA2\u6237(\u6A21\u7248\u5BFC\u5165)
other.P00008=SELECT GROUP_CONCAT(DISTINCT a.restcustomerid) AS customerId FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.customerid = b.CustomerId LEFT JOIN asdb.z_projectmember c ON c.projectid = b.projectid LEFT JOIN asdb.z_projectpeople e ON e.projectid = b.projectid INNER JOIN bdo_base.base_user f ON f.hrLoginId = '{param1}' AND f.id = e.managerid WHERE a.restcustomerid > ''
#\u83B7\u53D6\u7528\u6237\u6240\u6709\u6709\u6743\u9650\u7684\u5BA2\u6237
other.P00009=SELECT GROUP_CONCAT(DISTINCT CONCAT('"',a.restCustomerId,'-',h.hrDeptId,'"')) AS cusKey FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.customerid = b.CustomerId LEFT JOIN asdb.z_projectmember c ON c.projectid = b.projectid LEFT JOIN asdb.z_projectpeople e ON e.projectid = b.projectid INNER JOIN bdo_base.base_user f ON f.hrLoginId = '{hrLoginId}' AND f.id IN (e.signUser,e.signUser1,e.signUser2,e.signUser3,e.audit1,e.audit2,e.audit3,e.audit4,e.audit5,e.qfUser,e.managerid,e.gongshi1,e.gongshi2,c.memberId) LEFT JOIN bdo_base.base_department g ON g.autoid = b.departmentid LEFT JOIN bdo_base.base_department h ON h.autoid = g.topManageDepId WHERE a.restCustomerId > '' ORDER BY b.departmentid,a.restCustomerId DESC
#\u83B7\u53D6\u7528\u6237\u9879\u76EE\u8D1F\u8D23\u4EBA\u6743\u9650\u7684\u5BA2\u6237
other.P00010=SELECT GROUP_CONCAT(DISTINCT CONCAT('"',a.restCustomerId,'-',h.hrDeptId,'"')) AS cusKey FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.customerid = b.CustomerId LEFT JOIN asdb.z_projectmember c ON c.projectid = b.projectid LEFT JOIN asdb.z_projectpeople e ON e.projectid = b.projectid INNER JOIN bdo_base.base_user f ON f.hrLoginId = '{hrLoginId}' AND f.id = e.managerid LEFT JOIN bdo_base.base_department g ON g.autoid = b.departmentid LEFT JOIN bdo_base.base_department h ON h.autoid = g.topManageDepId WHERE a.restCustomerId > '' ORDER BY b.departmentid,a.restCustomerId DESC
#\u83B7\u53D6\u5BA2\u6237\u673A\u6784
other.P00011=SELECT d.hrDeptCode FROM bdo_cus.cus_customerinfo a LEFT JOIN asdb.z_project b ON b.CustomerID = a.customerId LEFT JOIN bdo_base.base_department c ON c.autoid = b.departmentid LEFT JOIN bdo_base.base_department d ON d.autoid = c.firstItemId WHERE a.restCustomerId = '{customerId}' ORDER BY a.restCustomerId,b.ProjectID DESC LIMIT 1
#\u5BA2\u6237\u673A\u6784redis job sync
other.P00012=SELECT COUNT(1) FROM (SELECT a.restCustomerId FROM bdo_cus.cus_customerinfo a LEFT JOIN bdo_base.base_department c ON c.autoid = a.departmentid LEFT JOIN bdo_base.base_department d ON d.autoid = c.firstItemId WHERE a.restCustomerId > '' AND d.hrDeptCode > '' GROUP BY a.restCustomerId) a
other.P00013=SELECT a.restCustomerId, d.hrDeptCode FROM bdo_cus.cus_customerinfo a LEFT JOIN bdo_base.base_department c ON c.autoid = a.departmentid LEFT JOIN bdo_base.base_department d ON d.autoid = c.firstItemId WHERE a.restCustomerId > '' AND d.hrDeptCode > '' AND a.customerId = (SELECT MAX(customerId) FROM bdo_cus.cus_customerinfo cu WHERE cu.restCustomerId = a.restCustomerId) GROUP BY a.restCustomerId ORDER BY a.restCustomerId limit {start},{size}
other.P00014=SELECT pext.s61 FROM asdb.z_projectext pext WHERE pext.projectId = {projectId}
#\u5728\u9879\u76EE\u7BA1\u7406\u7CFB\u7EDF\u67E5\u8BE2 \u4EBA + \u5BA2\u6237 \u5BF9\u5E94\u7684\u673A\u6784hrCode
other.P00015=SELECT dp2.hrDeptCode FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.customerid = b.CustomerId LEFT JOIN asdb.z_projectmember c ON c.projectid = b.projectid LEFT JOIN asdb.z_projectpeople e ON e.projectid = b.projectid INNER JOIN bdo_base.base_user f ON f.hrLoginId = '{hrLoginId}' AND f.id = e.managerid LEFT JOIN bdo_base.base_department dp1 ON dp1.autoid = b.departmentid LEFT JOIN bdo_base.base_department dp2 ON dp2.autoid = dp1.firstItemId WHERE a.restcustomerid = {customerId} ORDER BY b.ProjectID DESC LIMIT 1
#\u67E5\u8BE2\u6307\u5B9A\u9879\u76EE\u5728pm\u4E2D\u662F\u5426\u88AB\u6807\u8BC6\u4E3A\u5DF2\u5173\u95ED
other.P00016=SELECT p.isClose FROM  asdb.z_project p WHERE p.projectId = {projectId}
#\u67E5\u8BE2\u6307\u5B9A\u9879\u76EE\u5728pm\u4E2D\u9879\u76EE\u6027\u8D28
other.P00017=SELECT pext.projectId, pext.s21 AS isNeedReport FROM asdb.z_projectext pext WHERE pext.projectId in ({projectId})
#\u83B7\u53D6\u5BA2\u6237\u7BA1\u7406\u7684\u76D1\u7BA1\u6D88\u606F
#other.CP0001=SELECT a.autoId, a.id, a.title, a.zjhtype, DATE_FORMAT(a.QTime, '%Y-%m-%d') AS QTime, a.url, a.innerurl FROM bdo_cus.cus_zjhquestion a WHERE a.customerId = {param1} ORDER BY a.autoId, a.id
other.CP0001=SELECT DISTINCT a.autoId, a.id, a.title, a.zjhtype, a.QTime, a.url, a.innerurl FROM ((SELECT a.autoId, a.id, a.title, a.zjhtype, DATE_FORMAT(a.QTime, '%Y-%m-%d') AS QTime, a.url, a.innerurl FROM bdo_cus.cus_zjhquestion a WHERE a.customerId = {param1}) /*START #param2# UNION (SELECT a.autoId, a.id, a.title, a.zjhtype, DATE_FORMAT(a.QTime, '%Y-%m-%d') AS QTime, a.url, a.innerurl FROM bdo_cus.cus_zjhquestion a WHERE a.gpcode = {param2}) #param2# END*/) a ORDER BY a.QTime DESC
#\u83B7\u53D6\u5408\u4F19\u4EBA\u4FE1\u606F
#\u57FA\u672C\u4FE1\u606F
other.CP0002=SELECT a.id AS userId, a.NAME AS userName, CONCAT( b.topManageDepNm, '-', b.departname ) AS departmentName, a.rank, a.email, a.mobilePhone, a.phone, CONCAT( IFNULL(c.fn1, ''), IFNULL(c.fn2, ''), IFNULL(c.fn3, ''), IFNULL(c.fn4, ''), IFNULL(c.fn5, '') ) AS focusIndustry, c.evaluateScore, c.memo, c.partnerId, a.wrokState FROM bdo_base.base_user a LEFT JOIN bdo_base.base_department b ON a.departmentId = b.autoId LEFT JOIN asdb.coop_partnerinfo c ON c.partnerId = a.id WHERE a.hrLoginId = '{param1}'
#\u662F\u5426\u5173\u6CE8
other.CP0003=SELECT COUNT(0) FROM asdb.coop_partnerfocus a LEFT JOIN bdo_base.base_user b ON b.id = a.userId LEFT JOIN bdo_base.base_user c ON c.id = a.focusId WHERE b.hrLoginId = '{param2}' AND c.hrLoginId = '{param1}'
#\u5173\u6CE8\u6570/\u7C89\u4E1D\u6570
other.CP0004=select ifnull((SELECT COUNT(0) FROM asdb.coop_partnerfocus a INNER JOIN bdo_base.base_user b ON b.id = a.userId where b.hrLoginId = '{param1}'), 0) AS FOCUSNUM, IFNULL((SELECT COUNT(0) AS FANSNUM FROM asdb.coop_partnerfocus a INNER JOIN bdo_base.base_user b ON b.id = a.focusId WHERE b.hrLoginId = '{param1}'), 0) as FANSNUM 
#\u83B7\u53D6\u7528\u6237\u5DE5\u65F6\u7533\u62A5\u9879\u76EE
other.CP0005=SELECT b.id,b.hrLoginId,a.projectId,c.projectYear,c.projectName,c.auditPara,b.departmentId,CONCAT(d.firstItemName,'-',d.departName) AS departmentName FROM asdb.z_projectpeople a LEFT JOIN bdo_base.base_user b ON b.id = a.audit1 LEFT JOIN asdb.z_project c ON c.projectId = a.projectId LEFT JOIN bdo_base.base_department d ON d.autoId = b.departmentId WHERE b.hrLoginId = '{param1}' AND c.projectYear = {param2} {param3} ORDER BY a.projectId DESC
other.CP0006=SELECT b.id,b.hrLoginId,a.projectId,c.projectYear,c.projectName,c.auditPara,b.departmentId,CONCAT(d.firstItemName,'-',d.departName) AS departmentName FROM asdb.z_projectpeople a LEFT JOIN bdo_base.base_user b ON b.id = a.managerId LEFT JOIN asdb.z_project c ON c.projectId = a.projectId LEFT JOIN bdo_base.base_department d ON d.autoId = b.departmentId WHERE b.hrLoginId = '{param1}' AND c.projectYear = {param2} {param3} ORDER BY a.projectId DESC
other.CP0007=SELECT b.id,b.hrLoginId,a.projectId,c.projectYear,c.projectName,c.auditPara,b.departmentId,CONCAT(d.firstItemName,'-',d.departName) AS departmentName FROM asdb.z_projectmember a LEFT JOIN bdo_base.base_user b ON b.id = a.memberId LEFT JOIN asdb.z_project c ON c.projectId = a.projectId LEFT JOIN bdo_base.base_department d ON d.autoId = b.departmentId WHERE b.hrLoginId = '{param1}' AND c.projectYear = {param2} {param3} ORDER BY a.projectId DESC
#\u83B7\u53D6\u7528\u6237\u7533\u62A5\u5DE5\u65F6\u9879\u76EE\u6570
other.CP0008=SELECT a.userId, a.hrLoginId, a.projectYear, a.impPlSum, a.impPmSum, a.impMbSum, a.unimpPlSum, a.unimpPmSum, a.unimpMbSum FROM asdb.coop_userprojectsum a WHERE a.hrLoginId = {param1} ORDER BY a.projectYear DESC
#\u67E5\u8BE2\u5BA2\u6237\u4FE1\u606F
other.CP0009=SELECT industrycategory, industryclassification FROM bdo_cus.cus_customerinfo_basic WHERE customerId = {customerId}
#\u5408\u4F19\u4EBA\u4E1A\u52A1\u4FE1\u606F
other.CP0010=SELECT a.id AS __uid, a.wrokState, b.partnerId, a.departmentid AS __ddepartmentid, CONCAT( IFNULL(b.fn1, ''), IFNULL(b.fn2, ''), IFNULL(b.fn3, ''), IFNULL(b.fn4, ''), IFNULL(b.fn5, '') ) AS focusIndustry, CONCAT( IFNULL(b.mn1, ''), IFNULL(b.mn2, ''), IFNULL(b.mn3, ''), IFNULL(b.mn4, ''), IFNULL(b.mn5, '') ) AS mainIndustry, b.fn1, b.fn2, b.fn3, b.fn4, b.fn5, b.mn1, b.mn2, b.mn3, b.mn4, b.mn5, b.mnOther, b.ms1, b.ms2, b.ms3, b.ms4, b.ms5, b.msOther, b.mp1, b.mp2, b.mp3, b.mp4, b.mp5, b.mpOther, b.evaluateScore, b.canApplyNum, b.providedNum, b.memo FROM bdo_base.base_user a LEFT JOIN asdb.coop_partnerinfo b ON a.id = b.partnerId WHERE a.hrLoginId = '{param1}'
#\u5408\u4F19\u4EBA\u7B7E\u53D1\u9879\u76EE
other.CP0011=SELECT a.projectYear, a.groupName, a.customerName, a.customerProperties, a.industrySys, a.businessType FROM asdb.coop_partnerproject a left join bdo_base.base_user b on a.partnerId = b.id WHERE b.hrLoginId= '{param1}' ORDER BY a.projectYear DESC, a.orderDate DESC  
#\u5173\u6CE8\u4FE1\u606F
other.CP0012=SELECT c.id AS __uid, c.wrokState, c.partnerId, c.departmentid AS __ddepartmentid, c.focusIndustry, c.mainIndustry, c.fn1, c.fn2, c.fn3, c.fn4, c.fn5, c.mn1, c.mn2, c.mn3, c.mn4, c.mn5, c.mnOther, c.ms1, c.ms2, c.ms3, c.ms4, c.ms5, c.msOther, c.mp1, c.mp2, c.mp3, c.mp4, c.mp5, c.mpOther, c.evaluateScore, c.canApplyNum, c.providedNum, c.memo FROM (SELECT a.id, a.wrokState, b.partnerId, a.departmentid, CONCAT( IFNULL(b.fn1, ''), IFNULL(b.fn2, ''), IFNULL(b.fn3, ''), IFNULL(b.fn4, ''), IFNULL(b.fn5, '') ) AS focusIndustry, CONCAT( IFNULL(b.mn1, ''), IFNULL(b.mn2, ''), IFNULL(b.mn3, ''), IFNULL(b.mn4, ''), IFNULL(b.mn5, '') ) AS mainIndustry, b.fn1, b.fn2, b.fn3, b.fn4, b.fn5, b.mn1, b.mn2, b.mn3, b.mn4, b.mn5, b.mnOther, b.ms1, b.ms2, b.ms3, b.ms4, b.ms5, b.msOther, b.mp1, b.mp2, b.mp3, b.mp4, b.mp5, b.mpOther, b.evaluateScore, b.canApplyNum, b.providedNum, b.memo FROM bdo_base.base_user a LEFT JOIN asdb.coop_partnerinfo b ON a.id = b.partnerId WHERE 1 = 1 /*START #param1# AND b.partnerId IS NOT NULL #param1# END*/ /*START #param2# AND a.id = {param2} #param2# END*/ ) c ORDER BY c.id
other.CP0013=SELECT COUNT(0) FROM coop_partnerfocus WHERE userId = {userId} AND focusId = {focusId}
#\u83B7\u53D6\u5408\u4F19\u4EBA\u5173\u6CE8\u6570
other.CP0014=SELECT COUNT(0) AS focusNum FROM coop_partnerfocus WHERE userId = {userId}
#\u83B7\u53D6\u5408\u4F19\u4EBA\u7C89\u4E1D\u6570
other.CP0015=SELECT COUNT(0) AS focusNum FROM coop_partnerfocus WHERE focusId = {focusId}
#\u5173\u6CE8\u4E00\u89C8
other.CP0016=SELECT f.autoId,f.CREATION_DATE AS createDate,fn.hrLoginId AS userLoginId,u.hrLoginId AS focusLoginId,u.name AS focusName,d.departname AS departName,u.userPhoto FROM bdo_base.base_user u LEFT JOIN asdb.coop_partnerfocus f ON f.focusId = u.id LEFT JOIN bdo_base.base_user fn ON fn.id = f.userId LEFT JOIN bdo_base.base_department d ON d.autoid = u.departmentid WHERE u.hrLoginId != '{param1}' AND fn.hrLoginId = '{param1}' ORDER BY f.CREATION_DATE DESC
#\u4EBA\u5458\u641C\u7D22\u4E00\u89C8
other.CP0017=SELECT f.autoId,'' AS createDate,'{param1}' AS userLoginId,u.hrLoginId AS focusLoginId,u.name AS focusName,d.departname AS departName,u.userPhoto FROM bdo_base.base_user u LEFT JOIN bdo_base.base_department d ON d.autoid = u.departmentid LEFT JOIN asdb.coop_partnerfocus f ON f.focusId=u.id AND f.userId = (SELECT id FROM bdo_base.base_user WHERE hrLoginId='{param1}') WHERE u.id != 19 AND u.wrokState = '\u5728\u804C' AND u.hrLoginId > '' AND u.ACTIVE_FLAG = 1 AND u.name LIKE '%{param2}%' ORDER BY f.autoId DESC,u.id
#\u83B7\u53D6\u80A1\u4E1C\u4FE1\u606F
other.CP0018=SELECT distinct b.customerName as customerName FROM bdo_cus.cus_customerinfo_qccratedetail a LEFT JOIN bdo_cus.cus_customerinfo_qcc b ON b.qccId = a.qccId WHERE a.subQccId  = (SELECT d.qccId from bdo_cus.cus_customerinfo_qcc d WHERE customerId={customerId} ) AND a.stockRateType = 2
#\u83B7\u53D6\u5BF9\u5916\u6295\u8D44\u7684\u4F01\u4E1A\u4FE1\u606F
other.CP0019=SELECT distinct b.customerName as customerName FROM bdo_cus.cus_customerinfo_qccratedetail a LEFT JOIN bdo_cus.cus_customerinfo_qcc b ON b.qccId = a.subQccId WHERE a.qccId = (SELECT d.qccId from bdo_cus.cus_customerinfo_qcc d WHERE customerId= {customerId} ) AND a.stockRateType = 1
#\u83B7\u53D6\u9AD8\u7BA1\u4FE1\u606F
other.CP0020=SELECT distinct membername as membername from bdo_cus.cus_customerinfo_member WHERE customerId = {customerId}
#
#\u8D26\u5957\u5BFC\u5165
other.AR000000=SELECT * FROM temp_faith.fin_tasklist WHERE customerId={customerId} AND year={yyyy}
#\u67E5\u8BE2\u51ED\u8BC1
other.AR000001=SELECT DISTINCT oldVoucherId FROM temp_faith.fin_subjectentry WHERE customerId={customerId} AND yyyy={yyyy} ORDER BY vchDate,oldVoucherId
#\u67E5\u8BE2\u51ED\u8BC1
other.AR000002=SELECT autoId FROM temp_faith.fin_subjectentry WHERE customerId={customerId} AND yyyy={yyyy} AND oldVoucherId={oldVoucherId} ORDER BY vchDate,oldVoucherId,summary
#\u67E5\u8BE2\u51ED\u8BC1
other.AR000003=SELECT voucherId,autoId FROM temp_faith.fin_subjectentry WHERE customerId={customerId} AND yyyy={yyyy} AND voucherId IN (SELECT voucherId FROM temp_faith.fin_subjectentry WHERE subjectFullName1 LIKE '\u672C\u5E74\u5229\u6DA6%' AND customerId={customerId} AND yyyy={yyyy}) AND voucherId NOT IN (SELECT voucherId FROM temp_faith.fin_subjectentry WHERE subjectname1 LIKE '\u672A\u5206\u914D\u5229\u6DA6%' AND customerId={customerId} AND yyyy={yyyy}) AND subjectFullName1 NOT LIKE '\u672C\u5E74\u5229\u6DA6%'
#\u67E5\u8BE2\u51ED\u8BC1
other.AR000004=SELECT voucherId,autoId FROM temp_faith.fin_subjectentry WHERE customerId={customerId} AND yyyy={yyyy} AND voucherId IN (SELECT voucherId FROM temp_faith.fin_subjectentry WHERE subjectname1 LIKE '\u672A\u5206\u914D\u5229\u6DA6%' AND customerId={customerId} AND yyyy={yyyy}) AND voucherId NOT IN (SELECT voucherId FROM temp_faith.fin_subjectentry WHERE subjectFullName1 LIKE '\u672C\u5E74\u5229\u6DA6%' AND customerId={customerId} AND yyyy={yyyy}) AND subjectname1 NOT LIKE '\u672A\u5206\u914D\u5229\u6DA6%'
#\u67E5\u8BE2\u53D1\u751F\u989D,\u7ED3\u8F6C
other.AR000005=SELECT a.subjectId,a.debitTotalOcc,a.creditTotalOcc,a.tranDebitTotalOcc,a.tranCreditTotalOcc,a.debitTotalOcc-a.tranDebitTotalOcc AS debitTotalOccNoTran,a.creditTotalOcc-a.tranCreditTotalOcc AS creditTotalOccNoTran,a.level0,a.isLeaf,t.remain,t.balance FROM (SELECT a.subjectId,a.debitTotalOcc,a.creditTotalOcc,SUM(IFNULL(b.tranDebitTotalOcc,0)) AS tranDebitTotalOcc,SUM(IFNULL(b.tranCreditTotalOcc,0)) AS tranCreditTotalOcc,level0,c.isLeaf,a.customerId,a.yyyy FROM temp_faith.fin_accpkgsubject a LEFT JOIN (SELECT subjectId,IF(dirction=1,SUM(occurValue),0) AS tranDebitTotalOcc,IF(dirction=-1,SUM(occurValue),0) AS tranCreditTotalOcc FROM temp_faith.fin_subjectentry WHERE customerId={customerId} AND yyyy={yyyy} AND isTransferVoucher=1 GROUP BY subjectId,dirction) b ON a.subjectId=LEFT (b.subjectId,LENGTH(a.subjectId)) LEFT JOIN ((SELECT subjectId,1 AS isLeaf FROM temp_faith.fin_accpkgsubject a WHERE customerId={customerId} AND yyyy={yyyy} AND NOT EXISTS (SELECT subjectId FROM temp_faith.fin_accpkgsubject b WHERE customerId={customerId} AND yyyy={yyyy} AND a.subjectId=SUBSTRING(b.subjectId,1,LENGTH(a.subjectId)) AND a.subjectId<>b.subjectId)) UNION (SELECT subjectId,0 AS isLeaf FROM temp_faith.fin_accpkgsubject a WHERE customerId={customerId} AND yyyy={yyyy} AND EXISTS (SELECT subjectId FROM temp_faith.fin_accpkgsubject b WHERE customerId={customerId} AND yyyy={yyyy} AND a.subjectId=SUBSTRING(b.subjectId,1,LENGTH(a.subjectId)) AND a.subjectId<>b.subjectId))) c ON c.subjectId=a.subjectId WHERE a.customerId={customerId} AND a.yyyy={yyyy} GROUP BY a.subjectId) a left join temp_faith.fin_account t on a.customerId = t.customerId and a.yyyy=t.subYearMonth and a.subjectId = t.subjectId and t.subMonth = 12
#\u67E5\u8BE2\u53D1\u751F\u989D,\u7ED3\u8F6C
other.AR000006=SELECT a.customerId,a.subYearMonth,a.subjectId,a.subMonth,a.debitOcc,a.creditOcc,a.debitOcc-a.tranDebitOcc AS debitOccNoTran,a.creditOcc-a.tranCreditOcc AS creditOccNoTran,a.tranDebitOcc,a.tranCreditOcc,a.isLeaf,a.level0 FROM (SELECT a.customerId,a.subYearMonth,a.subjectId,a.subMonth,IFNULL(b.debitOcc,0) AS debitOcc,IFNULL(b.creditOcc,0) AS creditOcc,IFNULL(c.tranDebitOcc,0) AS tranDebitOcc,IFNULL(c.tranCreditOcc,0) AS tranCreditOcc,d.isLeaf,d.level0 FROM temp_faith.fin_account a LEFT JOIN ({param1}) b ON b.customerId=a.customerId AND b.yyyy=a.subYearMonth AND b.subjectId=a.subjectId AND b.month=a.subMonth LEFT JOIN ({param2}) c ON c.customerId=a.customerId AND c.yyyy=a.subYearMonth AND c.subjectId=a.subjectId AND c.month=a.subMonth LEFT JOIN temp_faith.fin_accpkgsubject d ON d.customerId=a.customerId AND d.yyyy=a.subYearMonth AND d.subjectId=a.subjectId  WHERE a.customerId={customerId} AND a.subYearMonth={yyyy} ORDER BY a.customerId,a.subYearMonth,a.subjectId,a.subMonth) a
#\u67E5\u8BE2\u53D1\u751F\u989D,\u7ED3\u8F6C
other.AR000007=SELECT customerId,subYearMonth,subjectId,SUM(debitOcc) AS debitTotalOcc,SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy} AND subjectId={subjectId} AND subMonth<={subMonth}
#\u67E5\u8BE2\u6700\u5927\u79D1\u76EE\u7EA7\u522B
other.AR000008=SELECT MAX(level1) AS MAXLEV FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy}
#\u67E5\u8BE2\u6307\u5B9A\u7EA7\u522B\u7684\u79D1\u76EE\u4F59\u989D
other.AR000009=SELECT customerId,subYearMonth,subMonth,subjectId,isLeaf1 AS isLeaf FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy} AND level1={level0}
#\u67E5\u8BE2\u79D1\u76EE\u4F59\u989D
other.AR000010=SELECT customerId,subYearMonth,subjectId,subMonth,debitRemain,creditRemain,remain,debitBalance,creditBalance,debitBalance+creditBalance AS balance FROM (SELECT customerId,subYearMonth,subjectId,subMonth,debitRemain,creditRemain,debitRemain+creditRemain AS remain,CASE WHEN (debitRemain+creditRemain)+(debitOccN-creditOccN) > 0 THEN (debitRemain+creditRemain)+(debitOccN-creditOccN) ELSE 0 END AS debitBalance,CASE WHEN (debitRemain+creditRemain)+(debitOccN-creditOccN) < 0 THEN (debitRemain+creditRemain)+(debitOccN-creditOccN) ELSE 0 END AS creditBalance FROM (SELECT customerId,subYearMonth,subjectId,subMonth,direction,debitBalance AS debitRemain,creditBalance AS creditRemain,debitOccN,creditOccN FROM (SELECT customerId,subYearMonth,subjectId,MAX(subMonth) AS subMonth,direction,SUM(CASE WHEN subMonth=1 THEN debitRemain ELSE 0 END) AS debitRemain1,SUM(CASE WHEN subMonth=1 THEN creditRemain ELSE 0 END) AS creditRemain1,SUM(CASE WHEN subMonth={param1} THEN debitBalance ELSE 0 END) AS debitBalance,SUM(CASE WHEN subMonth={param1} THEN creditBalance ELSE 0 END) AS creditBalance,SUM(CASE WHEN subMonth={subMonth} THEN debitOcc ELSE 0 END) AS debitOccN,SUM(CASE WHEN subMonth={subMonth} THEN creditOcc ELSE 0 END) AS creditOccN FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy} AND subjectId={subjectId} AND subMonth<={subMonth}) a) a) a
#\u67E5\u8BE2\u79D1\u76EE\u4F59\u989D
other.AR000011=SELECT SUM(debitRemain) AS debitRemain,SUM(creditRemain) AS creditRemain,SUM(remain) AS remain,SUM(debitBalance) AS debitBalance,SUM(creditBalance) AS creditBalance,SUM(balance) AS balance FROM temp_faith.fin_account WHERE isLeaf1=1 AND customerId={customerId} AND subYearMonth={yyyy} AND subjectId<>{subjectId} AND subjectId LIKE '{subjectId}%' AND subMonth={subMonth}
#\u67E5\u8BE2\u79D1\u76EE\u4F59\u989D
other.AR000012=SELECT DISTINCT a.subjectId,a.subjectName,a.subjectFullName,a.currency,IFNULL(c.debitRemain,0) AS debitRemain,IFNULL(c.creditRemain,0) AS creditRemain,IFNULL(d.debitTotalOcc,0) AS debitTotalOcc,IFNULL(d.creditTotalOcc,0) AS creditTotalOcc,IFNULL(d.debitBalance,0) AS debitBalance,IFNULL(d.creditBalance,0) AS creditBalance FROM (SELECT distinct a.subjectId,a.subjectName,a.subjectFullName,t.currency FROM temp_faith.fin_accpkgsubject a,temp_faith.fin_subjectentry t WHERE a.customerId ={customerId} AND a.yyyy ={yyyy} AND t.currency <> '' AND a.customerId =t.customerId AND a.yyyy =t.yyyy AND t.subjectId like concat(a.subjectId,'%')) a LEFT JOIN (SELECT subjectId,debitRemain,creditRemain FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth=1) c ON c.subjectId=a.subjectId LEFT JOIN (SELECT subjectId,debitTotalOcc,creditTotalOcc,debitBalance,creditBalance FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth=12) d ON d.subjectId=a.subjectId WHERE a.currency<>'' ORDER BY a.subjectId,a.currency
#\u67E5\u8BE2\u79D1\u76EE\u4F59\u989D
other.AR000013=SELECT a.customerId,a.subYearMonth,a.subjectId,a.subMonth,a.currency,a.debitOcc,a.creditOcc,a.debitOcc-a.tranDebitOcc AS debitOccNoTran,a.creditOcc-a.tranCreditOcc AS creditOccNoTran,a.tranDebitOcc,a.tranCreditOcc,a.debitOccF,a.creditOccF,a.debitOccF-a.tranDebitOccF AS debitOccNoTranF,a.creditOccF-a.tranCreditOccF AS creditOccNoTranF,a.tranDebitOccF,a.tranCreditOccF,a.isLeaf,a.level0 FROM (SELECT a.customerId,a.subYearMonth,a.subjectId,a.subMonth,IFNULL(b.debitOcc,0) AS debitOcc,IFNULL(b.creditOcc,0) AS creditOcc,IFNULL(b.debitOccF,0) AS debitOccF,IFNULL(b.creditOccF,0) AS creditOccF,IFNULL(a.dataName,'') AS currency,IFNULL(c.tranDebitOcc,0) AS tranDebitOcc,IFNULL(c.tranCreditOcc,0) AS tranCreditOcc,IFNULL(c.tranDebitOccF,0) AS tranDebitOccF,IFNULL(c.tranCreditOccF,0) AS tranCreditOccF,d.isLeaf,d.level0 FROM temp_faith.fin_accountall a LEFT JOIN ({param1}) b ON b.customerId=a.customerId AND b.yyyy=a.subYearMonth AND b.subjectId=a.subjectId AND b.month=a.subMonth AND b.currency=a.dataName LEFT JOIN (SELECT customerId,yyyy,subjectId,month,IF(dirction=1,SUM(occurValue),0) AS tranDebitOcc,IF(dirction=-1,SUM(occurValue),0) AS tranCreditOcc,IF(dirction=1,SUM(currValue),0) AS tranDebitOccF,IF(dirction=-1,SUM(currValue),0) AS tranCreditOccF FROM temp_faith.fin_subjectentry WHERE customerId={customerId} AND yyyy={yyyy} AND isTransferVoucher=1 GROUP BY customerId,yyyy,subjectId,month ORDER BY customerId,yyyy,subjectId,month) c ON c.customerId=a.customerId AND c.yyyy=a.subYearMonth AND c.subjectId=a.subjectId AND c.month=a.subMonth LEFT JOIN temp_faith.fin_accpkgsubject d ON d.customerId=a.customerId AND d.yyyy=a.subYearMonth AND d.subjectId=a.subjectId WHERE a.customerId={customerId} AND a.subYearMonth={yyyy} ORDER BY a.customerId,a.subYearMonth,a.subjectId,a.subMonth) a
#\u67E5\u8BE2\u79D1\u76EE\u4F59\u989D
other.AR000014=SELECT subMonth,subjectId,dataName AS currency FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy}
#\u67E5\u8BE2\u79D1\u76EE\u4F59\u989D
other.AR000015=SELECT customerId,subYearMonth,subjectId,SUM(debitOcc) AS debitTotalOcc,SUM(creditOcc) AS creditTotalOcc,SUM(debitOccF) AS debitTotalOccF,SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subjectId={subjectId} AND subMonth<={subMonth} AND dataName={currency}
#\u67E5\u8BE2\u6700\u5927\u79D1\u76EE\u7EA7\u522B
other.AR000016=SELECT MAX(level1) AS MAXLEV FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy}
#\u67E5\u8BE2\u79D1\u76EE\u4F59\u989D
other.AR000017=SELECT customerId,subYearMonth,subMonth,subjectId,dataName AS currency,isLeaf1 AS isLeaf FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy} AND level1={level0}
#\u67E5\u8BE2\u79D1\u76EE\u4F59\u989D
other.AR000018=SELECT customerId,subYearMonth,subjectId,subMonth,dataName AS currency,debitRemain,creditRemain,remain,debitBalance,creditBalance,debitBalance+creditBalance AS balance,debitRemainF,creditRemainF,remainF,debitBalanceF,creditBalanceF,debitBalanceF+creditBalanceF AS balanceF FROM (SELECT customerId,subYearMonth,subjectId,subMonth,dataName,debitRemain,creditRemain,debitRemain+creditRemain AS remain,CASE WHEN (debitRemain+creditRemain)+(debitOccN-creditOccN) > 0 THEN (debitRemain+creditRemain)+(debitOccN-creditOccN) ELSE 0 END AS debitBalance,CASE WHEN (debitRemain+creditRemain)+(debitOccN-creditOccN) < 0 THEN (debitRemain+creditRemain)+(debitOccN-creditOccN) ELSE 0 END AS creditBalance,debitRemainF,creditRemainF,debitRemainF+creditRemainF AS remainF,CASE WHEN (debitRemainF+creditRemainF)+(debitOccNF-creditOccNF) > 0 THEN (debitRemainF+creditRemainF)+(debitOccNF-creditOccNF) ELSE 0 END AS debitBalanceF,CASE WHEN (debitRemainF+creditRemainF)+(debitOccNF-creditOccNF) < 0 THEN (debitRemainF+creditRemainF)+(debitOccNF-creditOccNF) ELSE 0 END AS creditBalanceF FROM (SELECT customerId,subYearMonth,subjectId,subMonth,dataName,debitBalance AS debitRemain,creditBalance AS creditRemain,debitOccN,creditOccN,debitBalanceF AS debitRemainF,creditBalanceF AS creditRemainF,debitOccNF,creditOccNF FROM (SELECT customerId,subYearMonth,subjectId,MAX(subMonth) AS subMonth,dataName,SUM(CASE WHEN subMonth=1 THEN debitRemain ELSE 0 END) AS debitRemain1,SUM(CASE WHEN subMonth=1 THEN creditRemain ELSE 0 END) AS creditRemain1,SUM(CASE WHEN subMonth={param1} THEN debitBalance ELSE 0 END) AS debitBalance,SUM(CASE WHEN subMonth={param1} THEN creditBalance ELSE 0 END) AS creditBalance,SUM(CASE WHEN subMonth={subMonth} THEN debitOcc ELSE 0 END) AS debitOccN,SUM(CASE WHEN subMonth={subMonth} THEN creditOcc ELSE 0 END) AS creditOccN,SUM(CASE WHEN subMonth=1 THEN debitRemainF ELSE 0 END) AS debitRemain1F,SUM(CASE WHEN subMonth=1 THEN creditRemainF ELSE 0 END) AS creditRemain1F,SUM(CASE WHEN subMonth={param1} THEN debitBalanceF ELSE 0 END) AS debitBalanceF,SUM(CASE WHEN subMonth={param1} THEN creditBalanceF ELSE 0 END) AS creditBalanceF,SUM(CASE WHEN subMonth={subMonth} THEN debitOccF ELSE 0 END) AS debitOccNF,SUM(CASE WHEN subMonth={subMonth} THEN creditOccF ELSE 0 END) AS creditOccNF FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subjectId={subjectId} AND subMonth<={subMonth} AND dataName={currency}) a) a) a
#\u67E5\u8BE2\u79D1\u76EE\u4F59\u989D
other.AR000019=SELECT SUM(debitRemain) AS debitRemain,SUM(creditRemain) AS creditRemain,SUM(remain) AS remain,SUM(debitBalance) AS debitBalance,SUM(creditBalance) AS creditBalance,SUM(balance) AS balance,SUM(debitRemainF) AS debitRemainF,SUM(creditRemainF) AS creditRemainF,SUM(remainF) AS remainF,SUM(debitBalanceF) AS debitBalanceF,SUM(creditBalanceF) AS creditBalanceF,SUM(balanceF) AS balanceF FROM temp_faith.fin_accountall WHERE isLeaf1=1 AND customerId={customerId} AND subYearMonth={yyyy} AND subjectId LIKE '{subjectId}%' AND subjectId<>{subjectId}  AND subMonth={subMonth} AND dataName='{currency}'
#\u67E5\u8BE2\u51ED\u8BC1
other.AR000020=SELECT accPackageId,customerId,yyyy,oldVoucherId,typeId,vchDate,voucherFillUser,voucherAuditUser,voucherKeepUser,SUM(CASE WHEN dirction=1 THEN occurValue ELSE 0 END) AS debit,SUM(CASE WHEN dirction=-1 THEN occurValue ELSE 0 END) AS credit FROM temp_faith.fin_subjectentry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,vchDate,oldVoucherId ORDER BY customerId,yyyy,vchDate,oldVoucherId
#\u67E5\u8BE2\u51ED\u8BC1
other.AR000021=SELECT customerId,yyyy,subjectId,typeId,vchDate,voucherId,oldVoucherId,serail,dirction AS direction,currency,occurValue,currRate,currValue,quantity,unitPrice,unitName,isTransferVoucher FROM temp_faith.fin_subjectentry WHERE customerId={customerId} AND yyyy={yyyy} AND subjectId={subjectId} AND oldVoucherId={oldVoucherId}
#\u67E5\u8BE2\u6838\u7B97\u4F59\u989D
other.AR000022=SELECT a.customerId,a.yyyy,a.subjectId,a.assItemId,a.assItemName,a.debitTotalOcc,a.creditTotalOcc,a.debitTotalOccF,a.creditTotalOccF FROM ((SELECT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},1) AS assItemId,SUBSTRING_INDEX(property,{subjectNameSplit},1) AS assItemName,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitTotalOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditTotalOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitTotalOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditTotalOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},1)) UNION (SELECT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},2) AS assItemId,SUBSTRING_INDEX(property,{subjectNameSplit},2) AS assItemName,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitTotalOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditTotalOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitTotalOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditTotalOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},2)) UNION (SELECT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},3) AS assItemId,SUBSTRING_INDEX(property,{subjectNameSplit},3) AS assItemName,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitTotalOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditTotalOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitTotalOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditTotalOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},3)) UNION (SELECT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},4) AS assItemId,SUBSTRING_INDEX(property,{subjectNameSplit},4) AS assItemName,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitTotalOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditTotalOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitTotalOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditTotalOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},4)) UNION (SELECT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},5) AS assItemId,SUBSTRING_INDEX(property,{subjectNameSplit},5) AS assItemName,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitTotalOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditTotalOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitTotalOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditTotalOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},5)) UNION (SELECT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},6) AS assItemId,SUBSTRING_INDEX(property,{subjectNameSplit},6) AS assItemName,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitTotalOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditTotalOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitTotalOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditTotalOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},6)) ) a WHERE a.customerId={customerId} AND a.yyyy={yyyy} ORDER BY a.subjectId,a.assItemId 
other.AR000023=SELECT DISTINCT a.customerId,a.yyyy,a.subjectId,a.assItemId,a.subMonth,a.debitOcc,a.creditOcc,a.debitOccF,a.creditOccF FROM ((SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},1) AS assItemId,MONTH(vchDate) AS subMonth,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},1),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},2) AS assItemId,MONTH(vchDate) AS subMonth,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},2),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},3) AS assItemId,MONTH(vchDate) AS subMonth,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},3),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},4) AS assItemId,MONTH(vchDate) AS subMonth,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},4),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},5) AS assItemId,MONTH(vchDate) AS subMonth,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},5),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},6) AS assItemId,MONTH(vchDate) AS subMonth,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},6),MONTH(vchDate))) a WHERE a.customerId={customerId} AND a.yyyy={yyyy} ORDER BY a.subjectId,a.assItemId
#\u67E5\u8BE2\u6838\u7B97\u4F59\u989D(\u5916\u5E01)
other.AR000024=SELECT DISTINCT a.customerId,a.yyyy,a.subjectId,a.assItemId,a.currency,a.debitTotalOcc,a.creditTotalOcc,a.debitTotalOccF,a.creditTotalOccF FROM ((SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},1) AS assItemId,currency,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitTotalOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditTotalOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitTotalOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditTotalOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},1),currency) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},2) AS assItemId,currency,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitTotalOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditTotalOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitTotalOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditTotalOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},2),currency) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},3) AS assItemId,currency,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitTotalOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditTotalOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitTotalOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditTotalOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},3),currency) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},4) AS assItemId,currency,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitTotalOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditTotalOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitTotalOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditTotalOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},4),currency) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},5) AS assItemId,currency,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitTotalOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditTotalOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitTotalOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditTotalOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},5),currency) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},6) AS assItemId,currency,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitTotalOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditTotalOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitTotalOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditTotalOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},6),currency)) a WHERE a.customerId={customerId} AND a.yyyy={yyyy} AND a.currency<>'' ORDER BY a.subjectId,a.assItemId 
other.AR000025=SELECT DISTINCT a.customerId,a.yyyy,a.subjectId,a.assItemId,a.subMonth,a.currency,a.debitOccF,a.creditOccF,a.debitOcc,a.creditOcc FROM ((SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},1) AS assItemId,MONTH(vchDate) AS subMonth,currency,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOccF,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOcc FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,currency,SUBSTRING_INDEX(assItemId,{subjectNameSplit},1),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},2) AS assItemId,MONTH(vchDate) AS subMonth,currency,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOccF,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOcc FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,currency,SUBSTRING_INDEX(assItemId,{subjectNameSplit},2),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},3) AS assItemId,MONTH(vchDate) AS subMonth,currency,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOccF,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOcc FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,currency,SUBSTRING_INDEX(assItemId,{subjectNameSplit},3),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},4) AS assItemId,MONTH(vchDate) AS subMonth,currency,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOccF,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOcc FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,currency,SUBSTRING_INDEX(assItemId,{subjectNameSplit},4),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},5) AS assItemId,MONTH(vchDate) AS subMonth,currency,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOccF,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOcc FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,currency,SUBSTRING_INDEX(assItemId,{subjectNameSplit},5),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},6) AS assItemId,MONTH(vchDate) AS subMonth,currency,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOccF,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOcc FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,currency,SUBSTRING_INDEX(assItemId,{subjectNameSplit},6),MONTH(vchDate))) a WHERE a.customerId={customerId} AND a.yyyy={yyyy} AND a.currency<>'' ORDER BY a.subjectId,a.assItemId
#\u67E5\u8BE2\u7ED3\u8F6C\u51ED\u8BC1
other.AR000026=SELECT DISTINCT customerId,yyyy,subjectId,oldVoucherId FROM temp_faith.fin_subjectentry WHERE customerId={customerId} AND yyyy={yyyy} AND isTransferVoucher=1 ORDER BY subjectId,oldVoucherId
#\u67E5\u8BE2 \u6838\u7B97\u7F16\u53F7\u662F\u5426\u662F\u53F6\u5B50\u8282\u70B9
other.AR000027=SELECT IF(COUNT(0)>0,0,1) AS isLeaf FROM temp_faith.fin_assitem WHERE customerId={customerId} AND yyyy={yyyy} AND assItemId<>'{assItemId}' AND assItemId LIKE '{assItemId}{subjectNameSplit}%'
#\u67E5\u8BE2\u6838\u7B97
other.AR000028=SELECT customerId,yyyy,accId AS subjectId,assItemId,assItemName,assTotalName,isLeaf,level0,direction FROM temp_faith.fin_assitem WHERE customerId={customerId} AND yyyy={yyyy} AND accId={subjectId} AND assItemId={assItemId}
#\u67E5\u8BE2\u6838\u7B97
other.AR000029=SELECT customerId,yyyy,accId AS subjectId,assItemId,isLeaf,level0,assItemName,assTotalName FROM temp_faith.fin_assitem WHERE customerId={customerId} AND yyyy={yyyy} 
#\u67E5\u8BE2\u6838\u7B97
other.AR000030=SELECT customerId,yyyy,accId AS subjectId,assItemId FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND yyyy={yyyy}
#\u67E5\u8BE2\u51ED\u8BC1\u5BF9\u65B9\u79D1\u76EE,\u501F\u8D37\u65B9\u5206\u5F55\u6570,\u53D1\u751F\u989D
other.AR000031=SELECT customerId,yyyy,dirction,vchDate,oldVoucherId,typeId,GROUP_CONCAT(DISTINCT CASE WHEN dirction=1 THEN (SELECT    subjectName   FROM  temp_faith.fin_accpkgsubject a       WHERE a.subjectId = LEFT(temp_faith.fin_subjectentry.subjectId,4)         AND customerId = {customerId}         AND yyyy = {yyyy})  END ORDER BY subjectId) AS debitsubjectsNameTop,GROUP_CONCAT(DISTINCT CASE WHEN dirction=-1 THEN (SELECT         subjectName       FROM        temp_faith.fin_accpkgsubject a       WHERE a.subjectId = LEFT(temp_faith.fin_subjectentry.subjectId,4)         AND customerId = {customerId}         AND yyyy = {yyyy}) END ORDER BY subjectId)AS creditsubjectsNameTop,GROUP_CONCAT(DISTINCT CASE WHEN dirction=1 THEN (SELECT    subjectName   FROM  temp_faith.fin_accpkgsubject a       WHERE a.subjectId = temp_faith.fin_subjectentry.subjectId         AND customerId = {customerId}         AND yyyy = {yyyy})  END ORDER BY subjectId) AS debitsubjectsName,GROUP_CONCAT(DISTINCT CASE WHEN dirction=-1 THEN (SELECT         subjectName       FROM        temp_faith.fin_accpkgsubject a       WHERE a.subjectId = temp_faith.fin_subjectentry.subjectId         AND customerId = {customerId}         AND yyyy = {yyyy}) END ORDER BY subjectId)AS creditsubjectsName,GROUP_CONCAT(DISTINCT CASE WHEN dirction=1 THEN subjectId END ORDER BY subjectId) AS debitsubjects,GROUP_CONCAT(DISTINCT CASE WHEN dirction=-1 THEN subjectId END ORDER BY subjectId)AS creditsubjects, SUM(CASE WHEN dirction=1 THEN 1 ELSE 0 END) AS drCount, SUM(CASE WHEN dirction=-1 THEN 1 ELSE 0 END) AS crCount, SUM(CASE WHEN dirction=1 THEN occurValue ELSE 0 END) AS voucherDebitOcc, SUM(CASE WHEN dirction=-1 THEN occurValue ELSE 0 END) AS voucherCreditOcc FROM temp_faith.fin_subjectentry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,vchDate,oldVoucherId,typeId
#
other.AR000032=SELECT DISTINCT a.subjectId,SUBSTRING_INDEX(a.assItemId,{subjectNameSplit},1) AS assItemId,SUBSTRING_INDEX(b.subjectFullName,{subjectNameSplit},1) AS subjectName,b.subjectFullName FROM temp_faith.fin_assitementry a LEFT JOIN temp_faith.fin_accpkgsubject b ON b.customerId={customerId} AND b.yyyy={yyyy} AND b.subjectId=a.subjectId WHERE a.customerId={customerId} AND a.yyyy={yyyy} ORDER BY a.subjectId,a.assItemId
#\u6839\u636EsubjectId\u67E5\u8BE2subjectName
other.AR000033=SELECT subjectName,subjectFullName FROM temp_faith.fin_accpkgsubject WHERE customerId={customerId} AND yyyy={yyyy} AND subjectId={subjectId}
#\u67E5\u8BE2fin_assitem
other.AR000034=SELECT customerId,yyyy,accId AS subjectId,assItemId,assItemName,assTotalName FROM temp_faith.fin_assitem WHERE customerId={customerId} AND yyyy={yyyy} AND accId={subjectId} AND assItemId={assItemId} 
#\u67E5\u8BE2fin_assitem
other.AR000035=SELECT a.customerId,a.yyyy,a.accId AS subjectId,a.assItemId,a.assItemName,a.assTotalName,a.isLeaf,t.remain,t.balance FROM temp_faith.fin_assitem a LEFT JOIN temp_faith.fin_assitementryacc t ON a.customerId = t.customerId AND a.yyyy=t.subYearMonth AND a.accId = t.accId AND a.assItemId = t.assItemId AND t.subMonth = 12 WHERE a.customerId={customerId} AND a.yyyy={yyyy} 
#\u67E5\u8BE2fin_assitem
other.AR000036=SELECT customerId,yyyy,accId AS subjectId,assItemId,assItemName,assTotalName,debitRemain,creditRemain,debitTotalOcc,creditTotalOcc,debitBalance,creditBalance,isLeaf,level0,IFNULL(curr,'') AS currency,direction FROM temp_faith.fin_assitem WHERE customerId={customerId} AND yyyy={yyyy}
#\u67E5\u8BE2fin_assitementryacc
other.AR000037=SELECT customerId, yyyy, subjectId, assItemId, subMonth, debitTotalOcc, creditTotalOcc FROM ((SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '1' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=1 GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '2' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=2 GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '3' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=3 GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '4' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=4 GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '5' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=5 GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '6' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=6 GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '7' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=7 GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '8' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=8 GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '9' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=9 GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '10' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=10 GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '11' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=11 GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '12' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=12 GROUP BY customerId, subYearMonth, accId, assItemId)) a ORDER BY customerId, yyyy, subjectId, assItemId, subMonth
#\u67E5\u8BE2fin_assitementryaccall
other.AR000038=SELECT customerId, yyyy, subjectId, assItemId, subMonth, currency, debitTotalOcc, creditTotalOcc, debitTotalOccF, creditTotalOccF FROM ((SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '1' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=1 GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '2' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=2 GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '3' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=3 GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '4' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=4 GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '5' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=5 GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '6' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=6 GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '7' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=7 GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '8' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=8 GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '9' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=9 GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '10' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=10 GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '11' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=11 GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '12' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=12 GROUP BY customerId, subYearMonth, accId, assItemId, dataName)) a ORDER BY customerId, yyyy, subjectId, assItemId, subMonth, currency
#\u67E5\u8BE2fin_subjectentry
other.AR000039=SELECT customerId, yyyy, vchDate, oldVoucherId, SUM(CASE WHEN dirction=1 THEN 1 ELSE 0 END) AS drCount, SUM(CASE WHEN dirction=-1 THEN 1 ELSE 0 END) AS crCount, SUM(CASE WHEN dirction=1 THEN occurValue ELSE 0 END) AS voucherDebitOcc, SUM(CASE WHEN dirction=-1 THEN occurValue ELSE 0 END) AS voucherCreditOcc FROM temp_faith.fin_subjectentry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY vchDate, oldVoucherId ORDER BY vchDate, oldVoucherId
#\u67E5\u8BE2\u501F\u8D37\u662F\u5426\u5E73\u8861
other.AR000040=SELECT b.debitTotalOcc=b.creditTotalOcc AS JDPH, a.debitTotalOcc=b.debitTotalOcc AND a.creditTotalOcc=b.creditTotalOcc AS YMPH FROM (SELECT SUM(debitTotalOcc) AS debitTotalOcc, SUM(creditTotalOcc) AS creditTotalOcc FROM temp_faith.fin_accpkgsubject WHERE level0 = 1 AND customerId = {customerId} AND yyyy = {yyyy}) a, (SELECT SUM( CASE WHEN dirction>0 THEN occurValue ELSE 0 END) AS debitTotalOcc, SUM( CASE WHEN dirction<0 THEN occurValue ELSE 0 END) AS creditTotalOcc FROM temp_faith.fin_subjectentry WHERE customerId = {customerId} AND yyyy = {yyyy}) b
#\u67E5\u8BE2\u4F59\u989D\u8868 \u5916\u5E01
other.AR000041=SELECT COUNT(0) AS ACCALLNUM FROM temp_faith.fin_accountall WHERE customerId = {customerId} AND subYearMonth = {yyyy}
#\u67E5\u8BE2\u6838\u7B97\u5230fin_subjectassitem
other.AR000042=SELECT a.customerId, a.yyyy, a.accId AS subjectId, b.subjectFullName AS subjectFullName1, SUBSTRING_INDEX(b.subjectFullName, {subjectNameSplit}, 1) AS subjectFullName2, a.assItemId, a.assTotalName FROM temp_faith.fin_assitem a LEFT JOIN temp_faith.fin_accpkgsubject b ON b.customerId = {customerId} AND b.yyyy = {yyyy} AND b.subjectId = a.accId WHERE a.level0 = 1 AND a.customerId = {customerId} AND a.yyyy = {yyyy} ORDER BY a.accId,a.assItemId
#\u51ED\u8BC1\u53F7\u67E5\u8BE2\u5230\u8BE5\u51ED\u8BC1\u7684\u6240\u6709\u660E\u7EC6
other.AR000043=SELECT  `autoId`,  `accPackageId`,  `customerId`,  `yyyy`,  `month`,  `voucherId`,  `oldVoucherId`,  `typeId`,  `vchDate`,  `serail`,  `summary`,  `subjectId`,  `dirction`,  `occurValue`,  `currRate`,  `currValue`,  `currency`,  `quantity`,  `unitPrice`,  `unitName`,  `bankId`,  `property`,  `subjectname1`,  `subjectFullName1`,  `debitsubjects`,  `creditsubjects`,  `voucherFillUser`,  `voucherAuditUser`,  `voucherKeepUser`,  `voucherAffixCount`,  `voucherDebitOcc`,  `voucherCreditOcc`,  `voucherDirector`,  `tokenId`,  `standName`,  `isTransferVoucher`,  `drCount`,  `crCount`,  `correspondOccurValue`,  `oppositeAccountTop`,  `oppositeAccountLast`FROM temp_faith.fin_subjectentry WHERE customerId = {customerId} AND yyyy = {yyyy} AND vchDate = {vchDate} AND oldVoucherId = {oldVoucherId} AND typeId = {typeId} ORDER BY vchDate,oldVoucherId,summary
#\u67E5\u8BE2\u6700\u5927\u79D1\u76EE\u7EA7\u522B
other.AR000044=SELECT MAX(level1) AS MAXLEV FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy}
#\u67E5\u8BE2\u6307\u5B9A\u7EA7\u522B\u7684\u79D1\u76EE\u4F59\u989D
other.AR000045=SELECT customerId,subYearMonth,subMonth,accId AS subjectId,assItemId,isLeaf1 AS isLeaf FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND level1={level0} AND assItemId LIKE '{assItemId}%'
#\u67E5\u8BE2\u79D1\u76EE\u4F59\u989D
other.AR000046=SELECT customerId,subYearMonth,accId AS subjectId,assItemId,subMonth,debitRemain,creditRemain,remain,debitBalance,creditBalance,debitBalance+creditBalance AS balance FROM (SELECT customerId,subYearMonth,accId,assItemId,subMonth,debitRemain,creditRemain,debitRemain+creditRemain AS remain,CASE WHEN (debitRemain+creditRemain)+(debitOccN-creditOccN) > 0 THEN (debitRemain+creditRemain)+(debitOccN-creditOccN) ELSE 0 END AS debitBalance,CASE WHEN (debitRemain+creditRemain)+(debitOccN-creditOccN) < 0 THEN (debitRemain+creditRemain)+(debitOccN-creditOccN) ELSE 0 END AS creditBalance FROM (SELECT customerId,subYearMonth,accId,assItemId,subMonth,direction,debitBalance AS debitRemain,creditBalance AS creditRemain,debitOccN,creditOccN FROM (SELECT customerId,subYearMonth,accId,assItemId,MAX(subMonth) AS subMonth,direction,SUM(CASE WHEN subMonth=1 THEN debitRemain ELSE 0 END) AS debitRemain1,SUM(CASE WHEN subMonth=1 THEN creditRemain ELSE 0 END) AS creditRemain1,SUM(CASE WHEN subMonth={param1} THEN debitBalance ELSE 0 END) AS debitBalance,SUM(CASE WHEN subMonth={param1} THEN creditBalance ELSE 0 END) AS creditBalance,SUM(CASE WHEN subMonth={subMonth} THEN debitOcc ELSE 0 END) AS debitOccN,SUM(CASE WHEN subMonth={subMonth} THEN creditOcc ELSE 0 END) AS creditOccN FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND accid={subjectId} AND assItemId={assItemId} AND subMonth<={subMonth}) a) a) a
#\u67E5\u8BE2\u79D1\u76EE\u4F59\u989D
other.AR000047=SELECT SUM(debitRemain) AS debitRemain,SUM(creditRemain) AS creditRemain,SUM(remain) AS remain,SUM(debitBalance) AS debitBalance,SUM(creditBalance) AS creditBalance,SUM(balance) AS balance FROM temp_faith.fin_assitementryacc WHERE isLeaf1=1 AND customerId={customerId} AND subYearMonth={yyyy} AND accid={subjectId} AND assItemId<>'{assItemId}' AND assItemId LIKE '{assItemId}%' AND subMonth={subMonth}
#\u67E5\u8BE2\u6700\u5927\u79D1\u76EE\u7EA7\u522B
other.AR000048=SELECT MAX(level1) AS MAXLEV FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy}
#\u67E5\u8BE2\u79D1\u76EE\u4F59\u989D
other.AR000049=SELECT customerId,subYearMonth,subMonth,accId AS subjectId,assItemId,dataName AS currency,isLeaf1 AS isLeaf FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND level1={level0} AND assItemId LIKE '{assItemId}%'
#\u67E5\u8BE2\u79D1\u76EE\u4F59\u989D
other.AR000050=SELECT customerId,subYearMonth,accId AS subjectId,assItemId,subMonth,dataName AS currency,debitRemain,creditRemain,remain,debitBalance,creditBalance,debitBalance+creditBalance AS balance,debitRemainF,creditRemainF,remainF,debitBalanceF,creditBalanceF,debitBalanceF+creditBalanceF AS balanceF FROM (SELECT customerId,subYearMonth,accId,assItemId,subMonth,dataName,debitRemain,creditRemain,debitRemain+creditRemain AS remain,CASE WHEN (debitRemain+creditRemain)+(debitOccN-creditOccN) > 0 THEN (debitRemain+creditRemain)+(debitOccN-creditOccN) ELSE 0 END AS debitBalance,CASE WHEN (debitRemain+creditRemain)+(debitOccN-creditOccN) < 0 THEN (debitRemain+creditRemain)+(debitOccN-creditOccN) ELSE 0 END AS creditBalance,debitRemainF,creditRemainF,(debitRemainF+creditRemainF) * direction AS remainF,CASE WHEN (debitRemainF+creditRemainF)+(debitOccNF-creditOccNF) > 0 THEN (debitRemainF+creditRemainF)+(debitOccNF-creditOccNF) ELSE 0 END AS debitBalanceF,CASE WHEN (debitRemainF+creditRemainF)+(debitOccNF-creditOccNF) < 0 THEN (debitRemainF+creditRemainF)+(debitOccNF-creditOccNF) ELSE 0 END AS creditBalanceF FROM (SELECT customerId,subYearMonth,accId,assItemId,subMonth,dataName,direction,debitBalance AS debitRemain,creditBalance AS creditRemain,debitOccN,creditOccN,debitBalanceF AS debitRemainF,creditBalanceF AS creditRemainF,debitOccNF,creditOccNF FROM (SELECT customerId,subYearMonth,accId,assItemId,MAX(subMonth) AS subMonth,dataName,direction,SUM(CASE WHEN subMonth=1 THEN debitRemain ELSE 0 END) AS debitRemain1,SUM(CASE WHEN subMonth=1 THEN creditRemain ELSE 0 END) AS creditRemain1,SUM(CASE WHEN subMonth={param1} THEN debitBalance ELSE 0 END) AS debitBalance,SUM(CASE WHEN subMonth={param1} THEN creditBalance ELSE 0 END) AS creditBalance,SUM(CASE WHEN subMonth={subMonth} THEN debitOcc ELSE 0 END) AS debitOccN,SUM(CASE WHEN subMonth={subMonth} THEN creditOcc ELSE 0 END) AS creditOccN,SUM(CASE WHEN subMonth=1 THEN debitRemainF ELSE 0 END) AS debitRemain1F,SUM(CASE WHEN subMonth=1 THEN creditRemainF ELSE 0 END) AS creditRemain1F,SUM(CASE WHEN subMonth={param1} THEN debitBalanceF ELSE 0 END) AS debitBalanceF,SUM(CASE WHEN subMonth={param1} THEN creditBalanceF ELSE 0 END) AS creditBalanceF,SUM(CASE WHEN subMonth={subMonth} THEN debitOccF ELSE 0 END) AS debitOccNF,SUM(CASE WHEN subMonth={subMonth} THEN creditOccF ELSE 0 END) AS creditOccNF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND accId={subjectId} AND assItemId = {assItemId} AND subMonth<={subMonth} AND dataName={currency}) a) a) a
#\u67E5\u8BE2\u79D1\u76EE\u4F59\u989D
other.AR000051=SELECT SUM(debitRemain) AS debitRemain,SUM(creditRemain) AS creditRemain,SUM(remain) AS remain,SUM(debitBalance) AS debitBalance,SUM(creditBalance) AS creditBalance,SUM(balance) AS balance,SUM(debitRemainF) AS debitRemainF,SUM(creditRemainF) AS creditRemainF,SUM(remainF) AS remainF,SUM(debitBalanceF) AS debitBalanceF,SUM(creditBalanceF) AS creditBalanceF,SUM(balanceF) AS balanceF FROM temp_faith.fin_assitementryaccall WHERE isLeaf1=1 AND customerId={customerId} AND subYearMonth={yyyy} AND accid={subjectId} AND assItemId LIKE '{assItemId}%' AND assItemId<>'{assItemId}'  AND subMonth={subMonth} AND dataName='{currency}'
#\u67E5\u8BE2\u5916\u5E01\u8F85\u52A9\u6838\u7B97
other.AR000052=SELECT distinct a.customerId,a.yyyy,a.accid,a.assItemId,a.assItemName,a.assTotalName,b.currency,a.direction from temp_faith.fin_assitem a ,temp_faith.fin_assitementry b WHERE a.customerId ={customerId} AND a.yyyy ={yyyy} and a.customerId = b.customerId and a.yyyy = b.yyyy and a.accId = b.subjectId and b.assItemId like concat(a.assItemId,{subjectNameSplit},'%') and b.currency is not null and b.currency <> '' union SELECT distinct a.customerId,a.yyyy,a.accid,a.assItemId,a.assItemName,a.assTotalName,b.currency,a.direction from temp_faith.fin_assitem a ,temp_faith.fin_assitementry b WHERE a.customerId ={customerId} AND a.yyyy ={yyyy} and a.customerId = b.customerId and a.yyyy = b.yyyy and a.accId = b.subjectId and b.assItemId = a.assItemId and b.currency is not null and b.currency <> '' ORDER BY accid,assItemId
#\u67E5\u8BE2\u8F85\u52A9\u6838\u7B97\u6C47\u603B
other.AR000053=SELECT DISTINCT a.customerId,a.yyyy,a.subjectId,a.property,a.assItemId,a.debitOcc,a.creditOcc,a.debitOccF,a.creditOccF FROM ((SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(property, {subjectNameSplit}, 1) AS property,SUBSTRING_INDEX(assItemId,{subjectNameSplit},1) AS assItemId,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(property, {subjectNameSplit}, 1),SUBSTRING_INDEX(assItemId,{subjectNameSplit},1)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(property, {subjectNameSplit}, 2) AS property,SUBSTRING_INDEX(assItemId,{subjectNameSplit},2) AS assItemId,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(property, {subjectNameSplit}, 2),SUBSTRING_INDEX(assItemId,{subjectNameSplit},2)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(property, {subjectNameSplit}, 3) AS property,SUBSTRING_INDEX(assItemId,{subjectNameSplit},3) AS assItemId,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(property, {subjectNameSplit}, 3),SUBSTRING_INDEX(assItemId,{subjectNameSplit},3)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(property, {subjectNameSplit}, 4) AS property,SUBSTRING_INDEX(assItemId,{subjectNameSplit},4) AS assItemId,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(property, {subjectNameSplit}, 4),SUBSTRING_INDEX(assItemId,{subjectNameSplit},4)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(property, {subjectNameSplit}, 5) AS property,SUBSTRING_INDEX(assItemId,{subjectNameSplit},5) AS assItemId,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(property, {subjectNameSplit}, 5),SUBSTRING_INDEX(assItemId,{subjectNameSplit},5)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(property, {subjectNameSplit}, 6) AS property,SUBSTRING_INDEX(assItemId,{subjectNameSplit},6) AS assItemId,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(property, {subjectNameSplit}, 6),SUBSTRING_INDEX(assItemId,{subjectNameSplit},6))) a WHERE a.customerId={customerId} AND a.yyyy={yyyy} ORDER BY a.subjectId,a.assItemId
#\u67E5\u8BE2\u8F85\u52A9\u6838\u7B97\u4E0A\u7EA7\u6C47\u603B
other.AR000054=SELECT direction,SUM(debitRemain) AS debitRemain,SUM(creditRemain) AS creditRemain,SUM(remain) AS remain,SUM(debitBalance) AS debitBalance,SUM(creditBalance) AS creditBalance,SUM(balance) AS balance FROM temp_faith.fin_assitem WHERE isLeaf=1 AND customerId={customerId} AND yyyy={yyyy} AND accid={subjectId} AND assItemId<>'{assItemId}' AND assItemId LIKE '{assItemId}%' GROUP BY direction
#\u67E5\u8BE2fin_account
other.AR100001=SELECT accPackageId, customerId, subjectId, accName, subYearMonth, subMonth, assSign, dataName, debitRemain, creditRemain, debitOcc, creditOcc, debitOccNoTran, creditOccNoTran, tranDebitOcc, tranCreditOcc, remain, balance, debitTotalOcc, creditTotalOcc, accSign, direction, debitBalance, creditBalance, isLeaf1, level1, subjectFullName1, subjectfullName2, direction2, tokenid, standName, dataType FROM temp_faith.fin_account WHERE customerId = {customerId} AND subYearMonth = {yyyy}
#\u67E5\u8BE2fin_accountall 
other.AR100002=SELECT accPackageId, customerId, subjectId, accName, subYearMonth, subMonth, assSign, dataName, debitRemain, creditRemain, debitOcc, creditOcc, creditOccNoTran, debitOccNoTran, tranDebitOcc, tranCreditOcc, remain, balance, debitTotalOcc, creditTotalOcc, accSign, direction, debitBalance, creditBalance, isLeaf1, level1, subjectFullName1, subjectfullName2, direction2, tokenid, standName, debitRemainF, creditRemainF, debitOccF, creditOccF, debitOccNoTranF, creditOccNoTranF, tranDebitOccF, tranCreditOccF, remainF, balanceF, debitTotalOccF, creditTotalOccF, debitBalanceF, creditBalanceF FROM temp_faith.fin_accountall WHERE customerId = {customerId} AND subYearMonth = {yyyy}
#\u67E5\u8BE2fin_accpkgsubject
other.AR100003=SELECT accPackageId, customerId, yyyy, subjectCode, subjectId, parentSubjectCode, parentSubjectId, subjectName, subjectFullName, assistCode, uomUnit, currency, isLeaf, level0, debitRemain, creditRemain, debitTotalOcc, creditTotalOcc, tranDebitTotalOcc, tranCreditTotalOcc, debitTotalOccNoTran, creditTotalOccNoTran, debitBalance, creditBalance, remain, balance, essentiality1, essentiality2, essentiality3, direction, property FROM temp_faith.fin_accpkgsubject WHERE customerId = {customerId} AND yyyy = {yyyy}
#\u67E5\u8BE2fin_assitem
other.AR100004=SELECT accPackageId, customerId, yyyy, accId, assItemId, assItemName, assTotalName, parentAssItemId, debitRemain, creditRemain, debitTotalOcc, creditTotalOcc, tranDebitTotalOcc, tranCreditTotalOcc, debitBalance, creditBalance, remain, balance, isLeaf, level0, uomUnit, curr, direction, property FROM temp_faith.fin_assitem WHERE customerId = {customerId} AND yyyy = {yyyy}
#\u67E5\u8BE2fin_assitementry
other.AR100005=SELECT accPackageId, customerId, yyyy, subjectId, voucherId, oldvoucherId, vchDate, typeId, serail, assItemId, summary, dirction, assItemSum, currRate, currValue, currency, quantity, unitPrice, unitName, '' AS property, isTransferVoucher FROM temp_faith.fin_assitementry WHERE customerId = {customerId} AND yyyy = {yyyy}
#\u67E5\u8BE2fin_assitementryacc
other.AR100006=SELECT accPackageId, customerId, accId, assItemId, assItemName, subYearMonth, subMonth, debitRemain, creditRemain, debitOcc, creditOcc, tranDebitOcc, tranCreditOcc, remain, balance, debitTotalOcc, creditTotalOcc, direction, debitBalance, creditBalance, isLeaf1, level1, assTotalName1, dataName, accSign, direction2 FROM temp_faith.fin_assitementryacc WHERE customerId = {customerId} AND subYearMonth = {yyyy}
#\u67E5\u8BE2fin_assitementryaccall
other.AR100007=SELECT accPackageId, customerId, accId, assItemId, assItemName, subYearMonth, subMonth, debitRemain, creditRemain, debitOcc, creditOcc, tranDebitOcc, tranCreditOcc, remain, balance, debitTotalOcc, creditTotalOcc, direction, debitBalance, creditBalance, isLeaf1, level1, assTotalName1, dataName, accSign, direction2, debitRemainF, creditRemainF, debitOccF, creditOccF, tranDebitOccF, tranCreditOccF, remainF, balanceF, debitTotalOccF, creditTotalOccF, debitBalanceF, creditBalanceF FROM temp_faith.fin_assitementryaccall WHERE customerId = {customerId} AND subYearMonth = {yyyy}
#\u67E5\u8BE2fin_subjectassitem
other.AR100008=SELECT accPackageId, customerId, yyyy, subjectId, subjectFullName1, subjectFullName2, assitemId, assTotalName1, ifEqual, property FROM temp_faith.fin_subjectassitem WHERE customerId = {customerId} AND yyyy = {yyyy}
#\u67E5\u8BE2fin_subjectentry
other.AR100009=SELECT accPackageId, customerId, yyyy, month, voucherId, oldVoucherId, typeId, vchDate, serail, summary, subjectId, dirction, occurValue, currRate, currValue, currency, quantity, unitPrice, unitName, bankId, property, subjectname1, subjectFullName1, debitsubjects, creditsubjects, voucherFillUser, voucherAuditUser, voucherKeepUser, voucherAffixCount, voucherDebitOcc, voucherCreditOcc, voucherDirector, tokenId, standName, isTransferVoucher, drCount, crCount, correspondOccurValue,oppositeAccountTop,oppositeAccountLast FROM temp_faith.fin_subjectentry WHERE customerId = {customerId} AND yyyy = {yyyy}
#\u67E5\u8BE2fin_subjectvoucher
other.AR100010=SELECT accPackageId, customerId, yyyy, month, voucherId, typeId, vchDate, fillUser, auditUser, keepUser, director, affixCount, description, doubtUserId, property, debitocc, creditocc FROM temp_faith.fin_subjectvoucher WHERE customerId = {customerId} AND yyyy = {yyyy}
#\u67E5\u8BE2fin_assitementry\u6700\u5927\u7EA7
other.AR100011=SELECT IFNULL(MAX(LENGTH(assItemId)-LENGTH(REPLACE(assItemId,'{subjectNameSplit}',''))) + 1,0) AS MAXLEVEL FROM temp_faith.fin_assitementry WHERE customerId = {customerId} AND yyyy = {yyyy} AND assItemId LIKE '{assItemId}%'
#\u67E5\u8BE2fin_assitementry \u6839\u636EassItemId\u5408\u8BA1
other.AR100012=(SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(property,'{subjectNameSplit}',{assLevel}) AS property,SUBSTRING_INDEX(assItemId,'{subjectNameSplit}',{assLevel}) AS assItemId,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} AND assItemId LIKE '{assItemId}%' GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(property,'{subjectNameSplit}',{assLevel}),SUBSTRING_INDEX(assItemId,'{subjectNameSplit}',{assLevel}))
other.AR100013=SELECT DISTINCT a.customerId,a.yyyy,a.subjectId,a.property,a.assItemId,a.debitOcc,a.creditOcc,a.debitOccF,a.creditOccF FROM ( {sqlStr} ) a WHERE a.customerId={customerId} AND a.yyyy={yyyy} ORDER BY a.subjectId,a.assItemId
#\u66F4\u65B0\u6838\u7B97\u4F59\u989D\u8868updateAssitemaccByAssmx
other.AR100014=(SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,'{subjectNameSplit}',{assLevel}) AS assItemId,MONTH(vchDate) AS subMonth,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} AND assItemId LIKE '{assItemId}%' GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,'{subjectNameSplit}',{assLevel}),MONTH(vchDate))
#\u66F4\u65B0\u6838\u7B97\u4F59\u989D\u8868updateAssitemaccallByAssmx
other.AR100015=(SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,'{subjectNameSplit}',{assLevel}) AS assItemId,MONTH(vchDate) AS subMonth,currency,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOccF,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOcc FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} AND assItemId LIKE '{assItemId}%' GROUP BY customerId,yyyy,subjectId,currency,SUBSTRING_INDEX(assItemId,'{subjectNameSplit}',{assLevel}),MONTH(vchDate))
#\u67E5\u8BE2\u6240\u6709\u79D1\u76EE\u9996\u4F4D
other.AR100016=SELECT DISTINCT SUBSTRING(subjectId,1,1) AS subjectId FROM temp_faith.fin_subjectentry WHERE customerId = {customerId} AND yyyy = {yyyy} ORDER BY SUBSTRING(subjectId,1,1)
other.AR100017=SELECT DISTINCT SUBSTRING(subjectId,1,1) AS subjectId FROM temp_faith.fin_accpkgsubject WHERE customerId = {customerId} AND yyyy = {yyyy} ORDER BY SUBSTRING(subjectId,1,1)
#\u67E5\u8BE2search_index
other.ES000001=SELECT autoId,indexName,systemId,modelId,state,engineType,CREATION_DATE,customerId,yyyy FROM bdo_search.search_index WHERE systemId = 11 /*START #param4# AND customerId in ({param4}) #param4# END*/ /*START #param1# AND customerId = {param1} #param1# END*/ /*START #param2# AND yyyy like CONCAT('%',{param2},'%') #param2# END*/ /*START #param5# AND modelId = {param5} #param5# END*/ /*START #param6# AND indexName = {param6} #param6# END*/
####EDATA
#\u8D26\u5957\u5BFC\u5165
#\u66F4\u65B0fin_subjectentry\u8868voucherId
other.AU000001=UPDATE   temp_faith.fin_subjectentry SET voucherId=CASE  oldVoucherId {voucherId}  END WHERE customerId = {customerId}   AND  yyyy = {yyyy}   AND  oldVoucherId IN ({oldVoucherId})
#\u66F4\u65B0fin_subjectentry\u8868serail
other.AU000002=UPDATE temp_faith.fin_subjectentry SET serail = {serail} WHERE autoId = {autoId}
#\u66F4\u65B0fin_subjectentry\u8868 isTransferVoucher
other.AU000003=UPDATE temp_faith.fin_subjectentry SET isTransferVoucher = 1 WHERE customerId = {customerId} AND yyyy = {yyyy} AND voucherId IN (SELECT voucherId FROM (SELECT DISTINCT voucherId FROM temp_faith.fin_subjectentry WHERE customerId = {customerId} AND yyyy = {yyyy} AND subjectFullName1 LIKE '\u672C\u5E74\u5229\u6DA6%' UNION SELECT DISTINCT voucherId FROM temp_faith.fin_subjectentry WHERE customerId = {customerId} AND yyyy = {yyyy} AND subjectFullName1 LIKE '\u672A\u5206\u914D\u5229\u6DA6%') a)
#\u66F4\u65B0fin_accpkgsubject\u8868
other.AU000004=UPDATE temp_faith.fin_accpkgsubject t1 INNER JOIN (SELECT a.customerId,a.yyyy,a.subjectId,a.debitTotalOcc,a.creditTotalOcc,a.tranDebitTotalOcc,a.tranCreditTotalOcc,a.debitTotalOcc-a.tranDebitTotalOcc AS debitTotalOccNoTran,a.creditTotalOcc-a.tranCreditTotalOcc AS creditTotalOccNoTran,a.level0,a.isLeaf,t.remain,t.balance FROM (SELECT a.subjectId,a.debitTotalOcc,a.creditTotalOcc,SUM(IFNULL(b.tranDebitTotalOcc,0)) AS tranDebitTotalOcc,SUM(IFNULL(b.tranCreditTotalOcc,0)) AS tranCreditTotalOcc,level0,c.isLeaf,a.customerId,a.yyyy FROM temp_faith.fin_accpkgsubject a LEFT JOIN (SELECT subjectId,IF(dirction=1,SUM(occurValue),0) AS tranDebitTotalOcc,IF(dirction=-1,SUM(occurValue),0) AS tranCreditTotalOcc FROM temp_faith.fin_subjectentry WHERE customerId={customerId} AND yyyy={yyyy} AND isTransferVoucher=1 GROUP BY subjectId,dirction) b ON a.subjectId=LEFT (b.subjectId,LENGTH(a.subjectId)) LEFT JOIN ((SELECT subjectId,1 AS isLeaf FROM temp_faith.fin_accpkgsubject a WHERE customerId={customerId} AND yyyy={yyyy} AND NOT EXISTS (SELECT subjectId FROM temp_faith.fin_accpkgsubject b WHERE customerId={customerId} AND yyyy={yyyy} AND a.subjectId=SUBSTRING(b.subjectId,1,LENGTH(a.subjectId)) AND a.subjectId<>b.subjectId)) UNION (SELECT subjectId,0 AS isLeaf FROM temp_faith.fin_accpkgsubject a WHERE customerId={customerId} AND yyyy={yyyy} AND EXISTS (SELECT subjectId FROM temp_faith.fin_accpkgsubject b WHERE customerId={customerId} AND yyyy={yyyy} AND a.subjectId=SUBSTRING(b.subjectId,1,LENGTH(a.subjectId)) AND a.subjectId<>b.subjectId))) c ON c.subjectId=a.subjectId WHERE a.customerId={customerId} AND a.yyyy={yyyy} GROUP BY a.subjectId) a LEFT JOIN temp_faith.fin_account t ON a.customerId = t.customerId AND a.yyyy=t.subYearMonth AND a.subjectId = t.subjectId AND t.subMonth = 12) t2 ON t1.customerId = t2.customerId AND t1.yyyy = t2.yyyy AND t1.subjectId = t2.subjectId SET t1.tranDebitTotalOcc = t2.tranDebitTotalOcc , t1.tranCreditTotalOcc = t2.tranCreditTotalOcc , t1.debitTotalOccNoTran = t2.debitTotalOccNoTran , t1.creditTotalOccNoTran = t2.creditTotalOccNoTran, t1.isLeaf = t2.isLeaf, t1.level0 = t2.level0, t1.remain = t2.remain, t1.balance = t2.balance WHERE t1.customerId = {customerId} AND t1.yyyy = {yyyy} 
#\u66F4\u65B0fin_account\u8868  \u53D1\u751F\u989D \u7ED3\u8F6C \u5254\u9664\u7ED3\u8F6C
other.AU000005=UPDATE temp_faith.fin_account SET debitOcc = {debitOcc}, creditOcc = {creditOcc}, debitOccNoTran = {debitOccNoTran}, creditOccNoTran = {creditOccNoTran}, tranDebitOcc = {tranDebitOcc}, tranCreditOcc = {tranCreditOcc}, isLeaf1 = {isLeaf}, level1 = {level0} WHERE customerId = {customerId} AND subYearMonth = {yyyy} AND subMonth = {subMonth} AND subjectId = {subjectId}
#\u66F4\u65B0fin_account\u8868 \u7D2F\u8BA1\u53D1\u751F\u989D
other.AU000006=UPDATE temp_faith.fin_account t1 INNER JOIN (SELECT customerId, yyyy, subjectId, subMonth, debitTotalOcc, creditTotalOcc FROM ((SELECT customerId, subYearMonth AS yyyy, subjectId,  '1' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=1 GROUP BY customerId, subYearMonth, subjectId) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId,  '2' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=2 GROUP BY customerId, subYearMonth, subjectId) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId,  '3' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=3 GROUP BY customerId, subYearMonth, subjectId) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId,  '4' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=4 GROUP BY customerId, subYearMonth, subjectId) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId,  '5' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=5 GROUP BY customerId, subYearMonth, subjectId) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId,  '6' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=6 GROUP BY customerId, subYearMonth, subjectId) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId,  '7' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=7 GROUP BY customerId, subYearMonth, subjectId) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId,  '8' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=8 GROUP BY customerId, subYearMonth, subjectId) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId,  '9' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=9 GROUP BY customerId, subYearMonth, subjectId) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId,  '10' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=10 GROUP BY customerId, subYearMonth, subjectId) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId,  '11' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=11 GROUP BY customerId, subYearMonth, subjectId) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId,  '12' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=12 GROUP BY customerId, subYearMonth, subjectId)) a) t2 ON t1.customerId = t2.customerId AND t1.subYearMonth = t2.yyyy AND t1.subjectId = t2.subjectId AND t1.subMonth = t2.subMonth SET t1.debitTotalOcc = t2.debitTotalOcc, t1.creditTotalOcc = t2.creditTotalOcc WHERE t1.customerId = {customerId} AND t1.subYearMonth = {yyyy} 
#\u66F4\u65B0fin_account\u8868 \u671F\u521D \u671F\u672B
other.AU000007=UPDATE temp_faith.fin_account SET debitRemain = {debitRemain}, creditRemain = {creditRemain}, debitBalance = {debitBalance}, creditBalance = {creditBalance}, remain = {remain}, balance = {balance} WHERE customerId = {customerId} AND subYearMonth = {yyyy} AND subMonth = {subMonth} AND subjectId = {subjectId}
#\u66F4\u65B0fin_accountall\u8868
other.AU000008=UPDATE temp_faith.fin_accountall SET direction = {direction}, debitRemain = {debitRemain}, creditRemain = {creditRemain}, debitTotalOcc = {debitTotalOcc}, creditTotalOcc = {creditTotalOcc}, debitBalance = {debitBalance}, creditBalance = {creditBalance}, debitRemainF = {debitRemainF}, creditRemainF = {creditRemainF}, debitTotalOccF = {debitTotalOccF}, creditTotalOccF = {creditTotalOccF}, debitBalanceF = {debitBalanceF}, creditBalanceF = {creditBalanceF} WHERE customerId = {customerId} AND subYearMonth = {yyyy} AND subjectId = {subjectId} AND dataName = {currency}
#\u66F4\u65B0fin_accountall\u8868  \u53D1\u751F\u989D  \u7ED3\u8F6C,\u5254\u9664\u7ED3\u8F6C
other.AU000009=UPDATE temp_faith.fin_accountall SET debitOcc = {debitOcc}, creditOcc = {creditOcc}, debitOccNoTran = {debitOccNoTran}, creditOccNoTran = {creditOccNoTran}, tranDebitOcc = {tranDebitOcc}, tranCreditOcc = {tranCreditOcc}, debitOccF = {debitOccF}, creditOccF = {creditOccF}, debitOccNoTranF = {debitOccNoTranF}, creditOccNoTranF = {creditOccNoTranF}, tranDebitOccF = {tranDebitOccF}, tranCreditOccF = {tranCreditOccF}, isLeaf1 = {isLeaf}, level1 = {level0} WHERE customerId = {customerId} AND subYearMonth = {yyyy} AND subMonth = {subMonth} AND subjectId = {subjectId} AND dataName = {currency}
#\u66F4\u65B0fin_accountall\u8868  \u7D2F\u8BA1\u53D1\u751F\u989D
other.AU000010=UPDATE temp_faith.fin_accountall t1 INNER JOIN (SELECT customerId, yyyy, subjectId, subMonth, dataName, debitTotalOcc, creditTotalOcc, debitTotalOccF, creditTotalOccF FROM ((SELECT customerId, subYearMonth AS yyyy, subjectId, '1' AS subMonth, dataName, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=1 GROUP BY customerId, subYearMonth, subjectId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId, '2' AS subMonth, dataName, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=2 GROUP BY customerId, subYearMonth, subjectId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId, '3' AS subMonth, dataName, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=3 GROUP BY customerId, subYearMonth, subjectId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId, '4' AS subMonth, dataName, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=4 GROUP BY customerId, subYearMonth, subjectId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId, '5' AS subMonth, dataName, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=5 GROUP BY customerId, subYearMonth, subjectId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId, '6' AS subMonth, dataName, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=6 GROUP BY customerId, subYearMonth, subjectId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId, '7' AS subMonth, dataName, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=7 GROUP BY customerId, subYearMonth, subjectId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId, '8' AS subMonth, dataName, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=8 GROUP BY customerId, subYearMonth, subjectId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId, '9' AS subMonth, dataName, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=9 GROUP BY customerId, subYearMonth, subjectId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId, '10' AS subMonth, dataName, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=10 GROUP BY customerId, subYearMonth, subjectId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId, '11' AS subMonth, dataName, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=11 GROUP BY customerId, subYearMonth, subjectId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, subjectId, '12' AS subMonth, dataName, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=12 GROUP BY customerId, subYearMonth, subjectId, dataName)) a) t2 ON t1.customerId = t2.customerId AND t1.subYearMonth = t2.yyyy AND t1.subjectId = t2.subjectId AND t1.dataName = t2.dataName AND t1.subMonth = t2.subMonth SET t1.debitTotalOcc = t2.debitTotalOcc, t1.creditTotalOcc = t2.creditTotalOcc, t1.debitTotalOccF = t2.debitTotalOccF, t1.creditTotalOccF = t2.creditTotalOccF WHERE t1.customerId = {customerId} AND t1.subYearMonth = {yyyy} 
#\u66F4\u65B0fin_accountall\u8868  \u671F\u521D \u671F\u672B
other.AU000011=UPDATE temp_faith.fin_accountall SET debitRemain = {debitRemain}, creditRemain = {creditRemain}, debitBalance = {debitBalance}, creditBalance = {creditBalance}, remain = {remain}, balance = {balance}, debitRemainF = {debitRemainF}, creditRemainF = {creditRemainF}, debitBalanceF = {debitBalanceF}, creditBalanceF = {creditBalanceF}, remainF = {remainF}, balanceF = {balanceF} WHERE customerId = {customerId} AND subYearMonth = {yyyy} AND subMonth = {subMonth} AND subjectId = {subjectId} AND dataName = {currency}
#\u66F4\u65B0fin_account\u8868 \u671F\u521D \u671F\u672B
other.AU000012=UPDATE temp_faith.fin_account a LEFT JOIN(SELECT subjectId,direction,IF(direction=1,debitRemain-creditRemain,creditRemain-debitRemain) AS remain,IF(direction=1,debitOcc-creditOcc,creditOcc-debitOcc) AS occ,IF(direction=1,(debitRemain-creditRemain)+(debitOcc-creditOcc),(creditRemain-debitRemain)+(creditOcc-debitOcc)) AS balance FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth={subMonth} AND isLeaf1={isLeaf}) b ON b.subjectId=a.subjectId SET a.remain=b.remain,a.balance=b.balance,a.debitBalance=(CASE WHEN a.direction=1 AND b.balance>=0 THEN b.balance WHEN a.direction=-1 AND b.balance<0 THEN ABS(b.balance) ELSE 0 END),a.creditBalance=(CASE WHEN a.direction=1 AND b.balance<0 THEN ABS(b.balance) WHEN a.direction=-1 AND b.balance>=0 THEN b.balance ELSE 0 END) WHERE a.customerId={customerId} AND a.subYearMonth={yyyy} AND a.subMonth={subMonth} AND a.isLeaf1={isLeaf}
#\u66F4\u65B0fin_accountall\u8868 \u671F\u521D \u671F\u672B
other.AU000013=UPDATE temp_faith.fin_accountall a LEFT JOIN (SELECT subjectId,dataName,direction,IF(direction=1,debitRemain-creditRemain,creditRemain-debitRemain) AS remain,IF(direction=1,debitOcc-creditOcc,creditOcc-debitOcc) AS occ,IF(direction=1,(debitRemain-creditRemain)+(debitOcc-creditOcc),(creditRemain-debitRemain)+(creditOcc-debitOcc)) AS balance,IF(direction=1,debitRemainF-creditRemainF,creditRemainF-debitRemainF) AS remainF,IF(direction=1,debitOccF-creditOccF,creditOccF-debitOccF) AS occF,IF(direction=1,(debitRemainF-creditRemainF)+(debitOccF-creditOccF),(creditRemainF-debitRemainF)+(creditOccF-debitOccF)) AS balanceF FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth={subMonth} AND isLeaf1={isLeaf}) b ON b.subjectId=a.subjectId AND b.dataName=a.dataName SET a.remain=b.remain,a.balance=b.balance,a.debitBalance=(CASE WHEN a.direction=1 AND b.balance>=0 THEN b.balance WHEN a.direction=-1 AND b.balance<0 THEN ABS(b.balance) ELSE 0 END),a.creditBalance=(CASE WHEN a.direction=1 AND b.balance<0 THEN ABS(b.balance) WHEN a.direction=-1 AND b.balance>=0 THEN b.balance ELSE 0 END),a.remainF=b.remainF,a.balanceF=b.balanceF,a.debitBalanceF=(CASE WHEN a.direction=1 AND b.balanceF>=0 THEN b.balanceF WHEN a.direction=-1 AND b.balanceF<0 THEN ABS(b.balanceF) ELSE 0 END),a.creditBalanceF=(CASE WHEN a.direction=1 AND b.balanceF<0 THEN ABS(b.balanceF) WHEN a.direction=-1 AND b.balanceF>=0 THEN b.balanceF ELSE 0 END) WHERE a.customerId={customerId} AND a.subYearMonth={yyyy} AND a.subMonth={subMonth} AND a.isLeaf1={isLeaf}
#\u66F4\u65B0fin_assitementryacc\u8868 \u53D1\u751F\u989D
#other.AU000014=UPDATE temp_faith.fin_assitementryacc t1 INNER JOIN (SELECT DISTINCT a.customerId,a.yyyy,a.subjectId,a.assItemId,a.subMonth,a.debitOcc,a.creditOcc,a.debitOccF,a.creditOccF FROM ((SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},1) AS assItemId,MONTH(vchDate) AS subMonth,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},1),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},2) AS assItemId,MONTH(vchDate) AS subMonth,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},2),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},3) AS assItemId,MONTH(vchDate) AS subMonth,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},3),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},4) AS assItemId,MONTH(vchDate) AS subMonth,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},4),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},5) AS assItemId,MONTH(vchDate) AS subMonth,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},5),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},6) AS assItemId,MONTH(vchDate) AS subMonth,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOcc,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},6),MONTH(vchDate))) a WHERE a.customerId={customerId} AND a.yyyy={yyyy}) t2 ON t1.customerId = t2.customerId AND t1.subYearMonth = t2.yyyy AND t1.accId = t2.subjectId AND t1.subMonth = t2.subMonth AND t1.assItemId = t2.assItemId SET t1.debitOcc = t2.debitOcc, t1.creditOcc = t2.creditOcc WHERE t1.customerId = {customerId} AND t1.subYearMonth = {yyyy} 
other.AU000014=UPDATE temp_faith.fin_assitementryacc t1 INNER JOIN (SELECT DISTINCT a.customerId, a.yyyy, a.subjectId, a.assItemId, a.subMonth, a.debitOcc, a.creditOcc, a.debitOccF, a.creditOccF FROM ( {sqlStr} ) a WHERE a.customerId ={customerId} AND a.yyyy ={yyyy} ) t2 ON t1.customerId = t2.customerId AND t1.subYearMonth = t2.yyyy AND t1.accId = t2.subjectId AND t1.subMonth = t2.subMonth AND t1.assItemId = t2.assItemId SET t1.debitOcc = t2.debitOcc, t1.creditOcc = t2.creditOcc WHERE t1.customerId = {customerId} AND t1.subYearMonth = {yyyy} AND t1.assItemId LIKE '{assItemId}%' 
#\u66F4\u65B0fin_assitementryaccall\u8868 \u53D1\u751F\u989D
#other.AU000015=UPDATE temp_faith.fin_assitementryaccall t1 INNER JOIN (SELECT DISTINCT a.customerId,a.yyyy,a.subjectId,a.assItemId,a.subMonth,a.currency,a.debitOccF,a.creditOccF,a.debitOcc,a.creditOcc FROM ((SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},1) AS assItemId,MONTH(vchDate) AS subMonth,currency,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOccF,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOcc FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,currency,SUBSTRING_INDEX(assItemId,{subjectNameSplit},1),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},2) AS assItemId,MONTH(vchDate) AS subMonth,currency,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOccF,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOcc FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,currency,SUBSTRING_INDEX(assItemId,{subjectNameSplit},2),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},3) AS assItemId,MONTH(vchDate) AS subMonth,currency,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOccF,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOcc FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,currency,SUBSTRING_INDEX(assItemId,{subjectNameSplit},3),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},4) AS assItemId,MONTH(vchDate) AS subMonth,currency,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOccF,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOcc FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,currency,SUBSTRING_INDEX(assItemId,{subjectNameSplit},4),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},5) AS assItemId,MONTH(vchDate) AS subMonth,currency,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOccF,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOcc FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,currency,SUBSTRING_INDEX(assItemId,{subjectNameSplit},5),MONTH(vchDate)) UNION (SELECT DISTINCT customerId,yyyy,subjectId,SUBSTRING_INDEX(assItemId,{subjectNameSplit},6) AS assItemId,MONTH(vchDate) AS subMonth,currency,SUM(CASE WHEN dirction=1 THEN assItemSum ELSE 0 END) AS debitOccF,SUM(CASE WHEN dirction=-1 THEN assItemSum ELSE 0 END) AS creditOccF,SUM(CASE WHEN dirction=1 THEN currValue ELSE 0 END) AS debitOcc,SUM(CASE WHEN dirction=-1 THEN currValue ELSE 0 END) AS creditOcc FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy} GROUP BY customerId,yyyy,subjectId,currency,SUBSTRING_INDEX(assItemId,{subjectNameSplit},6),MONTH(vchDate))) a WHERE a.customerId={customerId} AND a.yyyy={yyyy} AND a.currency<>'') t2 ON t1.customerId = t2.customerId AND t1.subYearMonth = t2.yyyy AND t1.accId = t2.subjectId AND t1.subMonth = t2.subMonth AND dataName = t2.currency AND t1.assItemId = t2.assItemId SET t1.debitOcc = t2.debitOcc, t1.creditOcc = t2.creditOcc, t1.debitOccF = t2.debitOccF, t1.creditOccF = t2.creditOccF WHERE t1.customerId = {customerId} AND t1.subYearMonth = {yyyy} 
other.AU000015=UPDATE temp_faith.fin_assitementryaccall t1 INNER JOIN (SELECT DISTINCT a.customerId,a.yyyy,a.subjectId,a.assItemId,a.subMonth,a.currency,a.debitOccF,a.creditOccF,a.debitOcc,a.creditOcc FROM ( {sqlStr} ) a WHERE a.customerId={customerId} AND a.yyyy={yyyy} AND a.currency<>"") t2 ON t1.customerId = t2.customerId AND t1.subYearMonth = t2.yyyy AND t1.accId = t2.subjectId AND t1.subMonth = t2.subMonth AND dataName = t2.currency AND t1.assItemId = t2.assItemId SET t1.debitOcc = t2.debitOcc, t1.creditOcc = t2.creditOcc, t1.debitOccF = t2.debitOccF, t1.creditOccF = t2.creditOccF WHERE t1.customerId = {customerId} AND t1.subYearMonth = {yyyy} AND t1.assItemId LIKE '{assItemId}%'  
#\u66F4\u65B0fin_assitementry\u8868 \u662F\u5426\u7ED3\u8F6C
other.AU000016=UPDATE temp_faith.fin_assitementry t1 INNER JOIN (SELECT DISTINCT customerId,yyyy,subjectId,oldVoucherId,1 AS isTransferVoucher FROM temp_faith.fin_subjectentry WHERE customerId={customerId} AND yyyy={yyyy} AND isTransferVoucher=1 ORDER BY subjectId,oldVoucherId) t2 ON t1.customerId = t2.customerId AND t1.yyyy = t2.yyyy AND t1.subjectId = t2.subjectId AND t1.oldvoucherId = t2.oldVoucherId SET t1.isTransferVoucher = t2.isTransferVoucher WHERE t1.customerId = {customerId} AND t2.yyyy = {yyyy} 
#\u66F4\u65B0fin_assitem\u8868 
#other.AU000017=UPDATE temp_faith.fin_assitem t1 INNER JOIN (SELECT t1.customerId,t1.yyyy,t1.assItemId,IF(SUM(IF(t2.assItemId IS NULL,0,1))>0,0,1) AS isLeaf FROM temp_faith.fin_assitem t1 LEFT JOIN temp_faith.fin_assitem t2 ON t1.customerId=t2.customerId AND t1.yyyy=t2.yyyy AND t2.assItemId LIKE CONCAT(t1.assItemId,'{subjectNameSplit}','%') WHERE t1.customerId={customerId} AND t1.yyyy={yyyy} GROUP BY t1.customerId,t1.yyyy,t1.assItemId) t2 ON t1.customerId = t2.customerId AND t1.yyyy = t2.yyyy AND t1.assItemId = t2.assItemId SET t1.isLeaf = t2.isLeaf WHERE t1.customerId = {customerId} AND t1.yyyy = {yyyy}
other.AU000017=UPDATE temp_faith.fin_assitem a LEFT JOIN (SELECT customerId,yyyy,assItemId,NOT EXISTS (SELECT DISTINCT assItemId FROM temp_faith.fin_assitem t2 WHERE t2.customerId={customerId} AND t2.yyyy={yyyy} AND t2.assItemId LIKE CONCAT(t1.assItemId,'{subjectNameSplit}%')) AS isLeaf FROM temp_faith.fin_assitem t1 WHERE t1.customerId={customerId} AND t1.yyyy={yyyy} AND t1.assItemId LIKE '{updateAssitemByAssId}%') b ON b.customerId=a.customerId AND b.yyyy=a.yyyy AND b.assItemId=a.assItemId set a.isLeaf = b.isLeaf WHERE a.customerId={customerId} AND a.yyyy={yyyy} AND a.assItemId LIKE '{updateAssitemByAssId}%';
#\u66F4\u65B0\u6838\u7B97\u4F59\u989D\u8868fin_assitementryacc
other.AU000018=UPDATE temp_faith.fin_assitementryacc t1 INNER JOIN (SELECT customerId,yyyy,accId AS subjectId,assItemId,isLeaf,level0,assItemName,assTotalName FROM temp_faith.fin_assitem WHERE customerId={customerId} AND yyyy={yyyy} AND assItemId LIKE '{assItemId}%') t2 ON t1.customerId = t2.customerId AND t1.subYearMonth = t2.yyyy AND t1.accId = t2.subjectId AND t1.assItemId = t2.assItemId SET t1.isLeaf1 = t2.isLeaf, t1.level1 = t2.level0, t1.assItemName = t2.assItemName, t1.assTotalName1 = t2.assTotalName WHERE t1.customerId = {customerId} AND t1.subYearMonth = {yyyy} AND t1.assItemId LIKE '{assItemId}%' 
#\u66F4\u65B0\u6838\u7B97\u4F59\u989D\u8868(\u5916\u5E01)fin_assitementryaccall
other.AU000019=UPDATE temp_faith.fin_assitementryaccall t1 INNER JOIN (SELECT customerId,yyyy,accId AS subjectId,assItemId,isLeaf,level0,assItemName,assTotalName FROM temp_faith.fin_assitem WHERE customerId={customerId} AND yyyy={yyyy} AND assItemId LIKE '{assItemId}%') t2 ON t1.customerId = t2.customerId AND t1.subYearMonth = t2.yyyy AND t1.accId = t2.subjectId AND t1.assItemId = t2.assItemId SET t1.isLeaf1 = t2.isLeaf, t1.level1 = t2.level0, t1.assItemName = t2.assItemName, t1.assTotalName1 = t2.assTotalName WHERE t1.customerId = {customerId} AND t1.subYearMonth = {yyyy} AND t1.assItemId LIKE '{assItemId}%' 
#\u66F4\u65B0fin_subjectentry\u8868\u5BF9\u65B9\u79D1\u76EE
other.AU000020=UPDATE temp_faith.fin_subjectentry SET debitsubjects = {debitsubjects}, creditsubjects = {creditsubjects}, drCount={drCount}, crCount={crCount}, voucherDebitOcc={voucherDebitOcc}, voucherCreditOcc={voucherCreditOcc},voucherId={voucherId} WHERE customerId = {customerId} AND yyyy = {yyyy} AND vchDate = {vchDate} AND oldVoucherId = {oldVoucherId} AND typeId = {typeId}
#\u66F4\u65B0\u6838\u7B97\u4F59\u989D\u8868fin_assitementryacc
other.AU000022=UPDATE temp_faith.fin_assitementryacc t1 INNER JOIN (SELECT customerId, yyyy, subjectId, assItemId, subMonth, debitTotalOcc, creditTotalOcc FROM ((SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '1' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=1 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '2' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=2 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '3' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=3 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '4' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=4 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '5' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=5 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '6' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=6 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '7' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=7 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '8' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=8 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '9' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=9 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '10' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=10 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '11' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=11 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '12' AS subMonth, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=12 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId)) a) t2 ON t1.customerId = t2.customerId AND t1.subYearMonth = t2.yyyy AND t1.accId = t2.subjectId AND t1.assItemId = t2.assItemId AND t1.subMonth = t2.subMonth SET t1.debitTotalOcc = t2.debitTotalOcc, t1.creditTotalOcc = t2.creditTotalOcc WHERE t1.customerId = {customerId} AND t1.subYearMonth = {yyyy} AND t1.assItemId LIKE '{assItemId}%'
#\u66F4\u65B0\u6838\u7B97\u4F59\u989D\u8868fin_assitementryaccall
other.AU000023=UPDATE temp_faith.fin_assitementryaccall t1 INNER JOIN (SELECT customerId, yyyy, subjectId, assItemId, subMonth, currency, debitTotalOcc, creditTotalOcc, debitTotalOccF, creditTotalOccF FROM ((SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '1' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=1 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '2' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=2 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '3' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=3 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '4' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=4 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '5' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=5 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '6' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=6 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '7' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=7 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '8' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=8 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '9' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=9 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '10' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=10 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '11' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=11 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId, dataName) UNION (SELECT customerId, subYearMonth AS yyyy, accId AS subjectId, assItemId, '12' AS subMonth, dataName AS currency, SUM(debitOcc) AS debitTotalOcc, SUM(creditOcc) AS creditTotalOcc, SUM(debitOccF) AS debitTotalOccF, SUM(creditOccF) AS creditTotalOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth<=12 AND assItemId LIKE '{assItemId}%' GROUP BY customerId, subYearMonth, accId, assItemId, dataName)) a) t2 ON t1.customerId = t2.customerId AND t1.subYearMonth = t2.yyyy AND t1.accId = t2.subjectId AND t1.assItemId = t2.assItemId AND t1.subMonth = t2.subMonth AND t1.dataName = t2.currency SET t1.debitTotalOcc = t2.debitTotalOcc, t1.creditTotalOcc = t2.creditTotalOcc, t1.debitTotalOccF = t2.debitTotalOccF, t1.creditTotalOccF = t2.creditTotalOccF WHERE t1.customerId = {customerId} AND t1.subYearMonth = {yyyy} AND t1.assItemId LIKE '{assItemId}%' 
#\u66F4\u65B0fin_subjectentry\u8868 drCount crCount voucherDebitOcc voucherCreditOcc
other.AU000024=UPDATE temp_faith.fin_subjectentry SET drCount={drCount}, crCount={crCount}, voucherDebitOcc={voucherDebitOcc}, voucherCreditOcc={voucherCreditOcc} WHERE customerId = {customerId} AND yyyy = {yyyy} AND vchDate = {vchDate} AND oldVoucherId = {oldVoucherId}
#\u66F4\u65B0fin_subjectentry\u8868\u5BF9\u65B9\u79D1\u76EE(\u65B0)
other.AU000025=UPDATE temp_faith.fin_subjectentry SET oppositeAccountTop = CASE  autoId  {oppositeAccountTop}  END, oppositeAccountLast = CASE  autoId  {oppositeAccountLast}  END,serail = CASE  autoId  {serail}  END WHERE customerId = {customerId} AND yyyy = {yyyy} AND autoId IN ({autoId}) 
#\u66F4\u65B0fin_subjectentry\u8868 isTransferVoucher
other.AU000026=UPDATE temp_faith.fin_subjectentry SET isTransferVoucher = 1 WHERE autoId IN (SELECT * FROM (SELECT autoId FROM temp_faith.fin_subjectentry WHERE customerId={customerId} AND yyyy={yyyy} AND voucherId IN (SELECT voucherId FROM temp_faith.fin_subjectentry WHERE subjectname1 LIKE '\u672A\u5206\u914D\u5229\u6DA6%' AND customerId={customerId} AND yyyy={yyyy}) AND voucherId NOT IN (SELECT voucherId FROM temp_faith.fin_subjectentry WHERE subjectFullName1 LIKE '\u672C\u5E74\u5229\u6DA6%' AND customerId={customerId} AND yyyy={yyyy}) AND subjectname1 NOT LIKE '\u672A\u5206\u914D\u5229\u6DA6%') temp)
#\u66F4\u65B0\u5E74\u5EA6\u4F59\u989D\u8868\u671F\u521D\u671F\u672B
other.AU000028=UPDATE temp_faith.fin_accpkgsubject SET remain = (SELECT remain FROM temp_faith.fin_account where customerId = {customerId} and subYearMonth = {yyyy} and subMonth = 12 and fin_account.subjectId = fin_accpkgsubject.subjectId),balance = (SELECT IF(direction = 1,balance, 0 - balance) FROM temp_faith.fin_account where customerId = {customerId} and subYearMonth = {yyyy} and subMonth = 12 and fin_account.subjectId = fin_accpkgsubject.subjectId) WHERE customerId = {customerId} and yyyy = {yyyy}
#\u66F4\u65B0fin_assitementryacc\u8868 \u671F\u521D \u671F\u672B
other.AU000029=UPDATE temp_faith.fin_assitementryacc a LEFT JOIN(SELECT accId,assItemId,direction,IF(direction=1,debitRemain-creditRemain,creditRemain-debitRemain) AS remain,IF(direction=1,debitOcc-creditOcc,creditOcc-debitOcc) AS occ,IF(direction=1,(debitRemain-creditRemain)+(debitOcc-creditOcc),(creditRemain-debitRemain)+(creditOcc-debitOcc)) AS balance FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth={subMonth} AND isLeaf1={isLeaf} AND assItemId LIKE '{assItemId}%') b ON b.accId=a.accId AND b.assItemId=a.assItemId SET a.remain=b.remain,a.balance=b.balance,a.debitBalance=(CASE WHEN a.direction=1 AND b.balance>=0 THEN b.balance WHEN a.direction=-1 AND b.balance<0 THEN ABS(b.balance) ELSE 0 END),a.creditBalance=(CASE WHEN a.direction=1 AND b.balance<0 THEN ABS(b.balance) WHEN a.direction=-1 AND b.balance>=0 THEN b.balance ELSE 0 END) WHERE a.customerId={customerId} AND a.subYearMonth={yyyy} AND a.subMonth={subMonth} AND a.isLeaf1={isLeaf} AND a.assItemId LIKE '{assItemId}%'
#\u66F4\u65B0fin_assitementryacc\u8868 \u671F\u521D \u671F\u672B
#other.AU000030=UPDATE temp_faith.fin_assitementryacc SET debitRemain = {debitRemain}, creditRemain = {creditRemain}, debitBalance = {debitBalance}, creditBalance = {creditBalance}, remain = {remain}, balance = {balance} WHERE customerId = {customerId} AND subYearMonth = {yyyy} AND subMonth = {subMonth} AND accId = {subjectId} AND assItemId = {assItemId}
other.AU000030=UPDATE temp_faith.fin_assitementryacc a LEFT JOIN ( SELECT customerId,subYearMonth,accId,subMonth,'{assItemId}' AS assItemId, SUM(debitRemain) AS debitRemain, SUM(creditRemain) AS creditRemain, SUM(remain) AS remain, SUM(debitBalance) AS debitBalance, SUM(creditBalance) AS creditBalance, SUM(balance) AS balance FROM temp_faith.fin_assitementryacc WHERE isLeaf1 = 1 AND customerId ={customerId} AND subYearMonth ={yyyy} AND accid ='{subjectId}' AND assItemId <> '{assItemId}' AND assItemId LIKE '{assItemId}%' AND subMonth ={subMonth} ) b ON b.customerId=a.customerId AND b.subYearMonth=a.subYearMonth AND b.accId=a.accId AND b.subMonth=a.subMonth SET a.debitRemain = b.debitRemain, a.creditRemain = b.creditRemain, a.debitBalance = b.debitBalance, a.creditBalance = b.creditBalance, a.remain = b.remain, a.balance = b.balance WHERE a.customerId = {customerId} AND a.subYearMonth = {yyyy} AND a.accId = '{subjectId}' AND a.subMonth = {subMonth} AND a.assItemId = '{assItemId}'
#\u66F4\u65B0fin_assitementryaccall\u8868 \u671F\u521D \u671F\u672B
other.AU000031=UPDATE temp_faith.fin_assitementryaccall a LEFT JOIN(SELECT accId,assItemId,direction,IF(direction=1,debitRemain-creditRemain,creditRemain-debitRemain) AS remain,IF(direction=1,debitOcc-creditOcc,creditOcc-debitOcc) AS occ,IF(direction=1,(debitRemain-creditRemain)+(debitOcc-creditOcc),(creditRemain-debitRemain)+(creditOcc-debitOcc)) AS balance,IF(direction=1,debitRemainF-creditRemainF,creditRemainF-debitRemainF) AS remainF,IF(direction=1,debitOccF-creditOccF,creditOccF-debitOccF) AS occF,IF(direction=1,(debitRemainF-creditRemainF)+(debitOccF-creditOccF),(creditRemainF-debitRemainF)+(creditOccF-debitOccF)) AS balanceF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND subMonth={subMonth} AND isLeaf1={isLeaf} AND assItemId LIKE '{assItemId}%') b ON b.accId=a.accId AND b.assItemId=a.assItemId SET a.remain=b.remain,a.balance=b.balance,a.debitBalance=(CASE WHEN a.direction=1 AND b.balance>=0 THEN b.balance WHEN a.direction=-1 AND b.balance<0 THEN ABS(b.balance) ELSE 0 END),a.creditBalance=(CASE WHEN a.direction=1 AND b.balance<0 THEN ABS(b.balance) WHEN a.direction=-1 AND b.balance>=0 THEN b.balance ELSE 0 END),a.remainF=b.remainF,a.balanceF=b.balanceF,a.debitBalanceF=(CASE WHEN a.direction=1 AND b.balanceF>=0 THEN b.balanceF WHEN a.direction=-1 AND b.balanceF<0 THEN ABS(b.balanceF) ELSE 0 END),a.creditBalanceF=(CASE WHEN a.direction=1 AND b.balanceF<0 THEN ABS(b.balanceF) WHEN a.direction=-1 AND b.balanceF>=0 THEN b.balanceF ELSE 0 END) WHERE a.customerId={customerId} AND a.subYearMonth={yyyy} AND a.subMonth={subMonth} AND a.isLeaf1={isLeaf} AND a.assItemId LIKE '{assItemId}%'
#\u66F4\u65B0fin_assitementryaccall\u8868  \u671F\u521D \u671F\u672B
#other.AU000032=UPDATE temp_faith.fin_assitementryaccall SET debitRemain = {debitRemain}, creditRemain = {creditRemain}, debitBalance = {debitBalance}, creditBalance = {creditBalance}, remain = {remain}, balance = {balance}, debitRemainF = {debitRemainF}, creditRemainF = {creditRemainF}, debitBalanceF = {debitBalanceF}, creditBalanceF = IF({creditBalanceF} is null,creditTotalOccF,{creditBalanceF}), remainF = {remainF}, balanceF = {balanceF} WHERE customerId = {customerId} AND subYearMonth = {yyyy} AND subMonth = {subMonth} AND accId = {subjectId} AND assItemId = {assItemId} AND dataName = {currency}
other.AU000032=UPDATE temp_faith.fin_assitementryaccall a LEFT JOIN ( SELECT customerId,subYearMonth,accId,subMonth,dataName,'{assItemId}' AS assItemId, SUM(debitRemain) AS debitRemain, SUM(creditRemain) AS creditRemain, SUM(remain) AS remain, SUM(debitBalance) AS debitBalance, SUM(creditBalance) AS creditBalance, SUM(balance) AS balance, SUM(debitRemainF) AS debitRemainF, SUM(creditRemainF) AS creditRemainF, SUM(remainF) AS remainF, SUM(debitBalanceF) AS debitBalanceF, SUM(creditBalanceF) AS creditBalanceF, SUM(balanceF) AS balanceF FROM temp_faith.fin_assitementryaccall WHERE isLeaf1 = 1 AND customerId ={customerId} AND subYearMonth ={yyyy} AND accid ='{subjectId}' AND assItemId <> '{assItemId}' AND assItemId LIKE '{assItemId}%' AND subMonth ={subMonth} AND dataName = 'currency') b ON b.customerId=a.customerId AND b.subYearMonth=a.subYearMonth AND b.accId=a.accId AND b.subMonth=a.subMonth AND b.dataName = a.dataName SET a.debitRemain = b.debitRemain, a.creditRemain = b.creditRemain, a.debitBalance = b.debitBalance, a.creditBalance = b.creditBalance, a.remain = b.remain, a.balance = b.balance WHERE a.customerId = {customerId} AND a.subYearMonth = {yyyy} AND a.accId = '{subjectId}' AND a.subMonth = {subMonth} AND a.assItemId = '{assItemId}' AND a.dataName = '{currency}'
#\u66F4\u65B0fin_assitem\u8868 \u671F\u521D \u671F\u672B
other.AU000033=UPDATE temp_faith.fin_assitem SET direction = {direction}, debitRemain = {debitRemain}, creditRemain = {creditRemain}, debitBalance = {debitBalance}, creditBalance = {creditBalance}, remain = {remain}, balance = {balance} WHERE customerId = {customerId} AND yyyy = {yyyy} AND accId = {subjectId} AND assItemId = {assItemId}
#\u66F4\u65B0fin_assitem\u8868 remain banance
other.AU000034=UPDATE temp_faith.fin_assitem t1 INNER JOIN (SELECT a.customerId,a.yyyy,a.accId AS subjectId,a.assItemId,a.assItemName,a.assTotalName,a.isLeaf,t.remain,t.balance FROM temp_faith.fin_assitem a LEFT JOIN temp_faith.fin_assitementryacc t ON a.customerId = t.customerId AND a.yyyy=t.subYearMonth AND a.accId = t.accId AND a.assItemId = t.assItemId AND t.subMonth = 12 WHERE a.customerId={customerId} AND a.yyyy={yyyy}) t2 ON t1.customerId = t2.customerId AND t1.yyyy = t2.yyyy AND t1.accId = t2.subjectId AND t1.assItemId = t2.assItemId SET t1.remain = t2.remain, t1.balance = t2.balance WHERE t1.customerId = {customerId} AND t1.yyyy = {yyyy}
#\u66F4\u65B0fin_assitementryacc\u8868 \u671F\u521D \u671F\u672B
other.AU000035=UPDATE temp_faith.fin_assitementryacc t1 INNER JOIN (SELECT customerId,subYearMonth,subjectId,assItemId,subMonth,debitRemain,creditRemain,remain,debitBalance,creditBalance,IF (direction=1,(debitRemain-creditRemain)+(debitOcc-creditOcc),(creditRemain-debitRemain)+(creditOcc-debitOcc)) AS balance FROM (SELECT customerId,subYearMonth,subjectId,assItemId,subMonth,direction,debitRemain,creditRemain,IF (direction=1,debitRemain-creditRemain,creditRemain-debitRemain) AS remain,debitOcc,creditOcc,CASE WHEN direction=1 AND (debitRemain-creditRemain)+(debitOcc-creditOcc)>=0 THEN (debitRemain-creditRemain)+(debitOcc-creditOcc) WHEN direction=-1 AND (creditRemain-debitRemain)+(creditOcc-debitOcc)<0 THEN ABS((creditRemain-debitRemain)+(creditOcc-debitOcc)) ELSE 0 END AS debitBalance,CASE WHEN direction=1 AND (debitRemain-creditRemain)+(debitOcc-creditOcc)<0 THEN ABS((debitRemain-creditRemain)+(debitOcc-creditOcc)) WHEN direction=-1 AND (creditRemain-debitRemain)+(creditOcc-debitOcc)>=0 THEN (creditRemain-debitRemain)+(creditOcc-debitOcc) ELSE 0 END AS creditBalance FROM (SELECT customerId,subYearMonth,accId AS subjectId ,assItemId,{subMonth} AS subMonth,direction,SUM(CASE WHEN subMonth={param1} THEN debitBalance ELSE 0 END) AS debitRemain,SUM(CASE WHEN subMonth={param1} THEN creditBalance ELSE 0 END) AS creditRemain,SUM(CASE WHEN subMonth={subMonth} THEN debitOcc ELSE 0 END) AS debitOcc,SUM(CASE WHEN subMonth={subMonth} THEN creditOcc ELSE 0 END) AS creditOcc FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy} AND isLeaf1={isLeaf} AND assItemId LIKE '{assItemId}%' AND subMonth<={subMonth} GROUP BY customerId,subYearMonth,subjectId,assItemId) a) a) t2 ON t1.customerId=t2.customerId AND t1.subYearMonth=t2.subYearMonth AND t1.subMonth=t2.subMonth AND t1.accId=t2.subjectId AND t1.assItemId = t2.assItemId SET t1.debitRemain=t2.debitRemain,t1.creditRemain=t2.creditRemain,t1.debitBalance=t2.debitBalance,t1.creditBalance=t2.creditBalance,t1.remain=t2.remain,t1.balance=t2.balance WHERE t1.customerId={customerId} AND t1.subYearMonth={yyyy} AND t1.subMonth={subMonth} AND t1.isLeaf1={isLeaf} AND t1.assItemId LIKE '{assItemId}%'
#\u66F4\u65B0fin_assitementryaccall\u8868  \u671F\u521D \u671F\u672B
other.AU000036=UPDATE temp_faith.fin_assitementryaccall t1 INNER JOIN(SELECT customerId,subYearMonth,subjectId,assItemId,dataName,subMonth,debitRemain,creditRemain,remain,debitBalance,creditBalance, IF(direction=1,(debitRemain-creditRemain)+(debitOcc-creditOcc),(creditRemain-debitRemain)+(creditOcc-debitOcc)) AS balance, debitRemainF,creditRemainF,remainF,debitBalanceF,creditBalanceF,IF(direction=1,(debitRemainF-creditRemainF)+(debitOccF-creditOccF),(creditRemainF-debitRemainF)+(creditOccF-debitOccF)) AS balanceF FROM (SELECT customerId,subYearMonth,subjectId,assItemId,dataName,subMonth,direction,debitRemain,creditRemain,IF(direction=1,debitRemain-creditRemain,creditRemain-debitRemain) AS remain,debitOcc,creditOcc, CASE WHEN direction=1 AND (debitRemain-creditRemain)+(debitOcc-creditOcc)>=0 THEN (debitRemain-creditRemain)+(debitOcc-creditOcc) WHEN direction=-1 AND (creditRemain-debitRemain)+(creditOcc-debitOcc)<0 THEN ABS((creditRemain-debitRemain)+(creditOcc-debitOcc)) ELSE 0 END AS debitBalance, CASE WHEN direction=1 AND (debitRemain-creditRemain)+(debitOcc-creditOcc)<0 THEN ABS((debitRemain-creditRemain)+(debitOcc-creditOcc)) WHEN direction=-1 AND (creditRemain-debitRemain)+(creditOcc-debitOcc)>=0 THEN (creditRemain-debitRemain)+(creditOcc-debitOcc) ELSE 0 END AS creditBalance, debitRemainF,creditRemainF,IF(direction=1,debitRemainF-creditRemainF,creditRemainF-debitRemainF) AS remainF,debitOccF,creditOccF, CASE WHEN direction=1 AND (debitRemainF-creditRemainF)+(debitOccF-creditOccF)>=0 THEN (debitRemainF-creditRemainF)+(debitOccF-creditOccF) WHEN direction=-1 AND (creditRemainF-debitRemainF)+(creditOccF-debitOccF)<0 THEN ABS((creditRemainF-debitRemainF)+(creditOccF-debitOccF)) ELSE 0 END AS debitBalanceF, CASE WHEN direction=1 AND (debitRemainF-creditRemainF)+(debitOccF-creditOccF)<0 THEN ABS((debitRemainF-creditRemainF)+(debitOccF-creditOccF)) WHEN direction=-1 AND (creditRemainF-debitRemainF)+(creditOccF-debitOccF)>=0 THEN (creditRemainF-debitRemainF)+(creditOccF-debitOccF) ELSE 0 END AS creditBalanceF FROM (SELECT customerId,subYearMonth,accId AS subjectId,assItemId,dataName,{subMonth} AS subMonth,direction,SUM(CASE WHEN subMonth={param1} THEN debitBalance ELSE 0 END) AS debitRemain,SUM(CASE WHEN subMonth={param1} THEN creditBalance ELSE 0 END) AS creditRemain,SUM(CASE WHEN subMonth={subMonth} THEN debitOcc ELSE 0 END) AS debitOcc,SUM(CASE WHEN subMonth={subMonth} THEN creditOcc ELSE 0 END) AS creditOcc,SUM(CASE WHEN subMonth={param1} THEN debitBalanceF ELSE 0 END) AS debitRemainF,SUM(CASE WHEN subMonth={param1} THEN creditBalanceF ELSE 0 END) AS creditRemainF,SUM(CASE WHEN subMonth={subMonth} THEN debitOccF ELSE 0 END) AS debitOccF,SUM(CASE WHEN subMonth={subMonth} THEN creditOccF ELSE 0 END) AS creditOccF FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy} AND isLeaf1={isLeaf} AND subMonth<={subMonth} AND assItemId LIKE '{assItemId}%' GROUP BY customerId,subYearMonth,subjectId,assItemId,dataName) a) a) t2 ON t1.customerId=t2.customerId AND t1.subYearMonth=t2.subYearMonth AND t1.subMonth=t2.subMonth AND t1.accId=t2.subjectId AND t1.assItemId=t2.assItemId AND t1.dataName=t2.dataName SET t1.debitRemain=t2.debitRemain,t1.creditRemain=t2.creditRemain,t1.debitBalance=t2.debitBalance,t1.creditBalance=t2.creditBalance,t1.remain=t2.remain,t1.balance=t2.balance,t1.debitRemainF=t2.debitRemainF,t1.creditRemainF=t2.creditRemainF,t1.debitBalanceF=t2.debitBalanceF,t1.creditBalanceF=t2.creditBalanceF,t1.remainF=t2.remainF,t1.balanceF=t2.balanceF WHERE t1.customerId={customerId} AND t1.subYearMonth={yyyy} AND t1.subMonth={subMonth} AND t1.isLeaf1={isLeaf} AND t1.assItemId LIKE '{assItemId}%'
#\u66F4\u65B0fin_account\u8868 \u671F\u521D \u671F\u672B
other.AU000037=UPDATE temp_faith.fin_account t1 INNER JOIN(SELECT customerId,subYearMonth,subjectId,subMonth,debitRemain,creditRemain,remain,debitBalance,creditBalance,IF(direction=1,(debitRemain-creditRemain)+(debitOcc-creditOcc),(creditRemain-debitRemain)+(creditOcc-debitOcc)) AS balance FROM (SELECT customerId,subYearMonth,subjectId,subMonth,direction,debitRemain,creditRemain,IF(direction=1,debitRemain-creditRemain,creditRemain-debitRemain) AS remain,debitOcc,creditOcc,CASE WHEN direction=1 AND (debitRemain-creditRemain)+(debitOcc-creditOcc)>=0 THEN (debitRemain-creditRemain)+(debitOcc-creditOcc) WHEN direction=-1 AND (creditRemain-debitRemain)+(creditOcc-debitOcc)<0 THEN ABS((creditRemain-debitRemain)+(creditOcc-debitOcc)) ELSE 0 END AS debitBalance,CASE WHEN direction=1 AND (debitRemain-creditRemain)+(debitOcc-creditOcc)<0 THEN ABS((debitRemain-creditRemain)+(debitOcc-creditOcc)) WHEN direction=-1 AND (creditRemain-debitRemain)+(creditOcc-debitOcc)>=0 THEN (creditRemain-debitRemain)+(creditOcc-debitOcc) ELSE 0 END AS creditBalance FROM (SELECT customerId,subYearMonth,subjectId,{subMonth} AS subMonth,direction,SUM(CASE WHEN subMonth={param1} THEN debitBalance ELSE 0 END) AS debitRemain,SUM(CASE WHEN subMonth={param1} THEN creditBalance ELSE 0 END) AS creditRemain,SUM(CASE WHEN subMonth={subMonth} THEN debitOcc ELSE 0 END) AS debitOcc,SUM(CASE WHEN subMonth={subMonth} THEN creditOcc ELSE 0 END) AS creditOcc FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy} AND isLeaf1={isLeaf} AND subMonth<={subMonth} GROUP BY customerId,subYearMonth,subjectId) a) a) t2 ON t1.customerId=t2.customerId AND t1.subYearMonth=t2.subYearMonth AND t1.subMonth=t2.subMonth AND t1.subjectId=t2.subjectId SET t1.debitRemain=t2.debitRemain,t1.creditRemain=t2.creditRemain,t1.debitBalance=t2.debitBalance,t1.creditBalance=t2.creditBalance,t1.remain=t2.remain,t1.balance=t2.balance WHERE t1.customerId={customerId} AND t1.subYearMonth={yyyy} AND t1.subMonth={subMonth} AND isLeaf1={isLeaf}
#\u66F4\u65B0fin_accountall\u8868  \u671F\u521D \u671F\u672B
other.AU000038=UPDATE temp_faith.fin_accountall t1 INNER JOIN(SELECT customerId,subYearMonth,subjectId,dataName,subMonth,debitRemain,creditRemain,remain,debitBalance,creditBalance,IF(direction=1,(debitRemain-creditRemain)+(debitOcc-creditOcc),(creditRemain-debitRemain)+(creditOcc-debitOcc)) AS balance,debitRemainF,creditRemainF,remainF,debitBalanceF,creditBalanceF,IF(direction=1,(debitRemainF-creditRemainF)+(debitOccF-creditOccF),(creditRemainF-debitRemainF)+(creditOccF-debitOccF)) AS balanceF FROM (SELECT customerId,subYearMonth,subjectId,dataName,subMonth,direction,debitRemain,creditRemain,IF(direction=1,debitRemain-creditRemain,creditRemain-debitRemain) AS remain,debitOcc,creditOcc,CASE WHEN direction=1 AND (debitRemain-creditRemain)+(debitOcc-creditOcc)>=0 THEN (debitRemain-creditRemain)+(debitOcc-creditOcc) WHEN direction=-1 AND (creditRemain-debitRemain)+(creditOcc-debitOcc)<0 THEN ABS((creditRemain-debitRemain)+(creditOcc-debitOcc)) ELSE 0 END AS debitBalance,CASE WHEN direction=1 AND (debitRemain-creditRemain)+(debitOcc-creditOcc)<0 THEN ABS((debitRemain-creditRemain)+(debitOcc-creditOcc)) WHEN direction=-1 AND (creditRemain-debitRemain)+(creditOcc-debitOcc)>=0 THEN (creditRemain-debitRemain)+(creditOcc-debitOcc) ELSE 0 END AS creditBalance, debitRemainF,creditRemainF,IF(direction=1,debitRemainF-creditRemainF,creditRemainF-debitRemainF) AS remainF,debitOccF,creditOccF,CASE WHEN direction=1 AND (debitRemainF-creditRemainF)+(debitOccF-creditOccF)>=0 THEN (debitRemainF-creditRemainF)+(debitOccF-creditOccF) WHEN direction=-1 AND (creditRemainF-debitRemainF)+(creditOccF-debitOccF)<0 THEN ABS((creditRemainF-debitRemainF)+(creditOccF-debitOccF)) ELSE 0 END AS debitBalanceF,CASE WHEN direction=1 AND (debitRemainF-creditRemainF)+(debitOccF-creditOccF)<0 THEN ABS((debitRemainF-creditRemainF)+(debitOccF-creditOccF)) WHEN direction=-1 AND (creditRemainF-debitRemainF)+(creditOccF-debitOccF)>=0 THEN (creditRemainF-debitRemainF)+(creditOccF-debitOccF) ELSE 0 END AS creditBalanceF FROM (SELECT customerId,subYearMonth,subjectId,dataName,{subMonth} AS subMonth,direction,SUM(CASE WHEN subMonth={param1} THEN debitBalance ELSE 0 END) AS debitRemain,SUM(CASE WHEN subMonth={param1} THEN creditBalance ELSE 0 END) AS creditRemain,SUM(CASE WHEN subMonth={subMonth} THEN debitOcc ELSE 0 END) AS debitOcc,SUM(CASE WHEN subMonth={subMonth} THEN creditOcc ELSE 0 END) AS creditOcc,SUM(CASE WHEN subMonth={param1} THEN debitBalanceF ELSE 0 END) AS debitRemainF,SUM(CASE WHEN subMonth={param1} THEN creditBalanceF ELSE 0 END) AS creditRemainF,SUM(CASE WHEN subMonth={subMonth} THEN debitOccF ELSE 0 END) AS debitOccF,SUM(CASE WHEN subMonth={subMonth} THEN creditOccF ELSE 0 END) AS creditOccF FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy} AND isLeaf1={isLeaf} AND subMonth<={subMonth} GROUP BY customerId,subYearMonth,subjectId,dataName) a) a) t2 ON t1.customerId=t2.customerId AND t1.subYearMonth=t2.subYearMonth AND t1.subMonth=t2.subMonth AND t1.subjectId=t2.subjectId AND t1.dataName=t2.dataName SET t1.debitRemain=t2.debitRemain,t1.creditRemain=t2.creditRemain,t1.debitBalance=t2.debitBalance,t1.creditBalance=t2.creditBalance,t1.remain=t2.remain,t1.balance=t2.balance,t1.debitRemainF=t2.debitRemainF,t1.creditRemainF=t2.creditRemainF,t1.debitBalanceF=t2.debitBalanceF,t1.creditBalanceF=t2.creditBalanceF,t1.remainF=t2.remainF,t1.balanceF=t2.balanceF WHERE t1.customerId={customerId} AND t1.subYearMonth={yyyy} AND t1.subMonth={subMonth} AND isLeaf1={isLeaf}
#\u66F4\u65B0fin_assitementry isTransferVoucher,voucherId
other.AU000039=UPDATE temp_faith.fin_assitementry a LEFT JOIN (SELECT DISTINCT a.customerId,a.yyyy,a.subjectId,a.oldvoucherId,a.vchDate,a.voucherId,a.isTransferVoucher FROM temp_faith.fin_subjectentry a WHERE a.customerId = {customerId} AND a.yyyy={yyyy}) b ON b.customerId=a.customerId AND b.yyyy=a.yyyy AND b.subjectId=a.subjectId AND b.vchDate=a.vchDate AND b.oldvoucherId=a.oldvoucherId SET a.voucherId = b.voucherId, a.isTransferVoucher=b.isTransferVoucher WHERE a.customerId = {customerId} AND a.yyyy={yyyy}
#\u5220\u9664\u8D26\u5957\u5BFC\u5165\u6570\u636E
other.AD000001=DELETE FROM temp_faith.fin_account WHERE customerId={customerId} AND subYearMonth={yyyy}
other.AD000002=DELETE FROM temp_faith.fin_accountall WHERE customerId={customerId} AND subYearMonth={yyyy}
other.AD000003=DELETE FROM temp_faith.fin_accpkgsubject WHERE customerId={customerId} AND yyyy={yyyy}
other.AD000004=DELETE FROM temp_faith.fin_assitem WHERE customerId={customerId} AND yyyy={yyyy}
other.AD000005=DELETE FROM temp_faith.fin_assitementry WHERE customerId={customerId} AND yyyy={yyyy}
other.AD000006=DELETE FROM temp_faith.fin_assitementryacc WHERE customerId={customerId} AND subYearMonth={yyyy}
other.AD000007=DELETE FROM temp_faith.fin_assitementryaccall WHERE customerId={customerId} AND subYearMonth={yyyy}
other.AD000008=DELETE FROM temp_faith.fin_subjectassitem WHERE customerId={customerId} AND yyyy={yyyy}
other.AD000009=DELETE FROM temp_faith.fin_subjectentry WHERE customerId={customerId} AND yyyy={yyyy}
other.AD000010=DELETE FROM temp_faith.fin_subjectvoucher WHERE customerId={customerId} AND yyyy={yyyy}

other.AD000011=DROP DATABASE IF EXISTS {dbName}

#\u63D2\u5165fin_accpkgsubject
other.AC000001=INSERT INTO temp_faith.fin_accpkgsubject (accPackageId,customerId,yyyy,subjectId,parentSubjectId,subjectName,subjectFullName,currency,level0,debitRemain,creditRemain,debitTotalOcc,creditTotalOcc,debitBalance,creditBalance,remain,balance,direction,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) VALUES ({accPackageId},{customerId},{yyyy},{subjectId},{parentSubjectId},{subjectName},{subjectFullName},{currency},{level0},{debitRemain},{creditRemain},{debitTotalOcc},{creditTotalOcc},{debitBalance},{creditBalance},{remain},{balance},{direction},{CREATION_DATE},{CREATED_BY},{LAST_UPDATE_DATE},{LAST_UPDATED_BY})
#\u63D2\u5165fin_account
other.AC000002=INSERT INTO temp_faith.fin_account (accPackageId,customerId,subjectId,accName,subYearMonth,subMonth,dataName,direction,debitRemain,creditRemain,debitTotalOcc,creditTotalOcc,debitBalance,creditBalance,subjectFullName1,subjectfullName2,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) VALUES ({accPackageId},{customerId},{subjectId},{accName},{yyyy},{subMonth},{currency},{direction},{debitRemain},{creditRemain},{debitTotalOcc},{creditTotalOcc},{debitBalance},{creditBalance},{subjectFullName1},{subjectfullName2},{CREATION_DATE},{CREATED_BY},{LAST_UPDATE_DATE},{LAST_UPDATED_BY})
#\u63D2\u5165fin_subjectentry
other.AC000003=INSERT INTO temp_faith.fin_subjectentry (accPackageId,customerId,yyyy,month,oldVoucherId,typeId,vchDate,summary,subjectId,dirction,occurValue,currRate,currValue,currency,quantity,unitPrice,unitName,subjectname1,subjectFullName1,voucherFillUser,voucherAuditUser,voucherKeepUser,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) VALUES ({accPackageId},{customerId},{yyyy},{month},{oldVoucherId},{typeId},{vchDate},{summary},{subjectId},{direction},{occurValue},{currRate},{currValue},{currency},{quantity},{unitPrice},{unitName},{subjectname1},{subjectFullName1},{voucherFillUser},{voucherAuditUser},{voucherKeepUser},{CREATION_DATE},{CREATED_BY},{LAST_UPDATE_DATE},{LAST_UPDATED_BY})
#\u63D2\u5165fin_assitementry
other.AC000004=INSERT INTO temp_faith.fin_assitementry (accPackageId,customerId,yyyy,subjectId,voucherId,oldvoucherId,vchDate,typeId,serail,assItemId,summary,dirction,assItemSum,currRate,currValue,currency,quantity,unitPrice,unitName,isTransferVoucher,property,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) VALUES ({accPackageId},{customerId},{yyyy},{subjectId},{voucherId},{oldVoucherId},{vchDate},{typeId},{serail},{assItemId},{summary},{direction},{occurValue},{currRate},{currValue},{currency},{quantity},{unitPrice},{unitName},{isTransferVoucher},{assItemName},{CREATION_DATE},{CREATED_BY},{LAST_UPDATE_DATE},{LAST_UPDATED_BY})
#\u63D2\u5165fin_accountall
other.AC000005=INSERT INTO temp_faith.fin_accountall (accPackageId,customerId,subjectId,accName,subYearMonth,subMonth,dataName,subjectFullName1,subjectfullName2,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) VALUES ({accPackageId},{customerId},{subjectId},{accName},{yyyy},{subMonth},{currency},{subjectFullName1},{subjectfullName2},{CREATION_DATE},{CREATED_BY},{LAST_UPDATE_DATE},{LAST_UPDATED_BY})
#\u63D2\u5165fin_subjectvoucher
other.AC000006=INSERT INTO temp_faith.fin_subjectvoucher (accPackageId,customerId,yyyy,month,voucherId,typeId,vchDate,fillUser,auditUser,keepUser,debitocc,creditocc,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) VALUES ({accPackageId},{customerId},{yyyy},{month},{voucherId},{typeId},{vchDate},{fillUser},{auditUser},{keepUser},{debitocc},{creditocc},{CREATION_DATE},{CREATED_BY},{LAST_UPDATE_DATE},{LAST_UPDATED_BY})
#\u63D2\u5165fin_assitem
other.AC000007=INSERT INTO temp_faith.fin_assitem (accPackageId,customerId,yyyy,accId,assItemId,parentAssItemId,debitTotalOcc,creditTotalOcc,assItemName,assTotalName,level0,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) VALUES ({accPackageId},{customerId},{yyyy},{subjectId},{assItemId},{parentAssItemId},{debitTotalOcc},{creditTotalOcc},{assItemName},{assTotalName},{level0},{CREATION_DATE},{CREATED_BY},{LAST_UPDATE_DATE},{LAST_UPDATED_BY})
#\u63D2\u5165fin_assitementryacc
other.AC000008=INSERT INTO temp_faith.fin_assitementryacc (accPackageId,customerId,accId,assItemId,subYearMonth,subMonth,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) VALUES ({accPackageId},{customerId},{subjectId},{assItemId},{yyyy},{subMonth},{CREATION_DATE},{CREATED_BY},{LAST_UPDATE_DATE},{LAST_UPDATED_BY})
#\u63D2\u5165fin_assitementryaccall
other.AC000009=INSERT INTO temp_faith.fin_assitementryaccall (accPackageId,customerId,accId,assItemId,subYearMonth,subMonth,dataName,direction,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) VALUES ({accPackageId},{customerId},{subjectId},{assItemId},{yyyy},{subMonth},{currency},{direction},{CREATION_DATE},{CREATED_BY},{LAST_UPDATE_DATE},{LAST_UPDATED_BY})
#\u63D2\u5165fin_subjectassitem
other.AC000010=INSERT INTO temp_faith.fin_subjectassitem (accPackageId,customerId,yyyy,subjectId,subjectFullName1,subjectFullName2,assitemId,assTotalName1,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) VALUES ({accPackageId},{customerId},{yyyy},{subjectId},{subjectFullName1},{subjectFullName2},{assitemId},{assTotalName},{CREATION_DATE},{CREATED_BY},{LAST_UPDATE_DATE},{LAST_UPDATED_BY})
#\u63D2\u5165fin_assitem
other.AC000011=INSERT INTO temp_faith.fin_assitem (accPackageId,customerId,yyyy,accId,assItemId,parentAssItemId,debitRemain,creditRemain,debitTotalOcc,creditTotalOcc,debitBalance,creditBalance,assItemName,assTotalName,level0,direction,balance,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) VALUES ({accPackageId},{customerId},{yyyy},{subjectId},{assItemId},{parentAssItemId},{debitRemain},{creditRemain},{debitTotalOcc},{creditTotalOcc},{debitBalance},{creditBalance},{assItemName},{assTotalName},{level0},{direction},{balance},{CREATION_DATE},{CREATED_BY},{LAST_UPDATE_DATE},{LAST_UPDATED_BY})
#\u63D2\u5165fin_assitementryacc
other.AC000012=INSERT INTO temp_faith.fin_assitementryacc (accPackageId,customerId,accId,assItemId,assItemName,subYearMonth,subMonth,debitRemain,creditRemain,debitTotalOcc,creditTotalOcc,debitBalance,creditBalance,isLeaf1,level1,assTotalName1,dataName,direction,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) VALUES ({accPackageId},{customerId},{subjectId},{assItemId},{assItemName},{yyyy},{subMonth},{debitRemain},{creditRemain},{debitTotalOcc},{creditTotalOcc},{debitBalance},{creditBalance},{isLeaf},{level0},{assTotalName},{currency},{direction},{CREATION_DATE},{CREATED_BY},{LAST_UPDATE_DATE},{LAST_UPDATED_BY})
#\u63D2\u5165fin_assitementryaccall
other.AC000013=INSERT INTO temp_faith.fin_assitementryaccall (accPackageId,customerId,accId,assItemId,assItemName,subYearMonth,subMonth,debitRemain,creditRemain,debitRemainF,creditRemainF,level1,assTotalName1,dataName,direction,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) VALUES ({accPackageId},{customerId},{subjectId},{assItemId},{assItemName},{yyyy},{subMonth},{debitRemain},{creditRemain},{debitRemainF},{creditRemainF},{level0},{assTotalName},{currency},{direction},{CREATION_DATE},{CREATED_BY},{LAST_UPDATE_DATE},{LAST_UPDATED_BY})
#\u63D2\u5165\u4F59\u989D\u8868\uFF08\u9605\u8BFB\uFF09
other.AC000014=INSERT INTO temp_faith.fin_account(accPackageId, customerId, subjectId, accName, subYearMonth, subMonth, dataName, debitRemain, creditRemain, debitOcc, creditOcc, remain, balance, debitTotalOcc, creditTotalOcc, direction, debitBalance, creditBalance, isLeaf1, level1, subjectFullName1, CREATION_DATE, CREATED_BY, LAST_UPDATE_DATE, LAST_UPDATED_BY) VALUES ({accPackageId},{customerId},{subjectId},{accName},{subYearMonth},{subMonth},{dataName},{debitRemain},{creditRemain},{debitOcc},{creditOcc},{remain},{balance},{debitTotalOcc},{creditTotalOcc},{direction},{debitBalance}, {creditBalance},{isLeaf1},{level1},{subjectFullName1},{CREATION_DATE},{CREATED_BY},{LAST_UPDATE_DATE},{LAST_UPDATED_BY});
#\u63D2\u5165\u5916\u5E01\u4F59\u989D\u8868\uFF08\u9605\u8BFB\uFF09
other.AC000015=INSERT INTO temp_faith.fin_accountall(accPackageId, customerId, subjectId, accName, subYearMonth, subMonth, dataName, debitRemain, creditRemain, debitOcc, creditOcc, remain, balance, debitTotalOcc, creditTotalOcc, direction, debitBalance, creditBalance, isLeaf1, level1, subjectFullName1, debitRemainF, creditRemainF, debitOccF, creditOccF, remainF, balanceF, debitTotalOccF, creditTotalOccF, debitBalanceF, creditBalanceF, CREATION_DATE, CREATED_BY, LAST_UPDATE_DATE, LAST_UPDATED_BY) VALUES ({accPackageId},{customerId},{subjectId},{accName},{subYearMonth},{subMonth},{dataName},{debitRemain},{creditRemain},{debitOcc},{creditOcc},{remain},{balance},{debitTotalOcc},{creditTotalOcc},{direction},{debitBalance}, {creditBalance},{isLeaf1},{level1},{subjectFullName1},{debitRemainF},{creditRemainF},{debitOccF},{creditOccF},{remainF},{balanceF},{debitTotalOccF},{creditTotalOccF},{debitBalanceF}, {creditBalanceF}, {CREATION_DATE},{CREATED_BY},{LAST_UPDATE_DATE},{LAST_UPDATED_BY});
#\u63D2\u5165\u5E74\u5EA6\u4F59\u989D\u8868
other.AC000016=INSERT INTO temp_faith.fin_accpkgsubject(accPackageId, customerId, yyyy, subjectId, parentSubjectId, subjectName, subjectFullName, currency, isLeaf, level0, debitRemain, creditRemain, debitTotalOcc, creditTotalOcc, debitBalance, creditBalance, remain, balance, direction, CREATION_DATE, CREATED_BY, LAST_UPDATE_DATE, LAST_UPDATED_BY) VALUES ({accPackageId},{customerId},{yyyy},{subjectId},{parentSubjectId},{subjectName},{subjectFullName},{currency},{isLeaf},{level0},{debitRemain},{creditRemain},{debitTotalOcc},{creditTotalOcc},{debitBalance},{creditBalance},{remain},{balance},{direction},{CREATION_DATE},{CREATED_BY},{LAST_UPDATE_DATE},{LAST_UPDATED_BY});

#\u5EFA\u5E93\u5EFA\u8868
other.AC000017=CREATE DATABASE {dbName} CHARACTER SET 'utf8' COLLATE 'utf8_general_ci'
other.AC000018=CREATE TABLE {dbName}.fin_account (accPackageId varchar(14) NOT NULL DEFAULT '0' COMMENT '\u8D26\u5957ID', customerId int(10) NOT NULL COMMENT '\u5BA2\u6237ID', subjectId varchar(50) NOT NULL DEFAULT '' COMMENT '\u79D1\u76EE\u7F16\u53F7', accName varchar(80) NOT NULL DEFAULT '' COMMENT '\u79D1\u76EE\u540D\u79F0', subYearMonth int(10) NOT NULL DEFAULT '0' COMMENT '\u5E74', subMonth int(10) NOT NULL DEFAULT '0' COMMENT '\u6708', assSign varchar(10) DEFAULT NULL COMMENT '(\u672A\u7528\u5B57\u6BB5)', dataName varchar(30) DEFAULT '0' COMMENT '\u5E01\u79CD', debitRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u521D', creditRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u521D', debitOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D', creditOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D', debitOccNoTran decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D', creditOccNoTran decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D', tranDebitOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u635F\u76CA\u7ED3\u8F6C\u6570', tranCreditOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u635F\u76CA\u7ED3\u8F6C\u6570', remain decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u521D\u6570', balance decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u672B\u6570', debitTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570', creditTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570', accSign int(4) NOT NULL DEFAULT '0' COMMENT '(\u672A\u7528\u5B57\u6BB5)', direction int(2) DEFAULT '0' COMMENT '\u501F\u8D37\u65B9\u5411', debitBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u672B', creditBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u672B', isLeaf1 int(1) NOT NULL DEFAULT '0' COMMENT '\u662F\u5426\u672B\u7EA7\u79D1\u76EE', level1 int(1) NOT NULL DEFAULT '0' COMMENT '\u79D1\u76EE\u7EA7\u522B', subjectFullName1 varchar(250) DEFAULT NULL COMMENT '\u79D1\u76EE\u5168\u8DEF\u5F84', subjectfullName2 varchar(250) NOT NULL DEFAULT '' COMMENT '(\u672A\u7528\u5B57\u6BB5)', direction2 int(11) NOT NULL DEFAULT '0' COMMENT '(\u672A\u7528\u5B57\u6BB5)', tokenid varchar(300) DEFAULT NULL COMMENT '(\u672A\u7528\u5B57\u6BB5)', standName varchar(80) DEFAULT NULL COMMENT '(\u672A\u7528\u5B57\u6BB5)', dataType int(1) DEFAULT '0' COMMENT '(\u672A\u7528\u5B57\u6BB5)', reportSubjectName varchar(80) DEFAULT NULL, CREATION_DATE datetime DEFAULT NULL, CREATED_BY varchar(20) DEFAULT NULL, LAST_UPDATE_DATE datetime DEFAULT NULL, LAST_UPDATED_BY varchar(20) DEFAULT NULL, ABOLITION_DATE datetime DEFAULT NULL, ABOLISHED_BY varchar(20) DEFAULT NULL, PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL, PROGRAM_ID varchar(20) DEFAULT NULL, ACTIVE_FLAG varchar(1) DEFAULT '1', PRIMARY KEY (customerId,subjectId,subYearMonth,subMonth), KEY customerId (customerId)) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u79D1\u76EE\u4F59\u989D\u8868(\u6708\u5EA6)'
other.AC000019=CREATE TABLE {dbName}.fin_accountall (accPackageId varchar(14) NOT NULL DEFAULT '0' COMMENT '\u8D26\u5957ID', customerId int(10) NOT NULL COMMENT '\u5BA2\u6237ID', subjectId varchar(50) NOT NULL DEFAULT '' COMMENT '\u79D1\u76EE\u7F16\u53F7', accName varchar(80) NOT NULL DEFAULT '' COMMENT '\u79D1\u76EE\u540D\u79F0', subYearMonth int(10) NOT NULL DEFAULT '0' COMMENT '\u5E74', subMonth int(10) NOT NULL DEFAULT '0' COMMENT '\u6708', assSign varchar(10) DEFAULT NULL COMMENT '(\u672A\u7528\u5B57\u6BB5)', dataName varchar(30) NOT NULL DEFAULT '' COMMENT '\u5E01\u79CD', debitRemain decimal(30,4) NOT NULL DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u521D\u6570', creditRemain decimal(30,4) NOT NULL DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u521D\u6570', debitOcc decimal(30,4) NOT NULL DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D', creditOcc decimal(30,4) NOT NULL DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D', creditOccNoTran decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D', debitOccNoTran decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D', tranDebitOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u7ED3\u8F6C\u6570', tranCreditOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u7ED3\u8F6C\u6570', remain decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u521D\u6570', balance decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u672B\u6570', debitTotalOcc decimal(30,4) NOT NULL DEFAULT '0.0000' COMMENT '\u501F\u65B9\u91D1\u989D\u7D2F\u8BA1\u6570', creditTotalOcc decimal(30,4) NOT NULL DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u91D1\u989D\u7D2F\u8BA1\u6570', accSign int(4) NOT NULL DEFAULT '0' COMMENT '(\u672A\u7528\u5B57\u6BB5)', direction int(2) DEFAULT '0' COMMENT '\u501F\u8D37\u65B9\u5411', debitBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u672B\u6570', creditBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u672B\u6570', isLeaf1 int(1) NOT NULL DEFAULT '0' COMMENT '\u662F\u5426\u672B\u7EA7\u79D1\u76EE', level1 int(1) NOT NULL DEFAULT '0' COMMENT '\u79D1\u76EE\u7EA7\u522B', subjectFullName1 varchar(250) DEFAULT NULL COMMENT '\u79D1\u76EE\u5168\u8DEF\u5F84', subjectfullName2 varchar(250) NOT NULL DEFAULT '' COMMENT '(\u672A\u7528\u5B57\u6BB5)', direction2 int(11) NOT NULL DEFAULT '0' COMMENT '(\u672A\u7528\u5B57\u6BB5)', tokenid varchar(300) DEFAULT NULL COMMENT '(\u672A\u7528\u5B57\u6BB5)', standName varchar(80) DEFAULT NULL COMMENT '(\u672A\u7528\u5B57\u6BB5)', debitRemainF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u521D\u6570(\u5916\u5E01)', creditRemainF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u521D\u6570(\u5916\u5E01)', debitOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D(\u5916\u5E01)', creditOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D(\u5916\u5E01)', debitOccNoTranF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D(\u5916\u5E01)', creditOccNoTranF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D(\u5916\u5E01)', tranDebitOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u7ED3\u8F6C\u6570(\u5916\u5E01)', tranCreditOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u7ED3\u8F6C\u6570(\u5916\u5E01)', remainF decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u521D\u6570(\u5916\u5E01)', balanceF decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u672B\u6570(\u5916\u5E01)', debitTotalOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u91D1\u989D\u7D2F\u8BA1\u6570(\u5916\u5E01)', creditTotalOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u91D1\u989D\u7D2F\u8BA1\u6570(\u5916\u5E01)', debitBalanceF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u672B\u6570(\u5916\u5E01)', creditBalanceF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u672B\u6570(\u5916\u5E01)', reportSubjectName varchar(80) DEFAULT NULL, CREATION_DATE datetime DEFAULT NULL, CREATED_BY varchar(20) DEFAULT NULL, LAST_UPDATE_DATE datetime DEFAULT NULL, LAST_UPDATED_BY varchar(20) DEFAULT NULL, ABOLITION_DATE datetime DEFAULT NULL, ABOLISHED_BY varchar(20) DEFAULT NULL, PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL, PROGRAM_ID varchar(20) DEFAULT NULL, ACTIVE_FLAG varchar(1) DEFAULT '1', PRIMARY KEY (customerId,subjectId,subYearMonth,subMonth,dataName), KEY customerId (customerId)) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u79D1\u76EE\u4F59\u989D\u8868(\u6708\u5EA6 \u5916\u5E01)'
other.AC000020=CREATE TABLE {dbName}.fin_accpkgsubject (accPackageId varchar(14) NOT NULL DEFAULT '0' COMMENT '\u8D26\u5957ID', customerId int(10) NOT NULL COMMENT '\u5BA2\u6237ID', yyyy int(4) NOT NULL COMMENT '\u5E74', subjectCode varchar(20) DEFAULT '' COMMENT '(\u672A\u7528\u5B57\u6BB5)', subjectId varchar(50) NOT NULL DEFAULT '' COMMENT '\u79D1\u76EE\u7F16\u53F7', parentSubjectCode varchar(20) DEFAULT '' COMMENT '(\u672A\u7528\u5B57\u6BB5)', parentSubjectId varchar(50) DEFAULT NULL COMMENT '\u4E0A\u7EA7\u79D1\u76EE\u7F16\u53F7', subjectFullId varchar(200) DEFAULT '' COMMENT '\u79D1\u76EE\u7F16\u53F7\u5168\u8DEF\u5F84', subjectName varchar(80) DEFAULT '' COMMENT '\u79D1\u76EE\u540D\u79F0', subjectFullName varchar(250) DEFAULT NULL COMMENT '\u79D1\u76EE\u5168\u8DEF\u5F84', assistCode varchar(10) DEFAULT '' COMMENT '(\u672A\u7528\u5B57\u6BB5)', uomUnit varchar(20) DEFAULT '' COMMENT '(\u672A\u7528\u5B57\u6BB5)', currency varchar(10) DEFAULT '' COMMENT '\u5E01\u79CD', isLeaf int(1) DEFAULT NULL COMMENT '\u662F\u5426\u672B\u7EA7\u79D1\u76EE', level0 int(1) DEFAULT '1' COMMENT '\u79D1\u76EE\u7EA7\u522B', debitRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u521D', creditRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u521D', debitTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D', creditTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D', tranDebitTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u635F\u76CA\u7ED3\u8F6C\u6570', tranCreditTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u635F\u76CA\u7ED3\u8F6C\u6570', debitTotalOccNoTran decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D', creditTotalOccNoTran decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D', debitBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u672B', creditBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u672B', remain decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u521D\u6570', balance decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u672B\u6570', essentiality1 decimal(30,4) DEFAULT '0.0000' COMMENT '(\u672A\u7528\u5B57\u6BB5)', essentiality2 decimal(30,4) DEFAULT '0.0000' COMMENT '(\u672A\u7528\u5B57\u6BB5)', essentiality3 decimal(30,4) DEFAULT '0.0000' COMMENT '(\u672A\u7528\u5B57\u6BB5)', direction int(2) DEFAULT NULL COMMENT '\u501F\u8D37\u65B9\u5411', property varchar(10) DEFAULT '' COMMENT '(\u672A\u7528\u5B57\u6BB5)', CREATION_DATE datetime DEFAULT NULL, CREATED_BY varchar(20) DEFAULT NULL, LAST_UPDATE_DATE datetime DEFAULT NULL, LAST_UPDATED_BY varchar(20) DEFAULT NULL, ABOLITION_DATE datetime DEFAULT NULL, ABOLISHED_BY varchar(20) DEFAULT NULL, PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL, PROGRAM_ID varchar(20) DEFAULT NULL, ACTIVE_FLAG varchar(1) DEFAULT '1', PRIMARY KEY (customerId,yyyy,subjectId), KEY customerId (customerId) USING BTREE) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u79D1\u76EE\u4F59\u989D\u8868(\u5E74\u5EA6)'
other.AC000021=CREATE TABLE {dbName}.fin_assitem (accPackageId varchar(14) NOT NULL DEFAULT '0' COMMENT '\u8D26\u5957ID', customerId int(10) NOT NULL COMMENT '\u5BA2\u6237ID', yyyy int(4) NOT NULL COMMENT '\u5E74', accId varchar(50) NOT NULL DEFAULT '' COMMENT '\u79D1\u76EE\u7F16\u53F7', assItemId varchar(100) NOT NULL COMMENT '\u6838\u7B97\u540D\u7F16\u53F7', assItemName varchar(100) NOT NULL DEFAULT '' COMMENT '\u6838\u7B97\u9879\u540D', assTotalName varchar(1000) DEFAULT NULL COMMENT '\u6838\u7B97\u9879\u5168\u79F0', parentAssItemId varchar(60) DEFAULT NULL COMMENT '\u4E0A\u7EA7\u6838\u7B97\u9879\u7F16\u53F7', debitRemain decimal(30,4) NOT NULL DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u521D\u6570', creditRemain decimal(30,4) NOT NULL DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u521D\u6570', debitTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570', creditTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570', tranDebitTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '(\u672A\u7528\u5B57\u6BB5)', tranCreditTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '(\u672A\u7528\u5B57\u6BB5)', debitBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u672B\u6570', creditBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u672B\u6570', remain decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u521D\u6570', balance decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u672B\u6570', isLeaf int(1) NOT NULL DEFAULT '0' COMMENT '\u662F\u5426\u672B\u7EA7', level0 int(2) DEFAULT '0' COMMENT '\u7EA7\u522B', uomUnit varchar(20) DEFAULT NULL COMMENT '(\u672A\u7528\u5B57\u6BB5)', curr varchar(20) DEFAULT NULL COMMENT '(\u672A\u7528\u5B57\u6BB5)', direction int(2) DEFAULT NULL COMMENT '\u501F\u8D37\u65B9\u5411', property varchar(10) DEFAULT NULL COMMENT '(\u672A\u7528\u5B57\u6BB5)', assItemFullId varchar(1000) DEFAULT '' COMMENT '\u6838\u7B97\u7F16\u53F7\u5168\u8DEF\u5F84', CREATION_DATE datetime DEFAULT NULL, CREATED_BY varchar(20) DEFAULT NULL, LAST_UPDATE_DATE datetime DEFAULT NULL, LAST_UPDATED_BY varchar(20) DEFAULT NULL, ABOLITION_DATE datetime DEFAULT NULL, ABOLISHED_BY varchar(20) DEFAULT NULL, PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL, PROGRAM_ID varchar(20) DEFAULT NULL, ACTIVE_FLAG varchar(1) DEFAULT '1', PRIMARY KEY (customerId,yyyy,accId,assItemId), KEY customerId (customerId), KEY assItemId (assItemId) USING BTREE) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u6838\u7B97\u4F59\u989D\u8868(\u5E74\u5EA6)'
other.AC000022=CREATE TABLE {dbName}.fin_assitementry (autoId int(10) NOT NULL AUTO_INCREMENT, accPackageId varchar(14) NOT NULL DEFAULT '0' COMMENT '\u8D26\u5957ID', customerId int(10) NOT NULL COMMENT '\u5BA2\u6237ID', yyyy int(10) DEFAULT NULL COMMENT '\u5E74', subjectId varchar(50) DEFAULT NULL COMMENT '\u79D1\u76EE\u7F16\u53F7', voucherId varchar(50) DEFAULT NULL COMMENT '\u51ED\u8BC1ID', oldvoucherId varchar(50) DEFAULT NULL COMMENT '\u65E7\u51ED\u8BC1ID', vchDate varchar(10) NOT NULL DEFAULT '' COMMENT '\u5236\u5355\u65E5\u671F', typeId varchar(100) NOT NULL DEFAULT '' COMMENT '\u51ED\u8BC1\u7C7B\u578B', serail int(10) NOT NULL DEFAULT '0' COMMENT '\u5206\u5F55\u53F7', summary longtext NOT NULL COMMENT '\u6458\u8981', assItemId varchar(100) NOT NULL COMMENT '\u6838\u7B97\u9879\u7F16\u53F7', dirction int(1) NOT NULL DEFAULT '0' COMMENT '\u501F\u8D37\u65B9\u5411', assItemSum decimal(30,4) NOT NULL DEFAULT '0.0000', currRate decimal(30,4) DEFAULT '0.0000' COMMENT '\u6C47\u7387', currValue decimal(30,4) DEFAULT '0.0000' COMMENT '\u53D1\u751F\u989D', currency varchar(20) DEFAULT '' COMMENT '\u5E01\u79CD', quantity decimal(30,4) DEFAULT '0.0000' COMMENT '\u6570\u91CF', unitPrice decimal(15,4) DEFAULT '0.0000' COMMENT '\u5355\u4EF7', unitName varchar(20) DEFAULT '' COMMENT '\u5355\u4F4D', property varchar(1000) DEFAULT '' COMMENT '(\u672A\u7528\u5B57\u6BB5)', isTransferVoucher int(1) DEFAULT NULL COMMENT '\u662F\u5426\u7ED3\u8F6C\u51ED\u8BC1', CREATION_DATE datetime DEFAULT NULL, CREATED_BY varchar(20) DEFAULT NULL, LAST_UPDATE_DATE datetime DEFAULT NULL, LAST_UPDATED_BY varchar(20) DEFAULT NULL, ABOLITION_DATE datetime DEFAULT NULL, ABOLISHED_BY varchar(20) DEFAULT NULL, PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL, PROGRAM_ID varchar(20) DEFAULT NULL, ACTIVE_FLAG varchar(1) DEFAULT '1', PRIMARY KEY (autoId,customerId), KEY customerId (customerId)) ENGINE=InnoDB AUTO_INCREMENT=254815 DEFAULT CHARSET=utf8 COMMENT='\u6838\u7B97\u660E\u7EC6\u8868'
other.AC000023=CREATE TABLE {dbName}.fin_assitementryacc (accPackageId varchar(14) NOT NULL DEFAULT '0' COMMENT '\u8D26\u5957ID', customerId int(10) NOT NULL COMMENT '\u5BA2\u6237ID', accId varchar(50) NOT NULL DEFAULT '' COMMENT '\u79D1\u76EE\u7F16\u53F7', assItemId varchar(100) NOT NULL COMMENT '\u6838\u7B97\u9879\u7F16\u53F7', assItemName varchar(100) DEFAULT NULL COMMENT '\u6838\u7B97\u9879\u540D\u79F0', subYearMonth int(10) NOT NULL DEFAULT '0' COMMENT '\u5E74', subMonth int(10) NOT NULL DEFAULT '0' COMMENT '\u6708', debitRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u521D\u6570', creditRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u521D\u6570', debitOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D', creditOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D', tranDebitOcc decimal(30,4) DEFAULT '0.0000' COMMENT '(\u672A\u7528\u5B57\u6BB5)', tranCreditOcc decimal(30,4) DEFAULT '0.0000' COMMENT '(\u672A\u7528\u5B57\u6BB5)', remain decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u521D\u6570', balance decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u672B\u6570', debitTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u7D2F\u8BA1\u53D1\u751F\u989D', creditTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u7D2F\u8BA1\u53D1\u751F\u989D', direction int(2) DEFAULT '0' COMMENT '\u501F\u8D37\u65B9\u5411', debitBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u672B\u6570', creditBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u672B\u6570', isLeaf1 int(1) NOT NULL DEFAULT '0' COMMENT '\u662F\u5426\u672B\u7EA7', level1 int(1) NOT NULL DEFAULT '0' COMMENT '\u7EA7\u522B', assTotalName1 varchar(1000) DEFAULT NULL COMMENT '\u6838\u7B97\u9879\u5168\u540D\u79F0', dataName varchar(30) NOT NULL DEFAULT '0' COMMENT '\u5E01\u79CD', accSign int(4) NOT NULL DEFAULT '0' COMMENT '(\u672A\u7528\u5B57\u6BB5)', direction2 int(4) DEFAULT '0' COMMENT '(\u672A\u7528\u5B57\u6BB5)', CREATION_DATE datetime DEFAULT NULL, CREATED_BY varchar(20) DEFAULT NULL, LAST_UPDATE_DATE datetime DEFAULT NULL, LAST_UPDATED_BY varchar(20) DEFAULT NULL, ABOLITION_DATE datetime DEFAULT NULL, ABOLISHED_BY varchar(20) DEFAULT NULL, PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL, PROGRAM_ID varchar(20) DEFAULT NULL, ACTIVE_FLAG varchar(1) DEFAULT '1', PRIMARY KEY (customerId,accId,assItemId,subYearMonth,subMonth), KEY customerId (customerId)) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u6838\u7B97\u4F59\u989D\u8868(\u6708\u5EA6)'
other.AC000024=CREATE TABLE {dbName}.fin_assitementryaccall (accPackageId varchar(14) NOT NULL DEFAULT '0' COMMENT '\u8D26\u5957ID', customerId int(10) NOT NULL COMMENT '\u5BA2\u6237ID', accId varchar(50) NOT NULL DEFAULT '' COMMENT '\u79D1\u76EE\u7F16\u53F7', assItemId varchar(100) NOT NULL COMMENT '\u6838\u7B97\u9879\u7F16\u53F7', assItemName varchar(100) DEFAULT NULL COMMENT '\u6838\u7B97\u9879\u540D\u79F0', subYearMonth int(10) NOT NULL DEFAULT '0' COMMENT '\u5E74', subMonth int(10) NOT NULL DEFAULT '0' COMMENT '\u6708', debitRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u521D\u6570', creditRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u521D\u6570', debitOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D', creditOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D', tranDebitOcc decimal(30,4) DEFAULT '0.0000' COMMENT '(\u672A\u7528\u5B57\u6BB5)', tranCreditOcc decimal(30,4) DEFAULT '0.0000' COMMENT '(\u672A\u7528\u5B57\u6BB5)', remain decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u521D\u6570', balance decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u672B\u6570', debitTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570', creditTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570', direction int(2) DEFAULT '0' COMMENT '\u501F\u8D37\u65B9\u5411', debitBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u672B\u6570', creditBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u672B\u6570', isLeaf1 int(1) NOT NULL DEFAULT '0' COMMENT '\u662F\u5426\u672B\u7EA7', level1 int(1) NOT NULL DEFAULT '0' COMMENT '\u7EA7\u522B', assTotalName1 varchar(1000) DEFAULT NULL COMMENT '\u6838\u7B97\u9879\u5168\u540D\u79F0', dataName varchar(30) NOT NULL DEFAULT '' COMMENT '\u5E01\u79CD', accSign int(4) DEFAULT '0' COMMENT '(\u672A\u7528\u5B57\u6BB5)', direction2 int(4) NOT NULL DEFAULT '0' COMMENT '(\u672A\u7528\u5B57\u6BB5)', debitRemainF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u521D\u6570(\u5916\u5E01)', creditRemainF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u521D\u6570(\u5916\u5E01)', debitOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D(\u5916\u5E01)', creditOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D(\u5916\u5E01)', tranDebitOccF decimal(30,4) DEFAULT '0.0000' COMMENT '(\u672A\u7528\u5B57\u6BB5)', tranCreditOccF decimal(30,4) DEFAULT '0.0000' COMMENT '(\u672A\u7528\u5B57\u6BB5)', remainF decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u521D\u6570(\u5916\u5E01)', balanceF decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u672B\u6570(\u5916\u5E01)', debitTotalOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570(\u5916\u5E01)', creditTotalOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570(\u5916\u5E01)', debitBalanceF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u672B\u6570(\u5916\u5E01)', creditBalanceF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u672B\u6570(\u5916\u5E01)', CREATION_DATE datetime DEFAULT NULL, CREATED_BY varchar(20) DEFAULT NULL, LAST_UPDATE_DATE datetime DEFAULT NULL, LAST_UPDATED_BY varchar(20) DEFAULT NULL, ABOLITION_DATE datetime DEFAULT NULL, ABOLISHED_BY varchar(20) DEFAULT NULL, PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL, PROGRAM_ID varchar(20) DEFAULT NULL, ACTIVE_FLAG varchar(1) DEFAULT '1', PRIMARY KEY (customerId,accId,assItemId,subYearMonth,subMonth,dataName), KEY customerId (customerId)) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u6838\u7B97\u4F59\u989D\u8868(\u6708\u5EA6 \u5916\u5E01)'
other.AC000025=CREATE TABLE {dbName}.fin_benford (autoId int(11) NOT NULL AUTO_INCREMENT, customerId int(10) NOT NULL COMMENT '\u5BA2\u6237ID', yyyy int(4) NOT NULL COMMENT '\u5E74', type varchar(50) NOT NULL DEFAULT '' COMMENT '\u7C7B\u578B', d1 decimal(10,4) DEFAULT '0.0000' COMMENT '1\u5F00\u5934\u7684\u91D1\u989D\u6BD4\u4F8B', d2 decimal(10,4) DEFAULT '0.0000' COMMENT '2\u5F00\u5934\u7684\u91D1\u989D\u6BD4\u4F8B', d3 decimal(10,4) DEFAULT '0.0000' COMMENT '3\u5F00\u5934\u7684\u91D1\u989D\u6BD4\u4F8B', d4 decimal(10,4) DEFAULT '0.0000' COMMENT '4\u5F00\u5934\u7684\u91D1\u989D\u6BD4\u4F8B', d5 decimal(10,4) DEFAULT '0.0000' COMMENT '5\u5F00\u5934\u7684\u91D1\u989D\u6BD4\u4F8B', d6 decimal(10,4) DEFAULT '0.0000' COMMENT '6\u5F00\u5934\u7684\u91D1\u989D\u6BD4\u4F8B', d7 decimal(10,4) DEFAULT '0.0000' COMMENT '7\u5F00\u5934\u7684\u91D1\u989D\u6BD4\u4F8B', d8 decimal(10,4) DEFAULT '0.0000' COMMENT '8\u5F00\u5934\u7684\u91D1\u989D\u6BD4\u4F8B', d9 decimal(10,4) DEFAULT '0.0000' COMMENT '9\u5F00\u5934\u7684\u91D1\u989D\u6BD4\u4F8B', result1 decimal(30,4) DEFAULT '0.0000' COMMENT '\u4F59\u5F26\u76F8\u4F3C\u5EA6', result2 decimal(30,4) DEFAULT '0.0000', result3 decimal(30,4) DEFAULT '0.0000', CREATION_DATE datetime DEFAULT NULL, CREATED_BY varchar(20) DEFAULT NULL, LAST_UPDATE_DATE datetime DEFAULT NULL, LAST_UPDATED_BY varchar(20) DEFAULT NULL, ABOLITION_DATE datetime DEFAULT NULL, ABOLISHED_BY varchar(20) DEFAULT NULL, PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL, PROGRAM_ID varchar(20) DEFAULT NULL, ACTIVE_FLAG varchar(1) DEFAULT '1', PRIMARY KEY (autoId,customerId), KEY customerId (customerId) USING BTREE) ENGINE=InnoDB AUTO_INCREMENT=195 DEFAULT CHARSET=utf8 COMMENT='\u672C\u798F\u7279\u8868'
other.AC000026=CREATE TABLE {dbName}.fin_subjectentry (autoId int(10) NOT NULL AUTO_INCREMENT, accPackageId varchar(14) NOT NULL DEFAULT '0' COMMENT '\u8D26\u5957ID', customerId int(10) NOT NULL COMMENT '\u5BA2\u6237ID', yyyy int(4) DEFAULT NULL COMMENT '\u5E74', month int(2) DEFAULT NULL COMMENT '\u6708', voucherId varchar(200) DEFAULT NULL COMMENT '\u51ED\u8BC1ID', oldVoucherId varchar(200) DEFAULT NULL COMMENT '\u65E7\u51ED\u8BC1ID', typeId varchar(100) NOT NULL DEFAULT '' COMMENT '\u51ED\u8BC1\u7C7B\u578B', vchDate varchar(20) NOT NULL DEFAULT '00000000' COMMENT '\u5236\u5355\u65E5\u671F', serail int(10) NOT NULL DEFAULT '0' COMMENT '\u5206\u5F55\u53F7', summary longtext NOT NULL COMMENT '\u6458\u8981', subjectId varchar(50) DEFAULT NULL COMMENT '\u79D1\u76EE\u7F16\u53F7', dirction int(1) NOT NULL DEFAULT '0' COMMENT '\u501F\u8D37\u65B9\u5411', occurValue decimal(30,4) NOT NULL DEFAULT '0.0000' COMMENT '\u53D1\u751F\u989D', currRate decimal(15,4) DEFAULT '0.0000' COMMENT '\u6C47\u7387', currValue decimal(30,4) DEFAULT '0.0000' COMMENT '\u539F\u5E01\u91D1\u989D', currency varchar(20) DEFAULT '' COMMENT '\u5E01\u79CD', quantity decimal(30,4) DEFAULT '0.0000' COMMENT '\u6570\u91CF', unitPrice decimal(15,4) DEFAULT '0.0000' COMMENT '\u5355\u4EF7', unitName varchar(20) DEFAULT '' COMMENT '\u5355\u4F4D', bankId varchar(50) NOT NULL DEFAULT '' COMMENT '(\u672A\u7528\u5B57\u6BB5)', property varchar(10) NOT NULL DEFAULT '' COMMENT '(\u672A\u7528\u5B57\u6BB5)', subjectname1 varchar(80) NOT NULL DEFAULT '' COMMENT '\u79D1\u76EE\u540D\u79F0', subjectFullName1 varchar(250) DEFAULT NULL COMMENT '\u79D1\u76EE\u5168\u8DEF\u5F84', debitsubjects longtext COMMENT '\u501F\u65B9\u79D1\u76EE', creditsubjects longtext COMMENT '\u8D37\u65B9\u79D1\u76EE', voucherFillUser varchar(50) DEFAULT NULL COMMENT '\u5236\u5355\u4EBA', voucherAuditUser varchar(50) DEFAULT NULL COMMENT '\u5BA1\u6838\u4EBA', voucherKeepUser varchar(50) DEFAULT NULL COMMENT '\u8BB0\u8D26\u4EBA', voucherAffixCount int(10) DEFAULT NULL COMMENT '\u9644\u4EF6\u5F20\u6570', voucherDebitOcc decimal(15,2) DEFAULT NULL COMMENT '\u51ED\u8BC1\u501F\u65B9\u53D1\u751F\u989D\u5408\u8BA1', voucherCreditOcc decimal(15,2) DEFAULT NULL COMMENT '\u51ED\u8BC1\u8D37\u65B9\u53D1\u751F\u989D\u5408\u8BA1', voucherDirector varchar(20) DEFAULT NULL COMMENT '\u8D22\u52A1\u4E3B\u7BA1', tokenId varchar(300) DEFAULT NULL COMMENT '(\u672A\u7528\u5B57\u6BB5)', standName varchar(80) DEFAULT NULL COMMENT '(\u672A\u7528\u5B57\u6BB5)', isTransferVoucher int(1) DEFAULT '0' COMMENT '\u662F\u5426\u7ED3\u8F6C', drCount int(11) DEFAULT NULL COMMENT '\u51ED\u8BC1\u501F\u65B9\u79D1\u76EE\u6570', crCount int(11) DEFAULT NULL COMMENT '\u51ED\u8BC1\u8D37\u65B9\u79D1\u76EE\u6570', correspondOccurValue decimal(15,4) NOT NULL DEFAULT '0.0000' COMMENT '\u5BF9\u5E94\u53D1\u751F\u989D', reportSubjectName varchar(80) DEFAULT NULL, oppositeAccountTop text COMMENT '\u5BF9\u65B9\u79D1\u76EE\u4E00\u7EA7', oppositeAccountLast text COMMENT '\u5BF9\u65B9\u79D1\u76EE\u672B\u7EA7', CREATION_DATE datetime DEFAULT NULL, CREATED_BY varchar(20) DEFAULT NULL, LAST_UPDATE_DATE datetime DEFAULT NULL, LAST_UPDATED_BY varchar(20) DEFAULT NULL, ABOLITION_DATE datetime DEFAULT NULL, ABOLISHED_BY varchar(20) DEFAULT NULL, PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL, PROGRAM_ID varchar(20) DEFAULT NULL, ACTIVE_FLAG varchar(1) DEFAULT '1', PRIMARY KEY (autoId,customerId), KEY customerId (customerId), KEY oldVoucherId (oldVoucherId), KEY PKey (customerId,yyyy,month,voucherId,oldVoucherId,vchDate) USING BTREE) ENGINE=InnoDB AUTO_INCREMENT=1801722 DEFAULT CHARSET=utf8 COMMENT='\u51ED\u8BC1\u5206\u5F55\u8868'
other.AC000027=CREATE TABLE {dbName}.fin_subjectvoucher (autoId int(11) NOT NULL AUTO_INCREMENT, accPackageId varchar(14) DEFAULT '0' COMMENT '\u8D26\u5957ID', customerId int(10) NOT NULL COMMENT '\u5BA2\u6237ID', yyyy int(4) DEFAULT NULL COMMENT '\u5E74', month int(2) DEFAULT NULL COMMENT '\u6708', voucherId varchar(200) DEFAULT NULL COMMENT '\u51ED\u8BC1\u53F7', typeId varchar(100) DEFAULT '' COMMENT '\u51ED\u8BC1\u7C7B\u578B', vchDate varchar(20) DEFAULT '' COMMENT '\u5236\u5355\u65E5\u671F', fillUser varchar(50) DEFAULT '' COMMENT '\u5236\u5355\u4EBA', auditUser varchar(50) DEFAULT '' COMMENT '\u5BA1\u6838\u4EBA', keepUser varchar(50) DEFAULT '' COMMENT '\u8BB0\u8D26\u4EBA', director varchar(20) DEFAULT '' COMMENT '\u8D22\u52A1\u4E3B\u7BA1', affixCount int(10) DEFAULT '0' COMMENT '\u9644\u4EF6\u5F20\u6570', description varchar(255) DEFAULT '' COMMENT '(\u672A\u7528\u5B57\u6BB5)', doubtUserId varchar(20) DEFAULT '' COMMENT '(\u672A\u7528\u5B57\u6BB5)', property varchar(10) DEFAULT '' COMMENT '(\u672A\u7528\u5B57\u6BB5)', debitocc decimal(15,2) DEFAULT NULL COMMENT '\u501F\u65B9\u53D1\u751F\u6570', creditocc decimal(15,2) DEFAULT NULL COMMENT '\u8D37\u65B9\u53D1\u751F\u6570', CREATION_DATE datetime DEFAULT NULL, CREATED_BY varchar(20) DEFAULT NULL, LAST_UPDATE_DATE datetime DEFAULT NULL, LAST_UPDATED_BY varchar(20) DEFAULT NULL, ABOLITION_DATE datetime DEFAULT NULL, ABOLISHED_BY varchar(20) DEFAULT NULL, PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL, PROGRAM_ID varchar(20) DEFAULT NULL, ACTIVE_FLAG varchar(1) DEFAULT '1', PRIMARY KEY (autoId,customerId), KEY customerId (customerId)) ENGINE=InnoDB AUTO_INCREMENT=164040 DEFAULT CHARSET=utf8 COMMENT='\u51ED\u8BC1\u8868'
#\u672C\u798F\u7279\u57FA\u51C6\u6570\u636E
other.AC000028=INSERT INTO {dbName}.fin_benford (autoId,customerId,yyyy,type,d1,d2,d3,d4,d5,d6,d7,d8,d9,result1,result2,result3) VALUES (1,0,0,'\u51ED\u8BC1\u5206\u5F55\u91D1\u989D',0.3010,0.1761,0.1249,0.0969,0.0792,0.0669,0.0580,0.0512,0.0458,0.0000,0.0000,0.0000)
#\u5B58\u50A8\u8FC7\u7A0B
other.AC000029=CREATE PROCEDURE {dbName}.sp_fin_account(IN P_customerId varchar(10), IN P_accPackageId bigint(20))BEGIN DECLARE my_id1 varchar(100);DECLARE my_id2 varchar(100);DECLARE my_id3 varchar(100);DECLARE my_id4 varchar(100);DECLARE my_id5 varchar(100);DECLARE my_id6 varchar(100);DECLARE my_id7 varchar(100);DECLARE done INT DEFAULT FALSE;DECLARE My_Cursor CURSOR for(SELECT a.debitOcc,a.creditOcc,SUM(ifnull(b.tranDebitTotalOccur,0))AS tranDebitOcc,SUM(ifnull(b.tranCreditTotalOccur,0))AS tranCreditOcc,a.subjectId,a.subYearMonth,a.subMonth FROM fin_account a LEFT JOIN(SELECT subjectId,MONTH,IF(dirction=1,SUM(occurValue),0)AS tranDebitTotalOccur, IF(dirction=-1,SUM(occurValue),0)AS tranCreditTotalOccur,IF(dirction=1,SUM(currValue),0)AS tranDebitTotalCurr,IF(dirction=-1,SUM(currValue),0)AS tranCreditTotalCurr FROM fin_subjectentry WHERE customerId=P_customerId AND yyyy=substr(P_accPackageId,-4,4)AND isTransferVoucher=1 GROUP BY subjectId,dirction,MONTH)b ON a.subjectId=LEFT(b.subjectId, LENGTH(a.subjectId))AND a.subMonth=b.MONTH WHERE a.customerId=P_customerId AND a.subYearMonth=substr(P_accPackageId,-4,4)GROUP BY a.subMonth,a.subjectId);DECLARE CONTINUE HANDLER FOR NOT FOUND SET done=TRUE;OPEN My_Cursor;myLoop: LOOP FETCH My_Cursor into my_id1,my_id2,my_id3,my_id4,my_id5,my_id6,my_id7;IF done THEN LEAVE myLoop;END IF;update fin_account SET tranDebitOcc=my_id3, tranCreditOcc=my_id4, debitOccNoTran=my_id1 -my_id3, creditOccNoTran=my_id2 -my_id4 WHERE customerId=P_customerId AND subjectId=my_id5 AND subYearMonth=my_id6 AND subMonth=my_id7;COMMIT;END LOOP myLoop;CLOSE My_Cursor;END
other.AC000030=CREATE PROCEDURE {dbName}.sp_fin_accountall(IN P_customerId varchar(10), IN P_accPackageId bigint(20))BEGIN DECLARE my_id1 varchar(100);DECLARE my_id2 varchar(100);DECLARE my_id3 varchar(100);DECLARE my_id4 varchar(100);DECLARE my_id5 varchar(100);DECLARE my_id6 varchar(100);DECLARE my_id7 varchar(100);DECLARE my_id8 varchar(100);DECLARE my_id9 varchar(100);DECLARE my_id10 varchar(100);DECLARE my_id11 varchar(100);DECLARE my_id12 varchar(100);DECLARE done INT DEFAULT FALSE;DECLARE My_Cursor CURSOR for(SELECT a.creditOcc,a.debitOcc,SUM(ifnull(b.tranDebitTotalOccur,0))AS tranDebitOcc,SUM(ifnull(b.tranCreditTotalOccur,0))AS tranCreditOcc,a.debitOccF,a.creditOccF,SUM(ifnull(b.tranDebitTotalCurr,0))AS tranDebitOccF,SUM(ifnull(b.tranCreditTotalCurr,0))AS tranCreditOccF,a.subjectId,a.subYearMonth,a.subMonth,a.dataName FROM fin_accountall a LEFT JOIN(SELECT subjectId,MONTH,currency,IF(dirction=1,SUM(occurValue),0)AS tranDebitTotalOccur,IF(dirction=-1,SUM(occurValue),0)AS tranCreditTotalOccur,IF(dirction=1,SUM(currValue),0)AS tranDebitTotalCurr,IF(dirction=-1,SUM(currValue),0)AS tranCreditTotalCurr FROM fin_subjectentry WHERE customerId=P_customerId AND yyyy=substr(P_accPackageId,-4,4)AND isTransferVoucher=1 GROUP BY subjectId,dirction,MONTH,currency)b ON a.subjectId=LEFT(b.subjectId, LENGTH(a.subjectId))AND a.subMonth=b.MONTH AND a.dataName=b.currency WHERE a.customerId=P_customerId AND a.subYearMonth=substr(P_accPackageId,-4,4)GROUP BY a.subMonth,a.subjectId,a.dataName);DECLARE CONTINUE HANDLER FOR NOT FOUND SET done=TRUE;OPEN My_Cursor;myLoop: LOOP FETCH My_Cursor into my_id1,my_id2,my_id3,my_id4,my_id5,my_id6,my_id7,my_id8,my_id9,my_id10,my_id11,my_id12;IF done THEN LEAVE myLoop;END IF;UPDATE fin_accountall SET tranDebitOcc=my_id3, tranCreditOcc=my_id4, debitOccNoTran=my_id1 -my_id3, creditOccNoTran=my_id2 -my_id4, tranDebitOccF=my_id7, tranCreditOccF=my_id8, debitOccNoTranF=my_id5 -my_id7, creditOccNoTranF=my_id6 -my_id8 WHERE customerId=P_customerId AND subjectId=my_id9 AND subYearMonth=my_id10 AND subMonth=my_id11 AND dataName=my_id12;COMMIT;END LOOP myLoop;CLOSE My_Cursor;END
other.AC000031=CREATE PROCEDURE {dbName}.sp_fin_accpkgfullsubject(IN P_customerId varchar(10), IN P_accPackageId bigint(20))BEGIN UPDATE fin_accpkgsubject t1 inner join(select a1.customerId,a1.yyyy,a1.subjectId, concat(IF(a10.subjectid is null,'',concat(a10.subjectid,'/')),IF(a9.subjectid is null,'',concat(a9.subjectid,'/')), IF(a8.subjectid is null,'',concat(a8.subjectid,'/')),IF(a7.subjectid is null,'',concat(a7.subjectid,'/')), IF(a6.subjectid is null,'',concat(a6.subjectid,'/')),IF(a5.subjectid is null,'',concat(a5.subjectid,'/')), IF(a4.subjectid is null,'',concat(a4.subjectid,'/')),IF(a3.subjectid is null,'',concat(a3.subjectid,'/')), IF(a2.subjectid is null,'',concat(a2.subjectid,'/')),IF(a1.subjectid is null,'',concat(a1.subjectid)))as subjectFullId from fin_accpkgsubject a1 left join(select * from fin_accpkgsubject where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))a2 on a1.customerId=a2.customerId and a1.yyyy=a2.yyyy and a2.subjectId =a1.parentSubjectId left join(select * from fin_accpkgsubject where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))a3 on a2.customerId=a3.customerId and a2.yyyy=a3.yyyy and a3.subjectId =a2.parentSubjectId left join(select * from fin_accpkgsubject where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))a4 on a3.customerId=a4.customerId and a3.yyyy=a4.yyyy and a4.subjectId =a3.parentSubjectId left join(select * from fin_accpkgsubject where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))a5 on a4.customerId=a5.customerId and a4.yyyy=a5.yyyy and a5.subjectId =a4.parentSubjectId left join(select * from fin_accpkgsubject where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))a6 on a5.customerId=a6.customerId and a5.yyyy=a6.yyyy and a6.subjectId =a5.parentSubjectId left join(select * from fin_accpkgsubject where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))a7 on a6.customerId=a7.customerId and a6.yyyy=a7.yyyy and a7.subjectId =a6.parentSubjectId left join(select * from fin_accpkgsubject where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))a8 on a7.customerId=a8.customerId and a7.yyyy=a8.yyyy and a8.subjectId =a7.parentSubjectId left join(select * from fin_accpkgsubject where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))a9 on a8.customerId=a9.customerId and a8.yyyy=a9.yyyy and a9.subjectId =a8.parentSubjectId left join(select * from fin_accpkgsubject where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))a10 on a9.customerId=a10.customerId and a9.yyyy=a10.yyyy and a10.subjectId =a9.parentSubjectId where a1.customerId=P_customerId and a1.yyyy=substr(P_accPackageId,-4,4))t2 set t1.subjectFullId=t2.subjectFullId WHERE t1.customerId=t2.customerId and t1.yyyy=t2.yyyy and t1.subjectId=t2.subjectId;END
other.AC000032=CREATE PROCEDURE {dbName}.sp_fin_accpkgsubject(IN P_customerId varchar(10), IN P_accPackageId bigint(20))BEGIN DECLARE my_id1 varchar(100);DECLARE my_id2 varchar(100);DECLARE my_id3 varchar(100);DECLARE my_id4 varchar(100);DECLARE my_id5 varchar(100);DECLARE done INT DEFAULT FALSE;DECLARE My_Cursor CURSOR for(SELECT a.debitTotalOcc,a.creditTotalOcc,SUM(ifnull(b.tranDebitTotalOccur,0))AS tranDebitTotalOcc,SUM(ifnull(b.tranDebitTotalOccur,0))AS tranCreditTotalOcc,a.subjectId FROM fin_accpkgsubject a LEFT JOIN(SELECT subjectId,IF(dirction=1,SUM(occurValue),0)AS tranDebitTotalOccur,IF(dirction=-1,SUM(occurValue),0)AS tranCreditTotalOccur FROM fin_subjectentry WHERE customerId=P_customerId AND yyyy=substr(P_accPackageId,-4,4)AND isTransferVoucher=1 GROUP BY subjectId,dirction)b ON a.subjectId=LEFT(b.subjectId, LENGTH(a.subjectId))WHERE a.customerId=P_customerId AND a.yyyy=substr(P_accPackageId,-4,4)GROUP BY a.subjectId);DECLARE CONTINUE HANDLER FOR NOT FOUND SET done=TRUE;OPEN My_Cursor;myLoop: LOOP FETCH My_Cursor into my_id1, my_id2, my_id3, my_id4, my_id5;IF done THEN LEAVE myLoop;END IF;update fin_accpkgsubject SET tranDebitTotalOcc=my_id3, tranCreditTotalOcc=my_id4, debitTotalOccNoTran=my_id1 -my_id3, creditTotalOccNoTran=my_id2 -my_id4 WHERE customerId=P_customerId AND yyyy=substr(P_accPackageId,-4,4)AND subjectId=my_id5;COMMIT;END LOOP myLoop;CLOSE My_Cursor;END
other.AC000033=CREATE PROCEDURE {dbName}.sp_fin_assitemfullId(IN P_customerId varchar(10), IN P_accPackageId bigint(20))BEGIN UPDATE fin_assitem t1 inner join(select a1.customerId,a1.yyyy,a1.assItemId,a1.accId, concat(IF(a10.assItemId is null,'',concat(a10.assItemId,'|')),IF(a9.assItemId is null,'',concat(a9.assItemId,'|')), IF(a8.assItemId is null,'',concat(a8.assItemId,'|')),IF(a7.assItemId is null,'',concat(a7.assItemId,'|')), IF(a6.assItemId is null,'',concat(a6.assItemId,'|')),IF(a5.assItemId is null,'',concat(a5.assItemId,'|')), IF(a4.assItemId is null,'',concat(a4.assItemId,'|')),IF(a3.assItemId is null,'',concat(a3.assItemId,'|')), IF(a2.assItemId is null,'',concat(a2.assItemId,'|')),IF(a1.assItemId is null,'',concat(a1.assItemId)))as assItemFullId from fin_assitem a1 left join(select * from fin_assitem where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))a2 on a1.customerId=a2.customerId and a1.yyyy=a2.yyyy and a1.accId=a2.accId and a2.assItemId =a1.parentassItemId left join(select * from fin_assitem where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))a3 on a2.customerId=a3.customerId and a2.yyyy=a3.yyyy and a2.accId=a3.accId and a3.assItemId =a2.parentassItemId left join(select * from fin_assitem where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))a4 on a3.customerId=a4.customerId and a3.yyyy=a4.yyyy and a3.accId=a4.accId and a4.assItemId =a3.parentassItemId left join(select * from fin_assitem where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))a5 on a4.customerId=a5.customerId and a4.yyyy=a5.yyyy and a4.accId=a5.accId and a5.assItemId =a4.parentassItemId left join(select * from fin_assitem where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))a6 on a5.customerId=a6.customerId and a5.yyyy=a6.yyyy and a5.accId=a6.accId and a6.assItemId =a5.parentassItemId left join(select * from fin_assitem where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))a7 on a6.customerId=a7.customerId and a6.yyyy=a7.yyyy and a6.accId=a7.accId and a7.assItemId =a6.parentassItemId left join(select * from fin_assitem where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))a8 on a7.customerId=a8.customerId and a7.yyyy=a8.yyyy and a7.accId=a8.accId and a8.assItemId =a7.parentassItemId left join(select * from fin_assitem where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))a9 on a8.customerId=a9.customerId and a8.yyyy=a9.yyyy and a8.accId=a9.accId and a9.assItemId =a8.parentassItemId left join(select * from fin_assitem where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))a10 on a9.customerId=a10.customerId and a9.yyyy=a10.yyyy and a9.accId=a10.accId and a10.assItemId =a9.parentassItemId where a1.customerId=P_customerId and a1.yyyy=substr(P_accPackageId,-4,4))t2 set t1.assItemFullId=t2.assItemFullId WHERE t1.customerId=t2.customerId and t1.yyyy=t2.yyyy and t1.assItemId=t2.assItemId and t1.accId=t2.accId;COMMIT;END
other.AC000034=CREATE PROCEDURE {dbName}.sp_fin_benford(IN P_customerId varchar(10), IN P_accPackageId bigint(20))BEGIN delete from fin_benford where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4)and type='\u51ED\u8BC1\u5206\u5F55\u91D1\u989D';insert into fin_benford(customerId,yyyy,type,d1,d2,d3,d4,d5,d6,d7,d8,d9,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY)select P_customerId,substr(P_accPackageId,-4,4),'\u51ED\u8BC1\u5206\u5F55\u91D1\u989D',ROUND(d1/d10,4),ROUND(d2/d10,4),ROUND(d3/d10,4),ROUND(d4/d10,4),ROUND(d5/d10,4),ROUND(d6/d10,4),ROUND(d7/d10,4),ROUND(d8/d10,4),ROUND(d9/d10,4),SYSDATE(),1,SYSDATE(),1 from(SELECT COUNT(1)d1 FROM fin_subjectentry WHERE customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4)AND LEFT(ABS(occurValue),1)=1)t1,(SELECT COUNT(1)d2 FROM fin_subjectentry WHERE customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4)AND LEFT(ABS(occurValue),1)=2)t2,(SELECT COUNT(1)d3 FROM fin_subjectentry WHERE customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4)AND LEFT(ABS(occurValue),1)=3)t3,(SELECT COUNT(1)d4 FROM fin_subjectentry WHERE customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4)AND LEFT(ABS(occurValue),1)=4)t4,(SELECT COUNT(1)d5 FROM fin_subjectentry WHERE customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4)AND LEFT(ABS(occurValue),1)=5)t5,(SELECT COUNT(1)d6 FROM fin_subjectentry WHERE customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4)AND LEFT(ABS(occurValue),1)=6)t6,(SELECT COUNT(1)d7 FROM fin_subjectentry WHERE customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4)AND LEFT(ABS(occurValue),1)=7)t7,(SELECT COUNT(1)d8 FROM fin_subjectentry WHERE customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4)AND LEFT(ABS(occurValue),1)=8)t8,(SELECT COUNT(1)d9 FROM fin_subjectentry WHERE customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4)AND LEFT(ABS(occurValue),1)=9)t9,(SELECT COUNT(1)d10 FROM fin_subjectentry WHERE customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))t10;update fin_benford set result1=(select ROUND(((t1.d1*t2.d1)+(t1.d2*t2.d2)+(t1.d3*t2.d3)+(t1.d4*t2.d4)+(t1.d5*t2.d5)+(t1.d6*t2.d6)+(t1.d7*t2.d7)+(t1.d8*t2.d8)+(t1.d9*t2.d9))/(SQRT(POWER(t1.d1,2)+POWER(t1.d2,2)+POWER(t1.d3,2)+POWER(t1.d4,2)+POWER(t1.d5,2)+POWER(t1.d6,2)+POWER(t1.d7,2)+POWER(t1.d8,2)+POWER(t1.d9,2))*SQRT(POWER(t2.d1,2)+POWER(t2.d2,2)+POWER(t2.d3,2)+POWER(t2.d4,2)+POWER(t2.d5,2)+POWER(t2.d6,2)+POWER(t2.d7,2)+POWER(t2.d8,2)+POWER(t2.d9,2))),4)from(select d1,d2,d3,d4,d5,d6,d7,d8,d9 from fin_benford where customerId=0 and yyyy=0)t1,(select d1,d2,d3,d4,d5,d6,d7,d8,d9 from fin_benford where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))t2)where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4);update fin_benford set result2=(select ROUND(POW(t1.d1-t2.d1,2)+POW(t1.d2-t2.d2,2)+POW(t1.d3-t2.d3,2)+POW(t1.d4-t2.d4,2)+POW(t1.d5-t2.d5,2)+POW(t1.d6-t2.d6,2)+POW(t1.d7-t2.d7,2)+POW(t1.d8-t2.d8,2)+POW(t1.d9-t2.d9,2),4)from(select d1,d2,d3,d4,d5,d6,d7,d8,d9 from fin_benford where customerId=0 and yyyy=0)t1,(select d1,d2,d3,d4,d5,d6,d7,d8,d9 from fin_benford where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4))t2)where customerId=P_customerId and yyyy=substr(P_accPackageId,-4,4);commit;END
other.AC000035=CREATE PROCEDURE {dbName}.sp_fin_oppositeAccount(IN P_customerId VARCHAR(10), IN P_accPackageId BIGINT(20), P_subjectId VARCHAR(50))BEGIN CREATE TEMPORARY TABLE IF NOT EXISTS temporary_fin_subjectentry(autoId INT(10), accPackageId VARCHAR(42), customerId INT(10), yyyy INT(4), month INT(2), voucherId BIGINT(11), oldVoucherId VARCHAR(600), typeId VARCHAR(60), vchDate VARCHAR(60), serail INT(10), summary VARCHAR(600), subjectId VARCHAR(150), dirction INT(2), occurValue DECIMAL(22,4), currRate DECIMAL(17,4), currValue DECIMAL(22,4), currency VARCHAR(60), quantity DECIMAL(22,4), unitPrice DECIMAL(17,4), unitName VARCHAR(60), bankId VARCHAR(150), property VARCHAR(30), subjectname1 VARCHAR(240), subjectFullName1 VARCHAR(750), debitsubjects BLOB, creditsubjects BLOB, voucherFillUser VARCHAR(60), voucherAuditUser VARCHAR(60), voucherKeepUser VARCHAR(60), voucherAffixCount INT(10), voucherDebitOcc DECIMAL(17,2), voucherCreditOcc DECIMAL(17,2), voucherDirector VARCHAR(60), tokenId VARCHAR(900), standName VARCHAR(240), isTransferVoucher INT(1), drCount INT(11), crCount INT(11), correspondOccurValue DECIMAL(17,4), reportSubjectName VARCHAR(240), oppositeAccountTop BLOB, oppositeAccountLast BLOB, CREATION_DATE DATETIME, CREATED_BY VARCHAR(60), LAST_UPDATE_DATE DATETIME, LAST_UPDATED_BY VARCHAR(60), ABOLITION_DATE DATETIME, ABOLISHED_BY VARCHAR(60), PROGRAM_APPLICATION_ID VARCHAR(60), PROGRAM_ID VARCHAR(60), ACTIVE_FLAG VARCHAR(3));TRUNCATE TABLE temporary_fin_subjectentry;INSERT INTO temporary_fin_subjectentry SELECT a.autoId, a.accPackageId, a.customerId, a.yyyy, a.month, a.voucherId, a.oldVoucherId, a.typeId, a.vchDate, a.serail, a.summary, a.subjectId, a.dirction, a.occurValue, a.currRate, a.currValue, a.currency, a.quantity, a.unitPrice, a.unitName, a.bankId, a.property, a.subjectname1, a.subjectFullName1, a.debitsubjects, a.creditsubjects, a.voucherFillUser, a.voucherAuditUser, a.voucherKeepUser, a.voucherAffixCount, a.voucherDebitOcc, a.voucherCreditOcc, a.voucherDirector, a.tokenId, a.standName, a.isTransferVoucher, a.drCount, a.crCount, a.correspondOccurValue, a.reportSubjectName, case when a.subjectFullName1 like '\u672C\u5E74\u5229\u6DA6%' and b.bnlrsubjectsNameTop is not null then b.fbnlrsubjectsNameTop when a.subjectFullName1 not like '\u672C\u5E74\u5229\u6DA6%' and b.bnlrsubjectsNameTop is not null then b.bnlrsubjectsNameTop else IF(a.dirction=1,IFNULL(b.creditsubjectsNameTop,b.creditsubjectsName),IFNULL(b.debitsubjectsNameTop,b.debitsubjectsName))END AS oppositeAccountTop, case when a.subjectFullName1 like '\u672C\u5E74\u5229\u6DA6%' and b.bnlrsubjectsName is not null then b.fbnlrsubjectsName when a.subjectFullName1 not like '\u672C\u5E74\u5229\u6DA6%' and b.bnlrsubjectsName is not null then b.bnlrsubjectsName else IF(a.dirction=1,b.creditsubjectsName,b.debitsubjectsName)END AS oppositeAccountLast, a.CREATION_DATE, a.CREATED_BY, a.LAST_UPDATE_DATE, a.LAST_UPDATED_BY, a.ABOLITION_DATE, a.ABOLISHED_BY, a.PROGRAM_APPLICATION_ID, a.PROGRAM_ID, a.ACTIVE_FLAG FROM fin_subjectentry a LEFT JOIN(SELECT vchDate, oldVoucherId,typeId, GROUP_CONCAT(DISTINCT CASE WHEN dirction=1 THEN(SELECT a.subjectName FROM fin_accpkgsubject a,fin_accpkgsubject b WHERE b.subjectId=fin_subjectentry.subjectId and b.customerId=fin_subjectentry.customerId and b.yyyy=fin_subjectentry.yyyy and a.customerId=b.customerId and a.yyyy=b.yyyy and b.subjectFullId like CONCAT(a.subjectId,'/%')AND a.level0=1 AND a.customerId=P_customerId AND a.yyyy=substr(P_accPackageId,-4,4)AND a.accPackageId=P_accPackageId)END ORDER BY subjectId)AS debitsubjectsNameTop, GROUP_CONCAT(DISTINCT CASE WHEN dirction=-1 THEN(SELECT a.subjectName FROM fin_accpkgsubject a,fin_accpkgsubject b WHERE b.subjectId=fin_subjectentry.subjectId and b.customerId=fin_subjectentry.customerId and b.yyyy=fin_subjectentry.yyyy and a.customerId=b.customerId and a.yyyy=b.yyyy and b.subjectFullId like CONCAT(a.subjectId,'/%')AND a.level0=1 AND a.customerId=P_customerId AND a.yyyy=substr(P_accPackageId,-4,4)AND a.accPackageId=P_accPackageId)END ORDER BY subjectId)AS creditsubjectsNameTop, GROUP_CONCAT(DISTINCT CASE WHEN dirction=1 THEN(SELECT subjectFullName FROM fin_accpkgsubject a WHERE a.subjectId=fin_subjectentry.subjectId AND customerId=P_customerId AND yyyy=substr(P_accPackageId,-4,4)AND accPackageId=P_accPackageId)END ORDER BY subjectId)AS debitsubjectsName, GROUP_CONCAT(DISTINCT CASE WHEN dirction=-1 THEN(SELECT subjectFullName FROM fin_accpkgsubject a WHERE a.subjectId=fin_subjectentry.subjectId AND customerId=P_customerId AND yyyy=substr(P_accPackageId,-4,4)AND accPackageId=P_accPackageId)END ORDER BY subjectId)AS creditsubjectsName, GROUP_CONCAT(DISTINCT CASE WHEN subjectFullName1 like '\u672C\u5E74\u5229\u6DA6%' THEN(SELECT a.subjectName FROM fin_accpkgsubject a,fin_accpkgsubject b WHERE b.subjectId=fin_subjectentry.subjectId and b.customerId=fin_subjectentry.customerId and b.yyyy=fin_subjectentry.yyyy and a.customerId=b.customerId and a.yyyy=b.yyyy and b.subjectFullId like CONCAT(a.subjectId,'/%')AND a.level0=1 AND a.customerId=P_customerId AND a.yyyy=substr(P_accPackageId,-4,4)AND a.accPackageId=P_accPackageId)END ORDER BY subjectId)AS bnlrsubjectsNameTop, GROUP_CONCAT(DISTINCT CASE WHEN subjectFullName1 like '\u672C\u5E74\u5229\u6DA6%' THEN(SELECT subjectFullName FROM fin_accpkgsubject a WHERE a.subjectId=fin_subjectentry.subjectId AND customerId=P_customerId AND yyyy=substr(P_accPackageId,-4,4)AND accPackageId=P_accPackageId)END ORDER BY subjectId)AS bnlrsubjectsName, GROUP_CONCAT(DISTINCT CASE WHEN subjectFullName1 not like '\u672C\u5E74\u5229\u6DA6%' THEN(SELECT a.subjectName FROM fin_accpkgsubject a,fin_accpkgsubject b WHERE b.subjectId=fin_subjectentry.subjectId and b.customerId=fin_subjectentry.customerId and b.yyyy=fin_subjectentry.yyyy and a.customerId=b.customerId and a.yyyy=b.yyyy and b.subjectFullId like CONCAT(a.subjectId,'/%')AND a.level0=1 AND a.customerId=P_customerId AND a.yyyy=substr(P_accPackageId,-4,4)AND a.accPackageId=P_accPackageId)END ORDER BY subjectId)AS fbnlrsubjectsNameTop, GROUP_CONCAT(DISTINCT CASE WHEN subjectFullName1 not like '\u672C\u5E74\u5229\u6DA6%' THEN(SELECT subjectFullName FROM fin_accpkgsubject a WHERE a.subjectId=fin_subjectentry.subjectId AND customerId=P_customerId AND yyyy=substr(P_accPackageId,-4,4)AND accPackageId=P_accPackageId)END ORDER BY subjectId)AS fbnlrsubjectsName FROM fin_subjectentry WHERE customerId=P_customerId AND yyyy=substr(P_accPackageId,-4,4)AND accPackageId=P_accPackageId AND subjectId LIKE CONCAT(P_subjectId,'%')GROUP BY customerId, yyyy, vchDate, oldVoucherId,typeId)b ON a.oldVoucherId=b.oldVoucherId AND a.vchDate=b.vchDate and a.typeId=b.typeId WHERE customerId=P_customerId AND yyyy=substr(P_accPackageId,-4,4)AND accPackageId=P_accPackageId;DELETE FROM fin_subjectentry WHERE customerId=P_customerId AND accPackageId=P_accPackageId;INSERT INTO fin_subjectentry SELECT a.autoId, a.accPackageId, a.customerId, a.yyyy, a.month, a.voucherId, a.oldVoucherId, a.typeId, a.vchDate, a.serail, a.summary, a.subjectId, a.dirction, a.occurValue, a.currRate, a.currValue, a.currency, a.quantity, a.unitPrice, a.unitName, a.bankId, a.property, a.subjectname1, a.subjectFullName1, a.debitsubjects, a.creditsubjects, a.voucherFillUser, a.voucherAuditUser, a.voucherKeepUser, a.voucherAffixCount, a.voucherDebitOcc, a.voucherCreditOcc, a.voucherDirector, a.tokenId, a.standName, a.isTransferVoucher, a.drCount, a.crCount, a.correspondOccurValue, a.reportSubjectName, a.oppositeAccountTop, a.oppositeAccountLast, a.CREATION_DATE, a.CREATED_BY, a.LAST_UPDATE_DATE, a.LAST_UPDATED_BY, a.ABOLITION_DATE, a.ABOLISHED_BY, a.PROGRAM_APPLICATION_ID, a.PROGRAM_ID, a.ACTIVE_FLAG FROM temporary_fin_subjectentry a WHERE customerId=P_customerId AND accPackageId=P_accPackageId;DROP TABLE temporary_fin_subjectentry;END
other.AC000036=CREATE PROCEDURE {dbName}.sp_fin_subjectentry(IN P_customerId varchar(10), IN P_accPackageId bigint(20))BEGIN DECLARE my_id1 varchar(100);DECLARE my_id2 varchar(100);DECLARE my_id3 varchar(100);DECLARE my_id4 varchar(100);DECLARE done INT DEFAULT FALSE;DECLARE My_Cursor CURSOR for(SELECT voucherId,autoId FROM fin_subjectentry WHERE customerId=P_customerId AND yyyy=substr(P_accPackageId,-4,4)AND voucherId IN(SELECT voucherId FROM fin_subjectentry WHERE subjectfullname1 like '\u672C\u5E74\u5229\u6DA6%' AND customerId=P_customerId AND yyyy=substr(P_accPackageId,-4,4))AND voucherId NOT IN(SELECT voucherId FROM fin_subjectentry WHERE subjectname1 like '\u672A\u5206\u914D\u5229\u6DA6%' AND customerId=P_customerId AND yyyy=substr(P_accPackageId,-4,4))AND subjectfullname1 not like '\u672C\u5E74\u5229\u6DA6%');DECLARE My_Cursor2 CURSOR FOR(SELECT voucherId,autoId FROM fin_subjectentry WHERE customerId=P_customerId AND yyyy=SUBSTR(P_accPackageId,-4,4)AND voucherId IN(SELECT voucherId FROM fin_subjectentry WHERE subjectname1 like '\u672A\u5206\u914D\u5229\u6DA6%' AND customerId=P_customerId AND yyyy=SUBSTR(P_accPackageId,-4,4))AND voucherId NOT IN(SELECT voucherId FROM fin_subjectentry WHERE subjectfullname1 LIKE '\u672C\u5E74\u5229\u6DA6%' AND customerId=P_customerId AND yyyy=SUBSTR(P_accPackageId,-4,4))AND subjectname1 not like '\u672A\u5206\u914D\u5229\u6DA6%');DECLARE CONTINUE HANDLER FOR NOT FOUND SET done=TRUE;OPEN My_Cursor;myLoop: LOOP FETCH My_Cursor into my_id1,my_id2;IF done THEN LEAVE myLoop;END IF;UPDATE fin_subjectentry SET isTransferVoucher='1' WHERE voucherId=my_id1 AND autoId=my_id2 AND customerId=P_customerId AND yyyy=substr(P_accPackageId,-4,4);COMMIT;END LOOP myLoop;CLOSE My_Cursor;SET done=FALSE;OPEN My_Cursor2;myLoop2: LOOP FETCH My_Cursor2 INTO my_id3,my_id4;IF done THEN LEAVE myLoop2;END IF;UPDATE fin_subjectentry SET isTransferVoucher='1' WHERE voucherId=my_id3 AND autoId=my_id4 AND customerId=P_customerId AND yyyy=SUBSTR(P_accPackageId,-4,4);COMMIT;END LOOP myLoop2;CLOSE My_Cursor2;END

########## EXCEL \u6570\u636E\u5BFC\u5165 EXCEL ##########
########## EXCEL \u4EC5\u4F59\u989D\u8868\u5BFC\u5165  EXCEL ##########
#\u6839\u636Eexcel\u63D2\u5165\u4F59\u989D\u8868
other.EXAC00001=INSERT INTO temp_faith.fin_account(accPackageId,customerId,subjectId,accName,subYearMonth,subMonth,dataName,debitRemain,creditRemain,debitOcc,creditOcc,debitOccNoTran,creditOccNoTran,tranDebitOcc,tranCreditOcc,remain,balance,debitTotalOcc,creditTotalOcc,direction,debitBalance,creditBalance,isLeaf1,level1,subjectFullName1,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) VALUES ({accPackageId},{customerId},{subjectId},{subjectName},{yyyy},{subMonth},{currency},{debitRemain},{creditRemain},{debitOcc},{creditOcc},{debitOccNoTran},{creditOccNoTran},{tranDebitOcc},{tranCreditOcc},{remain},{balance},{debitTotalOcc},{creditTotalOcc},{direction},{debitBalance},{creditBalance},{isLeaf1},{level1},{subjectFullName},{CREATION_DATE},{CREATED_BY},{LAST_UPDATE_DATE},{LAST_UPDATED_BY})
#\u6839\u636Eexcel\u63D2\u5165\u5916\u5E01\u4F59\u989D\u8868
other.EXAC00002=INSERT INTO temp_faith.fin_accountall(accPackageId,customerId,subjectId,accName,subYearMonth,subMonth,dataName,debitRemain,creditRemain,debitOcc,creditOcc,creditOccNoTran,debitOccNoTran,tranDebitOcc,tranCreditOcc,remain,balance,debitTotalOcc,creditTotalOcc,direction,debitBalance,creditBalance,isLeaf1,level1,subjectFullName1,debitRemainF,creditRemainF,debitOccF,creditOccF,debitOccNoTranF,creditOccNoTranF,tranDebitOccF,tranCreditOccF,remainF,balanceF,debitTotalOccF,creditTotalOccF,debitBalanceF,creditBalanceF,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) VALUES ({accPackageId},{customerId},{subjectId},{subjectName},{yyyy},{subMonth},{currency},{debitRemain},{creditRemain},{debitOcc},{creditOcc},{creditOccNoTran},{debitOccNoTran},{tranDebitOcc},{tranCreditOcc},{remain},{balance},{debitTotalOcc},{creditTotalOcc},{direction},{debitBalance},{creditBalance},{isLeaf1},{level1},{subjectFullName},{debitRemainF},{creditRemainF},{debitOccF},{creditOccF},{debitOccNoTranF},{creditOccNoTranF},{tranDebitOccF},{tranCreditOccF},{remainF},{balanceF},{debitTotalOccF},{creditTotalOccF},{debitBalanceF},{creditBalanceF},{CREATION_DATE},{CREATED_BY},{LAST_UPDATE_DATE},{LAST_UPDATED_BY})
#\u63D2\u5165\u79D1\u76EE\u8868
other.EXAC00003=INSERT INTO temp_faith.fin_accpkgsubject(accPackageId,customerId,yyyy,subjectId,subjectName,direction,currency,subjectFullName) SELECT DISTINCT accPackageId,customerId,subYearMonth AS yyyy,subjectId,accName AS subjectName,direction,dataName AS currency,subjectFullName1 AS subjectFullName FROM temp_faith.fin_account WHERE customerId = {customerId} AND subYearMonth = {yyyy} ORDER BY customerId,yyyy,subjectId
#\u66F4\u65B0\u79D1\u76EE\u8868\u5B57\u6BB5
other.EXAC00004=UPDATE temp_faith.fin_accpkgsubject SET level0 = {level1}, parentSubjectId = LEFT(subjectId,{level0}), subjectName = SUBSTRING_INDEX(SUBSTRING_INDEX(subjectFullName,'/',{level1}),'/',-1) WHERE customerId = {customerId} AND yyyy = {yyyy} AND LENGTH(subjectId) = {level}
other.EXAC00005=UPDATE temp_faith.fin_accpkgsubject a LEFT JOIN (SELECT a.customerId,a.yyyy,a.subjectId,IF(SUM(IF(b.subjectId IS NULL,0,1))>0,0,1) AS isLeaf FROM temp_faith.fin_accpkgsubject a LEFT JOIN temp_faith.fin_accpkgsubject b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND LEFT(b.subjectId,LENGTH(a.subjectId)) = a.subjectId AND b.subjectId <> a.subjectId WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} GROUP BY a.customerId,a.yyyy,a.subjectId) b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId SET a.isLeaf = b.isLeaf WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u8865\u5168\u4F59\u989D\u8868
#\u83B7\u53D6\u6240\u6709\u79D1\u76EE
other.EXAC00006=SELECT DISTINCT customerId,yyyy,subjectId FROM temp_faith.fin_accpkgsubject WHERE customerId = {customerId} AND yyyy = {yyyy} ORDER BY customerId,yyyy,subjectId
#\u63D2\u5165\u4E0D\u5B58\u5728\u7684\u6708\u4EFD
other.EXAC00007=INSERT INTO temp_faith.fin_account(accPackageId,customerId,subjectId,subYearMonth,subMonth,dataName,debitRemain,creditRemain,debitOcc,creditOcc,debitOccNoTran,creditOccNoTran,tranDebitOcc,tranCreditOcc,remain,balance,debitTotalOcc,creditTotalOcc,direction,debitBalance,creditBalance,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) SELECT * FROM (SELECT accPackageId,customerId,subjectId,subYearMonth,'1' AS subMonth,dataName,'0' AS debitRemain,'0' AS creditRemain,'0' AS debitOcc,'0' AS creditOcc,'0' AS debitOccNoTran,'0' AS creditOccNoTran,'0' AS tranDebitOcc,'0' AS tranCreditOcc,'0' AS remain,'0' AS balance,'0' AS debitTotalOcc,'0' AS creditTotalOcc,direction,'0' AS debitBalance,'0' AS creditBalance,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY FROM temp_faith.fin_account WHERE customerId = {customerId} AND subYearMonth = {yyyy} AND subjectId = {subjectId} GROUP BY customerId,subjectId,subYearMonth) a WHERE NOT EXISTS(SELECT accPackageId,customerId,subjectId,subYearMonth,subMonth FROM temp_faith.fin_account WHERE customerId = {customerId} AND subYearMonth = {yyyy} AND subMonth = 1 AND subjectId = {subjectId})
other.EXAC00008=INSERT INTO temp_faith.fin_account(accPackageId,customerId,subjectId,subYearMonth,subMonth,dataName,debitRemain,creditRemain,debitOcc,creditOcc,debitOccNoTran,creditOccNoTran,tranDebitOcc,tranCreditOcc,remain,balance,debitTotalOcc,creditTotalOcc,direction,debitBalance,creditBalance,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) SELECT * FROM (SELECT accPackageId,customerId,subjectId,subYearMonth,{subMonth} AS subMonth,dataName,SUM(CASE WHEN subMonth = {lastMonth} THEN debitBalance ELSE 0 END) AS debitRemain,SUM(CASE WHEN subMonth = {lastMonth} THEN creditBalance ELSE 0 END) AS creditRemain,'0' AS debitOcc,'0' AS creditOcc,'0' AS debitOccNoTran,'0' AS creditOccNoTran,'0' AS tranDebitOcc,'0' AS tranCreditOcc,SUM(CASE WHEN subMonth = {lastMonth} THEN balance ELSE 0 END) AS remain,SUM(CASE WHEN subMonth = {lastMonth} THEN balance ELSE 0 END) AS balance,SUM(debitOcc) AS debitTotalOcc,SUM(creditOcc) AS creditTotalOcc,direction,SUM(CASE WHEN subMonth = {lastMonth} THEN debitBalance ELSE 0 END) AS debitBalance,SUM(CASE WHEN subMonth = {lastMonth} THEN creditBalance ELSE 0 END) AS creditBalance,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY FROM temp_faith.fin_account WHERE customerId = {customerId} AND subYearMonth = {yyyy} AND subjectId = {subjectId} AND subMonth <= {subMonth}) a WHERE NOT EXISTS(SELECT accPackageId,customerId,subjectId,subYearMonth,subMonth FROM temp_faith.fin_account WHERE customerId = {customerId} AND subYearMonth = {yyyy} AND subjectId = {subjectId} AND subMonth = {subMonth})
#\u8865\u5168\u5916\u5E01\u4F59\u989D\u8868
#\u83B7\u53D6\u6240\u6709\u5916\u5E01\u79D1\u76EE
#other.EXAC00009=SELECT DISTINCT accPackageId,customerId,yyyy,subjectId,currency FROM( {sqlStr} ) a ORDER BY accPackageId,customerId,yyyy,subjectId,currency
#other.EXAC00010=(SELECT DISTINCT accPackageId,customerId,LEFT(subjectId,{level}) AS subjectId,subYearMonth AS yyyy,dataName AS currency FROM temp_faith.fin_accountall WHERE customerId = {customerId} AND subYearMonth = {yyyy} GROUP BY customerId,subYearMonth,LEFT(subjectId,{level}),dataName)
other.EXAC00010=SELECT DISTINCT accPackageId,customerId,subjectId,subYearMonth AS yyyy,dataName AS currency FROM temp_faith.fin_accountall WHERE customerId = {customerId} AND subYearMonth = {yyyy} ORDER BY customerId,subYearMonth,subjectId,dataName
#\u63D2\u5165\u4E0D\u5B58\u5728\u7684\u6708\u4EFD
other.EXAC00011=INSERT INTO temp_faith.fin_accountall(accPackageId,customerId,subjectId,subYearMonth,subMonth,dataName,debitRemain,creditRemain,debitOcc,creditOcc,debitOccNoTran,creditOccNoTran,tranDebitOcc,tranCreditOcc,remain,balance,debitTotalOcc,creditTotalOcc,direction,debitBalance,creditBalance,debitRemainF,creditRemainF,debitOccF,creditOccF,debitOccNoTranF,creditOccNoTranF,tranDebitOccF,tranCreditOccF,remainF,balanceF,debitTotalOccF,creditTotalOccF,debitBalanceF,creditBalanceF,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) SELECT * FROM (SELECT accPackageId,customerId,subjectId,subYearMonth,'1' AS subMonth,dataName,'0' AS debitRemain,'0' AS creditRemain,'0' AS debitOcc,'0' AS creditOcc,'0' AS debitOccNoTran,'0' AS creditOccNoTran,'0' AS tranDebitOcc,'0' AS tranCreditOcc,'0' AS remain,'0' AS balance,'0' AS debitTotalOcc,'0' AS creditTotalOcc,direction,'0' AS debitBalance,'0' AS creditBalance,'0' AS debitRemainF,'0' AS creditRemainF,'0' AS debitOccF,'0' AS creditOccF,'0' AS debitOccNoTranF,'0' AS creditOccNoTranF,'0' AS tranDebitOccF,'0' AS tranCreditOccF,'0' AS remainF,'0' AS balanceF,'0' AS debitTotalOccF,'0' AS creditTotalOccF,'0' AS debitBalanceF,'0' AS creditBalanceF,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY FROM temp_faith.fin_accountall WHERE customerId = {customerId} AND subYearMonth = {yyyy} AND subjectId = {subjectId} AND dataName = {currency} GROUP BY customerId,subjectId,subYearMonth,dataName) a WHERE NOT EXISTS(SELECT accPackageId,customerId,subjectId,subYearMonth,subMonth,dataName FROM temp_faith.fin_accountall WHERE customerId = {customerId} AND subYearMonth = {yyyy} AND subMonth = 1 AND subjectId = {subjectId} AND dataName = {currency})
other.EXAC00012=INSERT INTO temp_faith.fin_accountall(accPackageId,customerId,subjectId,subYearMonth,subMonth,dataName,debitRemain,creditRemain,debitOcc,creditOcc,debitOccNoTran,creditOccNoTran,tranDebitOcc,tranCreditOcc,remain,balance,debitTotalOcc,creditTotalOcc,direction,debitBalance,creditBalance,debitRemainF,creditRemainF,debitOccF,creditOccF,debitOccNoTranF,creditOccNoTranF,tranDebitOccF,tranCreditOccF,remainF,balanceF,debitTotalOccF,creditTotalOccF,debitBalanceF,creditBalanceF,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) SELECT * FROM (SELECT accPackageId,customerId,subjectId,subYearMonth,{subMonth} AS subMonth,dataName,SUM(CASE WHEN subMonth = {lastMonth} THEN debitBalance ELSE 0 END) AS debitRemain,SUM(CASE WHEN subMonth = {lastMonth} THEN creditBalance ELSE 0 END) AS creditRemain,'0' AS debitOcc,'0' AS creditOcc,'0' AS debitOccNoTran,'0' AS creditOccNoTran,'0' AS tranDebitOcc,'0' AS tranCreditOcc,SUM(CASE WHEN subMonth = {lastMonth} THEN balance ELSE 0 END) AS remain,SUM(CASE WHEN subMonth = {lastMonth} THEN balance ELSE 0 END) AS balance,SUM(debitOcc) AS debitTotalOcc,SUM(creditOcc) AS creditTotalOcc,direction,SUM(CASE WHEN subMonth = {lastMonth} THEN debitBalance ELSE 0 END) AS debitBalance,SUM(CASE WHEN subMonth = {lastMonth} THEN creditBalance ELSE 0 END) AS creditBalance,SUM(CASE WHEN subMonth = {lastMonth} THEN debitBalanceF ELSE 0 END) AS debitRemainF,SUM(CASE WHEN subMonth = {lastMonth} THEN creditBalanceF ELSE 0 END) AS creditRemainF,'0' AS debitOccF,'0' AS creditOccF,'0' AS debitOccNoTranF,'0' AS creditOccNoTranF,'0' AS tranDebitOccF,'0' AS tranCreditOccF,SUM(CASE WHEN subMonth = {lastMonth} THEN balanceF ELSE 0 END) AS remainF,SUM(CASE WHEN subMonth = {lastMonth} THEN balanceF ELSE 0 END) AS balanceF,SUM(debitOccF) AS debitTotalOccF,SUM(creditOccF) AS creditTotalOccF,SUM(CASE WHEN subMonth = {lastMonth} THEN debitBalanceF ELSE 0 END) AS debitBalanceF,SUM(CASE WHEN subMonth = {lastMonth} THEN creditBalanceF ELSE 0 END) AS creditBalanceF,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY FROM temp_faith.fin_accountall WHERE customerId = {customerId} AND subYearMonth = {yyyy} AND subjectId = {subjectId} AND subMonth <= {subMonth} AND dataName = {currency}) a WHERE NOT EXISTS(SELECT accPackageId,customerId,subjectId,subYearMonth,subMonth FROM temp_faith.fin_accountall WHERE customerId = {customerId} AND subYearMonth = {yyyy} AND subjectId = {subjectId} AND subMonth = {subMonth} AND dataName = {currency})
#\u83B7\u53D6\u6240\u6709\u4E0A\u7EA7\u79D1\u76EE\u5916\u5E01\u4F59\u989D\u8868
other.EXAC00013=SELECT b.subjectName,b.subjectFullName,b.level0 AS level1,b.isLeaf AS isLeaf1,a.* FROM (SELECT accPackageId,customerId,LEFT(subjectId,{level}) AS subjectId,subYearMonth AS yyyy,dataName AS currency,subMonth,SUM(debitRemain) AS debitRemain,SUM(creditRemain) AS creditRemain,SUM(debitOcc) AS debitOcc,SUM(creditOcc) AS creditOcc,SUM(debitOccNoTran) AS debitOccNoTran,SUM(creditOccNoTran) AS creditOccNoTran,SUM(tranDebitOcc) AS tranDebitOcc,SUM(tranCreditOcc) AS tranCreditOcc,SUM(remain) AS remain,SUM(balance) AS balance,SUM(debitTotalOcc) AS debitTotalOcc,SUM(creditTotalOcc) AS creditTotalOcc,direction,SUM(debitBalance) AS debitBalance,SUM(creditBalance) AS creditBalance,SUM(debitRemainF) AS debitRemainF,SUM(creditRemainF) AS creditRemainF,SUM(debitOccF) AS debitOccF,SUM(creditOccF) AS creditOccF,SUM(debitOccNoTranF) AS debitOccNoTranF,SUM(creditOccNoTranF) AS creditOccNoTranF,SUM(tranDebitOccF) AS tranDebitOccF,SUM(tranCreditOccF) AS tranCreditOccF,SUM(remainF) AS remainF,SUM(balanceF) AS balanceF,SUM(debitTotalOccF) AS debitTotalOccF,SUM(creditTotalOccF) AS creditTotalOccF,SUM(debitBalanceF) AS debitBalanceF,SUM(creditBalanceF) AS creditBalanceF FROM temp_faith.fin_accountall WHERE customerId = {customerId} AND subYearMonth = {yyyy} AND isLeaf1 = 1 AND subjectId != LEFT(subjectId,{level}) GROUP BY customerId,subYearMonth,LEFT(subjectId,{level}),dataName,subMonth ORDER BY customerId,subYearMonth,LEFT(subjectId,{level}),dataName,subMonth) a LEFT JOIN temp_faith.fin_accpkgsubject b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId
other.EXAC00014=SELECT IF(COUNT(0) > 0, 1, 0) AS hasData FROM temp_faith.fin_accountall WHERE customerId = {customerId} AND subYearMonth = {yyyy} AND subjectId = {subjectId} AND dataName = {currency} AND subMonth = {subMonth}
other.EXAC00015=INSERT INTO temp_faith.fin_accountall(accPackageId,customerId,subjectId,accName,subYearMonth,subMonth,dataName,debitRemain,creditRemain,debitOcc,creditOcc,creditOccNoTran,debitOccNoTran,tranDebitOcc,tranCreditOcc,remain,balance,debitTotalOcc,creditTotalOcc,direction,debitBalance,creditBalance,isLeaf1,level1,subjectFullName1,debitRemainF,creditRemainF,debitOccF,creditOccF,debitOccNoTranF,creditOccNoTranF,tranDebitOccF,tranCreditOccF,remainF,balanceF,debitTotalOccF,creditTotalOccF,debitBalanceF,creditBalanceF,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) VALUES ({accPackageId},{customerId},{subjectId},{subjectName},{yyyy},{subMonth},{currency},{debitRemain},{creditRemain},{debitOcc},{creditOcc},{creditOccNoTran},{debitOccNoTran},{tranDebitOcc},{tranCreditOcc},{remain},{balance},{debitTotalOcc},{creditTotalOcc},{direction},{debitBalance},{creditBalance},{isLeaf1},{level1},{subjectFullName},{debitRemainF},{creditRemainF},{debitOccF},{creditOccF},{debitOccNoTranF},{creditOccNoTranF},{tranDebitOccF},{tranCreditOccF},{remainF},{balanceF},{debitTotalOccF},{creditTotalOccF},{debitBalanceF},{creditBalanceF},{CREATION_DATE},{CREATED_BY},{LAST_UPDATE_DATE},{LAST_UPDATED_BY})
#\u66F4\u65B0\u4F59\u989D\u8868/\u5916\u5E01\u4F59\u989D\u8868 subjectName subjectFullName isLeaf level
other.EXAC00020=UPDATE temp_faith.fin_account a LEFT JOIN temp_faith.fin_accpkgsubject b ON b.customerId = a.customerId AND b.yyyy = a.subYearMonth AND b.subjectId = a.subjectId SET a.accName = b.subjectName,a.isLeaf1 = b.isLeaf,a.level1 = b.level0,a.subjectFullName1 = b.subjectFullName WHERE a.customerId = {customerId} AND a.subYearMonth = {yyyy}
other.EXAC00021=UPDATE temp_faith.fin_accountall a LEFT JOIN temp_faith.fin_accpkgsubject b ON b.customerId = a.customerId AND b.yyyy = a.subYearMonth AND b.subjectId = a.subjectId SET a.accName = b.subjectName,a.isLeaf1 = b.isLeaf,a.level1 = b.level0,a.subjectFullName1 = b.subjectFullName WHERE a.customerId = {customerId} AND a.subYearMonth = {yyyy}
#\u79D1\u76EE\u5E73\u8861\u6027\u6821\u9A8C
other.EXAC00030=SELECT GROUP_CONCAT(phxMsg) AS phxMsg FROM (SELECT CONCAT(subMonth,'\u6708\u79D1\u76EE:',GROUP_CONCAT(DISTINCT subjectId ORDER BY subjectId)) AS phxMsg FROM (SELECT subMonth,subjectId FROM temp_faith.fin_account WHERE customerId = {customerId} AND subYearMonth = {yyyy} AND direction*((debitRemain-creditRemain)+(debitOcc-creditOcc))<>direction*(debitBalance-creditBalance) UNION SELECT subMonth,subjectId FROM temp_faith.fin_accountall WHERE customerId = {customerId} AND subYearMonth = {yyyy} AND direction*((debitRemainF-creditRemainF)+(debitOccF-creditOccF))<>direction*(debitBalanceF-creditBalanceF)) a GROUP BY subMonth ORDER BY subMonth,subjectId) a
#\u6708\u5EA6\u79D1\u76EE\u4E0D\u540C\u6821\u9A8C
other.EXAC00031=SELECT GROUP_CONCAT(DISTINCT a.subjectId ORDER BY a.subjectId) AS subjectId FROM (SELECT subjectId,COUNT(0) AS ISEQUAL FROM temp_faith.fin_account WHERE customerId = {customerId} AND subYearMonth = {yyyy} GROUP BY subjectId,accName,direction,subjectFullName1) a LEFT JOIN (SELECT subjectId,COUNT(0) AS ISEQUAL FROM temp_faith.fin_account WHERE customerId = {customerId} AND subYearMonth = {yyyy} GROUP BY subjectId) b ON b.subjectId = a.subjectId WHERE a.ISEQUAL <> b.ISEQUAL
########## EXCEL \u4EC5\u4F59\u989D\u8868\u5BFC\u5165  EXCEL ##########
#\u5220\u5E93
other.EX000000=DROP DATABASE IF EXISTS {dbName}
#\u521B\u5EFA\u4E34\u65F6\u5E93,\u8868
other.EX000001=CREATE DATABASE {dbName} CHARACTER SET 'utf8' COLLATE 'utf8_general_ci'
other.EX000002=CREATE TABLE {dbName}.fin_account (autoId int(10) NOT NULL AUTO_INCREMENT COMMENT '\u81EA\u589EID',customerId int(10) NOT NULL DEFAULT '0' COMMENT '\u5BA2\u6237ID',yyyy int(10) NOT NULL DEFAULT '0' COMMENT '\u5E74',subMonth int(10) NOT NULL DEFAULT '0' COMMENT '\u6708',subjectId varchar(50) NOT NULL DEFAULT '0' COMMENT '\u79D1\u76EE\u7F16\u53F7',subjectName varchar(500) DEFAULT NULL COMMENT '\u79D1\u76EE\u540D\u79F0',direction int(2) DEFAULT '0' COMMENT '\u501F\u8D37\u65B9\u5411',currency varchar(30) DEFAULT NULL COMMENT '\u5E01\u79CD',debitRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u521D',creditRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u521D',remain decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u521D\u6570',debitOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D',creditOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D',tranDebitOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u635F\u76CA\u7ED3\u8F6C\u6570',tranCreditOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u635F\u76CA\u7ED3\u8F6C\u6570',debitOccNoTran decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D',creditOccNoTran decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D',debitTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570',creditTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570',debitBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u672B',creditBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u672B',balance decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u672B\u6570',isLeaf1 int(1) DEFAULT '0' COMMENT '\u662F\u5426\u672B\u7EA7\u79D1\u76EE',level1 int(1) DEFAULT '0' COMMENT '\u79D1\u76EE\u7EA7\u522B',subjectFullName varchar(800) DEFAULT NULL COMMENT '\u79D1\u76EE\u5168\u8DEF\u5F84',hasAssItem int(1) DEFAULT '0' COMMENT '\u662F\u5426\u542B\u8F85\u52A9\u6838\u7B97',s1 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s2 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s3 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s4 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s5 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s6 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s7 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s8 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s9 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s10 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s11 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s12 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s13 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s14 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s15 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s16 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s17 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s18 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s19 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s20 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s21 text COMMENT '\u5907\u7528\u5B57\u6BB5',s22 text COMMENT '\u5907\u7528\u5B57\u6BB5',s23 text COMMENT '\u5907\u7528\u5B57\u6BB5',s24 text COMMENT '\u5907\u7528\u5B57\u6BB5',s25 text COMMENT '\u5907\u7528\u5B57\u6BB5',CREATION_DATE datetime DEFAULT NULL COMMENT '\u521B\u5EFA\u65E5',CREATED_BY varchar(20) DEFAULT NULL COMMENT '\u521B\u5EFA\u4EBAID',LAST_UPDATE_DATE datetime DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u65E5',LAST_UPDATED_BY varchar(20) DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u4EBAID',ABOLITION_DATE datetime DEFAULT NULL COMMENT '\u5220\u9664\u65E5',ABOLISHED_BY varchar(20) DEFAULT NULL COMMENT '\u5220\u9664\u4EBAID',PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL COMMENT '\u4ECE\u54EA\u4E2A\u7CFB\u7EDF\u64CD\u4F5C\u7684\u6570\u636E',PROGRAM_ID varchar(20) DEFAULT NULL COMMENT '\u54EA\u4E2A\u7A0B\u5E8F\u64CD\u4F5C\u7684\u6570\u636E',ACTIVE_FLAG varchar(1) DEFAULT '1' COMMENT '0:\u65E0\u6548\u6570\u636E\uFF1B1\uFF1A\u6709\u6548\u6570\u636E',PRIMARY KEY (autoId) USING BTREE,UNIQUE KEY UniqueKey (customerId,yyyy,subMonth,subjectId) USING BTREE COMMENT '\u552F\u4E00key') ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u79D1\u76EE\u4F59\u989D\u8868'
other.EX000003=CREATE TABLE {dbName}.fin_accountall (autoId int(10) NOT NULL AUTO_INCREMENT COMMENT '\u81EA\u589EID',customerId int(10) NOT NULL DEFAULT '0' COMMENT '\u5BA2\u6237ID',yyyy int(10) NOT NULL DEFAULT '0' COMMENT '\u5E74',subMonth int(10) NOT NULL DEFAULT '0' COMMENT '\u6708',subjectId varchar(50) NOT NULL DEFAULT '0' COMMENT '\u79D1\u76EE\u7F16\u53F7',subjectName varchar(500) DEFAULT NULL COMMENT '\u79D1\u76EE\u540D\u79F0',direction int(2) DEFAULT '0' COMMENT '\u501F\u8D37\u65B9\u5411',currency varchar(30) NOT NULL DEFAULT '0' COMMENT '\u5E01\u79CD',debitRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u521D',creditRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u521D',remain decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u521D\u6570',debitOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D',creditOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D',tranDebitOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u635F\u76CA\u7ED3\u8F6C\u6570',tranCreditOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u635F\u76CA\u7ED3\u8F6C\u6570',debitOccNoTran decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D',creditOccNoTran decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D',debitTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570',creditTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570',debitBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u672B',creditBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u672B',balance decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u672B\u6570',debitRemainF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u521D(\u5916\u5E01)',creditRemainF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u521D(\u5916\u5E01)',remainF decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u521D\u6570(\u5916\u5E01)',debitOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D(\u5916\u5E01)',creditOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D(\u5916\u5E01)',tranDebitOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u635F\u76CA\u7ED3\u8F6C\u6570(\u5916\u5E01)',tranCreditOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u635F\u76CA\u7ED3\u8F6C\u6570(\u5916\u5E01)',debitOccNoTranF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D(\u5916\u5E01)',creditOccNoTranF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D(\u5916\u5E01)',debitTotalOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570(\u5916\u5E01)',creditTotalOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570(\u5916\u5E01)',debitBalanceF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u672B(\u5916\u5E01)',creditBalanceF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u672B(\u5916\u5E01)',balanceF decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u672B\u6570(\u5916\u5E01)',isLeaf1 int(1) DEFAULT '0' COMMENT '\u662F\u5426\u672B\u7EA7\u79D1\u76EE',level1 int(1) DEFAULT '0' COMMENT '\u79D1\u76EE\u7EA7\u522B',subjectFullName varchar(800) DEFAULT NULL COMMENT '\u79D1\u76EE\u5168\u8DEF\u5F84',hasAssItem int(1) DEFAULT '0' COMMENT '\u662F\u5426\u542B\u8F85\u52A9\u6838\u7B97',s1 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s2 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s3 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s4 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s5 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s6 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s7 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s8 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s9 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s10 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s11 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s12 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s13 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s14 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s15 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s16 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s17 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s18 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s19 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s20 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s21 text COMMENT '\u5907\u7528\u5B57\u6BB5',s22 text COMMENT '\u5907\u7528\u5B57\u6BB5',s23 text COMMENT '\u5907\u7528\u5B57\u6BB5',s24 text COMMENT '\u5907\u7528\u5B57\u6BB5',s25 text COMMENT '\u5907\u7528\u5B57\u6BB5',CREATION_DATE datetime DEFAULT NULL COMMENT '\u521B\u5EFA\u65E5',CREATED_BY varchar(20) DEFAULT NULL COMMENT '\u521B\u5EFA\u4EBAID',LAST_UPDATE_DATE datetime DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u65E5',LAST_UPDATED_BY varchar(20) DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u4EBAID',ABOLITION_DATE datetime DEFAULT NULL COMMENT '\u5220\u9664\u65E5',ABOLISHED_BY varchar(20) DEFAULT NULL COMMENT '\u5220\u9664\u4EBAID',PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL COMMENT '\u4ECE\u54EA\u4E2A\u7CFB\u7EDF\u64CD\u4F5C\u7684\u6570\u636E',PROGRAM_ID varchar(20) DEFAULT NULL COMMENT '\u54EA\u4E2A\u7A0B\u5E8F\u64CD\u4F5C\u7684\u6570\u636E',ACTIVE_FLAG varchar(1) DEFAULT '1' COMMENT '0:\u65E0\u6548\u6570\u636E\uFF1B1\uFF1A\u6709\u6548\u6570\u636E',PRIMARY KEY (autoId) USING BTREE,UNIQUE KEY UniqueKey (customerId,yyyy,subMonth,subjectId,currency) USING BTREE COMMENT '\u552F\u4E00key') ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u5916\u5E01\u79D1\u76EE\u4F59\u989D\u8868'
other.EX000004=CREATE TABLE {dbName}.fin_accpkgsubject (autoId int(10) NOT NULL AUTO_INCREMENT COMMENT '\u81EA\u589EID',customerId int(10) NOT NULL DEFAULT '0' COMMENT '\u5BA2\u6237ID',yyyy int(10) NOT NULL DEFAULT '0' COMMENT '\u5E74',subjectId varchar(50) NOT NULL COMMENT '\u79D1\u76EE\u7F16\u53F7',parentSubjectId varchar(50) DEFAULT NULL COMMENT '\u79D1\u76EE\u7F16\u53F7',subjectFullId varchar(200) DEFAULT '' COMMENT '\u79D1\u76EE\u7F16\u53F7\u5168\u8DEF\u5F84',subjectName varchar(500) DEFAULT '' COMMENT '\u79D1\u76EE\u540D\u79F0',direction int(2) DEFAULT '0' COMMENT '\u501F\u8D37\u65B9\u5411',currency varchar(30) DEFAULT '' COMMENT '\u5E01\u79CD',isLeaf1 int(1) DEFAULT NULL COMMENT '\u662F\u5426\u672B\u7EA7\u79D1\u76EE',level1 int(1) DEFAULT '1' COMMENT '\u79D1\u76EE\u7EA7\u522B',subjectFullName varchar(800) DEFAULT NULL COMMENT '\u79D1\u76EE\u540D\u79F0\u5168\u8DEF\u5F84',s1 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s2 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s3 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s4 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s5 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s6 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s7 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s8 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s9 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s10 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s11 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s12 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s13 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s14 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s15 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s16 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s17 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s18 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s19 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s20 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s21 text COMMENT '\u5907\u7528\u5B57\u6BB5',s22 text COMMENT '\u5907\u7528\u5B57\u6BB5',s23 text COMMENT '\u5907\u7528\u5B57\u6BB5',s24 text COMMENT '\u5907\u7528\u5B57\u6BB5',s25 text COMMENT '\u5907\u7528\u5B57\u6BB5',CREATION_DATE datetime DEFAULT NULL COMMENT '\u521B\u5EFA\u65E5',CREATED_BY varchar(20) DEFAULT NULL COMMENT '\u521B\u5EFA\u4EBAID',LAST_UPDATE_DATE datetime DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u65E5',LAST_UPDATED_BY varchar(20) DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u4EBAID',ABOLITION_DATE datetime DEFAULT NULL COMMENT '\u5220\u9664\u65E5',ABOLISHED_BY varchar(20) DEFAULT NULL COMMENT '\u5220\u9664\u4EBAID',PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL COMMENT '\u4ECE\u54EA\u4E2A\u7CFB\u7EDF\u64CD\u4F5C\u7684\u6570\u636E',PROGRAM_ID varchar(20) DEFAULT NULL COMMENT '\u54EA\u4E2A\u7A0B\u5E8F\u64CD\u4F5C\u7684\u6570\u636E',ACTIVE_FLAG varchar(1) DEFAULT '1' COMMENT '0:\u65E0\u6548\u6570\u636E\uFF1B1\uFF1A\u6709\u6548\u6570\u636E',PRIMARY KEY (autoId) USING BTREE,UNIQUE KEY UniqueKey (customerId,yyyy,subjectId) USING BTREE COMMENT '\u552F\u4E00key') ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u79D1\u76EE\u8868'
other.EX000005=CREATE TABLE {dbName}.fin_assitem (autoId int(10) NOT NULL AUTO_INCREMENT COMMENT '\u81EA\u589EID',customerId int(10) NOT NULL DEFAULT '0' COMMENT '\u5BA2\u6237ID',yyyy int(10) NOT NULL DEFAULT '0' COMMENT '\u5E74',subjectId varchar(50) NOT NULL DEFAULT '0' COMMENT '\u79D1\u76EE\u7F16\u53F7',subjectName varchar(500) DEFAULT NULL COMMENT '\u79D1\u76EE\u540D\u79F0',assItemId varchar(100) NOT NULL DEFAULT '0' COMMENT '\u6838\u7B97\u540D\u7F16\u53F7',assItemName varchar(500) DEFAULT NULL COMMENT '\u6838\u7B97\u9879\u540D',direction int(2) DEFAULT '0' COMMENT '\u501F\u8D37\u65B9\u5411',currency varchar(30) DEFAULT NULL COMMENT '\u5E01\u79CD',parentAssItemId varchar(100) DEFAULT NULL COMMENT '\u4E0A\u7EA7\u6838\u7B97\u9879\u7F16\u53F7',assItemFullId varchar(200) DEFAULT NULL COMMENT '\u6838\u7B97\u7F16\u53F7\u5168\u8DEF\u5F84',assTotalName varchar(800) DEFAULT NULL COMMENT '\u6838\u7B97\u9879\u5168\u79F0',subjectFullId varchar(200) DEFAULT NULL COMMENT '\u79D1\u76EE\u7F16\u53F7\u5168\u8DEF\u5F84',subjectFullName varchar(800) DEFAULT NULL COMMENT '\u79D1\u76EE\u5168\u8DEF\u5F84',isLeaf1 int(1) DEFAULT '0' COMMENT '\u662F\u5426\u672B\u7EA7\u6838\u7B97',level1 int(1) DEFAULT '0' COMMENT '\u6838\u7B97\u7EA7\u522B',s1 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s2 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s3 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s4 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s5 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s6 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s7 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s8 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s9 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s10 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s11 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s12 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s13 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s14 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s15 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s16 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s17 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s18 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s19 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s20 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s21 text COMMENT '\u5907\u7528\u5B57\u6BB5',s22 text COMMENT '\u5907\u7528\u5B57\u6BB5',s23 text COMMENT '\u5907\u7528\u5B57\u6BB5',s24 text COMMENT '\u5907\u7528\u5B57\u6BB5',s25 text COMMENT '\u5907\u7528\u5B57\u6BB5',CREATION_DATE datetime DEFAULT NULL COMMENT '\u521B\u5EFA\u65E5',CREATED_BY varchar(20) DEFAULT NULL COMMENT '\u521B\u5EFA\u4EBAID',LAST_UPDATE_DATE datetime DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u65E5',LAST_UPDATED_BY varchar(20) DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u4EBAID',ABOLITION_DATE datetime DEFAULT NULL COMMENT '\u5220\u9664\u65E5',ABOLISHED_BY varchar(20) DEFAULT NULL COMMENT '\u5220\u9664\u4EBAID',PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL COMMENT '\u4ECE\u54EA\u4E2A\u7CFB\u7EDF\u64CD\u4F5C\u7684\u6570\u636E',PROGRAM_ID varchar(20) DEFAULT NULL COMMENT '\u54EA\u4E2A\u7A0B\u5E8F\u64CD\u4F5C\u7684\u6570\u636E',ACTIVE_FLAG varchar(1) DEFAULT '1' COMMENT '0:\u65E0\u6548\u6570\u636E\uFF1B1\uFF1A\u6709\u6548\u6570\u636E',PRIMARY KEY (autoId),UNIQUE KEY UniqueKey (customerId,yyyy,subjectId,assItemId) USING BTREE COMMENT '\u552F\u4E00key') ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u6838\u7B97\u79D1\u76EE\u8868'
other.EX000006=CREATE TABLE {dbName}.fin_assitementry (autoId int(10) NOT NULL AUTO_INCREMENT COMMENT '\u81EA\u589EID',customerId int(10) NOT NULL DEFAULT '0' COMMENT '\u5BA2\u6237ID',yyyy int(10) NOT NULL DEFAULT '0' COMMENT '\u5E74',month int(2) DEFAULT '0' COMMENT '\u6708',subjectId varchar(50) NOT NULL DEFAULT '0' COMMENT '\u79D1\u76EE\u7F16\u53F7',assItemId varchar(100) NOT NULL DEFAULT '0' COMMENT '\u6838\u7B97\u9879\u7F16\u53F7',oldVoucherId varchar(50) DEFAULT NULL COMMENT '\u539F\u59CB\u6570\u636E\u51ED\u8BC1ID',voucherId varchar(50) DEFAULT NULL COMMENT '\u7CFB\u7EDF\u751F\u6210\u51ED\u8BC1ID',vchDate varchar(10) DEFAULT NULL COMMENT '\u51ED\u8BC1\u65E5\u671F',vchTime varchar(15) DEFAULT NULL COMMENT '\u51ED\u8BC1\u65F6\u95F4',typeId varchar(200) DEFAULT NULL COMMENT '\u51ED\u8BC1\u7C7B\u578B',serail int(10) DEFAULT '0' COMMENT '\u5206\u5F55\u53F7',summary longtext DEFAULT NULL COMMENT '\u6458\u8981',direction int(2) DEFAULT '0' COMMENT '\u501F\u8D37\u65B9\u5411',currency varchar(30) DEFAULT NULL COMMENT '\u5E01\u79CD',occurValue decimal(30,4) DEFAULT '0.0000' COMMENT '\u53D1\u751F\u989D(\u672C\u4F4D\u5E01)',currRate decimal(30,4) DEFAULT '0.0000' COMMENT '\u6C47\u7387',currValue decimal(30,4) DEFAULT '0.0000' COMMENT '\u53D1\u751F\u989D(\u539F\u5E01)',voucherFillUser varchar(50) DEFAULT NULL COMMENT '\u5236\u5355\u4EBA',voucherKeepUser varchar(50) DEFAULT NULL COMMENT '\u8BB0\u8D26\u4EBA',voucherAuditUser varchar(50) DEFAULT NULL COMMENT '\u5BA1\u6838\u4EBA',quantity decimal(30,4) DEFAULT '0.0000' COMMENT '\u6570\u91CF',unitPrice decimal(30,4) DEFAULT '0.0000' COMMENT '\u5355\u4EF7',unitName varchar(20) DEFAULT NULL COMMENT '\u5355\u4F4D',subjectName varchar(500) DEFAULT '' COMMENT '\u79D1\u76EE\u540D\u79F0',subjectFullName varchar(800) DEFAULT NULL COMMENT '\u79D1\u76EE\u5168\u8DEF\u5F84',assItemName varchar(500) DEFAULT NULL COMMENT '\u6838\u7B97\u9879\u540D',assTotalName varchar(800) DEFAULT NULL COMMENT '\u6838\u7B97\u9879\u5168\u79F0',isTransferVoucher int(1) DEFAULT '0' COMMENT '\u662F\u5426\u7ED3\u8F6C\u51ED\u8BC1 0:\u5426; 1:\u662F',subjectEntryId varchar(50) DEFAULT NULL COMMENT '\u5173\u8054\u660E\u548C\u6838\u7B97\u660E\u7EC6',s1 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s2 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s3 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s4 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s5 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s6 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s7 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s8 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s9 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s10 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s11 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s12 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s13 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s14 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s15 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s16 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s17 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s18 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s19 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s20 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s21 text COMMENT '\u5907\u7528\u5B57\u6BB5',s22 text COMMENT '\u5907\u7528\u5B57\u6BB5',s23 text COMMENT '\u5907\u7528\u5B57\u6BB5',s24 text COMMENT '\u5907\u7528\u5B57\u6BB5',s25 text COMMENT '\u5907\u7528\u5B57\u6BB5',CREATION_DATE datetime DEFAULT NULL COMMENT '\u521B\u5EFA\u65E5',CREATED_BY varchar(20) DEFAULT NULL COMMENT '\u521B\u5EFA\u4EBAID',LAST_UPDATE_DATE datetime DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u65E5',LAST_UPDATED_BY varchar(20) DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u4EBAID',ABOLITION_DATE datetime DEFAULT NULL COMMENT '\u5220\u9664\u65E5',ABOLISHED_BY varchar(20) DEFAULT NULL COMMENT '\u5220\u9664\u4EBAID',PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL COMMENT '\u4ECE\u54EA\u4E2A\u7CFB\u7EDF\u64CD\u4F5C\u7684\u6570\u636E',PROGRAM_ID varchar(20) DEFAULT NULL COMMENT '\u54EA\u4E2A\u7A0B\u5E8F\u64CD\u4F5C\u7684\u6570\u636E',ACTIVE_FLAG varchar(1) DEFAULT '1' COMMENT '0:\u65E0\u6548\u6570\u636E\uFF1B1\uFF1A\u6709\u6548\u6570\u636E',PRIMARY KEY (autoId),KEY SearchKey (customerId,yyyy,month,subjectId,assItemId,oldVoucherId,voucherId,vchDate),KEY SubjectEntryKey (customerId,yyyy,vchDate,voucherId,serail),KEY inx_subjectentryid (subjectEntryId)) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u6838\u7B97\u5206\u5F55\u8868'
other.EX000007=CREATE TABLE {dbName}.fin_assitementryacc (autoId int(10) NOT NULL AUTO_INCREMENT COMMENT '\u81EA\u589EID',customerId int(10) NOT NULL DEFAULT '0' COMMENT '\u5BA2\u6237ID',yyyy int(10) NOT NULL DEFAULT '0' COMMENT '\u5E74',subMonth int(10) NOT NULL DEFAULT '0' COMMENT '\u6708',subjectId varchar(50) NOT NULL DEFAULT '0' COMMENT '\u79D1\u76EE\u7F16\u53F7',subjectName varchar(500) DEFAULT NULL COMMENT '\u79D1\u76EE\u540D\u79F0',assItemId varchar(100) NOT NULL DEFAULT '0' COMMENT '\u6838\u7B97\u9879\u7F16\u53F7',assItemName varchar(500) DEFAULT NULL COMMENT '\u6838\u7B97\u9879\u540D\u79F0',direction int(2) DEFAULT '0' COMMENT '\u501F\u8D37\u65B9\u5411',currency varchar(30) DEFAULT NULL COMMENT '\u5E01\u79CD',debitRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u521D',creditRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u521D',remain decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u521D\u6570',debitOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D',creditOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D',tranDebitOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u635F\u76CA\u7ED3\u8F6C\u6570',tranCreditOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u635F\u76CA\u7ED3\u8F6C\u6570',debitOccNoTran decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D',creditOccNoTran decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D',debitTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570',creditTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570',debitBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u672B',creditBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u672B',balance decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u672B\u6570',isLeaf1 int(1) DEFAULT '0' COMMENT '\u662F\u5426\u672B\u7EA7\u6838\u7B97',level1 int(1) DEFAULT '0' COMMENT '\u6838\u7B97\u7EA7\u522B',subjectFullName varchar(800) DEFAULT NULL COMMENT '\u79D1\u76EE\u5168\u8DEF\u5F84',assTotalName varchar(800) DEFAULT NULL COMMENT '\u6838\u7B97\u9879\u5168\u79F0',s1 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s2 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s3 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s4 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s5 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s6 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s7 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s8 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s9 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s10 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s11 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s12 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s13 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s14 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s15 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s16 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s17 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s18 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s19 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s20 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s21 text COMMENT '\u5907\u7528\u5B57\u6BB5',s22 text COMMENT '\u5907\u7528\u5B57\u6BB5',s23 text COMMENT '\u5907\u7528\u5B57\u6BB5',s24 text COMMENT '\u5907\u7528\u5B57\u6BB5',s25 text COMMENT '\u5907\u7528\u5B57\u6BB5',CREATION_DATE datetime DEFAULT NULL COMMENT '\u521B\u5EFA\u65E5',CREATED_BY varchar(20) DEFAULT NULL COMMENT '\u521B\u5EFA\u4EBAID',LAST_UPDATE_DATE datetime DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u65E5',LAST_UPDATED_BY varchar(20) DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u4EBAID',ABOLITION_DATE datetime DEFAULT NULL COMMENT '\u5220\u9664\u65E5',ABOLISHED_BY varchar(20) DEFAULT NULL COMMENT '\u5220\u9664\u4EBAID',PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL COMMENT '\u4ECE\u54EA\u4E2A\u7CFB\u7EDF\u64CD\u4F5C\u7684\u6570\u636E',PROGRAM_ID varchar(20) DEFAULT NULL COMMENT '\u54EA\u4E2A\u7A0B\u5E8F\u64CD\u4F5C\u7684\u6570\u636E',ACTIVE_FLAG varchar(1) DEFAULT '1' COMMENT '0:\u65E0\u6548\u6570\u636E\uFF1B1\uFF1A\u6709\u6548\u6570\u636E',PRIMARY KEY (autoId) USING BTREE,UNIQUE KEY UniqueKey (customerId,yyyy,subMonth,subjectId,assItemId) USING BTREE COMMENT '\u552F\u4E00key') ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u79D1\u76EE\u6838\u7B97\u4F59\u989D\u8868'
other.EX000008=CREATE TABLE {dbName}.fin_assitementryaccall (autoId int(10) NOT NULL AUTO_INCREMENT COMMENT '\u81EA\u589EID',customerId int(10) NOT NULL DEFAULT '0' COMMENT '\u5BA2\u6237ID',yyyy int(10) NOT NULL DEFAULT '0' COMMENT '\u5E74',subMonth int(10) NOT NULL DEFAULT '0' COMMENT '\u6708',subjectId varchar(50) NOT NULL DEFAULT '0' COMMENT '\u79D1\u76EE\u7F16\u53F7',subjectName varchar(500) DEFAULT NULL COMMENT '\u79D1\u76EE\u540D\u79F0',assItemId varchar(100) NOT NULL DEFAULT '0' COMMENT '\u6838\u7B97\u9879\u7F16\u53F7',assItemName varchar(500) DEFAULT NULL COMMENT '\u6838\u7B97\u9879\u540D\u79F0',direction int(2) DEFAULT '0' COMMENT '\u501F\u8D37\u65B9\u5411',currency varchar(30) DEFAULT NULL COMMENT '\u5E01\u79CD',debitRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u521D',creditRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u521D',remain decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u521D\u6570',debitOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D',creditOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D',tranDebitOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u635F\u76CA\u7ED3\u8F6C\u6570',tranCreditOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u635F\u76CA\u7ED3\u8F6C\u6570',debitOccNoTran decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D',creditOccNoTran decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D',debitTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570',creditTotalOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570',debitBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u672B',creditBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u672B',balance decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u672B\u6570',debitRemainF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u521D(\u5916\u5E01)',creditRemainF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u521D(\u5916\u5E01)',remainF decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u521D\u6570(\u5916\u5E01)',debitOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D(\u5916\u5E01)',creditOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D(\u5916\u5E01)',tranDebitOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u635F\u76CA\u7ED3\u8F6C\u6570(\u5916\u5E01)',tranCreditOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u635F\u76CA\u7ED3\u8F6C\u6570(\u5916\u5E01)',debitOccNoTranF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D(\u5916\u5E01)',creditOccNoTranF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u5254\u9664\u7ED3\u8F6C\u53D1\u751F\u989D(\u5916\u5E01)',debitTotalOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570(\u5916\u5E01)',creditTotalOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D\u7D2F\u8BA1\u6570(\u5916\u5E01)',debitBalanceF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u672B(\u5916\u5E01)',creditBalanceF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u672B(\u5916\u5E01)',balanceF decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u672B\u6570(\u5916\u5E01)',isLeaf1 int(1) DEFAULT '0' COMMENT '\u662F\u5426\u672B\u7EA7\u6838\u7B97',level1 int(1) DEFAULT '0' COMMENT '\u6838\u7B97\u7EA7\u522B',subjectFullName varchar(800) DEFAULT NULL COMMENT '\u79D1\u76EE\u5168\u8DEF\u5F84',assTotalName varchar(800) DEFAULT NULL COMMENT '\u6838\u7B97\u9879\u5168\u79F0',s1 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s2 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s3 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s4 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s5 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s6 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s7 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s8 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s9 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s10 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s11 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s12 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s13 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s14 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s15 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s16 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s17 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s18 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s19 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s20 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s21 text COMMENT '\u5907\u7528\u5B57\u6BB5',s22 text COMMENT '\u5907\u7528\u5B57\u6BB5',s23 text COMMENT '\u5907\u7528\u5B57\u6BB5',s24 text COMMENT '\u5907\u7528\u5B57\u6BB5',s25 text COMMENT '\u5907\u7528\u5B57\u6BB5',CREATION_DATE datetime DEFAULT NULL COMMENT '\u521B\u5EFA\u65E5',CREATED_BY varchar(20) DEFAULT NULL COMMENT '\u521B\u5EFA\u4EBAID',LAST_UPDATE_DATE datetime DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u65E5',LAST_UPDATED_BY varchar(20) DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u4EBAID',ABOLITION_DATE datetime DEFAULT NULL COMMENT '\u5220\u9664\u65E5',ABOLISHED_BY varchar(20) DEFAULT NULL COMMENT '\u5220\u9664\u4EBAID',PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL COMMENT '\u4ECE\u54EA\u4E2A\u7CFB\u7EDF\u64CD\u4F5C\u7684\u6570\u636E',PROGRAM_ID varchar(20) DEFAULT NULL COMMENT '\u54EA\u4E2A\u7A0B\u5E8F\u64CD\u4F5C\u7684\u6570\u636E',ACTIVE_FLAG varchar(1) DEFAULT '1' COMMENT '0:\u65E0\u6548\u6570\u636E\uFF1B1\uFF1A\u6709\u6548\u6570\u636E',PRIMARY KEY (autoId) USING BTREE,UNIQUE KEY UniqueKey (customerId,yyyy,subMonth,subjectId,assItemId,currency) USING BTREE COMMENT '\u552F\u4E00key') ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u5916\u5E01\u79D1\u76EE\u6838\u7B97\u4F59\u989D\u8868'
other.EX000009=CREATE TABLE {dbName}.fin_subjectentry (autoId int(10) NOT NULL AUTO_INCREMENT COMMENT '\u81EA\u589EID',customerId int(10) NOT NULL DEFAULT '0' COMMENT '\u5BA2\u6237ID',yyyy int(10) NOT NULL DEFAULT '0' COMMENT '\u5E74',month int(2) DEFAULT '0' COMMENT '\u6708',subjectId varchar(50) NOT NULL DEFAULT '0' COMMENT '\u79D1\u76EE\u7F16\u53F7',oldVoucherId varchar(50) DEFAULT NULL COMMENT '\u539F\u59CB\u6570\u636E\u51ED\u8BC1ID',voucherId varchar(50) DEFAULT NULL COMMENT '\u7CFB\u7EDF\u751F\u6210\u51ED\u8BC1ID',vchDate varchar(10) DEFAULT NULL COMMENT '\u51ED\u8BC1\u65E5\u671F',vchTime varchar(15) DEFAULT NULL COMMENT '\u51ED\u8BC1\u65F6\u95F4',typeId varchar(200) DEFAULT NULL COMMENT '\u51ED\u8BC1\u7C7B\u578B',serail int(10) DEFAULT '0' COMMENT '\u5206\u5F55\u53F7',summary longtext DEFAULT NULL COMMENT '\u6458\u8981',direction int(2) DEFAULT '0' COMMENT '\u501F\u8D37\u65B9\u5411',currency varchar(30) DEFAULT NULL COMMENT '\u5E01\u79CD',occurValue decimal(30,4) DEFAULT '0.0000' COMMENT '\u53D1\u751F\u989D(\u672C\u4F4D\u5E01)',currRate decimal(30,4) DEFAULT '0.0000' COMMENT '\u6C47\u7387',currValue decimal(30,4) DEFAULT '0.0000' COMMENT '\u53D1\u751F\u989D(\u539F\u5E01)',voucherFillUser varchar(50) DEFAULT NULL COMMENT '\u5236\u5355\u4EBA',voucherKeepUser varchar(50) DEFAULT NULL COMMENT '\u8BB0\u8D26\u4EBA',voucherAuditUser varchar(50) DEFAULT NULL COMMENT '\u5BA1\u6838\u4EBA',quantity decimal(30,4) DEFAULT '0.0000' COMMENT '\u6570\u91CF',unitPrice decimal(30,4) DEFAULT '0.0000' COMMENT '\u5355\u4EF7',unitName varchar(20) DEFAULT NULL COMMENT '\u5355\u4F4D',subjectName varchar(500) DEFAULT NULL COMMENT '\u79D1\u76EE\u540D\u79F0',subjectFullName varchar(800) DEFAULT NULL COMMENT '\u79D1\u76EE\u5168\u8DEF\u5F84',debitsubjects text COMMENT '\u501F\u65B9\u79D1\u76EE',creditsubjects text COMMENT '\u8D37\u65B9\u79D1\u76EE',drCount int(11) DEFAULT '0' COMMENT '\u51ED\u8BC1\u501F\u65B9\u79D1\u76EE\u6570',crCount int(11) DEFAULT '0' COMMENT '\u51ED\u8BC1\u8D37\u65B9\u79D1\u76EE\u6570',voucherDebitOcc decimal(30,4) DEFAULT NULL COMMENT '\u51ED\u8BC1\u501F\u65B9\u53D1\u751F\u989D\u5408\u8BA1',voucherCreditOcc decimal(30,4) DEFAULT NULL COMMENT '\u51ED\u8BC1\u8D37\u65B9\u53D1\u751F\u989D\u5408\u8BA1',oppositeAccountTop text COMMENT '\u5BF9\u65B9\u79D1\u76EE\u4E00\u7EA7',oppositeAccountLast text COMMENT '\u5BF9\u65B9\u79D1\u76EE\u672B\u7EA7',oppositeTopSubjectValue text COMMENT '\u5BF9\u65B9\u79D1\u76EE\u91D1\u989D(\u4E00\u7EA7\u79D1\u76EE)',oppositeSubjectValue text COMMENT '\u5BF9\u65B9\u79D1\u76EE\u91D1\u989D(\u672B\u7EA7\u79D1\u76EE)',correspondOccurValue decimal(30,4) DEFAULT '0.0000' COMMENT '\u5BF9\u5E94\u53D1\u751F\u989D',voucherAffixCount int(10) DEFAULT '0' COMMENT '\u9644\u4EF6\u5F20\u6570',voucherDirector varchar(20) DEFAULT NULL COMMENT '\u8D22\u52A1\u4E3B\u7BA1',isTransferVoucher int(1) DEFAULT '0' COMMENT '\u662F\u5426\u7ED3\u8F6C\u51ED\u8BC1 0:\u5426; 1:\u662F',subjectEntryId varchar(50) DEFAULT NULL COMMENT '\u5173\u8054\u660E\u548C\u6838\u7B97\u660E\u7EC6',s1 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s2 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s3 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s4 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s5 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s6 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s7 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s8 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s9 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s10 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s11 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s12 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s13 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s14 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s15 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s16 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s17 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s18 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s19 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s20 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s21 text COMMENT '\u5907\u7528\u5B57\u6BB5',s22 text COMMENT '\u5907\u7528\u5B57\u6BB5',s23 text COMMENT '\u5907\u7528\u5B57\u6BB5',s24 text COMMENT '\u5907\u7528\u5B57\u6BB5',s25 text COMMENT '\u5907\u7528\u5B57\u6BB5',CREATION_DATE datetime DEFAULT NULL COMMENT '\u521B\u5EFA\u65E5',CREATED_BY varchar(20) DEFAULT NULL COMMENT '\u521B\u5EFA\u4EBAID',LAST_UPDATE_DATE datetime DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u65E5',LAST_UPDATED_BY varchar(20) DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u4EBAID',ABOLITION_DATE datetime DEFAULT NULL COMMENT '\u5220\u9664\u65E5',ABOLISHED_BY varchar(20) DEFAULT NULL COMMENT '\u5220\u9664\u4EBAID',PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL COMMENT '\u4ECE\u54EA\u4E2A\u7CFB\u7EDF\u64CD\u4F5C\u7684\u6570\u636E',PROGRAM_ID varchar(20) DEFAULT NULL COMMENT '\u54EA\u4E2A\u7A0B\u5E8F\u64CD\u4F5C\u7684\u6570\u636E',ACTIVE_FLAG varchar(1) DEFAULT '1' COMMENT '0:\u65E0\u6548\u6570\u636E\uFF1B1\uFF1A\u6709\u6548\u6570\u636E',PRIMARY KEY (autoId),KEY SearchKey (customerId,yyyy,month,subjectId,oldVoucherId,voucherId,vchDate) USING BTREE,KEY SubjectEntryKey (customerId,yyyy,vchDate,voucherId,serail),KEY inx_subjectentryid (subjectEntryId),KEY inx_voucher (customerId,yyyy,oldVoucherId,vchDate,typeId)) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u51ED\u8BC1\u5206\u5F55\u8868'
other.EX000010=CREATE TABLE {dbName}.fin_subjectvoucher (autoId int(10) NOT NULL AUTO_INCREMENT COMMENT '\u81EA\u589EID',customerId int(10) NOT NULL DEFAULT '0' COMMENT '\u5BA2\u6237ID',yyyy int(10) NOT NULL DEFAULT '0' COMMENT '\u5E74',month int(2) DEFAULT '0' COMMENT '\u6708',oldVoucherId varchar(50) DEFAULT NULL COMMENT '\u539F\u59CB\u6570\u636E\u51ED\u8BC1ID',voucherId varchar(50) DEFAULT NULL COMMENT '\u7CFB\u7EDF\u751F\u6210\u51ED\u8BC1ID',vchDate varchar(10) DEFAULT NULL COMMENT '\u51ED\u8BC1\u65E5\u671F',vchTime varchar(15) DEFAULT NULL COMMENT '\u51ED\u8BC1\u65F6\u95F4',typeId varchar(200) DEFAULT NULL COMMENT '\u51ED\u8BC1\u7C7B\u578B',voucherFillUser varchar(50) DEFAULT NULL COMMENT '\u5236\u5355\u4EBA',voucherKeepUser varchar(50) DEFAULT NULL COMMENT '\u8BB0\u8D26\u4EBA',voucherAuditUser varchar(50) DEFAULT NULL COMMENT '\u5BA1\u6838\u4EBA',voucherAffixCount int(10) DEFAULT '0' COMMENT '\u9644\u4EF6\u5F20\u6570',voucherDirector varchar(20) DEFAULT NULL COMMENT '\u8D22\u52A1\u4E3B\u7BA1',debitocc decimal(30,4) DEFAULT NULL COMMENT '\u501F\u65B9\u53D1\u751F\u6570',creditocc decimal(30,4) DEFAULT NULL COMMENT '\u8D37\u65B9\u53D1\u751F\u6570',s1 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s2 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s3 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s4 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s5 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s6 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s7 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s8 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s9 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s10 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s11 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s12 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s13 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s14 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s15 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s16 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s17 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s18 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s19 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s20 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s21 text COMMENT '\u5907\u7528\u5B57\u6BB5',s22 text COMMENT '\u5907\u7528\u5B57\u6BB5',s23 text COMMENT '\u5907\u7528\u5B57\u6BB5',s24 text COMMENT '\u5907\u7528\u5B57\u6BB5',s25 text COMMENT '\u5907\u7528\u5B57\u6BB5',CREATION_DATE datetime DEFAULT NULL COMMENT '\u521B\u5EFA\u65E5',CREATED_BY varchar(20) DEFAULT NULL COMMENT '\u521B\u5EFA\u4EBAID',LAST_UPDATE_DATE datetime DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u65E5',LAST_UPDATED_BY varchar(20) DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u4EBAID',ABOLITION_DATE datetime DEFAULT NULL COMMENT '\u5220\u9664\u65E5',ABOLISHED_BY varchar(20) DEFAULT NULL COMMENT '\u5220\u9664\u4EBAID',PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL COMMENT '\u4ECE\u54EA\u4E2A\u7CFB\u7EDF\u64CD\u4F5C\u7684\u6570\u636E',PROGRAM_ID varchar(20) DEFAULT NULL COMMENT '\u54EA\u4E2A\u7A0B\u5E8F\u64CD\u4F5C\u7684\u6570\u636E',ACTIVE_FLAG varchar(1) DEFAULT '1' COMMENT '0:\u65E0\u6548\u6570\u636E\uFF1B1\uFF1A\u6709\u6548\u6570\u636E',PRIMARY KEY (autoId),KEY SearchKey (customerId,yyyy,month,oldVoucherId,voucherId,vchDate) USING BTREE) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u51ED\u8BC1\u8868'
#\u521B\u5EFA\u52A0\u5DE5\u8FC7\u7A0B\u4E34\u65F6\u8868
other.EX000011=CREATE TABLE {dbName}.t_subject (customerId int(10) NOT NULL DEFAULT '0' COMMENT '\u5BA2\u6237ID',yyyy int(10) NOT NULL DEFAULT '0' COMMENT '\u5E74',subjectId varchar(50) NOT NULL DEFAULT '0' COMMENT '\u79D1\u76EE\u7F16\u53F7', subjectName varchar(500) DEFAULT NULL COMMENT '\u79D1\u76EE\u540D\u79F0', currency varchar(30) NOT NULL DEFAULT '0' COMMENT '\u5E01\u79CD', direction int(2) DEFAULT '0' COMMENT '\u501F\u8D37\u65B9\u5411', debitRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u521D', creditRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u521D', remain decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u521D\u6570', debitOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D', creditOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D', debitBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u672B', creditBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u672B', balance decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u672B\u6570', debitRemainF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u521D(\u5916\u5E01)', creditRemainF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u521D(\u5916\u5E01)', remainF decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u521D\u6570(\u5916\u5E01)', debitOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D(\u5916\u5E01)', creditOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D(\u5916\u5E01)', debitBalanceF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u672B(\u5916\u5E01)', creditBalanceF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u672B(\u5916\u5E01)', balanceF decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u672B\u6570(\u5916\u5E01)', parentSubjectId varchar(50) DEFAULT NULL COMMENT '\u79D1\u76EE\u7F16\u53F7', subjectFullId varchar(200) DEFAULT '' COMMENT '\u79D1\u76EE\u7F16\u53F7\u5168\u8DEF\u5F84', subjectFullName varchar(800) DEFAULT NULL COMMENT '\u79D1\u76EE\u5168\u8DEF\u5F84', isLeaf1 int(1) DEFAULT '0' COMMENT '\u662F\u5426\u672B\u7EA7\u79D1\u76EE', level1 int(1) DEFAULT '0' COMMENT '\u79D1\u76EE\u7EA7\u522B',PRIMARY KEY (customerId,yyyy,subjectId,currency)) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u4E34\u65F6\u79D1\u76EE\u4F59\u989D\u8868'
other.EX000012=CREATE TABLE {dbName}.t_assitem (customerId int(10) NOT NULL DEFAULT '0' COMMENT '\u5BA2\u6237ID',yyyy int(10) NOT NULL DEFAULT '0' COMMENT '\u5E74',subjectId varchar(50) NOT NULL DEFAULT '0' COMMENT '\u79D1\u76EE\u7F16\u53F7', subjectName varchar(500) DEFAULT NULL COMMENT '\u79D1\u76EE\u540D\u79F0', assitemType varchar(50) NOT NULL COMMENT '\u6838\u7B97\u7C7B\u578B',assItemId varchar(100) NOT NULL DEFAULT '0' COMMENT '\u6838\u7B97\u540D\u7F16\u53F7',assItemName varchar(500) DEFAULT NULL COMMENT '\u6838\u7B97\u9879\u540D', currency varchar(30) NOT NULL DEFAULT '' COMMENT '\u5E01\u79CD', direction int(2) DEFAULT '0' COMMENT '\u501F\u8D37\u65B9\u5411', debitRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u521D', creditRemain decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u521D', remain decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u521D\u6570', debitOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D', creditOcc decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D', debitBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u672B', creditBalance decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u672B', balance decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u672B\u6570', debitRemainF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u521D(\u5916\u5E01)', creditRemainF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u521D(\u5916\u5E01)', remainF decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u521D\u6570(\u5916\u5E01)', debitOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u53D1\u751F\u989D(\u5916\u5E01)', creditOccF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u53D1\u751F\u989D(\u5916\u5E01)', debitBalanceF decimal(30,4) DEFAULT '0.0000' COMMENT '\u501F\u65B9\u671F\u672B(\u5916\u5E01)', creditBalanceF decimal(30,4) DEFAULT '0.0000' COMMENT '\u8D37\u65B9\u671F\u672B(\u5916\u5E01)', balanceF decimal(30,4) DEFAULT '0.0000' COMMENT '\u671F\u672B\u6570(\u5916\u5E01)', parentSubjectId varchar(50) DEFAULT NULL COMMENT '\u79D1\u76EE\u7F16\u53F7', subjectFullId varchar(200) DEFAULT '' COMMENT '\u79D1\u76EE\u7F16\u53F7\u5168\u8DEF\u5F84', subjectFullName varchar(800) DEFAULT NULL COMMENT '\u79D1\u76EE\u5168\u8DEF\u5F84', parentAssItemId varchar(100) DEFAULT NULL COMMENT '\u4E0A\u7EA7\u6838\u7B97\u9879\u7F16\u53F7',assItemFullId varchar(200) DEFAULT NULL COMMENT '\u6838\u7B97\u7F16\u53F7\u5168\u8DEF\u5F84',assTotalName varchar(800) DEFAULT NULL COMMENT '\u6838\u7B97\u9879\u5168\u79F0', isLeaf1 int(1) DEFAULT '0' COMMENT '\u662F\u5426\u672B\u7EA7\u79D1\u76EE', level1 int(1) DEFAULT '0' COMMENT '\u79D1\u76EE\u7EA7\u522B',PRIMARY KEY (customerId,yyyy,subjectId,assitemId,currency)) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u4E34\u65F6\u6838\u7B97\u79D1\u76EE\u4F59\u989D\u8868'
########## EXCEL \u5206\u6708\u4F59\u989D\u660E\u7EC6\u8868\u5BFC\u5165  EXCEL ##########
#\u751F\u6210\u4E34\u65F6\u79D1\u76EE\u8868
other.EX100001=INSERT INTO {dbName}.t_subject(customerId,yyyy,subjectId,subjectName,currency,direction,debitRemain,creditRemain,debitBalance,creditBalance,debitRemainF,creditRemainF,debitBalanceF,creditBalanceF,parentSubjectId,level1) VALUES ({customerId},{yyyy},'{subjectId}','{subjectName}','{currency}','{direction}','{debitRemain}','{creditRemain}','{debitBalance}','{creditBalance}','{debitRemainF}','{creditRemainF}','{debitBalanceF}','{creditBalanceF}','{parentSubjectId}','{level1}')
#\u751F\u6210\u51ED\u8BC1\u660E\u7EC6\u8868
other.EX100002=INSERT INTO {dbName}.fin_subjectentry(customerId,yyyy,subjectId,vchDate,month,oldVoucherId,typeId,summary,currency,direction,occurValue,currValue,currRate,voucherFillUser,voucherKeepUser,voucherAuditUser,quantity,unitPrice,unitName,subjectEntryId) VALUES 
#\u8BA1\u7B97\u79D1\u76EE\u5C5E\u6027(\u5168\u79F0,\u5168\u8DEF\u5F84,\u662F\u5426\u53F6\u5B50\u7B49)
other.EX100003=UPDATE {dbName}.t_subject a INNER JOIN (SELECT a.subjectId,CASE WHEN a.level1 = 1 THEN '' ELSE c.subjectId END AS parentSubjectId,CASE WHEN a.level1 = 1 THEN a.subjectName ELSE CONCAT(c.subjectFullName,'/',a.subjectName) END AS subjectFullName,CASE WHEN a.level1 = 1 THEN a.subjectId ELSE CONCAT(c.subjectId,'/',a.subjectId) END AS subjectFullId,IF(b.subjectId IS NULL,1,0) AS isLeaf1 FROM {dbName}.t_subject a LEFT JOIN {dbName}.t_subject b ON b.parentSubjectId = a.subjectId LEFT JOIN {dbName}.t_subject c ON c.subjectId = a.parentSubjectId WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} AND a.level1 = {subjectLevel} GROUP BY a.subjectId) b ON b.subjectId = a.subjectId SET a.parentSubjectId=b.parentSubjectId,a.subjectFullId=b.subjectFullId,a.subjectFullName=b.subjectFullName,a.isLeaf1=b.isLeaf1 WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} AND a.level1 = {subjectLevel}
#\u751F\u6210\u79D1\u76EE\u8868
other.EX100004=INSERT INTO {dbName}.fin_accpkgsubject(customerId,yyyy,subjectId,parentSubjectId,subjectFullId,subjectName,direction,isLeaf1,subjectFullName) SELECT {customerId} AS customerId,{yyyy} AS yyyy,subjectId,parentSubjectId,subjectFullId,subjectName,direction,isLeaf1,subjectFullName FROM {dbName}.t_subject GROUP BY subjectId ORDER BY subjectId
#\u8BA1\u7B97\u79D1\u76EE\u540D\u79F0,\u9996\u4F4D\u91D1\u989D
other.EX100005=UPDATE {dbName}.fin_subjectentry a INNER JOIN {dbName}.fin_accpkgsubject b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId SET a.subjectName = b.subjectName,a.subjectFullName = b.subjectFullName,a.s1 = LEFT(ABS(a.occurValue),1) WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u751F\u6210voucherId
other.EX100006=UPDATE {dbName}.fin_subjectentry a INNER JOIN (SELECT customerId,yyyy,vchDate,oldVoucherId,(@inx:=@inx+1) AS voucherId FROM (SELECT DISTINCT customerId,yyyy,vchDate,oldVoucherId FROM {dbName}.fin_subjectentry WHERE customerId = {customerId} AND yyyy = {yyyy}) a,(SELECT @inx:=0) b) b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.vchDate = a.vchDate AND b.oldVoucherId = a.oldVoucherId SET a.voucherId = b.voucherId WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u8BA1\u7B97serail
other.EX100007=UPDATE {dbName}.fin_subjectentry a INNER JOIN (SELECT autoId,(@inx:=CASE WHEN @lastCode = a.voucherId THEN @inx+1 ELSE 1 END) AS serail,@lastCode:=a.voucherId FROM {dbName}.fin_subjectentry a,(SELECT @inx:=0,@lastCode:='') b WHERE customerId = {customerId} AND yyyy = {yyyy}) b ON b.autoId = a.autoId SET a.serail = b.serail WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u8BA1\u7B97\u662F\u5426\u7ED3\u8F6C
other.EX100008=UPDATE {dbName}.fin_subjectentry SET isTransferVoucher = 1 WHERE customerId = {customerId} AND yyyy = {yyyy} AND month = {subMonth} AND voucherId IN (SELECT voucherId FROM (SELECT DISTINCT voucherId FROM {dbName}.fin_subjectentry WHERE customerId = {customerId} AND yyyy = {yyyy} AND month = {subMonth} AND subjectFullName LIKE '\u672C\u5E74\u5229\u6DA6%' UNION SELECT DISTINCT voucherId FROM {dbName}.fin_subjectentry WHERE customerId = {customerId} AND yyyy = {yyyy} AND month = {subMonth} AND subjectFullName LIKE '\u672A\u5206\u914D\u5229\u6DA6%') a)
#\u8BA1\u7B97\u5BF9\u65B9\u79D1\u76EE\u76F8\u5173
other.EX100009=UPDATE {dbName}.fin_subjectentry a INNER JOIN (SELECT customerId, yyyy, voucherId, SUM(CASE WHEN direction = 1 THEN 1 ELSE 0 END) AS drCount, SUM(CASE WHEN direction =- 1 THEN 1 ELSE 0 END) AS crCount, SUM(CASE WHEN direction = 1 THEN occ ELSE 0 END) AS voucherDebitOcc, SUM(CASE WHEN direction =- 1 THEN occ ELSE 0 END) AS voucherCreditOcc, GROUP_CONCAT(CASE WHEN direction = 1 THEN subjectId ELSE NULL END) AS debitsubjects, GROUP_CONCAT(CASE WHEN direction = - 1 THEN subjectId ELSE NULL END) AS creditsubjects, GROUP_CONCAT(CASE WHEN direction = 1 THEN SUBSTRING_INDEX(subjectFullName, '/', 1) ELSE NULL END) AS dSubjectTopName, GROUP_CONCAT(CASE WHEN direction = - 1 THEN SUBSTRING_INDEX(subjectFullName, '/', 1) ELSE NULL END) AS cSubjectTopName, GROUP_CONCAT(CASE WHEN direction = 1 THEN subjectFullName ELSE NULL END) AS dSubjectFullName, GROUP_CONCAT(CASE WHEN direction = - 1 THEN subjectFullName ELSE NULL END) AS cSubjectFullName FROM (SELECT customerId, yyyy, subjectId, voucherId, direction, SUM(occurValue) AS occ, subjectFullName FROM {dbName}.fin_subjectentry WHERE customerId = {customerId} AND yyyy = {yyyy} AND month = {subMonth} GROUP BY customerId, yyyy, subjectId, voucherId, direction) t GROUP BY customerId, yyyy, voucherId ORDER BY voucherId) b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.voucherId = a.voucherId SET a.drCount = b.drCount,a.crCount = b.crCount,a.voucherDebitOcc = b.voucherDebitOcc,a.voucherCreditOcc = b.voucherCreditOcc,a.debitsubjects = b.debitsubjects,a.creditsubjects = b.creditsubjects,a.oppositeAccountTop = IF(a.direction = 1, b.cSubjectTopName, b.dSubjectTopName),a.oppositeAccountLast = IF(a.direction = 1, b.cSubjectFullName, b.dSubjectFullName) WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u751F\u6210\u51ED\u8BC1\u8868
other.EX100010=INSERT INTO {dbName}.fin_subjectvoucher (customerId,yyyy,month,oldVoucherId,voucherId,vchDate,vchTime,typeId,voucherFillUser,voucherKeepUser,voucherAuditUser,debitocc,creditocc) SELECT DISTINCT customerId,yyyy,month,voucherId AS oldVoucherId,oldVoucherId AS voucherId,vchDate,vchTime,typeId,voucherFillUser,voucherKeepUser,voucherAuditUser,voucherDebitOcc AS debitocc,voucherCreditOcc AS creditocc FROM {dbName}.fin_subjectentry WHERE customerId = {customerId} AND yyyy = {yyyy}
#\u751F\u6210\u4F59\u989D\u8868
other.EX100012=INSERT INTO {dbName}.fin_account(customerId,yyyy,subjectId,subMonth) SELECT DISTINCT customerId,yyyy,subjectId,{subMonth} AS subMonth FROM {dbName}.t_subject WHERE customerId = {customerId} AND yyyy = {yyyy} ORDER BY subjectId
#\u8BA1\u7B97\u4F59\u989D\u8868\u79D1\u76EE\u540D\u79F0,\u671F\u521D\u7B49
other.EX100013=UPDATE {dbName}.fin_account a INNER JOIN (SELECT customerId,yyyy,subjectId,subjectName,direction,SUM(debitRemain) AS debitRemain,SUM(creditRemain) AS creditRemain,SUM(direction*(debitRemain-creditRemain)) AS remain,isLeaf1,level1,subjectFullName FROM {dbName}.t_subject a WHERE customerId = {customerId} AND yyyy = {yyyy} GROUP BY customerId,yyyy,subjectId) b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId SET a.subjectName = b.subjectName,a.direction = b.direction,a.debitRemain = b.debitRemain,a.creditRemain = b.creditRemain,a.remain = b.remain,a.isLeaf1 = b.isLeaf1,a.level1 = b.level1,a.subjectFullName = b.subjectFullName WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u8BA1\u7B97\u4F59\u989D\u8868\u53D1\u751F\u989D
other.EX100014=UPDATE {dbName}.fin_account a INNER JOIN (SELECT customerId,yyyy,subjectId,month AS subMonth,SUM(CASE WHEN direction = 1 THEN occurValue ELSE 0 END) AS debitOcc,SUM(CASE WHEN direction = -1 THEN occurValue ELSE 0 END) AS creditOcc,SUM(CASE WHEN isTransferVoucher = 1 AND direction = 1 THEN occurValue ELSE 0 END) AS tranDebitOcc,SUM(CASE WHEN isTransferVoucher = 1 AND direction = -1 THEN occurValue ELSE 0 END) AS tranCreditOcc FROM {dbName}.fin_subjectentry WHERE customerId = {customerId} AND yyyy = {yyyy} GROUP BY customerId,yyyy,subjectId,month) b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId AND b.subMonth = a.subMonth SET a.debitOcc = b.debitOcc,a.creditOcc = b.creditOcc,a.tranDebitOcc = b.tranDebitOcc,a.tranCreditOcc = b.tranCreditOcc,a.debitOccNoTran = b.debitOcc - b.tranDebitOcc,a.creditOccNoTran = b.creditOcc - b.tranCreditOcc WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u8BA1\u7B97\u4F59\u989D\u88681\u6708\u671F\u521D\u672B,\u7D2F\u8BA1\u53D1\u751F\u989D
other.EX100015=UPDATE {dbName}.fin_account SET debitTotalOcc = debitOcc,creditTotalOcc = creditOcc,debitBalance = IF(direction = 1,remain + direction * (debitOcc - creditOcc),0),creditBalance = IF(direction = -1,remain + direction * (debitOcc - creditOcc),0),balance = direction * (debitBalance - creditBalance) WHERE customerId = {customerId} AND yyyy = {yyyy} AND subMonth = 1
#\u8BA1\u7B97\u4F59\u989D\u88682~12\u671F\u521D\u672B,\u7D2F\u8BA1\u53D1\u751F\u989D
other.EX100016=UPDATE {dbName}.fin_account a INNER JOIN {dbName}.fin_account b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId AND b.subMonth = {lastMonth} LEFT JOIN (SELECT customerId,yyyy,subjectId,{subMonth} AS subMonth,SUM(debitOcc) AS debitTotalOcc,SUM(creditOcc)  AS creditTotalOcc FROM {dbName}.fin_account WHERE customerId = {customerId} AND yyyy = {yyyy} AND subMonth <= {subMonth} GROUP BY customerId,yyyy,subjectId) c ON c.customerId = a.customerId AND c.yyyy = a.yyyy AND c.subjectId = a.subjectId AND c.subMonth = a.subMonth SET a.debitRemain = b.debitBalance,a.creditRemain = b.creditBalance,a.remain = b.balance,a.debitBalance = IF(a.direction = 1,b.balance + a.direction * (a.debitOcc - a.creditOcc),0),a.creditBalance = IF(a.direction = -1,b.balance + a.direction * (a.debitOcc - a.creditOcc),0),a.balance = a.direction * (b.debitBalance - b.creditBalance + a.debitOcc - a.creditOcc),a.debitTotalOcc = c.debitTotalOcc,a.creditTotalOcc = c.creditTotalOcc WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} AND a.subMonth = {subMonth}
#\u8BA1\u7B97\u4F59\u989D\u8868\u7236\u7EA7\u79D1\u76EE\u6839\u636E\u5B50\u7EA7\u79D1\u76EE
other.EX100017=UPDATE {dbName}.fin_account a INNER JOIN (SELECT customerId,yyyy,LEFT(subjectId,{subjectLevel}) AS subjectId,subMonth,SUM(debitRemain) AS debitRemain,SUM(creditRemain) AS creditRemain,SUM(remain) AS remain,SUM(debitOcc) AS debitOcc,SUM(creditOcc) AS creditOcc,SUM(tranDebitOcc) AS tranDebitOcc,SUM(tranCreditOcc) AS tranCreditOcc,SUM(debitOccNoTran) AS debitOccNoTran,SUM(creditOccNoTran) AS creditOccNoTran,SUM(debitTotalOcc) AS debitTotalOcc,SUM(creditTotalOcc) AS creditTotalOcc,SUM(debitBalance) AS debitBalance,SUM(creditBalance) AS creditBalance,SUM(balance) AS balance FROM {dbName}.fin_account WHERE customerId = {customerId} AND yyyy = {yyyy} AND isLeaf1 = 1 AND LENGTH(subjectId) >= {subjectLevel} GROUP BY customerId,yyyy,LEFT(subjectId,{subjectLevel}),subMonth) b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId AND b.subMonth = a.subMonth SET a.debitRemain = b.debitRemain,a.creditRemain = b.creditRemain,a.remain = b.remain,a.debitOcc = b.debitOcc,a.creditOcc = b.creditOcc,a.tranDebitOcc = b.tranDebitOcc,a.tranCreditOcc = b.tranCreditOcc,a.debitOccNoTran = b.debitOccNoTran,a.creditOccNoTran = b.creditOccNoTran,a.debitTotalOcc = b.debitTotalOcc,a.creditTotalOcc = b.creditTotalOcc,a.debitBalance = b.debitBalance,a.creditBalance = b.creditBalance,a.balance = b.balance WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u751F\u6210\u5916\u5E01\u4F59\u989D\u8868
other.EX100018=INSERT INTO {dbName}.fin_accountall(customerId,yyyy,subjectId,currency,subMonth) SELECT customerId,yyyy,LEFT(subjectId,{subjectLevel}) AS subjectId,currency,{subMonth} AS subMonth FROM {dbName}.t_subject WHERE customerId = {customerId} AND yyyy = {yyyy} AND currency > '' AND isLeaf1 = 1 AND LENGTH(subjectId) >= {subjectLevel} GROUP BY customerId,yyyy,LEFT(subjectId,{subjectLevel}),currency ORDER BY customerId,yyyy,subjectId
#\u8BA1\u7B97\u5916\u5E01\u4F59\u989D\u8868\u79D1\u76EE\u540D\u79F0\u7B49
other.EX100019=UPDATE {dbName}.fin_accountall a INNER JOIN (SELECT customerId,yyyy,subjectId,subjectName,direction,isLeaf1,level1,subjectFullName FROM {dbName}.t_subject a WHERE customerId = {customerId} AND yyyy = {yyyy} GROUP BY customerId,yyyy,subjectId) b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId SET a.subjectName = b.subjectName,a.direction = b.direction,a.isLeaf1 = b.isLeaf1,a.level1 = b.level1,a.subjectFullName = b.subjectFullName WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u8BA1\u7B97\u5916\u5E01\u4F59\u989D\u8868\u53D1\u751F\u989D
other.EX100020=UPDATE {dbName}.fin_accountall a INNER JOIN (SELECT customerId,yyyy,subjectId,month AS subMonth,currency,SUM(CASE WHEN direction = 1 THEN occurValue ELSE 0 END) AS debitOcc,SUM(CASE WHEN direction = -1 THEN occurValue ELSE 0 END) AS creditOcc,SUM(CASE WHEN isTransferVoucher = 1 AND direction = 1 THEN occurValue ELSE 0 END) AS tranDebitOcc,SUM(CASE WHEN isTransferVoucher = 1 AND direction = -1 THEN occurValue ELSE 0 END) AS tranCreditOcc,SUM(CASE WHEN direction = 1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN direction = -1 THEN currValue ELSE 0 END) AS creditOccF,SUM(CASE WHEN isTransferVoucher = 1 AND direction = 1 THEN currValue ELSE 0 END) AS tranDebitOccF,SUM(CASE WHEN isTransferVoucher = 1 AND direction = -1 THEN currValue ELSE 0 END) AS tranCreditOccF FROM {dbName}.fin_subjectentry WHERE customerId = {customerId} AND yyyy = {yyyy} AND currency > '' GROUP BY customerId,yyyy,subjectId,month,currency) b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId AND b.subMonth = a.subMonth AND b.currency = a.currency SET a.debitOcc = b.debitOcc,a.creditOcc = b.creditOcc,a.tranDebitOcc = b.tranDebitOcc,a.tranCreditOcc = b.tranCreditOcc,a.debitOccNoTran = b.debitOcc - b.tranDebitOcc,a.creditOccNoTran = b.creditOcc - b.tranCreditOcc,a.debitOccF = b.debitOccF,a.creditOccF = b.creditOccF,a.tranDebitOccF = b.tranDebitOccF,a.tranCreditOccF = b.tranCreditOccF,a.debitOccNoTranF = b.debitOccF - b.tranDebitOccF,a.creditOccNoTranF = b.creditOccF - b.tranCreditOccF WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u8BA1\u7B97\u5916\u5E01\u4F59\u989D\u88681\u6708\u671F\u521D\u672B,\u7D2F\u8BA1\u53D1\u751F\u989D
other.EX100021=UPDATE {dbName}.fin_accountall SET debitTotalOcc = debitOcc,creditTotalOcc = creditOcc,debitBalance = IF(direction = 1,remain + direction * (debitOcc - creditOcc),0),creditBalance = IF(direction = -1,remain + direction * (debitOcc - creditOcc),0),balance = direction * (debitBalance - creditBalance),debitTotalOccF = debitOccF,creditTotalOccF = creditOccF,debitBalanceF = IF(direction = 1,remainF + direction * (debitOccF - creditOccF),0),creditBalanceF = IF(direction = -1,remainF + direction * (debitOccF - creditOccF),0),balanceF = direction * (debitBalanceF - creditBalanceF) WHERE customerId = {customerId} AND yyyy = {yyyy} AND subMonth = 1
#\u8BA1\u7B97\u5916\u5E01\u4F59\u989D\u88682~12\u671F\u521D\u672B,\u7D2F\u8BA1\u53D1\u751F\u989D
other.EX100022=UPDATE {dbName}.fin_accountall a INNER JOIN {dbName}.fin_accountall b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId AND b.subMonth = {lastMonth} AND b.currency = a.currency LEFT JOIN (SELECT customerId,yyyy,subjectId,currency,{subMonth} AS subMonth,SUM(debitOcc) AS debitTotalOcc,SUM(creditOcc)  AS creditTotalOcc,SUM(debitOccF) AS debitTotalOccF,SUM(creditOccF)  AS creditTotalOccF FROM {dbName}.fin_accountall WHERE customerId = {customerId} AND yyyy = {yyyy} AND subMonth <= {subMonth} GROUP BY customerId,yyyy,subjectId) c ON c.customerId = a.customerId AND c.yyyy = a.yyyy AND c.subjectId = a.subjectId AND c.currency = a.currency AND c.subMonth = a.subMonth SET a.debitRemain = b.debitBalance,a.creditRemain = b.creditBalance,a.remain = b.balance,a.debitBalance = IF(a.direction = 1,b.balance + a.direction * (a.debitOcc - a.creditOcc),0),a.creditBalance = IF(a.direction = -1,b.balance + a.direction * (a.debitOcc - a.creditOcc),0),a.balance = a.direction * (b.debitBalance - b.creditBalance + a.debitOcc - a.creditOcc),a.debitTotalOcc = c.debitTotalOcc,a.creditTotalOcc = c.creditTotalOcc,a.debitRemainF = b.debitBalanceF,a.creditRemainF = b.creditBalanceF,a.remainF = b.balanceF,a.debitBalanceF = IF(a.direction = 1,b.balanceF + a.direction * (a.debitOccF - a.creditOccF),0),a.creditBalanceF = IF(a.direction = -1,b.balanceF + a.direction * (a.debitOccF - a.creditOccF),0),a.balanceF = a.direction * (b.debitBalanceF - b.creditBalanceF + a.debitOccF - a.creditOccF),a.debitTotalOccF = c.debitTotalOccF,a.creditTotalOccF = c.creditTotalOccF WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} AND a.subMonth = {subMonth}
#\u8BA1\u7B97\u5916\u5E01\u4F59\u989D\u8868\u7236\u7EA7\u79D1\u76EE\u6839\u636E\u5B50\u7EA7\u79D1\u76EE
other.EX100023=UPDATE {dbName}.fin_accountall a INNER JOIN (SELECT customerId,yyyy,LEFT(subjectId,{subjectLevel}) AS subjectId,subMonth,currency,SUM(debitRemain) AS debitRemain,SUM(creditRemain) AS creditRemain,SUM(remain) AS remain,SUM(debitOcc) AS debitOcc,SUM(creditOcc) AS creditOcc,SUM(tranDebitOcc) AS tranDebitOcc,SUM(tranCreditOcc) AS tranCreditOcc,SUM(debitOccNoTran) AS debitOccNoTran,SUM(creditOccNoTran) AS creditOccNoTran,SUM(debitTotalOcc) AS debitTotalOcc,SUM(creditTotalOcc) AS creditTotalOcc,SUM(debitBalance) AS debitBalance,SUM(creditBalance) AS creditBalance,SUM(balance) AS balance,SUM(debitRemainF) AS debitRemainF,SUM(creditRemainF) AS creditRemainF,SUM(remainF) AS remainF,SUM(debitOccF) AS debitOccF,SUM(creditOccF) AS creditOccF,SUM(tranDebitOccF) AS tranDebitOccF,SUM(tranCreditOccF) AS tranCreditOccF,SUM(debitOccNoTranF) AS debitOccNoTranF,SUM(creditOccNoTranF) AS creditOccNoTranF,SUM(debitTotalOccF) AS debitTotalOccF,SUM(creditTotalOccF) AS creditTotalOccF,SUM(debitBalanceF) AS debitBalanceF,SUM(creditBalanceF) AS creditBalanceF,SUM(balanceF) AS balanceF FROM {dbName}.fin_accountall WHERE customerId = {customerId} AND yyyy = {yyyy} AND isLeaf1 = 1 AND LENGTH(subjectId) >= {subjectLevel} GROUP BY customerId,yyyy,LEFT(subjectId,{subjectLevel}),currency,subMonth) b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId AND b.subMonth = a.subMonth AND b.currency = a.currency SET a.debitRemain = b.debitRemain,a.creditRemain = b.creditRemain,a.remain = b.remain,a.debitOcc = b.debitOcc,a.creditOcc = b.creditOcc,a.tranDebitOcc = b.tranDebitOcc,a.tranCreditOcc = b.tranCreditOcc,a.debitOccNoTran = b.debitOccNoTran,a.creditOccNoTran = b.creditOccNoTran,a.debitTotalOcc = b.debitTotalOcc,a.creditTotalOcc = b.creditTotalOcc,a.debitBalance = b.debitBalance,a.creditBalance = b.creditBalance,a.balance = b.balance,a.debitRemainF = b.debitRemainF,a.creditRemainF = b.creditRemainF,a.remainF = b.remainF,a.debitOccF = b.debitOccF,a.creditOccF = b.creditOccF,a.tranDebitOccF = b.tranDebitOccF,a.tranCreditOccF = b.tranCreditOccF,a.debitOccNoTranF = b.debitOccNoTranF,a.creditOccNoTranF = b.creditOccNoTranF,a.debitTotalOccF = b.debitTotalOccF,a.creditTotalOccF = b.creditTotalOccF,a.debitBalanceF = b.debitBalanceF,a.creditBalanceF = b.creditBalanceF,a.balanceF = b.balanceF WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u8BA1\u7B97\u5916\u5E01\u4F59\u989D\u8868\u671F\u521D\u7B49
other.EX100024=UPDATE {dbName}.fin_accountall a INNER JOIN (SELECT customerId,yyyy,subjectId,currency,SUM(debitRemain) AS debitRemain,SUM(creditRemain) AS creditRemain,SUM(direction*(debitRemain-creditRemain)) AS remain,SUM(debitRemainF) AS debitRemainF,SUM(creditRemainF) AS creditRemainF,SUM(direction*(debitRemainF-creditRemainF)) AS remainF FROM {dbName}.t_subject a WHERE customerId = {customerId} AND yyyy = {yyyy} GROUP BY customerId,yyyy,subjectId,currency) b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId AND b.currency = a.currency SET a.debitRemain = b.debitRemain,a.creditRemain = b.creditRemain,a.remain = b.remain,a.debitRemainF = b.debitRemainF,a.creditRemainF = b.creditRemainF,a.remainF = b.remainF WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u751F\u6210\u6838\u7B97\u660E\u7EC6\u8868
other.EX100025=INSERT INTO {dbName}.fin_assitementry(customerId,yyyy,subjectId,assitemId,vchDate,month,oldVoucherId,typeId,summary,currency,direction,occurValue,currValue,currRate,voucherFillUser,voucherKeepUser,voucherAuditUser,quantity,unitPrice,unitName,subjectEntryId) VALUES 
#\u751F\u6210\u4E34\u65F6\u6838\u7B97\u8868
other.EX100026=INSERT INTO {dbName}.t_assitem(customerId,yyyy,subjectId,subjectName,assitemType,assitemId,assitemName,currency,direction,debitRemain,creditRemain,debitBalance,creditBalance,debitRemainF,creditRemainF,debitBalanceF,creditBalanceF,isLeaf1,level1) VALUES ({customerId},{yyyy},'{subjectId}','{subjectName}','{assitemType}','{assitemId}','{assitemName}','{currency}','{direction}','{debitRemain}','{creditRemain}','{debitBalance}','{creditBalance}','{debitRemainF}','{creditRemainF}','{debitBalanceF}','{creditBalanceF}','{isLeaf1}','{level1}')
#\u751F\u6210\u7236\u7EA7\u6838\u7B97
other.EX100027=INSERT INTO {dbName}.t_assitem(customerId,yyyy,subjectId,assitemType,assItemId,assItemName,direction,isLeaf1,level1) SELECT DISTINCT a.customerId,a.yyyy,a.subjectId,a.assitemType,b.assItemId,a.assitemType AS assItemName,a.direction,0 AS isLeaf1,1 AS level1 FROM {dbName}.t_assitem a LEFT JOIN (SELECT assitemType,(@inx:=@inx+1) AS assItemId FROM (SELECT DISTINCT assitemType FROM {dbName}.t_assitem WHERE customerId = {customerId} AND yyyy = {yyyy}) a,(SELECT @inx:=0) b) b ON b.assitemType = a.assitemType WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u8BA1\u7B97\u4E34\u65F6\u6838\u7B97\u8868\u79D1\u76EE\u7EA7\u6B21,\u6838\u7B97\u7EA7\u6B21\u7B49
other.EX100028=UPDATE {dbName}.t_assitem a LEFT JOIN {dbName}.fin_accpkgsubject b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId LEFT JOIN (SELECT DISTINCT assItemId,assItemName FROM {dbName}.t_assitem WHERE customerId = {customerId} AND yyyy = {yyyy} AND level1 = 1) c ON c.assItemName = a.assItemType SET a.subjectName = b.subjectName,a.subjectFullName = b.subjectFullName,a.parentSubjectId = b.parentSubjectId,a.subjectFullId = b.subjectFullId,a.parentAssItemId = IF(a.level1 = 1,'',c.assItemId),a.assItemFullId = IF(a.level1 = 1,a.assItemId,CONCAT(c.assItemId,'|',a.assItemId)),a.assTotalName = IF(a.level1 = 1,a.assItemName,CONCAT(a.assitemType,'/',a.assItemName)) WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u751F\u6210\u6838\u7B97\u79D1\u76EE\u8868
other.EX100029=INSERT INTO {dbName}.fin_assitem(customerId,yyyy,subjectId,subjectName,assItemId,assItemName,direction,parentAssItemId,assItemFullId,assTotalName,subjectFullId,subjectFullName,isLeaf1,level1) SELECT customerId,yyyy,subjectId,subjectName,assItemId,assItemName,direction,parentAssItemId,assItemFullId,assTotalName,subjectFullId,subjectFullName,isLeaf1,level1 FROM {dbName}.t_assitem WHERE customerId = {customerId} AND yyyy = {yyyy} ORDER BY customerId,yyyy,subjectId,assItemId
#\u8BA1\u7B97\u6838\u7B97\u660E\u7EC6\u8868
other.EX100030=UPDATE {dbName}.fin_assitementry a LEFT JOIN {dbName}.fin_assitem b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId AND b.assitemId = a.assitemId LEFT JOIN {dbName}.fin_subjectentry c ON c.subjectEntryId = a.subjectEntryId SET a.assItemName = b.assItemName,a.assTotalName = b.assTotalName,a.subjectName = b.subjectName,a.subjectFullName = b.subjectFullName,a.voucherId = c.voucherId,a.serail = c.serail,a.isTransferVoucher = c.isTransferVoucher WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u751F\u6210\u6838\u7B97\u79D1\u76EE\u4F59\u989D\u8868
other.EX100031=INSERT INTO {dbName}.fin_assitementryacc(customerId,yyyy,subMonth,subjectId,subjectName,assItemId,assItemName,direction,debitRemain,creditRemain,debitOcc,creditOcc,debitBalance,creditBalance,isLeaf1,level1,subjectFullName,assTotalName) SELECT customerId,yyyy,{subMonth} AS subMonth,subjectId,subjectName,assItemId,assItemName,direction,debitRemain,creditRemain,debitOcc,creditOcc,debitBalance,creditBalance,isLeaf1,level1,subjectFullName,assTotalName FROM {dbName}.t_assitem WHERE customerId = {customerId} AND yyyy = {yyyy} ORDER BY customerId,yyyy,subjectId,assItemId
#\u8BA1\u7B97\u6838\u7B97\u79D1\u76EE\u4F59\u989D\u8868\u53D1\u751F\u989D
other.EX100032=UPDATE {dbName}.fin_assitementryacc a INNER JOIN (SELECT customerId,yyyy,subjectId,assItemId,month AS subMonth,SUM(CASE WHEN direction = 1 THEN occurValue ELSE 0 END) AS debitOcc,SUM(CASE WHEN direction = -1 THEN occurValue ELSE 0 END) AS creditOcc,SUM(CASE WHEN isTransferVoucher = 1 AND direction = 1 THEN occurValue ELSE 0 END) AS tranDebitOcc,SUM(CASE WHEN isTransferVoucher = 1 AND direction = -1 THEN occurValue ELSE 0 END) AS tranCreditOcc FROM {dbName}.fin_assitementry WHERE customerId = {customerId} AND yyyy = {yyyy} GROUP BY customerId,yyyy,subjectId,assItemId,month) b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId AND b.assItemId = a.assItemId AND b.subMonth = a.subMonth SET a.debitOcc = b.debitOcc,a.creditOcc = b.creditOcc,a.tranDebitOcc = b.tranDebitOcc,a.tranCreditOcc = b.tranCreditOcc,a.debitOccNoTran = b.debitOcc - b.tranDebitOcc,a.creditOccNoTran = b.creditOcc - b.tranCreditOcc WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u8BA1\u7B97\u6838\u7B97\u79D1\u76EE\u4F59\u989D\u88681\u6708\u671F\u521D\u672B,\u7D2F\u8BA1\u53D1\u751F\u989D
other.EX100033=UPDATE {dbName}.fin_assitementryacc SET remain = direction * (debitRemain - creditRemain),debitTotalOcc = debitOcc,creditTotalOcc = creditOcc,debitBalance = IF(direction = 1,remain + direction * (debitOcc - creditOcc),0),creditBalance = IF(direction = -1,remain + direction * (debitOcc - creditOcc),0),balance = direction * (debitBalance - creditBalance) WHERE customerId = {customerId} AND yyyy = {yyyy} AND subMonth = 1
#\u8BA1\u7B97\u6838\u7B97\u79D1\u76EE\u4F59\u989D\u88682~12\u671F\u521D\u672B,\u7D2F\u8BA1\u53D1\u751F\u989D
other.EX100034=UPDATE {dbName}.fin_assitementryacc a INNER JOIN {dbName}.fin_assitementryacc b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId AND b.assItemId = a.assItemId AND b.subMonth = {lastMonth} LEFT JOIN (SELECT customerId,yyyy,subjectId,assItemId,{subMonth} AS subMonth,SUM(debitOcc) AS debitTotalOcc,SUM(creditOcc)  AS creditTotalOcc FROM {dbName}.fin_assitementryacc WHERE customerId = {customerId} AND yyyy = {yyyy} AND subMonth <= {subMonth} GROUP BY customerId,yyyy,subjectId,assItemId) c ON c.customerId = a.customerId AND c.yyyy = a.yyyy AND c.subjectId = a.subjectId AND c.assItemId = a.assItemId AND c.subMonth = a.subMonth SET a.debitRemain = b.debitBalance,a.creditRemain = b.creditBalance,a.remain = b.balance,a.debitBalance = IF(a.direction = 1,b.balance + a.direction * (a.debitOcc - a.creditOcc),0),a.creditBalance = IF(a.direction = -1,b.balance + a.direction * (a.debitOcc - a.creditOcc),0),a.balance = a.direction * (b.debitBalance - b.creditBalance + a.debitOcc - a.creditOcc),a.debitTotalOcc = c.debitTotalOcc,a.creditTotalOcc = c.creditTotalOcc WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} AND a.subMonth = {subMonth}
#\u8BA1\u7B97\u6838\u7B97\u79D1\u76EE\u4F59\u989D\u8868\u7236\u7EA7\u79D1\u76EE\u6839\u636E\u5B50\u7EA7\u79D1\u76EE
other.EX100035=UPDATE {dbName}.fin_assitementryacc a INNER JOIN (SELECT a.customerId,a.yyyy,a.subjectId,b.parentAssItemId AS assItemId,a.subMonth,SUM(a.debitRemain) AS debitRemain,SUM(a.creditRemain) AS creditRemain,SUM(a.remain) AS remain,SUM(a.debitOcc) AS debitOcc,SUM(a.creditOcc) AS creditOcc,SUM(a.tranDebitOcc) AS tranDebitOcc,SUM(a.tranCreditOcc) AS tranCreditOcc,SUM(a.debitOccNoTran) AS debitOccNoTran,SUM(a.creditOccNoTran) AS creditOccNoTran,SUM(a.debitTotalOcc) AS debitTotalOcc,SUM(a.creditTotalOcc) AS creditTotalOcc,SUM(a.debitBalance) AS debitBalance,SUM(a.creditBalance) AS creditBalance,SUM(a.balance) AS balance FROM {dbName}.fin_assitementryacc a LEFT JOIN {dbName}.fin_assitem b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId AND b.assitemId = a.assItemId WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} AND a.isLeaf1 = 1 GROUP BY a.customerId,a.yyyy,a.subjectId,b.parentAssItemId,a.subMonth) b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId AND b.assItemId = a.assItemId AND b.subMonth = a.subMonth SET a.debitRemain = b.debitRemain,a.creditRemain = b.creditRemain,a.remain = b.remain,a.debitOcc = b.debitOcc,a.creditOcc = b.creditOcc,a.tranDebitOcc = b.tranDebitOcc,a.tranCreditOcc = b.tranCreditOcc,a.debitOccNoTran = b.debitOccNoTran,a.creditOccNoTran = b.creditOccNoTran,a.debitTotalOcc = b.debitTotalOcc,a.creditTotalOcc = b.creditTotalOcc,a.debitBalance = b.debitBalance,a.creditBalance = b.creditBalance,a.balance = b.balance WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u751F\u6210\u5916\u5E01\u6838\u7B97\u79D1\u76EE\u4F59\u989D\u8868
other.EX100036=INSERT INTO {dbName}.fin_assitementryaccall (customerId,yyyy,subMonth,subjectId,subjectName,assItemId,assItemName,direction,currency,debitRemain,creditRemain,debitOcc,creditOcc,debitBalance,creditBalance,debitRemainF,creditRemainF,debitOccF,creditOccF,debitBalanceF,creditBalanceF) SELECT customerId,yyyy,{subMonth} AS subMonth,subjectId,subjectName,parentAssItemId AS assItemId,assitemType AS assItemName,direction,currency,SUM(debitRemain) AS debitRemain,SUM(creditRemain) AS creditRemain,SUM(debitOcc) AS debitOcc,SUM(creditOcc) AS creditOcc,SUM(debitBalance) AS debitBalance,SUM(creditBalance) AS creditBalance,SUM(debitRemainF) AS debitRemainF,SUM(creditRemainF) AS creditRemainF,SUM(debitOccF) AS debitOccF,SUM(creditOccF) AS creditOccF,SUM(debitBalanceF) AS debitBalanceF,SUM(creditBalanceF) AS creditBalanceF FROM {dbName}.t_assitem WHERE customerId = {customerId} AND yyyy = {yyyy} AND currency > '' GROUP BY customerId,yyyy,subjectId,parentAssItemId,currency UNION SELECT customerId,yyyy,{subMonth} AS subMonth,subjectId,subjectName,assItemId,assItemName,direction,currency,debitRemain,creditRemain,debitOcc,creditOcc,debitBalance,creditBalance,debitRemainF,creditRemainF,debitOccF,creditOccF,debitBalanceF,creditBalanceF FROM {dbName}.t_assitem WHERE customerId = {customerId} AND yyyy = {yyyy} AND currency > '' ORDER BY customerId,yyyy,subjectId,assItemId
#\u8BA1\u7B97\u5916\u5E01\u6838\u7B97\u79D1\u76EE\u4F59\u989D\u8868\u671F\u521D
other.EX100037=UPDATE {dbName}.fin_assitementryaccall a INNER JOIN (SELECT customerId,yyyy,subjectId,assitemId,currency,SUM(debitRemain) AS debitRemain,SUM(creditRemain) AS creditRemain,SUM(direction*(debitRemain-creditRemain)) AS remain,SUM(debitRemainF) AS debitRemainF,SUM(creditRemainF) AS creditRemainF,SUM(direction*(debitRemainF-creditRemainF)) AS remainF FROM {dbName}.t_assitem a WHERE customerId = {customerId} AND yyyy = {yyyy} GROUP BY customerId,yyyy,subjectId,assitemId,currency) b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId AND b.assitemId = a.assitemId AND b.currency = a.currency SET a.debitRemain = b.debitRemain,a.creditRemain = b.creditRemain,a.remain = b.remain,a.debitRemainF = b.debitRemainF,a.creditRemainF = b.creditRemainF,a.remainF = b.remainF WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u8BA1\u7B97\u5916\u5E01\u6838\u7B97\u79D1\u76EE\u4F59\u989D\u8868\u53D1\u751F\u989D
other.EX100038=UPDATE {dbName}.fin_assitementryaccall a INNER JOIN (SELECT customerId,yyyy,subjectId,assitemId,month AS subMonth,currency,SUM(CASE WHEN direction = 1 THEN occurValue ELSE 0 END) AS debitOcc,SUM(CASE WHEN direction = -1 THEN occurValue ELSE 0 END) AS creditOcc,SUM(CASE WHEN isTransferVoucher = 1 AND direction = 1 THEN occurValue ELSE 0 END) AS tranDebitOcc,SUM(CASE WHEN isTransferVoucher = 1 AND direction = -1 THEN occurValue ELSE 0 END) AS tranCreditOcc,SUM(CASE WHEN direction = 1 THEN currValue ELSE 0 END) AS debitOccF,SUM(CASE WHEN direction = -1 THEN currValue ELSE 0 END) AS creditOccF,SUM(CASE WHEN isTransferVoucher = 1 AND direction = 1 THEN currValue ELSE 0 END) AS tranDebitOccF,SUM(CASE WHEN isTransferVoucher = 1 AND direction = -1 THEN currValue ELSE 0 END) AS tranCreditOccF FROM {dbName}.fin_assitementry WHERE customerId = {customerId} AND yyyy = {yyyy} AND currency > '' GROUP BY customerId,yyyy,subjectId,assitemId,month,currency) b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId AND b.assitemId = a.assitemId AND b.subMonth = a.subMonth AND b.currency = a.currency SET a.debitOcc = b.debitOcc,a.creditOcc = b.creditOcc,a.tranDebitOcc = b.tranDebitOcc,a.tranCreditOcc = b.tranCreditOcc,a.debitOccNoTran = b.debitOcc - b.tranDebitOcc,a.creditOccNoTran = b.creditOcc - b.tranCreditOcc,a.debitOccF = b.debitOccF,a.creditOccF = b.creditOccF,a.tranDebitOccF = b.tranDebitOccF,a.tranCreditOccF = b.tranCreditOccF,a.debitOccNoTranF = b.debitOccF - b.tranDebitOccF,a.creditOccNoTranF = b.creditOccF - b.tranCreditOccF WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u8BA1\u7B97\u5916\u5E01\u6838\u7B97\u79D1\u76EE\u4F59\u989D\u88681\u6708\u671F\u521D\u672B,\u7D2F\u8BA1\u53D1\u751F\u989D
other.EX100039=UPDATE {dbName}.fin_assitementryaccall SET debitTotalOcc = debitOcc,creditTotalOcc = creditOcc,debitBalance = IF(direction = 1,remain + direction * (debitOcc - creditOcc),0),creditBalance = IF(direction = -1,remain + direction * (debitOcc - creditOcc),0),balance = direction * (debitBalance - creditBalance),debitTotalOccF = debitOccF,creditTotalOccF = creditOccF,debitBalanceF = IF(direction = 1,remainF + direction * (debitOccF - creditOccF),0),creditBalanceF = IF(direction = -1,remainF + direction * (debitOccF - creditOccF),0),balanceF = direction * (debitBalanceF - creditBalanceF) WHERE customerId = {customerId} AND yyyy = {yyyy} AND subMonth = 1
#\u8BA1\u7B97\u5916\u5E01\u6838\u7B97\u79D1\u76EE\u4F59\u989D\u88682~12\u671F\u521D\u672B,\u7D2F\u8BA1\u53D1\u751F\u989D
other.EX100040=UPDATE {dbName}.fin_assitementryaccall a INNER JOIN {dbName}.fin_assitementryaccall b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId AND b.assitemId = a.assitemId AND b.subMonth = {lastMonth} AND b.currency = a.currency LEFT JOIN (SELECT customerId,yyyy,subjectId,assItemId,currency,{subMonth} AS subMonth,SUM(debitOcc) AS debitTotalOcc,SUM(creditOcc) AS creditTotalOcc,SUM(debitOccF) AS debitTotalOccF,SUM(creditOccF) AS creditTotalOccF FROM {dbName}.fin_assitementryaccall WHERE customerId = {customerId} AND yyyy = {yyyy} AND subMonth <= {subMonth} GROUP BY customerId,yyyy,subjectId,assItemId,currency) c ON c.customerId = a.customerId AND c.yyyy = a.yyyy AND c.subjectId = a.subjectId AND c.assItemId = a.assItemId AND c.currency = a.currency AND c.subMonth = a.subMonth SET a.debitRemain = b.debitBalance,a.creditRemain = b.creditBalance,a.remain = b.balance,a.debitBalance = IF(a.direction = 1,b.balance + a.direction * (a.debitOcc - a.creditOcc),0),a.creditBalance = IF(a.direction = -1,b.balance + a.direction * (a.debitOcc - a.creditOcc),0),a.balance = a.direction * (b.debitBalance - b.creditBalance + a.debitOcc - a.creditOcc),a.debitTotalOcc = c.debitTotalOcc,a.creditTotalOcc = c.creditTotalOcc,a.debitRemainF = b.debitBalanceF,a.creditRemainF = b.creditBalanceF,a.remainF = b.balanceF,a.debitBalanceF = IF(a.direction = 1,b.balanceF + a.direction * (a.debitOccF - a.creditOccF),0),a.creditBalanceF = IF(a.direction = -1,b.balanceF + a.direction * (a.debitOccF - a.creditOccF),0),a.balanceF = a.direction * (b.debitBalanceF - b.creditBalanceF + a.debitOccF - a.creditOccF),a.debitTotalOccF = c.debitTotalOccF,a.creditTotalOccF = c.creditTotalOccF WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} AND a.subMonth = {subMonth}
#\u8BA1\u7B97\u5916\u5E01\u6838\u7B97\u79D1\u76EE\u4F59\u989D\u8868\u7236\u7EA7\u79D1\u76EE\u6839\u636E\u5B50\u7EA7\u79D1\u76EE
other.EX100041=UPDATE {dbName}.fin_assitementryaccall a INNER JOIN (SELECT a.customerId,a.yyyy,a.subjectId,b.parentAssItemId AS assItemId,a.subMonth,a.currency,SUM(a.debitRemain) AS debitRemain,SUM(a.creditRemain) AS creditRemain,SUM(a.remain) AS remain,SUM(a.debitOcc) AS debitOcc,SUM(a.creditOcc) AS creditOcc,SUM(a.tranDebitOcc) AS tranDebitOcc,SUM(a.tranCreditOcc) AS tranCreditOcc,SUM(a.debitOccNoTran) AS debitOccNoTran,SUM(a.creditOccNoTran) AS creditOccNoTran,SUM(a.debitTotalOcc) AS debitTotalOcc,SUM(a.creditTotalOcc) AS creditTotalOcc,SUM(a.debitBalance) AS debitBalance,SUM(a.creditBalance) AS creditBalance,SUM(a.balance) AS balance,SUM(a.debitRemainF) AS debitRemainF,SUM(a.creditRemainF) AS creditRemainF,SUM(a.remainF) AS remainF,SUM(a.debitOccF) AS debitOccF,SUM(a.creditOccF) AS creditOccF,SUM(a.tranDebitOccF) AS tranDebitOccF,SUM(a.tranCreditOccF) AS tranCreditOccF,SUM(a.debitOccNoTranF) AS debitOccNoTranF,SUM(a.creditOccNoTranF) AS creditOccNoTranF,SUM(a.debitTotalOccF) AS debitTotalOccF,SUM(a.creditTotalOccF) AS creditTotalOccF,SUM(a.debitBalanceF) AS debitBalanceF,SUM(a.creditBalanceF) AS creditBalanceF,SUM(a.balanceF) AS balanceF FROM {dbName}.fin_assitementryaccall a LEFT JOIN {dbName}.fin_assitem b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId AND b.assitemId = a.assItemId WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} AND a.isLeaf1 = 1 GROUP BY a.customerId,a.yyyy,a.subjectId,b.parentAssItemId,a.currency,a.subMonth) b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subjectId = a.subjectId AND b.assItemId = a.assItemId AND b.currency = a.currency AND b.subMonth = a.subMonth SET a.debitRemain = b.debitRemain,a.creditRemain = b.creditRemain,a.remain = b.remain,a.debitOcc = b.debitOcc,a.creditOcc = b.creditOcc,a.tranDebitOcc = b.tranDebitOcc,a.tranCreditOcc = b.tranCreditOcc,a.debitOccNoTran = b.debitOccNoTran,a.creditOccNoTran = b.creditOccNoTran,a.debitTotalOcc = b.debitTotalOcc,a.creditTotalOcc = b.creditTotalOcc,a.debitBalance = b.debitBalance,a.creditBalance = b.creditBalance,a.balance = b.balance,a.debitRemainF = b.debitRemainF,a.creditRemainF = b.creditRemainF,a.remainF = b.remainF,a.debitOccF = b.debitOccF,a.creditOccF = b.creditOccF,a.tranDebitOccF = b.tranDebitOccF,a.tranCreditOccF = b.tranCreditOccF,a.debitOccNoTranF = b.debitOccNoTranF,a.creditOccNoTranF = b.creditOccNoTranF,a.debitTotalOccF = b.debitTotalOccF,a.creditTotalOccF = b.creditTotalOccF,a.debitBalanceF = b.debitBalanceF,a.creditBalanceF = b.creditBalanceF,a.balanceF = b.balanceF WHERE a.customerId = {customerId} AND a.yyyy = {yyyy}
#\u6309\u51ED\u8BC1\u5408\u5E76\u67E5\u8BE2
other.EX100042=SELECT DISTINCT customerId,yyyy,vchDate,oldVoucherId,typeId FROM {dbName}.fin_subjectentry WHERE customerId={customerId} AND yyyy={yyyy}
########## EXCEL \u5206\u6708\u4F59\u989D\u660E\u7EC6\u8868\u5BFC\u5165  EXCEL ##########
########## EXCEL \u6570\u636E\u5BFC\u5165 EXCEL ##########
###ETL
#\u91CD\u7F6E\u4EFB\u52A1\u72B6\u6001
other.EU000001=UPDATE asdb.k_tasklist SET state = {state}, headway = '50%', isImported = '0', jobrunflag = '0', errorCount = 0 WHERE id = {id}
#\u6E05\u7A7A\u9519\u8BEF\u6B21\u6570
other.EU000002=UPDATE asdb.k_tasklist SET errorCount = 0 WHERE id = {id}
#############################WIND#############################
#\u83B7\u53D6\u6709\u5E74\u62A5\u5BA1\u8BA1\u7684\u5BA2\u6237
other.WD000001=SELECT DISTINCT b.restCustomerId AS customerId FROM asdb.z_project a LEFT JOIN bdo_cus.cus_customerinfo b ON b.CustomerId = a.CustomerId LEFT JOIN asdb.z_reportlinknum c ON c.projectid = a.ProjectID WHERE b.restCustomerId > '' AND a.AuditPara = '\u5E74\u62A5\u5BA1\u8BA1' AND c.reportYear = {reportYear} ORDER BY b.restCustomerId
#\u67E5\u80A1\u7968\u4EE3\u7801 \u6587\u53F7
other.WD000002=SELECT a.customerName, a.stock, a.industryclassificationcode AS firstClassCode, a.industryclassification AS firstClassName, a.industrycategorycode AS secondClassCode, a.industrycategory AS secondClassName FROM bdo_cus.cus_customerinfo_basic a WHERE a.customerId = {param1}
#other.WD000003=SELECT c.reportNumber FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.restCustomerId = {companyId} AND a.customerId = b.CustomerId AND b.AuditPara = '\u5E74\u62A5\u5BA1\u8BA1' AND b.financeReportType = {monoOrMerge} INNER JOIN asdb.z_reportlinknum c ON b.ProjectID = c.projectid AND c.reportYear = {reportYear}
other.WD000003=SELECT c.reportNumber FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.restCustomerId = {companyId} AND a.customerId = b.CustomerId AND b.AuditPara = '\u5E74\u62A5\u5BA1\u8BA1' INNER JOIN asdb.z_reportlinknum c ON b.ProjectID = c.projectid AND c.reportYear = {reportYear} ORDER BY b.financeReportType DESC LIMIT 1
#\u83B7\u53D6\u62A5\u8868
other.WD000004=SELECT t2.id fileId, t4.table_div tableDiv, t1.customername FROM bdo_adu.adu_report_filedetailinfo t1, bdo_adu.adu_base_fileinfo_tbl t2, bdo_adu.adu_base_tableinfo_tbl t3, bdo_adu.adu_report_table_code_tbl t4, ( SELECT max(filedate) filedate, filedetailinfoid FROM bdo_adu.adu_base_fileinfo_tbl WHERE filedetailinfoid = ( SELECT max(id) FROM bdo_adu.adu_report_filedetailinfo WHERE reportnumber = '{reportNumber}' )) t5 WHERE t1.reportnumber = '{reportNumber}' AND t1.id = t2.filedetailinfoid AND t2.id = t3.fileinfoid AND t3.tablename = t4.table_name AND t1.id = t5.filedetailinfoid AND t2.filedate = t5.filedate
other.WD000005=SELECT t2.FINALACCRUAL columnn1, t2.OPENACCRUAL columnn2, t3.column_code columnn0, t3.item_name columnName FROM bdo_adu.adu_base_tableinfo_tbl t1, bdo_adu.adu_REPORT_PROINCSTATEMENT_TBL t2, bdo_adu.adu_report_item_code_tbl t3 WHERE t1.fileinfoid =  {fileId} AND t1.id = t2.tableinfoid AND t2.asset_item_code = t3.item_code AND t3.title_flg = 0 AND t3.TABLE_DIV ={tableDiv} ORDER BY t3.line_num
other.WD000006=SELECT t2.FINALACCRUAL columnn1, t2.OPENACCRUAL columnn2, t3.column_code columnn0, t3.item_name columnName FROM bdo_adu.adu_base_tableinfo_tbl t1, bdo_adu.adu_report_proincstatementmerge_tbl t2, bdo_adu.adu_report_item_code_tbl t3 WHERE t1.fileinfoid = {fileId} AND t1.id = t2.tableinfoid AND t2.asset_item_code = t3.item_code AND t3.title_flg = 0 AND t3.TABLE_DIV = {tableDiv} ORDER BY t3.line_num
other.WD000007=SELECT t2.FINALBALA columnn1, t2.OPENBALA columnn2, t3.column_code columnn0, t3.item_name columnName FROM bdo_adu.adu_base_tableinfo_tbl t1, bdo_adu.adu_report_probalsheet_tbl t2, bdo_adu.adu_report_item_code_tbl t3 WHERE t1.fileinfoid = {fileId} AND t1.id = t2.tableinfoid AND t2.asset_item_code = t3.item_code AND t3.title_flg = 0 AND t3.TABLE_DIV = {tableDiv} ORDER BY t3.line_num
other.WD000008=SELECT t2.FINALBALA columnn1, t2.OPENBALA columnn2, t3.column_code columnn0, t3.item_name columnName FROM bdo_adu.adu_base_tableinfo_tbl t1, bdo_adu.adu_report_probalsheet_after_tbl t2, bdo_adu.adu_report_item_code_tbl t3 WHERE t1.fileinfoid = {fileId} AND t1.id = t2.tableinfoid AND t2.asset_item_code = t3.item_code AND t3.title_flg = 0 AND t3.TABLE_DIV = {tableDiv} ORDER BY t3.line_num
other.WD000009=SELECT t2.FINALBALA columnn1, t2.OPENBALA columnn2, t3.column_code columnn0, t3.item_name columnName FROM bdo_adu.adu_base_tableinfo_tbl t1, bdo_adu.adu_report_probalsheetmerge_tbl t2, bdo_adu.adu_report_item_code_tbl t3 WHERE t1.fileinfoid = {fileId} AND t1.id = t2.tableinfoid AND t2.asset_item_code = t3.item_code AND t3.title_flg = 0 AND t3.TABLE_DIV = {tableDiv} ORDER BY t3.line_num
other.WD000010=SELECT t2.FINALBALA columnn1, t2.OPENBALA columnn2, t3.column_code columnn0, t3.item_name columnName FROM bdo_adu.adu_base_tableinfo_tbl t1, bdo_adu.adu_report_probalsheetmerge_after_tbl t2, bdo_adu.adu_report_item_code_tbl t3 WHERE t1.fileinfoid = {fileId} AND t1.id = t2.tableinfoid AND t2.asset_item_code = t3.item_code AND t3.title_flg = 0 AND t3.TABLE_DIV = {tableDiv} ORDER BY t3.line_num
other.WD000011=SELECT t2.FINALACCRUAL columnn1, t2.OPENACCRUAL columnn2, t3.column_code columnn0, t3.item_name columnName FROM bdo_adu.adu_base_tableinfo_tbl t1, bdo_adu.adu_report_procfstatement_tbl t2, bdo_adu.adu_report_item_code_tbl t3 WHERE t1.fileinfoid = {fileId} AND t1.id = t2.tableinfoid AND t2.asset_item_code = t3.item_code AND t3.title_flg = 0 AND t3.TABLE_DIV = {tableDiv} ORDER BY t3.line_num
other.WD000012=SELECT t2.FINALACCRUAL columnn1, t2.OPENACCRUAL columnn2, t3.column_code columnn0, t3.item_name columnName FROM bdo_adu.adu_base_tableinfo_tbl t1, bdo_adu.adu_report_procfstatementmerge_tbl t2, bdo_adu.adu_report_item_code_tbl t3 WHERE t1.fileinfoid = {fileId} AND t1.id = t2.tableinfoid AND t2.asset_item_code = t3.item_code AND t3.title_flg = 0 AND t3.TABLE_DIV = {tableDiv} ORDER BY t3.line_num
#\u641C\u7D22\u5BA2\u6237\u673A\u6784\u540D\u79F0\u548C\u90E8\u95E8\u540D\u79F0
other.WD000013=SELECT d.departname AS departName,d.firstItemName FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.restCustomerId = {companyId} AND a.customerId = b.CustomerId AND b.AuditPara = '\u5E74\u62A5\u5BA1\u8BA1' INNER JOIN asdb.z_reportlinknum c ON b.ProjectID = c.projectid AND c.reportYear = {reportYear} INNER JOIN bdo_base.base_department d ON b.departmentid = d.autoid ORDER BY b.financeReportType DESC LIMIT 1
#\u83B7\u53D6\u7ACB\u4FE1\u5BA2\u6237
other.WD000014=SELECT DISTINCT a.restCustomerId FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.restCustomerId > 0 AND a.customerId = b.CustomerId AND b.AuditPara = '\u5E74\u62A5\u5BA1\u8BA1' INNER JOIN asdb.z_reportlinknum c ON b.ProjectID = c.projectid AND c.reportYear = {reportYear} AND a.restCustomerId >= {nowBdoQuotaCusId}
#\u6839\u636E\u62A5\u8868code\u548C\u6A21\u677Fid\u83B7\u5F97windCode
other.WD000015=SELECT a.column_code AS colCode FROM bdo_adu.adu_report_item_code_tbl a WHERE a.ITEM_CODE = '{ITEM_CODE}'
#\u65B9\u6CD5\u6267\u884C \u8BA1\u7B97\u7ACB\u4FE1\u5BA2\u6237\u6307\u6807 \u83B7\u53D6\u5E74\u62A5\u7ACB\u4FE1\u5BA2\u6237
other.WD000016=SELECT GROUP_CONCAT(DISTINCT b.restCustomerId ORDER BY b.restCustomerId) AS customerId FROM asdb.z_project a LEFT JOIN bdo_cus.cus_customerinfo b ON b.CustomerId = a.CustomerId LEFT JOIN asdb.z_reportlinknum c ON c.projectid = a.ProjectID WHERE b.restCustomerId > '' AND a.AuditPara = '\u5E74\u62A5\u5BA1\u8BA1' AND c.reportYear = {reportYear}
#############################WIND#############################
##############################################################
##\u57F9\u8BAD\u7CFB\u7EDF\u8003\u8BD5\u6210\u7EE9
other.OT00001=SELECT ue.faceCourseId, ue.examPaperId, ue.userScore, ue.passedScore, ue.examTotalScore, ue.examEndTime, ue.isPassed, ue.isView FROM bdo_training.tr_userexamscore ue LEFT JOIN bdo_base.base_user u ON u.id = ue.examUserId WHERE u.hrLoginId = '{hrLoginId}' AND ue.classType = 2 AND ue.faceCourseId = {sacpQeId} ORDER BY ue.LAST_UPDATE_DATE DESC
#\u5408\u5E76\u529F\u80FD \u67E5\u8BE2pie \u6E05\u5355
other.HB00002=SELECT a.stockLevel, a.stockBreakRate, a.stockCapi, a.capiType, a.stockType, a.stockRemark,c.customerId,c.customerName FROM bdo_cus.cus_customerinfo_qccratedetail a LEFT JOIN bdo_cus.cus_customerinfo_qcc b ON b.qccId = a.qccId LEFT JOIN bdo_cus.cus_customerinfo_qcc c ON c.qccId = a.subQccId WHERE a.stockRateType = 1  AND b.customerId = {customerId} ORDER BY stockBreakRate DESC
# \u5408\u5E76\u9879\u76EE\u67E5\u8BE2 \u9879\u76EE\u7BA1\u7406\u7CFB\u7EDF\u4FE1\u606F  \u6839\u636E\u516B\u4F4D\u5BA2\u6237id\u3001\u4E1A\u52A1\u7C7B\u578B\u3001\u9879\u76EE\u5E74\u5EA6\u3001\u90E8\u95E8id \u67E5\u8BE2\u9879\u76EE\u4FE1\u606F
other.HB00003=select z.projectid, auditdept, cus.customerid, accpackageid, audittype, auditpara, projectname, projectcreated, projectend, state, auditpeople, z.property, audittimebegin, audittimeend, realstartdate, realenddate, standbyname, systemid, templatetype, z.departmentid, groupname, groupprojectname, groupprojectid, projecttype, createtime, createuser, projectyear, projectfeeyear, projectfee, shortname, postil, registernum, approvalid, isstateend, sysspecial, isapproval, approvalstate, issign, finalresults, isback, backreson, projectapprovalid, signparaudit, signaudittime, signpar, signadvice, isapt, isaptchanging, aptrelationaudituser, aptrelationauditdate, aptrelationauditstate, aptrelationauditreason, isclose, budgetstate, budgetuser, budgettime, budgetreason, customerlocale, auditstartdate, auditenddate, checkdate, financereporttype, outworktime, auditfee, independencetype,ismilitarysecret, isend, endtime from asdb.z_project z left join bdo_cus.cus_customerinfo cus on cus.customerId = z.CustomerId where cus.restCustomerId = {customerId} and z.AuditPara = {AuditPara} and z.departmentid = {departmentid} and z.projectYear = {year};
# \u5408\u5E76\u9879\u76EE\u67E5\u8BE2 \u9879\u76EE\u7BA1\u7406\u7CFB\u7EDF\u96C6\u56E2\u6811
other.HB00004=SELECT a.uscc, a.register, a.customerId, a.customerName, a.restCustomerId, a.level, a.fullPath , a.PROGRAM_APPLICATION_ID as appId,sockCode,areaPlace,industry FROM bdo_cus.cus_customerInfo a WHERE ( a.fullpath LIKE '{customerId}|%' OR a.fullpath LIKE '%|{customerId}|%' ) and restCustomerId  is not null order by a.fullpath
#\u6839\u636E\u4E0E\u9879\u76EEid \u67E5\u8BE2\u9879\u76EE\u7BA1\u7406\u7CFB\u7EDF \u5BA2\u6237id
other.HB00005=select customerId from asdb.z_project where  ProjectID ={projectId}
#############################HR#############################
other.HR00001=SELECT a.DEPT_ID AS hrDeptId, a.DEPT_CODE AS hrDeptCode, aa.DEPT_ID AS parentId, a.PARENT AS parentCode, a.CONTENT AS hrDeptName, a.GRADE-1 AS level0, b.deptmanagerid AS deptManager FROM myehrlx.dbo.DEPTCODE a LEFT JOIN myehrlx.dbo.v_deptmanage b ON b.auditdeptid = a.DEPT_ID LEFT JOIN myehrlx.dbo.DEPTCODE aa ON aa.DEPT_CODE = a.PARENT WHERE a.GRADE > 1 ORDER BY a.DEPT_CODE
#############################HR#############################
#############################\u6570\u636E\u5BFC\u5165\u7EDF\u8BA1#############################
#\u83B7\u53D6E\u5BA1\u901A\u5BFC\u5165\u5217\u8868
other.CT00001=SELECT b.CustomerID AS customerId,a.uploadCustomer AS customerName,accpackage AS yyyy,CONCAT(b.CustomerID,accpackage) AS accpackage,uploadUser AS loginId,IF(isImported='2',1,0) AS isSuccess FROM asdb.k_tasklist a LEFT JOIN asdb.k_bdocustomer b ON b.DepartName = a.uploadCustomer WHERE 1 = 1 AND uploadCustomer NOT LIKE '%\u5BA1\u8BA1\u5E73\u53F0%' AND STR_TO_DATE(beginTime,'%Y-%m') = STR_TO_DATE('{countDate}','%Y-%m')
#\u83B7\u53D6\u9F0E\u4FE1\u8BFA\u5BFC\u5165\u5217\u8868
other.CT00002=SELECT CustomId AS customerId,CustomName AS customerName,AccountYear AS yyyy,CONCAT(CustomId,AccountYear) AS accpackage,UserName AS loginId,IF(TaskState=6,1,0) AS isSuccess FROM bdo_fin.b_task WHERE 1 = 1 AND CustomName NOT LIKE '%\u5BA1\u8BA1\u5E73\u53F0%' AND STR_TO_DATE(UploadStartTime,'%Y-%m') = STR_TO_DATE('{countDate}','%Y-%m')
#\u83B7\u53D6\u6A21\u677F\u5BFC\u5165\u5217\u8868
other.CT00003=SELECT customerId,customerName,yyyy,CONCAT(customerId,yyyy) AS accpackage,b.hrLoginId AS loginId,IF(importState='9',0,1) AS isSuccess FROM bdo_fin.fin_importlist a LEFT JOIN bdo_base.base_user b ON b.id = a.uploadUser WHERE 1 = 1 AND customerName NOT LIKE '%\u5BA1\u8BA1\u5E73\u53F0%' AND STR_TO_DATE(uploadTime,'%Y-%m') = STR_TO_DATE('{countDate}','%Y-%m')
#\u6839\u636E\u540D\u79F0\u83B7\u53D6\u9879\u76EE\u7CFB\u7EDF\u5BA2\u6237
other.CT00004=SELECT a.restcustomerid AS customerId,dp1.hrDeptCode AS departCode,dp2.hrDeptCode AS officeCode FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.customerid = b.CustomerId LEFT JOIN asdb.z_projectpeople e ON e.projectid = b.projectid INNER JOIN bdo_base.base_user f ON f.hrLoginId = '{loginId}' AND f.id = e.managerid LEFT JOIN bdo_base.base_department dp1 ON dp1.autoid = b.departmentid LEFT JOIN bdo_base.base_department dp2 ON dp2.autoid = dp1.firstItemId WHERE a.customerName = '{customerName}' ORDER BY b.CREATION_DATE DESC LIMIT 1
#\u6839\u636EID\u83B7\u53D6\u9879\u76EE\u7CFB\u7EDF\u5BA2\u6237
other.CT00005=SELECT a.restcustomerid AS customerId,dp1.hrDeptCode AS departCode,dp2.hrDeptCode AS officeCode FROM bdo_cus.cus_customerinfo a INNER JOIN asdb.z_project b ON a.customerid = b.CustomerId LEFT JOIN asdb.z_projectpeople e ON e.projectid = b.projectid INNER JOIN bdo_base.base_user f ON f.hrLoginId = '{loginId}' AND f.id = e.managerid LEFT JOIN bdo_base.base_department dp1 ON dp1.autoid = b.departmentid LEFT JOIN bdo_base.base_department dp2 ON dp2.autoid = dp1.firstItemId WHERE a.restcustomerid = '{customerId}' ORDER BY b.CREATION_DATE DESC LIMIT 1
#############################\u6570\u636E\u5BFC\u5165\u7EDF\u8BA1#############################
#####################\u9879\u76EE\u7BA1\u7406\u7CFB\u7EDF \u67E5\u8BE2###############
other.ID00002=SELECT a.projectYear AS year,f.attributeName AS independenceType, b.customerName AS customerName, a.audittimeend AS balanceDay, d.`NAME` AS projectPartner, e.`NAME` AS projectManager, curdate() AS today FROM asdb.z_project a LEFT JOIN bdo_cus.cus_customerinfo b ON a.customerid = b.customerid LEFT JOIN asdb.z_projectpeople c ON a.ProjectID = c.projectId LEFT JOIN bdo_base.base_user d ON c.signUser = d.id LEFT JOIN bdo_base.base_user e ON c.managerId = e.id LEFT JOIN bdo_base.base_dic f ON f.attributetype = '\u72EC\u7ACB\u6027\u58F0\u660E\u5BA1\u8BA1\u4E1A\u52A1\u7C7B\u578B' AND f.attributeValue1 = a.independenceType WHERE a.ProjectID = {param1}
#############################\u5C0F\u674F\u4EBA#############################
#\u83B7\u53D6E\u5BA1\u901A\u5BFC\u5165\u5217\u8868
other.XXR00001=select checkResult,startTime,endTime,filePath from bdo_xxr.xxr_checkbank where checkid = '{checkId}'
#############################\u5C0F\u674F\u4EBA#############################
#############################\u98CE\u9669\u8BC4\u4F30\u62A5\u544A#############################
#\u5168\u5C40\u4FE1\u606F
other.CR000000=SELECT a.customerId,b.customerName,b.stockCode,b.stockName,b.industryCode,b.industryName,DATE_FORMAT(a.updateDate,'%Y-%m-%d %T') AS updateDate,a.isUpdating FROM bdo_risk.risk_project a INNER JOIN bdo_risk.risk_customerinfo b ON b.riskId = a.riskId WHERE a.riskId = {riskId}
##\u5BA2\u6237\u4FE1\u606F
#\u57FA\u672C\u4FE1\u606F
other.CR000001=SELECT a.customerId,a.customerName,a.corporation,a.registerState,a.incorporationDate,a.register,a.issueDate,a.uscc,a.bpr,a.industrycategory,a.type,a.startTime,a.endTime,a.registerOffice,a.areaPlace,a.areaRegion,a.userbeforename,a.customerEnName,a.registerAddress,b.recCap,b.ixCode,b.orgNo,b.cusScope FROM bdo_cus.cus_customerinfo_basic a LEFT JOIN bdo_cus.cus_customerinfo_basic_qcc b ON b.customerId=a.customerId WHERE a.customerId = {customerId}
#\u4E0A\u5E02\u4FE1\u606F
other.CR000002=SELECT a.customerId,a.customerName,b.astockCode,b.astockName,b.bstockCode,b.bstockName,b.hstockCode,b.hstockName,b.stockType,b.lawFirm,b.accountFirm,b.historyName FROM bdo_cus.cus_customerinfo_basic a LEFT JOIN bdo_cus.cus_customerinfo_basic_qcc b ON b.customerId=a.customerId WHERE a.customerId = {customerId}
#\u80A1\u672C\u7ED3\u6784
other.CR000003=SELECT customerId,changeDate,totalShares,freeShares,banShares FROM bdo_cus.cus_customerinfo_stockstructure WHERE customerId = {customerId} ORDER BY changeDate DESC
#\u5341\u5927\u80A1\u4E1C
other.CR000004=SELECT customerId,stockHolder,stockType,stockCount,stockRate,changeCount,changeProportion FROM bdo_cus.cus_customerinfo_tenstock WHERE customerId = {customerId}
#\u5B9E\u9645\u63A7\u5236\u4EBA
other.CR000005=SELECT customerId,controllerName,stockRate,stockPath FROM bdo_cus.cus_customerinfo_controller WHERE customerId = {customerId}
#\u5206\u652F\u673A\u6784
other.CR000006=SELECT customerId,customerName,customerEnName,uscc,bpr,registerState,registerAddress,industrycategory,type FROM bdo_cus.cus_customerinfo_basic WHERE customerId IN (SELECT DISTINCT branchcustomerId FROM bdo_cus.cus_customerinfo_branch WHERE customerId = {customerId})
#\u5BF9\u5916\u6295\u8D44
other.CR000007=SELECT b.customerId,b.customerName,CONCAT(ROUND(a.stockRate,2),'%') AS stockRate,a.stockCapi,a.capiType,a.stockType,a.stockRemark FROM bdo_cus.cus_customerinfo_qccratedetail a LEFT JOIN bdo_cus.cus_customerinfo_qcc b ON b.qccId = a.subQccId INNER JOIN bdo_cus.cus_customerinfo_qcc c ON c.qccId = a.qccId AND c.customerId = {customerId} WHERE a.stockRateType = '1' AND a.treeType = '1' ORDER BY c.qccId,a.stockRate DESC,b.qccId
#\u589E\u53D1
other.CR000008=SELECT customerId,issueDate,issueAmount,issueCapital,issuePrice,issueType,issueGqdjDate,issueZfssDate,issueZjdzDate FROM bdo_cus.cus_customerinfo_addissue WHERE customerId = {customerId}
#\u5206\u7EA2
other.CR000009=SELECT customerId,shareGgDate,sharePlan,shareGqdjDate,shareCqcxDate,sharePxDate,shareProgress FROM bdo_cus.cus_customerinfo_sharebonus WHERE customerId = {customerId}
#\u914D\u80A1
other.CR000010=SELECT customerId,allotPgggDate,allotPrice,allotAmount,allotCapital,allotGqdjDate,allotPgcqDate,allotType FROM bdo_cus.cus_customerinfo_allot WHERE customerId = {customerId}
##\u8D22\u52A1\u4FE1\u606F
#\u6570\u636E\u6821\u9A8C\u7ED3\u679C
other.CR000020=SELECT checkId,checkTitle,checkExplain,CASE WHEN checkNoPass <> 0 AND checkType = 2 THEN '2' WHEN checkNoPass <> 0 AND checkType = 1 THEN '1' ELSE '0' END AS checkResult,checkPass,checkPassNum,checkNoPass,checkNoPassNum FROM bdo_risk.risk_datacheck WHERE riskId = {riskId} ORDER BY checkNoPass = 0,checkType DESC
#\u6570\u636E\u6821\u9A8C\u7ED3\u679C
other.CR000021=SELECT '' AS customerId,'' AS yyyy,CONCAT(d1,',',d2,',',d3,',',d4,',',d5,',',d6,',',d7,',',d8,',',d9) AS benfordData,result1,result2,result3 FROM bdo_wind.wind_benford  WHERE customerId = 0 UNION SELECT customerId,reportYear AS yyyy,CONCAT(d1,',',d2,',',d3,',',d4,',',d5,',',d6,',',d7,',',d8,',',d9) AS benfordData,result1,result2,result3 FROM bdo_wind.wind_benford  WHERE type ='\u51ED\u8BC1\u5206\u5F55\u91D1\u989D' AND customerId = {customerId} ORDER BY yyyy DESC
#\u5BA2\u6237\u521D\u59CB\u5316\u6570\u636E
other.CR000022=SELECT a.customerId,a.customerName,b.stockCode,b.stockName,IF(a.industrycategory > '',CONCAT(a.industryclassificationcode,a.industrycategorycode),a.industryclassificationcode) AS industryCode,IF(a.industrycategory > '',industrycategory,a.industryclassification) AS industryName FROM bdo_cus.cus_customerinfo_basic a LEFT JOIN bdo_cus.cus_customerinfo_basic_ext b ON b.customerId = a.customerId WHERE a.customerId = {customerId}
#\u51ED\u8BC1
#\u51ED\u8BC1\u5E73\u8861\u6027\u6821\u9A8C
other.CR000030=SELECT customerId,yyyy,oldVoucherId AS voucherId,vchDate,voucherId AS oldVoucherId,typeId,voucherFillUser,voucherKeepUser,voucherAuditUser,debitocc AS debitOcc,creditocc AS creditOcc FROM {lockDbName}.fin_subjectvoucher WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy}  AND debitocc <> creditocc ORDER BY vchDate,voucherId
#\u51ED\u8BC1\u79D1\u76EE\u91CD\u590D\u6821\u9A8C
other.CR000031=SELECT GROUP_CONCAT(DISTINCT voucherId) AS voucherId FROM (SELECT voucherId,subjectId,COUNT(0) AS COUNTNUM FROM (SELECT voucherId,subjectId,direction FROM {lockDbName}.fin_subjectentry WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} GROUP BY voucherId,subjectId,direction) a GROUP BY voucherId,subjectId) a WHERE COUNTNUM > 1
other.CR000032=SELECT customerId,yyyy,oldVoucherId AS voucherId,vchDate,voucherId AS oldVoucherId,typeId,voucherFillUser,voucherKeepUser,voucherAuditUser,debitocc AS debitOcc,creditocc AS creditOcc FROM {lockDbName}.fin_subjectvoucher WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} AND oldVoucherId IN ({voucherId}) ORDER BY vchDate,voucherId
#\u51ED\u8BC1\u501F\u8D37\u65B9\u96F6\u91D1\u989D\u6821\u9A8C
other.CR000033=SELECT customerId,yyyy,oldVoucherId AS voucherId,vchDate,voucherId AS oldVoucherId,typeId,voucherFillUser,voucherKeepUser,voucherAuditUser,debitocc AS debitOcc,creditocc AS creditOcc FROM {lockDbName}.fin_subjectvoucher WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} AND (debitocc = 0 OR creditocc = 0) ORDER BY vchDate,voucherId
#\u51ED\u8BC1\u5F55\u5165\u65E5\u671F\u6821\u9A8C
other.CR000034=SELECT a.customerId,a.yyyy,a.oldVoucherId AS voucherId,a.vchDate,a.voucherId AS oldVoucherId,a.typeId,a.voucherFillUser,a.voucherKeepUser,a.voucherAuditUser,a.debitocc AS debitOcc,a.creditocc AS creditOcc FROM {lockDbName}.fin_subjectvoucher a LEFT JOIN bdo_base.base_holiday b ON b.holiday = a.vchDate WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND (b.TYPE IS NOT NULL OR a.vchDate = '') ORDER BY a.vchDate,a.voucherId
#\u51ED\u8BC1\u5236\u5355\u4EBA\u3001\u5BA1\u6838\u4EBA\u6821\u9A8C
other.CR000035=SELECT customerId,yyyy,oldVoucherId AS voucherId,vchDate,voucherId AS oldVoucherId,typeId,voucherFillUser,voucherKeepUser,voucherAuditUser,debitocc AS debitOcc,creditocc AS creditOcc FROM {lockDbName}.fin_subjectvoucher WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} AND IFNULL(voucherFillUser,'') = IFNULL(voucherAuditUser,'') ORDER BY vchDate,voucherId
#\u4F59\u989D\u8868\u548C\u5916\u5E01\u4F59\u989D\u8868\u671F\u521D\u6570\u6821\u9A8C
other.CR000036=SELECT b.customerId,b.yyyy,b.subjectId,b.subjectName,b.subjectFullName,IFNULL(a.remain,0) AS remain,SUM(IFNULL(b.remainF, 0)) AS remainF FROM {lockDbName}.fin_accountall b INNER JOIN {lockDbName}.fin_account a ON a.customerId = b.customerId AND a.yyyy = b.yyyy AND a.subjectId = b.subjectId AND a.isLeaf1 = 1 AND a.subMonth = 1 WHERE b.customerId = {lockCustomerId} AND b.yyyy = {lockYyyy} AND b.isLeaf1 = 1 AND b.subMonth = 1 GROUP BY b.customerId,b.yyyy,b.subjectId HAVING remain <> remainF ORDER BY b.subjectId
#\u4F59\u989D\u8868\u548C\u5916\u5E01\u4F59\u989D\u8868\u671F\u672B\u6570\u6821\u9A8C
other.CR000037=SELECT b.customerId,b.yyyy,b.subjectId,b.subjectName,b.subjectFullName,IFNULL(a.balance,0) AS balance,SUM(IFNULL(b.balanceF, 0)) AS balanceF FROM {lockDbName}.fin_accountall b INNER JOIN {lockDbName}.fin_account a ON a.customerId = b.customerId AND a.yyyy = b.yyyy AND a.subjectId = b.subjectId AND a.isLeaf1 = 1 AND a.subMonth = 12 WHERE b.customerId = {lockCustomerId} AND b.yyyy = {lockYyyy} AND b.isLeaf1 = 1 AND b.subMonth = 12 GROUP BY b.customerId,b.yyyy,b.subjectId HAVING balance <> balanceF ORDER BY b.subjectId
#\u6838\u7B97\u4F59\u989D\u8868\u548C\u5916\u5E01\u6838\u7B97\u4F59\u989D\u8868\u671F\u521D\u6570\u6821\u9A8C
other.CR000038=SELECT b.customerId,b.yyyy,b.subjectId,b.subjectName,b.subjectFullName,b.assItemId,b.assItemName,b.assTotalName,IFNULL(a.remain,0) AS remain,SUM(IFNULL(b.remainF, 0)) AS remainF FROM {lockDbName}.fin_assitementryaccall b INNER JOIN {lockDbName}.fin_assitementryacc a ON a.customerId = b.customerId AND a.yyyy = b.yyyy AND a.subjectId = b.subjectId AND a.assItemId = b.assItemId AND a.isLeaf1 = 1 AND a.subMonth = 1 WHERE b.customerId = {lockCustomerId} AND b.yyyy = {lockYyyy} AND b.isLeaf1 = 1 AND b.subMonth = 1 GROUP BY b.customerId,b.yyyy,b.subjectId,b.assItemId HAVING remain <> remainF ORDER BY b.subjectId,b.assItemId
#\u6838\u7B97\u4F59\u989D\u8868\u548C\u5916\u5E01\u6838\u7B97\u4F59\u989D\u8868\u671F\u672B\u6570\u6821\u9A8C
other.CR000039=SELECT b.customerId,b.yyyy,b.subjectId,b.subjectName,b.subjectFullName,b.assItemId,b.assItemName,b.assTotalName,IFNULL(a.balance,0) AS balance,SUM(IFNULL(b.balanceF, 0)) AS balanceF FROM {lockDbName}.fin_assitementryaccall b INNER JOIN {lockDbName}.fin_assitementryacc a ON a.customerId = b.customerId AND a.yyyy = b.yyyy AND a.subjectId = b.subjectId AND a.assItemId = b.assItemId AND a.isLeaf1 = 1 AND a.subMonth = 12 WHERE b.customerId = {lockCustomerId} AND b.yyyy = {lockYyyy} AND b.isLeaf1 = 1 AND b.subMonth = 12 GROUP BY b.customerId,b.yyyy,b.subjectId,b.assItemId HAVING balance <> balanceF ORDER BY b.subjectId,b.assItemId
#\u79D1\u76EE\u671F\u521D\u6570\u6821\u9A8C
other.CR000040=SELECT b.customerId,b.yyyy,b.subjectId,b.subjectName,b.subjectFullName,IFNULL(b.remain,0) AS remain,IFNULL(a.balance,0) AS balance FROM {lockDbName}.fin_account b LEFT JOIN {lockDbName}.fin_account a ON a.customerId = {lockCustomerId} AND a.yyyy = ({lockYyyy} - 1) AND a.subjectId = b.subjectId AND a.subMonth = 12 WHERE b.customerId = {lockCustomerId} AND b.yyyy = {lockYyyy} AND b.subMonth = 1 AND IFNULL(b.remain,0) <> IFNULL(a.balance,0) ORDER BY b.subjectId
#\u6838\u7B97\u79D1\u76EE\u671F\u521D\u6570\u6821\u9A8C
other.CR000041=SELECT b.customerId,b.yyyy,b.subjectId,b.subjectName,b.subjectFullName,b.assItemId,b.assItemName,b.assTotalName,IFNULL(b.remain,0) AS remain,IFNULL(a.balance,0) AS balance FROM {lockDbName}.fin_assitementryacc b LEFT JOIN {lockDbName}.fin_assitementryacc a ON a.customerId = {lockCustomerId} AND a.yyyy = ({lockYyyy} - 1) AND a.subjectId = b.subjectId AND a.assItemId = b.assItemId AND a.subMonth = 12 WHERE b.customerId = {lockCustomerId} AND b.yyyy = {lockYyyy} AND b.subMonth = 1 AND IFNULL(b.remain,0) <> IFNULL(a.balance,0) ORDER BY b.subjectId
#\u79D1\u76EE\u4F59\u989D\u548C\u53D1\u751F\u989D\u5E73\u8861\u6027\u6821\u9A8C
other.CR000042=SELECT a.customerId,a.yyyy,a.subjectId,a.subjectName,a.subjectFullName,a.subMonth,a.debitOcc,a.creditOcc,IFNULL(b.debitOccS,0) AS debitOccS,IFNULL(b.creditOccS,0) AS creditOccS FROM {lockDbName}.fin_account a LEFT JOIN (SELECT subjectId,month,SUM(CASE direction WHEN 1 THEN occurValue ELSE 0 END) AS debitOccS,SUM(CASE direction WHEN -1 THEN occurValue ELSE 0 END) AS creditOccS FROM {lockDbName}.fin_subjectentry WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} GROUP BY subjectId,month) b ON b.subjectId = a.subjectId AND b.month = a.subMonth WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND a.isLeaf1 = 1 AND (a.debitOcc <> IFNULL(b.debitOccS,0) OR a.creditOcc <> IFNULL(b.creditOccS,0)) ORDER BY a.subjectId
#\u6838\u7B97\u9879\u548C\u79D1\u76EE\u4F59\u989D\u5E73\u8861\u6027\u6821\u9A8C
other.CR000043=SELECT a.customerId,a.yyyy,a.subjectId,a.subjectName,a.subjectFullName,a.remain,a.debitOcc,a.creditOcc,a.balance,b.remainS,b.debitOccS,b.creditOccS,b.balanceS FROM (SELECT a.customerId,a.yyyy,a.subjectId,a.subjectName,a.subjectFullName,SUM(CASE WHEN subMonth = 1 THEN a.remain ELSE 0 END) AS remain,SUM(a.debitOcc) AS debitOcc,SUM(a.creditOcc) AS creditOcc,SUM(CASE WHEN subMonth = 12 THEN a.balance ELSE 0 END) AS balance FROM {lockDbName}.fin_account a WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND a.isLeaf1 = 1 GROUP BY a.subjectId) a INNER JOIN (SELECT a.subjectId,SUM(CASE WHEN subMonth = 1 THEN a.remain ELSE 0 END) AS remainS,SUM(a.debitOcc) AS debitOccS,SUM(a.creditOcc) AS creditOccS,SUM(CASE WHEN subMonth = 12 THEN a.balance ELSE 0 END) AS balanceS FROM {lockDbName}.fin_assitementryacc a WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND a.isLeaf1 = 1 GROUP BY a.subjectId) b ON b.subjectId = a.subjectId WHERE (remain <> remainS OR debitOcc <> debitOccS OR creditOcc <> creditOccS OR balance <> balanceS)
#\u6838\u7B97\u79D1\u76EE\u4F59\u989D\u6821\u9A8C
other.CR000044=SELECT customerId,yyyy,subjectId,subjectName,subjectFullName,SUM(balance) AS balance FROM {lockDbName}.fin_assitementryacc WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} AND subMonth = 12 GROUP BY subjectId HAVING balance < 0 ORDER BY subjectId 
#\u635F\u76CA\u662F\u5426\u7ED3\u8F6C\u6821\u9A8C
other.CR000045=SELECT customerId,yyyy,subjectId,subjectName,subjectFullName,balance FROM {lockDbName}.fin_account WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} AND subMonth = 12 AND balance <> 0 AND LEFT(subjectId,1) IN (SELECT LEFT(subjectId,1) FROM {lockDbName}.fin_accpkgsubject WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} AND subjectName IN ('\u4E3B\u8425\u4E1A\u52A1\u6536\u5165','\u8425\u4E1A\u6536\u5165')) ORDER BY subjectId  
#\u4F59\u989D\u8868\u7EA7\u6B21\u91D1\u989D\u6821\u9A8C
other.CR000046=SELECT a.customerId,a.yyyy,a.subjectId,a.subjectName,a.subjectFullName,a.subMonth,a.remain,a.debitOcc,a.creditOcc,a.balance,SUM(b.remain) AS remainS,SUM(b.debitOcc) AS debitOccS,SUM(b.creditOcc) AS creditOccS,SUM(b.balance) AS balanceS FROM {lockDbName}.fin_account a LEFT JOIN {lockDbName}.fin_account b ON b.customerId = a.customerId AND b.yyyy = a.yyyy AND b.subMonth = a.subMonth AND b.isLeaf1 = 1 AND b.subjectId LIKE CONCAT(a.subjectId,'%') WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND a.isLeaf1 = 0 GROUP BY a.subjectId,a.subMonth HAVING (remain <> remainS OR debitOcc <> debitOccS OR creditOcc <> creditOccS OR balance<> balanceS) ORDER BY a.subjectId,a.subMonth
#\u5206\u5F55\u79D1\u76EE\u7F16\u7801\u6821\u9A8C
other.CR000047=SELECT customerId,yyyy,voucherId,vchDate,oldVoucherId,typeId,summary,voucherFillUser,voucherKeepUser,voucherAuditUser,IF(direction=1,'\u501F','\u8D37') AS direction,occurValue FROM {lockDbName}.fin_subjectentry WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} AND IFNULL(subjectId,'') = '' ORDER BY vchDate,voucherId,serail
#\u5206\u5F55\u7F16\u5236\u4EBA\u5458\u6821\u9A8C
other.CR000048=SELECT customerId,yyyy,oldVoucherId AS voucherId,vchDate,voucherId AS oldVoucherId,typeId,voucherFillUser,voucherKeepUser,voucherAuditUser,debitocc AS debitOcc,creditocc AS creditOcc FROM {lockDbName}.fin_subjectvoucher WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy}  AND (IFNULL(voucherFillUser,'')='') ORDER BY vchDate,voucherId
#\u5206\u5F55\u51ED\u8BC1\u7C7B\u578B\u6821\u9A8C
other.CR000049=SELECT customerId,yyyy,oldVoucherId AS voucherId,vchDate,voucherId AS oldVoucherId,typeId,voucherFillUser,voucherKeepUser,voucherAuditUser,debitocc AS debitOcc,creditocc AS creditOcc FROM {lockDbName}.fin_subjectvoucher WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy}  AND (IFNULL(typeId,'')='') ORDER BY vchDate,voucherId
#\u5206\u5F55\u51ED\u8BC1\u7F16\u53F7\u6821\u9A8C
other.CR000050=SELECT customerId,yyyy,oldVoucherId AS voucherId,vchDate,voucherId AS oldVoucherId,typeId,voucherFillUser,voucherKeepUser,voucherAuditUser,debitocc AS debitOcc,creditocc AS creditOcc FROM {lockDbName}.fin_subjectvoucher WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy}  AND NOT (voucherId>'' AND oldVoucherId>'') ORDER BY vchDate,voucherId
#\u5206\u5F55\u91D1\u989D\u8D1F\u6570\u6821\u9A8C
other.CR000051=SELECT customerId,yyyy,voucherId,vchDate,oldVoucherId,typeId,summary,voucherFillUser,voucherKeepUser,voucherAuditUser,IF(direction=1,'\u501F','\u8D37') AS direction,occurValue FROM {lockDbName}.fin_subjectentry WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} AND occurValue < 0 ORDER BY vchDate,voucherId,serail
#\u5206\u5F55\u6458\u8981\u6821\u9A8C
other.CR000052=SELECT customerId,yyyy,voucherId,vchDate,oldVoucherId,typeId,summary,voucherFillUser,voucherKeepUser,voucherAuditUser,IF(direction=1,'\u501F','\u8D37') AS direction,occurValue FROM {lockDbName}.fin_subjectentry WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} AND summary REGEXP '^(-) ?[1-9][0-9]*(.) [0-9]*$|(\u8F67\u5DEE) |(\u51B2\u62B5) |^[[:space:]]*$' ORDER BY vchDate,voucherId,serail
##\u8D22\u52A1\u62A5\u8868
#\u5229\u6DA6\u8868
other.CR000071=SELECT a.reportDate,b.pCol1,b.pCol2,b.pCol3,b.pCol4,b.pCol5,b.pCol6,b.pCol7,b.pCol8,b.pCol9,b.pCol10,b.pCol11,b.pCol12,b.pCol13,b.pCol14,b.pCol15,b.pCol16,b.pCol17,b.pCol18,b.pCol19,b.pCol20,b.pCol21,b.pCol22,b.pCol23,b.pCol24,b.pCol25,b.pCol26,b.pCol27,b.pCol28,b.pCol29,b.pCol30,b.pCol31,b.pCol32,b.pCol33,b.pCol34,b.pCol35,b.pCol36,b.pCol37,b.pCol38,b.pCol39,b.pCol40,b.pCol41,b.pCol42,b.pCol43,b.pCol44,b.pCol45,b.pCol46,b.pCol47,b.pCol48,b.pCol49,b.pCol50,b.pCol51,b.pCol52,b.pCol53,b.pCol54,b.pCol55,b.pCol56,b.pCol57,b.pCol58,b.pCol59,b.pCol60,b.pCol61,b.pCol62,b.pCol63,b.pCol64,b.pCol65,b.pCol66,b.pCol67,b.pCol68,b.pCol69,b.pCol70,b.pCol71,b.pCol72,b.pCol73,b.pCol74,b.pCol75 FROM bdo_wind.wind_table_info_bdo a LEFT JOIN bdo_wind.wind_profit_statement_bdo b ON b.tableId = a.tableId WHERE a.companyId = {customerId} AND a.reportType = 1 AND a.reportDate IN ({reportDate}) AND a.monoOrMerge={monoOrMerge} ORDER BY a.reportDate DESC
#\u8D44\u4EA7\u8D1F\u503A\u8868
other.CR000072=SELECT a.reportDate,b.bCol1,b.bCol2,b.bCol3,b.bCol4,b.bCol5,b.bCol6,b.bCol7,b.bCol8,b.bCol9,b.bCol10,b.bCol11,b.bCol12,b.bCol13,b.bCol14,b.bCol15,b.bCol16,b.bCol17,b.bCol18,b.bCol19,b.bCol20,b.bCol21,b.bCol22,b.bCol23,b.bCol24,b.bCol25,b.bCol26,b.bCol27,b.bCol28,b.bCol29,b.bCol30,b.bCol31,b.bCol32,b.bCol33,b.bCol34,b.bCol35,b.bCol36,b.bCol37,b.bCol38,b.bCol39,b.bCol40,b.bCol41,b.bCol42,b.bCol43,b.bCol44,b.bCol45,b.bCol46,b.bCol47,b.bCol48,b.bCol49,b.bCol50,b.bCol51,b.bCol52,b.bCol53,b.bCol54,b.bCol55,b.bCol56,b.bCol57,b.bCol58,b.bCol59,b.bCol60,b.bCol61,b.bCol62,b.bCol63,b.bCol64,b.bCol65,b.bCol66,b.bCol67,b.bCol68,b.bCol69,b.bCol70,b.bCol71,b.bCol72,b.bCol73,b.bCol74,b.bCol75,b.bCol76,b.bCol77,b.bCol78,b.bCol79,b.bCol80,b.bCol81,b.bCol82,b.bCol83,b.bCol84,b.bCol85,b.bCol86,b.bCol87,b.bCol88,b.bCol89,b.bCol90,b.bCol91,b.bCol92,b.bCol93,b.bCol94,b.bCol95,b.bCol96,b.bCol97,b.bCol98,b.bCol99,b.bCol100,b.bCol101,b.bCol102,b.bCol103,b.bCol104,b.bCol105,b.bCol106,b.bCol107,b.bCol108,b.bCol109,b.bCol110,b.bCol111,b.bCol112,b.bCol113,b.bCol114,b.bCol115,b.bCol116,b.bCol117,b.bCol118,b.bCol119,b.bCol120,b.bCol121,b.bCol122,b.bCol123,b.bCol124,b.bCol125,b.bCol126,b.bCol127,b.bCol128,b.bCol129,b.bCol130,b.bCol131,b.bCol132,b.bCol133,b.bCol134,b.bCol135,b.bCol136,b.bCol137,b.bCol138,b.bCol139,b.bCol140,b.bCol141,b.bCol142,b.bCol143,b.bCol144,b.bCol145,b.bCol146,b.bCol147,b.bCol148,b.bCol149,b.bCol150,b.bCol151,b.bCol152,b.bCol153,b.bCol154,b.bCol155,b.bCol156,b.bCol157,b.bCol158,b.bCol159,b.bCol160,b.bCol161,b.bCol162,b.bCol163,b.bCol164,b.bCol165,b.bCol166,b.bCol167,b.bCol168,b.bCol169,b.bCol170,b.bCol171,b.bCol172,b.bCol173,b.bCol174,b.bCol175 FROM bdo_wind.wind_table_info_bdo a LEFT JOIN bdo_wind.wind_balance_sheet_bdo b ON b.tableId = a.tableId WHERE a.companyId = {customerId} AND a.reportType = 2 AND a.reportDate IN ({reportDate}) AND a.monoOrMerge={monoOrMerge} ORDER BY a.reportDate DESC
#\u73B0\u91D1\u6D41\u91CF\u8868
other.CR000073=SELECT a.reportDate,b.cCol1,b.cCol2,b.cCol3,b.cCol4,b.cCol5,b.cCol6,b.cCol7,b.cCol8,b.cCol9,b.cCol10,b.cCol11,b.cCol12,b.cCol13,b.cCol14,b.cCol15,b.cCol16,b.cCol17,b.cCol18,b.cCol19,b.cCol20,b.cCol21,b.cCol22,b.cCol23,b.cCol24,b.cCol25,b.cCol26,b.cCol27,b.cCol28,b.cCol29,b.cCol30,b.cCol31,b.cCol32,b.cCol33,b.cCol34,b.cCol35,b.cCol36,b.cCol37,b.cCol38,b.cCol39,b.cCol40,b.cCol41,b.cCol42,b.cCol43,b.cCol44,b.cCol45,b.cCol46,b.cCol47,b.cCol48,b.cCol49,b.cCol50,b.cCol51,b.cCol52,b.cCol53,b.cCol54,b.cCol55,b.cCol56,b.cCol57,b.cCol58,b.cCol59,b.cCol60,b.cCol61,b.cCol62,b.cCol63,b.cCol64,b.cCol65,b.cCol66,b.cCol67,b.cCol68,b.cCol69,b.cCol70,b.cCol71,b.cCol72,b.cCol73,b.cCol74,b.cCol75,b.cCol76,b.cCol77,b.cCol78,b.cCol79,b.cCol80,b.cCol81,b.cCol82,b.cCol83,b.cCol84,b.cCol85,b.cCol86,b.cCol87,b.cCol88,b.cCol89,b.cCol90,b.cCol91,b.cCol92,b.cCol93,b.cCol94,b.cCol95,b.cCol96,b.cCol97,b.cCol98,b.cCol99,b.cCol100,b.cCol101,b.cCol102,b.cCol103,b.cCol104,b.cCol105,b.cCol106,b.cCol107,b.cCol108,b.cCol109,b.cCol110,b.cCol111,b.cCol112,b.cCol113,b.cCol114,b.cCol115,b.cCol116 FROM bdo_wind.wind_table_info_bdo a LEFT JOIN bdo_wind.wind_cash_flow_statement_bdo b ON b.tableId = a.tableId WHERE a.companyId = {customerId} AND a.reportType = 3 AND a.reportDate IN ({reportDate}) AND a.monoOrMerge={monoOrMerge} ORDER BY a.reportDate DESC
#\u67E5\u8BE2\u6240\u6709\u62A5\u544A\u671F
other.CR000074=SELECT DISTINCT reportDate AS singleItem FROM bdo_risk.risk_statement WHERE riskId = {riskId} ORDER BY reportDate ASC LIMIT 5
#\u83B7\u53D6\u6307\u5B9A\u62A5\u8868\u9879
other.CR000075=SELECT columnCode,columnDisp,columnAmount,columnFormula FROM bdo_risk.risk_statement WHERE riskId = {riskId} AND reportDate = '{reportDate}' AND reportType = '{reportType}' AND columnCode IN ({columnCode}) ORDER BY sortNum
##\u98CE\u9669\u626B\u63CF
#\u8D22\u52A1\u8D26\u5957\u5F02\u5E38\u9879
other.CR000090=SELECT checkTitle,checkExplain,CASE WHEN checkNoPass <> 0 AND checkType = 2 THEN '2' WHEN checkNoPass <> 0 AND checkType = 1 THEN '1' ELSE '0' END AS checkResult,checkPass,checkPassNum,checkNoPass,checkNoPassNum FROM bdo_risk.risk_datacheck WHERE riskId = {riskId} AND checkNoPass > 0 AND checkType = '2'
#\u8D22\u52A1\u6307\u6807\u5F02\u5E38\u9879
other.CR000091=SELECT COUNT(0) AS quotaNum FROM bdo_risk.risk_quota a WHERE a.riskId = {riskId} AND a.quotaType = '1' AND a.quotaValue = 1
#\u83B7\u53D6\u5F02\u5E38\u6307\u6807
other.CR000092=SELECT b.* FROM bdo_risk.risk_quota a LEFT JOIN bdo_risk.risk_defquota b ON b.quotaCode = a.quotaCode WHERE a.riskId = {riskId} AND a.quotaType = '1' AND a.quotaValue = 1 ORDER BY a.quotaCode
#\u672C\u5E74\u51ED\u8BC1\u91D1\u989D\u672C\u798F\u7279
other.CR000093=SELECT '{yyyy}\u5E74\u8D22\u52A1\u8D26\u5957' AS riskTitle,CONCAT('\u51ED\u8BC1\u91D1\u989D\u76F8\u4F3C\u5EA6:',result1,IF(result1 < 0.90,' \u8D22\u52A1\u6570\u636E\u53EF\u4FE1\u5EA6\u6781\u4F4E!',' \u8D22\u52A1\u6570\u636E\u53EF\u4FE1\u5EA6\u8F83\u4F4E!')) AS riskDetail FROM bdo_wind.wind_benford WHERE type = '\u51ED\u8BC1\u5206\u5F55\u91D1\u989D' AND customerId = {customerId} AND reportYear = {yyyy} AND result1 < 0.94
#\u8D22\u52A1\u62A5\u8868\u5F02\u5E38\u9879
other.CR000094=SELECT a.reportType,TRIM(a.columnDisp) AS columnName,a.columnAmount AS currentAmount,b.columnAmount AS previousAmount,ROUND(100*(a.columnAmount-b.columnAmount)/b.columnAmount,2) AS changeRate,ROUND(100*a.columnAmount/c.columnAmount,2) AS occupyRate FROM bdo_risk.risk_statement a INNER JOIN bdo_risk.risk_statement b ON b.riskId=a.riskId AND b.columnCode=a.columnCode AND b.reportDate='{previousDate}' LEFT JOIN bdo_risk.risk_statement c ON c.riskId=a.riskId AND c.columnCode='A' AND c.reportDate='{reportDate}' WHERE a.riskId={riskId} AND a.reportType='2' AND a.reportDate='{reportDate}' HAVING ABS(changeRate)>={changeThreshold} AND ABS(occupyRate)>={profitsValue} UNION SELECT a.reportType,TRIM(a.columnDisp) AS columnName,a.columnAmount AS currentAmount,b.columnAmount AS previousAmount,ROUND(100*(a.columnAmount-b.columnAmount)/b.columnAmount,2) AS changeRate,ROUND(100*a.columnAmount/c.columnAmount,2) AS occupyRate FROM bdo_risk.risk_statement a INNER JOIN bdo_risk.risk_statement b ON b.riskId=a.riskId AND b.columnCode=a.columnCode AND b.reportDate='{previousDate}' LEFT JOIN bdo_risk.risk_statement c ON c.riskId=a.riskId AND c.columnCode='S06' AND c.reportDate='{reportDate}' WHERE a.riskId={riskId} AND a.reportType='1' AND a.reportDate='{reportDate}' HAVING ABS(changeRate)>={changeThreshold} AND ABS(occupyRate)>={assetsValue} UNION SELECT a.reportType,TRIM(a.columnDisp) AS columnName,a.columnAmount AS currentAmount,b.columnAmount AS previousAmount,ROUND(100*(a.columnAmount-b.columnAmount)/b.columnAmount,2) AS changeRate,ROUND(100*a.columnAmount/c.columnAmount,2) AS occupyRate FROM bdo_risk.risk_statement a INNER JOIN bdo_risk.risk_statement b ON b.riskId=a.riskId AND b.columnCode=a.columnCode AND b.reportDate='{previousDate}' LEFT JOIN (SELECT reportType,SUM(columnAmount) AS columnAmount FROM bdo_risk.risk_statement WHERE riskId={riskId} AND reportDate='{reportDate}' AND columnCode IN ('F00004','F00016','F00027')) c ON c.reportType=a.reportType WHERE a.riskId={riskId} AND a.reportType='3' AND a.reportDate='{reportDate}' AND a.columnCode IN ('F00001','F00002','F00003','F00011','F00012','F00013','F00014','F00015','F00023','F00024','F00026') HAVING ABS(changeRate)>={changeThreshold} AND ABS(occupyRate)>={cashInValue} UNION SELECT a.reportType,TRIM(a.columnDisp) AS columnName,a.columnAmount AS currentAmount,b.columnAmount AS previousAmount,ROUND(100*(a.columnAmount-b.columnAmount)/b.columnAmount,2) AS changeRate,ROUND(100*a.columnAmount/c.columnAmount,2) AS occupyRate FROM bdo_risk.risk_statement a INNER JOIN bdo_risk.risk_statement b ON b.riskId=a.riskId AND b.columnCode=a.columnCode AND b.reportDate='{previousDate}' LEFT JOIN (SELECT reportType,SUM(columnAmount) AS columnAmount FROM bdo_risk.risk_statement WHERE riskId={riskId} AND reportDate='{reportDate}' AND columnCode IN ('F00009','F00021','F00031')) c ON c.reportType=a.reportType WHERE a.riskId={riskId} AND a.reportType='3' AND a.reportDate='{reportDate}' AND a.columnCode IN ('F00005','F00006','F00007','F00008','F00017','F00018','F00019','F00020','F00028','F00029','F000{changeThreshold}') HAVING ABS(changeRate)>={changeThreshold} AND ABS(occupyRate)>={cashOutValue}
##\u8D22\u52A1\u6307\u6807
#\u67E5\u8BE2\u5BA1\u8BA1\u5E73\u53F0\u62A5\u8868\u5B57\u6BB5\u548Cwind\u5B57\u6BB5\u5BF9\u4E8E\u5173\u7CFB
other.CR000100=SELECT quotaCode AS label,tableCol AS value FROM bdo_risk.risk_defcolumn WHERE quotaCode > '' AND tableCol > '' AND monoOrMerge={monoOrMerge}
#\u67E5\u8BE2\u516C\u53F8\u6307\u6807
other.CR000101=SELECT a.reportDate,a.quotaCode,b.quotaNameChi,a.quotaValue,b.quotaDisp,a.sourceQuota FROM bdo_risk.risk_quota a INNER JOIN bdo_risk.risk_defquota b ON b.quotaCode = a.sourceQuota AND b.parentCode = '{parentCode}' WHERE a.riskId = '{riskId}' AND a.quotaType = '{quotaType}' ORDER BY a.quotaCode,a.industryCode,reportDate ASC
#\u83B7\u53D6\u8981\u67E5\u8BE2\u7684\u884C\u4E1A\u6307\u6807\u5217\u540D
other.CR000102=SELECT GROUP_CONCAT(CONCAT(columnName,'Avg AS ',quotaCode)) FROM bdo_risk.risk_defquota WHERE parentCode = '{quotaType}'
#\u83B7\u53D6\u884C\u4E1A\u6307\u6807
other.CR000103=SELECT reportDate,{industryQuotaCol} FROM bdo_wind.wind_industry_quota a WHERE stock_palte = '{stockPalte}' AND programCode = '{industryCode}' AND periodStandard = '2' ORDER BY reportDate DESC
#\u67E5\u627E\u6307\u6807\u5B9A\u4E49
other.CR000104=SELECT * FROM bdo_risk.risk_defquota WHERE quotaType IN ({quotaType})
#\u83B7\u53D6\u62A5\u544A\u65E5\u671F,\u884C\u4E1A,\u677F\u5757,\u516C\u53F8
other.CR000105=SELECT a.reportYear,a.reportDate,a.{industryType} AS industryCode,c.className AS industryName,GROUP_CONCAT(DISTINCT a.companyId) AS customerId FROM bdo_wind.wind_company_industry a INNER JOIN bdo_wind.wind_company_general b ON b.companyid = a.companyId AND b.ACTIVE_FLAG = '1' LEFT JOIN bdo_wind.wind_defindustry c ON c.classCode = a.{industryType} WHERE a.stock_palte IN ({stockPalte}) AND a.period = 1 AND a.reportDate IN ({reportDate}) AND a.{industryType} = '{industryCode}' /*START #areaRegion# AND (areaRegion LIKE '%{areaRegion}%') #areaRegion# END*/ /*START #areaPlace# AND (areaPlace LIKE '%{areaPlace}%' ) #areaPlace# END*/ GROUP BY a.reportDate DESC,a.{industryType} LIMIT 5
#\u83B7\u53D6\u6307\u6807
other.CR000106=SELECT quotaCode,quotaValue FROM bdo_risk.risk_quota WHERE riskId = {riskId} AND reportDate = '{reportDate}' AND quotaType IN ({quotaType})
#\u83B7\u53D6\u6307\u6807\u6570\u636E
other.CR000107=SELECT * FROM bdo_risk.risk_quota WHERE riskId = {riskId} AND quotaType IN ('0','2','3','4','5') AND reportDate IN ({reportDate}) ORDER BY quotaCode,reportDate DESC
#\u67E5\u8BE2\u6307\u5B9A\u6307\u6807
other.CR000108=SELECT * FROM bdo_risk.risk_defquota WHERE quotaCode IN ({quotaCode})
##\u76D1\u7BA1\u6D88\u606F
#\u76D1\u7BA1\u6D88\u606F\u5217\u8868
other.CR000200=SELECT b.letterTypeName AS letterType,b.letterName,b.letterOrg,b.letterDate,b.letterReturnDate,b.letterId,GROUP_CONCAT(DISTINCT c.labelList) AS letterLabel FROM bdo_regu.regu_relevance_customer a INNER JOIN bdo_regu.regu_letter b ON b.letterId = a.letterId /*START #letterType# AND b.letterTypeName IN ({letterType}) #letterType# END*/ /*START #letterOrg# AND b.letterOrg IN ({letterOrg}) #letterOrg# END*/ INNER JOIN bdo_regu.regu_letter_ask_answer c ON c.letterId = a.letterId INNER JOIN bdo_regu.regu_letter_question_label_type d ON d.letterId = a.letterId /*START #askLabel# AND d.labelCode IN ({askLabel}) #askLabel# END*/ WHERE a.customerId = {customerId} GROUP BY b.letterId ORDER BY b.letterDate DESC,b.letterReturnDate DESC
#\u76D1\u7BA1\u6D88\u606F\u9644\u4EF6
other.CR000201=SELECT letterId, '\u53D1\u51FD\u6587\u4EF6' AS fileType,autoId AS fileId,letterAtachmentName AS fileName,CONCAT('{bdoReguUrl}',letterAtachmentUrl) AS fileUrl,letterDate FROM bdo_regu.regu_letter_incoming_file WHERE letterId = {letterId} UNION ALL SELECT letterId, '\u56DE\u51FD\u6587\u4EF6' AS fileType,autoId AS fileId,fileName,CONCAT('{bdoReguUrl}',fileUrl) AS fileUrl,letterDate FROM bdo_regu.regu_letter_reply_file WHERE letterId = {letterId} ORDER BY fileType,letterDate DESC
#\u83B7\u53D6\u53D1\u51FD\u6587\u4EF6
other.CR000202=SELECT letterAtachmentName AS fileName,CONCAT('{bdoReguUrl}',letterAtachmentUrl) AS fileUrl FROM bdo_regu.regu_letter_incoming_file WHERE autoId = {fileId}
#\u83B7\u53D6\u56DE\u51FD\u6587\u4EF6
other.CR000203=SELECT fileName,CONCAT('{bdoReguUrl}',fileUrl) AS fileUrl FROM bdo_regu.regu_letter_reply_file WHERE autoId = {fileId}
#\u83B7\u53D6\u76D1\u7BA1\u6D88\u606F\u5934\u90E8\u53CA\u5C3E\u90E8\u5185\u5BB9
other.CR000204=SELECT introductionList AS headerMsg,conclusionList AS footerMsg FROM bdo_regu.regu_letter_detail WHERE id = '{letterId}'
#\u83B7\u53D6\u76D1\u7BA1\u6D88\u606F\u53D1\u51FD\u56DE\u51FD\u95EE\u7B54\u5185\u5BB9
other.CR000205=SELECT askContent AS askMsg,answer AS answerMsg,labelList AS msgLabel FROM bdo_regu.regu_letter_ask_answer WHERE letterId = '{letterId}'
#\u6309\u51FD\u4EF6\u7C7B\u578B\u7EDF\u8BA1
other.CR000206=SELECT '\u5168\u90E8' AS typeCode,'\u5168\u90E8' AS typeName, COUNT(DISTINCT a.letterId) AS typeNum FROM bdo_regu.regu_relevance_customer a WHERE a.customerId = {customerId}
#\u6309\u51FD\u4EF6\u7C7B\u578B\u7EDF\u8BA1
other.CR000207=SELECT b.letterTypeName AS typeCode,b.letterTypeName AS typeName,COUNT(0) AS typeNum FROM bdo_regu.regu_relevance_customer a LEFT JOIN bdo_regu.regu_letter b ON b.letterId = a.letterId WHERE a.customerId = {customerId} GROUP BY b.letterTypeName ORDER BY b.letterTypeName
#\u6309\u53D1\u51FD\u5355\u4F4D\u7EDF\u8BA1
other.CR000208=SELECT b.letterOrg AS typeCode,b.letterOrg AS typeName,COUNT(0) AS typeNum FROM bdo_regu.regu_relevance_customer a LEFT JOIN bdo_regu.regu_letter b ON b.letterId = a.letterId WHERE a.customerId = {customerId} GROUP BY b.letterOrg ORDER BY b.letterOrg
#\u6309\u95EE\u7B54\u6807\u7B7E\u7EDF\u8BA1
other.CR000209=SELECT b.labelCode AS typeCode,c.letterClassName AS typeName,COUNT(0) AS typeNum FROM bdo_regu.regu_relevance_customer a LEFT JOIN bdo_regu.regu_letter_question_label_type b ON b.letterId = a.letterId LEFT JOIN bdo_regu.regu_tree c ON c.id = b.labelCode WHERE a.customerId = {customerId} AND b.labelCode > '' GROUP BY b.labelCode ORDER BY b.labelCode
other.CR000210=SELECT * FROM bdo_risk.risk_statement WHERE riskId = {riskId} AND reportDate = '{reportDate}' AND columnCode IN ({columnCode})
other.CR000211=SELECT a.reportType,a.columnCode,a.columnDisp,a.columnFormula,a.columnType,a.sortNum,b.tableCol,c.columnName FROM bdo_risk.risk_statement a LEFT JOIN bdo_risk.risk_defcolumn b ON b.quotaCode=a.columnCode LEFT JOIN bdo_wind.wind_defcolumn c ON c.tableCol=b.tableCol GROUP BY c.columnName;
other.CR000212=SELECT b.riskId,a.parentCode,b.quotaCode,b.quotaValue,b.reportDate,a.columnName FROM bdo_risk.risk_defquota a LEFT JOIN bdo_risk.risk_quota b ON a.quotaCode=b.quotaCode WHERE a.isCustomer=1 AND b.riskId = {riskId} AND b.reportDate = '{reportDate}' AND  a.quotaCode IN ({quotaCode}) GROUP BY b.quotaCode;
other.CR000213=SELECT a.quotaName,a.quotaNameChi,a.quotaDisp,a.sortNum,b.* FROM bdo_risk.risk_defquota a LEFT JOIN bdo_risk.risk_quota b ON a.quotaCode=b.quotaCode WHERE b.riskId = {riskId} AND b.quotaCode IN ({quotaCode});
other.CR000214=SELECT a.reportDate,a.quotaCode,b.quotaNameChi,a.quotaValue,b.quotaDisp,a.sourceQuota FROM bdo_risk.risk_quota a INNER JOIN bdo_risk.risk_defquota b ON b.quotaCode=a.sourceQuota WHERE a.riskId={riskId} AND a.quotaType='{quotaType}' AND a.quotaCode IN ({quotaCode}) ORDER BY a.quotaCode,a.industryCode,reportDate ASC
other.CR000215=SELECT * FROM bdo_spider.spider_executive_list WHERE customerId={customerId};
other.CR000216=SELECT *,change_person AS changePerson,change_number AS changeNumber,stock_cat AS stockCat,change_date AS changeDate FROM bdo_spider.spider_executive_shareholding_change WHERE customerId={customerId};
other.CR000217=SELECT *,announcement_date AS announcementDate,then_umber AS thenUmber,total_share AS totalShare,shareholder_share AS shareholderShare,start_date AS startDate,end_date AS endDate,release_date AS releaseDate FROM bdo_spider.spider_equity_pledge WHERE customerId={customerId};
other.CR000218=SELECT *,announcement_date AS announcementDate,litigation_type AS litigationType,amount_involved AS amountInvolved,one_prosecution_date AS oneProsecutionDate,one_acceptance_court AS oneAcceptanceCourt,one_sentence_date AS oneSentenceDate,one_sentence_content AS oneSentenceContent,one_appeal_not AS oneAppealNot,two_appellant AS twoAppellant,two_acceptance_court AS twoAcceptanceCourt,two_sentence_date AS twoSentenceDate,two_sentence_content AS twoSentenceContent FROM bdo_spider.spider_litigation_arbitration WHERE customerId={customerId};
other.CR000219=SELECT *,announcement_date AS announcementDate,secured_party AS securedParty,guarantee_mode AS guaranteeMode,guarantee_amount AS guaranteeAmount,guarantee_period AS guaranteePeriod,guarantee_start AS guaranteeStart,guarantee_end AS guaranteeEnd,completed_not AS completedNot,transaction_not AS transactionNot,transaction_date AS transactionDate,guarantee_description AS guaranteeDescription,reporting_period AS reportingPeriod,reporting_period_type AS reportingPeriodType FROM bdo_spider.spider_external_guarantee WHERE customerId={customerId};
other.CR000220=SELECT *,announcement_date AS announcementDate,penalty_object AS penaltyObject,disposition_type AS dispositionType,disposition_measures AS dispositionMeasures,penalty_amount AS penaltyAmount FROM bdo_spider.spider_violation_handling WHERE customerId={customerId};
other.CR000221=SELECT *,announcement_date AS announcementDate,report_year AS reportYear,performance_type_code AS performanceTypeCode,performance_type AS performanceType,performance_content AS performanceContent,performance_change AS performanceChange,profit_lower AS profitLower,profit_upper AS profitUpper FROM bdo_spider.spider_business_forecast WHERE customerId={customerId};
other.CR000222=SELECT *,pdf_url as pdfUrl,announcement_type AS announcementType,release_date AS releaseDate FROM bdo_spider.spider_announcement WHERE customerId={customerId} AND announcement_type='{announcementType}';
other.CR000223=SELECT *,pdf_url as pdfUrl,announcement_type AS announcementType,release_date AS releaseDate FROM bdo_spider.spider_announcement WHERE customerId={customerId} AND announcement_type!='{announcementType}';
other.CR000224=SELECT mergeType FROM bdo_dg.dg_projectext WHERE projectId={projectId} AND customerId={customerId};
other.CR000225=SELECT a.autoId,a.customerId,a.projectId,a.mergeCustomerId,a.mergeProjectId,a.mergeCustomerName,a.oneSubjectId,a.oneSubjectName,a.subjectFullName,a.merchantId,a.merchantName,a.merchantType,a.customerUscc,a.subjectId,a.remain,a.debitOcc,a.creditOcc,a.balance,a.badDebt,a.deferredTax,a.status, a.reason,a.ara07 as ara01, a.ara08 as ara02, a.ara09 as ara03,  a.ara10 as ara04,  a.ara11 as ara05, a.ara12 as ara06,a.debitAdjust,a.creditAdjust,a.direction,case when a.direction = 1 then IFNULL(a.balance,0) + IFNULL(a.debitAdjust,0) - IFNULL(a.creditAdjust,0) else IFNULL(a.balance,0) - IFNULL(a.debitAdjust,0) + IFNULL(a.creditAdjust,0) end as approvalBalance,(IFNULL(a.ara07,0) + IFNULL(a.ara08,0) +IFNULL(a.ara09,0) +IFNULL(a.ara10,0) +IFNULL(a.ara11,0) +IFNULL(a.ara12,0)) as araTotal FROM bdo_dg.dg_merchantdetail a WHERE a.customerId = {lockCustomerId} AND a.projectId = {lockProjectId} order by a.mergeCustomerName
########\u98CE\u9669\u8BC4\u4F30\u62A5\u544A-\u8D22\u52A1\u6570\u636E########
##\u51ED\u8BC1
#\u51ED\u8BC1\u5E73\u8861\u6027\u6821\u9A8C
other.CR100000=SELECT (debitocc = creditocc) AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM(debitocc+creditocc),0) AS checkPassNum FROM {lockDbName}.fin_subjectvoucher WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} GROUP BY (debitocc = creditocc)
#\u51ED\u8BC1\u79D1\u76EE\u91CD\u590D\u6821\u9A8C
#\u79D1\u76EE\u91CD\u590D\u7684\u51ED\u8BC1\u53F7
other.CR100001=SELECT GROUP_CONCAT(DISTINCT voucherId) AS voucherId FROM (SELECT voucherId,subjectId,COUNT(0) AS COUNTNUM FROM (SELECT voucherId,subjectId,direction FROM {lockDbName}.fin_subjectentry WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} GROUP BY voucherId,subjectId,direction) a GROUP BY voucherId,subjectId) a WHERE COUNTNUM > 1
other.CR100002=SELECT (oldVoucherId NOT IN ({voucherId})) AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM(debitocc+creditocc),0) AS checkPassNum FROM {lockDbName}.fin_subjectvoucher WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} GROUP BY oldVoucherId NOT IN ({voucherId})
#\u51ED\u8BC1\u501F\u8D37\u65B9\u96F6\u91D1\u989D\u6821\u9A8C
other.CR100003=SELECT (debitocc != 0 AND creditocc != 0) AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM(debitocc+creditocc),0) AS checkPassNum FROM {lockDbName}.fin_subjectvoucher WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} GROUP BY (debitocc != 0 AND creditocc != 0)
#\u51ED\u8BC1\u5F55\u5165\u65E5\u671F\u6821\u9A8C
other.CR100004=SELECT (b.TYPE IS NULL AND a.vchDate > '') AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM(debitocc+creditocc),0) AS checkPassNum FROM {lockDbName}.fin_subjectvoucher a LEFT JOIN bdo_base.base_holiday b ON b.holiday = a.vchDate WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} GROUP BY (b.TYPE IS NULL AND a.vchDate > '')
# \u51ED\u8BC1\u5236\u5355\u4EBA\u3001\u5BA1\u6838\u4EBA\u6821\u9A8C
other.CR100005=SELECT (IFNULL(voucherFillUser,'') != IFNULL(voucherAuditUser,'')) AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM(debitocc+creditocc),0) AS checkPassNum FROM {lockDbName}.fin_subjectvoucher WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} GROUP BY (IFNULL(voucherFillUser,'') != IFNULL(voucherAuditUser,''))
##\u4F59\u989D
#\u4F59\u989D\u8868\u548C\u5916\u5E01\u4F59\u989D\u8868\u671F\u521D\u6570\u6821\u9A8C
other.CR100006=SELECT (a.remain = a.remainF) AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM(remain),0) AS checkPassNum FROM (SELECT b.customerId,b.yyyy,b.subjectId,IFNULL(a.remain,0) AS remain,SUM(IFNULL(b.remainF,0)) AS remainF FROM {lockDbName}.fin_accountall b INNER JOIN {lockDbName}.fin_account a ON a.customerId = b.customerId AND a.yyyy = b.yyyy AND a.subjectId = b.subjectId AND a.isLeaf1 = 1 AND a.subMonth = 1 WHERE b.customerId = {lockCustomerId} AND b.yyyy = {lockYyyy} AND b.isLeaf1 = 1 AND b.subMonth = 1 GROUP BY b.customerId,b.yyyy,b.subjectId) a GROUP BY (a.remain = a.remainF)
#\u4F59\u989D\u8868\u548C\u5916\u5E01\u4F59\u989D\u8868\u671F\u672B\u6570\u6821\u9A8C
other.CR100007=SELECT (a.balance = a.balanceF) AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM(a.balance),0) AS checkPassNum FROM (SELECT b.customerId,b.yyyy,b.subjectId,IFNULL(a.balance,0) AS balance,SUM(IFNULL(b.balanceF,0)) AS balanceF FROM {lockDbName}.fin_accountall b INNER JOIN {lockDbName}.fin_account a ON a.customerId = b.customerId AND a.yyyy = b.yyyy AND a.subjectId = b.subjectId AND a.isLeaf1 = 1 AND a.subMonth = 12 WHERE b.customerId = {lockCustomerId} AND b.yyyy = {lockYyyy} AND b.isLeaf1 = 1 AND b.subMonth = 12 GROUP BY b.customerId,b.yyyy,b.subjectId) a GROUP BY (a.balance = a.balanceF)
#\u6838\u7B97\u4F59\u989D\u8868\u548C\u5916\u5E01\u6838\u7B97\u4F59\u989D\u8868\u671F\u521D\u6570\u6821\u9A8C
other.CR100008=SELECT (a.remain = a.remainF) AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM(remain),0) AS checkPassNum FROM (SELECT b.customerId,b.yyyy,b.subjectId,b.assItemId,IFNULL(a.remain,0) AS remain,SUM(IFNULL(b.remainF,0)) AS remainF FROM {lockDbName}.fin_assitementryaccall b INNER JOIN {lockDbName}.fin_assitementryacc a ON a.customerId = b.customerId AND a.yyyy = b.yyyy AND a.subjectId = b.subjectId AND a.assItemId = b.assItemId AND a.isLeaf1 = 1 AND a.subMonth = 1 WHERE b.customerId = {lockCustomerId} AND b.yyyy = {lockYyyy} AND b.isLeaf1 = 1 AND b.subMonth = 1 GROUP BY b.customerId,b.yyyy,b.subjectId,b.assItemId) a GROUP BY a.remain = a.remainF
#\u6838\u7B97\u4F59\u989D\u8868\u548C\u5916\u5E01\u6838\u7B97\u4F59\u989D\u8868\u671F\u672B\u6570\u6821\u9A8C
other.CR100009=SELECT (a.balance = a.balanceF) AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM(balance),0) AS checkPassNum FROM (SELECT b.customerId,b.yyyy,b.subjectId,b.assItemId,IFNULL(a.balance,0) AS balance,SUM(IFNULL(b.balanceF,0)) AS balanceF FROM {lockDbName}.fin_assitementryaccall b INNER JOIN {lockDbName}.fin_assitementryacc a ON a.customerId = b.customerId AND a.yyyy = b.yyyy AND a.subjectId = b.subjectId AND a.assItemId = b.assItemId AND a.isLeaf1 = 1 AND a.subMonth = 12 WHERE b.customerId = {lockCustomerId} AND b.yyyy = {lockYyyy} AND b.isLeaf1 = 1 AND b.subMonth = 12 GROUP BY b.customerId,b.yyyy,b.subjectId,b.assItemId) a GROUP BY a.balance = a.balanceF
#\u79D1\u76EE\u671F\u521D\u6570\u6821\u9A8C
other.CR100010=SELECT (a.remain = a.balance) AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM(a.remain),0) AS checkPassNum FROM (SELECT a.subjectId,a.remain,IFNULL(b.balance,0) AS balance FROM {lockDbName}.fin_account a LEFT JOIN {lockDbName}.fin_account b ON b.customerId = {lockCustomerId} AND b.yyyy = ({lockYyyy} - 1) AND b.subjectId = a.subjectId AND b.subMonth = 12 WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND a.subMonth = 1) a GROUP BY (a.remain = a.balance)
#\u6838\u7B97\u79D1\u76EE\u671F\u521D\u6570\u6821\u9A8C
other.CR100011=SELECT (a.remain = a.balance) AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM(a.remain),0) AS checkPassNum FROM (SELECT a.subjectId,a.remain,IFNULL(b.balance,0) AS balance FROM {lockDbName}.fin_assitementryacc a LEFT JOIN {lockDbName}.fin_assitementryacc b ON b.customerId = {lockCustomerId} AND b.yyyy = ({lockYyyy} - 1) AND b.subjectId = a.subjectId AND b.assItemId = a.assItemId AND b.subMonth = 12 WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND a.subMonth = 1) a GROUP BY (a.remain = a.balance)
#\u79D1\u76EE\u4F59\u989D\u548C\u53D1\u751F\u989D\u5E73\u8861\u6027\u6821\u9A8C
other.CR100012=SELECT (debitOcc=debitOccS AND creditOcc=creditOccS) AS checkResult,COUNT(0) AS checkPass,SUM(IF(a.isLeaf1=1,a.debitOccS,0)+IF(a.isLeaf1=1,a.creditOccS,0)) AS checkPassNum FROM (SELECT a.subjectId,a.debitOcc,a.creditOcc,SUM(IFNULL(b.debitOcc,0)) AS debitOccS,SUM(IFNULL(b.creditOcc,0)) AS creditOccS,a.isLeaf1 FROM (SELECT a.subjectId,b.subjectFullId,SUM(a.debitOcc) AS debitOcc,SUM(a.creditOcc) AS creditOcc,a.isLeaf1 FROM {lockDbName}.fin_account a INNER JOIN {lockDbName}.fin_accpkgsubject b ON b.customerId=a.customerId AND b.yyyy=a.yyyy AND b.subjectId=a.subjectId WHERE a.customerId={lockCustomerId} AND a.yyyy={lockYyyy} GROUP BY a.subjectId) a LEFT JOIN (SELECT a.subjectId,b.subjectFullId,SUM(IF (a.direction=1,occurValue,0)) AS debitOcc,SUM(IF (a.direction=-1,occurValue,0)) AS creditOcc FROM {lockDbName}.fin_subjectentry a INNER JOIN {lockDbName}.fin_accpkgsubject b ON b.customerId=a.customerId AND b.yyyy=a.yyyy AND b.subjectId=a.subjectId WHERE a.customerId={lockCustomerId} AND a.yyyy={lockYyyy} GROUP BY a.subjectId) b ON b.subjectFullId LIKE CONCAT(a.subjectFullId,'/%') OR a.subjectId=b.subjectId GROUP BY a.subjectId) a GROUP BY (debitOcc=debitOccS AND creditOcc=creditOccS)
#\u6838\u7B97\u9879\u548C\u79D1\u76EE\u4F59\u989D\u5E73\u8861\u6027\u6821\u9A8C
other.CR100013=SELECT (a.remain = a.remainS AND a.debitOcc = a.debitOccS AND a.creditOcc = a.creditOccS AND a.balance = a.balanceS) AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM(a.balance),0) AS checkPassNum FROM (SELECT a.customerId,a.yyyy,a.subjectId,a.subjectName,a.subjectFullName,a.remain,a.debitOcc,a.creditOcc,a.balance,b.remainS,b.debitOccS,b.creditOccS,b.balanceS FROM (SELECT a.customerId,a.yyyy,a.subjectId,a.subjectName,a.subjectFullName,SUM(CASE WHEN subMonth = 1 THEN a.remain ELSE 0 END) AS remain,SUM(a.debitOcc) AS debitOcc,SUM(a.creditOcc) AS creditOcc,SUM(CASE WHEN subMonth = 12 THEN a.balance ELSE 0 END) AS balance FROM {lockDbName}.fin_account a WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND a.isLeaf1 = 1 GROUP BY a.subjectId) a INNER JOIN (SELECT a.subjectId,SUM(CASE WHEN subMonth = 1 THEN a.remain ELSE 0 END) AS remainS,SUM(a.debitOcc) AS debitOccS,SUM(a.creditOcc) AS creditOccS,SUM(CASE WHEN subMonth = 12 THEN a.balance ELSE 0 END) AS balanceS FROM {lockDbName}.fin_assitementryacc a WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} AND a.isLeaf1 = 1 GROUP BY a.subjectId) b ON b.subjectId = a.subjectId) a GROUP BY (a.remain = a.remainS AND a.debitOcc = a.debitOccS AND a.creditOcc = a.creditOccS AND a.balance = a.balanceS)
#\u635F\u76CA\u662F\u5426\u7ED3\u8F6C\u6821\u9A8C
other.CR100014=SELECT '1' AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM(a.amount),0) AS checkPassNum FROM (SELECT a.subjectId,b.amount FROM {lockDbName}.fin_account a LEFT JOIN (SELECT subjectId,ABS(SUM(tranDebitOcc-tranCreditOcc)) AS amount FROM {lockDbName}.fin_account WHERE customerId={lockCustomerId} AND yyyy={lockYyyy} GROUP BY subjectId) b ON b.subjectId=a.subjectId WHERE customerId={lockCustomerId} AND yyyy={lockYyyy} AND subMonth=12 AND balance=0 AND LEFT (a.subjectId,1) IN (SELECT LEFT (subjectId,1) FROM {lockDbName}.fin_accpkgsubject WHERE customerId={lockCustomerId} AND yyyy={lockYyyy} AND subjectName IN ('\u4E3B\u8425\u4E1A\u52A1\u6536\u5165','\u8425\u4E1A\u6536\u5165'))) a UNION SELECT '0' AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM(ABS(amount)),0) AS checkPassNum FROM (SELECT subjectId,balance AS amount FROM {lockDbName}.fin_account WHERE customerId={lockCustomerId} AND yyyy={lockYyyy} AND subMonth=12 AND balance<> 0 AND LEFT (subjectId,1) IN (SELECT LEFT (subjectId,1) FROM {lockDbName}.fin_accpkgsubject WHERE customerId={lockCustomerId} AND yyyy={lockYyyy} AND subjectName IN ('\u4E3B\u8425\u4E1A\u52A1\u6536\u5165','\u8425\u4E1A\u6536\u5165'))) a
#\u4F59\u989D\u8868\u7EA7\u6B21\u6821\u9A8C
other.CR100015=SELECT (remain=remainS AND debitOcc=debitOccS AND creditOcc=creditOccS AND balance=balanceS) AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM((a.debitOcc+a.creditOcc)),0) AS checkPassNum FROM (SELECT a.subjectId,a.remain,a.debitOcc,a.creditOcc,a.balance,SUM(b.remain) AS remainS,SUM(b.debitOcc) AS debitOccS,SUM(b.creditOcc) AS creditOccS,SUM(b.balance) AS balanceS FROM (SELECT a.subjectId,b.subjectFullId,SUM(IF (a.subMonth=1,a.remain,0)) AS remain,SUM(a.debitOcc) AS debitOcc,SUM(a.creditOcc) AS creditOcc,SUM(IF (a.subMonth=12,a.balance,0)) AS balance FROM {lockDbName}.fin_account a INNER JOIN {lockDbName}.fin_accpkgsubject b ON b.customerId=a.customerId AND b.yyyy=a.yyyy AND b.subjectId=a.subjectId WHERE a.customerId={lockCustomerId} AND a.yyyy={lockYyyy} GROUP BY a.subjectId) a LEFT JOIN (SELECT a.subjectId,b.subjectFullId,SUM(IF (a.subMonth=1,a.remain,0)) AS remain,SUM(a.debitOcc) AS debitOcc,SUM(a.creditOcc) AS creditOcc,SUM(IF (a.subMonth=12,a.balance,0)) AS balance FROM {lockDbName}.fin_account a INNER JOIN {lockDbName}.fin_accpkgsubject b ON b.customerId=a.customerId AND b.yyyy=a.yyyy AND b.subjectId=a.subjectId WHERE a.customerId={lockCustomerId} AND a.yyyy={lockYyyy} AND a.isLeaf1='1' GROUP BY a.subjectId) b ON b.subjectFullId LIKE CONCAT(a.subjectFullId,'/%') OR a.subjectId=b.subjectId GROUP BY a.subjectId) a GROUP BY (remain=remainS AND debitOcc=debitOccS AND creditOcc=creditOccS AND balance=balanceS)
##\u5206\u5F55
#\u5206\u5F55\u79D1\u76EE\u7F16\u7801\u6821\u9A8C
other.CR100016=SELECT (subjectId > '') AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM(occurValue),0) AS checkPassNum FROM {lockDbName}.fin_subjectentry WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} GROUP BY (subjectId > '')
##\u51ED\u8BC1
#\u5236\u5355\u4EBA\u6821\u9A8C
other.CR100017=SELECT voucherFillUser > '' AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM(debitocc+creditocc),0) AS checkPassNum FROM {lockDbName}.fin_subjectvoucher WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} GROUP BY (voucherFillUser > '')
#\u51ED\u8BC1\u7C7B\u578B\u6821\u9A8C
other.CR100018=SELECT (typeId > '') AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM(debitocc+creditocc),0) AS checkPassNum FROM {lockDbName}.fin_subjectvoucher WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} GROUP BY (typeId > '')
#\u51ED\u8BC1\u7F16\u53F7\u6821\u9A8C
other.CR100019=SELECT (oldVoucherId > '' AND voucherId > '') AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM(debitocc+creditocc),0) AS checkPassNum FROM {lockDbName}.fin_subjectvoucher WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} GROUP BY (oldVoucherId > '' AND voucherId > '')
##\u5206\u5F55
#\u91D1\u989D\u8D1F\u6570\u6821\u9A8C
other.CR100020=SELECT (occurValue >= 0) AS checkResult,COUNT(0) AS checkPass,IFNULL(ABS(SUM(occurValue)),0) AS checkPassNum FROM {lockDbName}.fin_subjectentry WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} GROUP BY (occurValue >= 0)
#\u6458\u8981\u6821\u9A8C
other.CR100021=SELECT (summary NOT REGEXP '^(-) ?[1-9][0-9]*(.) [0-9]*$|(\u8F67\u5DEE) |(\u51B2\u62B5) |^[[:space:]]*$') AS checkResult,COUNT(0) AS checkPass,IFNULL(SUM(occurValue),0) AS checkPassNum FROM {lockDbName}.fin_subjectentry WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} GROUP BY (summary NOT REGEXP '^(-) ?[1-9][0-9]*(.) [0-9]*$|(\u8F67\u5DEE) |(\u51B2\u62B5) |^[[:space:]]*$')
##\u4F59\u989D
#\u6838\u7B97\u79D1\u76EE\u4F59\u989D\u6821\u9A8C
other.CR100022=SELECT (a.balance >= 0) AS checkResult,COUNT(0) AS checkPass,IFNULL(ABS(SUM(a.balance)),0) AS checkPassNum FROM (SELECT customerId,yyyy,subjectId,SUM(balance) AS balance FROM {lockDbName}.fin_assitementryacc WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} AND subMonth = 12 AND isLeaf1 = 1 GROUP BY customerId,yyyy,subjectId) a GROUP BY (a.balance >= 0)
########\u98CE\u9669\u8BC4\u4F30\u62A5\u544A-\u8D22\u52A1\u6570\u636E########
########\u98CE\u9669\u8BC4\u4F30\u62A5\u544A-sacp########
#\u5206\u5F55\u6458\u8981\u6821\u9A8C
other.CR200001=SELECT classCode AS industryCode,className AS industryName,parentClassCode AS parentCode,classLevel AS industryLevel FROM bdo_wind.wind_defindustry
#\u6838\u7B97\u79D1\u76EE\u4F59\u989D\u6821\u9A8C
other.CR200002=SELECT customerId,projectId,year AS yyyy,customerName,projectName FROM bdo_dg.dg_project WHERE customerId = {customerId} AND projectId = {projectId}
#\u83B7\u53D6\u4E07\u5F97\u62A5\u8868 \u5229\u6DA6\u8868
other.CR200003=SELECT a.companyId AS customerId,a.reportDate,pCol1,pCol2,pCol3,pCol4,pCol5,pCol6,pCol7,pCol8,pCol9,pCol10,pCol11,pCol12,pCol13,pCol14,pCol15,pCol16,pCol17,pCol18,pCol19,pCol20,pCol21,pCol22,pCol23,pCol24,pCol25,pCol26,pCol27,pCol28,pCol29,pCol30,pCol31,pCol32,pCol33,pCol34,pCol35,pCol36,pCol37,pCol38,pCol39,pCol40,pCol41,pCol42,pCol43,pCol44,pCol45,pCol46,pCol47,pCol48,pCol49,pCol50,pCol51,pCol52,pCol53,pCol54,pCol55,pCol56,pCol57,pCol58,pCol59,pCol60,pCol61,pCol62,pCol63,pCol64,pCol65,pCol66,pCol67,pCol68,pCol69,pCol70,pCol71,pCol72,pCol73,pCol74,pCol75 FROM bdo_wind.wind_table_info a LEFT JOIN bdo_wind.wind_profit_statement b ON b.tableId=a.tableId WHERE a.companyId IN ({customerId}) AND a.reportDate IN ({reportDate}) AND a.reportType=1 AND a.monoOrMerge={monoOrMerge}
#\u83B7\u53D6\u4E07\u5F97\u62A5\u8868 \u8D44\u4EA7\u8D1F\u503A\u8868
other.CR200004=SELECT a.companyId AS customerId,a.reportDate,bCol1,bCol2,bCol3,bCol4,bCol5,bCol6,bCol7,bCol8,bCol9,bCol10,bCol11,bCol12,bCol13,bCol14,bCol15,bCol16,bCol17,bCol18,bCol19,bCol20,bCol21,bCol22,bCol23,bCol24,bCol25,bCol26,bCol27,bCol28,bCol29,bCol30,bCol31,bCol32,bCol33,bCol34,bCol35,bCol36,bCol37,bCol38,bCol39,bCol40,bCol41,bCol42,bCol43,bCol44,bCol45,bCol46,bCol47,bCol48,bCol49,bCol50,bCol51,bCol52,bCol53,bCol54,bCol55,bCol56,bCol57,bCol58,bCol59,bCol60,bCol61,bCol62,bCol63,bCol64,bCol65,bCol66,bCol67,bCol68,bCol69,bCol70,bCol71,bCol72,bCol73,bCol74,bCol75,bCol76,bCol77,bCol78,bCol79,bCol80,bCol81,bCol82,bCol83,bCol84,bCol85,bCol86,bCol87,bCol88,bCol89,bCol90,bCol91,bCol92,bCol93,bCol94,bCol95,bCol96,bCol97,bCol98,bCol99,bCol100,bCol101,bCol102,bCol103,bCol104,bCol105,bCol106,bCol107,bCol108,bCol109,bCol110,bCol111,bCol112,bCol113,bCol114,bCol115,bCol116,bCol117,bCol118,bCol119,bCol120,bCol121,bCol122,bCol123,bCol124,bCol125,bCol126,bCol127,bCol128,bCol129,bCol130,bCol131,bCol132,bCol133,bCol134,bCol135,bCol136,bCol137,bCol138,bCol139,bCol140,bCol141,bCol142,bCol143,bCol144,bCol145,bCol146,bCol147,bCol148,bCol149,bCol150,bCol151,bCol152,bCol153,bCol154,bCol155,bCol156,bCol157,bCol158,bCol159,bCol160,bCol161,bCol162,bCol163,bCol164,bCol165,bCol166,bCol167,bCol168,bCol169,bCol170,bCol171,bCol172,bCol173,bCol174,bCol175 FROM bdo_wind.wind_table_info a LEFT JOIN bdo_wind.wind_balance_sheet b ON b.tableId = a.tableId WHERE a.companyId IN ({customerId}) AND a.reportDate IN ({reportDate}) AND a.reportType = 2 AND a.monoOrMerge={monoOrMerge}
#\u83B7\u53D6\u4E07\u5F97\u62A5\u8868 \u73B0\u91D1\u6D41\u91CF\u8868
other.CR200005=SELECT a.companyId AS customerId,a.reportDate,cCol1,cCol2,cCol3,cCol4,cCol5,cCol6,cCol7,cCol8,cCol9,cCol10,cCol11,cCol12,cCol13,cCol14,cCol15,cCol16,cCol17,cCol18,cCol19,cCol20,cCol21,cCol22,cCol23,cCol24,cCol25,cCol26,cCol27,cCol28,cCol29,cCol30,cCol31,cCol32,cCol33,cCol34,cCol35,cCol36,cCol37,cCol38,cCol39,cCol40,cCol41,cCol42,cCol43,cCol44,cCol45,cCol46,cCol47,cCol48,cCol49,cCol50,cCol51,cCol52,cCol53,cCol54,cCol55,cCol56,cCol57,cCol58,cCol59,cCol60,cCol61,cCol62,cCol63,cCol64,cCol65,cCol66,cCol67,cCol68,cCol69,cCol70,cCol71,cCol72,cCol73,cCol74,cCol75,cCol76,cCol77,cCol78,cCol79,cCol80,cCol81,cCol82,cCol83,cCol84,cCol85,cCol86,cCol87,cCol88,cCol89,cCol90,cCol91,cCol92,cCol93,cCol94,cCol95,cCol96,cCol97,cCol98,cCol99,cCol100,cCol101,cCol102,cCol103,cCol104,cCol105,cCol106,cCol107,cCol108,cCol109,cCol110,cCol111,cCol112,cCol113,cCol114,cCol115,cCol116 FROM bdo_wind.wind_table_info a LEFT JOIN bdo_wind.wind_cash_flow_statement b ON b.tableId = a.tableId WHERE a.companyId IN ({customerId}) AND reportDate IN ({reportDate}) AND reportType = 3 AND a.monoOrMerge={monoOrMerge}
#\u67E5\u627E\u4E07\u5F97id
other.CR200006=SELECT companyid FROM bdo_wind.wind_company_general WHERE stock_code = '{stockCode}' AND ACTIVE_FLAG = '1' LIMIT 1
#\u67E5\u627Ewind\u80A1\u672C\u80A1\u4EF7\u8BA1\u7B97\u5E02\u503C
other.CR200007=SELECT b.reportDate,ROUND(b.iCol1*b.iCol2,4) AS marketcap FROM bdo_wind.wind_company_general a LEFT JOIN bdo_wind.wind_company_info b ON b.companyId = a.companyid WHERE a.ACTIVE_FLAG = '1' AND a.stock_code = '{stockCode}'
#\u67E5\u627E\u73B0\u91D1\u6D41\u91CF\u8868\u76F8\u540C\u7C7B\u578B\u516C\u53F8
other.CR200008=SELECT a.companyId,c.company_name AS companyName,c.stock_code AS stockCode,a.reportDate,ROUND(cCol36,2) AS operateAmount,ROUND(cCol56,2) AS investmentAmount,ROUND(cCol75,2) AS fundraiseAmount FROM bdo_wind.wind_table_info a LEFT JOIN bdo_wind.wind_cash_flow_statement b ON b.tableId = a.tableId INNER JOIN bdo_wind.wind_company_general c ON c.companyid = a.companyId AND c.ACTIVE_FLAG = '1' INNER JOIN bdo_wind.wind_company_industry d ON d.companyId = a.companyId AND d.reportDate = a.reportDate AND d.secondClassZJH = '{industryCode}' WHERE a.reportType = 3 AND a.reportDate = '{reportDate}' AND b.cCol36 {jyhd} AND b.cCol56 {tzhd} AND b.cCol75 {czhd} ORDER BY c.stock_code
#\u67E5\u627Edg_projectext\u9608\u503C
other.CR200009=SELECT ROUND(assetsValue * 100,2) AS assetsValue,ROUND(profitsValue * 100,2) AS profitsValue,ROUND(changeThreshold * 100,2) AS changeThreshold FROM bdo_dg.dg_projectext WHERE customerId = {customerId} AND projectId = {projectId}
#\u67E5\u8BE2\u516C\u53F8\u6700\u591A10\u4E2A
other.CR200010=SELECT companyid AS value,CONCAT(company_name,'(',windcode,')') AS label FROM bdo_wind.wind_company_general WHERE ACTIVE_FLAG = '1' /*START #searchKey# AND (company_name LIKE '%{searchKey}%' OR windcode LIKE '%{searchKey}%') #searchKey# END*/ ORDER BY stock_code LIMIT 10
other.CR200011=SELECT * FROM bdo_wind.wind_balance WHERE reportDate = '{reportDate}' AND companyId IN ({companyId}) AND columnCode IN ({columnCode});
other.CR200012=SELECT * FROM bdo_wind.wind_profit WHERE reportDate = '{reportDate}' AND companyId IN ({companyId}) AND columnCode IN ({columnCode});
other.CR200013=SELECT * FROM bdo_wind.wind_cashflow WHERE reportDate = '{reportDate}' AND companyId IN ({companyId}) AND columnCode IN ({columnCode});
other.CR200014=SELECT * FROM bdo_wind.wind_quota WHERE periodStandard = '{periodStandard}' AND reportDate = '{reportDate}' AND companyId IN ({companyId});
other.CR200015=SELECT a.companyid AS VALUE,CONCAT(a.company_name,'(',a.windcode,')') AS label,b.stock_palte AS industryPalte,a.areaRegion AS industryRegion,a.areaPlace AS industryArea,c.className AS industryName FROM bdo_wind.wind_company_general a LEFT JOIN bdo_wind.wind_company_industry b ON a.companyid=b.companyId LEFT JOIN bdo_wind.wind_defindustry c ON b.{industryType}=c.classCode WHERE a.ACTIVE_FLAG='1'/*START #searchKey# AND (company_name LIKE '%{searchKey}%' OR windcode LIKE '%{searchKey}%') #searchKey# END*/ GROUP BY b.companyId;
########\u98CE\u9669\u8BC4\u4F30\u62A5\u544A-sacp########
########\u98CE\u9669\u8BC4\u4F30\u62A5\u544A-\u5220\u9664########
#\u5220\u9664\u8D22\u52A1\u8D26\u5957\u6821\u9A8C\u7ED3\u679C
other.CRD00001=DELETE FROM bdo_risk.risk_datacheck WHERE riskId = {riskId}
#\u5220\u9664\u8D22\u52A1\u62A5\u8868
other.CRD00002=DELETE FROM bdo_risk.risk_statement WHERE riskId = {riskId}
#\u5220\u9664\u8D22\u52A1\u6307\u6807
other.CRD00003=DELETE FROM bdo_risk.risk_quota WHERE riskId = {riskId}
#\u5220\u9664\u8D22\u52A1\u6307\u6807
other.CRD00004=DELETE FROM bdo_risk.risk_quota WHERE riskId = {riskId} AND quotaType IN ({quotaType})
########\u98CE\u9669\u8BC4\u4F30\u62A5\u544A-\u5220\u9664########
#############################\u98CE\u9669\u8BC4\u4F30\u62A5\u544A#############################


####\u67E5\u8BE2\u5BA2\u6237\u9879\u76EE\u4E0B\u62C9\u6846####
#\u5728\u5BA2\u6237\u7CFB\u7EDF\u4E2D\u8FC7\u6EE4\u5B58\u5728\u7684\u5BA2\u6237
other.CUPJ00001=SELECT DISTINCT a.customerId FROM bdo_cus.cus_customerinfo_basic a WHERE a.customerId IN ({customerId}) ORDER BY a.customerId DESC
#\u9879\u76EE\u7CFB\u7EDF \u9879\u76EE\u8D1F\u8D23\u4EBA\u6743\u9650
other.CUPJ00002=SELECT DISTINCT 1 AS isManager,'SACP' AS systemId,pj.ProjectID AS projectId,CONCAT('[\u5BA1]',pj.ProjectName) AS projectName,cus.restCustomerId AS customerId,CONCAT('[\u5BA1]',cus.customerName) AS customerName,dp1.hrDeptCode AS departId,dp2.hrDeptCode AS officeId,NOW() AS lastUpdateTime FROM asdb.z_project pj INNER JOIN asdb.z_projectext ext ON ext.projectid=pj.ProjectID INNER JOIN bdo_cus.cus_customerinfo cus ON cus.customerId=pj.CustomerId INNER JOIN asdb.z_projectpeople pjp ON pjp.projectId=pj.ProjectID INNER JOIN bdo_base.base_user u ON u.id=pjp.managerId INNER JOIN bdo_base.base_department dp1 ON dp1.autoid=pj.departmentid INNER JOIN bdo_base.base_department dp2 ON dp2.autoid=dp1.firstItemId WHERE pj.isClose=0 AND ext.s61=1 AND cus.restCustomerId IS NOT NULL AND u.hrLoginId='{hrLoginId}' GROUP BY pj.ProjectID ORDER BY pj.ProjectID DESC
#\u9879\u76EE\u7CFB\u7EDF \u7EC4\u5458\u6743\u9650
other.CUPJ00003=SELECT DISTINCT SUM(isManager)>0 AS isManager,'SACP' AS systemId,pj.ProjectID AS projectId,CONCAT('[\u5BA1]',pj.ProjectName) AS projectName,cus.restCustomerId AS customerId,CONCAT('[\u5BA1]',cus.customerName) AS customerName,dp1.hrDeptCode AS departId,dp2.hrDeptCode AS officeId,NOW() AS lastUpdateTime FROM (SELECT f.id,e.projectId,1 AS isManager FROM bdo_base.base_user f LEFT JOIN asdb.z_projectpeople e ON f.id=e.managerid WHERE f.hrLoginId='{hrLoginId}' UNION SELECT f.id,e.projectId,0 AS isManager FROM bdo_base.base_user f LEFT JOIN asdb.z_projectpeople e ON f.id IN (e.signUser,e.signUser1,e.signUser2,e.signUser3,e.audit1,e.audit2,e.audit3,e.audit4,e.audit5,e.qfUser,e.gongshi1,e.gongshi2) WHERE f.hrLoginId='{hrLoginId}' UNION SELECT f.id,c.projectId,0 AS isManager FROM bdo_base.base_user f LEFT JOIN asdb.z_projectmember c ON f.id=c.memberId WHERE f.hrLoginId='{hrLoginId}') f LEFT JOIN asdb.z_project pj ON pj.projectId=f.projectId LEFT JOIN asdb.z_projectext pext ON pext.projectId=f.projectId LEFT JOIN bdo_cus.cus_customerinfo cus ON cus.customerId=pj.customerId LEFT JOIN bdo_base.base_department dp1 ON dp1.autoid=pj.departmentid LEFT JOIN bdo_base.base_department dp2 ON dp2.autoid=dp1.firstItemId WHERE 1=1 AND pj.isClose=0 AND pext.s61=1 AND cus.restCustomerId IS NOT NULL GROUP BY pj.projectId ORDER BY pj.projectId DESC
#\u7A0E\u52A1\u7CFB\u7EDF \u9879\u76EE\u8D1F\u8D23\u4EBA\u6743\u9650
other.CUPJ00004=SELECT DISTINCT 1 AS isManager,'TCP' AS systemId,pj.ProjectID AS projectId,CONCAT('[\u7A0E]',pj.ProjectName) AS projectName,cus.restCustomerId AS customerId,CONCAT('[\u7A0E]',cus.customerName) AS customerName,dp1.hrDeptCode AS departId,dp2.hrDeptCode AS officeId,NOW() AS lastUpdateTime FROM asdb.z_project pj INNER JOIN asdb.z_projectext ext ON ext.projectid=pj.ProjectID INNER JOIN bdo_cus.cus_customerinfo cus ON cus.customerId=pj.CustomerId INNER JOIN asdb.z_projectpeople pjp ON pjp.projectId=pj.ProjectID INNER JOIN bdo_base.base_user u ON u.id=pjp.managerId INNER JOIN bdo_base.base_department dp1 ON dp1.autoid=pj.departmentid INNER JOIN bdo_base.base_department dp2 ON dp2.autoid=dp1.firstItemId WHERE 1 = 1 AND pj.isClose=0 AND ext.s61=1 AND cus.restCustomerId IS NOT NULL AND u.hrLoginId='{hrLoginId}' GROUP BY pj.ProjectID ORDER BY pj.ProjectID DESC
#\u7A0E\u52A1\u7CFB\u7EDF \u7EC4\u5458\u6743\u9650
other.CUPJ00005=SELECT DISTINCT SUM(isManager)>0 AS isManager,'TCP' AS systemId,pj.ProjectID AS projectId,CONCAT('[\u7A0E]',pj.ProjectName) AS projectName,cus.restCustomerId AS customerId,CONCAT('[\u7A0E]',cus.customerName) AS customerName,dp1.hrDeptCode AS departId,dp2.hrDeptCode AS officeId,NOW() AS lastUpdateTime FROM (SELECT f.id,e.projectId,1 AS isManager FROM bdo_base.base_user f LEFT JOIN asdb.z_projectpeople e ON f.id=e.managerid WHERE f.hrLoginId='{hrLoginId}' UNION SELECT f.id,e.projectId,0 AS isManager FROM bdo_base.base_user f LEFT JOIN asdb.z_projectpeople e ON f.id IN (e.signUser,e.signUser1,e.signUser2,e.signUser3,e.audit1,e.audit2,e.audit3,e.audit4,e.audit5,e.qfUser,e.gongshi1,e.gongshi2) WHERE f.hrLoginId='{hrLoginId}' UNION SELECT f.id,c.projectId,0 AS isManager FROM bdo_base.base_user f LEFT JOIN asdb.z_projectmember c ON f.id=c.memberId WHERE f.hrLoginId='{hrLoginId}' UNION SELECT f.id,a.projectId,0 AS isManager FROM bdo_base.base_user f INNER JOIN asdb.z_projectbookundertake c ON c.auditPeople = f.id INNER JOIN asdb.z_projectbusiness b ON b.registerNum = c.registernum INNER JOIN asdb.z_project a ON a.ProjectID = b.projectID WHERE f.hrLoginId = '{hrLoginId}') f LEFT JOIN asdb.z_project pj ON pj.projectId=f.projectId LEFT JOIN asdb.z_projectext pext ON pext.projectId=f.projectId LEFT JOIN bdo_cus.cus_customerinfo cus ON cus.customerId=pj.customerId LEFT JOIN bdo_base.base_department dp1 ON dp1.autoid=pj.departmentid LEFT JOIN bdo_base.base_department dp2 ON dp2.autoid=dp1.firstItemId WHERE 1=1 AND pj.isClose=0 AND pext.s61=1 AND cus.restCustomerId IS NOT NULL GROUP BY pj.projectId ORDER BY pj.projectId DESC
#\u5BA1\u8BA1\u5E73\u53F0 \u4E34\u65F6\u5BA2\u6237\u521B\u5EFA\u4EBA
other.CUPJ00006=SELECT DISTINCT 1 AS isManager,a.userCustomerId AS customerId,CONCAT('[\u4E34]',a.userCustomerName) AS customerName,a.userCustomerId AS projectId,CONCAT('[\u4E34]',a.userCustomerName) AS projectName,NOW() AS lastUpdateTime FROM bdo_fin.fin_usercustomer a WHERE a.userId={userId} GROUP BY a.userCustomerId ORDER BY a.userCustomerId
#\u5BA1\u8BA1\u5E73\u53F0 \u4E34\u65F6\u5BA2\u6237\u7EC4\u5458
other.CUPJ00007=SELECT DISTINCT SUM(a.isManager)> 0 AS isManager,a.customerId,CONCAT('[\u4E34]',a.customerName) AS customerName,a.customerId AS projectId,CONCAT('[\u4E34]',a.customerName) AS projectName,NOW() AS lastUpdateTime FROM ((SELECT 1 AS isManager,a.userCustomerId AS customerId,a.userCustomerName AS customerName FROM bdo_fin.fin_usercustomer a WHERE a.userId={userId}) UNION (SELECT 0 AS isManager,a.userCustomerId AS customerId,a.userCustomerName AS customerName FROM bdo_fin.fin_usercustomer a LEFT JOIN bdo_fin.fin_usercustomerauth b ON b.userCustomerId=a.userCustomerId WHERE b.userId={userId})) a GROUP BY a.customerId ORDER BY a.customerId
####\u67E5\u8BE2\u5BA2\u6237\u9879\u76EE\u4E0B\u62C9\u6846####

####\u8D22\u52A1\u8D26\u5957\u5408\u5E76####
#\u4FDD\u5B58\u5BA2\u6237\u79D1\u76EE
other.MC000001=INSERT INTO {lockDbName}.fin_mergesubject (customerId,yyyy,subjectId,parentSubjectId,subjectFullId,subjectName,direction,currency,isLeaf1,level1,subjectFullName,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) select {newCustomerId},yyyy,subjectId,parentSubjectId,subjectFullId,subjectName,direction,currency,isLeaf1,level1,subjectFullName,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY from {lockDbName}.fin_mergesubject where customerId = {customerId} and yyyy = {yyyy}
#\u4FDD\u5B58\u5BA2\u6237\u6838\u7B97
other.MC000002=INSERT INTO {lockDbName}.fin_mergeassitem (customerId,yyyy,assItemId,parentAssItemId,assItemFullId,assItemName,isLeaf1,level1,assTotalName,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY) select {newCustomerId},yyyy,assItemId,parentAssItemId,assItemFullId,assItemName,isLeaf1,level1,assTotalName,CREATION_DATE,CREATED_BY,LAST_UPDATE_DATE,LAST_UPDATED_BY from {lockDbName}.fin_mergeassitem where customerId = {customerId} and yyyy = {yyyy}
#\u5EFA\u5E93
other.MC000003=CREATE DATABASE IF NOT EXISTS {lockDbName} CHARACTER SET 'utf8' COLLATE 'utf8_general_ci'
#\u5EFA\u8868
other.MC000004=CREATE TABLE IF NOT EXISTS {lockDbName}.fin_mergesubject(autoId int(10) NOT NULL AUTO_INCREMENT COMMENT '\u81EA\u589EID',customerId int(10) NOT NULL DEFAULT '0' COMMENT '\u5BA2\u6237ID',yyyy int(10) NOT NULL DEFAULT '0' COMMENT '\u5E74',subjectId varchar(50) NOT NULL COMMENT '\u79D1\u76EE\u7F16\u53F7',parentSubjectId varchar(50) DEFAULT NULL COMMENT '\u79D1\u76EE\u7F16\u53F7',subjectFullId varchar(200) DEFAULT '' COMMENT '\u79D1\u76EE\u7F16\u53F7\u5168\u8DEF\u5F84',subjectName varchar(500) DEFAULT '' COMMENT '\u79D1\u76EE\u540D\u79F0',direction int(2) DEFAULT '0' COMMENT '\u501F\u8D37\u65B9\u5411',currency varchar(30) DEFAULT '' COMMENT '\u5E01\u79CD',isLeaf1 int(1) DEFAULT NULL COMMENT '\u662F\u5426\u672B\u7EA7\u79D1\u76EE',level1 int(1) DEFAULT '1' COMMENT '\u79D1\u76EE\u7EA7\u522B',subjectFullName varchar(800) DEFAULT NULL COMMENT '\u79D1\u76EE\u540D\u79F0\u5168\u8DEF\u5F84',s1 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s2 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s3 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s4 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s5 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s6 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s7 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s8 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s9 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s10 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s11 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s12 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s13 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s14 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s15 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s16 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s17 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s18 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s19 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s20 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s21 text COMMENT '\u5907\u7528\u5B57\u6BB5',s22 text COMMENT '\u5907\u7528\u5B57\u6BB5',s23 text COMMENT '\u5907\u7528\u5B57\u6BB5',s24 text COMMENT '\u5907\u7528\u5B57\u6BB5',s25 text COMMENT '\u5907\u7528\u5B57\u6BB5',CREATION_DATE datetime DEFAULT NULL COMMENT '\u521B\u5EFA\u65E5',CREATED_BY varchar(20) DEFAULT NULL COMMENT '\u521B\u5EFA\u4EBAID',LAST_UPDATE_DATE datetime DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u65E5',LAST_UPDATED_BY varchar(20) DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u4EBAID',ABOLITION_DATE datetime DEFAULT NULL COMMENT '\u5220\u9664\u65E5',ABOLISHED_BY varchar(20) DEFAULT NULL COMMENT '\u5220\u9664\u4EBAID',PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL COMMENT '\u4ECE\u54EA\u4E2A\u7CFB\u7EDF\u64CD\u4F5C\u7684\u6570\u636E',PROGRAM_ID varchar(20) DEFAULT NULL COMMENT '\u54EA\u4E2A\u7A0B\u5E8F\u64CD\u4F5C\u7684\u6570\u636E',ACTIVE_FLAG varchar(1) DEFAULT '1' COMMENT '0:\u65E0\u6548\u6570\u636E\uFF1B1\uFF1A\u6709\u6548\u6570\u636E',PRIMARY KEY (autoId),UNIQUE KEY UniqueKey (customerId,yyyy,subjectId) USING BTREE COMMENT '\u552F\u4E00key') ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u79D1\u76EE\u5BF9\u7167\u8868'
#\u5EFA\u8868
other.MC000005=CREATE TABLE IF NOT EXISTS {lockDbName}.fin_mergeassitem(autoId int(10) NOT NULL AUTO_INCREMENT COMMENT '\u81EA\u589EID',customerId int(10) NOT NULL DEFAULT '0' COMMENT '\u5BA2\u6237ID',yyyy int(10) NOT NULL DEFAULT '0' COMMENT '\u5E74',assItemId varchar(100) NOT NULL COMMENT '\u6838\u7B97\u7F16\u53F7',assItemName varchar(500) DEFAULT '' COMMENT '\u6838\u7B97\u9879\u540D',parentAssItemId varchar(100) DEFAULT NULL COMMENT '\u4E0A\u7EA7\u6838\u7B97\u9879\u7F16\u53F7',assItemFullId varchar(200) DEFAULT '' COMMENT '\u6838\u7B97\u7F16\u53F7\u5168\u8DEF\u5F84',assTotalName varchar(800) DEFAULT NULL COMMENT '\u6838\u7B97\u9879\u5168\u79F0',isLeaf1 int(1) DEFAULT '0' COMMENT '\u662F\u5426\u672B\u7EA7\u6838\u7B97',level1 int(1) DEFAULT '0' COMMENT '\u6838\u7B97\u7EA7\u522B',s1 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s2 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s3 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s4 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s5 varchar(500) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s6 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s7 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s8 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s9 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s10 int(10) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s11 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s12 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s13 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s14 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s15 decimal(30,4) DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s16 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s17 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s18 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s19 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s20 datetime DEFAULT NULL COMMENT '\u5907\u7528\u5B57\u6BB5',s21 text COMMENT '\u5907\u7528\u5B57\u6BB5',s22 text COMMENT '\u5907\u7528\u5B57\u6BB5',s23 text COMMENT '\u5907\u7528\u5B57\u6BB5',s24 text COMMENT '\u5907\u7528\u5B57\u6BB5',s25 text COMMENT '\u5907\u7528\u5B57\u6BB5',CREATION_DATE datetime DEFAULT NULL COMMENT '\u521B\u5EFA\u65E5',CREATED_BY varchar(20) DEFAULT NULL COMMENT '\u521B\u5EFA\u4EBAID',LAST_UPDATE_DATE datetime DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u65E5',LAST_UPDATED_BY varchar(20) DEFAULT NULL COMMENT '\u6700\u540E\u66F4\u65B0\u4EBAID',ABOLITION_DATE datetime DEFAULT NULL COMMENT '\u5220\u9664\u65E5',ABOLISHED_BY varchar(20) DEFAULT NULL COMMENT '\u5220\u9664\u4EBAID',PROGRAM_APPLICATION_ID varchar(20) DEFAULT NULL COMMENT '\u4ECE\u54EA\u4E2A\u7CFB\u7EDF\u64CD\u4F5C\u7684\u6570\u636E',PROGRAM_ID varchar(20) DEFAULT NULL COMMENT '\u54EA\u4E2A\u7A0B\u5E8F\u64CD\u4F5C\u7684\u6570\u636E',ACTIVE_FLAG varchar(1) DEFAULT '1' COMMENT '0:\u65E0\u6548\u6570\u636E\uFF1B1\uFF1A\u6709\u6548\u6570\u636E',PRIMARY KEY (autoId),UNIQUE KEY UniqueKey (customerId,yyyy,assItemId) USING BTREE COMMENT '\u552F\u4E00key') ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u6838\u7B97\u5BF9\u7167\u8868'

#\u66F4\u65B0\u5BA2\u6237\u79D1\u76EE\u5BF9\u7167
other.MU000001=UPDATE {lockDbName}.fin_mergesubject a inner join {lockDbName}.fin_mergesubject b on a.yyyy = b.yyyy and a.subjectId = b.subjectId and a.isLeaf1 = b.isLeaf1 and b.customerId = {newCustomerId} and b.yyyy = {yyyy} set a.s1 = b.subjectId,a.s6 = b.autoId where a.yyyy = {yyyy} /*START #customerId# and a.customerId = {customerId} #customerId# END*/
#\u66F4\u65B0\u5BA2\u6237\u79D1\u76EE\u5C42\u7EA7
other.MU000002=update {lockDbName}.fin_mergesubject a inner join {lockDbName}.fin_mergesubject b on a.customerId = b.customerId and a.yyyy = b.yyyy and a.subjectId = b.parentSubjectId set a.isLeaf1 = 0 where a.customerId = {newCustomerId} and a.yyyy = {yyyy}
#\u66F4\u65B0\u5BA2\u6237\u6838\u7B97\u5BF9\u7167
other.MU000003=UPDATE {lockDbName}.fin_mergeassitem a inner join {lockDbName}.fin_mergeassitem b on a.yyyy = b.yyyy and a.assItemId = b.assItemId and a.isLeaf1 = b.isLeaf1 and b.customerId = {newCustomerId} and b.yyyy = {yyyy} set a.s1 = b.assItemId,a.s6 = b.autoId where a.yyyy = {yyyy} /*START #customerId# and a.customerId = {customerId} #customerId# END*/
#\u66F4\u65B0\u5BA2\u6237\u6838\u7B97\u5C42\u7EA7
other.MU000004=update {lockDbName}.fin_mergeassitem a inner join {lockDbName}.fin_mergeassitem b on a.customerId = b.customerId and a.yyyy = b.yyyy and a.assItemId = b.parentAssItemId set a.isLeaf1 = 0 where a.customerId = {newCustomerId} and a.yyyy = {yyyy}
#\u66F4\u65B0\u5BA2\u6237\u79D1\u76EE\u5C42\u7EA7
other.MU000005=update {lockDbName}.fin_mergesubject a inner join {lockDbName}.fin_mergesubject b on a.customerId = b.customerId and a.yyyy = b.yyyy and a.parentSubjectId = b.subjectId and b.level1 > 0 set a.level1 = b.level1 + 1 where a.customerId = {newCustomerId} and a.yyyy = {yyyy}
#\u66F4\u65B0\u5BA2\u6237\u6838\u7B97\u5C42\u7EA7
other.MU000006=update {lockDbName}.fin_mergeassitem a inner join {lockDbName}.fin_mergeassitem b on a.customerId = b.customerId and a.yyyy = b.yyyy and a.parentAssItemId = b.assItemId and b.level1 > 0 set a.level1 = b.level1 + 1 where a.customerId = {newCustomerId} and a.yyyy = {yyyy}

#\u5220\u9664\u5BA2\u6237\u79D1\u76EE\u5BF9\u7167
other.MD000001=DELETE FROM {lockDbName}.fin_mergesubject where customerId = {newCustomerId} and yyyy = {yyyy}
#\u5220\u9664\u5BA2\u6237\u6838\u7B97\u5BF9\u7167
other.MD000002=DELETE FROM {lockDbName}.fin_mergeassitem where customerId = {newCustomerId} and yyyy = {yyyy}
#\u5220\u9664\u5BA2\u6237\u79D1\u76EE\u5BF9\u7167
other.MD000003=TRUNCATE TABLE {lockDbName}.fin_mergesubject
#\u5220\u9664\u5BA2\u6237\u6838\u7B97\u5BF9\u7167
other.MD000004=TRUNCATE TABLE {lockDbName}.fin_mergeassitem

#\u67E5\u8BE2\u5BA2\u6237\u79D1\u76EE\u5BF9\u7167
other.MS000001=select a.autoId,a.customerId,a.yyyy,a.subjectId,a.subjectName,a.subjectFullId,a.subjectFullName,a.parentSubjectId,a.direction,a.level1,a.isLeaf1 {customerColumn} FROM {lockDbName}.fin_mergesubject a {customerJoin} where a.customerId = {newCustomerId} and a.yyyy = {yyyy} group by a.autoId order by a.subjectId,CASE WHEN a.isLeaf1 = 1 and a.level1 > 1 THEN a.parentSubjectId ELSE a.subjectId END
#\u67E5\u8BE2\u5BA2\u6237\u79D1\u76EE\u5BF9\u7167
other.MS000002=select a.autoId,a.customerId,a.yyyy,a.subjectId,a.subjectName,a.subjectFullId,a.subjectFullName,a.parentSubjectId,a.direction,case when a.direction = '1' then '\u501F' else '\u8D37' end as directionName,a.level1,a.isLeaf1 FROM {lockDbName}.fin_mergesubject a where a.customerId = {customerId} and a.yyyy = {yyyy} /*START #param1# and a.s6 = {param1} #param1# END*/ /*START #param2# AND a.s6 is null #param2# END*/ /*START #param3# AND a.s6 is not null #param3# END*/ order by a.subjectId,CASE WHEN a.isLeaf1 = 1 and a.level1 > 1 THEN a.parentSubjectId ELSE a.subjectId END
#\u67E5\u8BE2\u79D1\u76EE\u6811
other.MS000003=SELECT aa.id, aa.label AS `name`, aa.label, aa.value, IF(LENGTH(aa.parentId) = 1, '', aa.parentId) as parentId, aa.leaf FROM( SELECT a.subjectId AS `id`, CONCAT(a.subjectId, '-', a.subjectFullName) AS `label`, a.subjectId AS `value`, IF( LENGTH(a.parentSubjectId) = 0, SUBSTR(a.subjectId, 1, 1), a.parentSubjectId) AS parentId, IF(a.isLeaf1 = 0, 'false', 'true') AS leaf FROM {lockDbName}.fin_mergesubject a WHERE  a.customerId = {lockCustomerId} AND a.yyyy={lockYyyy} ) aa WHERE  1 = 1 /*START #param2# AND aa.parentId like '{param2}%' #param2# END*/ /*START #param19# AND aa.label LIKE '%{param19}%' #param19# END*/ ORDER BY aa.id, aa.value
#\u67E5\u8BE2\u5BA2\u6237\u79D1\u76EE\u5BF9\u7167
other.MS000004=select a.autoId,a.customerId,a.yyyy,a.subjectId,a.subjectName,a.subjectFullId,a.subjectFullName,a.parentSubjectId,a.direction,a.level1,a.isLeaf1,b.subjectId as contrastSubjectId FROM {lockDbName}.fin_mergesubject a left join {lockDbName}.fin_mergesubject b on a.s1 = b.subjectId and a.customerId = b.customerId and a.yyyy = b.yyyy where a.customerId = {customerId} and a.yyyy = {yyyy} /*START #param1# and a.s6 = {param1} #param1# END*/ order by a.subjectId,CASE WHEN a.isLeaf1 = 1 and a.level1 > 1 THEN a.parentSubjectId ELSE a.subjectId END
#\u67E5\u8BE2\u5BA2\u6237\u6838\u7B97\u5BF9\u7167
other.MS000005=select a.autoId,a.customerId,a.yyyy,a.assItemId,a.assItemName,a.assItemFullId,a.assTotalName,a.parentAssItemId,a.level1,a.isLeaf1 {customerColumn} FROM {lockDbName}.fin_mergeassitem a {customerJoin} where a.customerId = {newCustomerId} and a.yyyy = {yyyy} group by a.autoId order by a.assItemId,CASE WHEN a.isLeaf1 = 1 and a.level1 > 1 THEN a.parentAssItemId ELSE a.assItemId END
#\u67E5\u8BE2\u5BA2\u6237\u6838\u7B97\u5BF9\u7167
other.MS000006=select a.autoId,a.customerId,a.yyyy,a.assItemId,a.assItemName,a.assItemFullId,a.assTotalName,a.parentAssItemId,a.level1,a.isLeaf1 FROM {lockDbName}.fin_mergeassitem a where a.customerId = {customerId} and a.yyyy = {yyyy} /*START #param1# and a.s6 = {param1} #param1# END*/ /*START #param2# AND a.s6 is null #param2# END*/ /*START #param3# AND a.s6 is not null #param3# END*/ order by a.assItemId,CASE WHEN a.isLeaf1 = 1 and a.level1 > 1 THEN a.parentAssItemId ELSE a.assItemId END
#\u67E5\u8BE2\u5BA2\u6237\u6838\u7B97\u5BF9\u7167
other.MS000007=select a.autoId,a.customerId,a.yyyy,a.assItemId,a.assItemName,a.assItemFullId,a.assTotalName,a.parentAssItemId,a.level1,a.isLeaf1,b.assItemId as contrastAssItemId FROM {lockDbName}.fin_mergeassitem a left join {lockDbName}.fin_mergeassitem b on a.s1 = b.assItemId and a.customerId = b.customerId and a.yyyy = b.yyyy where a.customerId = {customerId} and a.yyyy = {yyyy} /*START #param1# and a.s6 = {param1} #param1# END*/ order by a.assItemId,CASE WHEN a.isLeaf1 = 1 and a.level1 > 1 THEN a.parentAssItemId ELSE a.assItemId END
#\u67E5\u8BE2\u5BA2\u6237\u79D1\u76EE\u5C42\u7EA7
other.MS000008=select count(1) as levelNum from {lockDbName}.fin_mergesubject a where a.customerId = {newCustomerId} and a.yyyy = {yyyy} and a.level1 = 0
#\u67E5\u8BE2\u5BA2\u6237\u6838\u7B97\u5C42\u7EA7
other.MS000009=select count(1) as levelNum from {lockDbName}.fin_mergeassitem a where a.customerId = {newCustomerId} and a.yyyy = {yyyy} and a.level1 = 0
####\u8D22\u52A1\u8D26\u5957\u5408\u5E76####