#TB\u79D1\u76EE\u5BF9\u7167\u4E00\u89C8
FA10005=SELECT a.autoId, a.userDefined, a.creditBalance, a.tranDebitTotalOcc, a.tranCreditTotalOcc, debitTotalOcc-tranDebitTotalOcc AS debitTotalOccNoTran, creditTotalOcc-tranCreditTotalOcc AS creditTotalOccNoTran, a.customerId, a.yyyy,a.vocationId,a.baseSubjectId,a.baseSubjectName, a.tbSubjectCode, a.tbSubjectName, a.reportSubjectId, a.reportSubjectName, a.userSubjectId, a.userSubjectName, a.remain, a.debitRemain, (a.creditRemain * (- 1)) AS creditRemain, a.debitTotalOcc, a.creditTotalOcc, a.debitBalance, a.creditBalance * (- 1), IF(a.direction = - 1, '\u8D37', '\u501F') AS direction, a.balance, a.level0, a.isLeaf0 FROM bdo_dg.dg_tbsubjectcontract a WHERE a.customerId = {param1} AND a.yyyy = {param2} and a.projectId = {param3} ORDER BY a.userSubjectId, a.level0 
#\u67E5\u8BE2\u8C03\u6574\u5206\u5F55
FA10056=SELECT a.autoId,a.accPackageId,a.customerId,a.projectId,a.yyyy AS subjectYear,a.subjectId,a.voucherId,a.serail,a.summary,a.dirction,a.occurValue,a.currValue,a.currency,a.subjectname1 AS subjectName,a.subjectFullName1 AS fullName,a.adjustType,a.adjustSubjectTB,a.adjustSubjectCodeReport,a.adjustSubjectReport,a.status,a.ACTIVE_FLAG FROM bdo_dg.dg_subjectentryadjust a WHERE 1 = 1 /*START #param1# AND a.customerId = {param1} #param1# END*//*START #param5# AND a.projectId = {param5} #param5# END*/ /*START #param2# AND a.yyyy = {param2} #param2# END*/ /*START #param3# AND a.subjectId = '{param3}' #param3# END*/ /*START #param4# AND a.adjustType = {param4} #param4# END*/ /*START #param6# AND a.adjustSubjectTB = '{param6}' #param6# END*/ ORDER BY a.voucherId 
#\u83B7\u53D6\u8C03\u6574\u5206\u5F55\u501F\u8D37\u603B\u91D1\u989D
FA10057=SELECT a.accPackageId,a.customerId,a.yyyy AS subjectYear,a.subjectId,SUM(CASE WHEN a.dirction = 1 THEN a.occurValue ELSE 0 END) AS debitOcc,SUM(CASE WHEN a.dirction = - 1 THEN a.occurValue ELSE 0 END) AS creditOcc,SUM(a.dirction*a.occurValue) AS balance,a.subjectname1 AS subjectName,a.subjectFullName1 AS fullName FROM bdo_dg.dg_subjectentryadjust a WHERE a.ACTIVE_FLAG = '1' /*START #param1# AND a.customerId = {param1} #param1# END*/ /*START #param2# AND a.yyyy = {param2} #param2# END*/ /*START #param3# AND a.subjectId = '{param3}' #param3# END*/ 
#\u8C03\u6574\u660E\u7EC6\u5BFC\u51FA
FA10082=SELECT CASE a.status WHEN '1' THEN '\u8C03\u6574' WHEN '2' THEN '\u8C03\u6574' WHEN '0' THEN '\u672A\u8C03\u6574' END as status,CASE a.dirction WHEN '-1' THEN a.occurValue END AS 'minusOccurValue',CASE a.dirction WHEN '1' THEN a.occurValue END AS 'plusOccurValue',a.autoId,a.workpaperId,a.assItemId,a.assItemName,a.indexId,a.accPackageId,a.customerId,a.projectId,a.yyyy AS subjectYear,a.subjectId,a.voucherId,a.serail,a.summary,a.dirction,a.occurValue,a.currValue,a.currency,a.subjectname1 AS subjectName,a.subjectFullName1 AS fullName,a.adjustType,a.adjustSubjectTB,a.adjustSubjectCodeReport,a.adjustSubjectReport,a.reason,a.fillUser AS __ufillUserName,a.ACTIVE_FLAG FROM bdo_dg.dg_subjectentryadjust a INNER JOIN(SELECT DISTINCT indexId FROM bdo_dg.dg_subjectentryadjust WHERE customerId = {param1} AND yyyy BETWEEN {param2} AND {param6} AND adjustType = {param3} /*START #param4# AND tbSubjectCode = '{param4}' #param4# END*/ AND projectId = {param5}) b ON a.indexId = b.indexId WHERE a.customerId = {param1} AND yyyy BETWEEN {param2} AND {param6} AND a.projectId = {param5} AND a.adjustType = {param3} ORDER BY a.indexId 
#TB\u79D1\u76EE\u5BF9\u7167\u4E00\u89C8 cuiwenchao\u7F16\u5199 (\u4FEE\u6539\u4E3A\u8D37\u65B9\u671F\u521D\u4E0D\u4E58\u8D1F\u4E00##\u4FEE\u6539\u5BA2\u6237\u8D22\u52A1\u79D1\u76EE\u65F6\u56DE\u663E\u6570\u636E\u65F6\u7528\u5230)
FA10083=SELECT a.autoId, a.userDefined, a.creditBalance, a.tranDebitTotalOcc, a.tranCreditTotalOcc, debitTotalOcc-tranDebitTotalOcc AS debitTotalOccNoTran, creditTotalOcc-tranCreditTotalOcc AS creditTotalOccNoTran, a.customerId, a.yyyy,a.vocationId,a.baseSubjectId,a.baseSubjectName, a.tbSubjectCode, a.tbSubjectName, a.reportSubjectId, a.reportSubjectName, a.userSubjectId, a.userSubjectName, a.remain, a.debitRemain, a.creditRemain , a.debitTotalOcc, a.creditTotalOcc, a.debitBalance, a.creditBalance * (- 1), CASE a.direction WHEN  -1 THEN  '\u8D37' WHEN 1 THEN  '\u501F' END AS direction, a.balance, a.level0, a.isLeaf0 FROM bdo_dg.dg_tbsubjectcontract a WHERE a.customerId = {param1} AND a.yyyy = {param2} and a.projectId = {param3} /*START #param4# and a.tbSubjectCode is null #param4# END*/ /*START #param5# and a.tbSubjectCode is not null #param5# END*/ ORDER BY a.userSubjectId, a.level0 
#\u8C03\u6574\u660E\u7EC6(\u672A\u5BA1\u62A5\u8868\u91CD\u5206\u7C7B\u8C03\u6574 TA03 \u672A\u5206\u914D\u5229\u6DA6\u4E13\u7528)
FA10084=SELECT a.autoId,a.workpaperId,a.assItemId,a.assItemName,a.indexId,a.accPackageId,a.customerId,a.projectId,a.yyyy AS subjectYear,a.subjectId,a.voucherId,a.serail,a.summary,a.dirction,a.occurValue,a.currValue,a.currency,a.subjectname1 AS subjectName,a.subjectFullName1 AS fullName,a.adjustType,a.adjustSubjectTB,a.adjustSubjectCodeReport,a.adjustSubjectReport,a.status,a.reason,a.fillUser AS __ufillUserName,a.ACTIVE_FLAG FROM bdo_dg.dg_subjectentryadjust a INNER JOIN(SELECT DISTINCT indexId FROM bdo_dg.dg_subjectentryadjust WHERE customerId = {param1} AND yyyy BETWEEN {param2} AND {param6} AND adjustType = {param3} AND left(subjectId,1) ='6' AND projectId = {param5}) b ON a.indexId = b.indexId WHERE a.customerId = {param1} AND yyyy BETWEEN {param2} AND {param6} AND a.projectId = {param5} AND a.adjustType = {param3} ORDER BY a.indexId 
#\u83B7\u53D6\u5B50\u7A0B\u5E8F
FA30037=select `autoId`,`departmentId`,`customerId`,`projectId`,`parentId`,`typeId`,`level`,`indexId`,`subjecttreeId`,`auditprogramId`,`subjectId`,`subjectName`,`programNamePre`,`programNameAft`,`auditDesc`,`auditConclusion`,`confirmStatusPre`,`confirmStatusPreName`,`confirmStatusAft`,`confirmStatusAftName`,`csE`,`csC`,`csA`,`csV`,`csP`,`sE`,`sC`,`sA`,`sV`,`sP`,`csEOriginal`,`csCOriginal`,`csAOriginal`,`csVOriginal`,`csPOriginal`,`sEOriginal`,`sCOriginal`,`sAOriginal`,`sVOriginal`,`sPOriginal`,`workpaperId`,`required`,`state`,`updateFlag`,`customizeFlag`,`reason`,`remark`,`dgName`,`status`,`audit3`,`audit3Date`,`audit2`,`audit2Date`,`audit1`,`audit1Date`,`dgparam`,`CREATION_DATE`,`CREATED_BY`,`LAST_UPDATE_DATE`,`LAST_UPDATED_BY`,`ABOLITION_DATE`,`ABOLISHED_BY`,`PROGRAM_APPLICATION_ID`,`PROGRAM_ID`,`ACTIVE_FLAG` from bdo_dg.dg_auditprogram where autoId={param1} 
#\u67E5\u8BE2\u62BD\u6837\u62BD\u51ED
FA30067=SELECT autoId,sampleName,customerId,projectId,dataResource,vchDateType,vchDateStart,vchDateEnd,subjectId,typeId,oldVoucherId,summary,amountType,assItemId,sampleMethod,projectCount,projectAverage,sampleCount,sampleStatus,sampleUser AS __uuploadUser,sampleTime from bdo_dg.dg_samplinglist where 1=1 /*START #lockCustomerId# and customerId = {lockCustomerId} #lockCustomerId# END*/ /*START #param3# and projectId = {param3} #param3# END*/ /*START #param2# AND sampleName LIKE '%{param2}%' #param2# END*/ and sampleUser = {param4}
#\u67E5\u8BE2\u62BD\u51ED\u7ED3\u679C
FA30073=select a.autoId,a.customerId,a.yyyy,a.month,a.voucherId,a.oldVoucherId,a.typeId,a.vchDate,a.serail,a.summary,a.subjectId,a.direction,a.occurValue,a.currRate,a.currValue,a.currency,a.subjectname,a.subjectFullName,a.sampleMethod,a.sampleUserName,IF(a.direction = 1,a.occurValue,0.00) AS debitValue,IF(a.direction = - 1,a.occurValue,0.00) AS crebitValue,a.auditResult,a.remark,b.fileIndexId from bdo_dg.dg_samplingsubjectentry a left join (select a.customerId,a.projectId,b.subjectentryId,GROUP_CONCAT(a.fileIndexId) fileIndexId from bdo_dg.dg_samplingfile a inner join bdo_dg.dg_samplingfileRelated b on a.autoId= b.samplingFileId where a.customerId = {lockCustomerId} and a.projectId = {param1} group by a.customerId,a.projectId,b.subjectentryId) b on a.customerId = b.customerId and a.autoId = b.subjectentryId and a.projectId= b.projectId where a.customerId = {lockCustomerId} and a.projectId = {param1} and a.yyyy={param2} /*START #param12# AND a.month >='{param12}' #param12# END*/ /*START #param13# AND a.month <='{param13}' #param13# END*/ /*START #param3# AND a.vchDate >='{param3}' #param3# END*/ /*START #param4# AND a.vchDate <='{param4}' #param4# END*/ /*START #param5# AND a.sampleMethod ='{param5}' #param5# END*/ /*START #param6# AND a.oldVoucherId = '{param6}' #param6# END*/ /*START #param7# AND a.sampleUserName ='{param7}' #param7# END*/ /*START #param11# and a.subjectId LIKE CONCAT('{param11}','%') #param11# END*/ order by a.vchDate,a.oldVoucherId,a.serail,a.subjectId
#\u67E5\u8BE2\u5254\u9664\u6570\u636E
FA30078=SELECT samplingId,dataResource,GROUP_CONCAT(subjectId) as subjectId,GROUP_CONCAT(voucherId) as voucherId,GROUP_CONCAT(CONCAT(subjectId,'-',assItemId)) as assItemId from bdo_dg.dg_samplingcull a where a.samplingId = {param1} and a.dataResource = {param2} and customerId = {lockCustomerId} and projectId = {param3}
#\u67E5\u8BE2\u8BD5\u62BD\u6837\u7ED3\u679C\u6570\u636E
FA30079=SELECT samplingId,dataResource,GROUP_CONCAT(subjectId) as subjectId,GROUP_CONCAT(voucherId) as voucherId,GROUP_CONCAT(CONCAT(subjectId,'-',assItemId)) as assItemId from bdo_dg.dg_samplingresult a where a.samplingId = {param1} and a.dataResource = {param2} and customerId = {lockCustomerId} and projectId = {param3}
#\u67E5\u8BE2\u62BD\u6837\u7ED3\u679C\u51ED\u8BC1\u6570\u636E
FA30082=SELECT GROUP_CONCAT(voucherId) as voucherId from bdo_dg.dg_samplingsubjectentry a where a.customerId = {lockCustomerId} and projectId = {param1} and yyyy = {param2}
#\u67E5\u8BE2\u62BD\u51ED\u9644\u4EF6
FA30083=SELECT a.autoId, a.customerId, a.projectId, a.fileIndexId, a.fileName, a.fileType, a.suffix, a.fullPath, a.uploadDate, a.subjectTreeId, a.CREATED_BY as __uuploadUser, a.sortNum, a.tempFileIndexId, a.tempFullPath, a.relateType FROM bdo_dg.dg_samplingfile a WHERE a.customerId = {param1} /*START #param2# AND a.subjectTreeId = {param2} #param2# END*/ /*START #param3# AND a.autoId = {param3} #param3# END*/ /*START #param4# AND a.projectId = {param4} #param4# END*/ /*START #param5# AND a.subjectentryId = {param5} #param5# END*/ /*START #param6# AND a.relateType = {param6} #param6# END*/ /*START #param7# AND a.CREATED_BY = {param7} #param7# END*/ ORDER BY a.sortNum
#\u67E5\u8BE2\u5176\u4ED6\u7528\u6237\u62BD\u4E2D\u7684\u6570\u636E
FA30084=select a.samplingId,b.sampleMethod,b.sampleUser,b.sampleUserName from bdo_dg.dg_samplingresult a,bdo_dg.dg_samplinglist b where a.customerId = {lockCustomerId} and a.projectId = {param2} and a.voucherId = {param3} and a.resultState = '1' and a.samplingId <> {param4} and a.samplingId = b.autoId order by a.CREATION_DATE
FA40002=SELECT a.customerId,a.yyyy,a.projectId,a.reportSubjectId,a.tbSubjectCode,a.tbSubjectName,a.reportSubjectName,a.userSubjectId,a.userSubjectName,a.debitTotalOcc,a.creditTotalOcc,a.tranDebitTotalOcc,a.tranCreditTotalOcc,a.remain,a.balance,a.direction FROM bdo_dg.dg_tbsubjectcontract a WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} and a.projectId={projectId} AND a.reportSubjectId IS NOT NULL GROUP BY a.userSubjectId 
#\u672A\u5BA1\u62A5\u8868\u67E5\u8BE2
#FA40003=SELECT colCode,colDisp,colType,customerAmount AS customerAmount{yyyy}, unAuditAmount AS unAuditAmount{yyyy},adjustAmount AS adjustAmount{yyyy},adjustedAmount AS adjustedAmount{yyyy},(ifnull(customerAmount,0) - ifnull(adjustedAmount,0)) AS differenceAmount{yyyy}, remain AS remain{yyyy}, adjustRemain AS adjustRemain{yyyy}, adjustedRemain AS adjustedRemain{yyyy}, customerRemain AS customerRemain{yyyy}, ( ifnull(customerRemain, 0) - ifnull(adjustedRemain, 0)) AS differenceRemain{yyyy}, adjustFlag  FROM dg_unauditreport WHERE customerId = {customerId} AND yyyy = {yyyy} and projectId={projectId} ORDER BY sortNo
FA40003=SELECT colCode,colDisp,colType,TRUNCATE(customerAmount,2) AS customerAmount{yyyy},TRUNCATE(unAuditAmount,2) AS unAuditAmount{yyyy},TRUNCATE(adjustAmount,2) AS adjustAmount{yyyy},TRUNCATE(adjustedAmount,2) AS adjustedAmount{yyyy},(TRUNCATE(IFNULL(customerAmount,0),2) - TRUNCATE(IFNULL(adjustedAmount,0),2)) AS differenceAmount{yyyy},TRUNCATE(remain,2) AS remain{yyyy},TRUNCATE(adjustRemain,2) AS adjustRemain{yyyy},TRUNCATE(adjustedRemain,2) AS adjustedRemain{yyyy},TRUNCATE(customerRemain,2) AS customerRemain{yyyy},(TRUNCATE(IFNULL(customerRemain,0),2) - TRUNCATE(IFNULL(adjustedRemain,0),2)) AS differenceRemain{yyyy},adjustFlag FROM bdo_dg.dg_unauditreport WHERE customerId = {customerId} AND yyyy = {yyyy} AND projectId = {projectId} ORDER BY sortNo 
#\u672A\u5BA1\u62A5\u8868\u67E5\u8BE2
FA40004=SELECT changeReason,colCode,colDisp,colType,customerAmount AS customerAmount{param2},unAuditAmount AS unAuditAmount{param2},adjustAmount AS adjustAmount{param2},adjustedAmount AS adjustedAmount{param2},(ifnull(customerAmount,0) - ifnull(adjustedAmount,0)) AS differenceAmount{param2},remain AS remain{param2},adjustRemain AS adjustRemain{param2},adjustedRemain AS adjustedRemain{param2},customerRemain AS customerRemain{param2},(ifnull(customerRemain,0) - ifnull(adjustedRemain,0)) AS differenceRemain{param2},adjustFlag,t1.tableDiv,calFun FROM bdo_dg.dg_unauditreport INNER JOIN(SELECT colCode AS subjectId,tableDiv,calFun FROM asdb.k_reporttemplate WHERE vocationId = {param4} /*START #param5# AND tableDiv = {param5} #param5# END*/) AS t1 ON colCode = t1.subjectId WHERE customerId = {param1} AND yyyy = {param2} and projectId={param3} ORDER BY sortNo 
FA50009=SELECT audit.colCode, audit.colDisp, audit.colType, audit.customerAmount AS customerAmount{param2}, audit.unAuditAmount AS unAuditAmount{param2}, audit.adjustAmount AS adjustAmount{param2}, audit.adjustedAmount AS adjustedAmount{param2}, audit.remain AS remain{param2}, audit.adjustRemain AS adjustRemain{param2}, audit.adjustedRemain AS adjustedRemain{param2}, audit.customerRemain AS customerRemain{param2}, (ifnull(audit.customerAmount, 0) - ifnull(audit.adjustedAmount, 0)) AS differenceAmount{param2}, (ifnull(audit.customerRemain, 0) - ifnull(audit.adjustedRemain, 0)) AS differenceRemain{param2}, audit.adjustFlag FROM bdo_dg.dg_unauditreport audit LEFT JOIN asdb.k_reporttemplate temp ON audit.colCode = temp.colCode WHERE audit.customerId = {param1} AND audit.yyyy = {param2} AND audit.projectId = {param3} AND audit.colType = 1 AND temp.vocationId = {param4} AND NOT EXISTS(SELECT contract.reportSubjectId FROM bdo_dg.dg_tbsubjectcontract contract WHERE contract.customerId = {param1} AND contract.yyyy = {param2} AND contract.projectId = {param3} AND contract.reportSubjectId = audit.colCode ) GROUP BY audit.colCode
FA50010=SELECT DISTINCT t.autoId,t.customerId,t.yyyy,t.projectId,t.colCode,t.colDisp,t.colType,t.sortNo,t.column1,t.column2,t.column3,t.column4,t.column5,t.column6,t.column7,t.column8,t.column9,t.column10,t.column11,t.column12 FROM bdo_dg.dg_unauditreport_tpl AS t WHERE t.customerId = {param1} AND t.projectId = {param3} AND t.isEnd = {param6} AND t.calfun is null AND NOT EXISTS(SELECT DISTINCT * FROM bdo_dg.dg_tbsubjectcontract contract WHERE contract.customerId = {param1} AND contract.projectId = {param3} AND contract.reportSubjectId like 'G%' GROUP BY contract.reportSubjectId HAVING contract.reportSubjectId = t.colCode) GROUP BY t.colCode 
#\u8BD5\u7B97\u5E73\u8861\u8868\u67E5\u8BE2
FA40007=SELECT a.tbSubjectId AS colCode,concat(a.subjectType1,a.tbSubjectName) as colKey,a.tbSubjectName AS colDisp,a.subjectType1,a.subjectType2,a.colType,a.unAuditAmount AS unAuditAmount{yyyy},a.adjustCAmount AS adjustCAmount{yyyy},a.adjustAmount AS adjustAmount{yyyy},a.auditAmount AS auditAmount{yyyy},a.adjustFlag,count(c.autoId) contractCount,c.direction FROM bdo_dg.dg_tbtable a LEFT JOIN bdo_dg.dg_projecttb b ON a.customerId=b.customerId AND a.projectId=b.projectId AND a.tbSubjectId=b.tbSubjectId LEFT JOIN bdo_dg.dg_tbsubjectcontract c ON a.customerId = c.customerId AND a.projectId = c.projectId AND a.tbSubjectId = c.tbSubjectCode WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} and a.projectId = {projectId} GROUP BY a.tbSubjectId,a.sortNo ORDER BY a.sortNo 
#\u67E5\u8BE2\u8C03\u6574\u79D1\u76EE
FA40008=SELECT subjectId,occurValue,dirction FROM bdo_dg.dg_subjectentryadjust WHERE customerId = {customerId} AND yyyy = {yyyy} 
#\u8BD5\u7B97\u5E73\u8861\u8868\u5408\u8BA1\u751F\u6210
#FA40011=SELECT IF( a.colDisp = '', CONCAT(c.subjectTypeName, '\u5408\u8BA1'), a.colDisp ) AS colDisp, a.subjectType1, a.subjectType2, a.unAuditAmount AS unAuditAmount, a.adjustAmount AS adjustAmount, a.auditAmount AS auditAmount FROM (SELECT '' AS colDisp, subjectType2 AS subjectType, subjectType1, subjectType2, SUM(a.unAuditAmount) AS unAuditAmount, SUM(a.adjustAmount) AS adjustAmount, SUM(a.auditAmount) AS auditAmount FROM dg_tbtable a WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} AND a.projectId = {projectId} AND subjectType2 > '' AND a.colDisp <> '' AND a.type = 1 GROUP BY subjectType2 UNION SELECT '' AS colDisp, subjectType1 AS subjectType, subjectType1, CONCAT(subjectType1, '99') AS subjectType2, SUM(a.unAuditAmount) AS unAuditAmount, SUM(a.adjustAmount) AS adjustAmount, SUM(a.auditAmount) AS auditAmount FROM dg_tbtable a WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} AND a.projectId = {projectId} AND subjectType1 <> 'Z' AND a.type = 1 GROUP BY subjectType1 UNION SELECT '\u8D1F\u503A\u548C\u6240\u6709\u8005\u6743\u76CA\u603B\u8BA1', 'CB', 'CB', '', SUM(a.unAuditAmount), SUM(a.adjustAmount), SUM(a.auditAmount) FROM dg_tbtable a WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} AND a.projectId = {projectId} AND subjectType1 IN ('B', 'C') AND a.type = 1 UNION SELECT '\u672A\u5206\u914D\u5229\u6DA6', 'Z', 'Z', 'Z99', SUM(a.unAuditAmount), SUM(a.adjustAmount), SUM(a.auditAmount) FROM dg_tbtable a WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} AND a.projectId = {projectId} AND subjectType1 IN ('S', 'Z') AND a.type = 1) a LEFT JOIN asdb.k_subjecttype c ON a.subjectType = c.subjectTypeId ORDER BY a.subjecttype1, a.subjecttype2
FA40011=SELECT IF(a.tbSubjectName = '',CONCAT(c.subjectTypeName,'\u5408\u8BA1'),a.tbSubjectName) AS colDisp,a.subjectType1,a.subjectType2,a.unAuditAmount AS unAuditAmount,a.adjustCAmount AS adjustCAmount,a.adjustAmount AS adjustAmount,a.auditAmount AS auditAmount,a.sortNo from (SELECT '' AS tbSubjectName,subjectType2 AS subjectType,subjectType1,subjectType2,SUM(a.unAuditAmount) AS unAuditAmount,SUM(a.adjustCAmount) AS adjustCAmount,SUM(a.adjustAmount) AS adjustAmount,SUM(a.auditAmount) AS auditAmount,MAX(sortNo) sortNo FROM bdo_dg.dg_tbtable a WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} AND a.projectId = {projectId} AND subjectType2 > '' AND a.tbSubjectName <> '' AND a.colType = 1 GROUP BY subjectType2 UNION SELECT '' AS tbSubjectName,subjectType1 AS subjectType,subjectType1,CONCAT(subjectType1,'99') AS subjectType2,SUM(a.unAuditAmount) AS unAuditAmount,SUM(a.adjustCAmount) AS adjustCAmount,SUM(a.adjustAmount) AS adjustAmount,SUM(a.auditAmount) AS auditAmount,MAX(sortNo) sortNo FROM bdo_dg.dg_tbtable a WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} AND a.projectId = {projectId} AND subjectType1 <> 'Z' AND a.colType = 1 GROUP BY subjectType1 UNION SELECT '\u8D1F\u503A\u548C\u6240\u6709\u8005\u6743\u76CA\u603B\u8BA1','CB','CB','',SUM(a.unAuditAmount),SUM(a.adjustCAmount),SUM(a.adjustAmount),SUM(a.auditAmount),MAX(sortNo) sortNo FROM bdo_dg.dg_tbtable a WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} AND a.projectId = {projectId} AND subjectType1 IN('B','C') AND a.colType = 1 UNION SELECT '\u672A\u5206\u914D\u5229\u6DA6','Z','Z','Z01',SUM(a.unAuditAmount),SUM(a.adjustCAmount),SUM(a.adjustAmount),SUM(a.auditAmount),MAX(sortNo) sortNo FROM bdo_dg.dg_tbtable a WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} AND a.projectId = {projectId} AND subjectType1 IN('S','Z') AND a.colType = 1) a LEFT JOIN asdb.k_subjecttype c ON a.subjectType = c.subjectTypeId ORDER BY a.subjecttype1,a.subjecttype2 
#\u8BD5\u7B97\u5E73\u8861\u8868\u6821\u9A8C\uFF08\u8D44\u4EA7=\u8D1F\u503A+\u6240\u6709\u8005\u6743\u76CA\uFF09
FA40012=SELECT(a.unAuditAmount + b.unAuditAmount) AS unAuditAmount,(a.adjustCAmount + b.adjustCAmount) AS adjustCAmount,(a.adjustAmount + b.adjustAmount) AS adjustAmount,(a.auditAmount + b.auditAmount) AS auditAmount from (SELECT unAuditAmount,adjustCAmount,adjustAmount,auditAmount FROM bdo_dg.dg_tbtable WHERE customerId = {customerId} AND yyyy = {yyyy} AND projectId = {projectId} AND tbSubjectName = '\u8D44\u4EA7\u5408\u8BA1') a,(SELECT unAuditAmount,adjustCAmount,adjustAmount,auditAmount FROM bdo_dg.dg_tbtable WHERE customerId = {customerId} AND yyyy = {yyyy} AND projectId = {projectId} AND tbSubjectName = '\u8D1F\u503A\u548C\u6240\u6709\u8005\u6743\u76CA\u603B\u8BA1') b 
#\u8BD5\u7B97\u5E73\u8861\u8868\u6821\u9A8C\uFF08\u635F\u76CA\u5408\u8BA1=\u672C\u5E74\u5229\u6DA6\uFF09
FA40013=SELECT(d.unAuditAmount - h.unAuditAmount) AS unAuditAmount,(d.adjustCAmount - k.adjustCAmount) AS adjustCAmount,(d.adjustAmount - g.adjustAmount) AS adjustAmount,(d.unAuditAmount - h.unAuditAmount + d.adjustCAmount - k.adjustCAmount + d.adjustAmount - g.adjustAmount) AS auditAmount from (SELECT unAuditAmount,adjustCAmount,adjustAmount,auditAmount FROM bdo_dg.dg_tbtable WHERE customerId = {customerId} AND yyyy = {yyyy} AND projectId = {projectId} AND tbSubjectName = '\u635F\u76CA\u5408\u8BA1') d,(SELECT((debitTotalOcc - tranDebitTotalOcc) -(creditTotalOcc - tranCreditTotalOcc)) AS unAuditAmount FROM bdo_dg.dg_tbsubjectcontract WHERE customerId = {customerId} AND yyyy = {yyyy} AND projectId = {projectId} AND userSubjectName = '\u672C\u5E74\u5229\u6DA6') h,(SELECT IFNULL(SUM(occurValue * dirction),0.00) AS adjustAmount FROM bdo_dg.dg_subjectentryadjust WHERE customerId = {customerId} AND yyyy = {yyyy} AND projectId = {projectId} AND adjustType = 2 AND subjectname1 = '\u672C\u5E74\u5229\u6DA6' AND STATUS = 1 AND ACTIVE_FLAG = 1) g,(SELECT IFNULL(SUM(occurValue * dirction),0.00) AS adjustCAmount FROM bdo_dg.dg_subjectentryadjust WHERE customerId = {customerId} AND yyyy = {yyyy} AND projectId = {projectId} AND adjustType = 1 AND subjectname1 = '\u672C\u5E74\u5229\u6DA6' AND STATUS = 1 AND ACTIVE_FLAG = 1) k 
#\u8BD5\u7B97\u5E73\u8861\u8868\u6821\u9A8C\uFF08\u671F\u521D\u672A\u5206\u914D\u5229\u6DA6+\u635F\u76CA\u5408\u8BA1-\u5229\u6DA6\u5206\u914D+\u4EE5\u524D\u5E74\u5EA6\u635F\u76CA=\u671F\u672B\u672A\u5206\u914D\u5229\u6DA6\uFF09
#FA40014=SELECT ( c.unAuditAmount + d.unAuditAmount + e.unAuditAmount + f.unAuditAmount - g.unAuditAmount ) AS unAuditAmount, ( c.adjustCAmount + d.adjustCAmount + e.adjustCAmount + f.adjustCAmount - g.adjustCAmount ) AS adjustCAmount, ( c.adjustAmount + d.adjustAmount + e.adjustAmount + f.adjustAmount - g.adjustAmount ) AS adjustAmount, ( c.auditAmount + d.auditAmount + e.auditAmount + f.auditAmount - g.auditAmount ) AS auditAmount FROM (SELECT unAuditAmount, adjustCAmount, adjustAmount, auditAmount FROM dg_tbtable WHERE customerId = {customerId} AND yyyy = {yyyy} AND projectId = {projectId} AND colDisp = '\u5E74\u521D\u672A\u5206\u914D\u5229\u6DA6') c, (SELECT unAuditAmount, adjustCAmount, adjustAmount, auditAmount FROM dg_tbtable WHERE customerId = {customerId} AND yyyy = {yyyy} AND projectId = {projectId} AND colDisp = '\u635F\u76CA\u5408\u8BA1') d, (SELECT SUM(unAuditAmount) AS unAuditAmount, SUM(adjustCAmount) AS adjustCAmount, SUM(adjustAmount) AS adjustAmount, SUM(auditAmount) AS auditAmount FROM dg_tbtable WHERE customerId = {customerId} AND yyyy = {yyyy} AND projectId = {projectId} AND LOCATE('\u5229\u6DA6\u5206\u914D/', colDisp) > 0) e, (SELECT unAuditAmount, adjustCAmount, adjustAmount, auditAmount FROM dg_tbtable WHERE customerId = {customerId} AND yyyy = {yyyy} AND projectId = {projectId} AND colDisp = '\u4EE5\u524D\u5E74\u5EA6\u635F\u76CA\u8C03\u6574') f, (SELECT unAuditAmount, adjustCAmount, adjustAmount, auditAmount FROM dg_tbtable WHERE customerId = {customerId} AND yyyy = {yyyy} AND projectId = {projectId} AND colDisp = '\u672A\u5206\u914D\u5229\u6DA6' AND subjectType1 = 'C') g
FA40014=SELECT(a.unAuditAmount - b.unAuditAmount) AS unAuditAmount,(a.adjustCAmount - b.adjustCAmount) AS adjustCAmount,(a.adjustAmount - b.adjustAmount) AS adjustAmount,(a.auditAmount - b.auditAmount) AS auditAmount from (SELECT unAuditAmount,adjustCAmount,adjustAmount,auditAmount FROM bdo_dg.dg_tbtable WHERE customerId = {customerId} AND yyyy = {yyyy} AND projectId = {projectId} AND tbSubjectName = '\u672A\u5206\u914D\u5229\u6DA6' AND subjectType1 = 'C') a,(SELECT unAuditAmount,adjustCAmount,adjustAmount,auditAmount FROM bdo_dg.dg_tbtable WHERE customerId = {customerId} AND yyyy = {yyyy} AND projectId = {projectId} AND tbSubjectName = '\u672A\u5206\u914D\u5229\u6DA6\u5408\u8BA1') b 
#TB\u6807\u51C6\u79D1\u76EE\u5BF9\u7167\u5173\u952E\u5B57\u8868\u67E5\u8BE2(\u6309\u90E8\u95E8\u67E5\u8BE2)
FA40021=SELECT departId, customerId, tbSubjectKey, userSubjectKey FROM bdo_dg.dg_tbsubjectkeyresult WHERE  customerId = {customerId} AND departId= {departId}  UNION SELECT departId, customerId, tbSubjectKey, userSubjectKey FROM (SELECT departmentId AS departId, 0 AS customerId, subjectname AS tbSubjectKey, subjectName AS userSubjectKey FROM asdb.k_subjecttb WHERE customerId = 0 AND departmentId = {departId} AND vocationId = {vocationId} UNION SELECT b.departmentId AS departId, 0 AS customerId, b.subjectName AS tbSubjectKey, TRIM( REPLACE( CONCAT(b.subjectName, ''), a.key1, a.key2 ) ) AS userSubjectKey FROM asdb.k_subjectContractkey a INNER JOIN (SELECT departmentId, subjectName FROM asdb.k_subjecttb WHERE customerId = 0 AND departmentId = {departId} AND vocationId = {vocationId}) b ON b.subjectName LIKE CONCAT('%', a.key1, '%')) aa WHERE userSubjectKey NOT IN (SELECT userSubjectKey FROM bdo_dg.dg_tbsubjectkeyresult WHERE customerId = {customerId} AND departId= {departId})
#TB\u6807\u51C6\u79D1\u76EE\u5BF9\u7167\u5173\u952E\u5B57\u8868\u67E5\u8BE2\uFF08\u6309\u5BA2\u6237\u67E5\u8BE2\uFF09
FA40022=SELECT departId, customerId, tbSubjectKey, userSubjectKey FROM bdo_dg.dg_tbsubjectkeyresult WHERE customerId = {customerId} UNION SELECT departId, customerId, tbSubjectKey, userSubjectKey FROM (SELECT departmentId AS departId, 0 AS customerId, subjectname AS tbSubjectKey, subjectName AS userSubjectKey FROM asdb.k_subjecttb WHERE customerId = {customerId} UNION SELECT b.departmentId AS departId, 0 AS customerId, b.subjectName AS tbSubjectKey, TRIM( REPLACE( CONCAT(b.subjectName, ''), a.key1, a.key2 ) ) AS userSubjectKey FROM asdb.k_subjectContractkey a INNER JOIN (SELECT departmentId, subjectName FROM asdb.k_subjecttb WHERE customerId = {customerId}) b ON b.subjectName LIKE CONCAT('%', a.key1, '%')) aa WHERE userSubjectKey NOT IN (SELECT userSubjectKey FROM bdo_dg.dg_tbsubjectkeyresult WHERE  customerId = {customerId})
#\u8BD5\u7B97\u5E73\u8861\u8868\u751F\u6210\u6570\u636E\u67E5\u8BE2
##FA40025=SELECT a.customerId,a.yyyy, a.tbSubjectName, a.userSubjectId, a.debitRemain, a.creditRemain, a.debitTotalOcc, a.creditTotalOcc, SUM(b.tranDebitTotalOccur) AS tranDebitTotalOcc, SUM(b.tranCreditTotalOccur) AS tranCreditTotalOcc, a.debitBalance, a.creditBalance, a.balance, a.direction FROM bdo_dg.dg_tbsubjectcontract a LEFT JOIN ( SELECT subjectId, IF(dirction = 1, SUM(occurValue), 0) AS tranDebitTotalOccur, IF(dirction = - 1, SUM(occurValue ), 0) AS tranCreditTotalOccur FROM bdo_fin.fin_subjectentry WHERE customerId = {customerId} AND yyyy = {yyyy} AND isTransferVoucher = 1 AND subjectname1 <> '\u672C\u5E74\u5229\u6DA6' GROUP BY subjectId) b ON  a.userSubjectId = LEFT(b.subjectId ,LENGTH(a.userSubjectId)) WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} AND a.projectId = {projectId} AND a.tbSubjectName IS NOT NULL GROUP BY a.userSubjectId
FA40025=SELECT a.customerId, a.yyyy, a.tbSubjectName, a.tbSubjectCode,a.reportSubjectName, a.userSubjectId, a.debitRemain, a.creditRemain, a.debitTotalOcc, a.creditTotalOcc, a.tranDebitTotalOcc,a.tranCreditTotalOcc, a.debitBalance, a.creditBalance, a.remain, a.balance, a.direction FROM bdo_dg.dg_tbsubjectcontract a WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} AND a.projectId = {projectId} AND a.tbSubjectName IS NOT NULL GROUP BY a.userSubjectId
#\u67E5\u8BE2\u5BF9\u7167\u5173\u952E\u5B57
FA40034=SELECT departId, customerId, tbSubjectKey, userSubjectKey,baseSubjectKey FROM bdo_dg.dg_tbsubjectkeyresult WHERE customerId = {customerId} AND departId = {departId}
#\u6240\u6709\u8005\u6743\u76CA\u67E5\u8BE2
FA40043=SELECT t.autoId,t.customerId,t.yyyy,t.projectId,t.colCode,t.colDisp,t.colType,t.rowNum,t.column1,t.column2,t.column3,t.column4,t.column5,t.column6,t.column7,t.column8,t.column9,t.column10,t.column11,t.column12,t.column13,t.column14,t.column15,t.isPre,t.columnDesc1,t.columnDesc2,t.columnDesc3,t.columnDesc4,t.columnDesc5,t.columnDesc6,t.columnDesc7,t.columnDesc8,t.columnDesc9,t.columnDesc10,t.columnDesc11,t.columnDesc12,t.columnDesc13,t.columnDesc14,t.columnDesc15 FROM bdo_dg.dg_auditreport_info t WHERE t.customerId = {param1} AND t.projectId = {param3} AND t.isPre = {param6} AND t.colType = 'G' 
#\u67E5\u8BE2\u8C03\u6574\u5206\u5F55\u7D22\u5F15\u8868
FA50008=SELECT Max(adjust.indexValue) AS indexId,autoId,customerId,workpaperId FROM bdo_dg.dg_entryadjustindex adjust WHERE adjust.customerId = {param1} and adjust.projectId = {param2} and adjust.INDEXKEY = '{param3}' AND adjust.workpaperId = {param4}
FA50012=SELECT SUM( a.occurValue ) AS occurValue FROM bdo_dg.dg_subjectentryadjust a INNER JOIN ( SELECT DISTINCT indexId FROM bdo_dg.dg_subjectentryadjust WHERE customerId = {param1} AND yyyy ={param2} AND adjustType = 2 AND tbSubjectCode = '{param3}' AND subjectId LIKE '{param3}%' AND projectId = {param4} ) b ON a.indexId = b.indexId WHERE a.customerId = {param1} AND yyyy ={param2} AND a.projectId = {param4} AND a.adjustType = 2 AND a.subjectId LIKE '{param3}%' AND a.dirction ={param5} ORDER BY a.indexId

################## \u5E95\u7A3F\u4E2D\u5FC3 ###################
#\u67E5\u8BE2\u90E8\u95E8\u5168\u94FE\u63A5
#DG01000=select fullpath from bdo_base.base_department where autoId = {param1}
#\u67E5\u8BE2\u90E8\u95E8\u7236\u7EA7\u5BF9\u5E94\u7684id
#DG01003=SELECT autoid FROM bdo_base.base_department WHERE fullpath LIKE "{param1}"
#\u67E5\u8BE2\u6240\u6709\u5BA1\u8BA1\u7A0B\u5E8F\u7684\u7D22\u5F15\u53F7
DG01001=SELECT autoId,indexId FROM asdb.k_auditprogram
#\u83B7\u53D6\u884C\u4E1A\u4E2D\u6587\u540D\u79F0
DG01002=SELECT GROUP_CONCAT(name) AS industryName FROM bdo_base.base_industry WHERE value in({param1})
#\u83B7\u53D6\u5DF2\u751F\u6210\u5BA1\u8BA1\u7A0B\u5E8F\u7684\u6240\u6709\u5BA2\u6237
#SUBSTRING_INDEX(a.customerName,'-',-1)
DG01003 = SELECT DISTINCT a.customerId AS value , a.customerName AS label FROM bdo_dg.dg_project a LEFT JOIN bdo_dg.dg_tbsubjectkeyresult result ON a.customerId = result.customerId WHERE result.departId = {param1}
#\u83B7\u53D6\u5DF2\u751F\u6210\u5BA1\u8BA1\u7A0B\u5E8F\u5BA2\u6237\u9879\u76EE
DG01004 = SELECT a.projectId AS value, a.projectName AS label FROM bdo_dg.dg_project a WHERE a.customerId = {customerId} ORDER BY a.projectId DESC
#\u53EF\u9009\u9879\u76EE\u5BA1\u8BA1\u7A0B\u5E8F\u4E00\u89C8
DG01005=SELECT DISTINCT a.autoId,a.customerId,p.customerName,a.projectId,p.projectName,a.subjectId,a.subjectName,con.tbSubjectId,con.tbSubjectCode,con.tbSubjectName,con.userSubjectId,con.userSubjectName,con.baseSubjectId,a.programNameAft,a.dgName,a.indexId,a.auditprogramId,a.CREATED_BY AS __ucreateUser,a.ACTIVE_FLAG FROM bdo_dg.dg_auditprogram a LEFT JOIN bdo_dg.dg_project p ON a.customerId = p.customerId AND a.projectId = p.projectId LEFT JOIN bdo_dg.dg_tbsubjectcontract con ON a.subjectName = con.userSubjectName AND con.customerId = {param13} AND con.projectId = {param14} WHERE a.customerId = {param11} AND a.LEVEL = 0 AND a.projectId ={param12} AND con.userSubjectId IS NOT NULL AND con.tbSubjectCode IS NOT NULL AND a.ACTIVE_FLAG = 1 /*START #param15# AND a.subjectId = '{param15}' #param15# END*/ 
#\u67E5\u8BE2\u8282\u70B9\u540D\u79F0
DG01010=SELECT autoId,projectId,customerId,parentId,subjectId,workpaperId,indexId,fileIndexId,nodeName,nodeType,userSubjectId,userSubjectName,tbSubjectCode,tbSubjectId,tbSubjectName FROM bdo_dg.dg_subjecttree WHERE customerId = {customerId} AND projectId = {projectId} AND nodeType = 'SUBJECT'
#\u67E5\u8BE2\u53EF\u9009\u9879\u76EE\u5BA1\u8BA1\u7A0B\u5E8F
DG01011=SELECT DISTINCT a.*,p.customerName,p.projectName,con.tbSubjectId,con.tbSubjectCode,con.tbSubjectName,con.userSubjectId,con.userSubjectName,con.baseSubjectId FROM bdo_dg.dg_auditprogram a LEFT JOIN bdo_dg.dg_project p ON a.customerId = p.customerId AND a.projectId = p.projectId LEFT JOIN bdo_dg.dg_tbsubjectcontract con ON a.subjectName = con.userSubjectName AND con.customerId = {param13} AND con.projectId = {param14} WHERE a.customerId = {param11} AND a.LEVEL = 0 AND a.projectId ={param12} AND con.userSubjectId IS NOT NULL AND con.tbSubjectCode IS NOT NULL AND a.subjectId = con.userSubjectId /*START #param15# AND a.subjectId = {param15} #param15# END*/ 
#\u67E5\u8BE2\u53EF\u9009\u9879\u76EE\u8BA1\u5212\u63A7\u5236\u8868\u5206\u6570\u548C\u79D1\u76EE\u7F16\u5236\u4EBA
DG01012=SELECT contract.autoId, contract.customerId, contract.projectId, contract.yyyy, contract.tbSubjectCode, contract.tbSubjectName, contract.userSubjectId, contract.userSubjectName, contract.plansE, contract.plansC, contract.plansA, contract.plansV, contract.plansP, contract.plancsE, contract.plancsC, contract.plancsA, contract.plancsV, contract.plancsP, contract.subjectEditors FROM bdo_dg.dg_tbsubjectcontract contract LEFT JOIN bdo_dg.dg_tbsubjectcontract tb ON contract.userSubjectName = tb.userSubjectName AND tb.userSubjectId IS NOT NULL AND tb.customerId = {param1} AND tb.projectId = {param2} WHERE tb.userSubjectId IS NOT NULL AND contract.customerId = {param3} AND contract.projectId = {param4} AND contract.yyyy = {param5}
#\u67E5\u8BE2\u8BA1\u5212\u63A7\u5236\u8868
DG01013=SELECT * FROM bdo_dg.dg_tbsubjectcontract contract WHERE contract.customerId = {param1} AND contract.projectId = {param2} AND contract.yyyy = {param3} AND FIND_IN_SET( contract.userSubjectName , '{userSubjectNames}')
#\u67E5\u8BE2\u53EF\u9009\u9879\u76EE\u5176\u4ED6\u5BA1\u8BA1\u7A0B\u5E8F
DG01015=SELECT DISTINCT a.autoId,a.customerId,p.customerName,a.projectId,p.projectName,a.subjectId,a.subjectName,con.tbSubjectId,con.tbSubjectCode,con.tbSubjectName,con.baseSubjectId,con.baseSubjectName,a.programNameAft,a.dgName,a.indexId,a.auditprogramId,a.CREATED_BY AS __ucreateUser,a.ACTIVE_FLAG FROM bdo_dg.dg_auditprogram a LEFT JOIN bdo_dg.dg_project p ON a.customerId = p.customerId AND a.projectId = p.projectId LEFT JOIN bdo_dg.dg_othersubjectcontract con ON a.subjectName = con.baseSubjectName AND con.customerId = {param13} AND con.projectId = {param14} WHERE a.customerId = {param11} AND a. LEVEL = 0 AND a.projectId ={param12} AND con.tbSubjectCode IS NOT NULL AND con.userSubjectId IS NOT NULL AND a.ACTIVE_FLAG = 1 /*START #param15# AND a.subjectId = '{param15}' #param15# END*/ 
#\u6838\u7B97\u9879\u76EE\u6811
DG01016=SELECT DISTINCT a.assItemId AS id, a.assItemId AS value, a.assItemName AS text, IF(b.num IS NULL,CONCAT(a.assItemId, ' : ', a.assTotalName),CONCAT(a.assItemId, ' : ', a.assTotalName, ' (', b.num, ')')) AS label, IF(a.isLeaf1 = 0, 'false', 'true') AS leaf, a.parentAssItemId AS parentid FROM bdo_dg.dg_customerassitem a left join (select parentAssItemId,count(distinct assItemId) as num from bdo_dg.dg_customerassitem WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} /*START #param11# AND subjectFullId REGEXP '{param11}' #param11# END*/ /*START #param19# AND assItemName LIKE '%{param19}%' #param19# END*/ group by parentAssItemId) b on a.assItemId = b.parentAssItemId WHERE a.isLeaf1 = 0 AND a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} /*START #param11# AND a.subjectFullId REGEXP '{param11}' #param11# END*/ /*START #param19# AND a.assItemName LIKE '%{param19}%' #param19# END*/ ORDER BY a.customerId, a.yyyy, a.assItemId 
DG01017=SELECT DISTINCT a.assItemId AS id, IF(b.num IS NULL,CONCAT(a.assItemId, ' : ', a.assTotalName),CONCAT(a.assItemId, ' : ', a.assTotalName, ' (', b.num, ')')) AS label, a.assTotalName AS text, a.assItemName AS qtip, IF(a.isLeaf1 = 0, 'false', 'true') AS leaf, a.parentAssItemId AS parentid FROM bdo_dg.dg_customerassitem a left join (select parentAssItemId,count(distinct assItemId) as num from bdo_dg.dg_customerassitem WHERE customerId = {lockCustomerId} AND yyyy = {lockYyyy} /*START #param11# AND subjectFullId REGEXP '{param11}' #param11# END*/ /*START #param19# AND assItemName LIKE '%{param19}%' #param19# END*/ group by parentAssItemId) b on a.assItemId = b.parentAssItemId WHERE a.customerId = {lockCustomerId} AND a.yyyy = {lockYyyy} /*START #param1# AND a.parentAssItemId = '{param1}' and a.assItemId <> a.parentAssItemId #param1# END*/ /*START #param11# AND subjectFullId REGEXP '{param11}' #param11# END*/ /*START #param19# AND a.assItemName LIKE '%{param19}%' #param19# END*/ ORDER BY a.customerId, a.yyyy, a.assItemId limit 20 

#\u5BA1\u8BA1\u7A0B\u5E8F\u4E00\u89C8
DG00001=SELECT * FROM ( SELECT DISTINCT a.autoId, a.subjectId, a.departmentId, a.departmentId AS __ddepartmentId, b.name, a.programName, a.indexId, a.dgName, a.subjectName, a.confirmStatus, a.confirmStatusName, a.potentialRisk, a.stage, a.stageName, a.allIndustryFlag, a.industry, a.industryName, a.description, a.required, a.createUser AS __ucreateUser, a.csE, IFNULL(a.useCount, 0) AS useCount, a.csC, a.csA, a.csV, a.csP, a.sE, a.sC, a.sA, a.sV, a.sP, a.ACTIVE_FLAG, IF( a.departmentId = 555555, '0', '1' ) AS depCustomizeFlag, a.competitiveFlag, a.userablePlate, a.allUserablePlateFlag, a.ifOtherSubject /*START #param4# ,apc.autoId as customizeId #param4# END*/ FROM asdb.k_auditprogram a LEFT JOIN bdo_base.base_company b ON a.departmentId = b.id /*START #param16# INNER JOIN ( SELECT a.autoId FROM asdb.k_auditprogram a WHERE a.userablePlate REGEXP REPLACE('{param16}', ',', '|') OR a.allUserablePlateFlag = 1 ) plate ON plate.autoId = a.autoId #param16# END*/ /*START #param11# INNER JOIN (SELECT a.autoId FROM bdo_base.base_department a WHERE CONCAT('|',a.fullpath) REGEXP '\\\\|{param11}\\\\|') dep ON dep.autoId = a.departmentId #param11# END*/ /*START #param2# LEFT JOIN asdb.k_auditprogram_industry c     ON a.autoId = c.autoid    AND c.industry IN ({param2})  WHERE c.id IS NOT NULL #param2# END*//*START #param4# LEFT JOIN asdb.k_auditprogramcustomize apc ON a.autoId = apc.auditprogramId and apc.templateId = {param4} #param4# END*//*START #param3# WHERE a.departmentId IN (SELECT SUBSTRING_INDEX(SUBSTRING_INDEX({param3},",",help_topic_id+1),',',-1) AS num FROM mysql.help_topic WHERE help_topic_id < LENGTH({param3}) -  LENGTH(REPLACE({param3},",",""))+1)  #param3# END*//*START #param10# WHERE a.departmentId  NOT IN ("{param10}") #param10# END*//* WHERE a.departmentId IN ({canDeparts}) AND a.potentialRisk = '{param12}' AND a.description = '{param13}'*//*START #param15# AND a.subjectId = '{param15}' #param15# END*/ ) a WHERE 1 = 1 /*START #param14# AND a.ACTIVE_FLAG = '{param14}' #param14# END*/
#\u884C\u4E1A
DG00002=SELECT a.autoId AS value, a.name AS label FROM bdo_base.base_industry a WHERE a.level = 1
#\u5BA1\u8BA1\u7A0B\u5E8F\u6A21\u677F
DG00003=SELECT a.autoId, a.fileName,a.fullPath  FROM asdb.k_auditprogramtpl a WHERE a.auditprogramId = {param1}
#\u79D1\u76EE\u7EF4\u62A4\u4E00\u89C8
DG00004=SELECT a.autoId, a.autoId AS id, a.subjectId AS value, IF(a.parentId = a.autoId, null, a.parentId) as parentId, IF(a.parentId = a.autoId, NULL, a.parentId) AS _parentId, a.level, a.isLeaf, IF(a.isLeaf = '1', 'true', 'false') AS leaf, IF(a.isLeaf = '1', '', 'closed') AS state, a.subjectId, a.subjectName, a.fsaCode, a.fsaName, a.lsReportCode, a.lsReportName, a.subjectName AS label, a.subjectName AS text, a.subjectFullName, a.CREATED_BY AS __uuserId FROM asdb.k_subject a WHERE 1 = 1 /*START #param1# and a.parentId = '{param1}' #param1# END*/ /*START #param11# and a.level = '{param11}' #param11# END*/ /*START #param18# AND a.autoId = '{param18}' #param18# END*/ /*START #param19# AND (a.subjectName like '%{param19}%' or a.subjectFullName like '%{param19}%' or a.subjectId like '%{param19}%') #param19# END*/ order by a.subjectId 
#\u6267\u884C\u7684\u5BA1\u8BA1\u7A0B\u5E8F\u4E00\u89C8
#DG00005=SELECT a.autoId, a.customerId, a.departmentId, a.departmentId AS __ddepartmentId, parent.departmentId AS pdepartmentId, a.projectId, a.subjecttreeId, a.parentId, a.level, a.indexId, a.auditprogramId, a.subjectId, a.workpaperId, a.subjectName, a.dgName, a.auditDesc, a.auditConclusion, a.programNamePre, a.programNameAft, a.confirmStatusPre, a.confirmStatusAft, a.required, a.state, a.updateFlag, a.customizeFlag, a.reason, a.remark, a.CREATED_BY AS __ucreateUser, a.audit1 AS __uaudit1, a.audit2 AS __uaudit2, a.audit3 AS __uaudit3, a.csE, a.csC, a.csA, a.csV, a.csP, a.sE, a.sC, a.sA, a.sV, a.sP, a.csEOriginal, a.csCOriginal, a.csAOriginal, a.csVOriginal, a.csPOriginal, a.sEOriginal, a.sCOriginal, a.sAOriginal, a.sVOriginal, a.sPOriginal, a.typeId, a.dgparam, c.paramHtmlPath, p.year, a.workpaperEditor AS __uworkpaperEditor, tbsc.subjectEditors AS __usubjectEditors, a.recheckUser AS __urecheckUser FROM bdo_dg.dg_auditprogram a LEFT JOIN bdo_dg.dg_subjecttree b ON b.autoId = a.subjecttreeId LEFT JOIN asdb.k_dgexceltype c ON c.id = a.typeId LEFT JOIN bdo_dg.dg_project p ON p.projectId = a.projectId LEFT JOIN bdo_dg.dg_tbsubjectcontract tbsc ON tbsc.projectId = a.projectId AND tbsc.customerId = a.customerId AND tbsc.userSubjectId = a.subjectId AND tbsc.yyyy = p.year LEFT JOIN bdo_dg.dg_auditprogram parent ON parent.autoId = a.parentId AND parent.customerId = a.customerId AND parent.projectId = a.projectId WHERE a.ACTIVE_FLAG = '{param3}' AND a.customerId = {param6} /*START #param1# AND a.subjecttreeId = {param1} #param1# END*/ /*START #param2# AND b.parentId = '{param2}' #param2# END*/ /*START #param4# AND a.projectId = {param4} #param4# END*/ /*START #param5# AND a.level = {param5} #param5# END*/ /*START #param8# AND a.workpaperEditor = {param8} #param8# END*/ ORDER BY a.customizeFlag, CASE WHEN parent.departmentId = 555555 THEN 0 ELSE 1 END, CASE WHEN a.customizeFlag = '1' AND a.level = 0 THEN a.autoId ELSE a.parentId END, a.autoId
DG00005=SELECT a.autoId, a.customerId, a.departmentId, a.departmentId AS __ddepartmentId, parent.departmentId AS pdepartmentId, a.projectId, a.subjecttreeId, a.parentId, a.level, a.indexId, a.auditprogramId, a.subjectId, a.workpaperId, a.subjectName, a.dgName, a.auditDesc, a.auditConclusion, a.programNamePre, a.programNameAft, a.confirmStatusPre, a.confirmStatusAft, a.required, a.state, a.updateFlag, a.customizeFlag, a.reason, a.remark, a.CREATED_BY AS __ucreateUser, a.audit1 AS __uaudit1, a.audit2 AS __uaudit2, a.audit3 AS __uaudit3, a.csE, a.csC, a.csA, a.csV, a.csP, a.sE, a.sC, a.sA, a.sV, a.sP, a.csEOriginal, a.csCOriginal, a.csAOriginal, a.csVOriginal, a.csPOriginal, a.sEOriginal, a.sCOriginal, a.sAOriginal, a.sVOriginal, a.sPOriginal, a.typeId, a.dgparam, c.paramHtmlPath, p.year, a.workpaperEditor AS __uworkpaperEditor, tbsc.subjectEditors AS __usubjectEditors, tbsco.subjectEditors AS __usubjectOtherEditors, a.recheckUser AS __urecheckUser FROM bdo_dg.dg_auditprogram a LEFT JOIN bdo_dg.dg_subjecttree b ON b.autoId = a.subjecttreeId LEFT JOIN asdb.k_dgexceltype c ON c.id = a.typeId LEFT JOIN bdo_dg.dg_project p ON p.projectId = a.projectId LEFT JOIN bdo_dg.dg_tbsubjectcontract tbsc ON tbsc.projectId = a.projectId AND tbsc.customerId = a.customerId AND tbsc.userSubjectId = a.subjectId AND tbsc.yyyy = p.year LEFT JOIN bdo_dg.dg_othersubjectcontract tbsco ON tbsco.projectId = a.projectId AND tbsc.customerId = a.customerId AND tbsco.userSubjectId = a.subjectId AND tbsco.yyyy = p.year  LEFT JOIN bdo_dg.dg_auditprogram parent ON parent.autoId = a.parentId AND parent.customerId = a.customerId AND parent.projectId = a.projectId WHERE a.ACTIVE_FLAG = '{param3}' AND a.customerId = {param6} /*START #param1# AND a.subjecttreeId = {param1} #param1# END*/ /*START #param2# AND b.parentId = '{param2}' #param2# END*/ /*START #param4# AND a.projectId = {param4} #param4# END*/ /*START #param5# AND a.level = {param5} #param5# END*/ /*START #param8# AND a.workpaperEditor = {param8} #param8# END*/ ORDER BY a.customizeFlag, CASE WHEN parent.departmentId = 555555 THEN 0 ELSE 1 END, CASE WHEN a.customizeFlag = '1' AND a.level = 0 THEN a.autoId ELSE a.parentId END, a.autoId 
#\u4E0D\u6267\u884C\u7684\u5BA1\u8BA1\u7A0B\u5E8F\u4E00\u89C8
#DG00006=SELECT a.autoId, a.customerId, a.projectId, a.indexId, a.auditprogramId, a.subjectId, a.subjectName, a.programNamePre, a.programNameAft, a.confirmStatusPre, a.confirmStatusAft, a.required, a.state, a.updateFlag, a.customizeFlag, a.reason, a.remark, a.CREATED_BY AS __ucreateUser, a.audit1 AS __uaudit1, a.audit2 AS __uaudit2, a.audit3 AS __uaudit3 FROM bdo_dg.dg_auditprogram a WHERE a.ACTIVE_FLAG = '{param3}' AND a.projectId = {param1} AND a.customerId = {param4} AND a.subjectName = '{param2}'
#\u79D1\u76EE\u6811
DG00007=SELECT a.autoId, a.autoId AS id, a.autoId AS value, a.subjectId, a.parentId, a.parentId AS _parentId, a.level, a.isLeaf, IF( a.isLeaf = '1', 'true', 'false' ) AS leaf, IF( a.isLeaf = '1', '', 'closed' ) AS state, a.subjectId, a.subjectName, a.subjectName AS label, a.subjectName AS text,a.subjectFullName, a.CREATED_BY AS __uuserId FROM asdb.k_subject a WHERE 1 = 1 /*START #param1# and a.parentId = '{param1}' #param1# END*/ /*START #param11# and a.level = '{param11}' #param11# END*/ /*START #param18# AND a.autoId = '{param18}' #param18# END*/ /*START #param19# AND (a.subjectName like '%{param19}%' or a.subjectFullName like '%{param19}%' or a.subjectId like '%{param19}%') #param19# END*/ and a.ACTIVE_FLAG = '1'
#\u79D1\u76EE\u6811
DG00008=SELECT a.autoId, a.autoId AS id, a.subjectId AS value, a.parentId, a.parentId AS _parentId, a.level, a.isLeaf, IF( a.isLeaf = '1', 'true', 'false' ) AS leaf, IF( a.isLeaf = '1', '', 'closed' ) AS state, a.subjectId, a.subjectName, a.subjectName AS label, a.subjectName AS text,a.subjectFullName, a.CREATED_BY AS __uuserId FROM asdb.k_subject a WHERE 1 = 1 /*START #param1# and a.parentId = '{param1}' #param1# END*/ /*START #param11# and a.level = '{param11}' #param11# END*/ /*START #param18# AND a.subjectId = '{param18}' #param18# END*/ /*START #param19# AND (a.subjectName like '%{param19}%' or a.subjectFullName like '%{param19}%' or a.subjectId like '%{param19}%') #param19# END*/ and a.ACTIVE_FLAG = '1'
#\u5BA1\u8BA1\u7A0B\u5E8F\u4E00\u89C8
DG00009=SELECT a.autoId, a.subjectId, a.departmentId AS __ddepartmentId, b.name,a.programName, a.indexId, a.dgName, a.subjectName, a.confirmStatus, a.confirmStatusName, a.potentialRisk, a.stage, a.stageName, a.allIndustryFlag, a.industry, a.industryName, a.description, a.required, a.createUser AS __ucreateUser, a.csE, a.csC, a.csA, a.csV, a.csP, a.sE, a.sC, a.sA, a.sV, a.sP FROM asdb.k_auditprogram a LEFT JOIN bdo_base.base_company b  ON a.departmentId = b.id /*START #param2# LEFT JOIN asdb.k_auditprogram_industry c     ON a.autoId = c.autoid    AND c.industry IN ({param2})    WHERE c.id IS NOT NULL #param2# END*/ /* WHERE a.departmentId IN ({canDeparts})*/ /*START #param3# WHERE a.ACTIVE_FLAG = '{param3}'  #param3# END*/
#\u81EA\u5B9A\u4E49\u5BA1\u8BA1\u7A0B\u5E8F\u6A21\u677F
DG00010=SELECT a.autoId, a.fileName FROM bdo_dg.dg_auditprogramtpl a WHERE a.auditprogramId = {param1}
#\u5BA1\u8BA1\u7A0B\u5E8F\u8BA4\u5B9A\u5206\u6570\u7EDF\u8BA1
DG00011=SELECT SUM(a.sE) AS sE,SUM(a.sC) AS sC,SUM(a.sA) AS sA,SUM(a.sV) AS sV,SUM(a.sP) AS sP FROM bdo_dg.dg_auditprogram a WHERE a.subjecttreeId = {param1} GROUP BY a.subjecttreeId 
#\u5E95\u7A3F\u9644\u4EF6
DG00012=SELECT a.autoId, a.fileIndexId, a.customerId, a.projectId, a.auditprogramId, a.workpaperId, b.fileName AS dgName, a.fileName, a.fileType, a.suffix, a.CREATION_DATE AS uploadDate, a.CREATED_BY AS __uuploadUser, a.isReferred AS referredFlg FROM bdo_dg.dg_attach a LEFT JOIN bdo_dg.dg_workpaper b  ON b.autoId = a.workpaperId and b.customerId = a.customerId WHERE a.auditprogramId = {param1} and a.customerId = {param2} order by a.autoId desc
#\u5B9E\u8D28\u6027\u5E95\u7A3F\u7F16\u5236\u5BFC\u5F15\u8868\u67E5\u8BE2
DG00013=SELECT a.userSubjectId, a.userSubjectName, a.remain, a.debitTotalOcc, a.creditTotalOcc, a.balance, CASE WHEN a.remain != 0 THEN CONCAT( ROUND( (a.balance-a.remain) / a.remain * 100, 2), '', '%' ) ELSE '0.00%' END AS rate FROM bdo_dg.dg_tbsubjectcontract AS a WHERE a.projectId = {param1} AND a.customerId = {param2} AND a.yyyy = {param5} /*START #param3# and a.userSubjectId = '{param3}' #param3# END*/ /*START #param4# and a.tbSubjectName = '{param4}' #param4# END*/ ORDER BY a.userSubjectId ASC 
#\u5B9E\u8D28\u6027\u5E95\u7A3F\u7F16\u5236\uFF0C\u8C03\u6574\u67E5\u8BE2
DG00014=SELECT a.assItemName,a.autoId,a.indexId,a.accPackageId,a.customerId,a.projectId,a.yyyy AS subjectYear,a.subjectId,a.voucherId,a.serail,a.summary,a.dirction,IF(a.dirction < 0,a.occurValue,'') AS minusOccurValue,IF(a.dirction > 0,a.occurValue,'') AS plusOccurValue,a.occurValue,a.currValue,a.currency,a.subjectname1 AS subjectName,a.subjectFullName1 AS fullName,a.adjustType,a.adjustSubjectTB,a.adjustSubjectCodeReport,a.adjustSubjectReport,a.status,if(a.ACTIVE_FLAG = '0','0',if(a.status = '1',a.status,'0')) as statuss,a.reason,a.fillUser AS __ufillUserName,a.workpaperId,a.ACTIVE_FLAG FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId={param1} AND a.projectId={param2} /*START #param3# and workpaperId IN({param3}) #param3# END*/ /*START #param4# and adjustType = '{param4}' #param4# END*/ /*START #param5# and subjectId = '{param5}' #param5# END*/ ORDER BY a.indexId 
#\u6279\u6CE8\u4E00\u89C8
DG00015=SELECT * from (SELECT a.autoId,a.indexId,a.createUser AS __ucreateUser,DATE_FORMAT(a.CREATION_DATE,'%Y-%m-%d %H:%i:%s') AS createDate,a.content,IFNULL(a.contentText,'') AS postilContentText,NULL AS comments,a.ACTIVE_FLAG AS activeFlag,(CASE WHEN a.CREATED_BY = {userId} THEN 'true' ELSE 'false' END) AS isAuthor,'' AS __ucommentedUser,a.type,'' AS commentId,'' AS annotationId FROM bdo_dg.dg_annotation a WHERE a.foreignId = {param1} AND a.type = '{param2}' AND a.auditState = {param4} /*START #param3# AND a.autoId = {param3} #param3# END*/ UNION ALL SELECT a.autoId,b.indexId,a.createUser AS __ucreateUser,DATE_FORMAT(a.CREATION_DATE,'%Y-%m-%d %H:%i:%s') AS createDate,a.content,NULL AS comments,a.ACTIVE_FLAG AS activeFlag,(CASE WHEN a.CREATED_BY = {userId} THEN 'true' ELSE 'false' END) AS isAuthor,a.commentedUser AS __ucommentedUser,a.TYPE,a.commentId,a.annotationId FROM bdo_dg.dg_comment a LEFT JOIN bdo_dg.dg_annotation b ON b.autoId = a.annotationId AND a.customerId = b.customerId WHERE b.foreignId = {param1} AND b.type = '{param2}' AND b.auditState = {param4} AND b.customerId = {param6} /*START #param5# AND a.autoId = {param5} #param5# END*/) a 
#\u5B9E\u8D28\u6027\u5E95\u7A3F\u7F16\u5236\uFF0C\u8C03\u6574\u5206\u5F55\uFF0C\u6309\u51ED\u8BC1\u67E5\u8BE2
DG00016=SELECT a.oppSubjectJson,a.autoId,a.indexId,a.accPackageId,a.customerId,a.yyyy,a.voucherId,a.subjectId,a.subjectId,a.reason,a.subjectname1 AS subjectName,CONCAT(a.subjectId,'-',a.subjectfullname1) AS subjectContent,CONCAT(a.assItemId,'-',a.assItemName) AS assitemContent,CONCAT(a.tbSubjectCode,'-',a.adjustSubjectTB) AS adjustSubjectTB,a.adjustSubjectCodeReport,a.adjustSubjectReport,a.summary,a.active_flag,a.dirction,a.occurValue,a.currency,IFNULL(a.currValue,'') AS currValue,a.status,a.assItemId,a.assItemName,a.isEliminate FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.yyyy = {param2} and a.projectId = {param4} AND a.indexId = '{param3}' /*START #param5# AND a.workpaperId = {param5} #param5# END*/ ORDER BY a.accPackageId,a.voucherId,a.subjectId 
# \u5B50\u7A0B\u5E8F\u6570
DG00017=SELECT MAX(a.indexId) AS indexId FROM bdo_dg.dg_auditprogram a WHERE  a.parentId = ? AND a.customerId = ? AND a.level = 1
#\u8BA1\u5212\u6027\u5E95\u7A3F\u7F16\u5236\u5206\u6570\u67E5\u8BE2
#DG00018=SELECT userSubjectId,userSubjectName,plansE,plansC,plansA,plansV,plansP,plancsE,plancsC,plancsA,plancsV,plancsP FROM `dg_subjecttree` WHERE customerId={param1} AND projectId={param2} AND nodeType='{param3}'
# \u6279\u6CE8\u6C47\u603B
DG00019=SELECT a.autoId, a.foreignId, a.indexId, a.content, IFNULL(a.contentText,'') as postilContentText, a.type, a.createUser AS __ucreateUser, a.auditState, a.CREATION_DATE AS createDate, IFNULL(d.nodeName, e.nodeName) AS userSubjectName, c.nodeName AS fileName, a.projectId, a.customerId, a.ACTIVE_FLAG AS activeFlag FROM bdo_dg.dg_annotation a LEFT JOIN bdo_dg.dg_auditprogram b ON b.autoId = a.foreignId AND a.type = '{param1}' AND b.customerId = a.customerId LEFT JOIN bdo_dg.dg_subjecttree c ON c.autoId = a.foreignId AND c.nodeType = 'FILE' AND a.type = '{param2}' AND c.customerId = a.customerId LEFT JOIN bdo_dg.dg_subjecttree d ON d.autoId = b.subjecttreeId AND d.customerId = a.customerId LEFT JOIN bdo_dg.dg_subjecttree e ON e.autoId = c.parentId AND e.customerId = a.customerId WHERE a.customerId = {param6} AND (( b.autoId IS NULL AND c.autoId IS NOT NULL ) OR ( c.autoId IS NULL AND b.autoId IS NOT NULL )) /*START #param3# AND (b.subjecttreeId = {param3} OR c.parentId = '{param3}') #param3# END*/ /*START #param4# AND (d.parentId = '{param4}' OR e.parentId = '{param4}') #param4# END*/ /*START #param5# AND (d.projectId = {param5} OR e.projectId = {param5}) #param5# END*/  
#\u8BA1\u5212\u6027\u5E95\u7A3F\u7F16\u5236\u5206\u6570\u67E5\u8BE2
DG00020=SELECT a.autoId, a.customerId, a.projectId, a.tbSubjectId, CONCAT( a.tbSubjectCode, '-', a.tbSubjectName ) AS tbSubject, a.tbSubjectCode, a.tbSubjectName, CONCAT( a.userSubjectId, '-', a.userSubjectName ) AS userSubject, CONCAT(a.baseSubjectId,'-',a.baseSubjectName) AS baseSubject, a.userSubjectId, a.userSubjectName, a.plansE, a.plansC, a.plansA, a.plansV, a.plansP, a.plancsE, a.plancsC, a.plancsA, a.plancsV, a.plancsP, b.plansE AS subjectScoreE, b.plansC AS subjectScoreC, b.plansA AS subjectScoreA, b.plansV AS subjectScoreV, b.plansP AS subjectScoreP, a.subjectEditors,a.subjectEditors AS __usubjectEditorUser, a.isNeedToAudit, a.notAuditReasons, if(a.tbSubjectCode is null or a.userSubjectId is null or a.baseSubjectId is null, 0, 1) as isEditable, a.remain, a.balance, a.debitTotalOcc, a.creditTotalOcc FROM bdo_dg.dg_tbsubjectcontract a LEFT JOIN bdo_dg.dg_subjecttree b ON b.customerId = {param1} AND b.projectId = {param2} AND b.tbSubjectCode = a.tbSubjectCode AND b.userSubjectId = a.userSubjectId WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.yyyy = {param3} #param3# END*/ /*START #param4# AND a.tbSubjectName = {param4} #param4# END*/ /*START #param5# AND a.isNeedToAudit = {param5} #param5# END*/ /*START #param6# AND a.debitTotalOcc != 0 AND a.creditTotalOcc != 0 #param6# END*/ /*START #param7# AND a.debitTotalOcc = 0 AND a.creditTotalOcc = 0 #param7# END*/ /*START #param10# AND a.subjectEditors = {param10} #param10# END*/ ORDER BY a.userSubjectId, a.tbSubjectId, a.level0
#\u8BA1\u5212\u6027\u5E95\u7A3F\u6811\u67E5\u8BE2
DG00021=SELECT a.autoId, a.customerId, a.parentId, a.projectId, a.subjectId, a.workpaperId, a.indexId, a.nodeName, a.nodeType, a.userSubjectId, a.userSubjectName, a.tbSubjectCode, a.tbSubjectId, a.tbSubjectName, a.sE, a.sC, a.sA, a.sV, a.sP, a.csE, a.csC, a.csA, a.csV, a.csP, a.plansE, a.plansC, a.plansA, a.plansV, a.plansP, a.plancsE, a.plancsC, a.plancsA, a.plancsV, a.plancsP FROM bdo_dg.dg_subjecttree a WHERE a.customerId = {param2} AND a.ACTIVE_FLAG = '1' AND a.projectId = {param1} AND a.nodeType != 'FILE' ORDER BY ( CASE WHEN a.nodeType = 'PROJECT' THEN 0 WHEN a.nodeType = 'IMPL' THEN 1 WHEN a.nodeType = 'RCL' THEN 2 WHEN a.nodeType = 'TBSUBJECT' THEN 3 WHEN a.nodeType = 'SUBJECT' THEN 4 WHEN a.nodeType = 'FILE' THEN 5 END ), a.tbSubjectId, a.tbSubjectCode, a.userSubjectId  
#\u6839\u636E\u5BA2\u6237\u79D1\u76EE\u67E5\u8BE2\u5BF9\u5E94Tb\u79D1\u76EE
DG00022=SELECT CONCAT(tbSubjectCode, '-', tbSubjectName) AS label, CONCAT(reportSubjectId, ':', reportSubjectName, ':', tbSubjectCode) AS VALUE, b.parentSubjectId AS parentSubjectId FROM bdo_dg.dg_customersubject b LEFT JOIN bdo_dg.dg_tbsubjectcontract a ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.yyyy = b.yyyy AND a.userSubjectId = b.subjectId WHERE b.subjectId = {userSubjectId} AND b.customerId = {customerId} AND b.projectId = {projectId} AND b.yyyy = {yyyy}
#\u67E5\u8BE2tb\u79D1\u76EE
DG00023=SELECT a.sortNo AS id, CONCAT(a.tbSubjectId, '-', a.tbSubjectName) AS label, LEFT(a.subjectType1, 1) AS parentid, CONCAT(a.reportSubjectId, ':', a.reportSubjectName, ':', a.tbSubjectId) AS VALUE, 'true' AS leaf,'subject' AS typeName FROM bdo_dg.dg_tbtable a WHERE colType='1' AND customerId = {param14} AND projectId = {param17} /*START #param1# and LEFT(a.subjectType1,1) = '{param1}' #param1# END*/ /*START #param16# and tbSubjectId = '{param16}' #param16# END*/ /*START #param19# and CONCAT(a.tbSubjectName) like '%{param19}%' #param19# END*/ ORDER BY a.sortNo 
#\u6839\u636ETB\u79D1\u76EE\u67E5\u8BE2\u5BF9\u5E94\u5BA2\u6237\u79D1\u76EE
DG00024=SELECT  GROUP_CONCAT(userSubjectId) AS userSubjectId  FROM  bdo_dg.dg_tbsubjectcontract  WHERE customerId = {customerId}    AND projectId = {projectId} AND tbSubjectCode = {tbSubjectId} 
#\u67E5\u8BE2\u5BA2\u6237\u79D1\u76EE
DG00025=SELECT aa.id, aa.label AS NAME, aa.label, aa. VALUE , aa.parentId, aa.leaf  FROM ( SELECT a.subjectId AS id, CONCAT( a.subjectId, '-', a.subjectFullName ) AS label, a.subjectId AS VALUE , IF( a.parentSubjectId = '' OR a.parentSubjectId IS NULL, LEFT(a.subjectId,1), a.parentSubjectId ) AS parentId, IF( a.isLeaf = 0, 'false', 'true' ) AS leaf FROM bdo_dg.dg_customersubject a WHERE a.customerId = {param9} AND a.projectId = {param8} AND a.yyyy = {param10} AND ((a.userDefined = 1 AND a.isLeaf IS NOT NULL) OR a.userDefined = 0)) aa WHERE 1 = 1 AND aa.parentId NOT IN ('42', '41', '40') ORDER BY aa.id, aa.value
#\u67E5\u8BE2\u5BA2\u6237TB\u662F\u5426\u5B58\u5728
DG00026=SELECT 1 FROM bdo_dg.dg_tbtable WHERE customerId = {customerId} AND projectId={projectId}
#\u5408\u5E76\u9879\u76EE--\u8BA1\u5212\u7A0B\u5E8F\u8FDB\u5EA6\u3001\u5B9E\u65BD\u7A0B\u5E8F\u8FDB\u5EA6
DG00027=SELECT ( SELECT COUNT(1) FROM bdo_dg.dg_auditprogram a WHERE a.customerId = ? AND a.projectId = ? AND a.level = 0 AND a.ACTIVE_FLAG = 1 ) AS planNum, ( SELECT COUNT(1) FROM bdo_dg.dg_auditprogram a WHERE a.customerId = ? AND a.projectId = ? AND a.level = 0 ) AS planTotalNum, ( SELECT COUNT(1) FROM bdo_dg.dg_auditprogram a WHERE a.customerId = ? AND a.projectId = ? AND a.level = 1 AND a.auditConclusion IS NOT NULL AND a.auditConclusion <> '' ) AS realNum
#ECAVP\u7EDF\u8BA1\u503C
#DG00028=SELECT * FROM (SELECT a.plansE, a.plansC, a.plansA, a.plansV, a.plansP, a.sE, a.sC, a.sA, a.sV, a.sP, 'PROGRAMP' AS type FROM bdo_dg.dg_subjecttree a WHERE a.autoId = {param1} /*START #param2# AND a.nodeType = '{param2}' #param2# END*/ UNION ALL SELECT a.plansE, a.plansC, a.plansA, a.plansV, a.plansP, 0 AS sE, 0 AS sC, 0 AS sA, 0 AS sV, 0 AS sP, 'SUBJECTP' AS type FROM bdo_dg.dg_tbsubjectcontract a WHERE a.customerId = {param3} AND a.projectId = {param4} /*START #param5# and a.tbSubjectName = '{param5}' #param5# END*/ /*START #param6# and a.userSubjectId = '{param6}' #param6# END*/ /*START #param7# and a.userSubjectName = '{param7}' #param7# END*/ /*START #param8# AND a.yyyy = {param8} #param8# END*/ /*START #param9# and a.tbSubjectCode = '{param9}' #param9# END*/ ) a
DG00028=SELECT * FROM ( SELECT a.plansE, a.plansC, a.plansA, a.plansV, a.plansP, a.sE, a.sC, a.sA, a.sV, a.sP, 'PROGRAMP' AS type FROM bdo_dg.dg_subjecttree a WHERE a.autoId = {param1} /*START #param2# AND a.nodeType = '{param2}' #param2# END*/ UNION ALL SELECT a.plansE, a.plansC, a.plansA, a.plansV, a.plansP, 0 AS sE, 0 AS sC, 0 AS sA, 0 AS sV, 0 AS sP, 'SUBJECTP' AS type FROM bdo_dg.dg_tbsubjectcontract a WHERE a.customerId = {param3} AND a.projectId = {param4} /*START #param5# and a.tbSubjectName = '{param5}' #param5# END*/ /*START #param6# and a.userSubjectId = '{param6}' #param6# END*/ /*START #param7# and a.userSubjectName = '{param7}' #param7# END*/ /*START #param8# AND a.yyyy = {param8} #param8# END*/ /*START #param9# and a.tbSubjectCode = '{param9}' #param9# END*/ UNION ALL SELECT a.plansE, a.plansC, a.plansA, a.plansV, a.plansP, 0 AS sE, 0 AS sC, 0 AS sA, 0 AS sV, 0 AS sP, 'SUBJECTP' AS type FROM bdo_dg.dg_othersubjectcontract a WHERE a.customerId = {param3} AND a.projectId = {param4} /*START #param5# and a.tbSubjectName = '{param5}' #param5# END*/ /*START #param6# and a.userSubjectId = '{param6}' #param6# END*/ /*START #param7# and a.userSubjectName = '{param7}' #param7# END*/ /*START #param8# AND a.yyyy = {param8} #param8# END*/ /*START #param9# and a.tbSubjectCode = '{param9}' #param9# END*/ ) a
#\u81EA\u5B9A\u4E49\u7A0B\u5E8F\u6570
DG00029=SELECT MAX(a.indexId) AS indexId FROM bdo_dg.dg_auditprogram a WHERE a.projectId = ? AND a.customerId = ? AND a.customizeFlag = 1 AND a.level = 0
#\u67E5\u8BE2\u5E95\u7A3F\u6811\uFF0C\u5BF9\u5E94\u5E95\u7A3F
DG00030=SELECT GROUP_CONCAT(workpaperId) AS workpaperId FROM bdo_dg.dg_subjecttree t1 INNER JOIN (SELECT userSubjectId FROM bdo_dg.dg_subjecttree WHERE 1=1  /*START #param4# AND autoId = '{param4}' #param4# END*/ /*START #param5# AND parentId = '{param5}' #param5# END*/ ) t2 ON t1.userSubjectId = t2.userSubjectId WHERE customerId = {param1} AND projectId = {param2} AND nodeType = 'FILE' 
#\u5E95\u7A3F\u8282\u70B9\u4FE1\u606F
DG00031=SELECT a.autoId, a.customerId, a.parentId, a.projectId, a.subjectId, a.workpaperId, a.indexId, a.nodeName, a.nodeType, a.userSubjectId, a.userSubjectName, a.tbSubjectId, a.tbSubjectName, a.sE, a.sC, a.sA, a.sV, a.sP, a.csE, a.csC, a.csA, a.csV, a.csP, a.plansE, a.plansC, a.plansA, a.plansV, a.plansP, a.plancsE, a.plancsC, a.plancsA, a.plancsV, a.plancsP FROM bdo_dg.dg_subjecttree a LEFT JOIN bdo_dg.dg_annotation b ON b.autoId = {param1} AND b.foreignId = {param2} AND b.type = 'P001' WHERE a.autoId = {param2} AND b.type = '{param3}' UNION ALL SELECT a.autoId, a.customerId, a.parentId, a.projectId, a.subjectId, a.workpaperId, a.indexId, a.nodeName, a.nodeType, a.userSubjectId, a.userSubjectName, a.tbSubjectId, a.tbSubjectName, a.sE, a.sC, a.sA, a.sV, a.sP, a.csE, a.csC, a.csA, a.csV, a.csP, a.plansE, a.plansC, a.plansA, a.plansV, a.plansP, a.plancsE, a.plancsC, a.plancsA, a.plancsV, a.plancsP FROM bdo_dg.dg_subjecttree a LEFT JOIN bdo_dg.dg_auditprogram ap ON ap.subjecttreeId = a.parentId AND ap.workpaperId = a.workpaperId LEFT JOIN bdo_dg.dg_annotation b ON b.autoId = {param1} AND b.foreignId = {param2} AND b.type = 'P002' WHERE ap.autoId = {param2} AND b.type = '{param3}'
#\u67E5\u8BE2\u6807\u51C6\u79D1\u76EE
DG00032=SELECT a.autoId AS id,a.SubjectId AS subjectId,a.SubjectName AS subjectName, CONCAT(a.SubjectId, '-', a.SubjectName) AS label, a.parentId AS parentid, CONCAT(a.SubjectId, '-', a.SubjectName) AS VALUE, /*IF(a.isLeaf = 0, 'false', 'true')*/ 'true' AS leaf,'subject' AS typeName FROM asdb.k_subject a WHERE a.ACTIVE_FLAG=1 /*START #param18# AND parentId IS {param18} #param18# END*/ /*START #param2# AND parentId='{param2}' #param2# END*/ /*START #param19# and CONCAT(SubjectName) like '%{param19}%' #param19# END*/ ORDER BY a.SubjectId
#\u67E5\u8BE2\u5E95\u7A3F\u8D44\u6599\u6587\u4EF6\u76EE\u5F55
DG00033=SELECT DISTINCT a.autoId AS id, a.fileName AS label, a.parentId, IF( '{param13}' = '1', IF(a.lowerState = '1', 'false', 'true'), IF(a.fileType = '01', 'false', 'true') ) AS leaf, a.autoId AS value, 'dgfs' AS typeName FROM bdo_dg.dg_rcfilesystem a WHERE a.ACTIVE_FLAG = '1' AND a.customerId = {param22} AND a.projectId = {param23} /*START #param12# AND a.fileType = '01' #param12# END*/ /*START #param1# AND a.parentId = '{param1}' #param1# END*/ /*START #param20# AND a.parentId = '{param20}' #param20# END*/ /*START #param21# AND a.depth = {param21} #param21# END*/ /*START #param11# AND a.autoId != {param11} #param11# END*/ /*START #param18# AND a.autoId IN ({param18}) #param18# END*/ 
#\u67E5\u8BE2\u5E95\u7A3F\u8D44\u6599\u6587\u4EF6
DG00034=SELECT a.autoId, a.parentId, a.fileIndexId, a.fileName, a.lowerState, a.depth, a.fileType, a.fileTypeName, a.suffix, a.fullPath, a.LAST_UPDATED_BY AS __ulastUpdateUser, a.LAST_UPDATE_DATE AS lastUpdateDate FROM bdo_dg.dg_rcfilesystem a WHERE a.ACTIVE_FLAG = '1' AND a.customerId = {param2} AND a.projectId = {param3} /*START #param1# AND a.parentId = '{param1}' AND a.depth > 0 #param1# END*/
#\u67E5\u8BE2\u8BA4\u5B9A\u5206\u6570\u4E2A\u6570--\u5408\u5E76
DG00035=SELECT IF( totalCount = 0, 0, ROUND(hasSetCount / totalCount * 100, 2) ) res FROM  (SELECT SUM(b.totalCount) as totalCount, SUM(b.hasSetCount) as hasSetCount FROM  (SELECT COUNT(1) AS totalCount, SUM(IF(a.subjectEditors > '', 1, 0)) AS hasSetCount  FROM bdo_dg.dg_tbsubjectcontract a WHERE a.customerId = ? AND a.projectId = ? AND a.yyyy = ? and a.isNeedToAudit = '1' /*AND a.debitTotalOcc != 0 AND a.creditTotalOcc != 0*/ UNION ALL SELECT COUNT(1) AS totalCount, SUM( IF( IF(a.plancsE = '1' AND a.plansE > 0, 1, 0) + IF(a.plancsC = '1' AND a.plansC > 0, 1, 0) + IF(a.plancsA = '1' AND a.plansA > 0, 1, 0) + IF(a.plancsV = '1' AND a.plansV > 0, 1, 0) + IF(a.plancsP = '1' AND a.plansP > 0, 1, 0) > 0, if(a.subjectEditors > '', 1, 0), 0 ) ) AS hasSetCount FROM bdo_dg.dg_othersubjectcontract a WHERE a.customerId = ? AND a.projectId = ? AND a.yyyy = ? and a.isNeedToAudit = '1') b) a 
#\u67E5\u8BE2\u5BF9\u7167TB\u79D1\u76EE
DG00036=SELECT a.autoId AS id, CONCAT(a.tbSubjectId, '-', a.tbSubjectName) AS label, LEFT(a.subjectType1, 1) AS parentid, CONCAT(a.tbSubjectId, '-', a.tbSubjectName) AS VALUE, 'true' AS leaf,'subject' AS typeName FROM bdo_dg.dg_projectTb a WHERE customerId = {param14} AND projectId = {param17} AND a.isSubject=1 /*START #param1# and LEFT(a.subjectType1,1) = '{param1}' #param1# END*/ /*START #param19# and CONCAT(a.tbSubjectName) like '%{param19}%' #param19# END*/  ORDER BY a.sortNo 
#\u67E5\u627E\u5E95\u7A3F\u79D1\u76EE\u6811\uFF08\u5B9E\u8D28\u6027\uFF09
DG00037=SELECT a.autoId, a.customerId, a.parentId, a.projectId, a.subjectId, a.workpaperId, a.indexId, a.nodeName, a.nodeType, a.userSubjectId, a.userSubjectName, a.tbSubjectCode, a.tbSubjectId, a.tbSubjectName, a.sE, a.sC, a.sA, a.sV, a.sP, a.csE, a.csC, a.csA, a.csV, a.csP, a.plansE, a.plansC, a.plansA, a.plansV, a.plansP, a.plancsE, a.plancsC, a.plancsA, a.plancsV, a.plancsP FROM bdo_dg.dg_subjecttree a WHERE a.ACTIVE_FLAG = '1' AND a.projectId = {param1} AND a.customerId = {param2} ORDER BY ( CASE WHEN a.nodeType = 'PROJECT' THEN 0 WHEN a.nodeType = 'IMPL' THEN 1 WHEN a.nodeType = 'RCL' THEN 2 WHEN a.nodeType = 'TBSUBJECT' THEN 3 WHEN a.nodeType = 'SUBJECT' THEN 4 WHEN a.nodeType = 'FILE' THEN 5 END ), a.tbSubjectId, a.tbSubjectCode, a.userSubjectId
#\u67E5\u8BE2\u8C03\u6574\u6700\u5927\u7D22\u5F15\u53F7
DG00038=SELECT Max(CAST(RIGHT(indexId,4) AS SIGNED)) AS maxIndex FROM bdo_dg.dg_subjectentryadjust WHERE customerId = '{param1}' AND projectId = '{param2}' AND adjustType = '{param4}' 
#\u67E5\u8BE2\u5BA2\u6237\u79D1\u76EE\u5217\u8868
DG00039=select autoId,subjectId,subjectFullName as subjectName,projectId from bdo_dg.dg_customersubject where customerId={param1} and projectId={param2} and yyyy={param3} and isLeaf=1 
#\u9879\u76EE\u72B6\u6001
DG00040=SELECT a.autoId, a.projectId, a.customerId, a.State, a.Weight, a.AuditUser, a.AuditUser AS __uAuditUser, a.prefix, a.auditStatu, b.isNeedReport FROM ( SELECT a.autoId, a.projectId, a.customerId, a.materialityState AS State, a.materialityStateWeight AS Weight, a.materialityAuditUser AS AuditUser, 'materiality' AS prefix, a.auditStatu FROM bdo_dg.dg_project a WHERE a.projectId = {param1} AND a.customerId = {param2} UNION ALL SELECT a.autoId, a.projectId, a.customerId, a.trialBalanceState AS State, a.trialBalanceStateWeight AS Weight, a.trialBalanceAuditUser AS AuditUser, 'trialBalance' AS prefix, a.auditStatu FROM bdo_dg.dg_project a WHERE a.projectId = {param1} AND a.customerId = {param2} UNION ALL SELECT a.autoId, a.projectId, a.customerId, a.unauditedState AS State, a.unauditedStateWeight AS Weight, a.unauditedAuditUser AS AuditUser, 'unaudited' AS prefix, a.auditStatu FROM bdo_dg.dg_project a WHERE a.projectId = {param1} AND a.customerId = {param2} UNION ALL SELECT a.autoId, a.projectId, a.customerId, a.analysisReviewState AS State, a.analysisReviewStateWeight AS Weight, a.analysisReviewAuditUser AS AuditUser, 'analysisReview' AS prefix, a.auditStatu FROM bdo_dg.dg_project a WHERE a.projectId = {param1} AND a.customerId = {param2} UNION ALL SELECT a.autoId, a.projectId, a.customerId, a.identifiedState AS State, a.identifiedStateWeight AS Weight, a.identifiedAuditUser AS AuditUser, 'identified' AS prefix, a.auditStatu FROM bdo_dg.dg_project a WHERE a.projectId = {param1} AND a.customerId = {param2} UNION ALL SELECT a.autoId, a.projectId, a.customerId, a.programPlanState AS State, a.programPlanStateWeight AS Weight, a.programPlanAuditUser AS AuditUser, 'programPlan' AS prefix, a.auditStatu FROM bdo_dg.dg_project a WHERE a.projectId = {param1} AND a.customerId = {param2} UNION ALL SELECT a.autoId, a.projectId, a.customerId, a.programState AS State, a.programStateWeight AS Weight, a.programAuditUser AS AuditUser, 'program' AS prefix, a.auditStatu FROM bdo_dg.dg_project a WHERE a.projectId = {param1} AND a.customerId = {param2} UNION ALL SELECT a.autoId, a.projectId, a.customerId, a.samplingState AS State, a.samplingStateWeight AS Weight, a.samplingAuditUser AS AuditUser, 'sampling' AS prefix, a.auditStatu FROM bdo_dg.dg_project a WHERE a.projectId = {param1} AND a.customerId = {param2} UNION ALL SELECT a.autoId, a.projectId, a.customerId, a.clearQuestionState AS State, a.clearQuestionStateWeight AS Weight, a.clearQuestionAuditUser AS AuditUser, 'clearQuestion' AS prefix, a.auditStatu FROM bdo_dg.dg_project a WHERE a.projectId = {param1} AND a.customerId = {param2} UNION ALL SELECT a.autoId, a.projectId, a.customerId, a.auditedState AS State, a.auditedStateWeight AS Weight, a.auditedAuditUser AS AuditUser, 'audited' AS prefix, a.auditStatu FROM bdo_dg.dg_project a WHERE a.projectId = {param1} AND a.customerId = {param2} UNION ALL SELECT a.autoId, a.projectId, a.customerId, a.finalAnalysisReviewState AS State, a.finalAnalysisReviewStateWeight AS Weight, a.finalAnalysisReviewAuditUser AS AuditUser, 'finalAnalysisReview' AS prefix, a.auditStatu FROM bdo_dg.dg_project a WHERE a.projectId = {param1} AND a.customerId = {param2} UNION ALL SELECT a.autoId, a.projectId, a.customerId, a.noteinfoState AS State, a.noteinfoStateWeight AS Weight, a.noteinfoAuditUser AS AuditUser, 'noteinfo' AS prefix, a.auditStatu FROM bdo_dg.dg_project a WHERE a.projectId = {param1} AND a.customerId = {param2} UNION ALL SELECT a.autoId, a.projectId, a.customerId, a.reportState AS State, a.reportStateWeight AS Weight, a.reportAuditUser AS AuditUser, 'report' AS prefix, a.auditStatu FROM bdo_dg.dg_project a WHERE a.projectId = {param1} AND a.customerId = {param2} UNION ALL SELECT a.autoId, a.projectId, a.customerId, a.bbReportState AS State, a.bbReportStateWeight AS Weight, a.bbReportAuditUser AS AuditUser, 'bbReport' AS prefix, a.auditStatu FROM bdo_dg.dg_project a WHERE a.projectId = {param1} AND a.customerId = {param2} ) a left join bdo_dg.dg_projectext b on a.customerId = b.customerId and a.projectId = b.projectId
#\u9879\u76EE\u91CD\u7F6E\u72B6\u6001
DG00041=SELECT isResetNow FROM bdo_dg.dg_project where projectId=? 
#\u67E5\u8BE2\u6240\u6709\u79D1\u76EE\u5BF9\u7167
DG00042=SELECT CONCAT(tbSubjectCode,'-',tbSubjectName) AS label,CONCAT(reportSubjectId,':',reportSubjectName,':',tbSubjectCode) AS VALUE,t1.parentSubjectId AS parentSubjectId,t1.subjectName,t1.subjectId AS subjectId FROM bdo_dg.dg_customersubject t1 LEFT JOIN bdo_dg.dg_tbsubjectcontract t2 ON t1.customerId = t2.customerId AND t1.projectId = t2.projectId AND t1.subjectId = t2.userSubjectId and t1.yyyy = t2.yyyy WHERE t1.customerId = {customerId} AND t1.projectId = {projectId} AND t1.yyyy = {year} 
#DG00042=SELECT CONCAT( tbSubjectCode, '-', tbSubjectName ) AS label, CONCAT( reportSubjectId, ':', reportSubjectName, ':', tbSubjectCode ) AS VALUE, t1.parentSubjectId AS parentSubjectId, t1.subjectName, t1.subjectId AS subjectId FROM  bdo_dg.dg_tbsubjectcontract t2 LEFT JOIN dg_customersubject t1 ON t1.customerId = t2.customerId AND t1.projectId = t2.projectId AND t1.subjectId = t2.userSubjectId WHERE t2.customerId = {customerId} AND t2.projectId = {projectId} AND t2.yyyy = {year}
#\u67E5\u8BE2\u6700\u5927\u7D22\u5F15\u53F7
DG00043=SELECT Max(CAST(RIGHT(indexId,4) AS SIGNED) + 1) AS maxIndex FROM bdo_dg.dg_subjectentryadjust WHERE customerId = {param1} AND projectId = {param2} AND yyyy = {param3} AND adjustType = {param4} AND LEFT(indexId,LENGTH({param5})) ={param5} 
#\u67E5\u8BE2\u7D22\u5F15\u53F7
DG00044=SELECT autoId,customerId,projectId,indexId FROM bdo_dg.dg_subjecttree WHERE customerId={param1} AND projectId={param2} AND nodeType='FILE' ORDER BY indexId 
#\u67E5\u8BE2\u5E95\u7A3F\u6811\u6709\u65E0\u6B64\u7D22\u5F15\u53F7
DG00045=SELECT workpaperId,nodeName,userSubjectId FROM bdo_dg.dg_subjecttree WHERE indexId={indexId} AND customerId = {customerId} AND projectId = {projectId} limit 1 
#\u67E5\u8BE2\u5E95\u7A3F\u538B\u7F29\u6587\u4EF6
DG00046=SELECT a.autoId,a.customerId,a.projectId,a.fileName,a.size,a.CREATED_BY AS __ucreateUser,a.CREATION_DATE AS createDate FROM bdo_dg.dg_workpaperbackup a WHERE a.customerId = {param1} AND a.projectId = {param2} order by a.CREATION_DATE DESC 
#\u5E95\u7A3F\u64CD\u4F5C\u8BB0\u5F55
DG00047=SELECT a.autoId, a.projectId, a.customerId, a.operateUser, a.operateUserName, a.CREATION_DATE AS createDate, a.state, a.message, a.actionType, a.actionName FROM bdo_dg.dg_operatelog a WHERE a.projectId = {param1} AND a.customerId = {param2} ORDER BY a.autoId DESC
#\u67E5\u8BE2\u9879\u76EE\u63A7\u5236\u8868\u4FE1\u606F
DG00048=SELECT a.autoId, a.projectId, a.customerId, a.projectName, a.customerName, a.year, a.reportFormat, a.tbTemplate, a.tbReportTemplate FROM bdo_dg.dg_project a WHERE a.projectId = {param1} AND a.customerId = {param2}
#\u67E5\u8BE2\u5E95\u7A3F\u6811\u5355\u6761\u4FE1\u606F
DG00049=SELECT autoId,customerId,projectId,indexId,nodeName,nodeType,userSubjectId,userSubjectName,tbSubjectId,tbSubjectName FROM bdo_dg.dg_subjecttree WHERE customerId={param1} AND projectId={param2} AND nodeType='SUBJECT' AND userSubjectId='{param3}' AND userSubjectName='{param4}' 
#\u67E5\u8BE2\u8BA4\u5B9A\u5206\u6570\u4E2A\u6570
DG00050=SELECT IF( totalCount = 0, 0, ROUND(hasSetCount / totalCount * 100, 2) ) res FROM  (SELECT SUM(b.totalCount) as totalCount, SUM(b.hasSetCount) as hasSetCount FROM  (SELECT COUNT(1) AS totalCount, SUM( IF( IF(a.plancsE = '1' AND a.plansE > 0, 1, 0) + IF(a.plancsC = '1' AND a.plansC > 0, 1, 0) + IF(a.plancsA = '1' AND a.plansA > 0, 1, 0) + IF(a.plancsV = '1' AND a.plansV > 0, 1, 0) + IF(a.plancsP = '1' AND a.plansP > 0, 1, 0) > 0, if(a.subjectEditors > '', 1, 0), 0 ) ) AS hasSetCount FROM bdo_dg.dg_tbsubjectcontract a WHERE a.customerId = ? AND a.projectId = ? AND a.yyyy = ? and a.isNeedToAudit = '1' /*AND a.debitTotalOcc != 0 AND a.creditTotalOcc != 0*/ UNION ALL SELECT COUNT(1) AS totalCount, SUM( IF( IF(a.plancsE = '1' AND a.plansE > 0, 1, 0) + IF(a.plancsC = '1' AND a.plansC > 0, 1, 0) + IF(a.plancsA = '1' AND a.plansA > 0, 1, 0) + IF(a.plancsV = '1' AND a.plansV > 0, 1, 0) + IF(a.plancsP = '1' AND a.plansP > 0, 1, 0) > 0, if(a.subjectEditors > '', 1, 0), 0 ) ) AS hasSetCount FROM bdo_dg.dg_othersubjectcontract a WHERE a.customerId = ? AND a.projectId = ? AND a.yyyy = ? and a.isNeedToAudit = '1') b) a 
#\u67E5\u8BE2\u8BA1\u5212\u548C\u5B9E\u65BD\u7A0B\u5E8F\u8BA4\u5B9A\u5206\u503C
DG00051=SELECT autoId,IFNULL(plansE,0) AS plansE,IFNULL(plansC,0) AS plansC,IFNULL(plansA,0) AS plansA,IFNULL(plansV,0) AS plansV,IFNULL(plansP,0) AS plansP,IFNULL(sE,0) AS sE,IFNULL(sC,0) AS sC,IFNULL(sA,0) AS sA,IFNULL(sV,0) AS sV,IFNULL(sP,0) AS sP FROM bdo_dg.dg_subjecttree WHERE customerId = ? AND projectId = ? AND nodeType = 'PROJECT' 
#\u67E5\u8BE2\u79D1\u76EE\u8BA4\u5B9A\u5206\u503C
DG00052=SELECT IFNULL(SUM(a.plansE),0) AS plansE,IFNULL(SUM(a.plansC),0) AS plansC,IFNULL(SUM(a.plansA),0) AS plansA,IFNULL(SUM(a.plansV),0) AS plansV,IFNULL(SUM(a.plansP),0) AS plansP from (SELECT IFNULL(SUM(plansE),0) AS plansE,IFNULL(SUM(plansC),0) AS plansC,IFNULL(SUM(plansA),0) AS plansA,IFNULL(SUM(plansV),0) AS plansV,IFNULL(SUM(plansP),0) AS plansP FROM bdo_dg.dg_tbsubjectcontract WHERE customerId = ? AND projectId = ? AND yyyy = ? UNION SELECT IFNULL(SUM(plansE),0) AS plansE,IFNULL(SUM(plansC),0) AS plansC,IFNULL(SUM(plansA),0) AS plansA,IFNULL(SUM(plansV),0) AS plansV,IFNULL(SUM(plansP),0) AS plansP FROM bdo_dg.dg_othersubjectcontract WHERE customerId = ? AND projectId = ? AND yyyy = ?) a 
#\u67E5\u8BE2\u9879\u76EE\u5237\u65B0\u5BF9\u7167\u540E\u7684tb\u79D1\u76EE
DG00053=SELECT MAX(autoId) AS tbId,tbsubjectName AS tbSubjectName,tbSubjectId AS subjectCode,isSubject,calFun,reportSubjectId,reportSubjectName,LEFT(subjectType1,1) AS subjectType1,IF(LENGTH(subjectType1) >= 3,LEFT(subjectType1,3),'') AS subjectType2,sortNo FROM bdo_dg.dg_projecttb WHERE projectId = {projectId} AND customerId = {customerId} GROUP BY tbSubjectId,tbsubjectName 
#\u67E5\u8BE2\u79D1\u76EE\u8BA4\u5B9A\u5206\u503C
DG00054=SELECT SUM(a.plansE) AS plansE, SUM(a.plansC) AS plansC, SUM(a.plansA) AS plansA, SUM(a.plansV) AS plansV, SUM(a.plansP) AS plansP FROM ( SELECT IFNULL(SUM(a.plansE), 0) AS plansE, IFNULL(SUM(a.plansC), 0) AS plansC, IFNULL(SUM(a.plansA), 0) AS plansA, IFNULL(SUM(a.plansV), 0) AS plansV, IFNULL(SUM(a.plansP), 0) AS plansP FROM bdo_dg.dg_tbsubjectcontract a WHERE a.customerId = ? AND a.projectId =? AND a.yyyy = ? AND a.isNeedToAudit = 1 UNION ALL SELECT IFNULL(SUM(a.plansE), 0) AS plansE, IFNULL(SUM(a.plansC), 0) AS plansC, IFNULL(SUM(a.plansA), 0) AS plansA, IFNULL(SUM(a.plansV), 0) AS plansV, IFNULL(SUM(a.plansP), 0) AS plansP FROM bdo_dg.dg_othersubjectcontract a WHERE a.customerId = ? AND a.projectId = ? AND a.yyyy = ? AND a.isNeedToAudit = 1 ) a
#\u67E5\u8BE2\u6A21\u677F\u5DE5\u5177\u5E93\u6587\u4EF6\u76EE\u5F55
DG00055=SELECT DISTINCT a.autoId AS id, a.fileName AS label, a.parentId, IF( '{param13}' = '1', IF(a.lowerState = '1', 'false', 'true'), IF(a.fileType = '01', 'false', 'true') ) AS leaf, a.autoId AS value, 'dgfs' AS typeName FROM asdb.k_templatelibrary a WHERE a.ACTIVE_FLAG = '1'  /*START #param12# AND a.fileType = '01' #param12# END*/ /*START #param1# AND a.parentId = '{param1}' #param1# END*/ /*START #param20# AND a.parentId = '{param20}' #param20# END*/ /*START #param21# AND a.depth = {param21} #param21# END*/ /*START #param11# AND a.autoId != {param11} #param11# END*/ /*START #param18# AND a.autoId IN ({param18}) #param18# END*/
#\u67E5\u8BE2\u6A21\u677F\u5DE5\u5177\u5E93\u6587\u4EF6\u8D44\u6599
DG00056=SELECT a.autoId, a.parentId, a.fileIndexId, a.fileName, a.lowerState, a.depth, a.fileType, a.fileTypeName, a.suffix, a.fullPath, a.LAST_UPDATED_BY AS __ulastUpdateUser, a.LAST_UPDATE_DATE AS lastUpdateDate FROM asdb.k_templatelibrary a WHERE a.ACTIVE_FLAG = '1'  /*START #param1# AND a.parentId = '{param1}' AND a.depth > 0 #param1# END*/
#\u67E5\u8BE2\u624B\u52A8\u6DFB\u52A0\u7684TB\u79D1\u76EE
DG00057=SELECT t.direction,t.autoId,t.vocationId,t.customerId,t.projectId,t.departmentId,t.tbSubjectId,t.tbSubjectName,t.reportSubjectId,t.reportSubjectName,t.subjectType1,t.sortNo,t.userDefined,IFNULL(t.calFun,"") AS calFun,t.isSubject,t.ACTIVE_FLAG FROM bdo_dg.dg_projecttb AS t WHERE t.customerId = '{param1}' AND t.projectId = '{param2}' ORDER BY t.sortNo 
#\u67E5\u8BE2\u624B\u52A8\u6DFB\u52A0\u7684\u8D22\u52A1\u79D1\u76EE
DG00058=SELECT a.subjectId AS id, CONCAT( a.subjectId, '-', a.subjectFullName ) AS label, a.subjectId AS VALUE, '' AS parentId, IF(a.isLeaf = 0, 'false', 'true') AS leaf FROM bdo_dg.dg_customersubject a WHERE a.customerId = {param9} AND projectId = {param8} AND a.yyyy = {param10} AND a.userdefined = '1' AND a.parentSubjectId = ''
#\u6839\u636EHRID\u67E5\u627EuserId
DG00059=SELECT GROUP_CONCAT( a.id ) AS ids FROM bdo_base.base_user a WHERE a.hrId IN ({hrIds})
#\u6839\u636EuserId\u83B7\u53D6\u7528\u6237\u4FE1\u606F
DG00060=SELECT a.id, a.name FROM bdo_base.base_user a WHERE a.id IN ({userIds})
#\u6839\u636E\u83B7\u53D6\u9879\u76EE\u4FE1\u606F
DG00061=SELECT a.autoId, a.customerId, a.customerName, a.projectId, a.projectName, a.finalResults, a.year, a.progressRate, a.preId, a.preProjectId, a.preProjectName, a.preCustomerId, a.preYear, a.auditTimeBegin, a.auditTimeEnd, a.reportFormat, a.tbTemplate, b.tbTemplateName, a.tbReportTemplate, c.ruleName AS tbReportTemplateName, a.materialityState, a.materialityStateWeight, a.materialityAuditUser, a.trialBalanceState, a.trialBalanceStateWeight, a.trialBalanceAuditUser, a.unauditedState, a.unauditedStateWeight, a.unauditedAuditUser, a.auditedState, a.auditedStateWeight, a.auditedAuditUser, a.identifiedState, a.identifiedStateWeight, a.identifiedAuditUser, a.programPlanState, a.programPlanStateWeight, a.programPlanAuditUser, a.programState, a.programStateWeight, a.programAuditUser, a.clearQuestionState, a.clearQuestionStateWeight, a.clearQuestionAuditUser, a.noteinfoState, a.noteinfoStateWeight, a.noteinfoAuditUser, a.reportState, a.reportStateWeight, a.reportAuditUser, a.analysisReviewState, a.analysisReviewStateWeight, a.analysisReviewAuditUser, a.finalAnalysisReviewState, a.finalAnalysisReviewStateWeight, a.finalAnalysisReviewAuditUser, a.bbReportState, a.bbReportStateWeight, a.bbReportAuditUser, a.samplingState, a.samplingStateWeight, a.samplingAuditUser, a.isResetNow, a.manager, a.manager AS __umanager, a.signUser, a.signUser AS __usignUser, a.audit1, a.audit1 AS __uaudit1, DATE_FORMAT(b.audit1Date, '%Y-%m-%d %T') AS audit1Date, a.audit2, a.audit2 AS __uaudit2, DATE_FORMAT(b.audit2Date, '%Y-%m-%d %T') AS audit2Date, a.members, a.membersId, a.auditStatu, a.projectState, a.financeReportType, CASE WHEN a.financeReportType = '0' THEN '\u5355\u4F53' WHEN a.financeReportType = '1' THEN '\u5408\u5E76' END AS financeReportTypeStr, a.projectIdMerge, a.projectIdMergeText, a.signAccountant2, a.signAccountant2 AS __usignAccountant2, DATE_FORMAT( b.signAccountant2Date, '%Y-%m-%d %T' ) AS signAccountant2Date, a.signAccountant3, a.signAccountant3 AS __usignAccountant3, DATE_FORMAT( b.signAccountant3Date, '%Y-%m-%d %T' ) AS signAccountant3Date, a.reviewPartner, a.reviewPartner AS __ureviewPartner, DATE_FORMAT( b.reviewPartnerDate, '%Y-%m-%d %T' ) AS reviewPartnerDate, a.reaReviewer, a.reaReviewer AS __ureaReviewer, DATE_FORMAT( b.reaReviewerDate, '%Y-%m-%d %T' ) AS reaReviewerDate, a.issuedPeople, a.issuedPeople AS __uissuedPeople, DATE_FORMAT( b.issuedPeopleDate, '%Y-%m-%d %T' ) AS issuedPeopleDate, b.quoteReport, b.quoteTb, b.quoteIdentified, b.quoteProgram, b.endMonth, b.tbEditer, b.tbEditer AS __utbEditer, b.unReportEditer, b.unReportEditer AS __uunReportEditer, b.cashFlowEditer, b.cashFlowEditer AS __ucashFlowEditer, DATE_FORMAT( b.projectStartDate, '%Y-%m-%d' ) AS projectStartDate, DATE_FORMAT( b.projectEndDate, '%Y-%m-%d' ) AS projectEndDate, b.auditPolicyFileId, ( CASE WHEN ( ISNULL(b.industrycategory) = 1 ) || ( LENGTH(TRIM(b.industrycategory)) = 0 ) THEN b.industryclassification ELSE b.industrycategory END ) AS projectIndustry, ( CASE WHEN ( ISNULL(b.industrycategorycode) = 1 ) || ( LENGTH( TRIM(b.industrycategorycode)) = 0 ) THEN CONCAT( UPPER( b.industryclassificationcode ), '-GB' ) ELSE CONCAT( UPPER( b.industryclassificationcode ), b.industrycategorycode, '-GB' ) END ) AS industry, b.mergeType, b.projectUserablePlate, a.projectType, b.auditProgramRuleAccId, b.isNeedReport FROM bdo_dg.dg_project a LEFT JOIN bdo_dg.dg_projectext b ON a.customerId = b.customerId AND a.projectId = b.projectId LEFT JOIN asdb.k_ruleacc c ON a.tbReportTemplate = c.autoId WHERE a.projectId = {param1} AND a.customerId = {param2}
#\u5E95\u7A3F\u6811\u8282\u70B9\u9644\u4EF6
DG00062=SELECT a.autoId, a.customerId, a.projectId, a.fileIndexId, a.fileName, a.fileType, a.suffix, a.fullPath, a.uploadDate, a.subjectTreeId, a.CREATED_BY as __uuploadUser, a.sortNum FROM bdo_dg.dg_file a WHERE a.customerId = {param1} AND a.subjectTreeId = {param2} /*START #param3# AND a.autoId = {param3} #param3# END*/ ORDER BY a.sortNum
#\u6839\u636E\u90E8\u95E8\u67E5\u627E\u5BA1\u8BA1\u90E8\u95E8\u4E00\u89C8
DG00063=SELECT DISTINCT a.autoId, a.subjectId, a.departmentId, a.departmentId AS __ddepartmentId, b.name, a.programName, a.indexId, a.dgName, a.subjectName, a.confirmStatus, a.confirmStatusName, a.potentialRisk, a.stage, a.stageName, a.allIndustryFlag, a.industry, a.industryName, a.description, a.required, a.createUser AS __ucreateUser, IFNULL(a.useCount, 0) AS useCount, a.csE, a.csC, a.csA, a.csV, a.csP, a.sE, a.sC, a.sA, a.sV, a.sP, tpl.fullPath, a.userablePlate, a.allUserablePlateFlag, a.ifOtherSubject, a.ACTIVE_FLAG /*START #param4# ,apc.autoId as customizeId #param4# END*/ FROM asdb.k_auditprogram a LEFT JOIN bdo_base.base_company b ON a.departmentId = b.id LEFT JOIN asdb.k_auditprogramtpl tpl ON a.autoId = tpl.auditprogramId /*START #param4# LEFT JOIN asdb.k_auditprogramcustomize apc ON a.autoId = apc.auditprogramId and apc.templateId = {param4} #param4# END*/ WHERE 1 = 1 /*START #param1# AND a.departmentId IN ({param1}) #param1# END*/ /*START #param2# AND a.ACTIVE_FLAG = '{param2}' #param2# END*/
#\u5BA1\u5B9A\u62A5\u8868\u67E5\u8BE2
DG00064=SELECT a.columnName,a.finallyChangeReason, a.contrastStatus, a.colType, a.colCode, a.colDisp, a.adjustedAmount, a.adjustedRemain, IFNULL(b.occurValue, 0) AS adjustAmount, IFNULL(b2.occurValue, 0) AS adjustRemain, CASE a.contrastStatus WHEN 1 THEN IFNULL((a.adjustedAmount + IFNULL(b.occurValue, 0)), 0) ELSE NULL END AS auditedAmount,CASE a.contrastStatus WHEN 1 THEN IFNULL((a.adjustedRemain + IFNULL(b2.occurValue, 0)), 0) ELSE  NULL END AS auditedRemain, tableDiv FROM bdo_dg.dg_unauditreport a INNER JOIN (SELECT colCode AS subjectId, tableDiv FROM asdb.k_reporttemplate WHERE vocationId = {param4}) AS t1 ON colCode = t1.subjectId LEFT JOIN (SELECT SUM(adjustValue) AS occurValue, reportSubjectId, customerId, projectId FROM bdo_dg.dg_tbsubjectcontract WHERE customerId = {param1} AND projectId = {param2} AND yyyy = {param7} AND ACTIVE_FLAG = 1 GROUP BY reportSubjectId) b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.colCode = b.reportSubjectId LEFT JOIN (SELECT SUM(adjustValue) AS occurValue, reportSubjectId, customerId, projectId FROM bdo_dg.dg_tbsubjectcontract WHERE customerId = {param1} AND projectId = {param2} AND yyyy = {param8} AND ACTIVE_FLAG = 1 GROUP BY reportSubjectId) b2 ON a.customerId = b2.customerId AND a.projectId = b2.projectId AND a.colCode = b2.reportSubjectId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy={param7}  GROUP BY a.colCode ORDER BY a.sortNo
#DG00064=SELECT a.colCode, a.contrastStatus, a.colDisp, a.adjustedAmount, a.adjustAmount AS adjustAmount, a.adjustedAmount + a.adjustAmount AS auditedAmount FROM bdo_dg.dg_unauditreport a WHERE a.customerId = {param1} AND a.projectId = {param2} GROUP BY a.sortNo
#\u5BA1\u8BA1\u7A0B\u5E8F\u7EDF\u8BA1
DG00065=SELECT SUM( IF( a.departmentId = 555555 AND a.LEVEL = 0 AND a.customizeFlag = '0', 1, 0 ) ) AS companyCount, SUM( IF( a.departmentId <> 555555 AND a.LEVEL = 0 AND a.customizeFlag = '0', 1, 0 ) ) AS depCount, SUM( IF( a.customizeFlag = '1' AND a.LEVEL = 0, 1, 0 ) ) AS customizeCount, SUM( IF( a.LEVEL = 1, 1, 0 ) ) AS subCount FROM bdo_dg.dg_auditprogram a /*START #param4# LEFT JOIN bdo_dg.dg_subjecttree b ON b.customerId = {param1} AND b.autoId = a.subjecttreeId #param4# END*/ /*START #param5# LEFT JOIN bdo_dg.dg_subjecttree b ON b.customerId = {param1} AND b.autoId = a.subjecttreeId LEFT JOIN bdo_dg.dg_subjecttree c ON c.customerId = {param1} AND c.autoId = b.parentId #param5# END*/ /*START #param6# LEFT JOIN bdo_dg.dg_subjecttree b ON b.customerId = {param1} AND b.autoId = a.subjecttreeId LEFT JOIN bdo_dg.dg_subjecttree c ON c.customerId = {param1} AND c.autoId = b.parentId LEFT JOIN bdo_dg.dg_subjecttree d ON d.customerId = {param1} AND d.autoId = c.parentId #param6# END*/ WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.ACTIVE_FLAG = '1' /*START #param4# AND b.autoId = {param4} #param4# END*/ /*START #param5# AND c.autoId = {param5} #param5# END*/ /*START #param6# AND d.parentId = '{param6}' #param6# END*/ /*START #param8# AND a.workpaperEditor = {param8} #param8# END*/ /*START #param10# AND a.subjectId = {param10} #param10# END*/
#\u67E5\u8BE2\u662F\u5426\u751F\u6210\u5BA1\u8BA1\u7A0B\u5E8F
DG00066=SELECT COUNT(autoId) AS count FROM bdo_dg.dg_auditprogram WHERE customerId={customerId} AND projectId={projectId} 
#\u67E5\u627E\u5E95\u7A3F
DG00067=SELECT a.autoId, a.fileName, b.indexId, a.subjectId, a.subjectName FROM bdo_dg.dg_workpaper a LEFT JOIN bdo_dg.dg_subjecttree b ON b.customerId = {param1} AND b.projectId = {param2} AND b.workpaperId = a.autoId WHERE a.customerId = {param1} AND a.projectId = {param2} AND b.nodeType = 'FILE'  ORDER BY b.indexId  ASC
#\u67E5\u627E\u5E95\u7A3F\u9644\u4EF6
DG00068=SELECT a.autoId, a.fileIndexId, a.fileName FROM bdo_dg.dg_attach a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.workpaperId = {param3}
#\u67E5\u627E\u5E95\u7A3F\u9644\u4EF6
DG00069=SELECT a.autoId, a.workpaperId, a.fileIndexId, a.fileName FROM bdo_dg.dg_attach a WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.workpaperId = {param3} AND SUBSTRING(a.fileName, -4) = 'xlsx' #param3# END*/
#\u6279\u91CF\u4E0A\u4F20\u5E95\u7A3F\u4E00\u89C8
DG00070=SELECT a.autoId, a.customerId, a.projectId, a.fileName, a.matchState, a.auditprogramId, a.uploadDate, a.uploadUser AS __uuploadUser, ap.indexId, CONCAT( ap.indexId, '-', ap.dgName, '.xlsx' ) AS tplFileName, b.autoId AS workpaperId FROM bdo_dg.dg_workpapertemp a LEFT JOIN bdo_dg.dg_auditprogram ap ON ap.customerId = a.customerId AND ap.projectId = a.projectId AND ap.autoId = a.auditprogramId LEFT JOIN bdo_dg.dg_workpaper b ON a.customerId = a.customerId AND a.projectId = a.projectId AND ap.workpaperId = b.autoId WHERE a.customerId = {param1} AND a.projectId = {param2} 
#\u67E5\u8BE2\u5B9E\u65BD\u79D1\u76EE
DG00071=SELECT a.autoId AS value, CONCAT(a.indexId, '-', a.dgName, '.xlsx') AS label FROM bdo_dg.dg_auditprogram a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.ACTIVE_FLAG = '1' AND a.level = 1 AND a.workpaperId IS NOT NULL ORDER BY a.indexId
#\u67E5\u8BE2\u81EA\u5B9A\u4E49\u5355\u5143\u683C\u7C7B\u578B\u3001\u5E95\u7A3F\u53D6\u503C\u4FE1\u606F
DG00072=SELECT a.customizeStyle, a.dgValueInfo FROM bdo_dg.dg_workpaper a WHERE a.customerId = {param1} AND a.autoId = {param2}
#\u67E5\u8BE2\u5E95\u7A3F\u4E0B\u7684TB\u79D1\u76EE
DG00073=SELECT a.tbSubjectId AS subjectCode,a.tbSubjectName,a.reportSubjectId,a.reportSubjectName,a.subjectType1,'' AS subjectType2,a.sortNo,a.isSubject,a.calFun,a.userDefined,a.autoId AS tbId FROM bdo_dg.dg_projecttb a WHERE a.customerId = {customerId} AND a.projectId = {projectId} 
#\u83B7\u53D6\u6700\u5927indexId
DG00074=SELECT SUBSTRING(a.fileIndexId, LENGTH(a.fileIndexId)-3) AS indexId FROM bdo_dg.dg_attach a WHERE a.customerId = {param1} AND a.auditprogramId = {param2} ORDER BY a.autoId DESC LIMIT 0,1
#\u83B7\u53D6\u6279\u6CE8\u6700\u5927indexId
DG00075=SELECT SUBSTRING( a.indexId, LENGTH(a.indexId) - 3 ) AS indexId FROM (SELECT IF( an.autoId < anw.autoId, anw.indexId, an.indexId ) indexId, IF( an.autoId < anw.autoId, anw.autoId, an.autoId ) autoId FROM bdo_dg.dg_auditprogram ap LEFT JOIN bdo_dg.dg_annotation an ON an.customerId = {param1} AND an.foreignId = ap.autoId AND an.type = 'P002' LEFT JOIN bdo_dg.dg_subjecttree st ON st.customerId = {param1} AND st.workpaperId = ap.workpaperId LEFT JOIN bdo_dg.dg_annotation anw ON anw.customerId = {param1} AND anw.foreignId = st.autoId AND anw.type = 'P001' WHERE ap.customerId = {param1} AND ap.autoId = {param2} ) a ORDER BY a.autoId DESC LIMIT 0, 1
#\u7528\u6237\u5207\u6362\u9879\u76EE\u5386\u53F2\u8BB0\u5F55
DG00076=SELECT a.dgProjectAutoId, MAX(a.autoId) AS histryId, b.customerId, b.projectId, b.projectName, b.customerName, b.auditTimeBegin, b.auditTimeEnd, b.manager AS __umanager, a.optUserId AS __uoptUserId, MAX(a.optDate) AS optDate FROM bdo_dg.dg_projectacthistory a LEFT JOIN bdo_dg.dg_project b ON b.customerId = a.customerId AND b.autoId = a.dgProjectAutoId WHERE a.optUserId = {userId} GROUP BY a.dgProjectAutoId ORDER BY optDate DESC LIMIT 0,10
#\u6279\u6CE8\u4E00\u89C8new
DG00077=SELECT * FROM (SELECT a.autoId, a.customerId, a.indexId,  a.createUser AS __ucreateUser, DATE_FORMAT( a.CREATION_DATE, '%Y-%m-%d %H:%i:%s' ) AS createDate, a.content, a.cellContent, a.postilLevel, NULL AS comments, a.ACTIVE_FLAG AS activeFlag, ( CASE WHEN a.CREATED_BY = {userId} THEN 'true' ELSE 'false'  END ) AS isAuthor, '' AS __ucommentedUser, a.type, '' AS commentId, '' AS annotationId FROM bdo_dg.dg_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.autoId = {param3} #param3# END*/  /*START #param4# AND a.auditState = {param4} #param4# END*/ AND a.foreignId = {param5} AND a.type = '{param6}' UNION ALL SELECT a.autoId, a.customerId, b.indexId, a.createUser AS __ucreateUser, DATE_FORMAT( a.CREATION_DATE, '%Y-%m-%d %H:%i:%s' ) AS createDate, a.content, a.cellContent, '' AS postilLevel, NULL AS comments, a.ACTIVE_FLAG AS activeFlag, ( CASE WHEN a.CREATED_BY = {userId} THEN 'true' ELSE 'false' END ) AS isAuthor, a.commentedUser AS __ucommentedUser, a.TYPE, a.commentId, a.annotationId FROM bdo_dg.dg_comment a LEFT JOIN bdo_dg.dg_annotation b ON b.autoId = a.annotationId AND a.customerId = b.customerId WHERE b.customerId = {param1} AND b.projectId = {param2} /*START #param3# AND b.autoId = {param3} #param3# END*/ /*START #param4# AND b.auditState = {param4}  #param4# END*/ AND b.foreignId = {param5} AND b.type = '{param6}') a 
#\u67E5\u627E\u5E95\u7A3F\u6811
DG00078=SELECT a.autoId, a.customerId, a.parentId, a.projectId, a.subjectId, a.workpaperId, a.indexId, a.nodeName, a.nodeType, a.userSubjectId, a.userSubjectName, a.tbSubjectCode, a.tbSubjectId, a.tbSubjectName, a.sE, a.sC, a.sA, a.sV, a.sP, a.csE, a.csC, a.csA, a.csV, a.csP, a.plansE, a.plansC, a.plansA, a.plansV, a.plansP, a.plancsE, a.plancsC, a.plancsA, a.plancsV, a.plancsP, CONCAT(d.parentId,',',c.parentId,',',b.parentId,',',a.parentId,',',a.autoId) AS fullPath FROM bdo_dg.dg_subjecttree a LEFT JOIN bdo_dg.dg_subjecttree b ON a.parentId = b.autoId AND b.ACTIVE_FLAG = '1' AND b.customerId = {param1} AND b.projectId = {param2} LEFT JOIN bdo_dg.dg_subjecttree c ON b.parentId = c.autoId AND c.ACTIVE_FLAG = '1' AND c.customerId = {param1} AND c.projectId = {param2} LEFT JOIN bdo_dg.dg_subjecttree d ON c.parentId = d.autoId AND d.ACTIVE_FLAG = '1' AND d.customerId = {param1} AND d.projectId = {param2} WHERE a.ACTIVE_FLAG = '1' AND a.customerId = {param1} AND a.projectId = {param2} AND a.workpaperId = {param3} AND a.nodeType <> 'FUZHU' ORDER BY a.tbSubjectId, a.tbSubjectCode, a.userSubjectId
#\u6E05Q\u8FDB\u5EA6
DG00079=SELECT IF( totalCount = 0, 0, ROUND(closeCount * 100 / totalCount, 4) ) AS percent FROM (SELECT SUM(IF(a.ACTIVE_FLAG = '1', 0, 1)) closeCount, IFNULL(SUM(1), 0) AS totalCount FROM bdo_dg.dg_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} ) a 
#\u4F7F\u7528\u7A0B\u5E8F\u90E8\u95E8
DG00080=SELECT dgap.departmentId AS __ddepartmentId, COUNT(dgap.departmentId) AS useCount FROM bdo_dg.dg_auditprogram dgap LEFT JOIN bdo_base.base_department bd ON bd.autoid = dgap.departmentId WHERE dgap.level = 0 AND dgap.ACTIVE_FLAG = '1' AND dgap.auditprogramId = {param1} GROUP BY dgap.departmentId
#\u8868\u683C\u914D\u7F6E
DG00081=SELECT a.autoId, a.menuId, a.clientTableId, a.customizeConfig FROM asdb.k_customizetblconf a WHERE a.menuId = '{param1}' AND a.clientTableId = '{param2}' AND a.userId = {userId}
#\u6839\u636E\u6761\u4EF6\u53D6\u5F97\u6807\u7B7E\u540D
DG00082=SELECT a.autoId, a.tagName, a.tagValue, a.tagPosition, a.tagInfo, a.tagDgId FROM bdo_dg.dg_projectlstag a WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.tagPosition = '{param3}' #param3# END*/ /*START #param4# AND a.tagDgId = {param4} #param4# END*/ /*START #param5# AND a.tagType = '{param5}' #param5# END*/ AND a.ACTIVE_FLAG = '1' ORDER BY a.autoId
#\u83B7\u53D6\u6807\u7B7E
DG00083=SELECT a.autoId, a.tagName, a.tagValue, a.tagPosition, a.tagInfo, a.tagType, a.tagProperty, a.tagDgId, CASE a.tagType WHEN 'function' THEN LEFT( a.tagPosition, LOCATE(':', a.tagPosition) - 1 ) WHEN 'db' THEN LEFT( a.tagPosition, LOCATE(':', a.tagPosition) - 1 ) WHEN 'dg' THEN b.dgName WHEN 'note' THEN c.noteName WHEN 'report' THEN a.tagPosition END AS otherPosition FROM ( SELECT a.autoId, a.tagName, a.tagValue, a.tagPosition, a.tagInfo, a.tagType, a.tagProperty, a.tagDgId, a.LAST_UPDATE_DATE FROM bdo_dg.dg_projectlstag a WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param4# AND a.tagType = '{param4}' #param4# END*/ /*START #param5# AND a.tagType = 'dg' AND a.tagDgId IN ({param5}) #param5# END*/ /*START #param6# AND a.tagType = 'note' AND a.tagDgId = {param6} #param6# END*/ AND a.ACTIVE_FLAG = '1' ORDER BY a.autoId ) a LEFT JOIN bdo_dg.dg_auditprogram b ON a.tagType = 'dg' AND a.tagDgId IS NOT NULL AND b.customerId = {param1} AND b.projectId = {param2} AND a.tagDgId = b.workpaperId LEFT JOIN bdo_dg.dg_noteinfo c ON a.tagType = 'note' AND c.customerId = {param1} AND c.projectId = {param2} AND a.tagDgId IS NOT NULL AND a.tagDgId = c.autoId ORDER BY a.LAST_UPDATE_DATE DESC
#\u83B7\u53D6\u6821\u9A8C\u6570\u636E\u516C\u5F0F
DG00084=SELECT a.autoId, a.subjectId, a.formulaType, a.formulaProperty, a.formula, a.formulaText, a.formulaValue, a.formulaCalc, a.LAST_UPDATE_DATE AS updateTime, a.subjectName FROM bdo_dg.dg_projectformula a WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND ( a.subjectId IN (SELECT b.userSubjectId FROM bdo_dg.dg_tbsubjectcontract b WHERE b.tbSubjectCode = '{param3}') OR a.subjectId = '{param3}' ) #param3# END*/ /*START #param4# AND a.formulaType = '{param4}' #param4# END*/ AND a.ACTIVE_FLAG = '1' AND a.checkType = '0' ORDER BY a.formulaCalc 
#\u91CD\u8981\u6027\u6C34\u5E73\u8BBE\u7F6E\u4FE1\u606F
DG00085=SELECT a.autoId, a.projectId, a.customerId, a.materIndex, a.editUser AS __ueditUser, a.editDate, a.auditedUnit, a.reviewUser, a.reviewDate, a.belongDate, a.reason, a.auditUser, a.auditDate, a.settingType, a.settingTypeValue1, a.settingTypeValue2, a.finalSettingTypeValue1,a.finalSettingTypeValue2,a.settingValue1, a.settingRate1, a.settingImportValue1, a.settingRateOne1, a.settingRateTwo1, a.settingValue2, a.settingRate2, a.settingImportValue2, a.settingRateOne2, a.settingRateTwo2, a.settingValue3, a.settingRate3, a.settingImportValue3, a.settingRateOne3, a.settingRateTwo3, a.settingValue4, a.settingRate4, a.settingImportValue4, a.settingRateOne4, a.settingRateTwo4 ,a.settingValue5,a.settingRate5,a.settingImportValue5,a.settingRateOne5,a.settingRateTwo5 ,a.settingValue6,a.settingRate6,a.settingImportValue6,a.settingRateOne6,a.settingRateTwo6 FROM bdo_dg.dg_materiality a WHERE a.customerId = {param1} AND projectId = {param2}
#\u83B7\u53D6\u81EA\u5B9A\u4E49\u5355\u5143\u683C\u6837\u5F0F
DG00086=SELECT a.customizeStyle, a.subjectId FROM bdo_dg.dg_workpaper a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.autoId = {param3} 
#\u4ECE\u524D\u7F6E\u9879\u76EE\u590D\u5236\u7A0B\u5E8F\uFF1A\u83B7\u53D6\u9879\u76EE\u79D1\u76EE\u8282\u70B9
DG00087=select * from bdo_dg.dg_auditprogram a where a.subjecttreeId in ({subjecttreeIds}) and a.customizeFlag = '0' and a.level = 0
#\u5224\u65AD\u662F\u5426\u5B58\u5728\u79D1\u76EE\u8282\u70B9
DG00088=select count(1) from bdo_dg.dg_subjecttree a where a.customerId = {customerId} and a.parentId = '{parentId}'
#\u6A21\u7CCA\u67E5\u8BE2\u6821\u9A8C\u6570\u636E\u516C\u5F0F
DG00089=SELECT a.autoId, a.customerId, a.projectId, a.subjectId, a.subjectName, a.formulaType, a.formulaProperty, a.formula, a.formulaText, a.formulaValue, a.formulaCalc, a.formulaAutoId, a.LAST_UPDATE_DATE AS updateTime FROM bdo_dg.dg_projectformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND ( a.formulaText LIKE CONCAT('{param3}', '+', '%') OR a.formulaText LIKE CONCAT('{param3}', '-', '%') OR a.formulaText LIKE CONCAT('{param3}', '=', '%') OR a.formulaText LIKE CONCAT('%', '+', '{param3}') OR a.formulaText LIKE CONCAT('%', '-', '{param3}') OR a.formulaText LIKE CONCAT('%', '=', '{param3}') OR a.formulaText LIKE CONCAT('%', '+', '{param3}', '+', '%') OR a.formulaText LIKE CONCAT('%', '+', '{param3}', '-', '%') OR a.formulaText LIKE CONCAT('%', '+', '{param3}', '=', '%') OR a.formulaText LIKE CONCAT('%', '-', '{param3}', '+', '%') OR a.formulaText LIKE CONCAT('%', '-', '{param3}', '-', '%') OR a.formulaText LIKE CONCAT('%', '-', '{param3}', '=', '%') OR a.formulaText LIKE CONCAT('%', '=', '{param3}', '+', '%') OR a.formulaText LIKE CONCAT('%', '=', '{param3}', '-', '%')) ORDER BY a.autoId 
#\u9644\u6CE8\u4E00\u89C8
DG00090=SELECT a.* FROM ( SELECT a.autoId, a.customerId, a.projectId, a.knoteId, a.noteNo, a.noteName, a.colCode, a.colName, a.fileName, a.fullPath, a.noteDgValueInfo, a.curAmount, a.preAmount, a.reportTplId, a.isForbid, a.isEdited, a.isFinished, a.customizeStyle, a.sortNo, a.isCompleteNow, DATE_FORMAT( a.LAST_UPDATE_DATE, '%Y-%m-%d %H:%i:%s' ) AS updateTime, a.LAST_UPDATED_BY AS __urevisor, IF (c.autoId IS NULL, 1, 0) AS checkResult FROM bdo_dg.dg_noteinfo a LEFT JOIN bdo_dg.dg_referredformula b ON a.customerId = b.customerId AND a.projectId = b.projectId AND b.infoType = 'NOTE' AND b.infoId = a.autoId LEFT JOIN bdo_dg.dg_projectformula c ON a.customerId = c.customerId AND a.projectId = c.projectId AND c.checkType = 0 AND c.formulaCalc = 0 AND c.autoId IN ( SELECT SUBSTRING_INDEX( SUBSTRING_INDEX( b.infoFormula, ',', d.help_topic_id + 1 ), ',', - 1 ) AS infoFormula FROM mysql.help_topic d WHERE d.help_topic_id < ( LENGTH(b.infoFormula) - LENGTH( REPLACE (b.infoFormula, ',', '')) + 1 )) WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.noteName LIKE CONCAT('%', '{param3}', '%') #param3# END*/ /*START #param4# AND a.fullPath IS NOT NULL AND a.fullPath <> ''#param4# END*/ GROUP BY a.autoId ORDER BY a.sortNo ASC ) a
#\u83B7\u53D6\u672A\u521D\u59CB\u5316\u5230\u9879\u76EE\u7684\u9644\u6CE8
DG00091=SELECT a.autoId, a.noteNo, a.noteName, a.colCode, a.colName, a.fileName, a.fullPath, a.reportTplId, a.sortNo, isChange FROM asdb.k_noteinfo a LEFT JOIN bdo_dg.dg_project b ON b.tbReportTemplate = a.reportTplID LEFT JOIN bdo_dg.dg_noteinfo c ON c.knoteId = a.autoId AND c.customerId = b.customerId AND c.projectId = b.projectId WHERE b.customerId = {param1} AND b.projectId = {param2} AND c.autoId IS NULL 
#\u9644\u6CE8\u8282\u70B9\u4FE1\u606F
DG00092=SELECT a.autoId, a.customerId, a.projectId, a.knoteId, a.noteNo, a.noteName, a.colCode, a.colName, a.fileName, a.fullPath, a.noteDgValueInfo, a.reportTplId, a.isForbid, a.isEdited, a.isFinished, a.customizeStyle FROM bdo_dg.dg_noteinfo a WHERE a.ACTIVE_FLAG = '1' /*START #param1# AND a.autoId = {param1} #param1# END*/ AND a.customerId = {param2} AND a.projectId = {param3} /*START #param4# AND a.isForbid = '{param4}' #param4# END*/ /*START #param5# AND a.isFinished = '{param5}' #param5# END*/ ORDER BY a.sortNo ASC
#\u5BA1\u8BA1\u9879\u76EE
#DG00093=SELECT a.projectName, a.manager AS __umanager, a.auditTimeBegin AS projectStartDate, ROUND( ( IFNULL(a.clearQuestionState, 0) + IFNULL(a.programState, 0) + IFNULL(a.programPlanState, 0) + IFNULL(a.identifiedState, 0) + IFNULL(a.auditedState, 0) + IFNULL(a.unauditedState, 0) + IFNULL(a.trialBalanceState, 0) + IFNULL(a.materialityState, 0) ) / 8, 2 ) AS progress FROM (SELECT a.projectId, a.auditTimeBegin, a.manager, a.projectName, a.materialityState, a.trialBalanceState, a.unauditedState, a.auditedState, a.identifiedState, a.programPlanState, a.programState, a.clearQuestionState, a.auditStatu FROM bdo_dg.dg_project a WHERE a.manager = {param1} UNION SELECT a.projectId, a.auditTimeBegin, a.manager, a.projectName, a.materialityState, a.trialBalanceState, a.unauditedState, a.auditedState, a.identifiedState, a.programPlanState, a.programState, a.clearQuestionState, a.auditStatu FROM bdo_dg.dg_project a WHERE a.signUser = {param1} UNION SELECT a.projectId, a.auditTimeBegin, a.manager, a.projectName, a.materialityState, a.trialBalanceState, a.unauditedState, a.auditedState, a.identifiedState, a.programPlanState, a.programState, a.clearQuestionState, a.auditStatu FROM bdo_dg.dg_project a WHERE a.audit1 = {param1} UNION SELECT a.projectId, a.auditTimeBegin, a.manager, a.projectName, a.materialityState, a.trialBalanceState, a.unauditedState, a.auditedState, a.identifiedState, a.programPlanState, a.programState, a.clearQuestionState, a.auditStatu FROM bdo_dg.dg_project a WHERE a.audit2 = {param1} UNION SELECT a.projectId, a.auditTimeBegin, a.manager, a.projectName, a.materialityState, a.trialBalanceState, a.unauditedState, a.auditedState, a.identifiedState, a.programPlanState, a.programState, a.clearQuestionState, a.auditStatu FROM bdo_dg.dg_project a WHERE a.membersId REGEXP '^{param1}$|^{param1},|,{param1}$|,{param1},') a
#DG00093=SELECT a.projectName, a.manager AS __umanager, a.auditTimeBegin AS projectStartDate, ROUND( ( IFNULL(a.clearQuestionState, 0) * ifnull(a.clearQuestionStateWeight, 1) + IFNULL(a.programState, 0) * IFNULL(a.programStateWeight, 1) + IFNULL(a.programPlanState, 0) * IFNULL(a.programPlanStateWeight, 1) + IFNULL(a.identifiedState, 0) * IFNULL(a.identifiedStateWeight, 1) + IFNULL(a.auditedState, 0) * IFNULL(a.auditedStateWeight, 1) + IFNULL(a.unauditedState, 0) * IFNULL(a.unauditedStateWeight, 1) + IFNULL(a.trialBalanceState, 0) * IFNULL(a.trialBalanceStateWeight, 1) + IFNULL(a.materialityState, 0) * IFNULL(a.materialityStateWeight, 1) ) / (IFNULL(a.clearQuestionStateWeight, 1) + IFNULL(a.programStateWeight, 1) + IFNULL(a.programPlanStateWeight, 1) + IFNULL(a.identifiedStateWeight, 1) + IFNULL(a.auditedStateWeight, 1) + IFNULL(a.unauditedStateWeight, 1) + IFNULL(a.trialBalanceStateWeight, 1) + IFNULL(a.materialityStateWeight, 1)), 2 ) AS progress, a.projectId, a.customerId, a.customerName, a.auditTimeEnd, a.auditTimeBegin FROM bdo_dg.dg_project a where a.projectId in ({param1})
DG00093=SELECT a.projectName, a.manager AS __umanager, a.auditTimeBegin AS projectStartDate, ROUND(progressRate, 2 ) AS progress, a.projectId, a.customerId, a.customerName, a.auditTimeEnd, a.auditTimeBegin FROM bdo_dg.dg_project a where a.projectId in ({param1}) ORDER BY a.auditTimeBegin DESC
#\u9644\u6CE8\u5E95\u7A3F\u53D6\u503C
DG00094=SELECT a.noteDgValueInfo FROM bdo_dg.dg_noteinfo a WHERE a.autoId = {param1} AND a.customerId = {param2} AND a.projectId = {param3}
#\u540C\u6B65\u7528\u6237\u5BA2\u6237\u4FE1\u606F-\u83B7\u53D6\u7528\u6237\u4FE1\u606F
#DG00095=SELECT a.id AS userId, a.hrLoginId from bdo_base.base_user a WHERE a.ACTIVE_FLAG = 1 AND a.isActive = 1 AND a.hrLoginId > '' LIMIT {start}, {limit}
DG00095=SELECT DISTINCT a.id AS userId, a.hrLoginId, a.departmentId FROM bdo_base.base_user a LEFT JOIN bdo_base.base_userrole ur ON ur.userId = a.id AND ur.rid IN (43, 42, 41, 40, 39, 38, 35, 33) WHERE a.ACTIVE_FLAG = 1 AND a.isActive = 1 AND a.hrLoginId > '' AND ur.userId IS NOT NULL ORDER BY a.id LIMIT {start}, {limit}
#\u5BA1\u5B9A\u62A5\u8868\u67E5\u8BE2
DG00096=SELECT a.colCode, a.colDisp, a.adjustedAmount, IFNULL(b.occurValue, 0) AS adjustAmount, IFNULL((a.adjustedAmount + IFNULL(b.occurValue, 0)), 0) AS auditedAmount FROM bdo_dg.dg_unauditreport a LEFT JOIN (SELECT SUM(IFNULL(occurValue, 0) * IFNULL(dirction, 0)) AS occurValue, adjustSubjectCodeReport AS reportSubjectId, customerId, projectId FROM bdo_dg.dg_subjectentryadjust WHERE customerId = {param1} AND projectId = {param2} AND adjustType = 2 AND ACTIVE_FLAG = 1 GROUP BY adjustSubjectCodeReport) b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.colCode = b.reportSubjectId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.colDisp LIKE CONCAT('%',{param3},'%' ) GROUP BY a.sortNo
#\u5E95\u7A3FsubjectId
DG00097=SELECT b.subjectId FROM bdo_dg.dg_auditprogram a LEFT JOIN bdo_dg.dg_subjecttree b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.subjecttreeId = b.autoId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.autoId = {param3}
#\u9879\u76EE\u6570
DG00098=select count(1) as projectCount from (select a.projectId from bdo_dg.dg_project a where a.manager = {userId} union SELECT a.projectId FROM bdo_dg.dg_project a WHERE a.signUser = {userId} UNION SELECT a.projectId FROM bdo_dg.dg_project a WHERE a.audit1 = {userId} UNION SELECT a.projectId FROM bdo_dg.dg_project a WHERE a.audit2 = {userId} union SELECT a.projectId FROM bdo_dg.dg_project a WHERE a.membersId REGEXP '^{userId}$|^{userId},|,{userId}$|,{userId},') a
#\u9879\u76EE\u5B8C\u6210\u60C5\u51B5
DG00099=SELECT SUM( IF(a.materialityState = '100' AND a.trialBalanceState = '100' AND a.unauditedState = '100' AND a.auditedState = '100' AND a.identifiedState = '100' AND a.programPlanState = '100' AND a.programState = '100' AND a.clearQuestionState = '100', 1, 0 )) AS prjFinishCount, SUM( IF(a.materialityState = '100' AND a.trialBalanceState = '100' AND a.unauditedState = '100' AND a.auditedState = '100' AND a.identifiedState = '100' AND a.programPlanState = '100' AND a.programState = '100' AND a.clearQuestionState = '100', 0, 1 )) AS prjInProgressCount FROM (SELECT a.projectId, a.materialityState, a.trialBalanceState, a.unauditedState, a.auditedState, a.identifiedState, a.programPlanState, a.programState, a.clearQuestionState, a.auditStatu FROM bdo_dg.dg_project a WHERE a.manager = {userId} UNION SELECT a.projectId, a.materialityState, a.trialBalanceState, a.unauditedState, a.auditedState, a.identifiedState, a.programPlanState, a.programState, a.clearQuestionState, a.auditStatu FROM bdo_dg.dg_project a WHERE a.signUser = {userId} UNION SELECT a.projectId, a.materialityState, a.trialBalanceState, a.unauditedState, a.auditedState, a.identifiedState, a.programPlanState, a.programState, a.clearQuestionState, a.auditStatu FROM bdo_dg.dg_project a WHERE a.audit1 = {userId} UNION SELECT a.projectId, a.materialityState, a.trialBalanceState, a.unauditedState, a.auditedState, a.identifiedState, a.programPlanState, a.programState, a.clearQuestionState, a.auditStatu FROM bdo_dg.dg_project a WHERE a.audit2 = {userId} UNION SELECT a.projectId, a.materialityState, a.trialBalanceState, a.unauditedState, a.auditedState, a.identifiedState, a.programPlanState, a.programState, a.clearQuestionState, a.auditStatu FROM bdo_dg.dg_project a WHERE a.membersId REGEXP '^{userId}$|^{userId},|,{userId}$|,{userId},') a  
#Q\u91CF
#DG00100=SELECT SUM(IF(b.ACTIVE_FLAG = '1', 1, 0)) AS postilInProgressCount, SUM(IF(b.ACTIVE_FLAG = '1', 0, 1)) AS postilFinishCount FROM (SELECT a.projectId , a.customerId FROM bdo_dg.dg_project a WHERE a.manager = {userId} UNION SELECT a.projectId, a.customerId FROM bdo_dg.dg_project a WHERE a.signUser = {userId} UNION SELECT a.projectId, a.customerId FROM bdo_dg.dg_project a WHERE a.audit1 = {userId} UNION SELECT a.projectId, a.customerId FROM bdo_dg.dg_project a WHERE a.audit2 = {userId} UNION SELECT a.projectId, a.customerId FROM bdo_dg.dg_project a WHERE a.membersId REGEXP '^{userId}$|^{userId},|,{userId}$|,{userId},') a LEFT JOIN bdo_dg.dg_annotation b ON b.customerId = a.customerId AND b.projectId = a.projectId
DG00100=SELECT IFNULL(SUM(IF(b.ACTIVE_FLAG = '1', 1, 0)), 0) AS postilInProgressCount, IFNULL(SUM(IF(b.ACTIVE_FLAG = '1', 0, 1)), 0) AS postilFinishCount FROM bdo_dg.dg_annotation b where b.projectId in ({param1})
#\u672A\u5B8C\u6210Q\u5217\u8868
#DG00101=SELECT a.customerId, a.customerName, a.projectId, a.projectName, a.auditTimeEnd, a.auditTimeBegin, b.content, IFNULL(b.contentText,'') as postilContentText, b.auditState, b.CREATION_DATE AS createDate, b.ACTIVE_FLAG AS state, b.CREATED_BY AS __uCreateUser, ap.dgName/*, ap.workpaperEditor as __uWorkpaperEditor*/ FROM bdo_dg.dg_project a inner join bdo_dg.dg_annotation b ON b.customerId = a.customerId AND b.projectId = a.projectId LEFT JOIN bdo_dg.dg_auditprogram ap ON ap.customerId = a.customerId AND ap.projectId = a.projectId AND ap.workpaperId = b.foreignId where a.projectId in ({param1}) AND b.ACTIVE_FLAG = '1' ORDER BY b.CREATION_DATE DESC
DG00101=SELECT a.customerId, b.customerName, a.projectId, b.projectName, b.auditTimeEnd, b.auditTimeBegin, a.content, a.postilContentText, a.auditState, a.createDate, a.ACTIVE_FLAG AS state, a.__ucreateUser AS __uCreateUser, a.userSubjectName, a.nodeName FROM ( SELECT a.autoId, a.foreignId, a.indexId, a.content, IFNULL(a.contentText, '') AS postilContentText, a.cellContent, a.postilLevel, a.type, a.createUser AS __ucreateUser, a.auditState, a.CREATION_DATE AS createDate, IFNULL( CASE WHEN a.type = 'P000' THEN b.nodeName ELSE IFNULL(e.nodeName, f.nodeName) END, '' ) AS userSubjectName, IFNULL( IFNULL( IFNULL( CASE WHEN a.type = 'P000' THEN '\u9879\u76EE' ELSE b.nodeName END, c.fileName ), d.noteName ), '' ) AS nodeName, a.projectId, a.customerId, NULL AS mergeCustomerId, NULL AS mergeCustomerName, NULL AS mergeProjectId, NULL AS mergeProjectName, a.ACTIVE_FLAG AS ACTIVE_FLAG FROM bdo_dg.dg_annotation a LEFT JOIN bdo_dg.dg_subjecttree b ON b.autoId = a.foreignId AND b.customerId = a.customerId AND b.projectId = a.projectId LEFT JOIN bdo_dg.dg_workpaper c ON c.autoId = a.foreignId AND c.customerId = a.customerId LEFT JOIN bdo_dg.dg_noteinfo d ON d.autoId = a.foreignId AND d.customerId = a.customerId LEFT JOIN bdo_dg.dg_subjecttree e ON e.autoId = a.subjecttreeId AND e.customerId = a.customerId LEFT JOIN bdo_dg.dg_subjecttree f ON f.autoId = b.parentId AND f.customerId = a.customerId WHERE a.projectId IN ({param1}) UNION ALL SELECT a.autoId, a.foreignId, a.indexId, a.content, IFNULL(a.contentText, '') AS postilContentText, a.cellContent, a.postilLevel, a.type, a.createUser AS __ucreateUser, a.auditState, a.CREATION_DATE AS createDate, '' AS userSubjectName, IFNULL(a.cellContent, '') AS nodeName, a.projectId, a.customerId, a.mergeCustomerId, b.mergeCustomerName, a.mergeProjectId, b.mergeProjectName, a.ACTIVE_FLAG AS ACTIVE_FLAG FROM bdo_hb.hb_annotation a LEFT JOIN bdo_hb.hb_mergeproject b ON a.mergeProjectId = b.mergeProjectId AND a.mergeCustomerId = b.mergeCustomerId AND a.projectId = b.projectId AND a.customerId = b.customerId WHERE a.projectId IN ({param1})) a LEFT JOIN bdo_dg.dg_project b ON a.projectId = b.projectId AND a.customerId = b.customerId ORDER BY a.createDate DESC
#\u5BA2\u6237\u6570\u91CF
#DG00102=SELECT group_concat(DISTINCT customerid) FROM bdo_fin.fin_account WHERE customerid IN ({param1}) 
DG00103=SELECT * FROM bdo_dg.dg_project a where a.projectId in ({param1})
#\u62A5\u5907\u6A21\u677F\u5B57\u6BB5\u4FE1\u606F
DG00104=SELECT a.reportTplId, a.kNoteId, a.noteNo, a.noteName, a.fileName, a.fieldName, b.autoId, b.fieldValue, CASE WHEN b.fieldPosition != '' THEN b.fieldPosition ELSE a.fieldPosition END AS fieldPosition FROM asdb.k_reportfieldinfo a LEFT JOIN bdo_dg.dg_reportfieldinfo b ON a.reportTplId = b.reportTplId AND a.kNoteId = b.kNoteId AND a.noteNo = b.noteNo AND a.fieldName = b.fieldName AND b.customerId = {param1} AND b.projectId = {param2} WHERE a.reportTplId = {param3} AND a.kNoteId = {param4} AND a.noteNo = '{param5}'
#\u62A5\u5907
DG00105=SELECT a.autoId, a.reportNo, a.reportName, a.fileName, a.fullPath, a.startTime, a.completeTime, a.reportStatus, a.reportMessage FROM bdo_dg.dg_report a WHERE a.customerId = {param1}  AND a.projectId = {param2} ORDER BY a.autoId DESC 
#MAX\u62A5\u544A\u7F16\u53F7
DG00106=SELECT MAX(a.reportNo) FROM bdo_dg.dg_report a WHERE a.customerId = {param1} AND a.projectId = {param2} 
#TB
DG00107=SELECT a.tbSubjectId, TRIM(a.tbSubjectName) AS tbSubjectName, a.auditAmount FROM bdo_dg.dg_tbtable a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} /*START #param4# AND a.tbSubjectId = '{param4}' #param4# END*/
#\u62A5\u8868
DG00108=SELECT a.colCode, TRIM(a.colDisp) AS colDisp, IFNULL(( a.adjustedAmount + IFNULL(b.occurValue, 0)), 0 ) AS auditedAmount FROM bdo_dg.dg_unauditreport a LEFT JOIN ( SELECT SUM( IFNULL(occurValue, 0) * IFNULL(dirction, 0)) AS occurValue, adjustSubjectCodeReport AS reportSubjectId, customerId, projectId FROM bdo_dg.dg_subjectentryadjust WHERE customerId = {param1} AND projectId = {param2} AND yyyy = {param4} AND adjustType = 2 AND ACTIVE_FLAG = 1 GROUP BY adjustSubjectCodeReport ) b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.colCode = b.reportSubjectId WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.colCode = '{param3}' #param3# END*/ AND a.yyyy = {param4} GROUP BY a.sortNo
#\u5BA1\u8BA1\u9636\u6BB5\u91CD\u8981\u6027\u6C34\u5E73\u7EC4\u6210
DG00109=SELECT a.{param3} FROM bdo_dg.dg_materiality a WHERE a.customerId = {param1} AND a.projectId = {param2}
#\u5BA1\u8BA1\u9636\u6BB5\u91CD\u8981\u6027\u6C34\u5E73
DG00110=SELECT SUM(un.auditAmount) AS amount FROM ( SELECT a.tbSubjectId, TRIM(a.tbSubjectName) AS tbSubjectName, a.auditAmount FROM bdo_dg.dg_tbtable a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} UNION SELECT a.colCode, TRIM(a.colDisp) AS colDisp, IFNULL(( a.adjustedAmount + IFNULL(b.occurValue, 0)), 0 ) AS auditedAmount FROM bdo_dg.dg_unauditreport a LEFT JOIN ( SELECT SUM( IFNULL(occurValue, 0) * IFNULL(dirction, 0)) AS occurValue, adjustSubjectCodeReport AS reportSubjectId, customerId, projectId FROM bdo_dg.dg_subjectentryadjust WHERE customerId = {param1} AND projectId = {param2} AND adjustType = 2 AND ACTIVE_FLAG = 1 GROUP BY adjustSubjectCodeReport ) b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.colCode = b.reportSubjectId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} ) un WHERE un.tbSubjectId = {param4}
#\u5BA1\u8BA1\u9636\u6BB5\u91CD\u8981\u6027\u6C34\u5E73\u7EC4\u6210
DG00111=SELECT a.constitute1,a.constitute2,a.constitute3,a.constitute4 FROM bdo_dg.dg_materiality a WHERE a.customerId = {param1} AND a.projectId = {param2}
#\u5E95\u7A3F
DG00112=SELECT a.subjectId, a.subjectName, a.fileName, b.indexId, a.autoId FROM bdo_dg.dg_workpaper a LEFT JOIN bdo_dg.dg_subjecttree b ON b.customerId = {param1} AND b.projectId = {param2} AND b.workpaperId = a.autoId WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.subjectName LIKE CONCAT('%', '{param3}', '%') #param3# END*/ AND a.fileIndexId = 'P004-0001' ORDER BY a.subjectId ASC 
#\u79D1\u76EE\u5E95\u7A3F\u6821\u9A8C\u516C\u5F0F
DG00113=SELECT IF( LEFT(a.infoFormula, 1) = ',', SUBSTRING(a.infoFormula, 2), a.infoFormula ) AS infoFormula FROM ( SELECT IFNULL( GROUP_CONCAT(DISTINCT a.infoFormula), '' ) AS infoFormula FROM ( SELECT IFNULL( GROUP_CONCAT(DISTINCT a.infoFormula), '' ) AS infoFormula FROM bdo_dg.dg_referredformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.infoType = '{param3}' AND a.infoFormula IS NOT NULL AND a.infoFormula <> '' AND ( a.infoId = '{param4}' OR a.infoId IN ( SELECT DISTINCT (b.userSubjectId) FROM bdo_dg.dg_tbsubjectcontract b WHERE b.tbSubjectCode = '{param4}' )) UNION ALL SELECT a.infoFormula FROM bdo_dg.dg_referredformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.infoType = 'AUDITREPORT' AND a.infoName = '\u5BA1\u5B9A\u62A5\u8868-\u73B0\u91D1\u6D41\u91CF\u8868' AND 'NOTE' = '{param3}' AND '\u73B0\u91D1\u6D41\u91CF\u8868\u8865\u5145\u8D44\u6599' = ( SELECT a.noteName FROM bdo_dg.dg_noteinfo a WHERE a.autoId = '{param4}' AND a.customerId = {param1} AND a.projectId = {param2} )) a ) a
#\u6821\u9A8C\u516C\u5F0F
DG00114=SELECT a.autoId, a.customerId, a.projectId, a.subjectId, a.subjectName, a.formulaType, a.formulaProperty, a.formula, a.formulaText, a.formulaValue, a.formulaCalc, a.formulaAutoId, a.LAST_UPDATE_DATE AS updateTime FROM bdo_dg.dg_projectformula a WHERE a.autoId IN ({param3}) AND a.customerId = {param1} AND a.projectId = {param2} AND a.checkType = '0' /*START #param4# AND a.formulaType = '{param4}' #param4# END*/ /*START #param5# AND a.formulaCalc = '{param5}' #param5# END*/ /*START #param6# AND a.formulaProperty = '{param6}' #param6# END*/ORDER BY a.formulaCalc, a.LAST_UPDATE_DATE DESC
#\u79D1\u76EE\u5E95\u7A3F\u6821\u9A8C\u516C\u5F0FID
DG00115=SELECT a.autoId, a.customerId, a.projectId, a.infoType, a.infoId, a.infoName, a.infoFormula, a.infoVersion, a.remark FROM bdo_dg.dg_referredformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND ( a.infoFormula = '{param3}' OR a.infoFormula LIKE CONCAT('%', ',', '{param3}') OR a.infoFormula LIKE CONCAT('{param3}', ',', '%') OR a.infoFormula LIKE CONCAT('%', ',', '{param3}', ',', '%'))
#\u5E95\u7A3F\u9644\u4EF6\u4E00\u89C8
DG00116=SELECT a.autoId, a.fileIndexId, a.customerId, a.projectId, a.auditprogramId, a.workpaperId, b.fileName AS dgName, a.fileName, a.fileType, a.suffix, a.LAST_UPDATE_DATE AS uploadDate, a.CREATED_BY AS __uuploadUser, CONCAT(c.tbSubjectId,'-',c.tbSubjectName ) AS tbSubject, a.isReferred AS referredFlg, a.referredDgId FROM bdo_dg.dg_attach a LEFT JOIN bdo_dg.dg_workpaper b ON b.autoId = a.workpaperId AND b.customerId = a.customerId AND b.projectId = a.projectId LEFT JOIN bdo_dg.dg_subjecttree c ON b.subjectId = c.userSubjectId AND a.customerId = c.customerId AND a.projectId = c.projectId AND c.nodeType = 'SUBJECT' WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND c.tbSubjectId = '{param3}' #param3# END*/ /*START #param4# AND c.userSubjectId = '{param4}' #param4# END*/
#\u5E95\u7A3F\u6570\u91CF
DG00117=SELECT COUNT(a.autoId) AS num FROM bdo_dg.dg_workpaper a INNER JOIN bdo_dg.dg_subjecttree b ON  b.customerId = {param1} AND b.projectId = {param2} AND b.workpaperId = a.autoId AND b.nodeType = 'FILE' WHERE a.customerId = {param1} AND a.projectId = {param2}
#\u5E95\u7A3F\u9644\u4EF6\u6570\u91CF
DG00118=SELECT COUNT(a.autoId) AS num FROM bdo_dg.dg_attach a WHERE a.customerId = {param1} AND a.projectId = {param2}  AND a.isReferred = {param3} 
#\u6279\u6CE8\u6570\u91CF
DG00119=SELECT COUNT(a.autoId) AS num FROM bdo_dg.dg_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2}
#\u5BA1\u8BA1\u7A0B\u5E8F\u6570\u91CF\uFF08\u8BA1\u5212\uFF09
DG00120=SELECT COUNT(a.autoId) AS num FROM bdo_dg.dg_auditprogram a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.level = 0
#\u5BA1\u8BA1\u7A0B\u5E8F\u6570\u91CF\uFF08\u5B9E\u65BD\uFF09
DG00121=SELECT COUNT(a.autoId) AS num FROM bdo_dg.dg_auditprogram a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.level = 1
#\u9644\u4EF6\u6570\u91CF
DG00122=SELECT COUNT(a.autoId) AS num FROM bdo_dg.dg_file a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.subjectTreeId = (SELECT b.autoId FROM bdo_dg.dg_subjecttree b WHERE b.nodeName = '{param3}' AND b.customerId = {param1} AND b.projectId = {param2})
#\u9879\u76EE\u5408\u5E76\u8303\u56F4--\u672A\u9009\u9879\u76EE
DG00123=SELECT a.projectId, a.projectName FROM bdo_dg.dg_project a WHERE a.customerId = {param1} AND a.year = {param2} /*START #param3# AND a.projectId NOT IN ({param3}) #param3# END*/
#\u9879\u76EE\u5408\u5E76\u8303\u56F4--\u5DF2\u9009\u9879\u76EE
DG00124=SELECT a.projectId, a.projectName FROM bdo_dg.dg_project a WHERE a.customerId = {param1} AND a.projectId IN ({param2})
#\u9644\u6CE8
DG00125=SELECT a.autoId, a.customerId, a.projectId, a.knoteId, a.noteNo, a.noteName, a.colCode, a.colName, a.fileName, a.fullPath, a.noteDgValueInfo, a.reportTplId, a.isForbid, a.isEdited, a.isFinished FROM bdo_dg.dg_noteinfo a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.fullPath IS NOT NULL AND a.fullPath <> '' AND ( a.reportTplId = (SELECT tbReportTemplate FROM bdo_dg.dg_project WHERE customerId = {param1} AND projectId = {param2}) OR a.reportTplId IS NULL ) ORDER BY a.sortNo ASC
#TB
DG00126=SELECT a.tbSubjectId, TRIM(a.tbSubjectName) AS tbSubjectName, a.unAuditAmount,a.adjustAmount, a.auditAmount FROM bdo_dg.dg_tbtable a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} 
#TB\u4E00\u7EA7\u79D1\u76EE
DG00127=select a.autoId AS id,a.nodeName AS label,a.projectId AS parentId,a.autoId AS VALUE,'false' AS leaf,'tbsubject' AS typeName from bdo_dg.dg_subjecttree a where a.customerId={param1} and a.projectId={param2} and a.nodeType='{param3}' and a.tbSubjectCode is not null 
#TB\u4E8C\u7EA7\u79D1\u76EE
DG00128=select a.autoId AS id,a.nodeName AS label,a.parentId as parentId,a.subjectId as value,'false' AS leaf,'shenjisubject' AS typeName from bdo_dg.dg_subjecttree a where a.parentId='{param1}' 
#TB\u4E09\u7EA7\u79D1\u76EE \u5BA1\u8BA1Id5420
DG00129=select a.autoId from bdo_dg.dg_auditprogram a where a.customerId={parame1} and a.projectId= {parame2} and indexId={parame3} 
#TB\u56DB\u7EA7\u79D1\u76EE \u5BA1\u8BA1Id5420
DG00130=SELECT a.autoId as id,a.nodeName as label,a.workpaperId as value,a.parentId as parentId,'true' AS leaf,'filesubject'AS typeName,a.indexId AS qtip FROM bdo_dg.dg_subjecttree a WHERE a.parentId ='{param1}' and a.customerId={param2} and a.projectId={param3} AND a.nodeType='FILE' 
#\u9996\u9875
DG00131=select a.customerId, a.customerName, a.yyyy, a.uploadUser as __uuploadUser, max(importDate) as importDate from ( select a.customerId, '' as customerName, a.yyyy, a.uploadUser, a.LAST_UPDATE_DATE as importDate from bdo_fin.fin_importlist a where a.importState = '1' and a.customerId in ({param1}) union select a.customerId, '' AS customerName, a.YEAR as yyyy, a.uploadUser, a.LAST_UPDATE_DATE AS importDate from bdo_fin.fin_tasklist a where a.customerId in ({param1})) a group by a.customerId, a.yyyy order by a.importDate desc 
#\u67E5\u8BE2\u5E95\u7A3F\u81EA\u5B9A\u4E49\u5355\u5143\u683C\u7C7B\u578B
DG00132=SELECT a.customizeStyle FROM bdo_dg.dg_workpaper a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.autoId = {param3}
#\u67E5\u8BE2\u9644\u6CE8\u81EA\u5B9A\u4E49\u5355\u5143\u683C\u7C7B\u578B
DG00133=SELECT a.customizeStyle FROM bdo_dg.dg_noteinfo a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.autoId = {param3}
#\u9644\u6CE8\u5BF9\u5E94\u9644\u6CE8\u6A21\u677F\u62A5\u8868\u79D1\u76EE\u53CA\u5BA1\u5B9A\u6570\u4FEE\u6539
DG00134=SELECT a.autoId, a.customerId, a.projectId, a.knoteId, a.noteNo, a.noteName, b.colCode, b.colName, a.fileName, a.fullPath, a.noteDgValueInfo, a.reportTplId, a.isForbid, a.isEdited, a.isFinished, a.customizeStyle FROM bdo_dg.dg_noteinfo a LEFT JOIN asdb.k_noteinfo b ON a.knoteId = b.autoId LEFT JOIN bdo_dg.dg_project c ON c.tbReportTemplate = b.reportTplID AND a.customerId = c.customerId AND a.projectId = c.projectId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.reportTplId = c.tbReportTemplate ORDER BY a.sortNo ASC
#\u53D6\u5F97\u516C\u5F0F
DG00135=SELECT a.autoId, a.customerId, a.projectId, a.subjectId, a.subjectName, a.formulaType, a.formulaProperty, a.formula, a.formulaText, a.formulaValue, a.formulaCalc, a.formulaAutoId, a.isMutualIndex FROM bdo_dg.dg_projectformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.isMutualIndex = '1' AND a.formula LIKE '{param3}' AND a.ACTIVE_FLAG = '1' AND a.checkType = '0' 
#DG00136=select count(1) as fcount from bdo_dg.dg_file a where a.customerId = {customerId} and a.subjectTreeId = {subjectTreeId} 
DG00136=select count(1) as fcount, a.subjectTreeId from bdo_dg.dg_file a where a.customerId = {customerId} and a.projectId = {projectId} group by a.subjectTreeId
#DG00137=select count(1) as fcount from bdo_dg.dg_attach a where a.customerId = {customerId} and a.subjectTreeId = {subjectTreeId} 
DG00137=select count(1) as fcount, a.subjectTreeId from bdo_dg.dg_attach a where a.customerId = {customerId} and a.projectId = {projectId} group by a.subjectTreeId
DG00138=SELECT audit.customerId, audit.projectId, audit.workpaperEditor, audit.subjectName FROM bdo_dg.dg_auditprogram audit WHERE audit.customerId = {param1} AND audit.projectId = {param2} AND audit.workpaperId = {param3}
#\u6279\u6CE8\u6700\u5927\u7D22\u5F15\u53F7
DG00139=SELECT MAX(a.indexIdSeq) FROM bdo_dg.dg_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.type = {param3} 
#\u6279\u6CE8\u6C47\u603B
DG00140=SELECT * FROM (SELECT a.autoId, a.foreignId, a.indexId, a.content, IFNULL(a.contentText, '') AS postilContentText, a.cellContent, a.postilLevel, a.type, a.createUser AS __ucreateUser, a.auditState, a.CREATION_DATE AS createDate, IFNULL(CASE WHEN a.type = 'P000' THEN b.nodeName ELSE IFNULL(e.nodeName, f.nodeName) END, '') AS userSubjectName, IFNULL(IFNULL( IFNULL( CASE WHEN a.type = 'P000' THEN '\u9879\u76EE' ELSE b.nodeName END, c.fileName ), d.noteName ), '') AS nodeName, a.projectId, a.customerId, NULL as mergeCustomerId, NULL as mergeCustomerName, NULL as mergeProjectId, null as mergeProjectName, a.ACTIVE_FLAG AS ACTIVE_FLAG FROM bdo_dg.dg_annotation a LEFT JOIN bdo_dg.dg_subjecttree b ON b.autoId = a.foreignId AND b.customerId = a.customerId AND b.projectId = a.projectId left join bdo_dg.dg_workpaper c on c.autoId = a.foreignId and c.customerId = a.customerId LEFT JOIN bdo_dg.dg_noteinfo d ON d.autoId = a.foreignId and d.customerId = a.customerId LEFT JOIN bdo_dg.dg_subjecttree e ON e.autoId = a.subjecttreeId AND e.customerId = a.customerId LEFT JOIN bdo_dg.dg_subjecttree f ON f.autoId = b.parentId AND f.customerId = a.customerId WHERE a.customerId = {param1} AND a.projectId = {param2} UNION ALL SELECT a.autoId, a.foreignId, a.indexId, a.content, IFNULL(a.contentText, '') AS postilContentText, a.cellContent, a.postilLevel, a.type, a.createUser AS __ucreateUser, a.auditState, a.CREATION_DATE AS createDate, '' as userSubjectName, IFNULL(a.cellContent, '') as nodeName, a.projectId, a.customerId, a.mergeCustomerId, b.mergeCustomerName, a.mergeProjectId, b.mergeProjectName, a.ACTIVE_FLAG AS ACTIVE_FLAG FROM bdo_hb.hb_annotation a LEFT JOIN bdo_hb.hb_mergeproject b ON a.mergeProjectId = b.mergeProjectId AND a.mergeCustomerId = b.mergeCustomerId and a.projectId = b.projectId and a.customerId = b.customerId WHERE a.customerId = {param1} AND a.projectId = {param2}) a order by a.createDate desc
#\u6279\u6CE8\u6C47\u603B
DG00141=SELECT COUNT(a.autoId) AS postil FROM bdo_dg.dg_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 100 UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_dg.dg_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 100 AND a.ACTIVE_FLAG = '0' UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_dg.dg_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 200 UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_dg.dg_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 200 AND a.ACTIVE_FLAG = '0' UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_dg.dg_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 300 UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_dg.dg_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 300 AND a.ACTIVE_FLAG = '0' UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_dg.dg_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 400 UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_dg.dg_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 400 AND a.ACTIVE_FLAG = '0' UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_dg.dg_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 500 UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_dg.dg_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 500 AND a.ACTIVE_FLAG = '0' UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_dg.dg_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 600 UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_dg.dg_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 600 AND a.ACTIVE_FLAG = '0' UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_dg.dg_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 700 UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_dg.dg_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 700 AND a.ACTIVE_FLAG = '0' 
#\u67E5\u8BE2\u9879\u76EE\u9ED1\u540D\u5355
DG00142=select t1.autoId,t1.projectId,t1.customerId,t1.membersId,concat(t2.name,'(',t2.loginId,')') memberName  from bdo_dg.dg_projectblacklist t1,bdo_base.base_user t2 where t1.projectId = '{param1}' and t1.customerId = '{param2}' /*START #param3# and t1.membersId = '{param3}' #param3# END*/ and t1.membersId = t2.id and t1.active_flag='1'
#\u6279\u6CE8--\u67E5\u8BE2\u5E95\u7A3F
DG00143=SELECT a.autoId, a.customerId, a.parentId, a.projectId, a.subjectId, a.workpaperId, a.indexId, a.nodeName, a.nodeType, a.userSubjectId, a.userSubjectName, a.tbSubjectCode, a.tbSubjectId, a.tbSubjectName, a.sE, a.sC, a.sA, a.sV, a.sP, a.csE, a.csC, a.csA, a.csV, a.csP, a.plansE, a.plansC, a.plansA, a.plansV, a.plansP, a.plancsE, a.plancsC, a.plancsA, a.plancsV, a.plancsP, CONCAT( d.parentId, ',', c.parentId, ',', b.parentId, ',', a.parentId, ',', a.autoId ) AS fullPath FROM bdo_dg.dg_subjecttree a LEFT JOIN bdo_dg.dg_subjecttree b ON a.parentId = b.autoId AND b.ACTIVE_FLAG = '1' AND b.customerId = {param1} AND b.projectId = {param2} LEFT JOIN bdo_dg.dg_subjecttree c ON b.parentId = c.autoId AND c.ACTIVE_FLAG = '1' AND c.customerId = {param1} AND c.projectId = {param2} LEFT JOIN bdo_dg.dg_subjecttree d ON c.parentId = d.autoId AND d.ACTIVE_FLAG = '1' AND d.customerId = {param1} AND d.projectId = {param2} WHERE a.ACTIVE_FLAG = '1' AND a.customerId = {param1} AND a.projectId = {param2} AND a.workpaperId = (SELECT a.autoId FROM bdo_dg.dg_workpaper a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.subjectTreeId = {param3}) AND a.nodeType = 'FILE' ORDER BY a.tbSubjectId, a.tbSubjectCode, a.userSubjectId 
#\u6279\u6CE8\u6C47\u603B\u8868--\u8D22\u52A1\u79D1\u76EE
DG00144=SELECT * FROM (SELECT a.autoId, a.foreignId, a.indexId, a.content, IFNULL(a.contentText,'') AS postilContentText, a.cellContent, a.type, a.createUser AS __ucreateUser, a.auditState, a.CREATION_DATE AS createDate, IFNULL(d.nodeName, e.nodeName) AS userSubjectName, IFNULL(c.nodeName,'') AS fileName, a.projectId, a.customerId, a.ACTIVE_FLAG AS activeFlag, a.postilLevel FROM bdo_dg.dg_annotation a LEFT JOIN bdo_dg.dg_auditprogram b ON b.autoId = a.foreignId AND b.customerId = a.customerId LEFT JOIN bdo_dg.dg_subjecttree c ON a.customerId = c.customerId AND a.projectId = c.projectId AND a.foreignId = c.autoId LEFT JOIN bdo_dg.dg_subjecttree d ON d.autoId = a.subjecttreeId AND d.customerId = a.customerId LEFT JOIN bdo_dg.dg_subjecttree e ON e.autoId = c.parentId AND e.customerId = a.customerId WHERE a.customerId = {param1} AND a.projectId = {param2} AND c.nodeType = 'FILE' AND c.userSubjectId = '{param3}' ) a
#\u6279\u6CE8\u6C47\u603B\u8868--TB\u79D1\u76EE
DG00145=SELECT * FROM (SELECT a.autoId, a.foreignId, a.indexId, a.content, IFNULL(a.contentText,'') AS postilContentText, a.cellContent, a.type, a.createUser AS __ucreateUser, a.auditState, a.CREATION_DATE AS createDate, IFNULL(d.nodeName, e.nodeName) AS userSubjectName, IFNULL(c.nodeName,'') AS fileName, a.projectId, a.customerId, a.ACTIVE_FLAG AS activeFlag, a.postilLevel FROM bdo_dg.dg_annotation a LEFT JOIN bdo_dg.dg_auditprogram b ON b.autoId = a.foreignId AND b.customerId = a.customerId LEFT JOIN bdo_dg.dg_subjecttree c ON a.customerId = c.customerId AND a.projectId = c.projectId AND a.foreignId = c.autoId LEFT JOIN bdo_dg.dg_subjecttree d ON d.autoId = a.subjecttreeId AND d.customerId = a.customerId LEFT JOIN bdo_dg.dg_subjecttree e ON e.autoId = c.parentId AND e.customerId = a.customerId WHERE a.customerId = {param1} AND a.projectId = {param2} AND c.nodeType = 'FILE' AND c.userSubjectId IN (SELECT a.userSubjectId FROM bdo_dg.dg_tbsubjectcontract a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.tbSubjectCode = '{param4}')) a
#\u6279\u6CE8\u6C47\u603B\u8868--\u9879\u76EE
DG00146=SELECT * FROM (SELECT a.autoId, a.foreignId, a.indexId, a.content, IFNULL(a.contentText,'') AS postilContentText, a.cellContent, a.postilLevel, a.type, a.createUser AS __ucreateUser, a.auditState, a.CREATION_DATE AS createDate, CASE WHEN a.type = 'P000' THEN c.nodeName ELSE IFNULL(d.nodeName, e.nodeName) END AS userSubjectName, CASE WHEN a.type = 'P000' THEN '\u9879\u76EE' ELSE IFNULL(c.nodeName,'') END AS fileName, a.projectId, a.customerId, a.ACTIVE_FLAG AS activeFlag FROM bdo_dg.dg_annotation a LEFT JOIN bdo_dg.dg_auditprogram b ON b.autoId = a.foreignId AND b.customerId = a.customerId LEFT JOIN bdo_dg.dg_subjecttree c ON a.customerId = c.customerId AND a.projectId = c.projectId AND a.foreignId = c.autoId LEFT JOIN bdo_dg.dg_subjecttree d ON d.autoId = a.subjecttreeId AND d.customerId = a.customerId LEFT JOIN bdo_dg.dg_subjecttree e ON e.autoId = c.parentId AND e.customerId = a.customerId WHERE a.customerId = {param1} AND a.projectId = {param2} UNION ALL SELECT a.autoId, a.foreignId, a.indexId, a.content, IFNULL(a.contentText, '') AS postilContentText, a.cellContent, a.postilLevel, a.type, a.createUser AS __ucreateUser, a.auditState, a.CREATION_DATE AS createDate, '' as userSubjectName, IFNULL(a.cellContent, '') as fileName, a.projectId, a.customerId, a.ACTIVE_FLAG AS activeFlag FROM bdo_hb.hb_annotation a LEFT JOIN bdo_hb.hb_mergeproject b ON a.mergeProjectId = b.mergeProjectId AND a.mergeCustomerId = b.mergeCustomerId and a.projectId = b.projectId and a.customerId = b.customerId WHERE a.customerId = {param1} AND a.projectId = {param2}) a
#\u67E5\u8BE2\u62A5\u8868\u8BA1\u7B97\u516C\u5F0F
DG00147=SELECT vocationId,customerId,projectId,reportSubjectId,reportSubjectName,IF(cusCalFun = '',NULL,cusCalFun) cusCalFun FROM bdo_dg.dg_projecttb WHERE vocationId={vocationId}  AND customerId = {customerId} AND projectId = {projectId}  GROUP BY reportSubjectId HAVING cusCalFun IS NOT NULL
#\u5355\u5143\u683C\u6240\u6D89\u53CA\u5230\u7684\u4EA4\u53C9\u7D22\u5F15\u7684\u6821\u9A8C\u516C\u5F0F
DG00148=SELECT a.autoId, a.formulaText FROM bdo_dg.dg_projectformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.checkType = '0' AND ( a.formula LIKE CONCAT( (SELECT CONCAT('p', a.autoId, '=') FROM bdo_dg.dg_projectlstag a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.ACTIVE_FLAG = '1' AND a.tagDgId = {param5} AND a.tagType = '{param3}' AND a.tagPosition = '{param4}'), '%' ) OR a.formula LIKE CONCAT( '%', (SELECT  CONCAT('=', 'p', a.autoId) FROM bdo_dg.dg_projectlstag a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.ACTIVE_FLAG = '1' AND a.tagDgId = {param5} AND a.tagType = '{param3}' AND a.tagPosition = '{param4}') ) )
#\u9879\u76EE\u9644\u6CE8\u72B6\u6001
DG00149=SELECT IF( totalCount = 0, 0, ROUND( finishedCount * 100 / totalCount )) AS percent FROM ( SELECT SUM(IF(a.isFinished = '1', 1, 0)) finishedCount, IFNULL(SUM(1), 0) AS totalCount FROM bdo_dg.dg_noteinfo a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.isForbid = 0 ) a
#\u5355\u4F53\u9879\u76EE\u6279\u6CE8\u8282\u70B9\u540D\u79F0
DG00150=SELECT IFNULL( IFNULL( IFNULL( CASE WHEN a.type = 'P000' THEN '\u9879\u76EE' ELSE b.nodeName END, c.fileName ), d.noteName ), '' ) AS nodeName FROM bdo_dg.dg_annotation a LEFT JOIN bdo_dg.dg_subjecttree b ON b.autoId = a.foreignId AND b.customerId = a.customerId AND b.projectId = a.projectId LEFT JOIN bdo_dg.dg_workpaper c ON c.autoId = a.foreignId AND c.customerId = a.customerId LEFT JOIN bdo_dg.dg_noteinfo d ON d.autoId = a.foreignId AND d.customerId = a.customerId LEFT JOIN bdo_dg.dg_subjecttree e ON e.autoId = a.subjecttreeId AND e.customerId = a.customerId LEFT JOIN bdo_dg.dg_subjecttree f ON f.autoId = b.parentId AND f.customerId = a.customerId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.indexId = '{param3}'
#\u5408\u5E76\u9879\u76EE\u6279\u6CE8\u8282\u70B9\u540D\u79F0
#DG00151=
#\u6279\u6CE8\u4E0B\u7684\u8BC4\u8BBA
DG00152=SELECT a.autoId, a.customerId, b.indexId, a.createUser AS __ucreateUser, DATE_FORMAT( a.CREATION_DATE, '%Y-%m-%d %H:%i:%s' ) AS createDate, a.content, IFNULL(a.contentText,'') AS postilContentText, a.cellContent, NULL AS comments, a.ACTIVE_FLAG AS activeFlag, ( CASE WHEN a.CREATED_BY = {userId} THEN 'true' ELSE 'false' END ) AS isAuthor, a.commentedUser AS __ucommentedUser, a.TYPE, a.commentId, a.annotationId FROM bdo_dg.dg_comment a LEFT JOIN bdo_dg.dg_annotation b ON b.autoId = a.annotationId AND a.customerId = b.customerId WHERE b.customerId = {param1} AND b.projectId = {param2} /*START #param3# AND b.autoId = {param3} #param3# END*/ /*START #param4# AND b.auditState = {param4}  #param4# END*/ AND b.foreignId = {param5} AND b.type = '{param6}' /*START #param7# AND a.autoId = {param7}  #param7# END*/
#\u9644\u6CE8\u6587\u4EF6\u65F6\u95F4
DG00153=SELECT DATE_FORMAT( a.LAST_UPDATE_DATE, '%Y%m%d%H%i%s' ) AS TIME FROM bdo_dg.dg_noteinfo a WHERE a.autoId = {param1} AND a.customerId = {param2} AND a.projectId = {param3}
#\u5E95\u7A3F\u9644\u4EF6--\u6839\u636E\u88AB\u5173\u8054\u7684\u5E95\u7A3FID\u53D6\u5F97\u5E95\u7A3F
DG00154=SELECT a.autoId, a.subjectId, a.subjectName, a.fileName, a.customizeStyle, a.subjectTreeId FROM bdo_dg.dg_workpaper a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.autoId IN ({param3})
#\u6279\u91CF\u4E0A\u4F20\u5E95\u7A3F--\u67E5\u8BE2\u5B9E\u65BD\u7A0B\u5E8F
DG00155=SELECT a.autoId, a.customerId, a.projectId, a.subjecttreeId, CONCAT(a.indexId, '-', a.dgName) AS dgName, a.workpaperId, a.indexId FROM bdo_dg.dg_auditprogram a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.level = 1 AND CONCAT(a.indexId, '-', a.dgName) = '{param3}' AND a.ACTIVE_FLAG = '1' AND a.workpaperId IS NOT NULL 
#\u6839\u636E\u7A0B\u5E8FID\u67E5\u627E\u5E95\u7A3F
DG00156=SELECT a.autoId, a.customerId, a.projectId, a.fullPath FROM bdo_dg.dg_workpaper a LEFT JOIN bdo_dg.dg_auditprogram b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.autoId = b.workpaperId WHERE b.customerId = {param1} AND b.projectId = {param2} AND b.autoId = {param3} 
#\u62A5\u544A\u6A21\u677F
DG00157=SELECT a.templateName, a.templateFullPath FROM bdo_dg.dg_reporttemplate a WHERE a.customerId = {param1} AND a.projectId = {param2} 
DG00158=SELECT w.id, w.columnName AS columnId, w.columnNameChi AS label, '' AS VALUE, '' AS parentId, 'false' AS leaf FROM bdo_wind.wind_defcolumn w WHERE w.ACTIVE_FLAG = 1 AND w.columnName like 'title%'
DG00159=SELECT w.id, w.columnName AS columnId, CONCAT( w.columnName, '-', w.columnNameChi ) AS label, CONCAT( w.columnName, '-', w.columnNameChi ) AS VALUE , CASE w.tableName WHEN 'wind_balance_sheet' THEN '318' WHEN 'wind_profit_statement' THEN '319' WHEN 'wind_cash_flow_statement' THEN '320' ELSE '' END AS parentId, 'true' AS leaf, 'subject' AS typeName FROM bdo_wind.wind_defcolumn w WHERE w.ACTIVE_FLAG = 1 AND w.columnName not in(select columnName from bdo_wind.wind_defcolumn WHERE w.columnName like 'title%')################## \u5E95\u7A3F\u4E2D\u5FC3 END ###############=======
DG00160=SELECT autoId, departmentId, customerId, projectId, parentId, typeId, level, indexId, subjecttreeId, auditprogramId, subjectId, subjectName, programNamePre, programNameAft, auditDesc, auditConclusion, confirmStatusPre, confirmStatusPreName, confirmStatusAft, confirmStatusAftName, csE, csC, csA, csV, csP, sE, sC, sA, sV, sP, csEOriginal, csCOriginal, csAOriginal, csVOriginal, csPOriginal, sEOriginal, sCOriginal, sAOriginal, sVOriginal, sPOriginal, workpaperId, workpaperEditor, required, state, updateFlag, customizeFlag, reason, remark, dgName, status, audit3, audit3Date, audit2, audit2Date, audit1, audit1Date, dgparam FROM bdo_dg.dg_auditprogram WHERE customerId  = {customerId} AND projectId = {projectId} AND subjecttreeId = {subjecttreeId} AND level = 0 AND ACTIVE_FLAG = 1
#\u67E5\u8BE2\u5BA1\u8BA1\u7A0B\u5E8F\u662F\u5426\u6709\u5B50\u7A0B\u5E8F
DG00161=SELECT autoId, departmentId, customerId, projectId, parentId, typeId, level, indexId, subjecttreeId, auditprogramId, subjectId, subjectName, programNamePre, programNameAft, auditDesc, auditConclusion, confirmStatusPre, confirmStatusPreName, confirmStatusAft, confirmStatusAftName, csE, csC, csA, csV, csP, sE, sC, sA, sV, sP, csEOriginal, csCOriginal, csAOriginal, csVOriginal, csPOriginal, sEOriginal, sCOriginal, sAOriginal, sVOriginal, sPOriginal, workpaperId, workpaperEditor, required, state, updateFlag, customizeFlag, reason, remark, dgName, status, audit3, audit3Date, audit2, audit2Date, audit1, audit1Date, dgparam FROM bdo_dg.dg_auditprogram WHERE parentId IN ({parentId}) AND level = 1
#\u67E5\u8BE2TB\u4E0B\u7684\u6240\u6709\u8D22\u52A1\u79D1\u76EE
DG00162=SELECT autoId, customerId, yyyy, projectId, vocationId, tbSubjectId, tbSubjectCode, tbSubjectName, baseSubjectId, baseSubjectName, reportSubjectId, reportSubjectName, userSubjectId, userSubjectName, userDefined, plansE, plansC, plansA, plansV, plansP, plancsE, plancsC, plancsA, plancsV, plancsP, subjectEditors, debitRemain, creditRemain, debitTotalOcc, creditTotalOcc, tranDebitTotalOcc, tranCreditTotalOcc, debitBalance, creditBalance, direction, remain, balance, adjustValue, cusAdjustValue, level0, isLeaf0 FROM bdo_dg.dg_tbsubjectcontract contract WHERE contract.customerId = {param1} AND contract.projectId={param2} AND contract.yyyy={param3} AND contract.tbSubjectCode='{param4}'
#\u67E5\u8BE2\u79D1\u76EE\u4E0B\u7684\u5E95\u7A3F
DG00163=SELECT autoId, customerId, projectId, subjectId, fileIndexId, subjectName, fileName, fullPath, status, audit3, audit3Date, audit2, audit2Date, audit1, audit1Date, customizeStyle, subjectTreeId, indexIdSeq, sortNum FROM bdo_dg.dg_workpaper workpaper WHERE workpaper.customerId = {customerId} AND workpaper.projectId = {projectId} AND workpaper.subjectId = '{subjectId}'
#\u67E5\u8BE2\u5E95\u7A3F\u4E0B\u7684\u6279\u6CE8
DG00164=SELECT autoId, customerId, projectId, foreignId, indexId, content, IFNULL(contentText,'') AS postilContentText, cellContent, type, createUser, auditState, subjectTreeId, indexIdSeq, sortNum FROM bdo_dg.dg_annotation tation WHERE tation.customerId = {customerId} AND tation.projectId = {projectId} and tation.foreignId in ({foreignId})
#\u67E5\u8BE2\u6279\u6CE8\u4E0B\u7684\u8BC4\u8BBA
DG00165=SELECT autoId, annotationId, customerId, projectId, commentId, type, content, cellContent, createUser, commentedUser FROM bdo_dg.dg_comment comment WHERE comment.customerId = {customerId} AND comment.projectId = {projectId} AND comment.annotationId in ({annotationId})
#\u67E5\u8BE2\u5E95\u7A3F\u4E0B\u7684\u9644\u4EF6
DG00166=SELECT autoId, customerId, projectId, auditprogramId, workpaperId, fileIndexId, fileName, fileType, suffix, fullPath, subjectTreeId, indexIdSeq, sortNum, isReferred, referredDgId FROM bdo_dg.dg_attach attach WHERE attach.customerId = {customerId} AND attach.projectId = {projectId} AND attach.workpaperId in ({workpaperId})
#\u79D1\u76EE\u6D89\u53CA\u7684\u516C\u5F0F\u548C\u5E95\u7A3F\u6D89\u53CA\u7684\u516C\u5F0F
DG00167=SELECT autoId, customerId, projectId, infoType, infoId, infoName, infoFormula, infoVersion, remark FROM bdo_dg.dg_referredformula mula WHERE mula.customerId = {customerId} AND mula.projectId = {projectId} AND mula.infoId in ('{infoId}') AND mula.infoType = '{infoType}'
#\u67E5\u8BE2\u5E95\u7A3F\u6D89\u53CA\u5230\u7684\u6807\u7B7E
DG00168=SELECT autoId, customerId, projectId, tagName, tagValue, tagPosition, tagInfo, tagType, tagDgId, infoVersion, remark FROM bdo_dg.dg_projectlstag tag WHERE tag.customerId = {customerId} AND tag.projectId = {projectId} AND tag.tagType = '{tagType}' AND tag.tagDgId in ({tagDgId})
#\u67E5\u8BE2\u5BA1\u8BA1\u7A0B\u5E8F
DG00169=SELECT autoId, departmentId, customerId, projectId, parentId, typeId level, indexId, subjecttreeId, auditprogramId, subjectId, subjectName, programNamePre, programNameAft, auditDesc, auditConclusion, confirmStatusPre, confirmStatusPreName, confirmStatusAft, confirmStatusAftName, csE, csC, csA, csV, csP, sE, sC, sA, sV, sP, csEOriginal, csCOriginal, csAOriginal, csVOriginal, csPOriginal, sEOriginal, sCOriginal, sAOriginal, sVOriginal, sPOriginal, workpaperId, workpaperEditor, required, state, updateFlag, customizeFlag, reason, remark, dgName, status, audit3, audit3Date, audit2, audit2Date, audit1, audit1Date, dgparam FROM bdo_dg.dg_auditprogram pro WHERE pro.customerId = {customerId} AND pro.projectId = {projectId} AND pro.subjectId = '{subjectId}' AND pro.level = {level} /*START #param1# and pro.parentId = '{param1}' #param1# END*/
#\u67E5\u8BE2\u5E95\u7A3F\u7F16\u5236\u4EBA
DG00170=SELECT workpaperEditor from bdo_dg.dg_auditprogram WHERE customerId = {customerId} AND projectId = {projectId} AND workpaperId = {workpaperId}
#\u5BA1\u8BA1\u5E95\u7A3F\u6587\u4EF6\u5386\u53F2\u7248\u672C--MAX\u6392\u5E8F\u53F7
DG00171=SELECT MAX(a.sortNum) AS maxSortSum FROM bdo_dg.dg_workpaperbackup a WHERE a.customerId = {param1} AND a.projectId = {param2}
#\u83B7\u53D6\u6240\u6709\u6279\u6CE8
DG00172=SELECT a.autoId, a.customerId FROM bdo_dg.dg_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.foreignId = {param3} #param3# END*/
#\u5BA1\u8BA1\u8C03\u6574\u6C47\u603B\u5BFC\u51FA
DG00173=SELECT CASE a.status WHEN '1' THEN '\u8C03\u6574' WHEN '2' THEN '\u8C03\u6574' WHEN '0' THEN '\u672A\u8C03\u6574' END as status,CASE a.dirction WHEN '-1' THEN a.occurValue END AS 'minusOccurValue',CASE a.dirction WHEN '1' THEN a.occurValue END AS 'plusOccurValue',a.autoId,a.workpaperId,a.assItemId,a.assItemName,a.indexId,a.accPackageId,a.customerId,a.projectId,a.yyyy AS subjectYear,a.subjectId,a.voucherId,a.serail,a.summary,a.dirction,a.occurValue,a.currValue,a.currency,a.subjectname1 AS subjectName,a.subjectFullName1 AS fullName,a.adjustType,a.adjustSubjectTB,a.adjustSubjectCodeReport,a.adjustSubjectReport,a.reason,a.fillUser AS __ufillUserName,a.ACTIVE_FLAG FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId={param1} AND a.projectId={param2} /*START #param3# and workpaperId IN({param3}) #param3# END*/ /*START #param4# and adjustType = '{param4}' #param4# END*/ /*START #param5# and subjectId = '{param5}' #param5# END*/ ORDER BY a.indexId 
#\u83B7\u53D6\u5BA1\u8BA1\u8C03\u6574\u8BB0\u5F55
DG00174=SELECT a.autoId, a.customerId, a.projectId, a.indexId FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.adjustType = '{param3}'
#\u83B7\u53D6\u5BA1\u8BA1\u8C03\u6574\u5206\u5F55\u7D22\u5F15\u8BB0\u5F55
DG00175=SELECT a.autoId, a.customerId, a.projectId, a.workpaperId FROM bdo_dg.dg_entryadjustindex a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.indexKey IN ({param3})
#\u521D\u59CB\u5316\u9644\u6CE8\u5339\u914D\u5E95\u7A3F
DG00176=SELECT a.noteNo, a.noteName, a.noteSheetIndex, a.noteRowNum, a.noteColNum, a.auditprogramId, a.dgIndexId, a.dgName, a.dgSheetIndex, a.dgRowIndex, a.dgColIndex, a.dgRangeStr, a.reportTplId, c.autoId AS noteId, c.fullPath AS notePath, e.autoId AS dgId, e.fullPath AS dgPath, e.fileName AS dgFileName FROM asdb.k_notematchdg a LEFT JOIN bdo_dg.dg_project b ON b.tbReportTemplate = a.reportTplId LEFT JOIN bdo_dg.dg_noteinfo c ON c.noteNo = a.noteNo AND c.customerId = b.customerId AND c.projectId = b.projectId LEFT JOIN ( SELECT a.customerId, a.projectId, a.workpaperId, a.parentId, b.auditprogramId FROM bdo_dg.dg_auditprogram a LEFT JOIN bdo_dg.dg_auditprogram b ON a.parentId = b.autoId AND a.customerId = b.customerId AND a.projectId = b.projectId AND a.indexId = CONCAT( b.indexId, '-0001' ) WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.LEVEL = 1 ) d ON d.customerId = b.customerId AND d.projectId = b.projectId AND a.auditprogramId = d.auditprogramId LEFT JOIN bdo_dg.dg_workpaper e ON d.customerId = e.customerId AND d.projectId = e.projectId AND d.workpaperId = e.autoId WHERE b.customerId = {param1} AND b.projectId = {param2} AND a.noteNo = {param3} AND a.noteName = {param4} AND a.noteType = {param5} AND a.isPreVal = {param6} AND d.workpaperId IS NOT NULL
#\u67E5\u8BE2\u5BA1\u8BA1\u8C03\u6574
DG00178=SELECT autoId,accPackageId,customerId,yyyy,projectId,indexId,voucherId,typeId,vchDate,serail,summary,dirction,occurValue,currRate,currValue,currency,quantity,unitPrice,unitName,adjustType,tbSubjectCode,adjustSubjectTB,assItemId,assItemName,adjustSubjectCodeReport,adjustSubjectReport,subjectId,subjectname1,subjectFullName1,fillUser,auditUser,status,workpaperId,reason FROM bdo_dg.dg_subjectentryadjust WHERE customerId = {customerId} AND projectId = {projectId} AND workpaperId in({workpaperId}) AND adjustType = 2 
#\u5E95\u7A3F\u662F\u5426\u5B58\u5728
DG00179=SELECT COUNT(1) AS num FROM bdo_dg.dg_workpaper a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.autoId = {param3}
#\u5E95\u7A3F\u9644\u4EF6\u662F\u5426\u5B58\u5728
DG00180=SELECT COUNT(1) AS num FROM bdo_dg.dg_attach a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.autoId = {param3}
#\u9644\u6CE8\u662F\u5426\u5B58\u5728
DG00181=SELECT COUNT(1) AS num FROM bdo_dg.dg_noteinfo a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.autoId = {param3}
#\u91CD\u8981\u6027\u6C34\u5E73\u67E5\u8BE2
DG00182=SELECT autoId,projectId,customerId,materIndex,editUser,editDate,auditedUnit,reviewUser,reviewDate,belongDate,reason,auditUser,auditDate,settingType,settingTypeValue1,settingTypeValue2,settingValue1,settingRate1,settingImportValue1,settingRateOne1,settingRateTwo1,settingValue2,settingRate2,settingImportValue2,settingRateOne2,settingRateTwo2,settingValue3,settingRate3,settingImportValue3,settingRateOne3,settingRateTwo3,settingValue4,settingRate4,settingImportValue4,settingRateOne4,settingRateTwo4,constitute1,constitute2,constitute3,constitute4 FROM bdo_dg.dg_materiality WHERE customerId = {customerId} AND projectId = {projectId} 
#\u67E5\u8BE2TB\u79D1\u76EE\u5BF9\u7167\u8868
DG00183=SELECT tbSubjectCode FROM bdo_dg.dg_tbsubjectcontract WHERE customerId = {customerId} AND projectId = {projectId} AND yyyy = {yyyy} AND userSubjectId = '{userSubjectId}'
#\u67E5\u770B\u79D1\u76EE\u662F\u5426\u751F\u6210\u5BA1\u8BA1\u7A0B\u5E8F
#DG00184=SELECT IFNULL(COUNT(1), 0) AS programCount FROM bdo_dg.dg_tbsubjectcontract b INNER JOIN bdo_dg.dg_auditprogram a ON a.customerId = {param1} AND a.projectId = {param2} AND b.userSubjectId = a.subjectId AND a.level = 0 WHERE b.autoId = {param3} AND b.customerId = {param1} AND b.projectId = {param2}
DG00184=SELECT IFNULL(COUNT(1), 0) AS programCount FROM bdo_dg.dg_tbsubjectcontract b INNER JOIN bdo_dg.dg_subjecttree a ON a.customerId = {param1} AND a.projectId = {param2} AND b.userSubjectId = a.userSubjectId  AND b.tbSubjectCode = a.tbSubjectCode WHERE b.autoId = {param3} AND b.customerId = {param1} AND b.projectId = {param2}
#\u67E5\u770B\u5F15\u7528\u7A0B\u5E8F\u662F\u5426\u5DF2\u7ECF\u5F15\u7528
DG00185=SELECT a.autoId FROM bdo_dg.dg_auditprogram a WHERE a.customerId = {customerId} AND a.projectId = {projectId} AND  a.auditprogramId = {auditprogramId}
#\u67E5\u8BE2\u9879\u76EETB\u79D1\u76EE\u62A5\u8868\u8BA1\u7B97\u516C\u5F0F
DG00186=SELECT autoId,vocationId,customerId,projectId,departmentId,tbSubjectId,tbSubjectName,reportSubjectId,reportSubjectName,subjectType1,cusCalFun,sortNo,isSubject,calFun FROM bdo_dg.dg_projecttb WHERE customerId = {customerId} AND projectId = {projectId} AND cusCalFun LIKE CONCAT('%','{tbSubjectId}','%') 
#\u67E5\u8BE2\u9879\u76EETB\u79D1\u76EE\u8BA1\u7B97\u516C\u5F0F
DG00187=SELECT autoId,vocationId,customerId,projectId,departmentId,tbSubjectId,tbSubjectName,reportSubjectId,reportSubjectName,subjectType1,cusCalFun,sortNo,isSubject,calFun FROM bdo_dg.dg_projecttb WHERE customerId = {customerId} AND projectId = {projectId} AND calFun LIKE CONCAT('%','{tbSubjectId}','%') 
#\u67E5\u8BE2\u5BA1\u8BA1\u7A0B\u5E8F\u8868\uFF0C\u83B7\u53D6\u751F\u6210\u5E95\u7A3F\u7684\u5B9E\u65BD\u7A0B\u5E8F
DG00188=SELECT dgName,indexId,workpaperId,workpaperEditor FROM bdo_dg.dg_auditprogram WHERE customerId = {param1} AND projectId = {param2} AND level = {param5} AND workpaperId IS NOT NULL 
#\u5BA1\u8BA1\u8C03\u6574\u79D1\u76EE
##DG00189=SELECT a.customerId, a.projectId, a.yyyy, GROUP_CONCAT( DISTINCT (a.indexId) SEPARATOR ',' ) AS indexId, (SUM(adjust1) - SUM(adjust2)) * a.direction AS adjust, SUM(adjust1) AS adjust1, SUM(adjust2) AS adjust2, a.subjectId, a.subjectname1, a.subjectFullName1, a.direction, a.assItemId, a.assItemName FROM ( SELECT a.customerId, a.projectId, a.yyyy, a.indexId, CASE WHEN a.dirction <> - 1 THEN a.occurValue ELSE 0 END AS adjust1, CASE WHEN a.dirction <> - 1 THEN 0 ELSE a.occurValue END AS adjust2, a.subjectId, a.subjectname1, a.subjectFullName1, a.direction, a.assItemId, a.assItemName FROM ( SELECT a.autoId, a.customerId, a.yyyy, a.projectId, a.indexId, a.dirction, a.occurValue, a.subjectId, a.subjectname1, a.subjectFullName1, b.direction, a.assItemId, a.assItemName FROM bdo_dg.dg_subjectentryadjust a LEFT JOIN bdo_fin.fin_account b ON a.customerId = b.customerId AND a.yyyy = b.subYearMonth AND a.subjectId LIKE CONCAT(b.subjectId, '%') WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.yyyy = {param3} #param3# END*/ AND a. STATUS = 1 /*START #param5# AND a.adjustType = {param5} #param5# END*/ /*START #param6# AND a.workpaperId = {param6} #param6# END*/ AND a.subjectId LIKE '{param4}%' GROUP BY a.autoId ) a ) a WHERE 1 = 1 /*START #param8# AND a.assItemId IS NOT NULL #param8# END*/ GROUP BY a.customerId, a.projectId, a.yyyy, a.{param7}
DG00189=SELECT a.customerId, a.projectId, a.yyyy, GROUP_CONCAT( DISTINCT (a.indexId) SEPARATOR ',' ) AS indexId, SUM(adjust1) - SUM(adjust2) AS adjust, SUM(adjust1) AS adjust1, SUM(adjust2) AS adjust2, a.subjectId, TRIM(a.subjectname1) AS subjectname1, TRIM(a.subjectFullName1) AS subjectFullName1, IFNULL(a.assItemId, '') AS assItemId, IFNULL(TRIM(a.assItemName), '') AS assItemName FROM ( SELECT a.customerId, a.projectId, a.yyyy, a.indexId, CASE WHEN a.dirction <> - 1 THEN a.occurValue ELSE 0 END AS adjust1, CASE WHEN a.dirction <> - 1 THEN 0 ELSE a.occurValue END AS adjust2, a.subjectId, a.subjectname1, a.subjectFullName1, a.assItemId, a.assItemName, a.dirction FROM ( SELECT a.autoId, a.customerId, a.yyyy, a.projectId, a.indexId, a.dirction, a.occurValue, a.subjectId, a.subjectname1, a.subjectFullName1, a.assItemId, a.assItemName FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.yyyy = {param3} #param3# END*/ AND a. STATUS = 1 /*START #param5# AND a.adjustType = {param5} #param5# END*/ /*START #param6# AND a.workpaperId = {param6} #param6# END*/ AND a.subjectId LIKE '{param4}%' GROUP BY a.autoId ) a ) a GROUP BY a.customerId, a.projectId, a.yyyy, a.subjectId, a.assItemId
#\u83B7\u53D6\u5BA1\u8BA1\u6570\u636E\u5E95\u7A3F\u4F4D\u7F6E
DG00190=SELECT a.autoId, a.customerId, a.projectId, a.workpaperId, a.adjustType, a.subjectIdLocationCur, a.subjectNameLocationCur, a.assItemIdLocationCur, a.assItemNameLocationCur, a.adjustLocationCur, a.debitLocationCur, a.creditLocationCur, a.indexLocationCur, a.itemStartRowCur, a.itemEndRowCur, a.subjectIdLocationLast, a.subjectNameLocationLast, a.assItemIdLocationLast, a.assItemNameLocationLast, a.adjustLocationLast, a.debitLocationLast, a.creditLocationLast, a.indexLocationLast, a.itemStartRowLast, a.itemEndRowLast, a.remark FROM bdo_dg.dg_adjustdglocation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.workpaperId = {param3} AND a.adjustType = {param4}
#\u5BF9\u5916\u62A5\u544A\u5BA1\u6279\u5355 \u5173\u8054\u67E5\u8BE2
DG00191=SELECT p.signUser __usignUser,ext.signUserDate,p.audit1 __uaudit1,ext.audit1Date,p.audit2 __uaudit2,ext.audit2Date,p.signAccountant2 __usignAccountant2,ext.signAccountant2Date,p.signAccountant3 __usignAccountant3,ext.signAccountant3Date,p.reviewPartner __ureviewPartner,ext.reviewPartnerDate,p.reaReviewer __ureaReviewer,ext.reaReviewerDate,p.issuedPeople __uissuedPeople,ext.issuedPeopleDate FROM bdo_dg.dg_project p LEFT JOIN bdo_dg.dg_projectext ext ON p.projectId = ext.projectId AND p.customerId = ext.customerId WHERE p.customerId = {param1} AND p.projectId = {param2} 
#\u67E5\u8BE2\u5F53\u524D\u5BA2\u6237\u7684\u9879\u76EE\u7684TB\u79D1\u76EE\u6570\u91CF
#DG00192=select count(1) as tbCount from bdo_dg.dg_projecttb where customerId = {customerId} AND projectId = {projectId}
DG00192=select max(sortNo) as tbCount from bdo_dg.dg_projecttb where customerId = {customerId} AND projectId = {projectId}
#\u8C03\u6574\u5206\u5F55\u6C47\u603B\u67E5\u8BE2
DG00193=SELECT a.assItemName,a.autoId,a.taxEffect,a.cbType,a.indexId,a.accPackageId,a.customerId,a.projectId,a.yyyy AS subjectYear,a.subjectId,a.voucherId,a.serail,a.summary,a.dirction,IF(a.dirction < 0,a.occurValue,'') AS minusOccurValue,IF(a.dirction > 0,a.occurValue,'') AS plusOccurValue,a.occurValue,a.currValue,a.currency,a.subjectname1 AS subjectName,a.subjectFullName1 AS fullName,a.adjustType,a.adjustSubjectTB,a.adjustSubjectCodeReport,a.adjustSubjectReport,a.status,if(a.ACTIVE_FLAG = '0','0',if(a.status = '1',a.status,'0')) as statuss,a.reason,a.fillUser AS __ufillUserName,a.workpaperId,a.ACTIVE_FLAG,DATE_FORMAT(a.LAST_UPDATE_DATE,'%Y-%m-%d %H:%i:%s') AS lastUpdateDate FROM bdo_dg.dg_subjectentryadjust a /*START #param11#,bdo_base.base_user b #param11# END*/ WHERE a.customerId={param1} AND a.projectId={param2} /*START #param4# AND a.adjustType = '{param4}' #param4# END*/ /*START #param6# AND a.yyyy = {param6} #param6# END*/ /*START #param8# AND a.status = '{param8}' #param8# END*/ /*START #param9# AND a.adjustSubjectTB = '{param9}' #param9# END*/ /*START #param10# AND a.assItemName LIKE '%{param10}%' #param10# END*/ /*START #param11# AND a.fillUser = b.id AND b.NAME LIKE '%{param11}%' #param11# END*/ ORDER BY a.yyyy DESC, a.indexId, a.occurValue DESC 
#\u67E5\u8BE2\u5F53\u524DTB\u79D1\u76EE
DG00194=SELECT autoId AS tbId,tbsubjectName AS tbSubjectName,tbSubjectId AS subjectCode,isSubject,calFun,reportSubjectId,reportSubjectName,LEFT(subjectType1,1) AS subjectType1,IF(LENGTH(subjectType1) >= 3,LEFT(subjectType1,3),'') AS subjectType2,sortNo FROM bdo_dg.dg_projecttb WHERE projectId = {projectId} AND customerId = {customerId} AND tbSubjectId ={tbSubjectId} 
#\u67E5\u8BE2\u5176\u4ED6\u79D1\u76EE \u79D1\u76EE\u6811\u4E13\u4E1A
DG00195=SELECT aa.id, aa.label AS NAME, aa.label, aa. VALUE , aa.parentId, aa.leaf  FROM ( SELECT a.subjectId AS id, CONCAT( a.subjectId, '-', a.subjectFullName ) AS label, a.subjectId AS VALUE ,  '14' AS parentId, IF( a.isLeaf = 0, 'false', 'true' ) AS leaf FROM bdo_dg.dg_customersubject a WHERE a.customerId = {param9} AND projectId = {param8} AND a.yyyy = {param10} and  LEFT(a.subjectId, 1) NOT IN (1,2,3,4,5,6) ) aa WHERE 1 = 1 AND aa.parentId NOT IN ('42', '41', '40')  ORDER BY aa.id, aa.value
#\u6839\u636E\u90E8\u95E8id \u67E5\u8BE2\u5F53\u524D\u90E8\u95E8\u4E0B\u6240\u6709\u5BA2\u6237
DG00196=SELECT customerId,customerName from bdo_dg.dg_project where customerId in (SELECT customerId from bdo_dg.dg_tbsubjectkeyresult where departId = {param1} GROUP BY customerId)group by customerId
#\u83B7\u53D6\u9879\u76EE\u8D1F\u8D23\u4EBA
DG00197=SELECT a.manager FROM bdo_dg.dg_project a WHERE a.customerId = {param1} AND a.projectId = {param2}
#\u83B7\u53D6\u6240\u6709\u4E0D\u7B49\u4E8E\u96F6\u7684\u5BA1\u5B9A\u6570\u7684\u79D1\u76EE
#DG00198=SELECT b.colCode, IFNULL(( b.adjustedAmount + IFNULL(c.occurValue, 0)), 0 ) AS auditedAmount FROM bdo_dg.dg_unauditreport b LEFT JOIN ( SELECT SUM( IFNULL(occurValue, 0) * dirction ) AS occurValue, adjustSubjectCodeReport AS reportSubjectId, customerId, projectId FROM bdo_dg.dg_subjectentryadjust WHERE customerId = {param1} AND projectId = {param2} AND adjustType = 2 AND ACTIVE_FLAG = 1 GROUP BY adjustSubjectCodeReport ) c ON b.customerId = c.customerId AND b.projectId = c.projectId AND b.colCode = c.reportSubjectId WHERE b.customerId = {param1} AND b.projectId = {param2}
DG00198=SELECT a.colCode, a.colDisp, a.auditedAmount, a.auditedRemain FROM ( SELECT a.colCode, a.colDisp, IFNULL(( a.adjustedAmount + IFNULL(b.occurValue, 0)), 0 ) AS auditedAmount, ( IFNULL(b2.occurValue, 0) + a.adjustedRemain ) AS auditedRemain FROM bdo_dg.dg_unauditreport a INNER JOIN ( SELECT colCode AS subjectId, tableDiv FROM asdb.k_reporttemplate WHERE vocationId = ( SELECT tbReportTemplate FROM bdo_dg.dg_project WHERE customerId = {param1} AND projectId = {param2} )) AS t1 ON colCode = t1.subjectId LEFT JOIN ( SELECT SUM(adjustValue) AS occurValue, reportSubjectId, customerId, projectId FROM bdo_dg.dg_tbsubjectcontract WHERE customerId = {param1} AND projectId = {param2} AND yyyy = {param3} AND ACTIVE_FLAG = 1 GROUP BY reportSubjectId ) b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.colCode = b.reportSubjectId LEFT JOIN ( SELECT SUM(adjustValue) AS occurValue, reportSubjectId, customerId, projectId FROM bdo_dg.dg_tbsubjectcontract WHERE customerId = {param1} AND projectId = {param2} AND yyyy = {param3} - 1 AND ACTIVE_FLAG = 1 GROUP BY reportSubjectId ) b2 ON a.customerId = b2.customerId AND a.projectId = b2.projectId AND a.colCode = b2.reportSubjectId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} GROUP BY a.colCode ORDER BY a.sortNo ) a WHERE 1 = 1 /*START #param4# AND a.colCode = '{param4}' #param4# END*/
#\u67E5\u8BE2\u5B50\u7EA7\u79D1\u76EE \u6709\u6CA1\u6709\u8C03\u6574
DG00199=SELECT subjectId , subjectFullName1 FROM  bdo_dg.dg_subjectentryadjust WHERE  customerId = {param1} and projectId = {param2}  AND  subjectId LIKE '{param3}%' GROUP BY subjectId
#\u66F4\u65B0\u4F7F\u7528\u6B21\u6570\u76F8\u5173
DG00200=SELECT kap.autoId, IFNULL(b.useCount, 0) AS useCount FROM asdb.k_auditprogram kap LEFT JOIN (SELECT dgap.auditprogramId, COUNT(dgap.auditprogramId) useCount FROM bdo_dg.dg_auditprogram dgap WHERE dgap.level = 0 AND dgap.ACTIVE_FLAG = '1' GROUP BY dgap.auditprogramId) b ON kap.autoId = b.auditprogramId WHERE kap.subjectId IN ({subjectIds})
#\u67E5\u627E\u5E95\u7A3F
DG00201=SELECT a.autoId AS data, a.fileName AS value FROM bdo_dg.dg_workpaper a INNER JOIN (SELECT CONCAT( '[\\\\\\\\\\/]', CASE b.nodeType WHEN 'PROJECT' THEN b.projectId WHEN 'TBSUBJECT' THEN b.tbSubjectName ELSE b.nodeName END, '[\\\\\\\\\\/]' ) AS currentNodeName FROM bdo_dg.dg_subjecttree b WHERE b.autoId = {param3} AND b.customerId = {param1} AND b.projectId = {param2} AND b.ACTIVE_FLAG = '1') c ON CONCAT('\\\\/', a.fullPath, '\\\\/') REGEXP c.currentNodeName WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.subjectId <> '' AND a.fullPath REGEXP '^{param2}[\\\\\\\\/]{param4}[\\\\\\\\/]' AND a.ACTIVE_FLAG = '1'
#TB\u79D1\u76EE
DG00202=SELECT DISTINCT a.tbSubjectCode AS data, a.adjustSubjectTB AS value FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.projectId = {param2} ORDER BY a.tbSubjectCode
#\u67E5\u8BE2TB
DG00204=SELECT * FROM bdo_dg.dg_tbsubjectcontract WHERE customerId = {param1} AND projectId = {param2} AND yyyy = {param3} AND autoId IN ({param4})
#\u67E5\u8BE2\u5BA1\u8BA1\u7A0B\u5E8F
DG00205=SELECT * FROM bdo_dg.dg_auditprogram WHERE customerId = {param1} AND projectId = {param2} AND FIND_IN_SET(subjectId , '{param5}')
#\u67E5\u8BE2 asdb\u4E0B\u7684tb\u79D1\u76EE\u4E0E\u62A5\u8868\u79D1\u76EE\u7684\u5BF9\u7167\u5173\u7CFB
DG00206=SELECT b.autoId,departmentId,b.tbTemplateId,b.vocationId,subjectCode,subjectName,colCode,a.colDisp,b.calFun,subjectType1 FROM asdb.k_subjecttb b LEFT JOIN asdb.k_reporttemplate a ON b.reportSubjectCode = a.colCode AND a.vocationId = b.vocationId WHERE b.vocationId = {vocationId} AND tbTemplateId = {tbTemplateId} AND departmentId = {departmentId}
DG00207=SELECT COUNT(*) FROM bdo_dg.dg_auditprogram WHERE customerId = {customerId} AND projectId = {projectId} AND subjectId = '{subjectId}' AND ACTIVE_FLAG = '1'
#PreProjectList
DG00208=SELECT a.projectName AS value, a.projectName AS label FROM bdo_dg.dg_project a WHERE a.customerId = {customerId} AND a.projectId <> '{projectId}' AND a.tbTemplate IS NOT NULL AND ACTIVE_FLAG = '1' ORDER BY a.projectId DESC
DG00209=SELECT a.projectName AS projectName, a.tbTemplate AS tbTemplate FROM bdo_dg.dg_project a WHERE a.customerId = {param1} AND a.tbTemplate IS NOT NULL AND ACTIVE_FLAG = '1'
DG00210=SELECT a.userSubjectName AS userSubjectName, a.tbSubjectName AS tbSubjectName FROM bdo_dg.dg_tbsubjectcontract a WHERE a.customerId = {customerId} AND a.projectId = {preProjectId} AND a.tbSubjectName IS NOT NULL ORDER BY yyyy
#DG00211=SELECT COUNT(1) FROM bdo_fin.fin_account WHERE customerId = {customerId} AND subYearMonth = {subYearMonth}
#\u9644\u6CE8\u4E0E\u62A5\u8868\u6821\u9A8C
DG00212=SELECT b.customerId, b.projectId, a.fieldName, a.fieldNameDesc, a.auditprogramId, a.dgIndexId, a.dgName, a.dgSheetIndex, a.dgRowIndex, a.dgColIndex, a.dgRangeStr, a.reportTplId, a.isPreVal, d.autoId AS dgId, d.fullPath AS dgPath, d.fileName AS dgFileName FROM asdb.k_notereportcheck a LEFT JOIN bdo_dg.dg_project b ON b.tbReportTemplate = a.reportTplId LEFT JOIN ( SELECT a.customerId, a.projectId, a.workpaperId, a.parentId, b.auditprogramId FROM bdo_dg.dg_auditprogram a LEFT JOIN bdo_dg.dg_auditprogram b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.parentId = b.autoId AND a.indexId = CONCAT(b.indexId, '-0001') WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.LEVEL = 1 ) c ON c.customerId = b.customerId AND c.projectId = b.projectId AND c.auditprogramId = a.auditprogramId LEFT JOIN bdo_dg.dg_workpaper d ON c.customerId = d.customerId AND c.projectId = d.projectId AND c.workpaperId = d.autoId WHERE b.customerId = {param1} AND b.projectId = {param2} AND a.isPreVal = {param3} AND c.workpaperId IS NOT NULL
DG00213=SELECT a.autoId AS value, a.fileName AS label FROM bdo_dg.dg_file a, bdo_dg.dg_subjecttree b WHERE a.customerId = b.customerId AND a.projectId = b.projectId AND a.subjectTreeId = b.autoId AND b.customerId = {customerId} AND b.projectId = {projectId} AND b.nodeName = '{nodeName}' AND (a.suffix = 'xlsx' OR a.suffix = 'pdf')
#\u5B9E\u65BD\u7A0B\u5E8F\u7684\u6807\u51C6\u5BA1\u8BA1\u7A0B\u5E8FID
DG00214=SELECT a.dgparam, b.auditprogramId FROM bdo_dg.dg_auditprogram a LEFT JOIN bdo_dg.dg_auditprogram b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.subjectId = b.subjectId AND a.parentId = b.autoId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.workpaperId = {param3} AND a.subjectId = '{param4}' AND a.LEVEL = 1
DG00215=SELECT a.userSubjectName AS userSubjectName, a.tbSubjectName AS tbSubjectName FROM bdo_dg.dg_tbsubjectcontract a WHERE a.customerId = {customerId} AND a.tbSubjectName IS NOT NULL ORDER BY yyyy
DG00216=SELECT tbSubjectId, calFun FROM bdo_dg.dg_projecttb WHERE customerId = {param1} AND projectId = {param2} AND ACTIVE_FLAG = '1'
#\u4E0A\u671F\u9644\u6CE8
DG00217=SELECT a.autoId,a.customerId,a.projectId,a.knoteId,a.noteNo,a.noteName,a.colCode,a.colName,a.fileName,a.fullPath,a.noteDgValueInfo,a.reportTplId,a.isForbid,a.isEdited,a.isFinished,a.customizeStyle FROM bdo_dg.dg_noteinfo a WHERE a.ACTIVE_FLAG = '1' AND a.projectId = {param1} AND a.noteName = {param2} AND a.reportTplId = {param3}
#\u9644\u6CE8\u5355\u5143\u683C
DG00218=SELECT	a.noteNo,a.noteName,a.noteSheetIndex,a.noteRowNum,a.noteColNum,a.auditprogramId,a.dgIndexId,a.dgName,a.dgSheetIndex,a.dgRowIndex,a.dgColIndex,a.dgRangeStr,a.reportTplId FROM asdb.k_notematchdg a WHERE a.noteName = {param1} AND a.reportTplId = {param2} AND a.noteType = {param3} AND a.isPreVal = {param4}
#\u5BA1\u5B9A\u62A5\u8868\u67E5\u8BE2
DG00219=SELECT a.finallyChangeReason, a.contrastStatus, a.colType, a.colCode, a.colDisp, a.adjustedAmount, a.adjustedRemain, IFNULL(b.occurValue, 0) AS adjustAmount, IFNULL(b2.occurValue, 0) AS adjustRemain, IFNULL(( a.adjustedAmount + IFNULL(b.occurValue, 0)), 0 ) AS auditedAmount, IFNULL(( a.adjustedRemain + IFNULL(b2.occurValue, 0)), 0 ) AS auditedRemain, tableDiv FROM bdo_dg.dg_unauditreport a INNER JOIN ( SELECT colCode AS subjectId, tableDiv FROM asdb.k_reporttemplate WHERE vocationId = {param4} ) AS t1 ON colCode = t1.subjectId LEFT JOIN ( SELECT SUM(adjustValue) AS occurValue, reportSubjectId, customerId, projectId FROM bdo_dg.dg_tbsubjectcontract WHERE customerId = {param1} AND projectId = {param2} AND yyyy = {param7} AND ACTIVE_FLAG = 1 GROUP BY reportSubjectId ) b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.colCode = b.reportSubjectId LEFT JOIN ( SELECT SUM(adjustValue) AS occurValue, reportSubjectId, customerId, projectId FROM bdo_dg.dg_tbsubjectcontract WHERE customerId = {param1} AND projectId = {param2} AND yyyy = {param8} AND ACTIVE_FLAG = 1 GROUP BY reportSubjectId ) b2 ON a.customerId = b2.customerId AND a.projectId = b2.projectId AND a.colCode = b2.reportSubjectId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.colCode = '{param3}' AND a.yyyy = {param7} GROUP BY a.colCode ORDER BY a.sortNo
#\u4E0A\u671F\u9644\u6CE8
DG00220=SELECT a.autoId, a.customerId, a.projectId, a.knoteId, a.noteNo, a.noteName, a.colCode, a.colName, a.fileName, a.fullPath, a.reportTplId, a.isForbid, a.isEdited, a.isFinished, a.isCompleteNow, DATE_FORMAT( a.LAST_UPDATE_DATE, '%Y-%m-%d %H:%i:%s' ) AS updateTime, a.LAST_UPDATED_BY AS __urevisor FROM bdo_dg.dg_noteinfo a LEFT JOIN bdo_dg.dg_project b ON a.customerId = b.customerId AND a.projectId = b.preProjectId WHERE b.customerId = {param1} AND b.projectId = {param2} AND a.fullPath IS NOT NULL AND a.fullPath <> '' /*START #param3# AND a.noteName LIKE CONCAT('%', '{param3}', '%') #param3# END*/ ORDER BY a.sortNo ASC
#\u67E5\u8BE2\u5206\u6790\u6027\u590D\u6838\u9644\u4EF6
DG00221=SELECT autoId,customerId,projectId,fileIndexId,fileName,fullPath from bdo_dg.dg_file where customerId = {param1} and projectId = {param2} and autoId in ({param3})
#\u67E5\u8BE2\u586B\u5199\u539F\u56E0\u7684\u5F02\u5E38\u6307\u6807\u6570\u91CF
DG00222=SELECT count(1) as reasonCount from bdo_dg.dg_unusualreason where customerId = {param1} and projectId = {param2} and analysisType = {param3} and chartType in ({param4}) and (LENGTH(analysisReason) > 0 or LENGTH(fileId) > 0)
#\u5E95\u7A3F\u53C2\u6570
DG00223=SELECT a.dgparam FROM bdo_dg.dg_auditprogram a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.workpaperId = {param3} AND a.subjecttreeId = {param4} AND a.level = 1
#\u5BA1\u5B9A\u62A5\u8868--\u5E95\u7A3F\u6587\u4EF6\u4FE1\u606F
DG00224=SELECT a.autoId AS workpaperId, a.customerId, a.projectId, a.fileName, a.fullPath, a.fileIndexId, a.subjectTreeId FROM bdo_dg.dg_workpaper a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.autoId = {param3} AND a.ACTIVE_FLAG = '1'
#\u5BA1\u5B9A\u62A5\u8868--\u5217\u540D
DG00225=SELECT DISTINCT a.columnDesc1, a.columnDesc2, a.columnDesc3, a.columnDesc4, a.columnDesc5, a.columnDesc6, a.columnDesc7, a.columnDesc8, a.columnDesc9, a.columnDesc10, a.columnDesc11, a.columnDesc12, a.columnDesc13, a.columnDesc14, a.columnDesc15, a.generateMethod FROM bdo_dg.dg_auditreport_info a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.tableType = {param4} 
#\u5BA1\u5B9A\u62A5\u8868--\u6570\u636E
DG00226=SELECT a.colCode, a.colDisp, a.column1, a.column2, a.column3, a.column4, a.column5, a.column6, a.column7, a.column8, a.column9, a.column10, a.column11, a.column12, a.column13, a.column14, a.column15 FROM bdo_dg.dg_auditreport_info a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.tableType = {param4} ORDER BY a.rowNum 
#\u5BA1\u5B9A\u62A5\u8868--\u6587\u4EF6
DG00227=SELECT a.autoId, a.fullPath FROM bdo_dg.dg_workpaper a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.fileIndexId = '{param3}' AND a.fileName = '{param4}' 
#\u516C\u5F0F\u6821\u9A8C--\u6B63\u786E\u6570/\u603B\u6570
DG00228=SELECT COUNT(*) AS totalNum, COUNT(IF(a.formulaCalc = '1', TRUE, NULL)) AS rightNum FROM bdo_dg.dg_projectformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.ACTIVE_FLAG = '1' AND a.checkType = '0' /*START #param3# AND a.formulaType = '{param3}' #param3# END*/ 
#\u516C\u5F0F\u6821\u9A8C--\u6B63\u786E\u6570/\u603B\u6570
DG00229=SELECT COUNT(*) AS totalNum, COUNT(IF(a.formulaCalc = '1', TRUE, NULL)) AS rightNum FROM bdo_dg.dg_projectformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.ACTIVE_FLAG = '1' AND a.checkType = '0' AND a.autoId IN ({param3}) /*START #param4# AND a.formulaType = '{param4}' #param4# END*/ /*START #param5# AND a.formulaCalc = '{param5}' #param5# END*/
#\u524D\u63A8\u9879\u76EE\u6709\u65E0\u751F\u6210\u5BA1\u5B9A\u62A5\u8868--\u73B0\u91D1\u6D41\u91CF\u8868\u3001\u6240\u6709\u8005\u6743\u76CA\u53D8\u52A8\u8868\u5E95\u7A3F
DG00230=SELECT b.autoId, b.customerId, b.projectId FROM bdo_dg.dg_project a LEFT JOIN bdo_dg.dg_workpaper b ON a.preCustomerId = b.customerId AND a.preProjectId = b.projectId AND b.fileIndexId = '{param3}' AND b.fileName = '{param4}' WHERE a.customerId = {param1} AND a.projectId = {param2}
#\u9644\u6CE8\u6A21\u677F
DG00231=SELECT a.autoId, a.noteNo, a.noteName, a.colCode, a.colName, a.fileName, a.fullPath, a.reportTplId, a.sortNo, isChange FROM asdb.k_noteinfo a WHERE a.autoId = {param1} AND a.noteNo = {param2} AND a.reportTplId = {param3}
DG00232=SELECT b.reportType FROM bdo_dg.dg_project a LEFT JOIN asdb.k_ruleacc b ON b.autoId = a.tbReportTemplate WHERE a.customerId = {param1} AND a.projectId = {param2} 
#\u6839\u636E\u6807\u7B7E\u53D6\u6821\u9A8C\u516C\u5F0F
DG00233=SELECT a.autoId, a.customerId, a.projectId, a.subjectId, a.subjectName, a.formulaType, a.formulaProperty, a.formula, a.formulaText, a.formulaValue, a.formulaCalc, a.formulaAutoId, a.isMutualIndex FROM bdo_dg.dg_projectformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.formula LIKE '{param3}' AND a.formulaText LIKE '{param4}'
#\u6839\u636E\u5E95\u7A3F\u83B7\u53D6\u8BE5\u5E95\u7A3F\u6240\u5C5E\u79D1\u76EE\u4E0B\u6240\u6709\u5E95\u7A3Fid
DG00234=SELECT a.autoId FROM bdo_dg.dg_workpaper a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.subjectId IN ( SELECT DISTINCT a.userSubjectId FROM bdo_dg.dg_subjecttree a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.nodeType = 'SUBJECT' AND a.tbSubjectCode = ( SELECT a.tbSubjectCode FROM bdo_dg.dg_subjecttree a WHERE a.autoId = ( SELECT a.parentId FROM bdo_dg.dg_subjecttree a WHERE a.workpaperId = {param3} )))
#\u83B7\u53D6\u6807\u7B7E\u4FE1\u606F
DG00235=SELECT a.autoId, a.customerId, a.projectId, a.tagName, a.tagValue, a.tagPosition, a.tagInfo, a.tagType, a.tagProperty, a.tagDgId, a.infoVersion, a.remark FROM bdo_dg.dg_projectlstag a WHERE a.autoId = {param1} AND a.customerId = {param2} AND a.projectId = {param3} 
#\u6839\u636E\u9644\u6CE8\u5E95\u7A3FID\u83B7\u53D6\u8BE5\u9644\u6CE8\u516C\u5F0F
DG00236=SELECT a.autoId, a.customerId, a.projectId, a.subjectId, a.subjectName, a.formulaType, a.formulaProperty, a.formula, a.formulaText, a.formulaValue, a.formulaCalc, a.formulaAutoId, a.isMutualIndex FROM bdo_dg.dg_projectformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.checkType = '0' AND a.autoId IN ({param3})
#\u8BBE\u7F6E\u5237\u65B0\u8D22\u52A1\u8D26\u5957\u6570\u636E\u662F\u5426\u9700\u8981\u53C2\u6570
DG00237=SELECT s.methodStyle FROM asdb.k_dgaccountdata s LEFT JOIN bdo_dg.dg_auditprogram a ON s.id = a.auditprogramId LEFT JOIN bdo_dg.dg_auditprogram b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.autoId = b.parentId WHERE a.customerId = {param1} AND a.projectId = {param2} AND b.workpaperId = {param3} GROUP BY s.methodStyle
#
DG00238=SELECT customerId,projectId,fillUser FROM bdo_dg.dg_subjectentryadjust  WHERE customerId = {param1} AND projectId = {param2} AND adjustType = {param11}
#DgProjectProgressService
DG00239=SELECT COUNT(1) FROM bdo_dg.dg_tbtable a WHERE a.customerId = {customerId} AND a.projectId = {projectId} AND a.yyyy = {yyyy}
DG00240=SELECT COUNT(1) FROM bdo_dg.dg_unauditreport a WHERE a.customerId = {customerId} AND a.projectId = {projectId} AND a.yyyy = {yyyy} /*START #colDisp# AND TRIM(a.colDisp) = '{colDisp}' #colDisp# END*/
DG00241=SELECT a.reportStatus AS reportStatus FROM bdo_dg.dg_report a WHERE a.customerId = {customerId} AND a.projectId = {projectId} ORDER BY a.reportNo DESC LIMIT 1
DG00242=SELECT a.autoId,a.fileIndexId,a.customerId,a.projectId,a.auditprogramId,a.workpaperId,b.fileName AS dgName,a.fileName,a.fileType,a.suffix,a.CREATION_DATE AS uploadDate,a.CREATED_BY AS __uuploadUser,a.isReferred AS referredFlg FROM bdo_dg.dg_attach a JOIN bdo_dg.dg_workpaper b ON b.autoId = a.workpaperId AND b.customerId = a.customerId WHERE a.customerId = {param1} AND a.workpaperId = {param2} ORDER BY a.autoId DESC 
DG00243=SELECT isResetNow FROM bdo_dg.dg_project WHERE customerId = {param1} AND projectId = {param2}
DG00244=SELECT userSubjectId, userSubjectName FROM bdo_dg.dg_tbsubjectcontract WHERE customerId = {customerId} AND projectId = {projectId} AND yyyy = {yyyy} AND (userSubjectName = '{userSubjectName1}' OR userSubjectName = '{userSubjectName2}')
DG00245=SELECT subjectId as userSubjectId FROM bdo_dg.dg_customersubject WHERE customerId = {customerId} AND projectId = {projectId} AND yyyy = {yyyy} AND subjectId LIKE '{userSubjectId}%' 
#\u67E5\u8BE2\u6307\u5B9A\u5E74\u4EFD\u7684\u8BD5\u7B97\u5E73\u8861\u8868\u6570\u636E
DG00246=SELECT a.tbSubjectId AS colCode,concat(a.subjectType1,a.tbSubjectName) as colKey,a.tbSubjectName AS colDisp,a.subjectType1,a.subjectType2,a.colType,a.unAuditAmount,a.adjustCAmount,a.adjustAmount,a.auditAmount,a.adjustFlag,count(c.autoId) contractCount FROM bdo_dg.dg_tbtable a LEFT JOIN bdo_dg.dg_projecttb b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.tbSubjectId = b.tbSubjectId LEFT JOIN bdo_dg.dg_tbsubjectcontract c ON a.customerId = c.customerId AND a.projectId = c.projectId AND a.tbSubjectId = c.tbSubjectCode WHERE a.customerId = {customerId} AND a.yyyy = {yyyy} and a.projectId = {projectId} GROUP BY a.tbSubjectId ORDER BY b.sortNo,a.subjectType1,a.subjectType2 
#Clone Project
DG00247=SELECT userSubjectKey AS userSubjectKey,tbSubjectKey AS tbSubjectKey,baseSubjectKey AS baseSubjectKey,level AS level FROM bdo_dg.dg_tbsubjectkeyresult WHERE customerId = {customerId} AND departId = {departId} 
#SUBJECT CHECK
DG00248=SELECT COUNT(1) FROM bdo_dg.dg_customersubject WHERE customerId = {customerId} AND projectId = {projectId} AND(yyyy = {yyyy} OR yyyy = {yyyy} - 1) AND subjectId = '{subjectId}' AND isLeaf = 1 
#Account Age
DG00249=SELECT a.attributeValue1 AS id,a.attributeValue1 AS VALUE,a.attributeName AS text,CONCAT(a.attributeValue1,' : ',a.attributeName) AS label,'false' AS leaf,'' AS parentid FROM bdo_base.base_dic a WHERE a.attributetype = '\u65B0\u8D26\u9F84\u533A\u95F4' and a.ccatalog='\u5BA1\u8BA1\u5E73\u53F0' ORDER BY a.sortNum
DG00250=SELECT a.dgparam FROM bdo_dg.dg_auditprogram a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.workpaperId = {param3}
#DG00251=SELECT a.assItemId,a.assItemName,sum(a.remain) as balance from fin_assitementryacc a where a.customerId = {param1} AND a.accId LIKE '{param2}%' AND a.isLeaf1 = '1' AND a.assItemId REGEXP '{param11}' AND CONCAT(a.subYearMonth,'-',CASE WHEN a.subMonth < 10 THEN CONCAT('0', a.subMonth) ELSE a.subMonth END ) = '{param4}' group by a.assItemId order by a.assItemId asc
DG00251=SELECT a.assItemId,a.assItemName,sum(a.remain) as balance from bdo_fin.fin_assitementryacc a where a.customerId = {param1} AND a.accId LIKE '{param2}%' AND a.isLeaf1 = '1' AND a.assItemId in('{param11}') AND CONCAT(a.subYearMonth,'-',CASE WHEN a.subMonth < 10 THEN CONCAT('0',a.subMonth) ELSE a.subMonth END) = '{param4}' group by a.assItemId order by a.assItemId asc 
#DG00252=SELECT a.assItemId, a.assItemName, 0 as remain, 0 as balance, sum(a.debitOcc) as debitAmount, sum(a.creditOcc) as creditAmount, '0' as `status` FROM fin_assitementryacc a WHERE a.customerId = {param1} AND a.accId LIKE '{param2}%' AND a.isLeaf1 = '1' AND a.assItemId REGEXP '{param11}' AND CONCAT( a.subYearMonth, '-', CASE WHEN a.subMonth < 10 THEN CONCAT('0', a.subMonth) ELSE a.subMonth END) BETWEEN '{param3}' AND '{param4}' GROUP BY a.assItemId ORDER BY a.assItemId asc
DG00252=SELECT a.assItemId,a.assItemName,0 as remain,0 as balance,sum(a.debitOcc) as debitAmount,sum(a.creditOcc) as creditAmount,'0' as `status` FROM bdo_fin.fin_assitementryacc a WHERE a.customerId = {param1} AND a.accId LIKE '{param2}%' AND a.isLeaf1 = '1' AND a.assItemId in('{param11}') AND CONCAT(a.subYearMonth,'-',CASE WHEN a.subMonth < 10 THEN CONCAT('0',a.subMonth) ELSE a.subMonth END) BETWEEN '{param3}' AND '{param4}' GROUP BY a.assItemId ORDER BY a.assItemId asc 
DG00253=SELECT a.subjectId AS assItemId,a.accName AS assItemName,sum(a.remain) as balance FROM bdo_fin.fin_account a WHERE a.customerId = {param1} AND subjectId LIKE '{param2}%' AND isLeaf1 = '1' AND CONCAT(a.subYearMonth,'-',CASE WHEN a.subMonth < 10 THEN CONCAT('0',a.subMonth) ELSE a.subMonth END) = '{param4}' GROUP BY a.subjectId ORDER BY a.subjectId 
DG00254=SELECT a.subjectId AS assItemId,a.accName AS assItemName,0 as remain,0 as balance,sum(a.debitOcc) AS debitAmount,sum(a.creditOcc) AS creditAmount,'0' as `status` FROM bdo_fin.fin_account a WHERE a.customerId = {param1} AND subjectId LIKE '{param2}%' AND isLeaf1 = '1' AND CONCAT(a.subYearMonth,'-',CASE WHEN a.subMonth < 10 THEN CONCAT('0',a.subMonth) ELSE a.subMonth END) BETWEEN '{param3}' AND '{param4}' GROUP BY a.subjectId ORDER BY a.subjectId 
DG00255=SELECT a.araId,a.araName,a.subjectId,a.status,a.reason,a.ara01,a.ara02,a.ara03,a.ara04,a.ara05,a.ara06,a.ara07,a.ara08,a.ara09,a.ara10,a.ara11,a.ara12 FROM bdo_dg.dg_ara a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.subjectId LIKE '{param3}%' AND a.araName LIKE '%{param4}%'AND a.isMerge={param5} 
DG00256=SELECT a.araId,a.araName,a.subjectId,a.status,a.reason,a.ara01,a.ara02,a.ara03,a.ara04,a.ara05,a.ara06,a.ara07,a.ara08,a.ara09,a.ara10,a.ara11,a.ara12 FROM bdo_dg.dg_ara a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.subjectId LIKE '{param3}%' AND a.isMerge={param5} 
#DG00257=SELECT a.assItemId, a.assItemName, 0 as remain, 0 as balance, 0 as debitAmount, 0 as creditAmount, 0 as t0, 0 as t1, 0 as t2, 0 as t3, 0 as t4, 0 as t5, 0 as t6, '0' as `status`, '' as reason, CASE WHEN SUM(a.balance) > 0  THEN 1 ELSE -1 END as `result` FROM fin_assitementryacc a WHERE a.customerId = {param1} AND a.accId LIKE '{param2}%' AND a.isLeaf1 = '1' AND a.assItemId REGEXP '{param11}' AND CONCAT( a.subYearMonth, '-', CASE WHEN a.subMonth < 10 THEN CONCAT('0', a.subMonth) ELSE a.subMonth END) = '{param4}' GROUP BY a.assItemId HAVING SUM(a.balance) <> 0 ORDER BY a.assItemId asc
DG00257=SELECT a.assItemId,a.assItemName,0 as remain,0 as balance,0 as debitAmount,0 as creditAmount,0 as t0,0 as t1,0 as t2,0 as t3,0 as t4,0 as t5,0 as t6,'0' as `status`,'' as reason,CASE WHEN SUM(a.balance) > 0 THEN 1 ELSE -1 END as `result` FROM bdo_fin.fin_assitementryacc a WHERE a.customerId = {param1} AND a.accId LIKE '{param2}%' AND a.isLeaf1 = '1' AND a.assItemId in('{param11}') AND CONCAT(a.subYearMonth,'-',CASE WHEN a.subMonth < 10 THEN CONCAT('0',a.subMonth) ELSE a.subMonth END) = '{param4}' GROUP BY a.assItemId HAVING SUM(a.balance) <> 0 ORDER BY a.assItemId asc 
DG00258=SELECT a.subjectId AS assItemId,a.accName AS assItemName,0 as remain,0 as balance,0 as debitAmount,0 as creditAmount,0 as t0,0 as t1,0 as t2,0 as t3,0 as t4,0 as t5,0 as t6,'0' as `status`,'' as reason,CASE WHEN SUM(a.balance) > 0 THEN 1 ELSE -1 END as `result` FROM bdo_fin.fin_account a WHERE a.customerId = {param1} AND subjectId LIKE '{param2}%' AND isLeaf1 = '1' AND CONCAT(a.subYearMonth,'-',CASE WHEN a.subMonth < 10 THEN CONCAT('0',a.subMonth) ELSE a.subMonth END) = '{param4}' GROUP BY a.subjectId HAVING SUM(a.balance) <> 0 ORDER BY a.subjectId 
DG00259=SELECT a.direction FROM bdo_dg.dg_tbsubjectcontract a LEFT JOIN bdo_dg.dg_project b ON a.projectId = b.projectId AND a.customerId = b.customerId AND a.yyyy = b.`year` WHERE b.customerId = {param1} AND b.projectId = {param2} AND a.baseSubjectId = '{param3}' 
#MERGE PROJECT
DG00262=SELECT a.customerId, a.projectId, a.customerName, a.projectName, a.YEAR FROM bdo_dg.dg_project a left join bdo_dg.dg_projectext b on a.projectId=b.projectId where  a.projectId ={param2}  AND a.ACTIVE_FLAG = 1 AND b.mergeType=1 ORDER BY customerId,projectId
DG00263=SELECT IFNULL(MAX(projectId), {year} * 1000000 + 500000)  FROM bdo_dg.dg_project WHERE  projectId > ({year} * 1000000 + 500000)
DG00264=SELECT t.autoId,t.customerId,t.parentId,t.projectId,t.subjectId,t.workpaperId,t.indexId,t.fileIndexId,t.nodeName,t.nodeType,t.userSubjectId,t.userSubjectName,t.tbSubjectCode,t.tbSubjectId,t.tbSubjectName,t.sE,t.sC,t.sA,t.sV,t.sP,t.csE,t.csC,t.csA,t.csV,t.csP,t.plansE,t.plansC,t.plansA,t.plansV,t.plansP,t.plancsE,t.plancsC,t.plancsA,t.plancsV,t.plancsP,t.CREATION_DATE,t.CREATED_BY,t.LAST_UPDATE_DATE,t.LAST_UPDATED_BY,t.ABOLITION_DATE,t.ABOLISHED_BY,t.PROGRAM_APPLICATION_ID,t.PROGRAM_ID,t.ACTIVE_FLAG,t.autoId FROM bdo_dg.dg_subjecttree t INNER JOIN(SELECT autoId FROM bdo_dg.dg_subjecttree WHERE customerId = {customerId} AND projectId= {projectId} AND parentId = 0) t1 ON t.parentId = t1.autoId 
DG00265=SELECT t.autoId, t.customerId,t.parentId, t.projectId,t.subjectId, t.workpaperId,t.indexId, t.fileIndexId,t.nodeName, t.nodeType,t.userSubjectId, t.userSubjectName,t.tbSubjectCode, t.tbSubjectId,t.tbSubjectName, t.sE,t.sC, t.sA,t.sV, t.sP,t.csE, t.csC,t.csA, t.csV,t.csP, t.plansE,t.plansC, t.plansA,t.plansV, t.plansP,t.plancsE, t.plancsC,t.plancsA, t.plancsV,t.plancsP, t.CREATION_DATE,t.CREATED_BY, t.LAST_UPDATE_DATE,t.LAST_UPDATED_BY, t.ABOLITION_DATE,t.ABOLISHED_BY, t.PROGRAM_APPLICATION_ID,t.PROGRAM_ID, t.ACTIVE_FLAG,t.autoId FROM bdo_dg.dg_subjecttree t WHERE t.customerId = {customerId} AND t.projectId = {projectId} AND t.subjectId = {mergeProjectId}
#Account Age add
DG00269=SELECT * FROM bdo_dg.dg_projectext t where t.projectId = {param1} and t.customerId = {param2} 
#Clone Project
DG00270=SELECT projectId AS data,projectName AS value FROM bdo_dg.dg_project WHERE customerId = {param1} ORDER BY projectId 
#Account Age add
#DG00271=SELECT a.assItemId,a.assItemName,sum(a.remain) as remain from fin_assitementryacc a where a.customerId = {param1} AND a.accId LIKE '{param2}%' AND a.isLeaf1 = '1' AND a.assItemId REGEXP '{param11}'  AND CONCAT(a.subYearMonth,'-',CASE WHEN a.subMonth < 10 THEN CONCAT('0', a.subMonth) ELSE a.subMonth END ) = '{param3}'  group by a.assItemId order by a.assItemId asc
DG00271=SELECT a.assItemId,a.assItemName,sum(a.remain) as remain from bdo_fin.fin_assitementryacc a where a.customerId = {param1} AND a.accId LIKE '{param2}%' AND a.isLeaf1 = '1' AND a.assItemId in('{param11}') AND CONCAT(a.subYearMonth,'-',CASE WHEN a.subMonth < 10 THEN CONCAT('0',a.subMonth) ELSE a.subMonth END) = '{param3}' group by a.assItemId order by a.assItemId asc 
#DG00272=SELECT a.assItemId,a.assItemName,sum(a.balance) as balance from fin_assitementryacc a where a.customerId = {param1} AND a.accId LIKE '{param2}%' AND a.isLeaf1 = '1' AND a.assItemId REGEXP '{param11}' AND CONCAT(a.subYearMonth,'-',CASE WHEN a.subMonth < 10 THEN CONCAT('0', a.subMonth) ELSE a.subMonth END ) = '{param4}' group by a.assItemId order by a.assItemId asc
DG00272=SELECT a.assItemId,a.assItemName,sum(a.balance) as balance from bdo_fin.fin_assitementryacc a where a.customerId = {param1} AND a.accId LIKE '{param2}%' AND a.isLeaf1 = '1' AND a.assItemId in('{param11}') AND CONCAT(a.subYearMonth,'-',CASE WHEN a.subMonth < 10 THEN CONCAT('0',a.subMonth) ELSE a.subMonth END) = '{param4}' group by a.assItemId order by a.assItemId asc 
DG00273=SELECT ifnull(a.araId,a.subjectId) araId,ifnull(a.araName,a.subjectName) araName,a.status,a.reason,a.ara01,a.ara02,a.ara03,a.ara04,a.ara05,a.ara06,a.ara07,a.ara08,a.ara09,a.ara10,a.ara11,a.ara12,IFNULL(a.ara01,0) + IFNULL(a.ara02,0) + IFNULL(a.ara03,0) + IFNULL(a.ara04,0) + IFNULL(a.ara05,0) + IFNULL(a.ara06,0) as unauditTotal,IFNULL(a.ara07,0) + IFNULL(a.ara08,0) + IFNULL(a.ara09,0) + IFNULL(a.ara10,0) + IFNULL(a.ara11,0) + IFNULL(a.ara12,0) as adjustTotal from bdo_dg.dg_ara a where a.customerId = {param1} AND a.projectId = {param2} AND a.subjectId LIKE '{param3}%' AND a.isMerge = {param5} /*START #param4# AND a.status = '{param4}' #param4# END*/ ORDER BY a.araId 
DG00274=SELECT a.subjectId AS assItemId,a.accName AS assItemName,sum(a.remain) as remain FROM bdo_fin.fin_account a WHERE a.customerId = {param1} AND subjectId LIKE '{param2}%' AND isLeaf1 = '1' AND CONCAT(a.subYearMonth,'-',CASE WHEN a.subMonth < 10 THEN CONCAT('0',a.subMonth) ELSE a.subMonth END) = '{param3}' GROUP BY a.subjectId ORDER BY a.subjectId 
DG00275=SELECT a.subjectId AS assItemId,a.accName AS assItemName,sum(a.balance) as balance FROM bdo_fin.fin_account a WHERE a.customerId = {param1} AND subjectId LIKE '{param2}%' AND isLeaf1 = '1' AND CONCAT(a.subYearMonth,'-',CASE WHEN a.subMonth < 10 THEN CONCAT('0',a.subMonth) ELSE a.subMonth END) = '{param4}' GROUP BY a.subjectId ORDER BY a.subjectId 
#dg_tbsubjectcontract
DG00276=SELECT autoId,customerId FROM bdo_dg.dg_tbsubjectcontract WHERE customerId = {customerId} AND projectId = {projectId} AND yyyy = {yyyy} 
#\u9879\u76EE\u8FDB\u5EA6\u5237\u65B0job
DG00277=SELECT COUNT(1) FROM bdo_dg.dg_project a WHERE a.ACTIVE_FLAG = '1' AND (a.progressRate <> 100 OR a.progressRate IS NULL) AND a.LAST_UPDATE_DATE BETWEEN STR_TO_DATE({beginTime}, '%Y-%m-%d %H:%i:%S') AND STR_TO_DATE({endTime}, '%Y-%m-%d %H:%i:%S')
DG00278=SELECT * FROM bdo_dg.dg_project a WHERE a.ACTIVE_FLAG = '1' AND (a.progressRate < 100 OR a.progressRate IS NULL OR a.progressRate > 100) AND a.LAST_UPDATE_DATE BETWEEN STR_TO_DATE('{beginTime}', '%Y-%m-%d %H:%i:%S') AND STR_TO_DATE('{endTime}', '%Y-%m-%d %H:%i:%S') order by a.LAST_UPDATE_DATE limit {startP},{sizeP}
#20200115 \u5B50\u9879\u76EE\u7CBE\u786E\u67E5\u8BE2\u9879\u76EE\u4FE1\u606F
DG00282=SELECT customerId,projectId,customerName,projectName,year FROM bdo_dg.dg_project WHERE year = {param1} AND projectId={param2} AND `ACTIVE_FLAG` = '1' ORDER BY customerId,projectId 
#\u5B9E\u65BD\u7A0B\u5E8F\u5B8C\u6210\u72B6\u6001
DG00283=SELECT * FROM (SELECT ap.autoId, ap.customerId, ap.projectId, ap.indexId, IFNULL(ap2.indexId, '') AS subIndexId, ap.dgName AS apName, dgtree.nodeName AS apUserSubjectName, CONCAT( IFNULL( dgtree.tbSubjectId, dgtree.tbSubjectCode ), '-', dgtree.tbSubjectName ) AS tbSubjectName, IFNULL(ap2.auditConclusion, '') AS auditConclusion, ap.workpaperEditor, ap.workpaperEditor AS __uWorkpaperEditor, IF(ap2.auditConclusion > '', if( (ap.csE != '1' or ap.csE is null or (ap.csE = '1' and ap2.csE = '1') ) and (ap.csC != '1' or ap.csC is null or (ap.csC = '1' and ap2.csC = '1') ) AND (ap.csA != '1' or ap.csA is null or (ap.csA = '1' and ap2.csA = '1') ) AND (ap.csV != '1' or ap.csV is null or (ap.csV = '1' and ap2.csV = '1') ) AND (ap.csP != '1' or ap.csP is null or (ap.csP = '1' and ap2.csP = '1') ) , 1, 0 ), 0) AS haveDone FROM bdo_dg.dg_auditprogram ap LEFT JOIN bdo_dg.dg_auditprogram ap2 	ON ap2.parentId = ap.autoId 	AND ap2.level = 1 	AND ap2.ACTIVE_FLAG = '1' 	AND ap2.customerId = {param1} 	AND ap2.projectId = {param2} LEFT JOIN bdo_dg.dg_subjecttree dgtree ON dgtree.customerId = {param1} AND dgtree.projectId = {param2} AND dgtree.autoId = ap.subjecttreeId WHERE ap.customerId = {param1} AND ap.projectId = {param2} AND ap.level = 0 AND ap.ACTIVE_FLAG = '1' ) ap ORDER BY ap.customerId, ap.projectId, ap.indexId, ap.subIndexId 
#\u8BA1\u5212\u7A0B\u5E8F\u5B8C\u6210\u72B6\u6001
#DG00284=SELECT * FROM ( SELECT ap.autoId, ap.customerId, ap.projectId, ap.indexId, ap.dgName AS apName, ap.subjectId, dgtree.nodeName AS apUserSubjectName, IFNULL(tbsc.plansE, 0) AS ipSe, IFNULL(tbsc.plansC, 0) AS ipSc, IFNULL(tbsc.plansA, 0) AS ipSa, IFNULL(tbsc.plansV, 0) AS ipSv, IFNULL(tbsc.plansP, 0) AS ipSp, IFNULL(otbsc.plansE, 0) AS oipSe, IFNULL(otbsc.plansC, 0) AS oipSc, IFNULL(otbsc.plansA, 0) AS oipSa, IFNULL(otbsc.plansV, 0) AS oipSv, IFNULL(otbsc.plansP, 0) AS oipSp, IFNULL(dgtree.plansE, 0) AS ppSe, IFNULL(dgtree.plansC, 0) AS ppSc, IFNULL(dgtree.plansA, 0) AS ppSa, IFNULL(dgtree.plansV, 0) AS ppSv, IFNULL(dgtree.plansP, 0) AS ppSp, IFNULL(dgtree.sE, 0) AS tdSe, IFNULL(dgtree.sC, 0) AS tdSc, IFNULL(dgtree.sA, 0) AS tdSa, IFNULL(dgtree.sV, 0) AS tdSv, IFNULL(dgtree.sP, 0) AS tdSp, CONCAT( IFNULL( dgtree.tbSubjectId, dgtree.tbSubjectCode ), '-', dgtree.tbSubjectName ) AS tbSubjectName, IF(COUNT(subAp.autoId) > 0, 1, 0) AS haveDone FROM bdo_dg.dg_auditprogram ap LEFT JOIN bdo_dg.dg_subjecttree dgtree ON dgtree.customerId = {param1} AND dgtree.projectId = {param2} AND dgtree.autoId = ap.subjecttreeId LEFT JOIN bdo_dg.dg_auditprogram subAp ON subAp.customerId = {param1} AND subAp.projectId = {param2} AND subAp.parentId = ap.autoId AND subAp. LEVEL = 1 LEFT JOIN bdo_dg.dg_tbsubjectcontract tbsc ON tbsc.customerId = {param1} AND tbsc.projectId = {param2} AND tbsc.tbSubjectCode = dgtree.tbSubjectCode AND tbsc.userSubjectId = dgtree.userSubjectId AND tbsc.yyyy = {param3} LEFT JOIN bdo_dg.dg_othersubjectcontract otbsc ON otbsc.customerId = {param1} AND otbsc.projectId = {param2} AND otbsc.tbSubjectCode = dgtree.tbSubjectCode AND otbsc.baseSubjectId = dgtree.userSubjectId AND otbsc.yyyy = {param3} WHERE ap.customerId = {param1} AND ap.projectId = {param2} AND ap. LEVEL = 0 AND ap.ACTIVE_FLAG = '1' GROUP BY ap.autoId ) ap WHERE ap.haveDone = 0  
DG00284=SELECT apo.tbSubjectName, apo.apUserSubjectName, apo.subjectId, SUM(apo.ipSe) ipSe, SUM(apo.ipSc) ipSc, SUM(apo.ipSa) ipSa, SUM(apo.ipSv) ipSv, SUM(apo.ipSp) ipSp, SUM(apo.oipSe) oipSe, SUM(apo.oipSc) oipSc, SUM(apo.oipSa) oipSa, SUM(apo.oipSv) oipSv, SUM(apo.oipSp) oipSp, SUM(apo.ppSe) ppSe, SUM(apo.ppSc) ppSc, SUM(apo.ppSa) ppSa, SUM(apo.ppSv) ppSv, SUM(apo.ppSp) ppSp, COUNT(apo.subjectId) num, IF(SUM(apo.haveDone) > 0, 1, 0) AS haveDone FROM ( SELECT ap.autoId, ap.customerId, ap.projectId, ap.indexId, ap.dgName AS apName, ap.subjectId, dgtree.nodeName AS apUserSubjectName, IFNULL(tbsc.plansE, 0) AS ipSe, IFNULL(tbsc.plansC, 0) AS ipSc, IFNULL(tbsc.plansA, 0) AS ipSa, IFNULL(tbsc.plansV, 0) AS ipSv, IFNULL(tbsc.plansP, 0) AS ipSp, IFNULL(otbsc.plansE, 0) AS oipSe, IFNULL(otbsc.plansC, 0) AS oipSc, IFNULL(otbsc.plansA, 0) AS oipSa, IFNULL(otbsc.plansV, 0) AS oipSv, IFNULL(otbsc.plansP, 0) AS oipSp, IFNULL(dgtree.plansE, 0) AS ppSe, IFNULL(dgtree.plansC, 0) AS ppSc, IFNULL(dgtree.plansA, 0) AS ppSa, IFNULL(dgtree.plansV, 0) AS ppSv, IFNULL(dgtree.plansP, 0) AS ppSp, IFNULL(dgtree.sE, 0) AS tdSe, IFNULL(dgtree.sC, 0) AS tdSc, IFNULL(dgtree.sA, 0) AS tdSa, IFNULL(dgtree.sV, 0) AS tdSv, IFNULL(dgtree.sP, 0) AS tdSp, CONCAT( IFNULL( dgtree.tbSubjectId, dgtree.tbSubjectCode ), '-', dgtree.tbSubjectName ) AS tbSubjectName, IF(COUNT(ap.autoId) > 0, 1, 0) AS haveDone FROM bdo_dg.dg_auditprogram ap LEFT JOIN bdo_dg.dg_subjecttree dgtree ON dgtree.customerId = {param1} AND dgtree.projectId = {param2} AND dgtree.autoId = ap.subjecttreeId LEFT JOIN bdo_dg.dg_tbsubjectcontract tbsc ON tbsc.customerId = {param1} AND tbsc.projectId = {param2} AND tbsc.tbSubjectCode = dgtree.tbSubjectCode AND tbsc.userSubjectId = dgtree.userSubjectId AND tbsc.yyyy = {param3} LEFT JOIN bdo_dg.dg_othersubjectcontract otbsc ON otbsc.customerId = {param1} AND otbsc.projectId = {param2} AND otbsc.tbSubjectCode = dgtree.tbSubjectCode AND otbsc.userSubjectId = dgtree.userSubjectId AND otbsc.yyyy = {param3} WHERE ap.customerId = {param1} AND ap.projectId = {param2} AND ap.level = 0 AND ap.ACTIVE_FLAG = '1' GROUP BY ap.autoId ) apo GROUP BY apo.subjectId
#\u79D1\u76EE\u8BA4\u5B9A\u5B8C\u6210\u72B6\u6001
#DG00285=SELECT * FROM (SELECT a.autoId, a.customerId, a.projectId, CONCAT( a.tbSubjectCode, '-', a.tbSubjectName ) AS tbSubject, CONCAT( a.userSubjectId, '-', a.userSubjectName ) AS userSubject, IF(a.baseSubjectId IS NULL, 0, 1) AS isMapBaseSubject, IF( a.plancsE = '1' OR a.plancsC = '1' OR a.plancsA = '1' OR a.plancsV = '1' OR a.plancsP = '1', 1, 0 ) AS isSetEcvap, IF(a.subjectEditors > '', 1, 0) AS isSetSubjectEditor, IF(ap.apCount > 0, 1, 0) AS isCreatedProgram FROM bdo_dg.dg_tbsubjectcontract a LEFT JOIN bdo_dg.dg_subjecttree b ON b.customerId = {param1} AND b.projectId = {param2} AND b.tbSubjectCode = a.tbSubjectCode AND b.userSubjectId = a.userSubjectId LEFT JOIN (SELECT COUNT(ap.autoId) AS apCount,ap.subjecttreeId, ap.subjectId FROM bdo_dg.dg_auditprogram ap WHERE ap.customerId = {param1} AND ap.projectId = {param2} GROUP BY ap.subjectId, ap.subjecttreeId) ap ON ap.subjectId = a.userSubjectId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} ORDER BY a.userSubjectId, a.level0 ) a
DG00285=SELECT * FROM (SELECT * FROM  (SELECT a.customerId, a.projectId, a.level0, a.userSubjectId, CONCAT( a.tbSubjectCode, '-', a.tbSubjectName ) AS tbSubject, CONCAT( a.userSubjectId, '-', a.userSubjectName ) AS userSubject, IF(a.baseSubjectId IS NULL, 0, 1) AS isMapBaseSubject, IF( a.plancsE = '1' OR a.plancsC = '1' OR a.plancsA = '1' OR a.plancsV = '1' OR a.plancsP = '1', 1, 0 ) AS isSetEcvap, IF(a.subjectEditors > '', 1, 0) AS isSetSubjectEditor, IF(ap.apCount > 0, 1, 0) AS isCreatedProgram, a.isNeedToAudit FROM bdo_dg.dg_tbsubjectcontract a LEFT JOIN bdo_dg.dg_subjecttree b ON b.customerId = {param1} AND b.projectId = {param2} AND b.tbSubjectCode = a.tbSubjectCode AND b.userSubjectId = a.userSubjectId LEFT JOIN  (SELECT COUNT(ap.autoId) AS apCount, ap.subjecttreeId, ap.subjectId FROM bdo_dg.dg_auditprogram ap WHERE ap.customerId = {param1} AND ap.projectId = {param2} GROUP BY ap.subjectId, ap.subjecttreeId) ap ON ap.subjectId = a.userSubjectId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} UNION ALL SELECT a.customerId, a.projectId, a.level0, a.baseSubjectId AS userSubjectId, CONCAT( a.tbSubjectCode, '-', a.tbSubjectName ) AS tbSubject, CONCAT( a.baseSubjectId, '-', a.baseSubjectName ) AS userSubject, IF(a.userSubjectId IS NULL, 0, 1) AS isMapBaseSubject, IF( a.plancsE = '1' OR a.plancsC = '1' OR a.plancsA = '1' OR a.plancsV = '1' OR a.plancsP = '1', 1, 0 ) AS isSetEcvap, IF(a.subjectEditors > '', 1, 0) AS isSetSubjectEditor, IF(ap.apCount > 0, 1, 0) AS isCreatedProgram ,a.isNeedToAudit FROM bdo_dg.dg_othersubjectcontract a LEFT JOIN bdo_dg.dg_subjecttree b ON b.customerId = {param1} AND b.projectId = {param2} AND b.tbSubjectCode = a.tbSubjectCode AND b.userSubjectId = a.userSubjectId LEFT JOIN  (SELECT COUNT(ap.autoId) AS apCount, ap.subjecttreeId, ap.subjectId FROM bdo_dg.dg_auditprogram ap WHERE ap.customerId = {param1} AND ap.projectId = {param2} GROUP BY ap.subjectId, ap.subjecttreeId) ap ON ap.subjectId = a.baseSubjectId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3}) b ORDER BY b.userSubjectId, b.level0) a where 1 = 1 and a.isNeedToAudit = 1 /* 1. \u5168\u90E8: \u4E0D\u5904\u7406 */ /* 2. \u672A\u5B8C\u6210*/ /*START #param5# and( a.isSetEcvap = 0 OR a.isSetSubjectEditor = 0 ) #param5# END*/ /* 3. \u5DF2\u5B8C\u6210*/ /*START #param6# and( a.isSetEcvap = 1 and a.isSetSubjectEditor = 1 ) #param6# END*/  
## subjecttree ecavp \u8BA1\u7B97
#DG00287=SELECT plane.autoId, plane.customerId, plane.projectId, plane.parentId, IFNULL(plane.plansE, 0) AS plansE, IFNULL(plane.plansC, 0) AS plansC, IFNULL(plane.plansA, 0) AS plansA, IFNULL(plane.plansV, 0) AS plansV, IFNULL(plane.plansP, 0) AS plansP, IF( impe.apCount = 0 OR impe.psE = 0, plane.plansE, IFNULL( ROUND( impe.plansE / impe.psE * plane.plansE, 2 ), 0 ) ) AS sE, IF( impe.apCount = 0 OR impe.psC = 0, plane.plansC, IFNULL( ROUND( impe.plansC / impe.psC * plane.plansC, 2 ), 0 ) ) AS sC, IF( impe.apCount = 0 OR impe.psA = 0, plane.plansA, IFNULL( ROUND( impe.plansA / impe.psA * plane.plansA, 2 ), 0 ) ) AS sA, IF( impe.apCount = 0 OR impe.psV = 0, plane.plansV, IFNULL( ROUND( impe.plansV / impe.psV * plane.plansV, 2 ), 0 ) ) AS sV, IF( impe.apCount = 0 OR impe.psP = 0, plane.plansP, IFNULL( ROUND( impe.plansP / impe.psP * plane.plansP, 2 ), 0 ) ) AS sP FROM (SELECT st.autoId, st.customerId, st.projectId, st.parentId, IF(spe.sE > 0, tbce.plansE, 0) AS plansE, IF(spe.sC > 0, tbce.plansC, 0) AS plansC, IF(spe.sA > 0, tbce.plansA, 0) AS plansA, IF(spe.sV > 0, tbce.plansV, 0) AS plansV, IF(spe.sP > 0, tbce.plansP, 0) AS plansP FROM bdo_dg.dg_subjecttree st LEFT JOIN (SELECT c.subjecttreeId AS autoId, c.customerId, c.projectId, SUM(IF(c.csE = '1', 1, 0)) AS sE, SUM(IF(c.csC = '1', 1, 0)) AS sC, SUM(IF(c.csA = '1', 1, 0)) AS sA, SUM(IF(c.csV = '1', 1, 0)) AS sV, SUM(IF(c.csP = '1', 1, 0)) AS sP FROM bdo_dg.dg_auditprogram c WHERE c.ACTIVE_FLAG = '1' AND c.LEVEL = 0 AND c.customerId = {param1} AND c.projectId = {param2} GROUP BY c.subjecttreeId) spe ON spe.autoId = st.autoId AND spe.customerId = st.customerId AND spe.projectId = st.projectId LEFT JOIN (SELECT a.customerId, a.projectId, a.userSubjectId, a.tbSubjectCode, a.plansE, a.plansC, a.plansA, a.plansV, a.plansP FROM bdo_dg.dg_tbsubjectcontract a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3}) tbce ON tbce.customerId = st.customerId AND tbce.projectId = st.projectId AND tbce.userSubjectId = st.userSubjectId AND tbce.tbSubjectCode = st.tbSubjectCode WHERE st.customerId = {param1} AND st.projectId = {param2} AND st.nodeType = 'SUBJECT' AND st.ACTIVE_FLAG = '1') plane , (SELECT a.autoId, a.customerId, a.projectId, a.parentId, b.apCount, b.subApCount, b.plansE, b.plansC, b.plansV, b.plansA, b.plansP, b.psE, b.psC, b.psV, b.psA, b.psP FROM bdo_dg.dg_subjecttree a LEFT JOIN (SELECT a.subjecttreeId, a.customerId, a.projectId, COUNT(a.autoId) AS apCount, SUM(IF(a.subApCount > 0, 1, 0)) AS subApCount, SUM(IF(a.sE > 0, 1, 0)) AS plansE, SUM(IF(a.sC > 0, 1, 0)) AS plansC, SUM(IF(a.sV > 0, 1, 0)) AS plansV, SUM(IF(a.sA > 0, 1, 0)) AS plansA, SUM(IF(a.sP > 0, 1, 0)) AS plansP, SUM(IF(a.psE > 0, 1, 0)) AS psE, SUM(IF(a.psC > 0, 1, 0)) AS psC, SUM(IF(a.psV > 0, 1, 0)) AS psV, SUM(IF(a.psA > 0, 1, 0)) AS psA, SUM(IF(a.psP > 0, 1, 0)) AS psP FROM (SELECT c.subjecttreeId, c.autoId, c.customerId, c.projectId, SUM( IF( d.autoId IS NOT NULL AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS subApCount, SUM( IF( d.csE = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sE, SUM( IF( d.csC = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sC, SUM( IF( d.csV = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sV, SUM( IF( d.csA = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sA, SUM( IF( d.csP = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sP, SUM(IF(c.csE = '1', 1, 0)) AS psE, SUM(IF(c.csC = '1', 1, 0)) AS psC, SUM(IF(c.csV = '1', 1, 0)) AS psV, SUM(IF(c.csA = '1', 1, 0)) AS psA, SUM(IF(c.csP = '1', 1, 0)) AS psP FROM bdo_dg.dg_auditprogram c LEFT JOIN bdo_dg.dg_auditprogram d ON d.parentId = c.autoId AND d.customerId = {param1} AND d.projectId = {param2} AND d.level = 1 WHERE c.ACTIVE_FLAG = '1' AND c.LEVEL = 0 AND c.customerId = {param1} AND c.projectId = {param2} GROUP BY c.autoId, c.customerId, c.projectId, c.subjecttreeId) a GROUP BY a.subjecttreeId, a.customerId, a.projectId) b ON b.subjecttreeId = a.autoId AND b.customerId = a.customerId AND b.projectId = a.projectId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.nodeType = 'SUBJECT' AND a.ACTIVE_FLAG = '1') impe WHERE plane.autoId = impe.autoId AND plane.customerId = impe.customerId AND plane.projectId = impe.projectId
#DG00287=SELECT plane.autoId, plane.customerId, plane.projectId, plane.parentId, IFNULL(plane.plansE, 0) AS plansE, IFNULL(plane.plansC, 0) AS plansC, IFNULL(plane.plansA, 0) AS plansA, IFNULL(plane.plansV, 0) AS plansV, IFNULL(plane.plansP, 0) AS plansP, IF( impe.apCount = 0 OR impe.psE = 0 OR impe.plansE > impe.psE, plane.plansE, IFNULL( ROUND( impe.plansE / impe.psE * plane.plansE, 2 ), 0 ) ) AS sE, IF( impe.apCount = 0 OR impe.psC = 0 OR impe.plansC > impe.psC, plane.plansC, IFNULL( ROUND( impe.plansC / impe.psC * plane.plansC, 2 ), 0 ) ) AS sC, IF( impe.apCount = 0 OR impe.psA = 0 OR impe.plansA > impe.psA, plane.plansA, IFNULL( ROUND( impe.plansA / impe.psA * plane.plansA, 2 ), 0 ) ) AS sA, IF( impe.apCount = 0 OR impe.psV = 0 OR impe.plansV > impe.psV, plane.plansV, IFNULL( ROUND( impe.plansV / impe.psV * plane.plansV, 2 ), 0 ) ) AS sV, IF( impe.apCount = 0 OR impe.psP = 0, plane.plansP, IFNULL( ROUND( impe.plansP / impe.psP * plane.plansP, 2 ), 0 ) ) AS sP FROM (SELECT st.autoId, st.customerId, st.projectId, st.parentId, IF(spe.sE > 0, tbce.plansE, 0) AS plansE, IF(spe.sC > 0, tbce.plansC, 0) AS plansC, IF(spe.sA > 0, tbce.plansA, 0) AS plansA, IF(spe.sV > 0, tbce.plansV, 0) AS plansV, IF(spe.sP > 0, tbce.plansP, 0) AS plansP FROM bdo_dg.dg_subjecttree st LEFT JOIN (SELECT c.subjecttreeId AS autoId, c.customerId, c.projectId, SUM(IF(c.csE = '1', 1, 0)) AS sE, SUM(IF(c.csC = '1', 1, 0)) AS sC, SUM(IF(c.csA = '1', 1, 0)) AS sA, SUM(IF(c.csV = '1', 1, 0)) AS sV, SUM(IF(c.csP = '1', 1, 0)) AS sP FROM bdo_dg.dg_auditprogram c WHERE c.ACTIVE_FLAG = '1' AND c.LEVEL = 0 AND c.customerId = {param1} AND c.projectId = {param2} GROUP BY c.subjecttreeId) spe ON spe.autoId = st.autoId AND spe.customerId = st.customerId AND spe.projectId = st.projectId LEFT JOIN (SELECT a.customerId, a.projectId, a.userSubjectId, a.tbSubjectCode, a.plansE, a.plansC, a.plansA, a.plansV, a.plansP FROM bdo_dg.dg_tbsubjectcontract a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3}) tbce ON tbce.customerId = st.customerId AND tbce.projectId = st.projectId AND tbce.userSubjectId = st.userSubjectId AND tbce.tbSubjectCode = st.tbSubjectCode WHERE st.customerId = {param1} AND st.projectId = {param2} AND st.nodeType = 'SUBJECT' AND st.ACTIVE_FLAG = '1') plane, (SELECT a.autoId, a.customerId, a.projectId, a.parentId, b.apCount, b.subApCount, b.plansE, b.plansC, b.plansV, b.plansA, b.plansP, b.psE, b.psC, b.psV, b.psA, b.psP FROM bdo_dg.dg_subjecttree a LEFT JOIN (SELECT a.subjecttreeId, a.customerId, a.projectId, COUNT(a.autoId) AS apCount, SUM( IF( a.subApCount > 0, a.subApCount / a.allSubApCount, 0 ) ) AS subApCount, SUM(IF(a.sE > 0, 1, 0)) AS plansE, SUM(IF(a.sC > 0, 1, 0)) AS plansC, SUM(IF(a.sV > 0, 1, 0)) AS plansV, SUM(IF(a.sA > 0, 1, 0)) AS plansA, SUM(IF(a.sP > 0, 1, 0)) AS plansP, SUM(IF(a.psE > 0, 1, 0)) AS psE, SUM(IF(a.psC > 0, 1, 0)) AS psC, SUM(IF(a.psV > 0, 1, 0)) AS psV, SUM(IF(a.psA > 0, 1, 0)) AS psA, SUM(IF(a.psP > 0, 1, 0)) AS psP FROM (SELECT c.subjecttreeId, c.autoId, c.customerId, c.projectId, COUNT(d.autoId) AS allSubApCount, SUM( IF( d.autoId IS NOT NULL AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS subApCount, SUM( IF( d.csE = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sE, SUM( IF( d.csC = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sC, SUM( IF( d.csA = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sA, SUM( IF( d.csV = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sV, SUM( IF( d.csP = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sP, SUM(IF(c.csE = '1', 1, 0)) AS psE, SUM(IF(c.csC = '1', 1, 0)) AS psC, SUM(IF(c.csA = '1', 1, 0)) AS psA, SUM(IF(c.csV = '1', 1, 0)) AS psV, SUM(IF(c.csP = '1', 1, 0)) AS psP FROM bdo_dg.dg_auditprogram c LEFT JOIN bdo_dg.dg_auditprogram d ON d.parentId = c.autoId AND d.customerId = {param1} AND d.projectId = {param2} AND d.level = 1 WHERE c.ACTIVE_FLAG = '1' AND c.LEVEL = 0 AND c.customerId = {param1} AND c.projectId = {param2} GROUP BY c.autoId, c.customerId, c.projectId, c.subjecttreeId) a GROUP BY a.subjecttreeId, a.customerId, a.projectId) b ON b.subjecttreeId = a.autoId AND b.customerId = a.customerId AND b.projectId = a.projectId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.nodeType = 'SUBJECT' AND a.ACTIVE_FLAG = '1') impe WHERE plane.autoId = impe.autoId AND plane.customerId = impe.customerId AND plane.projectId = impe.projectId 
DG00287=SELECT plane.autoId, plane.customerId, plane.projectId, plane.parentId, IFNULL(plane.plansE, 0) AS plansE, IFNULL(plane.plansC, 0) AS plansC, IFNULL(plane.plansA, 0) AS plansA, IFNULL(plane.plansV, 0) AS plansV, IFNULL(plane.plansP, 0) AS plansP, IF( impe.apCount = 0 OR impe.psE = 0 OR impe.plansE > impe.psE, plane.plansE, IFNULL( ROUND( impe.plansE / impe.psE * plane.plansE, 2 ), 0 ) ) AS sE, IF( impe.apCount = 0 OR impe.psC = 0 OR impe.plansC > impe.psC, plane.plansC, IFNULL( ROUND( impe.plansC / impe.psC * plane.plansC, 2 ), 0 ) ) AS sC, IF( impe.apCount = 0 OR impe.psA = 0 OR impe.plansA > impe.psA, plane.plansA, IFNULL( ROUND( impe.plansA / impe.psA * plane.plansA, 2 ), 0 ) ) AS sA, IF( impe.apCount = 0 OR impe.psV = 0 OR impe.plansV > impe.psV, plane.plansV, IFNULL( ROUND( impe.plansV / impe.psV * plane.plansV, 2 ), 0 ) ) AS sV, IF( impe.apCount = 0 OR impe.psP = 0, plane.plansP, IFNULL( ROUND( impe.plansP / impe.psP * plane.plansP, 2 ), 0 ) ) AS sP FROM ( SELECT st.autoId, st.customerId, st.projectId, st.parentId, IF(spe.sE > 0, tbce.plansE, 0) AS plansE, IF(spe.sC > 0, tbce.plansC, 0) AS plansC, IF(spe.sA > 0, tbce.plansA, 0) AS plansA, IF(spe.sV > 0, tbce.plansV, 0) AS plansV, IF(spe.sP > 0, tbce.plansP, 0) AS plansP FROM bdo_dg.dg_subjecttree st LEFT JOIN ( SELECT c.subjecttreeId AS autoId, c.customerId, c.projectId, SUM(IF(c.csE = '1', 1, 0)) AS sE, SUM(IF(c.csC = '1', 1, 0)) AS sC, SUM(IF(c.csA = '1', 1, 0)) AS sA, SUM(IF(c.csV = '1', 1, 0)) AS sV, SUM(IF(c.csP = '1', 1, 0)) AS sP FROM bdo_dg.dg_auditprogram c WHERE c.ACTIVE_FLAG = '1' AND c. LEVEL = 0 AND c.customerId = {param1} AND c.projectId = {param2} GROUP BY c.subjecttreeId ) spe ON spe.autoId = st.autoId AND spe.customerId = st.customerId AND spe.projectId = st.projectId LEFT JOIN ( SELECT a.customerId, a.projectId, a.userSubjectId, a.tbSubjectCode, a.plansE, a.plansC, a.plansA, a.plansV, a.plansP FROM bdo_dg.dg_tbsubjectcontract a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} UNION SELECT a.customerId, a.projectId, a.userSubjectId, a.tbSubjectCode, a.plansE, a.plansC, a.plansA, a.plansV, a.plansP FROM bdo_dg.dg_othersubjectcontract a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} ) tbce ON tbce.customerId = st.customerId AND tbce.projectId = st.projectId AND tbce.userSubjectId = st.userSubjectId AND tbce.tbSubjectCode = st.tbSubjectCode WHERE st.customerId = {param1} AND st.projectId = {param2} AND st.nodeType = 'SUBJECT' AND st.ACTIVE_FLAG = '1' ) plane, ( SELECT a.autoId, a.customerId, a.projectId, a.parentId, b.apCount, b.subApCount, b.plansE, b.plansC, b.plansV, b.plansA, b.plansP, b.psE, b.psC, b.psV, b.psA, b.psP FROM bdo_dg.dg_subjecttree a LEFT JOIN ( SELECT a.subjecttreeId, a.customerId, a.projectId, COUNT(a.autoId) AS apCount, SUM( IF( a.subApCount > 0, a.subApCount / a.allSubApCount, 0 ) ) AS subApCount, SUM(IF(a.sE > 0, 1, 0)) AS plansE, SUM(IF(a.sC > 0, 1, 0)) AS plansC, SUM(IF(a.sV > 0, 1, 0)) AS plansV, SUM(IF(a.sA > 0, 1, 0)) AS plansA, SUM(IF(a.sP > 0, 1, 0)) AS plansP, SUM(IF(a.psE > 0, 1, 0)) AS psE, SUM(IF(a.psC > 0, 1, 0)) AS psC, SUM(IF(a.psV > 0, 1, 0)) AS psV, SUM(IF(a.psA > 0, 1, 0)) AS psA, SUM(IF(a.psP > 0, 1, 0)) AS psP FROM ( SELECT c.subjecttreeId, c.autoId, c.customerId, c.projectId, COUNT(d.autoId) AS allSubApCount, SUM( IF( d.autoId IS NOT NULL AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS subApCount, SUM( IF( d.csE = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sE, SUM( IF( d.csC = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sC, SUM( IF( d.csA = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sA, SUM( IF( d.csV = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sV, SUM( IF( d.csP = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sP, SUM(IF(c.csE = '1', 1, 0)) AS psE, SUM(IF(c.csC = '1', 1, 0)) AS psC, SUM(IF(c.csA = '1', 1, 0)) AS psA, SUM(IF(c.csV = '1', 1, 0)) AS psV, SUM(IF(c.csP = '1', 1, 0)) AS psP FROM bdo_dg.dg_auditprogram c LEFT JOIN bdo_dg.dg_auditprogram d ON d.parentId = c.autoId AND d.customerId = {param1} AND d.projectId = {param2} AND d. LEVEL = 1 WHERE c.ACTIVE_FLAG = '1' AND c. LEVEL = 0 AND c.customerId = {param1} AND c.projectId = {param2} GROUP BY c.autoId, c.customerId, c.projectId, c.subjecttreeId ) a GROUP BY a.subjecttreeId, a.customerId, a.projectId ) b ON b.subjecttreeId = a.autoId AND b.customerId = a.customerId AND b.projectId = a.projectId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.nodeType = 'SUBJECT' AND a.ACTIVE_FLAG = '1' ) impe WHERE plane.autoId = impe.autoId AND plane.customerId = impe.customerId AND plane.projectId = impe.projectId
## subjecttree ecavp \u8BA1\u7B97: \u67E5\u627E\u66F4\u65B0\u7684\u8282\u70B9SELECT plane.autoId, plane.customerId, plane.projectId, plane.parentId, IFNULL(plane.plansE, 0) AS plansE, IFNULL(plane.plansC, 0) AS plansC, IFNULL(plane.plansA, 0) AS plansA, IFNULL(plane.plansV, 0) AS plansV, IFNULL(plane.plansP, 0) AS plansP, IF( impe.apCount = 0 OR impe.psE = 0, plane.plansE, IFNULL( ROUND( impe.plansE / impe.psE * plane.plansE, 2 ), 0 ) ) AS sE, IF( impe.apCount = 0 OR impe.psC = 0, plane.plansC, IFNULL( ROUND( impe.plansC / impe.psC * plane.plansC, 2 ), 0 ) ) AS sC, IF( impe.apCount = 0 OR impe.psA = 0, plane.plansA, IFNULL( ROUND( impe.plansA / impe.psA * plane.plansA, 2 ), 0 ) ) AS sA, IF( impe.apCount = 0 OR impe.psV = 0, plane.plansV, IFNULL( ROUND( impe.plansV / impe.psV * plane.plansV, 2 ), 0 ) ) AS sV, IF( impe.apCount = 0 OR impe.psP = 0, plane.plansP, IFNULL( ROUND( impe.plansP / impe.psP * plane.plansP, 2 ), 0 ) ) AS sP FROM (SELECT st.autoId, st.customerId, st.projectId, st.parentId, IF(spe.sE > 0, tbce.plansE, 0) AS plansE, IF(spe.sC > 0, tbce.plansC, 0) AS plansC, IF(spe.sA > 0, tbce.plansA, 0) AS plansA, IF(spe.sV > 0, tbce.plansV, 0) AS plansV, IF(spe.sP > 0, tbce.plansP, 0) AS plansP FROM bdo_dg.dg_subjecttree st LEFT JOIN (SELECT c.subjecttreeId AS autoId, c.customerId, c.projectId, SUM(IF(c.csE = '1', 1, 0)) AS sE, SUM(IF(c.csC = '1', 1, 0)) AS sC, SUM(IF(c.csA = '1', 1, 0)) AS sA, SUM(IF(c.csV = '1', 1, 0)) AS sV, SUM(IF(c.csP = '1', 1, 0)) AS sP FROM bdo_dg.dg_auditprogram c WHERE c.ACTIVE_FLAG = '1' AND c.LEVEL = 0 AND c.customerId = {param1} AND c.projectId = {param2} GROUP BY c.subjecttreeId) spe ON spe.autoId = st.autoId AND spe.customerId = st.customerId AND spe.projectId = st.projectId LEFT JOIN (SELECT a.customerId, a.projectId, a.userSubjectId, a.tbSubjectCode, a.plansE, a.plansC, a.plansA, a.plansV, a.plansP FROM bdo_dg.dg_tbsubjectcontract a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param2}) tbce ON tbce.customerId = st.customerId AND tbce.projectId = st.projectId AND tbce.userSubjectId = st.userSubjectId AND tbce.tbSubjectCode = st.tbSubjectCode WHERE st.customerId = {param1} AND st.projectId = {param2} AND st.nodeType = 'SUBJECT' AND st.ACTIVE_FLAG = '1') plane /* \u8BA1\u5212\u5206\u503C */ , (SELECT a.autoId, a.customerId, a.projectId, a.parentId, b.apCount, b.subApCount, b.plansE, b.plansC, b.plansV, b.plansA, b.plansP, b.psE, b.psC, b.psV, b.psA, b.psP FROM bdo_dg.dg_subjecttree a LEFT JOIN (SELECT a.subjecttreeId, a.customerId, a.projectId, COUNT(a.autoId) AS apCount, SUM(IF(a.subApCount > 0, 1, 0)) AS subApCount, /* \u5B9E\u65BD\u7A0B\u5E8F\u8BA4\u5B9A\u4E2A\u6570*/ SUM(IF(a.sE > 0, 1, 0)) AS plansE, SUM(IF(a.sC > 0, 1, 0)) AS plansC, SUM(IF(a.sV > 0, 1, 0)) AS plansV, SUM(IF(a.sA > 0, 1, 0)) AS plansA, SUM(IF(a.sP > 0, 1, 0)) AS plansP, /* \u8BA1\u5212\u7A0B\u5E8F\u8BA4\u5B9A\u4E2A\u6570*/ SUM(IF(a.psE > 0, 1, 0)) AS psE, SUM(IF(a.psC > 0, 1, 0)) AS psC, SUM(IF(a.psV > 0, 1, 0)) AS psV, SUM(IF(a.psA > 0, 1, 0)) AS psA, SUM(IF(a.psP > 0, 1, 0)) AS psP FROM (SELECT c.subjecttreeId, c.autoId, c.customerId, c.projectId, /* \u5B9E\u65BD\u7A0B\u5E8F\u8BA4\u5B9A\u4E2A\u6570*/ SUM( IF( d.autoId IS NOT NULL AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS subApCount, SUM( IF( d.csE = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sE, SUM( IF( d.csC = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sC, SUM( IF( d.csV = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sV, SUM( IF( d.csA = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sA, SUM( IF( d.csP = '1' AND d.auditConclusion IS NOT NULL AND d.auditConclusion <> '', 1, 0 ) ) AS sP, /* \u8BA1\u5212\u7A0B\u5E8F\u8BA4\u5B9A\u4E2A\u6570 */ SUM(IF(c.csE = '1', 1, 0)) AS psE, SUM(IF(c.csC = '1', 1, 0)) AS psC, SUM(IF(c.csV = '1', 1, 0)) AS psV, SUM(IF(c.csA = '1', 1, 0)) AS psA, SUM(IF(c.csP = '1', 1, 0)) AS psP FROM bdo_dg.dg_auditprogram c LEFT JOIN bdo_dg.dg_auditprogram d ON d.parentId = c.autoId AND d.customerId = {param1} AND d.projectId = {param2} AND d.level = 1 WHERE c.ACTIVE_FLAG = '1' AND c.LEVEL = 0 AND c.customerId = {param1} AND c.projectId = {param2} GROUP BY c.autoId, c.customerId, c.projectId, c.subjecttreeId) a GROUP BY a.subjecttreeId, a.customerId, a.projectId) b ON b.subjecttreeId = a.autoId AND b.customerId = a.customerId AND b.projectId = a.projectId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.nodeType = 'SUBJECT' AND a.ACTIVE_FLAG = '1') impe /* \u5B9E\u65BD\u5206\u503C */ WHERE plane.autoId = impe.autoId AND plane.customerId = impe.customerId AND plane.projectId = impe.projectId
DG00288=SELECT st.* FROM bdo_dg.dg_subjecttree st WHERE st.customerId = {param1} AND st.projectId = {param2} AND st.nodeType = '{param4}' AND st.autoId IN ({param3}) AND st.ACTIVE_FLAG = '1' 
#20200218 \u67E5\u8BE2\u6240\u6709fileIndexId\u5F00\u5934\u4E3AP004\u7684\u5E95\u7A3F
DG00289=SELECT a.autoId, a.customerId, a.projectId, a.fullPath FROM bdo_dg.dg_workpaper a  WHERE a.fileIndexId like 'P004%'
##TB\u901A\u7528\u6A21\u677F
DG00290=SELECT IFNULL(SUM(IF(ap.level = 1, 1, 0)), 0) AS apCount,IFNULL(SUM(IF(ap.level != 1, 1, 0)), 0) AS appCount,IFNULL(SUM(IF(ap.level = 1 AND ap.workpaperId > '', 1, 0)), 0) AS wpCount FROM bdo_dg.dg_auditprogram ap left join bdo_dg.dg_subjecttree st on st.customerId = ap.customerId and st.projectId = ap.projectId and st.autoId = ap.subjecttreeId and st.userSubjectId = ap.subjectId WHERE ap.customerId = {param1} AND ap.projectId = {param2} AND ap.subjectId = '{param3}' and st.tbSubjectCode = '{param4}' and ap.ACTIVE_FLAG = '1';
##\u6279\u6CE8\u5BFC\u51FA
DG00291=SELECT a.postilAutoId, a.postilContent, a.postilContentText, a.postilCellContent, a.postilLevel, a.postilCreateUser, u1. NAME AS postilCreateUserName, a.postilAuditState, dic.attributeName AS postilAuditStateName, a.postilSubjectTreeId, a.postilIndexId, a.postilSorNum, a.postilCreationDate, a.postilState, a.commentAutoId, a.commentContent, a.commentCellContent, a.commentCreateUser, u2. NAME AS commentCreateUserName, a.commentToUser, u3. NAME AS commentToUserName, a.commentCreationDate FROM (( SELECT an.autoId AS postilAutoId, an.content AS postilContent, IFNULL(an.contentText, '') AS postilContentText, an.cellContent AS postilCellContent, an.postilLevel AS postilLevel, an.createUser AS postilCreateUser, an.auditState AS postilAuditState, an.subjectTreeId AS postilSubjectTreeId, an.indexId AS postilIndexId, an.sortNum AS postilSorNum, DATE_FORMAT( an.CREATION_DATE, '%Y-%m-%d %T' ) AS postilCreationDate, an.ACTIVE_FLAG AS postilState, co.autoId AS commentAutoId, co.content AS commentContent, co.cellContent AS commentCellContent, co.createUser AS commentCreateUser, co.commentedUser AS commentToUser, DATE_FORMAT( co.CREATION_DATE, '%Y-%m-%d %T' ) AS commentCreationDate FROM bdo_dg.dg_annotation an LEFT JOIN bdo_dg.dg_comment co ON co.annotationId = an.autoId AND co.customerId = an.customerId AND co.projectId = an.projectId WHERE an.customerId = {param1} AND an.projectId = {param2} ORDER BY an.autoId, co.autoId ) UNION ALL ( SELECT an.autoId AS postilAutoId, an.content AS postilContent, IFNULL(an.contentText, '') AS postilContentText, an.cellContent AS postilCellContent, an.postilLevel AS postilLevel, an.createUser AS postilCreateUser, an.auditState AS postilAuditState, an.subjectTreeId AS postilSubjectTreeId, an.indexId AS postilIndexId, an.sortNum AS postilSorNum, DATE_FORMAT( an.CREATION_DATE, '%Y-%m-%d %T' ) AS postilCreationDate, an.ACTIVE_FLAG AS postilState, co.autoId AS commentAutoId, co.content AS commentContent, co.cellContent AS commentCellContent, co.createUser AS commentCreateUser, co.commentedUser AS commentToUser, DATE_FORMAT( co.CREATION_DATE, '%Y-%m-%d %T' ) AS commentCreationDate FROM bdo_hb.hb_annotation an LEFT JOIN bdo_hb.hb_comment co ON co.annotationId = an.autoId AND co.customerId = an.customerId AND co.projectId = an.projectId WHERE an.customerId = {param1} AND an.projectId = {param2} ORDER BY an.autoId, co.autoId )) a LEFT JOIN bdo_base.base_dic dic ON dic.ccatalog = '\u5BA1\u8BA1\u5E73\u53F0' AND dic.attributetype = '\u5BA1\u8BA1\u9636\u6BB5' AND a.postilAuditState = dic.attributeValue1 LEFT JOIN bdo_base.base_user u1 ON u1.id = a.postilCreateUser LEFT JOIN bdo_base.base_user u2 ON u2.id = a.commentCreateUser LEFT JOIN bdo_base.base_user u3 ON u3.id = a.commentToUser ORDER BY a.postilAutoId, a.commentAutoId 
##
DG00292=select (select count(ap.autoId) as cnt from bdo_dg.dg_auditprogram ap where ap.level = 1 and ap.ACTIVE_FLAG = '1' AND ( ap.auditConclusion = '' or ap.auditConclusion is null ) and ap.customerId = {param1} and ap.projectId = {param2}) + (SELECT COUNT(ap.autoId) AS cnt FROM bdo_dg.dg_auditprogram ap left join bdo_dg.dg_auditprogram subAp on subAp.parentId = ap.autoId AND subAp.customerId = {param1} AND subAp.projectId = {param2} WHERE ap.level = 0 AND ap.ACTIVE_FLAG = '1' AND ap.customerId = {param1} AND ap.projectId = {param2} and subAp.autoId is null) as cnt 
#\u67E5\u8BE2\u7B26\u5408\u6761\u4EF6\u7684\u5BA1\u8BA1\u6761\u4EF6
DG00293=SELECT a.* FROM (SELECT c.paramHtmlPath AS path, tbsc.yyyy AS year, a.autoId, a.customerId, a.departmentId, a.projectId, a.subjecttreeId, a.parentId, a.level, a.indexId, a.auditprogramId, a.subjectId, a.workpaperId, a.subjectName, a.dgName, a.auditDesc, a.auditConclusion, a.programNamePre, a.programNameAft, a.confirmStatusPre, a.confirmStatusAft, a.required, a.state, a.updateFlag, a.customizeFlag, a.reason, a.remark, a.CREATED_BY AS createdBy, a.audit1, a.audit2, a.audit3, a.csE, a.csC, a.csA, a.csV, a.csP, a.sE, a.sC, a.sA, a.sV, a.sP, a.csEOriginal, a.csCOriginal, a.csAOriginal, a.csVOriginal, a.csPOriginal, a.sEOriginal, a.sCOriginal, a.sAOriginal, a.sVOriginal, a.sPOriginal, a.typeId, a.dgparam, a.workpaperEditor, tbsc.subjectEditors AS usubjectEditors, a.recheckUser, parent.departmentId AS parentDepartment FROM bdo_dg.dg_auditprogram a LEFT JOIN bdo_dg.dg_subjecttree b ON b.autoId = a.subjecttreeId LEFT JOIN asdb.k_dgexceltype c ON c.id = a.typeId LEFT JOIN bdo_dg.dg_tbsubjectcontract tbsc ON tbsc.projectId = a.projectId AND tbsc.customerId = a.customerId AND tbsc.userSubjectId = a.subjectId LEFT JOIN bdo_dg.dg_auditprogram parent ON parent.autoId = a.parentId AND parent.customerId = a.customerId AND parent.projectId = a.projectId WHERE a.ACTIVE_FLAG = '{param3}' AND tbsc.yyyy ={param7} AND a.customerId = {param6} /*START #param1# AND a.subjecttreeId = {param1} #param1# END*/ /*START #param2# AND b.parentId = '{param2}' #param2# END*//*START #param4# AND a.projectId = {param4} #param4# END*/ /*START #param5# AND a.level = {param5} #param5# END*/ /*START #param8# AND a.workpaperEditor = {param8} #param8# END*/ UNION SELECT c.paramHtmlPath AS path, tbsc.yyyy AS year, a.autoId, a.customerId, a.departmentId, a.projectId, a.subjecttreeId, a.parentId, a.level, a.indexId, a.auditprogramId, a.subjectId, a.workpaperId, a.subjectName, a.dgName, a.auditDesc, a.auditConclusion, a.programNamePre, a.programNameAft, a.confirmStatusPre, a.confirmStatusAft, a.required, a.state, a.updateFlag, a.customizeFlag, a.reason, a.remark, a.CREATED_BY AS createdBy, a.audit1, a.audit2, a.audit3, a.csE, a.csC, a.csA, a.csV, a.csP, a.sE, a.sC, a.sA, a.sV, a.sP, a.csEOriginal, a.csCOriginal, a.csAOriginal, a.csVOriginal, a.csPOriginal, a.sEOriginal, a.sCOriginal, a.sAOriginal, a.sVOriginal, a.sPOriginal, a.typeId, a.dgparam, a.workpaperEditor, tbsc.subjectEditors AS usubjectEditors, a.recheckUser, parent.departmentId AS parentDepartment FROM bdo_dg.dg_auditprogram a LEFT JOIN bdo_dg.dg_subjecttree b ON b.autoId = a.subjecttreeId LEFT JOIN asdb.k_dgexceltype c ON c.id = a.typeId LEFT JOIN bdo_dg.dg_othersubjectcontract tbsc ON tbsc.projectId = a.projectId AND tbsc.customerId = a.customerId AND tbsc.userSubjectId = a.subjectId LEFT JOIN bdo_dg.dg_auditprogram parent ON parent.autoId = a.parentId AND parent.customerId = a.customerId AND parent.projectId = a.projectId WHERE a.ACTIVE_FLAG = '{param3}' AND tbsc.yyyy ={param7} AND a.customerId = {param6} /*START #param1# AND a.subjecttreeId = {param1} #param1# END*/ /*START #param2# AND b.parentId = '{param2}' #param2# END*//*START #param4# AND a.projectId = {param4} #param4# END*/ /*START #param5# AND a.level = {param5} #param5# END*/ /*START #param8# AND a.workpaperEditor = {param8} #param8# END*/) a ORDER BY a.customizeFlag, CASE WHEN a.parentDepartment = 555555 THEN 0 ELSE 1 END, CASE WHEN a.customizeFlag = '1' AND a. LEVEL = 0 THEN a.autoId ELSE a.parentId END, a.autoId
DG00294=SELECT a.araId,a.araName,a.subjectId,a.status,a.reason,sum(a.ara01) as ara01,sum(a.ara02) as ara02,sum(a.ara03) as ara03,sum(a.ara04) as ara04,sum(a.ara05) as ara05,sum(a.ara06) as ara06 from bdo_dg.dg_ara a where a.customerId = {param1} AND a.projectId = {param2} AND a.subjectId LIKE '{param3}%' /*START #param4# AND a.status = '{param4}' #param4# END*/ /*START #param5#AND a.araName LIKE '%{param5}%' #param5# END*/ GROUP BY a.customerId,a.projectId,a.araId ORDER BY a.araId 
##\u9879\u76EE\u8FDB\u5EA6\u7EDF\u8BA1ss
DG00298=SELECT CONCAT( 'SELECT ', ' COUNT(a.projectId) AS prjCount, ', ' SUM(IF(a.cnt >= a.colCount, 1, 0)) prjFinishedCount, ', ' SUM(IF(a.cnt < a.colCount, 1, 0)) prjInProgressCount ' 'FROM ( ', ' select ', '  a.projectId,', concat('(', colName, ')'), 'as cnt,', a.cnt, ' as colCount', ' from ', a.tblName, ' a where a.projectId in ({param1})', ' ) a' ) AS sp, a.cnt FROM (SELECT CONCAT(a.TABLE_SCHEMA, '.', a.TABLE_NAME) AS tblName, GROUP_CONCAT( concat( 'IF(a.', a.COLUMN_NAME, ' >= 100, 1, 0) ' ) SEPARATOR ' + ' ) AS colName, count(a.COLUMN_NAME) cnt FROM information_schema.COLUMNS a WHERE a.table_schema IN ('bdo_dg') and a.TABLE_NAME = 'dg_project' and a.COLUMN_NAME like '%State' and a.COLUMN_NAME != 'projectState') a GROUP BY a.tblName
##\u9879\u76EE\u8FDB\u5EA6\u7EDF\u8BA1: DG00298\u67E5\u8BE2\u7ED3\u679C
DG00299=SELECT COUNT(a.projectId) AS prjCount, SUM(IF(a.cnt >= a.colCount, 1, 0)) prjFinishedCount, SUM(IF(a.cnt < a.colCount, 1, 0)) prjInProccessCount, FROM (select ( IF(a.materialityState >= 100, 1, 0) + IF(a.trialBalanceState >= 100, 1, 0) + IF(a.unauditedState >= 100, 1, 0) + IF(a.auditedState >= 100, 1, 0) + IF(a.identifiedState >= 100, 1, 0) + IF(a.programPlanState >= 100, 1, 0) + IF(a.programState >= 100, 1, 0) + IF(a.samplingState >= 100, 1, 0) + IF(a.clearQuestionState >= 100, 1, 0) + IF(a.noteinfoState >= 100, 1, 0) + IF(a.reportState >= 100, 1, 0) + IF(a.analysisReviewState >= 100, 1, 0) + IF( a.finalAnalysisReviewState >= 100, 1, 0 ) + IF(a.bbReportState >= 100, 1, 0) ) as cnt, 14 as colCount from bdo_dg.dg_project a where a.projectId in ({param1})) a
#\u83B7\u53D6\u8D39\u7528\u7C7B\u79D1\u76EE\u751F\u6210\u5E95\u7A3F\u65F6\u6240\u7528\u4F1A\u8BA1\u79D1\u76EE\u7EA7\u6570
#DG00300=SELECT a.dgparam FROM bdo_dg.dg_auditprogram a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.LEVEL = 1 AND a.workpaperId = {param3} 
#\u514B\u9686\u9879\u76EE\u4E2D\u6E90\u9879\u76EE\u5BA2\u6237\u79D1\u76EE\u7F16\u53F7\u5BF9\u5E94\u7684\u672C\u9879\u76EE\u5BA2\u6237\u79D1\u76EE\u7F16\u53F7
DG00302=SELECT a.userSubjectId, b.userSubjectId AS newUserSubjectId FROM ( SELECT customerId, projectId, yyyy, tbSubjectCode, tbSubjectName, baseSubjectId, baseSubjectName, userSubjectId, userSubjectName FROM bdo_dg.dg_tbsubjectcontract WHERE customerId = {param1} AND projectId = {param2} AND baseSubjectId IS NOT NULL AND yyyy = ( SELECT year FROM bdo_dg.dg_project WHERE customerId = {param1} AND projectId = {param2} )) a LEFT JOIN ( SELECT customerId, projectId, yyyy, tbSubjectCode, tbSubjectName, baseSubjectId, baseSubjectName, userSubjectId, userSubjectName FROM bdo_dg.dg_tbsubjectcontract WHERE customerId = {param3} AND projectId = {param4} AND yyyy = {param5} AND baseSubjectId IS NOT NULL) b ON a.tbSubjectCode = b.tbSubjectCode AND a.userSubjectName = b.userSubjectName WHERE b.userSubjectId IS NOT NULL
#\u73B0\u91D1\u6D41\u91CF\u8868\u914D\u7F6E\u83B7\u53D6\u5E95\u7A3F\u7684\u5168\u8DEF\u5F84
DG00303=SELECT a.fullPath FROM bdo_dg.dg_workpaper a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.autoId = ( SELECT a.workpaperId FROM bdo_dg.dg_auditprogram a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.LEVEL = 1 AND a.parentId = ( SELECT a.autoId FROM bdo_dg.dg_auditprogram a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.LEVEL = 0 AND a.auditprogramId = {param3} LIMIT 1 ) LIMIT 1 )
#\u5BA1\u5B9A\u62A5\u8868--\u73B0\u91D1\u6D41\u91CF\u8868\u7684\u6570\u636E\u53CA\u8868\u5934
DG00304=SELECT colCode, colDisp, columnDesc1, IFNULL(column1, 0) AS column1, columnDesc2, IFNULL(column2, 0) AS column2 FROM bdo_dg.dg_auditreport_info WHERE customerId = {param1} AND projectId = {param2} AND colType = '{param3}' ORDER BY rowNum
#\u5BA1\u5B9A\u62A5\u8868--\u6240\u6709\u8005\u6743\u76CA\u53D8\u52A8\u8868\u7684\u6570\u636E\u53CA\u8868\u5934
DG00305=SELECT colCode, colDisp, columnDesc1, IFNULL(column1, 0) AS column1, columnDesc2, IFNULL(column2, 0) AS column2, columnDesc3, IFNULL(column3, 0) AS column3, columnDesc4, IFNULL(column4, 0) AS column4, columnDesc5, IFNULL(column5, 0) AS column5, columnDesc6, IFNULL(column6, 0) AS column6, columnDesc7, IFNULL(column7, 0) AS column7, columnDesc8, IFNULL(column8, 0) AS column8, columnDesc9, IFNULL(column9, 0) AS column9, columnDesc10, IFNULL(column10, 0) AS column10, columnDesc11, IFNULL(column11, 0) AS column11, columnDesc12, IFNULL(column12, 0) AS column12, columnDesc13, IFNULL(column13, 0) AS column13, columnDesc14, IFNULL(column14, 0) AS column14, columnDesc15, IFNULL(column15, 0) AS column15 FROM bdo_dg.dg_auditreport_info WHERE customerId = {param1} AND projectId = {param2} AND colType = '{param3}' AND isPre = {param4} ORDER BY rowNum
#\u53D6\u5F97\u6807\u7B7E\u503C(\u8BD5\u7B97\u5E73\u8861\u8868)
DG00306=SELECT {param1} FROM {param2} WHERE {param3}
#\u5408\u5E76\u9644\u6CE8\u4E00\u89C8
DG00309=SELECT a.autoId, a.customerId, a.projectId, a.mergeProjectId, a.knoteId, a.noteNo, a.noteName, a.colCode, a.colName, a.fileName, a.fullPath, a.reportTplId, a.isForbid, a.isEdited, a.isFinished, a.isCompleteNow, DATE_FORMAT( a.LAST_UPDATE_DATE, '%Y-%m-%d %H:%i:%s' ) AS updateTime, a.LAST_UPDATED_BY AS __urevisor FROM bdo_hb.hb_mergenoteinfo a  WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.autoId <> {param3}  #param3# END*/ /*START #param4# AND a.mergeProjectId = {param4}  #param4# END*/ ORDER BY a.sortNo
#\u5408\u5E76\u9644\u6CE8\u8282\u70B9\u4FE1\u606F
DG00310=SELECT a.autoId, a.customerId, a.projectId, a.mergeProjectId, a.knoteId, a.noteNo, a.noteName, a.colCode, a.colName, a.fileName, a.fullPath, a.noteDgValueInfo, a.reportTplId, a.isForbid, a.isEdited, a.isFinished, a.customizeStyle FROM bdo_hb.hb_mergenoteinfo a WHERE a.autoId = {param1} AND a.customerId = {param2} AND a.projectId = {param3} AND a.mergeProjectId = {param4} AND a.ACTIVE_FLAG = '1' ORDER BY a.autoId
#\u6839\u636E\u6761\u4EF6\u53D6\u5F97\u5408\u5E76\u9879\u76EE\u6807\u7B7E\u540D
DG00311=SELECT a.autoId, a.customerId, a.projectId, a.mergeProjectId, a.tagName, a.tagValue, a.tagPosition, a.tagInfo, a.tagDgId FROM bdo_hb.hb_mergeprojectlstag a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.mergeProjectId = {param3} /*START #param4# AND a.tagPosition = '{param4}' #param4# END*/ /*START #param5# AND a.autoId = {param5} #param5# END*/AND a.ACTIVE_FLAG = '1' ORDER BY a.autoId
#\u67E5\u8BE2\u5408\u5E76\u9644\u6CE8\u81EA\u5B9A\u4E49\u5355\u5143\u683C\u7C7B\u578B
DG00312=SELECT a.customizeStyle FROM bdo_hb.hb_mergenoteinfo a WHERE a.autoId = {param1} AND a.customerId = {param2} AND a.projectId = {param3} AND a.mergeProjectId = {param4}
#\u67E5\u8BE2\u5408\u5E76\u9879\u76EE\u4E2D\u6BCD\u516C\u53F8\u53CA\u5176\u4E0B\u5C5E\u5B50\u516C\u53F8\u7684\u9879\u76EE\u7F16\u53F7\u53CA\u9879\u76EE\u540D\u79F0
DG00313=SELECT a.projectId, a.projectName FROM bdo_dg.dg_project a WHERE a.customerId = {param1} AND a.projectId = {param2} UNION SELECT a.mergeProjectId AS projectId, a.mergeProjectName AS projectName FROM bdo_hb.hb_mergeproject a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.mergeprojectId IS NOT NULL AND a.ACTIVE_FLAG = 1
#\u83B7\u53D6\u5408\u5E76\u6807\u7B7E
DG00314=SELECT a.autoId, a.customerId, a.projectId, a.mergeProjectId, a.tagName, a.tagValue, a.tagPosition, a.tagInfo, a.tagType, a.tagProperty, a.tagDgId, CASE a.tagType WHEN 'mergeNote' THEN c.noteName WHEN 'mergeReport' THEN a.tagPosition END AS otherPosition FROM ( SELECT a.autoId, a.customerId, a.projectId, a.mergeProjectId, a.tagName, a.tagValue, a.tagPosition, a.tagInfo, a.tagType, a.tagProperty, a.tagDgId FROM bdo_hb.hb_mergeprojectlstag a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.mergeProjectId = {param3} /*START #param4# AND a.tagDgId = {param4} #param4# END*/ /*START #param5# AND a.tagType = '{param5}' #param5# END*/ AND a.ACTIVE_FLAG = '1' ORDER BY a.autoId ) a LEFT JOIN bdo_hb.hb_mergenoteinfo c ON a.tagType = 'mergeNote' AND a.customerId = c.customerId AND a.projectId = c.projectId AND a.mergeProjectId = c.mergeProjectId AND a.tagDgId IS NOT NULL AND a.tagDgId = c.autoId
#\u5408\u5E76\u6821\u9A8C\u516C\u5F0F
DG00315=SELECT a.autoId, a.customerId, a.projectId, a.mergeProjectId, a.subjectId, a.subjectName, a.formulaType, a.formulaProperty, a.formula, a.formulaText, a.formulaValue, a.formulaCalc, a.formulaAutoId, a.LAST_UPDATE_DATE AS updateTime FROM bdo_hb.hb_mergeprojectformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.mergeProjectId = {param3} /*START #param4# AND a.formulaType = '{param4}' #param4# END*/ /*START #param5# AND a.autoId IN ({param5}) #param5# END*/ AND a.ACTIVE_FLAG = '1' ORDER BY a.formulaCalc
#\u5408\u5E76\u6821\u9A8C\u516C\u5F0F--\u6B63\u786E\u6570/\u603B\u6570
DG00316=SELECT COUNT(*) AS totalNum, COUNT( IF( a.formulaCalc = '1', TRUE, NULL )) AS rightNum FROM bdo_hb.hb_mergeprojectformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.mergeProjectId = {param3} AND a.ACTIVE_FLAG = '1' /*START #param4# AND a.autoId IN ({param4}) #param4# END*/ /*START #param5# AND a.formulaType = '{param5}' #param5# END*/
#\u79D1\u76EE\u5E95\u7A3F\u6821\u9A8C\u516C\u5F0FID--\u6821\u9A8C\u516C\u5F0FID
DG00317=SELECT a.autoId, a.customerId, a.projectId, a.mergeProjectId, a.infoType, a.infoId, a.infoName, a.infoFormula, a.infoVersion, a.remark FROM bdo_hb.hb_referredmergeformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.mergeProjectId = {param3} AND ( a.infoFormula LIKE CONCAT({param4}, ',%') OR a.infoFormula LIKE CONCAT('%,', {param4}) OR a.infoFormula LIKE CONCAT('%,', {param4}, ',%') OR a.infoFormula = '{param4}' )
#\u79D1\u76EE\u5E95\u7A3F\u6821\u9A8C\u516C\u5F0FID--\u9644\u6CE8ID
DG00318=SELECT a.autoId, a.customerId, a.projectId, a.infoType, a.infoId, a.infoName, a.infoFormula, a.infoVersion, a.remark FROM bdo_hb.hb_referredmergeformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.mergeProjectId = {param3} AND a.infoType = '{param4}' AND a.infoId = {param5}
#\u6A21\u7CCA\u67E5\u8BE2\u6821\u9A8C\u6570\u636E\u516C\u5F0F
DG00319=SELECT a.autoId, a.customerId, a.projectId, a.mergeProjectId, a.subjectId, a.subjectName, a.formulaType, a.formulaProperty, a.formula, a.formulaText, a.formulaValue, a.formulaCalc, a.formulaAutoId FROM bdo_hb.hb_mergeprojectformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.mergeProjectId = {param3} AND ( a.formula LIKE CONCAT('%', {param4}) OR a.formula LIKE CONCAT({param4}, '%') OR a.formula LIKE CONCAT('%', {param4}, '=%') OR a.formula LIKE CONCAT('%', {param4}, '+%') OR a.formula LIKE CONCAT('%', {param4}, '-%')) AND a.ACTIVE_FLAG = '1' ORDER BY a.autoId 
#\u5408\u5E76\u9644\u6CE8\u4E00\u89C8
DG00320=SELECT a.sortNo,a.autoId, a.customerId, a.projectId, a.mergeProjectId, a.knoteId, a.noteNo, a.noteName, a.colCode, a.colName, a.fileName, a.fullPath, a.reportTplId, a.dgData, a.isForbid, a.isEdited, a.isFinished, a.isCompleteNow, DATE_FORMAT( a.LAST_UPDATE_DATE, '%Y-%m-%d %H:%i:%s' ) AS lastUpdateDate, a.LAST_UPDATED_BY AS __ulastUpdatedUser FROM bdo_hb.hb_mergenoteinfo a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.mergeProjectId = {param3} ORDER BY a.sortNo ASC
#\u5176\u4ED6\u5E95\u7A3F
DG00321=SELECT a.fileName, a.fileIndexId, a.autoId FROM bdo_dg.dg_workpaper a WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.fileName LIKE CONCAT('%', '{param3}', '%') #param3# END*/ AND a.fileIndexId <> 'P004-0001' ORDER BY a.fileIndexId ASC 
#20200620 \u67E5\u8BE2\u5408\u5E76\u9879\u76EE\u4E0B\u6240\u6709\u7684\u5B50\u516C\u53F8\u53CA\u5176\u5BF9\u5E94\u7684\u91CD\u8981\u6027\u6C34\u5E73
DG00322=SELECT a.autoId,a.mergeCustomerName, a.shortName, a.stockBreakRate, a.mergeScope, ifnull(a.settingTypeValue1,0) as settingTypeValue1, ifnull(a.settingTypeValue2,0) as settingTypeValue2, a.mergeProjectName, a.projectSource FROM bdo_hb.hb_mergeproject a WHERE a.customerId = {param1} AND a.projectId = {param2} ORDER BY a.mergeScope DESC
#\u6839\u636EprojectId\u67E5\u8BE2\u9879\u76EE\u4FE1\u606F
DG00323=SELECT a.manager, a.membersId FROM bdo_dg.dg_project a WHERE projectId = {param1} 
#\u6279\u6CE8
DG00324=SELECT * FROM ( SELECT a.autoId, a.customerId, a.projectId, a.mergeProjectId, a.indexId, a.createUser AS __ucreateUser, DATE_FORMAT( a.CREATION_DATE, '%Y-%m-%d %H:%i:%s' ) AS createDate, a.content, a.cellContent, a.postilLevel, NULL AS comments, a.ACTIVE_FLAG AS activeFlag, ( CASE WHEN a.CREATED_BY = {userId} THEN 'true' ELSE 'false' END ) AS isAuthor, '' AS __ucommentedUser, a.type, '' AS commentId, '' AS annotationId FROM bdo_hb.hb_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.autoId = {param3} #param3# END*/ /*START #param4# AND a.auditState = {param4} #param4# END*/ AND a.foreignId = {param5} AND a.type = '{param6}' AND a.mergeProjectId = {param7} UNION ALL SELECT a.autoId, b.customerId, b.projectId, b.mergeCustomerId, b.indexId, a.createUser AS __ucreateUser, DATE_FORMAT( a.CREATION_DATE, '%Y-%m-%d %H:%i:%s' ) AS createDate, a.content, a.cellContent, '' AS postilLevel, NULL AS comments, a.ACTIVE_FLAG AS activeFlag, ( CASE WHEN a.CREATED_BY = {userId} THEN 'true' ELSE 'false' END ) AS isAuthor, a.commentedUser AS __ucommentedUser, a.TYPE, a.commentId, a.annotationId FROM bdo_hb.hb_comment a LEFT JOIN bdo_hb.hb_annotation b ON b.autoId = a.annotationId AND a.customerId = b.customerId AND a.projectId = b.projectId AND a.mergeProjectId = b.mergeProjectId WHERE b.customerId = {param1} AND b.projectId = {param2} /*START #param3# AND b.autoId = {param3} #param3# END*/ /*START #param4# AND b.auditState = {param4}  #param4# END*/ AND b.foreignId = {param5} AND b.type = '{param6}' AND b.mergeProjectId = {param7} ) a
#\u5408\u5E76\u9879\u76EE--\u9879\u76EE\u4FE1\u606F\uFF08\u6839\u636EmergeProjectId\uFF09
DG00325=SELECT b.tbTemplateName,b.mergeType, b.endMonth, a.autoId, a.projectIdMerge, a.projectIdMergeText, a.financeReportType, CASE WHEN a.financeReportType = '0' THEN '\u5355\u4F53' WHEN a.financeReportType = '1' THEN '\u5408\u5E76' END AS financeReportTypeStr, a.audit1, a.audit2, a.auditTimeBegin, a.auditTimeEnd, a.customerId, a.customerName, a.identifiedAuditUser, a.identifiedState, a.identifiedStateWeight, a.isResetNow, a.manager, a.materialityAuditUser, a.materialityState, a.materialityStateWeight, a.members, a.membersId, a.programAuditUser, a.programPlanAuditUser, a.programPlanState, a.programPlanStateWeight, a.programState, a.programStateWeight, a.projectId, a.projectName, a.reportFormat, a.signUser, a.tbTemplate, a.tbReportTemplate, a.trialBalanceAuditUser, a.trialBalanceState, a.trialBalanceStateWeight, a.unauditedAuditUser, a.unauditedState, a.unauditedStateWeight, a.year, a.preCustomerId, a.preProjectId, a.preProjectName, a.preId, a.preYear, a.manager AS __umanager, a.audit1 AS __uaudit1, a.audit2 AS __uaudit2, a.signUser AS __usignUser, a.auditStatu, b.quoteReport, b.quoteTb, b.quoteIdentified, b.quoteProgram, a.finalResults, a.signAccountant2, a.signAccountant3, a.reviewPartner, a.reaReviewer, a.issuedPeople, a.signAccountant2 AS __usignAccountant2, a.signAccountant3 AS __usignAccountant3, a.reviewPartner AS __ureviewPartner, a.reaReviewer AS __ureaReviewer, a.issuedPeople AS __uissuedPeople,DATE_FORMAT(b.projectStartDate, '%Y-%m-%d') AS projectStartDate,DATE_FORMAT(b.projectEndDate, '%Y-%m-%d') AS projectEndDate,b.auditPolicyFileId FROM bdo_dg.dg_project a LEFT JOIN bdo_dg.dg_projectext b ON a.customerId=b.customerId AND a.projectId=b.projectId WHERE a.projectId = {param1}
#\u5408\u5E76\u6279\u6CE8\u4E0B\u7684\u8BC4\u8BBA
DG00326=SELECT a.autoId, a.customerId, a.projectId, a.mergeProjectId, b.indexId, a.createUser AS __ucreateUser, DATE_FORMAT( a.CREATION_DATE, '%Y-%m-%d %H:%i:%s' ) AS createDate, a.content, IFNULL(a.contentText, '') AS postilContentText, a.cellContent, NULL AS comments, a.ACTIVE_FLAG AS activeFlag, ( CASE WHEN a.CREATED_BY = {userId} THEN 'true' ELSE 'false' END ) AS isAuthor, a.commentedUser AS __ucommentedUser, a.TYPE, a.commentId, a.annotationId FROM bdo_hb.hb_comment a LEFT JOIN bdo_hb.hb_annotation b ON b.autoId = a.annotationId AND a.customerId = b.customerId AND a.projectId = b.projectId AND a.mergeProjectId = b.mergeProjectId WHERE b.customerId = {param1} AND b.projectId = {param2} /*START #param3# AND b.autoId = {param3} #param3# END*/ /*START #param4# AND b.auditState = {param4}  #param4# END*/ AND b.foreignId = {param5} AND b.type = '{param6}' /*START #param7# AND a.autoId = {param7}  #param7# END*/ AND b.mergeProjectId = {param8}
#\u540C\u6B65\u7528\u6237\u5BA2\u6237
DG00327=SELECT COUNT(DISTINCT a.id) FROM bdo_base.base_user a LEFT JOIN bdo_base.base_userrole b ON a.id = b.userId AND b.rid IN (43, 42, 41, 40, 39, 38, 35, 33) WHERE a.ACTIVE_FLAG = 1 AND a.isActive = 1 AND a.hrLoginId > '' AND b.rid IS NOT NULL
#\u62BD\u51ED\u9644\u4EF6
DG00328=SELECT a.autoId, a.customerId, a.projectId, a.fileIndexId, a.fileName, a.fileType, a.suffix, a.fullPath, a.uploadDate, a.subjectTreeId, a.indexIdSeq, a.sortNum, a.relateType, c.subjectentryId, b.subjectId FROM bdo_dg.dg_samplingfile a inner join bdo_dg.dg_samplingfilerelated c on a.autoId = c.samplingFileId LEFT JOIN bdo_dg.dg_samplingsubjectentry b ON a.customerId = b.customerId AND a.projectId = b.projectId AND c.subjectentryId = b.autoId WHERE a.customerId = {param1} AND a.projectId = {param2} AND c.subjectentryId IS NOT NULL AND b.subjectId in ({param3})
#\u62BD\u51ED\u9644\u4EF6\u662F\u5426\u5B58\u5728
DG00329=SELECT COUNT(1) AS num FROM bdo_dg.dg_samplingfile a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.autoId = {param3}
#\u5E95\u7A3F\u8DF3\u8F6C
DG00330=SELECT k.dgColIndex1,k.dgColIndex3,k.dgColIndex4, k.dgColIndex1Param1, k.dgColIndex2, k.autoId, k.id, k.name, k.subjectId, k.indexId, k.sheetIndex, k.colIndex, k.checColkIndex, k.paramColIndex1, k.param1, k.paramColIndex2, k.param2, k.paramColIndex3, k.param3, k.paramColIndex4, k.param4, k.paramColIndex5, k.param5, k.redirectId, k.redirectName, k.redirectSubjectId, k.redirectIndexId, k.implementationMethod, k.generateMethod FROM asdb.k_dg_redirect k WHERE k.id = ( SELECT b.auditprogramId FROM bdo_dg.dg_auditprogram a LEFT JOIN bdo_dg.dg_auditprogram b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.parentId = b.autoId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.workpaperId = {param3} )
#\u5E95\u7A3F\u8DF3\u8F6C\u5176\u4ED6\u5E95\u7A3F\u662F\u5426\u5B58\u5728
DG00331=SELECT a.otherWorkpaperId, a.otherSheetIndex FROM bdo_dg.dg_workpaper_redirect a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.workpaperId = {param3} AND a.sheetIndex = {param4} AND a.rangeStr = '{param5}'
#\u6279\u6CE8\u4E0B\u7684\u8BC4\u8BBA
DG00332=SELECT a.autoId, a.customerId, b.indexId, a.createUser AS __ucreateUser, DATE_FORMAT( a.CREATION_DATE, '%Y-%m-%d %H:%i:%s' ) AS createDate, a.content, IFNULL(a.contentText,'') AS postilContentText, a.cellContent, NULL AS comments, a.ACTIVE_FLAG AS activeFlag, ( CASE WHEN a.CREATED_BY = {userId} THEN 'true' ELSE 'false' END ) AS isAuthor, a.commentedUser AS __ucommentedUser, a.TYPE, a.commentId, a.annotationId FROM bdo_hb.hb_comment a LEFT JOIN bdo_hb.hb_annotation b ON b.autoId = a.annotationId AND a.customerId = b.customerId WHERE b.customerId = {param1} AND b.projectId = {param2} /*START #param3# AND b.autoId = {param3} #param3# END*/ /*START #param4# AND b.auditState = {param4}  #param4# END*/  AND b.type = '{param6}' /*START #param7# AND a.autoId = {param7}  #param7# END*/
#\u5408\u5E76\u6279\u6CE8\u6700\u5927\u7D22\u5F15\u53F7
DG00333=SELECT MAX(a.indexIdSeq) FROM bdo_hb.hb_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.type = {param3} 
#\u6279\u6CE8\u6C47\u603B
DG00334=SELECT COUNT(a.autoId) AS postil FROM bdo_hb.hb_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 100 UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_hb.hb_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 100 AND a.ACTIVE_FLAG = '0' UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_hb.hb_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 200 UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_hb.hb_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 200 AND a.ACTIVE_FLAG = '0' UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_hb.hb_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 300 UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_hb.hb_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 300 AND a.ACTIVE_FLAG = '0' UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_hb.hb_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 400 UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_hb.hb_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 400 AND a.ACTIVE_FLAG = '0' UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_hb.hb_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 500 UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_hb.hb_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 500 AND a.ACTIVE_FLAG = '0' UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_hb.hb_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 600 UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_hb.hb_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 600 AND a.ACTIVE_FLAG = '0' UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_hb.hb_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 700 UNION ALL SELECT COUNT(a.autoId) AS postil FROM bdo_hb.hb_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.auditState = 700 AND a.ACTIVE_FLAG = '0' 
#\u67E5\u8BE2\u5408\u5E76\u9879\u76EE\u7684\u5BA1\u8BA1\u9636\u6BB5\u7684\u91CD\u8981\u6027\u6C34\u5E73
DG00335=SELECT a.auditAmount AS amount FROM bdo_hb.hb_mergesummary a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} AND a.subjectId = {param4} and a.summaryType !=0
#\u67E5\u8BE2\u5E95\u7A3F\u751F\u6210\u5176\u4ED6\u5E95\u7A3F\u6240\u4F7F\u7528\u7684\u53C2\u6570\u7684\u4F4D\u7F6E
DG00336=SELECT c.paramColIndex1, c.param1, c.paramColIndex2, c.param2, c.paramColIndex3, c.param3, c.paramColIndex4, c.param4, c.paramColIndex5, c.param5 FROM bdo_dg.dg_auditprogram a LEFT JOIN bdo_dg.dg_auditprogram b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.parentid = b.autoId LEFT JOIN asdb.k_dg_redirect c ON b.auditprogramId = c.id WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.workpaperId = {param3}
#\u6839\u636E\u8BA1\u7B97\u516C\u5F0F\u6A21\u7CCA\u67E5\u8BE2\u9879\u76EETB\u79D1\u76EE\u8868
DG00337=SELECT t.autoId, t.vocationId, t.customerId, t.projectId, t.departmentId, t.tbSubjectId, t.tbSubjectName, t.reportSubjectId, t.reportSubjectName, t.subjectType1, t.sortNo, t.userDefined, IFNULL(t.cusCalFun, "") AS cusCalFun, IFNULL(t.calFun, "") AS calFun, t.isSubject, t.ACTIVE_FLAG FROM bdo_dg.dg_projecttb AS t WHERE t.customerId = {param1} AND t.projectId = {param2} AND (t.cusCalFun LIKE CONCAT('%', '{param3}', '%') OR t.calFun LIKE CONCAT('%', '{param3}', '%'))
#\u67E5\u8BE2\u6807\u7B7E\u5B58\u5728\u4E8E\u591A\u5C11\u6821\u9A8C\u516C\u5F0F\u4E2D
DG00338=SELECT COUNT(1) AS num FROM bdo_dg.dg_projectformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND ( a.formula LIKE CONCAT('%', '{param3}', '=%') OR a.formula LIKE CONCAT('%', '{param3}', '+%') OR a.formula LIKE CONCAT('%', '{param3}', '-%') OR a.formula LIKE CONCAT('%', '{param3}'))
#\u9879\u76EE\u94F6\u884C\u5BF9\u8D26\u5355
DG00339=SELECT a.autoId, a.customerId, a.projectId, a.bankName, a.checkStatus, a.checkFileFullPath, a.checkFileName FROM bdo_dg.dg_banklist a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.checkFileFullPath IS NOT NULL AND a.checkFileFullPath <> '' 
#TB\u79D1\u76EE\u5BF9\u7167\u7684fsa\u7F16\u7801
DG00340=SELECT a.*, b.fsaCode, b.fsaName, b.lsReportCode, b.lsReportName FROM ( SELECT a.customerId, a.projectId, a.yyyy, a.tbSubjectId, a.tbSubjectName, a.baseSubjectId, a.baseSubjectName FROM bdo_dg.dg_tbsubjectcontract a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.tbSubjectId IS NOT NULL AND a.baseSubjectId IS NOT NULL ) a LEFT JOIN asdb.k_subject b ON a.baseSubjectId = b.subjectId GROUP BY a.tbSubjectId
#\u5F52\u6863\u9879\u76EE\u8FC7\u6EE4\u5668\u914D\u7F6E
DG00341=select a.filterUri, a.filterType, a.paramName, a.methodPattern from asdb.k_dgfiledfilterrule a where a.ACTIVE_FLAG = '1'
#\u67E5\u8BE2\u9879\u76EE\u884C\u4E1A
DG00342=SELECT a.industryclassification,a.industrycategory,a.industrycategorycode,a.industryclassificationcode,(CASE WHEN (ISNULL(a.industrycategory)=1) || (LENGTH(trim(a.industrycategory))=0) THEN a.industryclassification ELSE a.industrycategory END)as aa, (CASE WHEN (ISNULL(a.industrycategorycode)=1) || (LENGTH(trim(a.industrycategorycode))=0) THEN CONCAT(upper(a.industryclassificationcode),'-GB') ELSE CONCAT(UPPER(a.industryclassificationcode),a.industrycategorycode,'-GB') END)as aacode from bdo_dg.dg_projectext a WHERE a.projectId = {param1} AND a.customerId = {param2}
#\u5E95\u7A3F\u9001\u5BA1\u68C0\u67E5\u8868--\u662F\u5426\u586B\u5199\u3001\u662F\u5426\u5BA1\u6838
DG00343=SELECT a.projectId, a.customerId, a.reviewtemplateId, MAX(a.isFillOut) AS isFillOut, a.fillOutDate, MAX(a.isAudit) AS isAudit, a.auditDate FROM bdo_dg.dg_review_check a WHERE a.customerId = {param1} AND a.projectId = {param2} GROUP BY a.projectId, a.customerId, a.reviewtemplateId
#\u5BA1\u6838\u6C47\u603B--\u5E95\u7A3F\u9001\u5BA1\u68C0\u67E5\u8868
DG00344=SELECT a.autoId, a.projectId, a.customerId, a.reviewtemplateId, a.id, a.title, a.parentId, a.auditor, a.auditOpinion, a.approvalItem1, a.approvalItemType1, a.approvalItemOptions1, a.approvalItemValue1, a.approvalItemMust1, a.approvalItem2, a.approvalItemType2, a.approvalItemOptions2, a.approvalItemValue2, a.approvalItemMust2, a.approvalItem3, a.approvalItemType3, a.approvalItemOptions3, a.approvalItemValue3, a.approvalItemMust3, a.approvalItem4, a.approvalItemType4, a.approvalItemOptions4, a.approvalItemValue4, a.approvalItemMust4, a.approvalItem5, a.approvalItemType5, a.approvalItemOptions5, a.approvalItemValue5, a.approvalItemMust5, a.approvalItem6, a.approvalItemType6, a.approvalItemOptions6, a.approvalItemValue6, a.approvalItemMust6, a.approvalItem7, a.approvalItemType7, a.approvalItemOptions7, a.approvalItemValue7, a.approvalItemMust7, a.approvalItem8, a.approvalItemType8, a.approvalItemOptions8, a.approvalItemValue8, a.approvalItemMust8, a.approvalItem9, a.approvalItemType9, a.approvalItemOptions9, a.approvalItemValue9, a.approvalItemMust9, a.approvalItem10, a.approvalItemType10, a.approvalItemOptions10, a.approvalItemValue10, a.approvalItemMust10, a.approvalItem11, a.approvalItemType11, a.approvalItemOptions11, a.approvalItemValue11, a.approvalItemMust11, a.approvalItem12, a.approvalItemType12, a.approvalItemOptions12, a.approvalItemValue12, a.approvalItemMust12, a.approvalItem13, a.approvalItemType13, a.approvalItemOptions13, a.approvalItemValue13, a.approvalItemMust13, a.approvalItem14, a.approvalItemType14, a.approvalItemOptions14, a.approvalItemValue14, a.approvalItemMust14, a.approvalItem15, a.approvalItemType15, a.approvalItemOptions15, a.approvalItemValue15, a.approvalItemMust15, a.approvalItem16, a.approvalItemType16, a.approvalItemOptions16, a.approvalItemValue16, a.approvalItemMust16, a.approvalItem17, a.approvalItemType17, a.approvalItemOptions17, a.approvalItemValue17, a.approvalItemMust17, a.approvalItem18, a.approvalItemType18, a.approvalItemOptions18, a.approvalItemValue18, a.approvalItemMust18, a.approvalItem19, a.approvalItemType19, a.approvalItemOptions19, a.approvalItemValue19, a.approvalItemMust19, a.approvalItem20, a.approvalItemType20, a.approvalItemOptions20, a.approvalItemValue20, a.approvalItemMust20, a.isFillOut, a.fillOutDate, a.isAudit, a.auditDate FROM bdo_dg.dg_review_check a WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.parentId = {param3} #param3# END*/
#\u5BA1\u6838\u6C47\u603B--\u5E95\u7A3F\u9001\u5BA1\u68C0\u67E5\u8868--\u7EDF\u8BA1\u5DF2\u5BA1\u6838
DG00345=SELECT COUNT(a.autoId) AS reviewSummary FROM bdo_dg.dg_review_check a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.parentId != 0 UNION ALL SELECT COUNT(a.autoId) AS reviewSummary FROM bdo_dg.dg_review_check a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.isAudit = 1 AND a.parentId != 0
#\u5BA1\u6838\u6C47\u603B--\u5E95\u7A3F\u9001\u5BA1\u68C0\u67E5\u8868--\u8868\u5934
DG00346=SELECT a.customerId, a.projectId, a.reviewtemplateId, a.approvalItem1, a.approvalItemType1, a.approvalItemMust1, a.approvalItem2, a.approvalItemType2, a.approvalItemMust2, a.approvalItem3, a.approvalItemType3, a.approvalItemMust3, a.approvalItem4, a.approvalItemType4, a.approvalItemMust4, a.approvalItem5, a.approvalItemType5, a.approvalItemMust5, a.approvalItem6, a.approvalItemType6, a.approvalItemMust6, a.approvalItem7, a.approvalItemType7, a.approvalItemMust7, a.approvalItem8, a.approvalItemType8, a.approvalItemMust8, a.approvalItem9, a.approvalItemType9, a.approvalItemMust9, a.approvalItem10, a.approvalItemType10, a.approvalItemMust10, a.approvalItem11, a.approvalItemType11, a.approvalItemMust11, a.approvalItem12, a.approvalItemType12, a.approvalItemMust12, a.approvalItem13, a.approvalItemType13, a.approvalItemMust13, a.approvalItem14, a.approvalItemType14, a.approvalItemMust14, a.approvalItem15, a.approvalItemType15, a.approvalItemMust15, a.approvalItem16, a.approvalItemType16, a.approvalItemMust16, a.approvalItem17, a.approvalItemType17, a.approvalItemMust17, a.approvalItem18, a.approvalItemType18, a.approvalItemMust18, a.approvalItem19, a.approvalItemType19, a.approvalItemMust19, a.approvalItem20, a.approvalItemType20, a.approvalItemMust20 FROM bdo_dg.dg_review_check a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.parentId != 0 AND ( a.approvalItemType1 IS NULL OR a.approvalItemType1 != 3 ) AND ( a.approvalItemType2 IS NULL OR a.approvalItemType2 != 3 ) AND ( a.approvalItemType3 IS NULL OR a.approvalItemType3 != 3 ) AND ( a.approvalItemType4 IS NULL OR a.approvalItemType4 != 3 ) AND ( a.approvalItemType5 IS NULL OR a.approvalItemType5 != 3 ) AND ( a.approvalItemType6 IS NULL OR a.approvalItemType6 != 3 ) AND ( a.approvalItemType7 IS NULL OR a.approvalItemType7 != 3 ) AND ( a.approvalItemType8 IS NULL OR a.approvalItemType8 != 3 ) AND ( a.approvalItemType9 IS NULL OR a.approvalItemType9 != 3 ) AND ( a.approvalItemType10 IS NULL OR a.approvalItemType10 != 3 ) AND ( a.approvalItemType11 IS NULL OR a.approvalItemType11 != 3 ) AND ( a.approvalItemType12 IS NULL OR a.approvalItemType12 != 3 ) AND ( a.approvalItemType13 IS NULL OR a.approvalItemType13 != 3 ) AND ( a.approvalItemType14 IS NULL OR a.approvalItemType14 != 3 ) AND ( a.approvalItemType15 IS NULL OR a.approvalItemType15 != 3 ) AND ( a.approvalItemType16 IS NULL OR a.approvalItemType16 != 3 ) AND ( a.approvalItemType17 IS NULL OR a.approvalItemType17 != 3 ) AND ( a.approvalItemType18 IS NULL OR a.approvalItemType18 != 3 ) AND ( a.approvalItemType19 IS NULL OR a.approvalItemType19 != 3 ) AND ( a.approvalItemType20 IS NULL OR a.approvalItemType20 != 3 ) GROUP BY a.customerId, a.projectId, a.reviewtemplateId
#\u5176\u4ED6\u79D1\u76EE\u6811 \uFF082020-11-13\u65B0\u589E\u8868\uFF09
DG00347=SELECT a.autoId, a.autoId AS id, a.subjectId AS value, a.parentId, a.parentId AS _parentId, a.level, a.isLeaf, IF( a.isLeaf = '1', 'true', 'false' ) AS leaf, IF( a.isLeaf = '1', '', 'closed' ) AS state, a.subjectId, a.subjectName, a.subjectName AS label, a.subjectName AS text,a.subjectFullName, a.CREATED_BY AS __uuserId FROM asdb.k_subjectother a WHERE 1 = 1 /*START #param1# and a.parentId = '{param1}' #param1# END*/ /*START #param11# and a.level = '{param11}' #param11# END*/ /*START #param18# AND a.subjectId = '{param18}' #param18# END*/ /*START #param19# AND (a.subjectName like '%{param19}%' or a.subjectFullName like '%{param19}%' or a.subjectId like '%{param19}%') #param19# END*/
#\u5BA1\u6838\u6C47\u603B--\u6807\u9898\u680F
DG00348=SELECT a.autoId, a.projectId, a.customerId, a.reviewtemplateId, a.id, a.title, a.parentId, b.num FROM bdo_dg.dg_review_check a LEFT JOIN ( SELECT a.customerId, a.projectId, a.parentId, COUNT( CASE WHEN a.isAudit = 0 THEN 1 END ) AS num FROM bdo_dg.dg_review_check a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.parentId != 0 GROUP BY a.parentId ) b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.id = b.parentId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.parentId = 0 /*START #param3# AND a.id = {param3} #param3# END*/
#\u5176\u4ED6\u79D1\u76EE\u4E00\u89C8
DG00349=SELECT a.autoId, a.vocationId, a.tbSubjectId, a.tbSubjectCode, a.tbSubjectName, CONCAT( a.tbSubjectId, '-', a.tbSubjectName ) AS tbSubject, a.baseSubjectId, a.baseSubjectName, CONCAT( a.baseSubjectId, '-', a.baseSubjectName ) AS baseSubject,CONCAT( a.userSubjectId, '-', a.userSubjectName ) AS userSubject, a.userSubjectId, a.userSubjectName, a.userDefined, a.plansE, a.plansC, a.plansA, a.plansV, a.plansP, a.plancsE, a.plancsC, a.plancsA, a.plancsV, a.plancsP, b.plansE AS subjectScoreE, b.plansC AS subjectScoreC, b.plansA AS subjectScoreA, b.plansV AS subjectScoreV, b.plansP AS subjectScoreP, a.subjectEditors, a.isNeedToAudit, a.notAuditReasons, IF( a.tbSubjectCode IS NULL OR a.userSubjectId IS NULL OR a.baseSubjectId IS NULL, 0, 1 ) AS isEditable, a.level0, a.isLeaf0 FROM bdo_dg.dg_othersubjectcontract a LEFT JOIN bdo_dg.dg_subjecttree b ON b.customerId = {param1} AND b.projectId = {param2} AND b.tbSubjectCode = a.tbSubjectCode AND b.userSubjectId = a.userSubjectId WHERE a.ACTIVE_FLAG = 1 AND a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} /*START #param10# AND a.subjectEditors = {param10} #param10# END*/ ORDER BY a.tbSubjectId, a.userSubjectId, a.level0
#\u67E5\u770B\u5176\u4ED6\u79D1\u76EE\u662F\u5426\u751F\u6210\u5BA1\u8BA1\u7A0B\u5E8F
DG00350=SELECT IFNULL(COUNT(1), 0) AS programCount FROM bdo_dg.dg_othersubjectcontract b INNER JOIN bdo_dg.dg_subjecttree a ON a.customerId = {param1} AND a.projectId = {param2} AND b.userSubjectId = a.userSubjectId  AND b.tbSubjectCode = a.tbSubjectCode WHERE b.autoId = {param3} AND b.customerId = {param1} AND b.projectId = {param2}
#\u5176\u4ED6\u79D1\u76EE\u8BA1\u5212\u6027\u5E95\u7A3F\u7F16\u5236\u5206\u6570\u67E5\u8BE2
DG00351=SELECT a.autoId, a.customerId, a.projectId, a.tbSubjectId, CONCAT( a.tbSubjectCode, '-', a.tbSubjectName ) AS tbSubject, a.tbSubjectCode, a.tbSubjectName, CONCAT( a.baseSubjectId, '-', a.baseSubjectName ) AS baseSubject, a.baseSubjectId, a.baseSubjectName, a.plansE, a.plansC, a.plansA, a.plansV, a.plansP, a.plancsE, a.plancsC, a.plancsA, a.plancsV, a.plancsP, b.plansE AS subjectScoreE, b.plansC AS subjectScoreC, b.plansA AS subjectScoreA, b.plansV AS subjectScoreV, b.plansP AS subjectScoreP, a.subjectEditors, a.subjectEditors AS __usubjectEditorUser FROM bdo_dg.dg_othersubjectcontract a LEFT JOIN bdo_dg.dg_subjecttree b ON b.customerId = {param1} AND b.projectId = {param2} AND b.tbSubjectCode = a.tbSubjectCode AND b.userSubjectId = a.userSubjectId WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.yyyy = {param3} #param3# END*/ /*START #param4# AND a.tbSubjectName = {param4} #param4# END*/ /*START #param6# AND a.debitTotalOcc != 0 AND a.creditTotalOcc != 0 #param6# END*/ /*START #param7# AND a.debitTotalOcc = 0 AND a.creditTotalOcc = 0 #param7# END*/ /*START #param10# AND a.subjectEditors = {param10} #param10# END*/ ORDER BY a.userSubjectId, a.level0
#\u67E5\u8BE2\u5176\u4ED6\u79D1\u76EETB
DG00352=SELECT * FROM bdo_dg.dg_othersubjectcontract WHERE customerId = {param1} AND projectId = {param2} AND yyyy = {param3} AND autoId IN ({param4})
#\u514B\u9686\u9879\u76EE\u4E2D\u6E90\u9879\u76EE\u5176\u4ED6\u79D1\u76EE\u7F16\u53F7\u5BF9\u5E94\u7684\u672C\u9879\u76EE\u5176\u4ED6\u79D1\u76EE\u7F16\u53F7
DG00353=SELECT a.userSubjectId, b.userSubjectId AS newUserSubjectId FROM ( SELECT customerId, projectId, yyyy, tbSubjectCode, tbSubjectName, baseSubjectId, baseSubjectName, userSubjectId, userSubjectName FROM bdo_dg.dg_othersubjectcontract WHERE customerId = {param1} AND projectId = {param2} AND baseSubjectId IS NOT NULL AND yyyy = ( SELECT year FROM bdo_dg.dg_project WHERE customerId = {param1} AND projectId = {param2} ) ) a LEFT JOIN ( SELECT customerId, projectId, yyyy, tbSubjectCode, tbSubjectName, baseSubjectId, baseSubjectName, userSubjectId, userSubjectName FROM bdo_dg.dg_othersubjectcontract WHERE customerId = {param3} AND projectId = {param4} AND yyyy = {param5} AND baseSubjectId IS NOT NULL ) b ON a.tbSubjectCode = b.tbSubjectCode AND a.userSubjectName = b.userSubjectName WHERE b.userSubjectId IS NOT NULL
#\u67E5\u8BE2\u5176\u4ED6\u79D1\u76EE\u7528\u6765\u81EA\u5B9A\u4E49\u5176\u4ED6\u5BA1\u8BA1\u7A0B\u5E8F
DG00354=SELECT autoId,subjectId,subjectName FROM asdb.k_subjectother
#\u5BF9\u5916\u62A5\u544A\u5BA1\u6279\u5355--\u662F\u5426\u586B\u5199\u3001\u662F\u5426\u5BA1\u6838
DG00355=SELECT a.projectId, a.customerId, a.reviewtemplateId, MAX(a.isFillOut) AS isFillOut, a.fillOutDate, MAX(a.isAudit) AS isAudit, a.auditDate FROM bdo_dg.dg_report_approval a WHERE a.customerId = {param1} AND a.projectId = {param2} GROUP BY a.projectId, a.customerId, a.reviewtemplateId
#\u5BA1\u6838\u6C47\u603B--\u5BF9\u5916\u62A5\u544A\u5BA1\u6279\u5355
DG00356=SELECT a.autoId, a.projectId, a.customerId, a.reviewtemplateId, a.id, a.title, a.parentId, a.auditor, a.auditOpinion, a.approvalItem1, a.approvalItemType1, a.approvalItemOptions1, a.approvalItemValue1, a.approvalItemMust1, a.approvalItem2, a.approvalItemType2, a.approvalItemOptions2, a.approvalItemValue2, a.approvalItemMust2, a.approvalItem3, a.approvalItemType3, a.approvalItemOptions3, a.approvalItemValue3, a.approvalItemMust3, a.approvalItem4, a.approvalItemType4, a.approvalItemOptions4, a.approvalItemValue4, a.approvalItemMust4, a.approvalItem5, a.approvalItemType5, a.approvalItemOptions5, a.approvalItemValue5, a.approvalItemMust5, a.approvalItem6, a.approvalItemType6, a.approvalItemOptions6, a.approvalItemValue6, a.approvalItemMust6, a.approvalItem7, a.approvalItemType7, a.approvalItemOptions7, a.approvalItemValue7, a.approvalItemMust7, a.approvalItem8, a.approvalItemType8, a.approvalItemOptions8, a.approvalItemValue8, a.approvalItemMust8, a.approvalItem9, a.approvalItemType9, a.approvalItemOptions9, a.approvalItemValue9, a.approvalItemMust9, a.approvalItem10, a.approvalItemType10, a.approvalItemOptions10, a.approvalItemValue10, a.approvalItemMust10, a.approvalItem11, a.approvalItemType11, a.approvalItemOptions11, a.approvalItemValue11, a.approvalItemMust11, a.approvalItem12, a.approvalItemType12, a.approvalItemOptions12, a.approvalItemValue12, a.approvalItemMust12, a.approvalItem13, a.approvalItemType13, a.approvalItemOptions13, a.approvalItemValue13, a.approvalItemMust13, a.approvalItem14, a.approvalItemType14, a.approvalItemOptions14, a.approvalItemValue14, a.approvalItemMust14, a.approvalItem15, a.approvalItemType15, a.approvalItemOptions15, a.approvalItemValue15, a.approvalItemMust15, a.approvalItem16, a.approvalItemType16, a.approvalItemOptions16, a.approvalItemValue16, a.approvalItemMust16, a.approvalItem17, a.approvalItemType17, a.approvalItemOptions17, a.approvalItemValue17, a.approvalItemMust17, a.approvalItem18, a.approvalItemType18, a.approvalItemOptions18, a.approvalItemValue18, a.approvalItemMust18, a.approvalItem19, a.approvalItemType19, a.approvalItemOptions19, a.approvalItemValue19, a.approvalItemMust19, a.approvalItem20, a.approvalItemType20, a.approvalItemOptions20, a.approvalItemValue20, a.approvalItemMust20, a.isFillOut, a.fillOutDate, a.isAudit, a.auditDate FROM bdo_dg.dg_report_approval a WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.parentId = {param3} #param3# END*/
#\u5BA1\u6838\u6C47\u603B--\u5BF9\u5916\u62A5\u544A\u5BA1\u6279\u5355--\u7EDF\u8BA1\u5DF2\u5BA1\u6838
DG00357=SELECT COUNT(a.autoId) AS reviewSummary FROM bdo_dg.dg_report_approval a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.parentId != 0 UNION ALL SELECT COUNT(a.autoId) AS reviewSummary FROM bdo_dg.dg_report_approval a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.isAudit = 1 AND a.parentId != 0
#\u5BA1\u6838\u6C47\u603B--\u5BF9\u5916\u62A5\u544A\u5BA1\u6279\u5355--\u8868\u5934
DG00358=SELECT a.customerId, a.projectId, a.reviewtemplateId, a.approvalItem1, a.approvalItemType1, a.approvalItemMust1, a.approvalItem2, a.approvalItemType2, a.approvalItemMust2, a.approvalItem3, a.approvalItemType3, a.approvalItemMust3, a.approvalItem4, a.approvalItemType4, a.approvalItemMust4, a.approvalItem5, a.approvalItemType5, a.approvalItemMust5, a.approvalItem6, a.approvalItemType6, a.approvalItemMust6, a.approvalItem7, a.approvalItemType7, a.approvalItemMust7, a.approvalItem8, a.approvalItemType8, a.approvalItemMust8, a.approvalItem9, a.approvalItemType9, a.approvalItemMust9, a.approvalItem10, a.approvalItemType10, a.approvalItemMust10, a.approvalItem11, a.approvalItemType11, a.approvalItemMust11, a.approvalItem12, a.approvalItemType12, a.approvalItemMust12, a.approvalItem13, a.approvalItemType13, a.approvalItemMust13, a.approvalItem14, a.approvalItemType14, a.approvalItemMust14, a.approvalItem15, a.approvalItemType15, a.approvalItemMust15, a.approvalItem16, a.approvalItemType16, a.approvalItemMust16, a.approvalItem17, a.approvalItemType17, a.approvalItemMust17, a.approvalItem18, a.approvalItemType18, a.approvalItemMust18, a.approvalItem19, a.approvalItemType19, a.approvalItemMust19, a.approvalItem20, a.approvalItemType20, a.approvalItemMust20 FROM bdo_dg.dg_report_approval a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.parentId != 0 AND ( a.approvalItemType1 IS NULL OR a.approvalItemType1 != 3 ) AND ( a.approvalItemType2 IS NULL OR a.approvalItemType2 != 3 ) AND ( a.approvalItemType3 IS NULL OR a.approvalItemType3 != 3 ) AND ( a.approvalItemType4 IS NULL OR a.approvalItemType4 != 3 ) AND ( a.approvalItemType5 IS NULL OR a.approvalItemType5 != 3 ) AND ( a.approvalItemType6 IS NULL OR a.approvalItemType6 != 3 ) AND ( a.approvalItemType7 IS NULL OR a.approvalItemType7 != 3 ) AND ( a.approvalItemType8 IS NULL OR a.approvalItemType8 != 3 ) AND ( a.approvalItemType9 IS NULL OR a.approvalItemType9 != 3 ) AND ( a.approvalItemType10 IS NULL OR a.approvalItemType10 != 3 ) AND ( a.approvalItemType11 IS NULL OR a.approvalItemType11 != 3 ) AND ( a.approvalItemType12 IS NULL OR a.approvalItemType12 != 3 ) AND ( a.approvalItemType13 IS NULL OR a.approvalItemType13 != 3 ) AND ( a.approvalItemType14 IS NULL OR a.approvalItemType14 != 3 ) AND ( a.approvalItemType15 IS NULL OR a.approvalItemType15 != 3 ) AND ( a.approvalItemType16 IS NULL OR a.approvalItemType16 != 3 ) AND ( a.approvalItemType17 IS NULL OR a.approvalItemType17 != 3 ) AND ( a.approvalItemType18 IS NULL OR a.approvalItemType18 != 3 ) AND ( a.approvalItemType19 IS NULL OR a.approvalItemType19 != 3 ) AND ( a.approvalItemType20 IS NULL OR a.approvalItemType20 != 3 ) GROUP BY a.customerId, a.projectId, a.reviewtemplateId
#\u5BA1\u6838\u6C47\u603B--\u6807\u9898\u680F
DG00359=SELECT a.autoId, a.projectId, a.customerId, a.reviewtemplateId, a.id, a.title, a.parentId, b.num FROM bdo_dg.dg_report_approval a LEFT JOIN ( SELECT a.customerId, a.projectId, a.parentId, COUNT( CASE WHEN a.isAudit = 0 THEN 1 END ) AS num FROM bdo_dg.dg_report_approval a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.parentId != 0 GROUP BY a.parentId ) b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.id = b.parentId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.parentId = 0 /*START #param3# AND a.id = {param3} #param3# END*/
#\u5168\u90E8\u8BA1\u5212\u7A0B\u5E8F
#DG00360=SELECT * FROM ( SELECT ap.autoId, ap.customerId, ap.projectId, ap.indexId, ap.dgName AS apName, ap.subjectId, dgtree.nodeName AS apUserSubjectName, IFNULL(tbsc.plansE, 0) AS ipSe, IFNULL(tbsc.plansC, 0) AS ipSc, IFNULL(tbsc.plansA, 0) AS ipSa, IFNULL(tbsc.plansV, 0) AS ipSv, IFNULL(tbsc.plansP, 0) AS ipSp, IFNULL(otbsc.plansE, 0) AS oipSe, IFNULL(otbsc.plansC, 0) AS oipSc, IFNULL(otbsc.plansA, 0) AS oipSa, IFNULL(otbsc.plansV, 0) AS oipSv, IFNULL(otbsc.plansP, 0) AS oipSp, IFNULL(dgtree.plansE, 0) AS ppSe, IFNULL(dgtree.plansC, 0) AS ppSc, IFNULL(dgtree.plansA, 0) AS ppSa, IFNULL(dgtree.plansV, 0) AS ppSv, IFNULL(dgtree.plansP, 0) AS ppSp, IFNULL(dgtree.sE, 0) AS tdSe, IFNULL(dgtree.sC, 0) AS tdSc, IFNULL(dgtree.sA, 0) AS tdSa, IFNULL(dgtree.sV, 0) AS tdSv, IFNULL(dgtree.sP, 0) AS tdSp, CONCAT( IFNULL( dgtree.tbSubjectId, dgtree.tbSubjectCode ), '-', dgtree.tbSubjectName ) AS tbSubjectName, IF(COUNT(subAp.autoId) > 0, 1, 0) AS haveDone FROM bdo_dg.dg_auditprogram ap LEFT JOIN bdo_dg.dg_subjecttree dgtree ON dgtree.customerId = {param1} AND dgtree.projectId = {param2} AND dgtree.autoId = ap.subjecttreeId LEFT JOIN bdo_dg.dg_auditprogram subAp ON subAp.customerId = {param1} AND subAp.projectId = {param2} AND subAp.parentId = ap.autoId AND subAp. LEVEL = 1 LEFT JOIN bdo_dg.dg_tbsubjectcontract tbsc ON tbsc.customerId = {param1} AND tbsc.projectId = {param2} AND tbsc.tbSubjectCode = dgtree.tbSubjectCode AND tbsc.userSubjectId = dgtree.userSubjectId AND tbsc.yyyy = {param3} LEFT JOIN bdo_dg.dg_othersubjectcontract otbsc ON otbsc.customerId = {param1} AND otbsc.projectId = {param2} AND otbsc.tbSubjectCode = dgtree.tbSubjectCode AND otbsc.baseSubjectId = dgtree.userSubjectId AND otbsc.yyyy = {param3} WHERE ap.customerId = {param1} AND ap.projectId = {param2} AND ap. LEVEL = 0 AND ap.ACTIVE_FLAG = '1' GROUP BY ap.autoId ) ap
DG00360=select * from ( SELECT apo.tbSubjectName, apo.apUserSubjectName, apo.subjectId, SUM(apo.ipSe) ipSe, SUM(apo.ipSc) ipSc, SUM(apo.ipSa) ipSa, SUM(apo.ipSv) ipSv, SUM(apo.ipSp) ipSp, SUM(apo.oipSe) oipSe, SUM(apo.oipSc) oipSc, SUM(apo.oipSa) oipSa, SUM(apo.oipSv) oipSv, SUM(apo.oipSp) oipSp, SUM(apo.ppSe) ppSe, SUM(apo.ppSc) ppSc, SUM(apo.ppSa) ppSa, SUM(apo.ppSv) ppSv, SUM(apo.ppSp) ppSp, COUNT(apo.subjectId) num, IF(SUM(apo.haveDone) > 0, 1, 0) AS haveDone FROM ( SELECT ap.autoId, ap.customerId, ap.projectId, ap.indexId, ap.dgName AS apName, ap.subjectId, dgtree.nodeName AS apUserSubjectName, IFNULL(tbsc.plansE, 0) AS ipSe, IFNULL(tbsc.plansC, 0) AS ipSc, IFNULL(tbsc.plansA, 0) AS ipSa, IFNULL(tbsc.plansV, 0) AS ipSv, IFNULL(tbsc.plansP, 0) AS ipSp, IFNULL(otbsc.plansE, 0) AS oipSe, IFNULL(otbsc.plansC, 0) AS oipSc, IFNULL(otbsc.plansA, 0) AS oipSa, IFNULL(otbsc.plansV, 0) AS oipSv, IFNULL(otbsc.plansP, 0) AS oipSp, IFNULL(dgtree.plansE, 0) AS ppSe, IFNULL(dgtree.plansC, 0) AS ppSc, IFNULL(dgtree.plansA, 0) AS ppSa, IFNULL(dgtree.plansV, 0) AS ppSv, IFNULL(dgtree.plansP, 0) AS ppSp, IFNULL(dgtree.sE, 0) AS tdSe, IFNULL(dgtree.sC, 0) AS tdSc, IFNULL(dgtree.sA, 0) AS tdSa, IFNULL(dgtree.sV, 0) AS tdSv, IFNULL(dgtree.sP, 0) AS tdSp, CONCAT( IFNULL( dgtree.tbSubjectId, dgtree.tbSubjectCode ), '-', dgtree.tbSubjectName ) AS tbSubjectName, IF(COUNT(subAp.autoId) > 0, 1, 0) AS haveDone FROM bdo_dg.dg_auditprogram ap LEFT JOIN bdo_dg.dg_subjecttree dgtree ON dgtree.customerId = {param1} AND dgtree.projectId = {param2} AND dgtree.autoId = ap.subjecttreeId LEFT JOIN bdo_dg.dg_auditprogram subAp ON subAp.customerId = {param1} AND subAp.projectId = {param2} AND subAp.parentId = ap.autoId AND subAp. LEVEL = 1 LEFT JOIN bdo_dg.dg_tbsubjectcontract tbsc ON tbsc.customerId = {param1} AND tbsc.projectId = {param2} AND tbsc.tbSubjectCode = dgtree.tbSubjectCode AND tbsc.userSubjectId = dgtree.userSubjectId AND tbsc.yyyy = {param3} LEFT JOIN bdo_dg.dg_othersubjectcontract otbsc ON otbsc.customerId = {param1} AND otbsc.projectId = {param2} AND otbsc.tbSubjectCode = dgtree.tbSubjectCode AND otbsc.userSubjectId = dgtree.userSubjectId AND otbsc.yyyy = {param3} WHERE ap.customerId = {param1} AND ap.projectId = {param2} AND ap.level = 0 AND ap.ACTIVE_FLAG = '1' GROUP BY ap.autoId ) apo GROUP BY apo.subjectId ) a
#\u83B7\u53D6\u8D22\u52A1\u6570\u636E--\u660E\u7EC6\u3001\u5C0F\u8BA1
DG00361=SELECT a.autoId, a.id, a.name, a.subjectId, a.indexId, a.className, a.methodName, a.itemSheet, a.templateRow, a.keyCol1, a.keyCol2, a.keyCol3, a.keyCol4, a.seq, a.methodStyle FROM asdb.k_dgaccountdata a WHERE a.id = ( SELECT b.auditprogramId FROM bdo_dg.dg_auditprogram a LEFT JOIN bdo_dg.dg_auditprogram b ON a.parentId = b.autoId AND a.customerId = b.customerId AND a.projectId = b.projectId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.workpaperId = {param3} ) AND a.methodStyle = 1 AND a.itemSheet = 2 
#\u83B7\u53D6\u5176\u4ED6\u79D1\u76EE\u5BA1\u8BA1\u7A0B\u5E8F\u7528\u6765\u4FEE\u6539\u5E95\u7A3F\u7F16\u5236\u4EBA
DG00362=SELECT * FROM bdo_dg.dg_auditprogram WHERE level = 0  AND customerId = {param1}  AND projectId = {param2} AND ACTIVE_FLAG = 1 AND substring_index(indexId,"_",1) = {param3} 
DG00363=SELECT GROUP_CONCAT(DISTINCT CONCAT('"',userSubjectId,'"')) AS subjectId FROM bdo_dg.dg_tbsubjectcontract WHERE customerId = {param1} AND projectId = {param3} AND baseSubjectId = '{param4}'
#\u9879\u76EE\u514B\u9686--\u79D1\u76EE\u8BA4\u5B9A\u5206\u503C
DG00364=SELECT a.autoId, a.customerId, a.projectId, a.yyyy, a.userSubjectId, b.plancsE, b.plancsC, b.plancsA, b.plancsV, b.plancsP, b.plansE, b.plansC, b.plansA, b.plansV, b.plansP, b.isNeedToAudit, b.notAuditReasons, b.subjectEditors FROM bdo_dg.dg_tbsubjectcontract a INNER JOIN ( SELECT autoId, customerId, projectId FROM bdo_dg.dg_tbsubjectcontract WHERE customerId = {targetCustomerId} AND projectId = {targetProjectId} ) aa ON aa.autoId = a.autoId AND aa.customerId = a.customerId LEFT JOIN bdo_dg.dg_tbsubjectcontract b ON ( a.tbSubjectId = b.tbSubjectId OR a.tbSubjectCode = b.tbSubjectCode ) AND a.baseSubjectId = b.baseSubjectId AND a.userSubjectName = b.userSubjectName WHERE b.customerId = {srcCustomerId} AND b.projectId = {srcProjectId} AND b.yyyy ={yyyy}
#\u88AB\u5173\u8054\u5E95\u7A3F
DG00365=SELECT a.autoId, a.customerId, a.projectId, a.fileIndexId, a.fileName, a.fullPath, a.customizeStyle, a.dgValueInfo FROM bdo_dg.dg_workpaper a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.fileIndexId = 'P004-0001' AND ( a.customizeStyle LIKE '%{param3}%' OR a.dgValueInfo LIKE '%{param3}%' )
#\u88AB\u5173\u8054\u9644\u6CE8
DG00366=SELECT a.autoId, a.customerId, a.projectId, a.noteNo, a.fileName, a.fullPath, a.customizeStyle, a.noteDgValueInfo FROM bdo_dg.dg_noteinfo a WHERE a.customerId = {param1} AND a.projectId = {param2} AND ( a.customizeStyle LIKE '%{param3}%' OR a.noteDgValueInfo LIKE '%{param3}%' )
#\u73B0\u91D1\u6D41\u91CF\u8868\u6821\u9A8C\u6838\u5BF9\u914D\u7F6E
DG00367=SELECT a.autoId, a.type, a.alias, a.noteNo, a.noteName, a.sheetIndex, a.rangeStr, a.fileType, a.fileAlias, a.fileNoteNo, a.fileNoteName, a.fileSheetIndex, a.fileRangeStr, a.pm, a.valType, a.valDesc, a.checkType, a.reportTplId FROM asdb.k_cashflowcheck a WHERE a.reportTplId = {param1} AND ( a.type = '{param2}' OR a.fileType = '{param2}' )
#\u73B0\u91D1\u6D41\u91CF\u8868\u6838\u5BF9\u516C\u5F0F
DG00368=SELECT a.autoId, a.customerId, a.projectId, a.subjectId, a.subjectName, a.formulaType, a.formulaProperty, a.formula, a.formulaText, a.formulaValue, a.formulaCalc, a.formulaAutoId, a.checkType, a.checkRemark, a.LAST_UPDATE_DATE AS updateTime FROM bdo_dg.dg_projectformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.checkType = 1 /*START #param3# AND a.autoId IN (SELECT SUBSTRING_INDEX( SUBSTRING_INDEX( a.infoFormula, ',', b.help_topic_id + 1 ), ',' ,- 1 ) AS ids FROM bdo_dg.dg_referredformula AS a JOIN mysql.help_topic AS b ON b.help_topic_id < ( length(a.infoFormula) - length( REPLACE(a.infoFormula, ',', '') ) + 1 ) WHERE a.infoType = '{param3}' AND a.infoId = {param4} ) #param3# END*/ ORDER BY a.formulaCalc, a.LAST_UPDATE_DATE DESC
#\u73B0\u91D1\u6D41\u91CF\u8868--\u83B7\u53D6\u5BF9\u65B9\u79D1\u76EE
DG00369=SELECT a.autoId, a.customerId, a.yyyy, a.projectId, a.vocationId, a.tbSubjectId, a.tbSubjectCode, a.tbSubjectName, a.baseSubjectId, a.baseSubjectName, a.reportSubjectId, a.reportSubjectName, a.userSubjectId, a.userSubjectName FROM bdo_dg.dg_tbsubjectcontract a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.tbsubjectCode IS NOT NULL /*START #param4# AND a.tbSubjectName NOT IN ({param4}) #param4# END*/
#\u6838\u5BF9\u516C\u5F0F--\u9644\u6CE8\u4E0E\u9644\u6CE8
DG00370=SELECT a.autoId, a.type, a.alias, a.noteNo, a.noteName, a.sheetIndex, a.rangeStr, a.fileType, a.fileAlias, a.fileNoteNo, a.fileNoteName, a.fileSheetIndex, a.fileRangeStr, a.pm, a.valType, a.valDesc, a.checkType, a.reportTplId FROM asdb.k_cashflowcheck a WHERE a.noteNo = '{param1}' AND a.noteName = '{param2}' AND a.reportTplId = {param3} AND a.fileType = 'note'
#\u6838\u5BF9\u516C\u5F0F\u3001\u6821\u9A8C\u516C\u5F0F
DG00371=SELECT a.autoId, a.customerId, a.projectId, a.subjectId, a.subjectName, a.formulaType, a.formulaProperty, a.formula, a.formulaText, a.formulaValue, a.formulaCalc, a.formulaAutoId, a.LAST_UPDATE_DATE AS updateTime FROM bdo_dg.dg_projectformula a WHERE a.autoId IN ({param3}) AND a.customerId = {param1} AND a.projectId = {param2} /*START #param4# AND a.formulaType = '{param4}' #param4# END*/ /*START #param5# AND a.formulaCalc = '{param5}' #param5# END*/ ORDER BY a.formulaCalc, a.LAST_UPDATE_DATE DESC
#\u67E5\u8BE2\u6709\u6743\u9650\u7684\u5E95\u7A3F\u4E0B\u8F7D\u6811
DG00372=select a.autoId as id, a.nodeName AS name, a.nodeName as label, a.autoId as value, IF(a.nodeType = 'TBSUBJECT', '', a.parentId) as parentId, IF(a.nodeType = 'FILE', 'true', 'false') as leaf,a.workpaperId from bdo_dg.dg_subjecttree a inner join (select a.parentId as tbId,a.autoId as subjectId,b.autoId from bdo_dg.dg_subjecttree a inner join (select a.autoId,a.parentId from bdo_dg.dg_subjecttree a inner join bdo_dg.dg_auditprogram b on a.customerId = b.customerId and a.projectId = b.projectId and a.workpaperId = b.workpaperId /*START #param11# and b.workpaperEditor = '{param11}' #param11# END*/ and b.level = 1 where a.customerId = '{param12}' and a.projectId = '{param13}' and a.nodeType = 'FILE') b on a.autoId = b.parentId) b on (a.autoId = b.tbId or a.autoId = b.subjectId or a.autoId = b.autoId) where a.customerId = '{param12}' and a.projectId = '{param13}' /*START #param14# and a.nodeType <> 'FILE' #param14# END*/ order by a.nodeName
#\u73B0\u91D1\u6D41\u91CF\u8868\u6838\u5BF9\u516C\u5F0F(\u5408\u5E76)
DG00373=SELECT a.autoId, a.customerId, a.projectId, a.mergeProjectId, a.subjectId, a.subjectName, a.formulaType, a.formulaProperty, a.formula, a.formulaText, a.formulaValue, a.formulaCalc, a.formulaAutoId, a.checkType, a.checkRemark, a.LAST_UPDATE_DATE AS updateTime FROM bdo_hb.hb_mergeprojectformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.mergeProjectId = {param3} AND a.checkType = 1 ORDER BY a.formulaCalc, a.LAST_UPDATE_DATE DESC
#\u83B7\u53D6\u6821\u9A8C\u6570\u636E\u516C\u5F0F
DG00374=SELECT a.autoId, a.subjectId, a.formulaType, a.formulaProperty, a.formula, a.formulaText, a.formulaValue, a.formulaCalc, a.LAST_UPDATE_DATE AS updateTime, a.subjectName FROM bdo_hb.hb_mergeprojectformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.mergeProjectId = {param3} /*START #param4# AND a.formulaType = '{param4}' #param4# END*/ AND a.ACTIVE_FLAG = '1' AND a.checkType = '0' ORDER BY a.formulaCalc 
#\u516C\u5F0F\u6821\u9A8C--\u6B63\u786E\u6570/\u603B\u6570
DG00375=SELECT COUNT(*) AS totalNum, COUNT(IF(a.formulaCalc = '1', TRUE, NULL)) AS rightNum FROM bdo_hb.hb_mergeprojectformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.mergeProjectId = {param3} AND a.ACTIVE_FLAG = '1' AND a.checkType = '0' /*START #param4# AND a.formulaType = '{param4}' #param4# END*/ 
#\u83B7\u53D6\u6807\u7B7E\u4FE1\u606F
DG00376=SELECT a.autoId, a.customerId, a.projectId, a.tagName, a.tagValue, a.tagPosition, a.tagInfo, a.tagType, a.tagProperty, a.tagDgId, a.infoVersion, a.remark FROM bdo_hb.hb_mergeprojectlstag a WHERE a.autoId = {param1} AND a.customerId = {param2} AND a.projectId = {param3} AND a.mergeProjectId = {param4} 
#\u5408\u5E76\u9644\u6CE8\u8282\u70B9\u4FE1\u606F
DG00377=SELECT a.autoId, a.customerId, a.projectId, a.knoteId, a.noteNo, a.noteName, a.colCode, a.colName, a.fileName, a.fullPath, a.noteDgValueInfo, a.reportTplId, a.isForbid, a.isEdited, a.isFinished, a.customizeStyle FROM bdo_hb.hb_mergenoteinfo a WHERE a.ACTIVE_FLAG = '1' AND a.autoId = {param1} AND a.customerId = {param2} AND a.projectId = {param3} AND a.mergeProjectId = {param4} ORDER BY a.autoId
#\u73B0\u91D1\u6D41\u91CF\u8868\u76F4\u63A5\u6CD5--\u79D1\u76EE\u51ED\u8BC1\u8C03\u6574\u4FE1\u606F\uFF08\u8C03\u51FA\u51ED\u8BC1ID\uFF09
DG00378=SELECT a.autoId, a.customerId, a.projectId, a.year, a.colCode, a.colName, a.property, a.debitAccountCode, a.debitAccountName, a.creditAccountCode, a.creditAccountName, a.remain, a.remainNum, a.remainEntryIds, a.remainSerails, a.flowIn, a.flowInNum, a.flowInEntryIds, a.flowInSerails, a.flowOut, a.flowOutNum, a.flowOutEntryIds, a.flowOutSerails, a.balance, a.balanceNum, a.balanceEntryIds, a.balanceSerails FROM bdo_dg.dg_cashflowstatement a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} AND a.debitAccountCode = {param5} AND a.creditAccountCode = {param6} AND a.autoId <> {param7} AND ( a.flowOutEntryIds = '{param4}' OR a.flowOutEntryIds LIKE CONCAT('{param4}', ',%') OR a.flowOutEntryIds LIKE CONCAT('%,', '{param4}') OR a.flowOutEntryIds LIKE CONCAT('%,', '{param4}', ',%'))
#\u73B0\u91D1\u6D41\u91CF\u8868\u76F4\u63A5\u6CD5--\u79D1\u76EE\u51ED\u8BC1\u8C03\u6574\u4FE1\u606F\uFF08\u8C03\u5165\u51ED\u8BC1ID\uFF09
DG00379=SELECT a.autoId, a.customerId, a.projectId, a.year, a.colCode, a.colName, a.property, a.debitAccountCode, a.debitAccountName, a.creditAccountCode, a.creditAccountName, a.remain, a.remainNum, a.remainEntryIds, a.remainSerails, a.flowIn, a.flowInNum, a.flowInEntryIds, a.flowInSerails, a.flowOut, a.flowOutNum, a.flowOutEntryIds, a.flowOutSerails, a.balance, a.balanceNum, a.balanceEntryIds, a.balanceSerails FROM bdo_dg.dg_cashflowstatement a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} AND a.debitAccountCode = {param5} AND a.creditAccountCode = {param6} AND a.autoId <> {param7} AND ( a.flowInEntryIds = '{param4}' OR a.flowInEntryIds LIKE CONCAT('{param4}', ',%') OR a.flowInEntryIds LIKE CONCAT('%,', '{param4}') OR a.flowInEntryIds LIKE CONCAT('%,', '{param4}', ',%'))
#\u73B0\u91D1\u6D41\u91CF\u8868\u76F4\u63A5\u6CD5--\u73B0\u91D1\u7B49\u4EF7\u7269\u79D1\u76EE\u4E2D\u7684\u79D1\u76EE
DG00380=SELECT a.autoId, a.customerId, a.projectId, a.year, a.subjectId, a.subjectName, a.assItemId, a.assItemName, a.remain, a.debitOcc, a.creditOcc, a.balance, a.date, a.startDate, a.endDate, a.sign FROM bdo_dg.dg_casheuivalentsaccount a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} AND a.sign = {param4} GROUP BY a.customerId, a.projectId, a.year, a.subjectId 
#\u73B0\u91D1\u6D41\u91CF\u8868\u76F4\u63A5\u6CD5--\u672A\u5BF9\u7167\u79D1\u76EE
DG00383=SELECT a.autoId, a.customerId, a.projectId, a.year, a.colCode, a.colName, a.property, a.debitAccountCode, a.debitAccountName, a.creditAccountCode, a.creditAccountName, a.positiveAmount, a.positiveEntryIds, a.positiveSerails, a.negativeAmount, a.negativeEntryIds, a.negativeSerails, a.amount, a.entryIds, a.serails, a.isEliminate, a.isFlowInOrOut FROM bdo_dg.dg_cashflow_subject_contrast a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} AND (a.colCode IS NULL OR a.colCode = '') ORDER BY a.debitAccountCode, a.creditAccountCode
#\u73B0\u91D1\u6D41\u91CF\u8868\u76F4\u63A5\u6CD5--\u5BF9\u7167\u79D1\u76EE
DG00384=SELECT a.* FROM ( SELECT a.autoId, a.customerId, a.projectId, a.year, a.colCode, a.colName, a.property, a.debitAccountCode, a.debitAccountName, a.creditAccountCode, a.creditAccountName, a.positiveAmount, a.positiveEntryIds, a.positiveSerails, a.negativeAmount, a.negativeEntryIds, a.negativeSerails, a.amount, a.entryIds, a.serails, a.isEliminate, a.isFlowInOrOut, a.LAST_UPDATE_DATE AS time, a.ACTIVE_FLAG AS flag, IFNULL(b.num, 0) AS rowSpan FROM bdo_dg.dg_cashflow_subject_contrast a LEFT JOIN ( SELECT a.autoId, a.num FROM ( SELECT a.*, b.num FROM ( SELECT a.* FROM bdo_dg.dg_cashflow_subject_contrast a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} AND a.colCode IS NOT NULL ) a LEFT JOIN ( SELECT a.customerId, a.projectId, a.year, a.colCode, count(1) AS num FROM bdo_dg.dg_cashflow_subject_contrast a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} GROUP BY a.customerId, a.projectId, a.year, a.colCode ) b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.year = b.year AND a.colCode = b.colCode ) a GROUP BY a.customerId, a.projectId, a.year, a.colCode ORDER BY a.autoId ) b ON a.autoId = b.autoId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} AND a.colCode IS NOT NULL AND a.colCode <> '' ) a LEFT JOIN ( SELECT a.* FROM asdb.k_reporttemplate a WHERE a.subjectType = 'F' AND a.vocationId = ( SELECT a.tbReportTemplate FROM bdo_dg.dg_project a WHERE a.customerId = {param1} AND a.projectId = {param2} )) b ON a.colCode = b.colCode ORDER BY b.sortNo, a.autoId, a.debitAccountCode, a.creditAccountCode
#\u5E95\u7A3F\u4E2D\u5FC3--\u8282\u70B9\u6811
DG00386=SELECT a.*, b.num FROM ( SELECT a.autoId, a.customerId, a.parentId, a.projectId, a.subjectId, a.workpaperId, a.indexId, a.fileIndexId, a.nodeName, a.nodeType, a.userSubjectId, a.userSubjectName, a.tbSubjectCode, a.tbSubjectId, a.tbSubjectName, a.sE, a.sC, a.sA, a.sV, a.sP, a.csE, a.csC, a.csA, a.csV, a.csP, a.plansE, a.plansC, a.plansA, a.plansV, a.plansP, a.plancsE, a.plancsC, a.plancsA, a.plancsV, a.plancsP, CASE WHEN a.nodeType = 'FILE' THEN b.workpaperEditor ELSE '' END AS workpaperEditor FROM bdo_dg.dg_subjecttree a LEFT JOIN bdo_dg.dg_auditprogram b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.workpaperId = b.workpaperId AND b.workpaperEditor = {param3} WHERE a.customerId = {param1} AND a.projectId = {param2} AND ( CASE WHEN a.nodeType = 'FILE' THEN b.workpaperEditor ELSE '' END IS NOT NULL )) a LEFT JOIN ( SELECT COUNT(1) AS num, a.customerId, a.projectId, a.parentId FROM ( SELECT a.* FROM ( SELECT a.*, CASE WHEN a.nodeType = 'FILE' THEN b.workpaperEditor ELSE '' END AS workpaperEditor FROM bdo_dg.dg_subjecttree a LEFT JOIN bdo_dg.dg_auditprogram b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.workpaperId = b.workpaperId AND b.workpaperEditor = {param3} WHERE a.customerId = {param1} AND a.projectId = {param2} ) a WHERE a.workpaperEditor IS NOT NULL ) a WHERE a.customerId = {param1} AND a.projectId = {param2} GROUP BY a.parentId ) b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.autoId = b.parentId WHERE ( CASE WHEN a.nodeType = 'SUBJECT' THEN b.num ELSE '' END IS NOT NULL )
#\u67E5\u8BE2\u6307\u5B9A\u5E74\u4EFD\u79D1\u76EE\u5BF9\u7167\u6570\u636E\uFF08\u5E26\u62A5\u8868\u8BA1\u7B97\u516C\u5F0F\uFF09
DG00387=select tb.tbSubjectName,tb.tbSubjectId,tsc.customerId,yyyy,tsc.projectId,tsc.reportSubjectId,tsc.reportSubjectName,adjustValue,cusAdjustValue,tb.cusCalFun from bdo_dg.dg_tbsubjectcontract tsc left join bdo_dg.dg_projecttb tb on tsc.customerId = tb.customerId and  tsc.projectId = tb.projectId and tsc.reportSubjectId = tb.reportSubjectId and tsc.tbSubjectCode = tb.tbSubjectId where tsc.customerId = {customerId} and tsc.projectId = {projectId} and yyyy = {year} and tsc.reportSubjectId is not null;
#\u73B0\u91D1\u6D41\u91CF\u8868\u76F4\u63A5\u6CD5--\u51ED\u8BC1\u8C03\u6574\u8868
DG00389=SELECT a.*, b.calFun FROM ( SELECT a.customerId, projectId, a.year, a.colCode, a.colName, SUM(a.balance) AS amount FROM bdo_dg.dg_cashflowstatement a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} AND a.colCode IS NOT NULL AND a.colCode <> '' GROUP BY a.customerId, a.projectId, a.year, a.colCode ORDER BY a.autoId ) a LEFT JOIN ( SELECT a.* FROM asdb.k_reporttemplate a WHERE a.subjectType = 'F' AND a.vocationId = {param4} ) b ON a.colCode = b.colCode
#\u6279\u91CF\u5237\u65B0\u5E95\u7A3F\u5C01\u9762--\u83B7\u53D6\u6240\u6709\u5E95\u7A3F
DG00390=SELECT a.autoId, a.customerId, d.customerName, a.projectId, d.projectName, a.indexId, a.subjectName, a.programNameAft, a.auditConclusion, a.csE, a.csC, a.csA, a.csV, a.csP, a.dgName, a.workpaperEditor, a.workpaperId, c.fileName, c.fullPath, d.auditTimeBegin, d.auditTimeEnd FROM bdo_dg.dg_auditprogram a LEFT JOIN bdo_dg.dg_subjecttree b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.subjecttreeId = b.autoId LEFT JOIN bdo_dg.dg_workpaper c ON a.customerId = c.customerId AND a.projectId = c.projectId AND a.workpaperId = c.autoId LEFT JOIN bdo_dg.dg_project d ON a.customerId = d.customerId AND a.projectId = d.projectId WHERE a.customerId = '{param1}' AND a.projectId = '{param2}' AND a. LEVEL = '1' AND a.workpaperId IS NOT NULL AND a.workpaperId <> '' /*START #param3# AND b.parentId = '{param3}' #param3# END*/ /*START #param4# AND b.autoId = '{param4}' #param4# END*/ /*START #param5# AND a.workpaperId = '{param5}' #param5# END*/
#\u9644\u6CE8\u5B8C\u6210\u72B6\u6001
DG00391=SELECT a.* FROM ( SELECT a.autoId, a.customerId, a.projectId, a.knoteId, a.noteNo, a.noteName, a.colCode, a.colName, a.fileName, a.fullPath, a.reportTplId, a.isFinished AS haveDone, DATE_FORMAT(a.LAST_UPDATE_DATE, '%Y-%m-%d %T') AS updateTime, a.LAST_UPDATED_BY AS __urevisor FROM bdo_dg.dg_noteinfo a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.ACTIVE_FLAG = '1' AND a.isForbid = '0' ORDER BY a.sortNo ASC ) a
#\u9879\u76EE\u7EF4\u62A4
DG00392=SELECT a.autoId, a.information, a.detail, a.detailType, a.className, a.funcName, a.funcType, a.param1, a.param1Type, a.param2, a.param2Type, a.param3, a.param3Type, a.param4, a.param4Type FROM asdb.k_projectmanualexe a 
#\u9879\u76EE\u6587\u4EF6
DG00393=select distinct a.fullPath, a.autoId, a.tableName from ( select a.autoId, a.fullPath, 'dg_attach' AS tableName from bdo_dg.dg_attach a where a.fullpath > '' and a.customerId = {param1} and a.projectId = {param2} union all select a.autoId, a.fullPath, 'dg_auditprogramtpl' AS tableName from bdo_dg.dg_auditprogramtpl a where a.fullpath > '' AND a.customerId = {param1} AND a.projectId = {param2} union all select a.autoId, a.fullPath, 'dg_bankfile' AS tableName from 	bdo_dg.dg_bankfile a where a.fullpath > '' AND a.customerId = {param1} AND a.projectId = {param2} union all select a.autoId, a.fullPath, 'dg_file' AS tableName from	bdo_dg.dg_file	a where a.fullpath > '' AND a.customerId = {param1} AND a.projectId = {param2} union all select a.autoId, a.fullPath, 'dg_filestatistics' AS tableName from	bdo_dg.dg_filestatistics a where a.fullpath > '' AND a.customerId = {param1} AND a.projectId = {param2} union all select a.autoId, a.fullPath, 'dg_noteinfo' AS tableName from	bdo_dg.dg_noteinfo a where a.fullpath > '' AND a.customerId = {param1} AND a.projectId = {param2} union all select a.autoId, a.fullPath, 'dg_report' AS tableName from	bdo_dg.dg_report a where a.fullpath > '' AND a.customerId = {param1} AND a.projectId = {param2} union all select a.autoId, a.templateFullPath as fullPath, 'dg_reporttemplate' AS tableName from bdo_dg.dg_reporttemplate a where a.templateFullPath > '' AND a.customerId = {param1} AND a.projectId = {param2} union all select a.autoId, a.fullPath, 'dg_samplingfile' AS tableName from	bdo_dg.dg_samplingfile a where a.fullpath > '' AND a.customerId = {param1} AND a.projectId = {param2} union all select a.autoId, a.fullPath, 'dg_workpaper' AS tableName from	bdo_dg.dg_workpaper a where a.fullpath > '' AND a.customerId = {param1} AND a.projectId = {param2} union all select a.autoId, a.fullPath, 'dg_workpapertemp' AS tableName from	bdo_dg.dg_workpapertemp a where a.fullpath > '' AND a.customerId = {param1} AND a.projectId = {param2} union all select a.autoId, a.fullPath, 'hb_file' AS tableName from	bdo_hb.hb_file a where a.fullpath > '' AND a.customerId = {param1} AND a.projectId = {param2} UNION ALL SELECT a.autoId, a.fullPath, 'hb_mergenoteinfo' AS tableName FROM	bdo_hb.hb_mergenoteinfo a WHERE a.fullpath > '' AND a.customerId = {param1} AND a.projectId = {param2} ) a 
#\u73B0\u91D1\u6D41\u91CF\u8868--\u516C\u5F0F\u6CD5
DG00394=SELECT a.autoId, a.customerId, a.projectId, a.yyyy, a.colCode, a.colDisp, a.colType, CASE WHEN a.column1 = '' THEN 0 ELSE a.column1 END AS curAmount, CASE WHEN a.column2 = '' THEN 0 ELSE a.column2 END AS preAmount, b.calFun, a.rowNum, a.colNum, a.tableType, a.generateMethod FROM bdo_dg.dg_auditreport_info a LEFT JOIN asdb.k_reporttemplate b ON b.vocationId = {param4} AND b.colCode = a.colCode WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.colType = 'F'
#\u73B0\u91D1\u6D41\u91CF\u8868--\u76F4\u63A5\u6CD5
DG00395=SELECT a.autoId, a.customerId, a.projectId, a.year AS yyyy, a.colCode, a.colDisp, CASE WHEN a.curAmount = '' THEN 0 ELSE a.curAmount END AS curAmount, CASE WHEN a.preAmount = '' THEN 0 ELSE a.preAmount END AS preAmount, b.calFun, c.colType, c.rowNum, c.colNum, c.tableType, c.generateMethod FROM bdo_dg.dg_cashflow a LEFT JOIN asdb.k_reporttemplate b ON b.vocationId = {param4} AND b.colCode = a.colCode LEFT JOIN bdo_dg.dg_auditreport_info c ON a.customerId = c.customerId AND a.projectId = c.projectId AND a.year = c.yyyy AND a.colCode = c.colCode AND c.colType = 'F' WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.year = {param3} #param3# END*/
#\u73B0\u91D1\u6D41\u91CF\u8868--\u516C\u5F0F\u6CD5\u3001\u76F4\u63A5\u6CD5
DG00396=SELECT a.autoId, a.customerId, a.projectId, a.yyyy, a.colCode, a.colDisp, IFNULL(a.column1, '') AS amount1, IF( a.column1 IS NULL, '', b.curAmount ) AS amount2, IF( a.column1 IS NULL, '', a.column1 - b.curAmount ) AS diff FROM bdo_dg.dg_auditreport_info a LEFT JOIN bdo_dg.dg_cashflow b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.yyyy = b.year AND a.colCode = b.colCode WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.colType = 'F' 
#\u641C\u7D22\u9879\u76EE\u6587\u6863
DG00397=SELECT * FROM (select '0' as autoId,a.customerId,a.projectId,'' as fileName,CONCAT('\u6587\u6863','(',count(1),')') as fullPath,'1' as fileType,'' as workpaperName from bdo_dg.dg_file a where a.customerId={param1} and a.projectId={param2} and a.fileName like '%{param3}%' and a.fullPath is not null and a.fullPath <> '' union all (select a.autoId,a.customerId,a.projectId,a.fileName,a.fullPath,'1' as fileType,'' as workpaperName from bdo_dg.dg_file a where a.customerId={param1} and a.projectId={param2} and a.fileName like '%{param3}%' and a.fullPath is not null and a.fullPath <> '' limit 10) union all select '0' as autoId,a.customerId,a.projectId,'' as fileName,CONCAT('\u5E95\u7A3F','(',count(1),')') as fullPath,'2' as fileType,'' as workpaperName from bdo_dg.dg_workpaper a where a.customerId={param1} and a.projectId={param2} and a.fileName like '%{param3}%' and a.fullPath is not null and a.fullPath <> '' union all (select a.autoId,a.customerId,a.projectId,a.fileName,a.fullPath,'2' as fileType,'' as workpaperName from bdo_dg.dg_workpaper a where a.customerId={param1} and a.projectId={param2} and a.fileName like '%{param3}%' and a.fullPath is not null and a.fullPath <> '' limit 10) union all select '0' as autoId,a.customerId,a.projectId,'' as fileName,CONCAT('\u5E95\u7A3F\u9644\u4EF6','(',count(1),')') as fullPath,'3' as fileType,'' as workpaperName from bdo_dg.dg_attach a where a.customerId={param1} and a.projectId={param2} and a.fileName like '%{param3}%' and a.fullPath is not null and a.fullPath <> '' union all (select a.autoId,a.customerId,a.projectId,a.fileName,a.fullPath,'3' as fileType,b.fileName as workpaperName from bdo_dg.dg_attach a left join bdo_dg.dg_workpaper b on a.workpaperId = b.autoId where a.customerId={param1} and a.projectId={param2} and a.fileName like '%{param3}%' and a.fullPath is not null and a.fullPath <> '' limit 10) union all select '0' as autoId,a.customerId,a.projectId,'' as fileName,CONCAT('\u9644\u6CE8','(',count(1),')') as fullPath,'4' as fileType,'' as workpaperName from bdo_dg.dg_noteinfo a where a.customerId={param1} and a.projectId={param2} and a.fileName like '%{param3}%' and a.fullPath is not null and a.fullPath <> '' union all (select a.autoId,a.customerId,a.projectId,a.fileName,a.fullPath,'4' as fileType,'' as workpaperName from bdo_dg.dg_noteinfo a where a.customerId={param1} and a.projectId={param2} and a.fileName like '%{param3}%' and a.fullPath is not null and a.fullPath <> '' limit 10) union all select '0' as autoId,a.customerId,a.projectId,'' as fileName,CONCAT('\u62BD\u51ED\u9644\u4EF6','(',count(1),')') as fullPath,'5' as fileType,'' as workpaperName from bdo_dg.dg_samplingfile a where a.customerId={param1} and a.projectId={param2} and a.fileName like '%{param3}%' and a.fullPath is not null and a.fullPath <> '' union all (select a.autoId,a.customerId,a.projectId,a.fileName,a.fullPath,'5' as fileType,'' as workpaperName from bdo_dg.dg_samplingfile a where a.customerId={param1} and a.projectId={param2} and a.fileName like '%{param3}%' and a.fullPath is not null and a.fullPath <> '' limit 10)) a order by a.fileType,a.autoId,a.fullPath
#\u73B0\u91D1\u6D41\u91CF\u8868\u76F4\u63A5\u6CD5--\u73B0\u91D1\u7B49\u4EF7\u7269\u5185\u90E8\u6570\u636E
DG00398=SELECT a.autoId, a.customerId, a.projectId, a.year, a.debitAccountCode, a.debitAccountName, a.creditAccountCode, a.creditAccountName, a.debitOcc, a.debitEntryIds, a.debitSerails, a.debitEntryNum, a.creditOcc, a.creditEntryIds, a.creditSerails, a.creditEntryNum FROM bdo_dg.dg_cashflow_subject_inner a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3}
#\u67E5\u8BE2\u8D44\u4EA7\u8D1F\u503A\u7C7B\u7684\u5BA2\u6237\u79D1\u76EE
DG00399=select group_concat(tsc.userSubjectId) as subjectId from bdo_dg.dg_tbsubjectcontract tsc left join bdo_dg.dg_projecttb pt on tsc.customerId = pt.customerId and tsc.projectId = pt.projectId and tsc.tbSubjectCode = pt.tbSubjectId and tsc.reportSubjectId = pt.reportSubjectId where tsc.customerId = {customerId} and tsc.projectId = {projectId} and yyyy = {year} and tsc.reportSubjectId is not null and subjectType1 in ('A', 'B')
#\u73B0\u91D1\u6D41\u91CF\u8868--\u73B0\u91D1\u6D41\u91CF\u8868\u9644\u6CE8--\u73B0\u91D1\u6D41\u91CF\u8868\u8865\u5145\u8D44\u6599\u3001\u73B0\u91D1\u6D41\u91CF\u8868\u9879\u76EE
DG00400=SELECT a.autoId, a.customerId, a.projectId, a.year, a.knoteId, a.noteNo, a.noteName, a.rowIndex, a.column1, a.columnDesc1, a.colIndex1, a.column2, a.columnDesc2, a.colIndex2, a.column3, a.columnDesc3, a.colIndex3, a.column4, a.columnDesc4, a.colIndex4, a.column5, a.columnDesc5, a.colIndex5, a.isDescRow, a.isTitleRow, a.isFormulaRow, a.colNum, a.noteType FROM bdo_dg.dg_cashflow_note a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} /*START #param4# AND a.noteType = '{param4}' #param4# END*/ /*START #param5# AND a.noteNo = '{param5}' #param5# END*/
#\u73B0\u91D1\u6D41\u91CF\u8868--\u73B0\u91D1\u6D41\u91CF\u8868\u51ED\u8BC1\u672A\u5206\u6790\u8868
DG00401=SELECT a.autoId, a.customerId, a.projectId, a.year, a.debitsubjects, a.debitSubjectName, a.debitOcc, a.creditsubjects, a.creditSubjectName, a.creditOcc, a.voucherId, a.vchDate, a.oldVoucherId, a.typeId, a.serail, a.isEliminate FROM bdo_dg.dg_cashflow_subject_analyse a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3}
#\u73B0\u91D1\u6D41\u91CF\u8868--\u5BA2\u6237\u8C03\u6574\u3001\u5BA1\u8BA1\u8C03\u6574\u51ED\u8BC1
DG00402=SELECT a.subjectId, a.subjectName, b.subjectId AS oppoSubjectId, b.subjectName AS oppoSubjectName, a.indexId AS oldVoucherId, a.indexId AS voucherId, a.vchDate, '\u8C03\u6574' AS typeId, a.serail, a.summary, a.direction, CASE WHEN c.num = 1 AND d.num = 1 THEN a.occurValue WHEN c.num = 1 AND d.num > 1 THEN b.occurValue WHEN c.num > 1 AND d.num = 1 THEN a.occurValue END AS occurValue, a.isEliminate FROM ( SELECT a.customerId, a.projectId, a.yyyy, a.indexId, a.vchDate, a.serail, a.summary, a.occurValue, a.subjectId, a.subjectFullName1 AS subjectName, a.dirction AS direction, a.isEliminate FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.dirction = 1 AND a.indexId = '{param4}' ) a LEFT JOIN ( SELECT a.customerId, a.projectId, a.yyyy, a.indexId, a.vchDate, a.serail, a.summary, a.occurValue, a.subjectId, a.subjectFullName1 AS subjectName, a.dirction AS direction, a.isEliminate FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.dirction = - 1 AND a.indexId = '{param4}' ) b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.yyyy = b.yyyy LEFT JOIN ( SELECT a.customerId, a.projectId, a.yyyy, COUNT(a.dirction) AS num FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.dirction = 1 AND a.indexId = '{param4}' ) c ON a.customerId = c.customerId AND a.projectId = c.projectId AND a.yyyy = c.yyyy LEFT JOIN ( SELECT a.customerId, a.projectId, a.yyyy, COUNT(a.dirction) AS num FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.dirction = - 1 AND a.indexId = '{param4}' ) d ON a.customerId = d.customerId AND a.projectId = d.projectId AND a.yyyy = d.yyyy
#\u73B0\u91D1\u6D41\u91CF\u8868--\u663E\u793A\u5BA2\u6237\u8C03\u6574\u3001\u5BA1\u8BA1\u8C03\u6574\u51ED\u8BC1
DG00403=SELECT a.* FROM ( SELECT a.subjectId, a.subjectName, b.subjectId AS oppoSubjectId, b.subjectName AS oppoSubjectName, a.indexId AS oldVoucherId, a.indexId AS voucherId, a.vchDate, '\u8C03\u6574' AS typeId, a.serail, CASE WHEN a.summary = b.summary THEN a.summary ELSE CONCAT_WS(',', a.summary, b.summary) END AS summary, a.direction, CASE WHEN c.num = 1 AND d.num = 1 THEN a.occurValue WHEN c.num = 1 AND d.num > 1 THEN b.occurValue WHEN c.num > 1 AND d.num = 1 THEN a.occurValue END AS occurValue, a.analyseSubjectId, a.analyseSubjectName, a.analyseOccurValue FROM ( SELECT a.customerId, a.projectId, a.yyyy, a.indexId, a.vchDate, a.serail, a.summary, a.occurValue, a.subjectId, a.subjectFullName1 AS subjectName, a.dirction AS direction, a.analyseSubjectId, a.analyseSubjectName, a.analyseOccurValue FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.dirction = 1 AND a.indexId = '{param4}' ) a LEFT JOIN ( SELECT a.customerId, a.projectId, a.yyyy, a.indexId, a.vchDate, a.serail, a.summary, a.occurValue, a.subjectId, a.subjectFullName1 AS subjectName, a.dirction AS direction FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.dirction = -1 AND a.indexId = '{param4}' ) b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.yyyy = b.yyyy LEFT JOIN ( SELECT a.customerId, a.projectId, a.yyyy, COUNT(a.dirction) AS num FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.dirction = 1 AND a.indexId = '{param4}' ) c ON a.customerId = c.customerId AND a.projectId = c.projectId AND a.yyyy = c.yyyy LEFT JOIN ( SELECT a.customerId, a.projectId, a.yyyy, COUNT(a.dirction) AS num FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.dirction = -1 AND a.indexId = '{param4}' ) d ON a.customerId = d.customerId AND a.projectId = d.projectId AND a.yyyy = d.yyyy ) a WHERE a.subjectId LIKE CONCAT('{param5}', '%') AND a.oppoSubjectId LIKE CONCAT('{param6}', '%')
#\u73B0\u91D1\u6D41\u91CF\u8868--\u5BA2\u6237\u8C03\u6574\u3001\u5BA1\u8BA1\u8C03\u6574 \u591A\u501F\u591A\u8D37\u51ED\u8BC1
DG00404=SELECT a.subjectId, a.subjectName, b.subjectId AS oppoSubjectId, b.subjectName AS oppoSubjectName, a.indexId AS oldVoucherId, a.indexId AS voucherId, a.vchDate, '\u8C03\u6574' AS typeId, a.serail, CASE WHEN a.summary = b.summary THEN a.summary ELSE CONCAT_WS(',', a.summary, b.summary) END AS summary, a.direction, a.occurValue FROM ( SELECT a.customerId, a.projectId, a.yyyy, a.indexId, a.vchDate, a.serail, GROUP_CONCAT(DISTINCT a.summary) AS summary, SUM(a.occurValue) AS occurValue, GROUP_CONCAT(DISTINCT a.subjectId) AS subjectId, GROUP_CONCAT(DISTINCT a.subjectFullName1) AS subjectName, a.dirction AS direction FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.dirction = 1 AND a.indexId = '{param4}' GROUP BY a.indexId ) a LEFT JOIN ( SELECT a.customerId, a.projectId, a.yyyy, a.indexId, a.vchDate, a.serail, GROUP_CONCAT(DISTINCT a.summary) AS summary, SUM(a.occurValue) AS occurValue, GROUP_CONCAT(DISTINCT a.subjectId) AS subjectId, GROUP_CONCAT(DISTINCT a.subjectFullName1) AS subjectName, a.dirction AS direction FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.dirction = -1 AND a.indexId = '{param4}' GROUP BY a.indexId ) b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.yyyy = b.yyyy AND a.indexId = b.indexId
# \u67E5\u8BE2\u5BA2\u5546\u5217\u8868 \u672C\u5E74
DG00405=select  oneSubjectName,oneSubjectId,direction,autoId,merchantFullId, case when merchantType = '1' then '' else merchantId end as 'assItemId', case when merchantType = '1' then '' else merchantName end as 'assItemName', balance,subjectId,subjectFullName as subjectName ,concat(subjectId,merchantName) as 'mergeId' from bdo_dg.dg_merchantlist where customerId = {customerId} and projectId = {projectId} and yyyy = {yyyy} /*START #rearrangeType# and balance < 0 #rearrangeType# END*/ and balance != 0 and merchantType = {merchantType} and isMerge =  {isMerge}  /*START #assItemId# and merchantId in ({assItemId})  #assItemId# END*/ /*START #subjectId# and oneSubjectId = {subjectId}   #subjectId# END*/ order by  subjectId
# \u67E5\u8BE2\u5BA2\u5546\u5217\u8868 \u4E0A\u5E74
DG00406=select  oneSubjectName,oneSubjectId,direction, autoId,merchantFullId, merchantId as 'assItemId', merchantName as 'assItemName', preBalance as 'balance',subjectId,subjectFullName as subjectName,concat(subjectId,merchantName) as 'mergeId' from bdo_dg.dg_merchantlist where customerId = {customerId} and projectId = {projectId} /*START #rearrangeType# and preBalance < 0 #rearrangeType# END*/ and preBalance != 0 and merchantType = {merchantType} and isMerge =  {isMerge}   /*START #assItemId# and merchantId in ({assItemId})  #assItemId# END*/ /*START #subjectId#  and oneSubjectId = {subjectId} #subjectId# END*/ order by  subjectId
# \u67E5\u8BE2\u672C\u5E74\u5BA2\u5546\u660E\u7EC6
DG00407=select   oneSubjectId,direction,autoId,merchantFullId, merchantId as 'assItemId', merchantName as 'assItemName', balance, subjectId, subjectName,concat(oneSubjectId,merchantName) as 'mergeId' from bdo_dg.dg_merchantlist where customerId = {customerId} and projectId = {projectId} and merchantId in ({merchantIds}) and balance != 0 and balance < 0 and isMerge = 0
# \u67E5\u8BE2\u4E0A\u5E74\u5BA2\u5546\u660E\u7EC6
DG00408=select   oneSubjectId,direction,autoId,merchantFullId, merchantId as 'assItemId', merchantName as 'assItemName', preBalance as 'balance', subjectId,subjectFullName as subjectName,concat(oneSubjectId,merchantName) as 'mergeId' from bdo_dg.dg_merchantlist where customerId = {customerId} and projectId = {projectId} and merchantId in ({merchantIds}) and preBalance != 0 and preBalance < 0 and isMerge = 0
#\u8D26\u9F84\u5206\u6790--\u67E5\u8BE2\u8C03\u6574\u6570\u636E
DG00409=SELECT a.customerId,a.projectId,{endYear} as subYearMonth,a.assItemId,a.assItemName,a.subjectId as accId,a.subjectname1 as accName,{subMonth} as subMonth,0 as remain,sum(case when a.yyyy = {startYear} and a.dirction = 1 then a.occurValue else 0 end) as preDebitAmount,sum(case when a.yyyy = {startYear} and a.dirction = -1 then a.occurValue else 0 end) as preCreditAmount,sum(case when a.yyyy = {endYear} and a.dirction = 1 then a.occurValue else 0 end) as debitAmount,sum(case when a.yyyy = {endYear} and a.dirction = -1 then a.occurValue else 0 end) as creditAmount,0 as balance FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {customerId} AND a.projectId = {projectId} AND a. STATUS = '1' and a.yyyy >= {startYear} and a.yyyy <= {endYear} AND a.subjectId in({accId}) group by a.subjectId,a.assItemId 
#\u73B0\u91D1\u6D41\u91CF\u8868--\u51ED\u8BC1\u8C03\u6574
DG00410=SELECT a.autoId, a.customerId, a.projectId, a.year, a.colCode, a.colName, a.property, a.debitAccountCode, a.debitAccountName, a.creditAccountCode, a.creditAccountName, a.remain, a.remainNum, a.remainEntryIds, a.remainSerails, a.flowIn, a.flowInNum, a.flowInEntryIds, a.flowInSerails, a.flowOut, a.flowOutNum, a.flowOutEntryIds, a.flowOutSerails, a.balance, a.balanceNum, a.balanceEntryIds, a.balanceSerails FROM bdo_dg.dg_cashflowstatement a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} AND a.debitAccountCode = {param4} AND a.creditAccountCode = {param5} AND a.remainEntryIds IS NOT NULL AND a.remainEntryIds <> ''
#\u67E5\u8BE2\u5F80\u6765\u79D1\u76EE\u7684\u501F\u8D37\u65B9\u5411\u4E0E\u5BF9\u7167\u5173\u7CFB
DG00411=select direction, tbSubjectName,tbSubjectCode,userSubjectId,userSubjectName from bdo_dg.dg_tbsubjectcontract where customerId = {customerId} and projectId = {projectId} and yyyy = {year} and userSubjectId in ({subjectId})
#\u73B0\u91D1\u6D41\u91CF\u8868--\u73B0\u91D1\u7B49\u4EF7\u7269
DG00412=SELECT a.autoId, a.customerId, a.projectId, a.year, a.subjectId, a.subjectName, a.assItemId, a.assItemName, a.remain, a.debitOcc, a.creditOcc, a.balance, a.DATE, a.startDate, a.endDate, a.sign FROM bdo_dg.dg_casheuivalentsaccount a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} AND a.subjectId IN ({param4}) AND a.sign = {param5} /*START #param6# AND a.assItemId = '{param6}' #param6# END*/ ORDER BY a.subjectId
#\u73B0\u91D1\u6D41\u91CF\u8868--\u73B0\u91D1\u7B49\u4EF7\u7269
DG00413=SELECT a.autoId, a.customerId, a.projectId, a.year, a.subjectId, a.subjectName, a.assItemId, a.assItemName, a.remain, a.debitOcc, a.creditOcc, a.balance, a.DATE, a.startDate, a.endDate, a.sign FROM bdo_dg.dg_casheuivalentsaccount a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} AND a.sign = {param4} /*START #param5# AND a.subjectId IN ({param5}) #param5# END*/ ORDER BY a.subjectId
#\u73B0\u91D1\u6D41\u91CF\u8868--\u6253\u5F00\u9644\u6CE8\u6587\u4EF6
DG00414=SELECT a.autoId, a.customerId, a.projectId, a.knoteId, a.noteNo, a.noteName, a.colCode, a.colName, a.fileName, a.fullPath, a.noteDgValueInfo, a.reportTplId, a.isForbid, a.isEdited, a.isFinished, a.customizeStyle FROM bdo_dg.dg_noteinfo a LEFT JOIN ( SELECT a.customerId, a.projectId, a.knoteId, a.noteNo, a.noteName FROM bdo_dg.dg_cashflow_note a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} AND a.noteType = {param4} GROUP BY a.knoteId ) b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.knoteId = b.knoteId AND a.noteNo = b.noteNo AND a.noteName = b.noteName WHERE a.customerId = {param1} AND a.projectId = {param2} AND b.customerId IS NOT NULL
#\u73B0\u91D1\u6D41\u91CF\u8868--\u5DF2\u5206\u6790\u7684\u8C03\u6574\u51ED\u8BC1
DG00415=SELECT a.customerId, a.projectId, a.yyyy, a.indexId, a.indexId AS oldVoucherId, a.indexId AS voucherId, a.vchDate, a.serail, a.summary, a.subjectId, a.subjectFullName1, a.dirction AS direction, SUBSTRING_INDEX( SUBSTRING_INDEX( a.analyseSubjectId, ',', b.help_topic_id + 1 ), ',', - 1 ) AS oppoSubjectId, SUBSTRING_INDEX( SUBSTRING_INDEX( a.analyseSubjectName, ',', b.help_topic_id + 1 ), ',', - 1 ) AS oppoSubjectName, SUBSTRING_INDEX( SUBSTRING_INDEX( a.analyseOccurValue, ',', b.help_topic_id + 1 ), ',', - 1 ) AS occurValue, a.isEliminate FROM bdo_dg.dg_subjectentryadjust a JOIN mysql.help_topic b ON b.help_topic_id < ( LENGTH(a.analyseSubjectId) - LENGTH( REPLACE(a.analyseSubjectId, ',', '')) + 1 ) WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.dirction = 1 AND a.indexId = '{param4}'
#\u51ED\u8BC1\u8C03\u6574\u8868\u4E2D\u501F\u8D37\u79D1\u76EE\u5B58\u5728\u671F\u521D
DG00416=SELECT a.autoId, a.customerId, a.projectId, a.year, a.colCode, a.colName, a.property, a.debitAccountCode, a.debitAccountName, a.creditAccountCode, a.creditAccountName, a.remain, a.remainNum, a.remainEntryIds, a.remainSerails, a.flowIn, a.flowInNum, a.flowInEntryIds, a.flowInSerails, a.flowOut, a.flowOutNum, a.flowOutEntryIds, a.flowOutSerails, a.balance, a.balanceNum, a.balanceEntryIds, a.balanceSerails FROM bdo_dg.dg_cashflowstatement a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} AND a.debitAccountCode = '{param4}' AND a.creditAccountCode = '{param5}' AND a.remainEntryIds IS NOT NULL AND a.remainEntryIds <> ''
#\u51ED\u8BC1\u8C03\u6574\u8868\u4E2D\u501F\u8D37\u79D1\u76EE\u4E0D\u5B58\u5728\u671F\u521D
DG00417=SELECT a.autoId, a.customerId, a.projectId, a.year, a.colCode, a.colName, a.property, a.debitAccountCode, a.debitAccountName, a.creditAccountCode, a.creditAccountName, a.remain, a.remainNum, a.remainEntryIds, a.remainSerails, a.flowIn, a.flowInNum, a.flowInEntryIds, a.flowInSerails, a.flowOut, a.flowOutNum, a.flowOutEntryIds, a.flowOutSerails, a.balance, a.balanceNum, a.balanceEntryIds, a.balanceSerails FROM bdo_dg.dg_cashflowstatement a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} AND a.debitAccountCode = '{param4}' AND a.creditAccountCode = '{param5}' AND ( a.remainEntryIds IS NULL OR a.remainEntryIds = '' )
#\u5E95\u7A3F\u4E2D\u5FC3--\u8C03\u6574
DG00418=SELECT a.autoId, a.customerId, a.projectId, a.yyyy, a.indexId, a.subjectId, a.subjectname1, a.subjectFullName1, a.analyseSubjectId, a.analyseSubjectName, a.analyseOccurValue FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.indexId = '{param4}' AND a.dirction = {param5}
#\u73B0\u91D1\u6D41\u91CF\u8868--\u540C\u501F\u540C\u8D37
DG00419=SELECT a.* FROM ( SELECT a.customerId, a.projectId, a.yyyy, a.indexId, a.vchDate, a.serail, a.summary, a.occurValue, a.subjectId, a.subjectFullName1 AS subjectName, a.dirction AS direction, a.isEliminate FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.dirction = 1 AND a.indexId = '{param4}' ) a LEFT JOIN ( SELECT a.customerId, a.projectId, a.yyyy, a.indexId, a.vchDate, a.serail, a.summary, a.occurValue, a.subjectId, a.subjectFullName1 AS subjectName, a.dirction AS direction, a.isEliminate FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.dirction = - 1 AND a.indexId = '{param4}' ) b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.yyyy = b.yyyy WHERE b.customerId IS NULL UNION ALL SELECT a.* FROM ( SELECT a.customerId, a.projectId, a.yyyy, a.indexId, a.vchDate, a.serail, a.summary, a.occurValue, a.subjectId, a.subjectFullName1 AS subjectName, a.dirction AS direction, a.isEliminate FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.dirction = - 1 AND a.indexId = '{param4}' ) a LEFT JOIN ( SELECT a.customerId, a.projectId, a.yyyy, a.indexId, a.vchDate, a.serail, a.summary, a.occurValue, a.subjectId, a.subjectFullName1 AS subjectName, a.dirction AS direction, a.isEliminate FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.dirction = 1 AND a.indexId = '{param4}' ) b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.yyyy = b.yyyy WHERE b.customerId IS NULL
#\u73B0\u91D1\u6D41\u91CF\u8868--\u914D\u7F6E\u8868
DG00420=SELECT a.colCode, a.colName, a.property FROM asdb.k_cashflowstatement_subject a WHERE /*START #param1# a.debitName = '{param1}' OR a.debitName LIKE '{param1},%' OR a.debitName LIKE '%,{param1}' OR a.debitName LIKE '%,{param1},%' #param1# END*/ /*START #param2# a.creditName = '{param2}' OR a.creditName LIKE '{param2},%' OR a.creditName LIKE '%,{param2}' OR a.creditName LIKE '%,{param2},%' #param2# END*/
#\u73B0\u91D1\u6D41\u91CF\u8868--\u5BF9\u7167\u89C4\u5219
DG00421=SELECT a.customerId, a.projectId, a.year, a.colCode, a.colName, a.property, GROUP_CONCAT(DISTINCT a.debitName) AS debitName, GROUP_CONCAT(DISTINCT a.creditName) AS creditName FROM bdo_dg.dg_cashflow_rules a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} GROUP BY a.colCode, a.property
#\u8C03\u6574\u6C47\u603B--\u5168\u9879\u76EE
DG00422=SELECT a.colCode AS colCodePre, a.colName AS colDispPre, b.colCode AS colCodeAft, b.colName AS colDispAft, '\u8C03\u51FA' AS property, a.debitAccountCode AS debitCode, a.debitAccountName AS debitName, a.creditAccountCode AS creditCode, a.creditAccountName AS creditName, b.flowIn AS amount, b.flowInNum AS num, b.flowInEntryIds AS entryIds FROM bdo_dg.dg_cashflowstatement a LEFT JOIN bdo_dg.dg_cashflowstatement b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.year = b.year AND a.debitAccountCode = b.debitAccountCode AND a.creditAccountCode = b.creditAccountCode AND a.colCode <> b.colCode AND b.flowInEntryIds <> '' AND b.flowInEntryIds IS NOT NULL WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} AND a.flowOutEntryIds <> '' AND a.flowOutEntryIds IS NOT NULL
#\u8C03\u6574\u6C47\u603B--\u5355\u9879\u76EE
DG00423=SELECT a.colCode AS colCodePre, a.colName AS colDispPre, b.colCode AS colCodeAft, b.colName AS colDispAft, '\u8C03\u51FA' AS property, a.debitAccountCode AS debitCode, a.debitAccountName AS debitName, a.creditAccountCode AS creditCode, a.creditAccountName AS creditName, b.flowIn AS amount, b.flowInNum AS num, b.flowInEntryIds AS entryIds FROM bdo_dg.dg_cashflowstatement a LEFT JOIN bdo_dg.dg_cashflowstatement b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.year = b.year AND a.debitAccountCode = b.debitAccountCode AND a.creditAccountCode = b.creditAccountCode AND a.colCode <> b.colCode AND b.flowInEntryIds <> '' AND b.flowInEntryIds IS NOT NULL WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} AND a.colCode = '{param4}' AND a.flowOutEntryIds <> '' AND a.flowOutEntryIds IS NOT NULL UNION ALL SELECT b.colCode AS colCodePre, b.colName AS colDispPre, a.colCode AS colCodeAft, a.colName AS colDispAft, '\u8C03\u5165' AS property, a.debitAccountCode AS debitCode, a.debitAccountName AS debitName, a.creditAccountCode AS creditCode, a.creditAccountName AS creditName, a.flowIn AS amount, a.flowInNum AS num, a.flowInEntryIds AS entryIds FROM bdo_dg.dg_cashflowstatement a LEFT JOIN bdo_dg.dg_cashflowstatement b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.year = b.year AND a.debitAccountCode = b.debitAccountCode AND a.creditAccountCode = b.creditAccountCode AND a.colCode <> b.colCode AND b.flowOutEntryIds <> '' AND b.flowOutEntryIds IS NOT NULL WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} AND a.colCode = '{param4}' AND a.flowInEntryIds <> '' AND a.flowInEntryIds IS NOT NULL
#\u5BA1\u5B9A\u62A5\u8868--\u62A5\u8868\u9879\u540D\u79F0
DG00424=SELECT a.colCode FROM bdo_dg.dg_unauditreport a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND TRIM(a.colDisp) = '{param4}'
#\u73B0\u91D1\u6D41\u91CF\u8868--\u5BF9\u7167\u89C4\u5219
DG00425=SELECT a.customerId, a.projectId, a.year, a.colCode, a.colName, a.property FROM bdo_dg.dg_cashflow_rules a WHERE a.property = '{param1}' GROUP BY a.customerId, a.projectId, a.year, a.colCode, a.property
#\u73B0\u91D1\u6D41\u91CF\u8868--\u5173\u8054\u65B9
DG00426=SELECT a.autoId, a.customerId, a.projectId, a.mergeCustomerId, a.mergeCustomerName, a.mergeCustomerName AS mergeCustomer, a.mergeProjectId, a.mergeProjectName, a.mergeCustomerName AS mergeProject, a.shortName, a.uscc, '0' AS isChecked FROM bdo_dg.dg_merchantrelated a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.mergeScope = 1 AND a.uscc IS NOT NULL AND a.uscc <> '' ORDER BY a.autoId
#\u73B0\u91D1\u6D41\u91CF\u8868--\u5173\u8054\u65B9--\u6839\u636E\u501F\u8D37\u79D1\u76EE\u3001\u51ED\u8BC1\u53F7\u67E5\u8BE2\u62A5\u8868\u9879\u76EE
DG00427=SELECT a.autoId, a.customerId, a.projectId, a.year, a.colCode, a.colName, a.property, a.debitAccountCode, a.debitAccountName, a.creditAccountCode, a.creditAccountName, a.remain, a.remainNum, a.remainEntryIds, a.remainSerails, a.flowIn, a.flowInNum, a.flowInEntryIds, a.flowInSerails, a.flowOut, a.flowOutNum, a.flowOutEntryIds, a.flowOutSerails, a.balance, a.balanceNum, a.balanceEntryIds, a.balanceSerails FROM bdo_dg.dg_cashflowstatement a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} AND a.debitAccountCode = '{param4}' AND a.creditAccountCode = '{param5}' AND ( a.balanceEntryIds = '{param6}' OR a.balanceEntryIds LIKE '{param6},%' OR a.balanceEntryIds LIKE '%,{param6},%' OR a.balanceEntryIds LIKE '%,{param6}' )
#\u73B0\u91D1\u6D41\u91CF\u8868--\u5173\u8054\u65B9--\u73B0\u91D1\u6D41\u91CF\u8868\u6570\u636E
DG00428=SELECT a.autoId, a.customerId, a.projectId, a.year, a.mergeCustomerId, a.mergeProjectId, a.colCode, a.colName, SUM(a.amount) AS amount, SUM(a.offsetAmount) AS offsetAmount, SUM(a.num) AS num FROM bdo_dg.dg_cashflows_merchant a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.mergeCustomerId = {param4} AND a.mergeProjectId = {param5} GROUP BY a.colCode ORDER BY a.autoId
#\u9879\u76EE\u8BBE\u7F6E--\u5B9E\u65BD\u7A0B\u5E8F\u5B8C\u6210\u60C5\u51B5\u4E00\u89C8--TB\u79D1\u76EE\u3001\u5E95\u7A3F\u7F16\u5236\u4EBA
DG00429=SELECT ( SELECT GROUP_CONCAT( DISTINCT CONCAT( a.subjectId, '-', a.subjectName )) FROM bdo_dg.dg_auditprogram a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a. LEVEL = 0 ) AS subjects, ( SELECT GROUP_CONCAT( DISTINCT CONCAT(b.id, '-', b. NAME)) FROM bdo_dg.dg_auditprogram a LEFT JOIN bdo_base.base_user b ON a.workpaperEditor = b.id WHERE a.customerId = {param1} AND a.projectId = {param2} AND a. LEVEL = 0 ) AS workpaperEditors
#\u73B0\u91D1\u6D41\u91CF\u8868--\u5173\u8054\u65B9--\u73B0\u91D1\u6D41\u91CF\u8868--\u4E00\u7EA7\u79D1\u76EE
DG00430=SELECT a.autoId, a.customerId, a.projectId, a.year, a.colCode, a.colName, a.property, a.debitAccountCode, a.debitAccountName, a.creditAccountCode, a.creditAccountName, a.remain, a.remainNum, a.remainEntryIds, a.remainSerails, a.flowIn, a.flowInNum, a.flowInEntryIds, a.flowInSerails, a.flowOut, a.flowOutNum, a.flowOutEntryIds, a.flowOutSerails, a.balance, a.balanceNum, a.balanceEntryIds, a.balanceSerails FROM bdo_dg.dg_cashflowstatement a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.year = {param3} AND ( a.debitAccountCode = '{param4}' OR a.creditAccountCode = '{param4}' )
#\u5408\u5E76\u9879\u76EE--\u6279\u91CF\u751F\u6210\u5B9E\u65BD\u7A0B\u5E8F\u53CA\u5E95\u7A3F
DG00431=SELECT a.* FROM (SELECT c.paramHtmlPath AS path, a.autoId, a.customerId, a.departmentId, a.projectId, a.subjecttreeId, a.parentId, a.level, a.indexId, a.auditprogramId, a.subjectId, a.workpaperId, a.subjectName, a.dgName, a.auditDesc, a.auditConclusion, a.programNamePre, a.programNameAft, a.confirmStatusPre, a.confirmStatusAft, a.required, a.state, a.updateFlag, a.customizeFlag, a.reason, a.remark, a.CREATED_BY AS createdBy, a.audit1, a.audit2, a.audit3, a.csE, a.csC, a.csA, a.csV, a.csP, a.sE, a.sC, a.sA, a.sV, a.sP, a.csEOriginal, a.csCOriginal, a.csAOriginal, a.csVOriginal, a.csPOriginal, a.sEOriginal, a.sCOriginal, a.sAOriginal, a.sVOriginal, a.sPOriginal, a.typeId, a.dgparam, a.workpaperEditor, a.recheckUser, parent.departmentId AS parentDepartment FROM bdo_dg.dg_auditprogram a LEFT JOIN bdo_dg.dg_subjecttree b ON b.autoId = a.subjecttreeId LEFT JOIN asdb.k_dgexceltype c ON c.id = a.typeId LEFT JOIN bdo_dg.dg_auditprogram parent ON parent.autoId = a.parentId AND parent.customerId = a.customerId AND parent.projectId = a.projectId WHERE a.ACTIVE_FLAG = '{param3}' AND a.customerId = {param6} /*START #param1# AND a.subjecttreeId = {param1} #param1# END*/ /*START #param2# AND b.parentId = '{param2}' #param2# END*//*START #param4# AND a.projectId = {param4} #param4# END*/ /*START #param5# AND a.level = {param5} #param5# END*/ /*START #param8# AND a.workpaperEditor = {param8} #param8# END*/ UNION SELECT c.paramHtmlPath AS path, a.autoId, a.customerId, a.departmentId, a.projectId, a.subjecttreeId, a.parentId, a.level, a.indexId, a.auditprogramId, a.subjectId, a.workpaperId, a.subjectName, a.dgName, a.auditDesc, a.auditConclusion, a.programNamePre, a.programNameAft, a.confirmStatusPre, a.confirmStatusAft, a.required, a.state, a.updateFlag, a.customizeFlag, a.reason, a.remark, a.CREATED_BY AS createdBy, a.audit1, a.audit2, a.audit3, a.csE, a.csC, a.csA, a.csV, a.csP, a.sE, a.sC, a.sA, a.sV, a.sP, a.csEOriginal, a.csCOriginal, a.csAOriginal, a.csVOriginal, a.csPOriginal, a.sEOriginal, a.sCOriginal, a.sAOriginal, a.sVOriginal, a.sPOriginal, a.typeId, a.dgparam, a.workpaperEditor, a.recheckUser, parent.departmentId AS parentDepartment FROM bdo_dg.dg_auditprogram a LEFT JOIN bdo_dg.dg_subjecttree b ON b.autoId = a.subjecttreeId LEFT JOIN asdb.k_dgexceltype c ON c.id = a.typeId LEFT JOIN bdo_dg.dg_auditprogram parent ON parent.autoId = a.parentId AND parent.customerId = a.customerId AND parent.projectId = a.projectId WHERE a.ACTIVE_FLAG = '{param3}' AND a.customerId = {param6} /*START #param1# AND a.subjecttreeId = {param1} #param1# END*/ /*START #param2# AND b.parentId = '{param2}' #param2# END*//*START #param4# AND a.projectId = {param4} #param4# END*/ /*START #param5# AND a.level = {param5} #param5# END*/ /*START #param8# AND a.workpaperEditor = {param8} #param8# END*/) a ORDER BY a.customizeFlag, CASE WHEN a.parentDepartment = 555555 THEN 0 ELSE 1 END, CASE WHEN a.customizeFlag = '1' AND a. LEVEL = 0 THEN a.autoId ELSE a.parentId END, a.autoId
#\u5408\u5E76\u9644\u6CE8--\u6839\u636E\u9644\u6CE8\u5E95\u7A3FID\u83B7\u53D6\u8BE5\u9644\u6CE8\u516C\u5F0F
DG00432=SELECT a.autoId, a.customerId, a.projectId, a.mergeProjectId, a.subjectId, a.subjectName, a.formulaType, a.formulaProperty, a.formula, a.formulaText, a.formulaValue, a.formulaCalc, a.formulaAutoId FROM bdo_hb.hb_mergeprojectformula a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.mergeProjectId = {param3} AND a.checkType = '0' AND a.autoId IN ({param4})
#\u73B0\u91D1\u6D41\u91CF\u8868--\u5173\u8054\u65B9--\u4E00\u7EA7\u79D1\u76EE\u7F16\u53F7
DG00433=SELECT a.oneSubjectId FROM bdo_dg.dg_merchantlist a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.customerUscc = '{param3}' GROUP BY a.oneSubjectId
#\u5E95\u7A3F\u8C03\u6574\u4F4D\u7F6E\u9ED8\u8BA4\u914D\u7F6E
DG00434=SELECT a.autoId, a.auditprogramId, a.adjustType, a.subjectIdLocationCur, a.subjectNameLocationCur, a.assItemIdLocationCur, a.assItemNameLocationCur, a.adjustLocationCur, a.debitLocationCur, a.creditLocationCur, a.indexLocationCur, a.subjectIdLocationLast, a.subjectNameLocationLast, a.assItemIdLocationLast, a.assItemNameLocationLast, a.adjustLocationLast, a.debitLocationLast, a.creditLocationLast, a.indexLocationLast FROM asdb.k_adjustdglocation a WHERE a.auditprogramId = ( SELECT a.auditprogramId FROM bdo_dg.dg_auditprogram a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.autoId = ( SELECT a.parentId FROM bdo_dg.dg_auditprogram a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.workpaperId = {param3} )) AND a.adjustType = {param4}
#\u5E95\u7A3F\u4E2D\u5FC3--\u751F\u6210\u5E95\u7A3F--\u9ED8\u8BA4\u5BA2\u6237\u7F16\u53F7
DG00435=SELECT userSubjectId, userSubjectName FROM bdo_dg.dg_tbsubjectcontract WHERE customerId = {param1} AND projectId = {param2} AND yyyy = {param3} AND userSubjectName = '{param4}'
#\u67E5\u8BE2\u5B58\u5728\u73B0\u91D1\u6D41\u91CF\u8868\u5BF9\u7167\u6570\u636E\u5374\u65E0\u73B0\u91D1\u6D41\u91CF\u8868\u73B0\u91D1\u7B49\u4EF7\u7269\u79D1\u76EE\u7684\u9879\u76EE
DG00436=SELECT a.* FROM ( SELECT a.customerId, a.projectId, a.year FROM bdo_dg.dg_cashflow_subject_contrast a GROUP BY a.customerId, a.projectId, a.year ) a LEFT JOIN ( SELECT a.customerId, a.projectId, a.year FROM bdo_dg.dg_casheuivalentsaccount a GROUP BY a.customerId, a.projectId, a.year ) b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.year = b.year WHERE b.customerId IS NULL ORDER BY a.customerId
# \u67E5\u8BE2\u73B0\u91D1\u6D41\u91CF\u8868\u79D1\u76EE\u7C7B\u578B in\u3001out
DG00437=select  colCode,property from asdb.k_cashflowstatement_subject group by  colCode
#\u5408\u5E76\u9879\u76EE\u8BA1\u5212\u7A0B\u5E8F\u8FDB\u5EA6--\u5206\u5B50
DG00438=SELECT COUNT(1) AS num FROM bdo_dg.dg_auditprogram a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a. LEVEL = 0 AND a.subjecttreeId IN ( SELECT a.autoId FROM bdo_dg.dg_subjecttree a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.parentId IN ( SELECT a.autoId FROM bdo_dg.dg_subjecttree a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.nodeName = '{param3}' ))
#\u6279\u91CF\u4E0D\u6267\u884C\u5BA1\u8BA1\u7A0B\u5E8F
DG00439=SELECT a.* FROM ( SELECT a.* FROM ( SELECT a.autoId, a.indexId, a.dgName, ( SELECT COUNT(1) FROM bdo_dg.dg_auditprogram WHERE customerId = a.customerId AND projectId = a.projectId AND parentId = a.autoId AND level = 1 ) AS num FROM bdo_dg.dg_auditprogram a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.subjectId = ( SELECT a.userSubjectId FROM bdo_dg.dg_tbsubjectcontract a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.autoId = {param4} ) AND a.ACTIVE_FLAG = 1 AND a.level = 0 ) a WHERE a.num = 0 UNION ALL SELECT a.* FROM ( SELECT a.autoId, a.indexId, a.dgName, ( SELECT COUNT(1) FROM bdo_dg.dg_auditprogram WHERE customerId = a.customerId AND projectId = a.projectId AND parentId = a.autoId AND level = 1 ) AS num FROM bdo_dg.dg_auditprogram a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.subjectId = ( SELECT a.userSubjectId FROM bdo_dg.dg_othersubjectcontract a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.autoId = {param4} ) AND a.ACTIVE_FLAG = 1 AND a.level = 0 ) a WHERE a.num = 0 ) a ORDER BY a.indexId
#\u5BA2\u6237\u8C03\u6574\u3001\u5BA1\u8BA1\u8C03\u6574--\u7D22\u5F15\u53F7
DG00440=SELECT GROUP_CONCAT(DISTINCT a.indexId) AS indexId FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} GROUP BY a.indexId 
#\u5BA2\u6237\u8C03\u6574\u3001\u5BA1\u8BA1\u8C03\u6574--\u5F71\u54CD\u5230\u7684\u73B0\u6D41\u8868\u3001\u73B0\u6D41\u8868\u5173\u8054\u65B9
DG00441=SELECT a.colCode, a.colName, CONCAT( a.debitAccountCode, '-', a.debitAccountName ) AS debit, CONCAT( a.creditAccountCode, '-', a.creditAccountName ) AS credit FROM bdo_dg.dg_cashflowstatement a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.balanceEntryIds LIKE '%{param3}%'
DG00442=SELECT a.colCode, a.colName, CONCAT( a.debitCode, '-', a.debitName ) AS debit, CONCAT( a.creditCode, '-', a.creditName ) AS credit, b.mergeCustomerName AS mergeCustomer, b.mergeProjectName AS mergeProject FROM bdo_dg.dg_cashflows_merchant a LEFT JOIN bdo_dg.dg_merchantrelated b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.mergeProjectId = b.mergeProjectId AND a.mergeCustomerId = b.mergeCustomerId AND b.mergeScope = 1 WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.entryIds LIKE '%{param3}%'
# \u67E5\u8BE2\u6307\u5B9A\u9879\u76EE\u6307\u5B9A\u5BA2\u6237\u6307\u5B9A\u79D1\u76EE\u7684\u7236\u79D1\u76EE\u7F16\u53F7
DG00443=select parentSubjectId from bdo_dg.dg_customersubject where customerId = {customerId} and projectId = {projectId} and yyyy = {yyyy} and subjectId = {subjectId}
# \u67E5\u8BE2\u6307\u5B9A\u5E74\u4EFD\u672A\u5BF9\u7167\u7684\u5BA2\u6237\u79D1\u76EE
DG00444=select userSubjectId,userSubjectName,remain,debitTotalOcc,creditTotalOcc,balance,yyyy,direction from bdo_dg.dg_tbsubjectcontract where customerId = {customerId} and projectId  = {projectId} and yyyy = {yyyy} and tbSubjectId is null  and tbSubjectCode is null and balance != 0
# \u67E5\u8BE2\u6307\u5B9A\u5E74\u4EFD\u5DF2\u5BF9\u7167\u7684\u79D1\u76EE
DG00445=select userSubjectId,userSubjectName,level0,tbSubjectCode,tbSubjectName,remain,debitTotalOcc,creditTotalOcc,balance,yyyy,direction from bdo_dg.dg_tbsubjectcontract where customerId = {customerId} and projectId  = {projectId} and yyyy = {yyyy} and tbSubjectId is not null  and tbSubjectCode is not null
#\u73B0\u6D41\u8868\u5173\u8054\u65B9
DG00446=SELECT a.customerId, a.projectId, a.mergeCustomerId, a.mergeProjectId, a.colCode, a.colName, SUM(a.amount) AS amount, b.mergeCustomerName, b.mergeProjectName FROM bdo_dg.dg_cashflows_merchant a LEFT JOIN bdo_dg.dg_merchantrelated b ON b.uscc IS NOT NULL AND b.uscc != '' AND a.customerId = b.customerId AND a.projectId = b.projectId AND a.mergeCustomerId = b.mergeCustomerId AND a.mergeProjectId = b.mergeProjectId WHERE a.customerId = {param1} AND a.projectId = {param2} AND b.autoId IS NOT NULL GROUP BY a.customerId, a.projectId, a.mergeCustomerId, a.mergeProjectId, a.colCode ORDER BY a.customerId, a.projectId, a.mergeCustomerId, a.mergeProjectId
#\u67E5\u8BE2\u5206\u4EAB\u81F3APT\u5E95\u7A3F
DG00447=select distinct a.autoId,a.customerId,a.projectId,a.fileName,a.fullPath,a.subjectName,c.tbSubjectName as nodeName,b.indexId ,b.workpaperEditor,b.dgName,b.autoId as programId,b.parentId from bdo_dg.dg_workpaper a inner join bdo_dg.dg_auditprogram b on a.customerId = b.customerId and a.projectId = b.projectId and a.autoId = b.workpaperId and b.ACTIVE_FLAG = '1' inner join bdo_dg.dg_subjecttree c on a.customerId = c.customerId and a.projectId = c.projectId and c.autoId = b.subjecttreeId where a.customerId = {param1} and a.projectId = {param2} /*START #param3# and a.autoId in ({param3}) #param3# END*/ /*START #param4# and c.workpaperEditor = {param4} #param4# END*/ /*START #param5# AND c.parentId = {param5} #param5# END*/ /*START #param6# AND c.autoId = {param6} #param6# END*//*START #param7# AND b.dgName like '%{param7}%' #param7# END*/ order by b.indexId
#\u67E5\u8BE2\u6807\u51C6\u5BA1\u8BA1\u7A0B\u5E8F\u7F16\u53F7
DG00448=SELECT a.auditprogramId FROM bdo_dg.dg_auditprogram a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.autoId = ( SELECT a.parentId FROM bdo_dg.dg_auditprogram a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.workpaperId = {param3} )
# copy 00025sql \u4F46\u662F\u53EA\u67E5\u8BE2\u4E00\u7EA7\u548C\u4E8C\u7EA7\u79D1\u76EE
DG00449=SELECT aa.id, aa.label AS NAME, aa.label, aa. VALUE , aa.parentId, aa.leaf  FROM ( SELECT a.subjectId AS id, CONCAT( a.subjectId, '-', a.subjectFullName ) AS label, a.subjectId AS VALUE , IF( a.parentSubjectId = '' OR a.parentSubjectId IS NULL, LEFT(a.subjectId,1), a.parentSubjectId ) AS parentId, IF(a.level1 = 2  or a.isLeaf  = 1 , 'true', 'false')   AS leaf FROM bdo_dg.dg_customersubject a WHERE a.customerId = {param9} AND a.projectId = {param8} AND a.yyyy = {param10} AND a.level1 <= 2 AND ((a.userDefined = 1 AND a.isLeaf IS NOT NULL) OR a.userDefined = 0)) aa WHERE 1 = 1 AND aa.parentId NOT IN ('42', '41', '40') ORDER BY aa.id, aa.value
#\u67E5\u8BE2\u5408\u5E76\u8303\u56F4\u5185\u5173\u8054/\u975E\u5408\u5E76\u8303\u56F4\u5185\u5173\u8054
DG00450=SELECT a.customerId,a.projectId,a.merchantId,a.merchantName,b.mergeScope FROM bdo_dg.dg_merchantlist a LEFT JOIN bdo_dg.dg_merchantrelated b ON a.customerId=b.customerId AND a.projectId=b.projectId AND a.customerUscc=b.uscc WHERE a.isMerge=1 AND a.merchantType=1 AND a.customerId={param1} AND a.projectId={param2} UNION SELECT a.customerId,a.projectId,a.merchantId,a.merchantName,b.mergeScope FROM bdo_dg.dg_merchantlist a LEFT JOIN bdo_dg.dg_merchantrelated b ON a.customerId=b.customerId AND a.projectId=b.projectId AND a.customerUscc=b.uscc WHERE a.isMerge=1 AND a.merchantType=2 AND a.customerId={param1} AND a.projectId={param2}
#
DG00451=SELECT a.autoId, a.customerId, a.projectId, a.paperId, a.paperType, a.referredNoteId, a.referredDgId, a.remark FROM bdo_dg.dg_referredfile a WHERE a.customerId = {customerId} AND a.projectId = {projectId} AND a.paperId IN ({dgId}) AND a.paperType = '{paperType}'
#\u6839\u636E\u9879\u76EE\u67E5\u8BE2\u5B9E\u4E60\u751F
DG00452=SELECT a.autoId,a.`NAME` as internName,a.loginId,a.departname,a.popedom,a.mobilePhone,a.bindingMembers,a.bindingMembersId FROM bdo_dg.dg_projectinternuser a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.ACTIVE_FLAG = 1 /*START #param3# AND a.loginId NOT IN ({param3}) #param3# END*/
#\u6839\u636E\u767B\u5F55ID\u67E5\u8BE2\u5B9E\u4E60\u751F
DG00453=SELECT a.autoId,a.`NAME` as internName,a.loginId,a.departname,a.popedom,a.mobilePhone,a.bindingMembers,a.bindingMembersId FROM bdo_dg.dg_projectinternuser a WHERE (a.customerId <> {param1} OR a.projectId <> {param2}) AND a.loginId = {param3} AND a.popedom like '%,{param4},%' AND a.ACTIVE_FLAG = 1
#\u9879\u76EE\u4E0B\u6240\u6709\u5E95\u7A3F
DG00454=SELECT a.* FROM ( SELECT a.customerId, a.projectId, CASE WHEN b.yyyy IS NOT NULL THEN b.yyyy ELSE d.yyyy END AS yyyy, CASE WHEN b.tbSubjectId IS NOT NULL THEN b.tbSubjectId ELSE d.tbSubjectId END AS tbSubjectId, CASE WHEN b.tbSubjectName IS NOT NULL THEN b.tbSubjectName ELSE d.tbSubjectName END AS tbSubjectName, CASE WHEN b.tbSubjectId IS NOT NULL THEN CONCAT( b.tbSubjectId, '-', b.tbSubjectName ) ELSE CONCAT( d.tbSubjectId, '-', d.tbSubjectName ) END AS tbSubject, CASE WHEN b.userSubjectId IS NOT NULL THEN b.userSubjectId ELSE d.userSubjectId END AS userSubjectId, CASE WHEN b.userSubjectName IS NOT NULL THEN b.userSubjectName ELSE d.userSubjectName END AS userSubjectName, CASE WHEN b.userSubjectId IS NOT NULL THEN CONCAT( b.userSubjectId, '-', b.userSubjectName ) ELSE CONCAT( d.userSubjectId, '-', d.userSubjectName ) END AS userSubject, CASE WHEN b.subjectEditors IS NOT NULL THEN b.subjectEditors ELSE d.subjectEditors END AS subjectEditors, a.indexId AS dgIndexId, a.workpaperId, a.workpaperEditor, c.fileName AS dgName, c.fullPath FROM bdo_dg.dg_auditprogram a LEFT JOIN bdo_dg.dg_tbsubjectcontract b ON a.customerId = b.customerId AND a.projectId = b.projectId AND b.yyyy = {param3} AND a.subjectId = b.userSubjectId LEFT JOIN bdo_dg.dg_workpaper c ON a.customerId = c.customerId AND a.projectId = c.projectId AND a.workpaperId = c.autoId LEFT JOIN bdo_dg.dg_othersubjectcontract d ON a.customerId = d.customerId AND a.projectId = d.projectId AND d.yyyy = {param3} AND a.subjectId = d.userSubjectId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a. LEVEL = 1 ) a WHERE a.workpaperId IS NOT NULL AND a.subjectEditors IS NOT NULL AND a.workpaperEditor IS NOT NULL ORDER BY a.dgIndexId
#\u9879\u76EE\u4E0B\u6240\u6709\u5E95\u7A3F\u9644\u4EF6
DG00455=SELECT a.customerId, a.projectId, a.auditprogramId, a.workpaperId, a.fileIndexId AS attachIndexId, a.fileName AS attachName, a.fullPath AS attachFullPath, a.CREATED_BY AS attachEditor FROM bdo_dg.dg_attach a LEFT JOIN bdo_dg.dg_workpaper b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.workpaperId = b.autoId WHERE a.customerId = {param1} AND a.projectId = {param2} ORDER BY a.fileIndexId
#\u83B7\u53D6\u9879\u76EE\u8D1F\u8D23\u4EBA\u548C\u7EC4\u5458
DG00456=SELECT a.manager,a.membersId FROM bdo_dg.dg_project a WHERE a.customerId={param1} AND a.projectId={param2}
#\u83B7\u53D6\u6388\u6743\u7ED1\u5B9A\u4EBA\u5458
DG00457=SELECT a.id as memberId,a.`NAME` as memberName FROM bdo_base.base_user a WHERE a.id IN ({param1}) ORDER BY a.id
#\u9879\u76EE\u514B\u9686\u5931\u8D25--\u91CD\u7F6E\u5E95\u7A3F
DG00458=SELECT * FROM bdo_dg.dg_operatelog WHERE message LIKE '%\u9879\u76EE\u514B\u9686\u5931\u8D25%' AND CREATION_DATE > '2021-12-01 00:00:00'
#\u5E95\u7A3F\u7F16\u5236\u4EBA\u4E3A\u7A7A
DG00459=SELECT a.* FROM bdo_dg.dg_auditprogram a WHERE a.level = 1 AND a.workpaperId IS NOT NULL AND a.workpaperEditor IS NULL 
#\u79D1\u76EE\u7F16\u5236\u4EBA\u4E3A\u7A7A
DG00460=SELECT a.* FROM bdo_dg.dg_tbsubjectcontract a WHERE a.isNeedToAudit = '1' AND a.subjectEditors IS NULL AND (a.plancsE + a.plancsC + a.plancsA + a.plancsV + a.plancsP) > 0 
#\u5207\u6362\u62A5\u8868\u6A21\u677F--\u9644\u6CE8
DG00461=SELECT a.autoId, a.customerId, a.projectId, a.knoteId, a.noteNo, a.noteName, a.colCode, a.colName, a.fileName, a.fullPath, a.noteDgValueInfo, a.reportTplId, a.isForbid, a.isEdited, a.isFinished, a.customizeStyle, a.sortNo, a.isCompleteNow, b.isChange FROM bdo_dg.dg_noteinfo a LEFT JOIN asdb.k_noteinfo b ON a.noteName = b.noteName AND b.reportTplID = {param3} WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param4# AND b.isChange = {param4} #param4# END*/ ORDER BY a.sortNo ASC
#\u5207\u6362\u62a5\u8868\u6a21\u677f--\u9644\u6ce8
DG00462=SELECT a.autoId, a.noteNo, a.noteName, a.colCode, a.colName, a.fileName, a.fullPath, a.reportTplId, a.sortNo, a.isChange FROM asdb.k_noteinfo a WHERE a.reportTplId = {param1} AND a.noteName NOT IN ( SELECT a.noteName FROM asdb.k_noteinfo a WHERE a.reportTplId = {param2} )

####################\u5BA1\u8BA1\u5E73\u53F0\u62BD\u51ED#####################
#\u67E5\u8BE2\u62BD\u6837\u62BD\u51ED
DG10001=SELECT a.autoId,a.sampleName,a.customerId,a.projectId,a.dataResource,a.vchDateType,a.vchDateStart,a.vchDateEnd,a.subjectId,a.typeId,a.oldVoucherId,a.summary,a.amountType,a.amountStart,a.amountEnd,a.assItemId,a.sampleMethod,c.attributeName as sampleMethodName,a.projectCount,a.projectAverage,a.sampleCount,a.sampleStatus,a.sampleUser AS __uuploadUser,a.sampleTime,a.cutoffNum,a.cutoffAmount,a.cullAmountType,a.cullAmountStart,a.cullAmountEnd,a.cullReason,a.cullSubjectId,a.customizeReason,a.subjectName,a.subjectFullName,a.assItemName,a.assTotalName,a.cullSubjectName,a.cullSubjectFullName from bdo_dg.dg_samplinglist a LEFT JOIN bdo_base.base_dic c on c.attributetype='\u62BD\u6837\u65B9\u5F0F' and c.attributeValue1 = a.sampleMethod where 1=1 /*START #lockCustomerId# and a.customerId = {lockCustomerId} #lockCustomerId# END*/ /*START #param3# and a.projectId = {param3} #param3# END*/ /*START #param2# AND a.sampleName LIKE '%{param2}%' #param2# END*/ /*START #param4# and a.sampleUser = {param4} #param4# END*/ order by a.sampleTime desc
#\u67E5\u8BE2\u62BD\u51ED\u7ED3\u679C
DG10002=select a.autoId,a.customerId,a.projectId,a.yyyy,a.month,a.voucherId,a.oldVoucherId,a.typeId,a.vchDate,a.serail,a.summary,a.subjectId,a.direction,a.occurValue,a.currRate,a.currValue,a.currency,a.subjectname,a.subjectFullName,a.assItemId,c.attributeName as sampleMethod,a.sampleUserName,IF(a.direction = 1,a.occurValue,0.00) AS debitValue,IF(a.direction = - 1,a.occurValue,0.00) AS crebitValue,a.auditResult,e.attributeName as auditResultName,a.remark,case when a.contentComplete = '1' then '\u662F' when a.contentComplete = '0' then '\u5426' else '' end as contentComplete,case when a.authorize = '1' then '\u662F' when a.authorize = '0' then '\u5426' else '' end as authorize,case when a.handleCorrect = '1' then '\u662F' when a.handleCorrect = '0' then '\u5426' else '' end as handleCorrect,case when a.contentMatch = '1' then '\u662F' when a.contentMatch = '0' then '\u5426' else '' end as contentMatch,case when a.amountMatch = '1' then '\u662F' when a.amountMatch = '0' then '\u5426' else '' end as amountMatch,case when a.cutoffCorrect = '1' then '\u662F' when a.cutoffCorrect = '0' then '\u5426' else '' end as cutoffCorrect,b.fileIndexId,d.sampleName,a.assTotalName,a.oppositeAccountLast,a.content,case when a.customizeResult1 = '1' then '\u662F' when a.customizeResult1 = '0' then '\u5426' else '' end as customizeResult1,case when a.customizeResult2 = '1' then '\u662F' when a.customizeResult2 = '0' then '\u5426' else '' end as customizeResult2,case when a.customizeResult3 = '1' then '\u662F' when a.customizeResult3 = '0' then '\u5426' else '' end as customizeResult3,case when a.customizeResult4 = '1' then '\u662F' when a.customizeResult4 = '0' then '\u5426' else '' end as customizeResult4,customizeResultName1,customizeResultName2,customizeResultName3,customizeResultName4,a.relateSamplingId,e.sampleName as relateSampleName,a.samplingId from bdo_dg.dg_samplingsubjectentry a left join (select a.customerId,a.projectId,b.subjectentryId,GROUP_CONCAT(a.fileIndexId) fileIndexId from bdo_dg.dg_samplingfile a inner join bdo_dg.dg_samplingfileRelated b on a.autoId = b.samplingFileId where a.customerId = {lockCustomerId} and a.projectId = {param1} group by a.customerId,a.projectId,b.subjectentryId) b on a.customerId = b.customerId and a.autoId = b.subjectentryId and a.projectId= b.projectId LEFT JOIN bdo_base.base_dic c on c.attributetype='\u62BD\u6837\u65B9\u5F0F' and c.attributeValue1 = a.sampleMethod LEFT JOIN bdo_base.base_dic e on e.attributetype='\u62BD\u51ED\u7ED3\u8BBA' and e.attributeValue1 = a.auditResult inner join bdo_dg.dg_samplinglist d on a.samplingId = d.autoId left join bdo_dg.dg_samplinglist e on a.relateSamplingId = e.autoId where a.customerId = {lockCustomerId} and a.projectId = {param1} /*START #param2# and a.yyyy >= {param2} #param2# END*/ /*START #param14# and a.yyyy <= {param14} #param14# END*/ /*START #param12# AND a.month >='{param12}' #param12# END*/ /*START #param13# AND a.month <='{param13}' #param13# END*/ /*START #param3# AND a.vchDate >='{param3}' #param3# END*/ /*START #param4# AND a.vchDate <='{param4}' #param4# END*/ /*START #param5# AND a.sampleMethod ='{param5}' #param5# END*/ /*START #param6# AND a.oldVoucherId = '{param6}' #param6# END*/ /*START #param7# AND a.sampleUserName ='{param7}' #param7# END*/ /*START #param11# and (a.subjectFullId LIKE CONCAT('{param11}','/%') or a.subjectId = '{param11}') #param11# END*/ /*START #param15# AND a.sampleMethod <>'{param15}' #param15# END*/ /*START #param16# AND d.sampleName like '%{param16}%' #param16# END*/ /*START #param17# and a.samplingId = a.selectId #param17# END*/ /*START #param18# and a.samplingId = {param18} #param18# END*/ /*START #param19# and a.auditResult = '2' and a.relateSamplingId is null #param19# END*/ /*START #param20# and a.assItemId REGEXP {param20} #param20# END*/ order by a.vchDate,a.oldVoucherId,a.serail,a.subjectId
#\u67E5\u8BE2\u5254\u9664\u6570\u636E
DG10003=SELECT samplingId,dataResource,GROUP_CONCAT(distinct subjectId) as subjectId,GROUP_CONCAT(distinct voucherId SEPARATOR '{param4}') as yearVoucherId,GROUP_CONCAT(distinct CONCAT(subjectId,'-',assItemId)) as assItemId, GROUP_CONCAT(distinct CONCAT(yyyy,'-',voucherId)) as voucherId from bdo_dg.dg_samplingcull a where a.samplingId = {param1} and a.dataResource = {param2} and customerId = {lockCustomerId} and projectId = {param3}
#\u67E5\u8BE2\u8BD5\u62BD\u6837\u7ED3\u679C\u6570\u636E
DG10004=SELECT samplingId,dataResource,GROUP_CONCAT(distinct subjectId) as subjectId,GROUP_CONCAT(distinct voucherId SEPARATOR '{finSplit2}') as yearVoucherId,GROUP_CONCAT(distinct CONCAT(subjectId,'-',assItemId)) as assItemId,GROUP_CONCAT(distinct CONCAT(yyyy,'-',voucherId)) as voucherId,count(1) as voucherIdNum from bdo_dg.dg_samplingresult a where a.samplingId = {param1} and a.dataResource = {param2} and customerId = {lockCustomerId} and projectId = {param3} /*START #param4# and voucherId not in (SELECT distinct CONCAT(a.vchDate,'|',a.oldVoucherId,'|',a.serail,'|',a.typeId) from bdo_dg.dg_samplingsubjectentry a where a.customerId = {lockCustomerId} and projectId = {param3} AND samplingId <> {param1} AND a.selectId is not null) #param4# END*/
#\u67E5\u8BE2\u62BD\u6837\u7ED3\u679C\u51ED\u8BC1\u6570\u636E
DG10005=SELECT GROUP_CONCAT(distinct CONCAT(a.vchDate,'|',a.oldVoucherId,'|',a.serail,'|',a.typeId) SEPARATOR '{finSplit2}') as yearVoucherId,GROUP_CONCAT(distinct CONCAT(yyyy,'-',voucherId)) as voucherId,MIN(yyyy) AS minyyyy,MAX(yyyy) AS maxyyyy from bdo_dg.dg_samplingsubjectentry a where a.customerId = {lockCustomerId} and projectId = {param1} /*START #param3# AND samplingId <> {param3} #param3# END*/ /*START #param4# AND a.selectId is not null #param4# END*/
#\u67E5\u8BE2\u62BD\u51ED\u9644\u4EF6
DG10006=SELECT distinct a.autoId, a.customerId, a.projectId, a.fileIndexId, a.fileName, a.fileType, a.suffix, a.fullPath, a.uploadDate, a.subjectTreeId, a.CREATED_BY as __uuploadUser, a.sortNum, a.tempFileIndexId, a.tempFullPath, a.relateType FROM bdo_dg.dg_samplingfile a /*START #param8# inner join (select b.customerId, b.projectId, b.autoId, c.samplingFileId from bdo_dg.dg_samplingsubjectentry b inner join bdo_dg.dg_samplingfileRelated c on b.autoId = c.subjectentryId where b.customerId = {param1} and b.projectId = {param4} and b.oldVoucherId = '{param8}' and b.vchDate = '{param9}') b on a.customerId = b.customerId and a.projectId = b.projectId and a.autoId = b.samplingFileId #param8# END*/ WHERE a.customerId = {param1} /*START #param2# AND a.subjectTreeId = {param2} #param2# END*/ /*START #param3# AND a.autoId = {param3} #param3# END*/ /*START #param4# AND a.projectId = {param4} #param4# END*/ /*START #param5# AND a.subjectentryId = {param5} #param5# END*/ /*START #param6# AND a.relateType = {param6} #param6# END*/ /*START #param7# AND a.CREATED_BY = {param7} #param7# END*/ ORDER BY a.sortNum
#\u67E5\u8BE2\u5176\u4ED6\u7528\u6237\u62BD\u4E2D\u7684\u6570\u636E
DG10007=select a.samplingId,a.sampleMethod,a.sampleUser,a.sampleUserName from bdo_dg.dg_samplingsubjectentry a where a.customerId = {lockCustomerId} AND a.projectId = {param2} and a.yyyy = {param3} and a.oldVoucherId = '{param4}' and a.selectId <> {param5} and a.vchDate = '{param6}' and a.typeId = '{param7}'
#\u67E5\u8BE2\u5254\u9664\u6570\u636E
DG10008=SELECT samplingId,dataResource,GROUP_CONCAT(distinct subjectId) as subjectId,GROUP_CONCAT(distinct voucherId SEPARATOR '{finSplit2}') as yearVoucherId,GROUP_CONCAT(distinct CONCAT(subjectId,'-',assItemId)) as assItemId,GROUP_CONCAT(distinct CONCAT(yyyy,'-',voucherId)) as voucherId from bdo_dg.dg_samplingcull a where a.samplingId = {param1} and a.dataResource = {param2} and customerId = {lockCustomerId} and projectId = {param3} 
#\u62BD\u51ED\u51ED\u8BC1\u8BE6\u7EC6 \u660E\u7EC6
DG10009=SELECT a.autoId,a.customerId,a.yyyy,a.voucherId,a.serail,a.summary,a.subjectId,a.subjectFullName AS subjectFullName,IF(a.direction=1,a.occurValue,0.00) AS debitValue,IF(a.direction=1,a.currValue,0.00) AS debitCurrValue,IF(a.direction=-1,a.occurValue,0.00) AS crebitValue,IF(a.direction=-1,a.currValue,0.00) AS crebitCurrValue,a.currrate,a.currValue,a.currency,a.oldVoucherId,a.vchDate,a.content,b.fileIndexId,a.assTotalName,a.oppositeAccountLast,a.selectId FROM bdo_dg.dg_samplingsubjectentry a left join (select a.customerId,a.projectId,b.subjectentryId,GROUP_CONCAT(a.fileIndexId) fileIndexId from bdo_dg.dg_samplingfile a inner join bdo_dg.dg_samplingfileRelated b on a.autoId = b.samplingFileId where a.customerId = {lockCustomerId} and a.projectId = {param1} group by a.customerId,a.projectId,b.subjectentryId) b on a.customerId = b.customerId and a.autoId = b.subjectentryId and a.projectId= b.projectId WHERE a.customerId={lockCustomerId} AND a.yyyy={lockYyyy} AND a.projectId='{param1}' AND a.oldVoucherId='{param3}' AND a.vchDate='{param4}' /*START #param5# and a.autoId={param5} #param5# END*/ ORDER BY a.serail
#\u67E5\u8BE2\u9879\u76EE\u4E0B\u6240\u6709\u6587\u4EF6\u603B\u8BA1\u5927\u5C0F
DG10010=select sum(a) as fileSize from (select ifnull(sum(fileSize),0) a from bdo_dg.dg_attach where customerId={param1} and projectId={param2} UNION ALL select ifnull(sum(fileSize),0) a from bdo_dg.dg_file where customerId={param1} and projectId={param2} UNION ALL select ifnull(sum(fileSize),0) a from bdo_dg.dg_report where customerId={param1} and projectId={param2} UNION ALL select ifnull(sum(fileSize),0) a from bdo_dg.dg_workpaper where customerId={param1} and projectId={param2}) a 
#\u67E5\u8BE2\u62BD\u51ED\u7EDF\u8BA1\u79D1\u76EE
DG10011=select distinct t.userSubjectId as baseSubjectId,t.userSubjectName as baseSubjectName from bdo_dg.dg_tbsubjectcontract t where t.customerId = {lockCustomerId} and t.projectId = {lockProjectId} and t.userSubjectId is not null /*START #param1# and t.tbSubjectCode = '{param1}' #param1# END*/
#\u67E5\u8BE2\u62BD\u51ED\u7EDF\u8BA1\u79D1\u76EE
DG10012=select c.autoId,c.sampleName,d.attributeName as sampleMethodName,c.sampleMethod,a.voucherNum,a.debitOcc,a.creditOcc,ROUND(a.voucherNum/b.voucherNum*100,2) as rate1,ROUND(a.debitOcc/b.debitOcc*100,2) as rate2,ROUND(a.creditOcc/b.creditOcc*100,2) as rate3,b.voucherNum as voucherNumCount,b.debitOcc as debitOccCount,b.creditOcc as creditOccCount,b.subjectId from (select a.customerId,a.projectId,a.samplingId,a.yyyy,count(distinct a.autoId) as voucherNum,sum(case when a.direction = 1 then a.occurValue else 0 end) as debitOcc,sum(case when a.direction = -1 then a.occurValue else 0 end) as creditOcc from bdo_dg.dg_samplingsubjectentry a where a.customerId = {lockCustomerId} and a.projectId = {lockProjectId} /*START #param3# and (a.subjectFullId LIKE CONCAT('{param3}','/%') or a.subjectId = '{param3}') #param3# END*/ /*START #param4# AND a.assItemId = '{param4}' #param4# END*/ and a.selectId is not null group by a.customerId,a.projectId,a.samplingId) a,(select b.customerId,b.projectId,b.subjectId,b.yyyy,IFNULL(sum(b.voucherNum),0) as voucherNum,IFNULL(sum(b.debitOcc),0) as debitOcc,IFNULL(sum(b.creditOcc),0) as creditOcc from bdo_dg.dg_samplingstatistics b where b.customerId = {lockCustomerId} and b.projectId = {lockProjectId} and b.subjectId <> '' group by b.subjectId,b.yyyy) b,bdo_dg.dg_samplinglist c LEFT JOIN bdo_base.base_dic d on d.attributetype='\u62BD\u6837\u65B9\u5F0F' and d.attributeValue1 = c.sampleMethod where a.customerId = b.customerId and a.projectId = b.projectId and a.yyyy = b.yyyy and a.samplingId = c.autoId and c.subjectId like CONCAT(b.subjectId,'%') /*START #param1# and b.subjectId = '{param1}' #param1# END*/ and c.sampleMethod <> '7' /*START #param2# and a.samplingId = {param2} #param2# END*/
#\u67E5\u8BE2\u62BD\u51ED\u7ED3\u8BBA
DG10013=select CONCAT(a.yyyy,'-',a.voucherId,'-',a.subjectId) as confirmSubject from bdo_dg.dg_samplingsubjectentry a where a.customerId = {lockCustomerId} and a.projectId = {lockProjectId} and a.auditResult = '1' /*START #param1# and a.subjectId LIKE CONCAT('{param1}','%') #param1# END*/ 
#\u67E5\u8BE2\u62BD\u51ED\u8FDB\u5EA6
DG10014=select IF(count(1) = 0,0,ROUND(sum(IF(a.auditResult is not null,1,0)) * 100/count(1),2)) as percent from bdo_dg.dg_samplingsubjectentry a WHERE a.customerId = {param1} AND a.projectId = {param2} and a.selectId is not null
#\u67E5\u8BE2\u5927\u989D\u94F6\u884C\u5B58\u6B3E\u6536\u652F\u51ED\u8BC1\u62BD\u51ED\u7ED3\u679C
DG10015=select a.autoId,a.customerId,a.projectId,a.yyyy,a.month,a.voucherId,a.oldVoucherId,a.typeId,a.vchDate,a.serail,a.summary,a.subjectId,a.direction,a.occurValue,(a.direction * a.occurValue) as occurValueD,a.currRate,a.currValue,a.currency,a.subjectname,a.subjectFullName,a.assItemId,if(a.assItemName <> '', a.assItemName, a.subjectname) as assItemName,c.attributeName as sampleMethod,a.sampleUserName,IF(a.direction = 1,a.occurValue,0.00) AS debitValue,IF(a.direction = - 1,a.occurValue,0.00) AS crebitValue,a.auditResult,e.attributeName as auditResultName,a.remark,case when a.contentComplete = '1' then '\u662F' when a.contentComplete = '0' then '\u5426' else '' end as contentComplete,case when a.authorize = '1' then '\u662F' when a.authorize = '0' then '\u5426' else '' end as authorize,case when a.handleCorrect = '1' then '\u662F' when a.handleCorrect = '0' then '\u5426' else '' end as handleCorrect,case when a.contentMatch = '1' then '\u662F' when a.contentMatch = '0' then '\u5426' else '' end as contentMatch,case when a.amountMatch = '1' then '\u662F' when a.amountMatch = '0' then '\u5426' else '' end as amountMatch,case when a.cutoffCorrect = '1' then '\u662F' when a.cutoffCorrect = '0' then '\u5426' else '' end as cutoffCorrect,b.fileIndexId,d.sampleName,a.assTotalName,a.oppositeAccountLast,a.content,case when a.customizeResult1 = '1' then '\u662F' when a.customizeResult1 = '0' then '\u5426' else '' end as customizeResult1,case when a.customizeResult2 = '1' then '\u662F' when a.customizeResult2 = '0' then '\u5426' else '' end as customizeResult2,case when a.customizeResult3 = '1' then '\u662F' when a.customizeResult3 = '0' then '\u5426' else '' end as customizeResult3,case when a.customizeResult4 = '1' then '\u662F' when a.customizeResult4 = '0' then '\u5426' else '' end as customizeResult4,customizeResultName1,customizeResultName2,customizeResultName3,customizeResultName4,a.relateSamplingId,e.sampleName as relateSampleName,a.samplingId from bdo_dg.dg_samplingsubjectentry a left join (select a.customerId,a.projectId,b.subjectentryId,GROUP_CONCAT(a.fileIndexId) fileIndexId from bdo_dg.dg_samplingfile a inner join bdo_dg.dg_samplingfileRelated b on a.autoId = b.samplingFileId where a.customerId = {customerId} and a.projectId = {projectId} group by a.customerId,a.projectId,b.subjectentryId) b on a.customerId = b.customerId and a.autoId = b.subjectentryId and a.projectId= b.projectId LEFT JOIN bdo_base.base_dic c on c.attributetype='\u62BD\u6837\u65B9\u5F0F' and c.attributeValue1 = a.sampleMethod LEFT JOIN bdo_base.base_dic e on e.attributetype='\u62BD\u51ED\u7ED3\u8BBA' and e.attributeValue1 = a.auditResult inner join bdo_dg.dg_samplinglist d on a.samplingId = d.autoId left join bdo_dg.dg_samplinglist e on a.relateSamplingId = e.autoId where a.customerId = {customerId} and a.projectId = {projectId} /*START #param1# and a.yyyy = {param1} #param1# END*/ /*START #param2# and a.month in ({param2}) #param2# END*/ /*START #param3# and a.subjectId = '{param3}' #param3# END*/ /*START #param4# and a.direction = {param4} #param4# END*/ /*START #param5# and a.occurValue >= {param5} #param5# END*/ /*START #param6# and a.assItemId like '%{param6}%' #param6# END*/ and a.samplingId = a.selectId order by a.vchDate,a.oldVoucherId,a.serail,a.subjectId
####################\u5BA1\u8BA1\u5E73\u53F0\u62BD\u51ED#####################
####################\u5BA1\u8BA1\u5E73\u53F0\u62A5\u5907#####################
#\u67E5\u8BE2\u62A5\u5907\u6A21\u677F\u4E00\u89C8
DG20001=SELECT a.autoId, a.ruleType, a.must, a.ruleName, a.remark, a.fileName, a.fullPath, a.reportType, b.attributeName as ruleTypeName, DATE_FORMAT(a.CREATION_DATE, '%Y-%m-%d %T') AS CREATION_DATE, a.CREATED_BY, DATE_FORMAT(a.LAST_UPDATE_DATE, '%Y-%m-%d %T') AS LAST_UPDATE_DATE, a.LAST_UPDATED_BY, a.ACTIVE_FLAG, c.checkNum FROM asdb.k_bbruleacc a inner join (select distinct t1.bbTemplateId from asdb.k_subjectbb t1, bdo_dg.dg_project t2 where t1.vocationId = t2.tbReportTemplate and t2.customerId = {param1} and t2.projectId = {param2}) c on a.autoId = c.bbTemplateId left join bdo_base.base_dic b on a.ruleType = b.attributeValue1 and b.attributetype = '\u62A5\u5907\u6A21\u677F\u7C7B\u578B' left join bdo_dg.dg_bbcheck c on c.bbTemplate = a.autoId and c.customerId = {param1} and c.projectId = {param2} WHERE 1 = 1 AND a.ACTIVE_FLAG = '1' ORDER BY a.CREATION_DATE DESC 
#\u67E5\u8BE2\u62A5\u5907\u62A5\u8868\u6A21\u677F\u5BF9\u7167\u5173\u7CFB
DG20002=select distinct t1.bbVocationId,t1.bbSubjectId,t1.bbSubjectName,t1.bbSubjectNameDisp,t1.sortNo,t1.tableDiv,{param1} as vocationId,t2.reportSubjectCode,t2.calFun as reportCalFun,t2.mulReportSubjectCode,t2.mulReportSubjectName,t1.calFun as bbCalFun from asdb.k_bbtemplate t1 LEFT JOIN asdb.k_subjectbb t2 on t1.bbVocationId = t2.bbTemplateId and t1.bbSubjectId = t2.subjectCode and t1.tableDiv = t2.tableDiv and t2.vocationId = {param1} where t1.bbVocationId = {param2}
#\u67E5\u8BE2\u62A5\u5907\u62A5\u8868
DG20003=select a.autoId,a.customerId,a.projectId,a.column1,a.column2,a.column3,a.column4,a.column5,a.column6,a.column7,a.column8,a.column9,a.column10,a.column11,a.column12,a.column13,a.column14,a.column15,a.note,a.bbSubjectId,a.bbSubjectName,a.bbSubjectNameDisp,b.calFun as bbCalFun from bdo_dg.dg_bbreport a inner join asdb.k_bbtemplate b on a.bbTemplate = b.bbVocationId and a.bbSubjectId = b.bbSubjectId and a.tableType = b.tableDiv where a.customerId = {param1} and a.projectId = {param2} and a.bbTemplate = {param3} /*START #param4# and a.tableType = {param4} #param4# END*/ order by a.sortNo
#\u67E5\u8BE2\u62A5\u5907\u62A5\u8868\u5217\u540D
DG20004=select distinct tableType,columnDesc1,columnDesc2,columnDesc3,columnDesc4,columnDesc5,columnDesc6,columnDesc7,columnDesc8,columnDesc9,columnDesc10,columnDesc11,columnDesc12,columnDesc13,columnDesc14,columnDesc15 from bdo_dg.dg_bbreport t where customerId = {param1} and projectId = {param2} and bbTemplate = {param3} group by tableType
#\u67E5\u8BE2\u62A5\u5907\u6570\u636E
DG20005=select t1.bbSubjectId,t1.tableDiv,t2.column1,t2.column2,t2.column3,t2.column4,t2.column5,t2.column6,t2.column7,t2.column8,t2.column9,t2.column10,t2.column11,t2.column12,t2.column13,t2.column14,t2.column15,t2.note,t2.columnDesc1,t2.columnDesc2,t2.columnDesc3,t2.columnDesc4,t2.columnDesc5,t2.columnDesc6,t2.columnDesc7,t2.columnDesc8,t2.columnDesc9,t2.columnDesc10,t2.columnDesc11,t2.columnDesc12,t2.columnDesc13,t2.columnDesc14,t2.columnDesc15 from asdb.k_bbtemplate t1 left join bdo_dg.dg_bbreport t2 on t1.bbVocationId = t2.bbTemplate and t1.bbSubjectId = t2.bbSubjectId and t1.tableDiv = t2.tableType and t2.customerId = {param1} and t2.projectId = {param2} where t1.bbVocationId = {param3}
#\u67E5\u8BE2\u5355\u4F53\u9644\u6CE8
DG20006=select b.*,@group_row:=CASE when @parent_code=b.tableDiv then  @group_row+1 else 1 end as groupRow,@parent_code:=b.tableDiv as parent_code from (SELECT a.noteNo,a.colCode,a.reportTplId,a.isForbid,b.tableDiv FROM bdo_dg.dg_noteinfo a, asdb.k_reporttemplate b WHERE a.customerId = {param1} AND a.projectId = {param2} and a.isForbid <> 1 and a.reportTplId = b.vocationId and a.colCode = b.colCode ORDER BY a.noteNo DESC,b.tableDiv) b, ( select @group_row:=1, @parent_code:='') as c
#\u67E5\u8BE2\u5408\u5E76\u9644\u6CE8
DG20007=select b.*,@group_row:=CASE when @parent_code=b.tableDiv then  @group_row+1 else 1 end as groupRow,@parent_code:=b.tableDiv as parent_code from (SELECT a.noteNo,a.colCode,a.reportTplId,a.isForbid,b.tableDiv FROM bdo_hb.hb_mergenoteinfo a, asdb.k_reporttemplate b WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.mergeProjectId = {param3} and a.isForbid <> 1 and a.reportTplId = b.vocationId and a.colCode = b.colCode ORDER BY a.noteNo DESC,b.tableDiv) b, ( select @group_row:=1, @parent_code:='') as c
#\u67E5\u8BE2\u8BE5\u5408\u5E76\u9879\u76EE\u9664\u4E86\u5F53\u524D\u5B50\u9879\u76EE\u5916\u5176\u4ED6\u6240\u6709\u9879\u76EE\u5DF2\u5206\u914D\u7684\u91CD\u8981\u6027\u6C34\u5E73\uFF0C\u660E\u663E\u5FAE\u7EC6\u9519\u62A5
DG20008=SELECT ifnull(sum(a.settingTypeValue1),0) as settingTypeValue1Total,ifnull(sum(a.settingTypeValue2),0) as settingTypeValue2Total FROM bdo_hb.hb_mergeproject a WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.autoId != {param3} #param3# END*/ 
#\u6279\u6CE8\u4E00\u89C8(\u5408\u5E76\u9879\u76EE)
DG20009=SELECT * FROM (SELECT a.autoId, a.customerId, a.indexId,  a.createUser AS __ucreateUser, ( CASE WHEN a.CREATED_BY = {userId} THEN 'true' ELSE 'false'  END ) AS isAuthor, DATE_FORMAT( a.CREATION_DATE, '%Y-%m-%d %H:%i:%s' ) AS createDate, a.content, a.cellContent, a.postilLevel, NULL AS comments, a.ACTIVE_FLAG AS activeFlag, '' AS __ucommentedUser, a.type, '' AS commentId, '' AS annotationId FROM bdo_hb.hb_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.autoId = {param3} #param3# END*/  /*START #param4# AND a.auditState = {param4} #param4# END*/  AND a.type = '{param6}' UNION ALL SELECT a.autoId, a.customerId, b.indexId, a.createUser AS __ucreateUser, ( CASE WHEN a.CREATED_BY = {userId} THEN 'true' ELSE 'false'  END ) AS isAuthor,DATE_FORMAT( a.CREATION_DATE, '%Y-%m-%d %H:%i:%s' ) AS createDate, a.content, a.cellContent, '' AS postilLevel, NULL AS comments, a.ACTIVE_FLAG AS activeFlag, a.commentedUser AS __ucommentedUser, a.TYPE, a.commentId, a.annotationId FROM bdo_hb.hb_comment a LEFT JOIN bdo_hb.hb_annotation b ON b.autoId = a.annotationId AND a.customerId = b.customerId WHERE b.customerId = {param1} AND b.projectId = {param2} /*START #param3# AND b.autoId = {param3} #param3# END*/ /*START #param4# AND b.auditState = {param4}  #param4# END*/  AND b.type = '{param6}') a 
#\u67E5\u8BE2\u5408\u5E76\u8303\u56F4\u5185\u6240\u6709\u5B50\u9879\u76EE\u7684\u9879\u76EE\u8FDB\u5EA6
#20200716 \u9879\u76EE\u5168\u666F\u56FE\u67E5\u8BE2\u65F6\u4E0D\u67E5\u8BE2\u4E34\u65F6\u9879\u76EE\uFF0C\u5224\u65AD\u6807\u51C6 mergeProjectId\u4EE51\u5F00\u5934
DG20010=SELECT  mergeScope,a.ACTIVE_FLAG,ifnull(a.lastInitializationTimeContacts, 0) as lastInitializationTimeContacts,ifnull(a.lastInitializationTimeDeal, 0)     as lastInitializationTimeDeal,a.projectProgress,if(left(a.mergeProjectId,1) = '1',true,false) as 'isTempProject',a.autoId,a.mergeProjectId as projectId,a.projectSource, a.mergeCustomerId as customerId,CONCAT( a.mergeCustomerId, '-', a.mergeCustomerName ) AS customerName,CONCAT( a.mergeProjectId, '-', a.mergeProjectName ) AS projectName,ifnull( b.materialityState, 0 ) AS materialityState ,ifnull(b.trialBalanceState,0) as trialBalanceState , ifnull(b.unauditedState,0) as unauditedState , ifnull(b.analysisReviewState,0) as analysisReviewState , ifnull(b.identifiedState,0) as identifiedState , ifnull(b.programPlanState,0) programPlanState , ifnull(b.programState,0) as programState , ifnull(b.clearQuestionState,0) as clearQuestionState , ifnull(b.auditedState,0) as auditedState , ifnull(b.finalAnalysisReviewState,0) as finalAnalysisReviewState,ifnull(b.noteinfoState,0) as noteinfoState, ifnull(b.reportState,0) as reportState, ifnull(b.bbReportState,0) as bbReportState FROM bdo_hb.hb_mergeproject a LEFT JOIN bdo_dg.dg_project b ON a.mergeProjectId = b.projectId AND a.mergeCustomerId = b.customerId where a.customerId = {param1} AND a.projectId = {param2} 
#\u6279\u6CE8\u4E00\u89C8(\u6279\u6CE8\u6C47\u603B-\u5408\u5E76\u9879\u76EE)
DG20011=SELECT * FROM (SELECT a.autoId, a.customerId, a.indexId,  a.createUser AS __ucreateUser, ( CASE WHEN a.CREATED_BY = {userId} THEN 'true' ELSE 'false'  END ) AS isAuthor, DATE_FORMAT( a.CREATION_DATE, '%Y-%m-%d %H:%i:%s' ) AS createDate, REPLACE(a.content ,'..','.')as content, a.cellContent, a.postilLevel, NULL AS comments, a.ACTIVE_FLAG AS activeFlag, '' AS __ucommentedUser, a.type, '' AS commentId, '' AS annotationId FROM bdo_hb.hb_annotation a WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.autoId = {param3} #param3# END*/  /*START #param4# AND a.auditState = {param4} #param4# END*/  AND a.type = '{param6}' UNION ALL SELECT a.autoId, a.customerId, b.indexId, a.createUser AS __ucreateUser, ( CASE WHEN a.CREATED_BY = {userId} THEN 'true' ELSE 'false'  END ) AS isAuthor,DATE_FORMAT( a.CREATION_DATE, '%Y-%m-%d %H:%i:%s' ) AS createDate, REPLACE(a.content ,'..','.')as content, a.cellContent, '' AS postilLevel, NULL AS comments, a.ACTIVE_FLAG AS activeFlag, a.commentedUser AS __ucommentedUser, a.TYPE, a.commentId, a.annotationId FROM bdo_hb.hb_comment a LEFT JOIN bdo_hb.hb_annotation b ON b.autoId = a.annotationId AND a.customerId = b.customerId WHERE b.customerId = {param1} AND b.projectId = {param2} /*START #param3# AND b.autoId = {param3} #param3# END*/ /*START #param4# AND b.auditState = {param4}  #param4# END*/  AND b.type = '{param6}') a 
# \u67E5\u8BE2dg\u4E0B\u5173\u8054\u65B9\u4FE1\u606Fsql
DG20012=select customerId,projectId,customerName,projectName, manager  AS __umanager from bdo_dg.dg_project where customerId = {customerId} and projectId = {projectId} 
####################\u5BA1\u8BA1\u5E73\u53F0\u62A5\u5907#####################
####################\u5BA1\u8BA1\u5E73\u53F0\u5F80\u6765#####################
#\u67E5\u8BE2\u5F80\u6765\u5BA2\u5546\u8303\u56F4
DG40001=select a.subjectId,a.subjectName,a.subjectIsMerchant,a.assitemIsMerchant,GROUP_CONCAT(a.assItemId) as assItemId,GROUP_CONCAT(a.assItemName) as assItemName from bdo_dg.dg_merchantrange a where a.customerId = {param1} and a.projectId = {param2} group by a.subjectId,a.subjectName,a.subjectIsMerchant,a.assitemIsMerchant order by a.subjectId
#\u67E5\u8BE2\u5173\u8054\u62BD\u51ED
DG40002=select distinct a.autoId,a.customerId,IF(a.isSampling = '1', '\u662F', '\u5426') as isSampling from bdo_dg.dg_merchantlist a,bdo_dg.dg_samplingsubjectentry b where a.customerId = {param1} and a.projectId = {param2} and a.yyyy = {param3} and a.customerId = b.customerId and a.projectId = b.projectId and b.yyyy = {param3} and ((a.merchantId = b.subjectId and a.merchantType = '1') or (a.merchantId = b.assItemId and a.merchantType = '2')) and a.isSampling = '0' and b.selectId = b.samplingId and a.isMerge = 1
#\u67E5\u8BE2\u5BA2\u5546\u6570\u636E
DG40003=select distinct a.autoId,a.customerId,a.projectId,a.merchantId,a.merchantName,a.merchantFullName,a.merchantType,IF(a.isSampling = '1', '\u662F', '\u5426') as isSampling,a.customerUscc,a.companyName as customerName,a.companyEnName as customerEnName,a.officeAddress,a.registeredAddress,a.baiduAddress,a.telephone,a.areaPlace,a.industrycategory,a.industrycategorycode,a.industryclassification,a.industryclassificationcode,a.registerAmount,a.oneSubjectId,a.oneSubjectName,a.subjectId,a.subjectName,a.subjectFullName,a.remain,a.debitOcc,a.creditOcc,a.balance,a.preRemain,a.preDebitOcc,a.preCreditOcc,a.preBalance from bdo_dg.dg_merchantlist a left join asdb.k_company b on a.customerUscc = b.customerUscc where a.customerId = {lockCustomerId} and a.projectId = {lockProjectId} and a.yyyy = {lockYyyy} and a.isMerge = 1 /*START #param3# and a.merchantName like '%{param3}%' #param3# END*/ /*START #param4# and a.isSampling = {param4} #param4# END*/ /*START #param5# and a.customerUscc = '{param5}' #param5# END*/ /*START #param6# and a.subjectFullName like '%{param6}%' #param6# END*/ /*START #param7# and a.subjectFullId like '{param7}%' #param7# END*/ /*START #param9# and (a.customerUscc is null or a.customerUscc = '') #param9# END*/ /*START #param10# and (a.remain <> 0 or a.debitOcc <> 0 or a.creditOcc <> 0 or a.balance <> 0) #param10# END*/ group by a.autoId
#\u67E5\u8BE2\u5BA2\u5546\u6570\u636E(\u5DE5\u5546\u5BA2\u6237\u7EF4\u5EA6)
DG40004=select distinct a.autoId,a.customerId,a.projectId,a.merchantId,a.merchantName,a.merchantFullName,a.merchantType,IF(a.isSampling = '1', '\u662F', '\u5426') as isSampling,a.customerUscc,a.companyName as customerName,a.companyEnName as customerEnName,a.officeAddress,a.registeredAddress,a.baiduAddress,a.telephone,a.areaPlace,a.industrycategory,a.industrycategorycode,a.industryclassification,a.industryclassificationcode,a.registerAmount,a.oneSubjectId,a.oneSubjectName,a.subjectId,a.subjectName,a.subjectFullName,a.remain,a.debitOcc,a.creditOcc,a.balance,a.preRemain,a.preDebitOcc,a.preCreditOcc,a.preBalance from bdo_dg.dg_merchantlist a inner join asdb.k_company b on a.customerUscc = b.customerUscc where a.customerId = {lockCustomerId} and a.projectId = {lockProjectId} and a.yyyy = {lockYyyy} and a.isMerge = 1 /*START #param2# and (a.customerUscc = '{param7}' or (a.merchantName = '{param2}' or b.customerName = '{param2}')) #param2# END*/ /*START #param3# and a.merchantName like '%{param3}%' #param3# END*/ /*START #param4# and a.isSampling = {param4} #param4# END*/ /*START #param5# and a.customerUscc = '{param5}' #param5# END*/ /*START #param6# and a.customerName like '%{param6}%' #param6# END*/ /*START #param8# and a.subjectFullName like '%{param8}%' #param8# END*/ /*START #param9# and (a.customerUscc is null or a.customerUscc = '') #param9# END*/ /*START #param10# and (a.remain <> 0 or a.debitOcc <> 0 or a.creditOcc <> 0 or a.balance <> 0) #param10# END*/ group by a.autoId order by a.customerUscc
#\u67E5\u8BE2\u5339\u914D\u6570\u636E
DG40005=select a.autoId,a.customerId,a.merchantName,max(b.customerUscc) as customerUscc /*START #param4# ,max(c.customerUscc) as lastUscc #param4# END*/ from bdo_dg.dg_merchantlist a left join asdb.k_company b on a.merchantName = b.customerName /*START #param4# left join bdo_dg.dg_merchantlist c on a.merchantId = c.merchantId and a.merchantType = c.merchantType and c.customerId = {param3} AND c.projectId = {param4} and c.yyyy = {lockYyyy} and c.isMerge = 1 and c.customerUscc is not null #param4# END*/ where a.customerId = {param1} and a.projectId = {param2} and a.yyyy = {lockYyyy} and a.isMerge = 1 and (a.customerUscc is null or a.customerUscc ='') /*START #param5# and a.merchantId = '{param5}' #param5# END*/ group by a.autoId,a.customerId,a.merchantName
#\u67E5\u8BE2\u5F80\u6765\u5BA2\u6237\uFF08\u5408\u5E76\u9879\u76EE\uFF09
DG40006=select distinct t1.mergeCustomerId,t1.mergeProjectId,t1.mergeCustomerName,t1.stockBreakRate,t1.equityRatio,t1.stockType,t1.stockCapi,t1.shortName,t1.mergeProjectName,t1.curMergeProportion,t1.preMergeProportion,t1.mergeScope,t1.projectSource,t1.uscc,t1.incomeTaxRate from (select a.customerId,a.projectId,a.mergeCustomerId,a.mergeProjectId,a.mergeCustomerName,a.stockBreakRate,a.equityRatio,a.stockType,a.stockCapi,a.shortName,a.mergeProjectName,a.curMergeProportion,a.preMergeProportion,a.mergeScope,a.projectSource,a.uscc,a.incomeTaxRate from bdo_hb.hb_mergeproject a where a.customerId = {lockCustomerId} and a.projectId = {lockProjectId} and a.mergeProjectId <> {lockProjectId} and a.mergeScope = '1' and a.ACTIVE_FLAG = '1' union select a.customerId,a.projectId,a.mergeCustomerId,a.mergeProjectId,a.mergeCustomerName,a.stockBreakRate,a.equityRatio,a.stockType,a.stockCapi,a.shortName,a.mergeProjectName,a.curMergeProportion,a.preMergeProportion,a.mergeScope,a.projectSource,a.uscc,a.incomeTaxRate from bdo_hb.hb_mergeproject a,(select a.customerId,a.projectId from bdo_hb.hb_mergeproject a where a.mergeCustomerId = {lockCustomerId} and a.mergeProjectId = {lockProjectId} and a.mergeScope = '1' and a.ACTIVE_FLAG = '1') b where a.customerId = b.customerId and a.projectId = b.projectId and a.mergeProjectId <> {lockProjectId}) t1 where 1=1 /*START #param3# and t1.mergeCustomerName like '%{param3}%' #param3# END*/ order by t1.mergeCustomerId 
#\u67E5\u8BE2\u5F80\u6765\u5BA2\u6237\uFF08\u624B\u52A8\u5BFC\u5165\uFF09
DG40007=select distinct t1.autoId,t1.customerId,t1.projectId,t1.mergeCustomerId,t1.mergeProjectId,t1.mergeCustomerName,t1.stockBreakRate,t1.equityRatio,t1.stockType,t1.stockCapi,t1.shortName,t1.mergeProjectName,t1.curMergeProportion,t1.preMergeProportion,t1.mergeScope,case when t1.mergeScope = '0' then '\u5408\u5E76\u8303\u56F4\u5916\u4E14\u662F\u5173\u8054\u65B9' when t1.mergeScope = '1' then '\u5408\u5E76\u8303\u56F4\u5185' else '\u4EC5\u672C\u516C\u53F8\u5173\u8054\u65B9' end as mergeScopeName, t1.projectSource,t2.merchantId,t2.merchantName,t2.merchantType,t2.subjectId,t2.subjectName,t2.oneSubjectId,t2.oneSubjectName,t2.autoId as listId,t2.customerUscc,t2.companyName as customerName,t2.officeAddress,t2.registeredAddress,t2.baiduAddress,t2.telephone,t2.areaPlace,t2.industrycategory,t2.industrycategorycode,t2.industryclassification,t2.industryclassificationcode,t1.uscc,t1.incomeTaxRate,t1.checkComplete,t1.checkMan,t1.checkTime,t1.checkReason,t1.tradeMan,t1.tradeTime from bdo_dg.dg_merchantrelated t1 left join bdo_dg.dg_merchantlist t2 on t1.uscc = t2.customerUscc and t1.customerId = t2.customerId and t1.projectId = t2.projectId and t2.yyyy = {lockYyyy} and t2.isMerge = 1 where t1.customerId = {param1} and t1.projectId = {param2} /*START #param3# and t1.mergeCustomerName like '%{param3}%' #param3# END*/ /*START #param4# and t2.merchantName like '%{param4}%' #param4# END*/ /*START #param5# and t2.customerUscc in ({param5}) #param5# END*/ /*START #param6# and t2.merchantId is not null #param6# END*/ /*START #param7# and t2.merchantId is null #param7# END*/ /*START #param8# and t2.customerUscc = '{param8}' #param8# END*/ order by t1.mergeCustomerId,t1.mergeCustomerName
#\u67E5\u8BE2\u5339\u914D\u767E\u5EA6\u5730\u5740\u6570\u636E
DG40008=select distinct b.companyId,b.customerUscc,b.customerName from bdo_dg.dg_merchantlist a inner join asdb.k_company b on a.customerUscc = b.customerUscc where a.customerId = {param1} and a.projectId = {param2} and a.yyyy = {lockYyyy} and a.customerUscc is not null and a.isMerge = 1 and b.baiduAddress is null
#\u67E5\u8BE2\u5339\u914D\u6570\u91CF
DG40009=select count(1) as totalCount,ifnull(sum(case when a.customerUscc is not null and a.customerUscc <> '' then 1 else 0 end),0) as matchCount,ifnull(sum(case when a.isSampling = 1 then 1 else 0 end),0) as samplingCount,ifnull(sum(case when (a.customerUscc is not null and a.customerUscc <> '') and a.isSampling = 1 then 1 else 0 end),0) as samplingMatchCount from bdo_dg.dg_merchantlist a where a.customerId = {param1} and a.projectId = {param2} and a.yyyy = {lockYyyy} and a.isMerge = 1 
#\u67E5\u8BE2\u591A\u79D1\u76EE\u6302\u8D26\u6307\u5B9A\u7684\u76F8\u540C\u5BA2\u5546
DG40010=select distinct b.assItemId,c.autoId,c.customerId from bdo_fin.fin_assitemsame a inner join bdo_fin.fin_assitemsame b on a.customerId = b.customerId and a.yyyy = b.yyyy and a.assItemCustomerName = b.assItemCustomerName and b.assItemId <> '{param3}' inner join bdo_dg.dg_merchantlist c on b.assItemId = c.merchantId and a.customerId = c.customerId and c.projectId = {param4} and c.yyyy = {param2} and c.merchantType = '2' and c.isMerge = '1' where a.customerId = {param1} and a.yyyy = {param2} and a.assItemId = '{param3}' 
DG40011=SELECT * FROM bdo_dg.dg_merchantlist a WHERE a.customerId = {param1} AND a.projectId = {param2} and a.yyyy = {lockYyyy} AND a.merchantType = {param3} AND a.merchantId IN ({param4}) and a.isMerge = 1 
DG40012=select * from asdb.k_company where customerUscc in ({param1})
DG40013=select * from bdo_dg.dg_merchantlist where autoId in ({param1})
DG40014=SELECT DISTINCT a.assItemId,b.assItemId as assItemId2 FROM (SELECT b.assItemId, b.assItemCustomerName FROM bdo_fin.fin_assitemsame b WHERE b.customerId = {param1} AND b.yyyy = {param2} /*AND b.assItemId NOT IN ({param3})*/) a LEFT JOIN (SELECT a.assItemId, a.assItemCustomerName FROM bdo_fin.fin_assitemsame a WHERE a.customerId = {param1} AND a.yyyy = {param2} AND a.assItemId IN ({param3})) b ON a.assItemCustomerName = b.assItemCustomerName AND b.assItemId != a.assItemId WHERE b.assItemId IS NOT NULL ORDER BY b.assItemId DESC
#\u67E5\u8BE2\u5730\u533A\u884C\u4E1A
DG40015=select distinct a.merchantId,a.customerUscc,b.areaPlace,b.industrycategory,b.industryclassification from bdo_dg.dg_merchantlist a inner join asdb.k_company b on a.customerUscc = b.customerUscc where a.customerId = {param1} and a.yyyy = {lockYyyy} and a.merchantType = {param2} and a.customerUscc is not null and a.isMerge = 1 
#\u67E5\u8BE2\u8D26\u9F84
DG40016=SELECT ifnull(a.araId,a.subjectId) araId,ifnull(a.araName,a.subjectName) araName, a.subjectId,case when a.status = 0 then '\u6210\u529F' when a.status = 1 then '\u5931\u8D25' else a.status end as status, a.reason,a.ara01, a.ara02, a.ara03,  a.ara04,  a.ara05, a.ara06 FROM bdo_dg.dg_ara a inner join (SELECT distinct customerId,projectId FROM bdo_hb.hb_mergeproject WHERE mergeCustomerId = {lockCustomerId} AND mergeProjectId = {lockProjectId}) b on a.customerId = b.customerId AND a.projectId = b.projectId /*START #param3# AND ifnull(a.araName,a.subjectName) LIKE '%{param3}%' #param3# END*/ /*START #param3# AND a.araName LIKE '%{param4}%' #param3# END*/ AND a.isMerge={param5}
#\u5173\u8054\u65B9\u660E\u7EC6
DG40017=SELECT a.autoId,a.customerId,a.projectId,a.mergeCustomerId,a.mergeProjectId,a.mergeCustomerName,a.oneSubjectId,a.oneSubjectName,a.subjectFullName,a.merchantId,a.merchantName,a.merchantType,a.customerUscc,a.subjectId,a.remain,a.debitOcc,a.creditOcc,a.balance,a.badDebt,a.deferredTax,a.status, a.reason,a.ara07 as ara01, a.ara08 as ara02, a.ara09 as ara03,  a.ara10 as ara04,  a.ara11 as ara05, a.ara12 as ara06,a.debitAdjust,a.creditAdjust,a.direction,case when a.direction = 1 then IFNULL(a.balance,0) + IFNULL(a.debitAdjust,0) - IFNULL(a.creditAdjust,0) else IFNULL(a.balance,0) - IFNULL(a.debitAdjust,0) + IFNULL(a.creditAdjust,0) end as approvalBalance,(IFNULL(a.ara07,0) + IFNULL(a.ara08,0) +IFNULL(a.ara09,0) +IFNULL(a.ara10,0) +IFNULL(a.ara11,0) +IFNULL(a.ara12,0)) as araTotal FROM bdo_dg.dg_merchantdetail a WHERE a.customerId = {lockCustomerId} AND a.projectId = {lockProjectId} /*START #param3# AND a.mergeCustomerName LIKE '%{param3}%' #param3# END*/ order by a.mergeCustomerName
#\u521D\u59CB\u5316\u5173\u8054\u65B9\u660E\u7EC6\u67E5\u8BE2
DG40018=select distinct t1.customerId,t1.projectId,t2.merchantId,t2.merchantName,t2.merchantFullName,t2.merchantType,t2.customerUscc,t1.mergeCustomerId,t1.mergeProjectId,t1.mergeCustomerName,t2.oneSubjectId,t2.oneSubjectName,t2.subjectId,t2.subjectFullId,t2.subjectName,t2.subjectFullName,t2.remain,t2.debitOcc,t2.creditOcc,t2.balance,t2.preRemain,t2.preDebitOcc,t2.preCreditOcc,t2.preBalance,t3.ara01,t3.ara02,t3.ara03,t3.ara04,t3.ara05,t3.ara06,t3.ara07,t3.ara08,t3.ara09,t3.ara10,t3.ara11,t3.ara12,t3.ara13,t3.ara14,t3.ara15,t3.ara16,t3.ara17,t3.ara18,t3.ara19,t3.ara20,t3.reason,t3.status,t3.isMerge,t5.subjectType1 as subjectType from bdo_dg.dg_merchantrelated t1 inner join bdo_dg.dg_merchantlist t2 on t1.uscc = t2.customerUscc and t1.customerId = t2.customerId and t1.projectId = t2.projectId and t2.yyyy = {lockYyyy} and t2.isMerge = 1 left join bdo_dg.dg_ara t3 on t2.customerId = t3.customerId and t2.projectId = t3.projectId and t3.isMerge = 1 and ((t2.merchantId = t3.subjectId and t2.merchantType=1 and t3.araId is null ) or (t2.merchantId = t3.araId and t2.merchantType=2 and t3.subjectId like CONCAT(t2.oneSubjectId,'%'))) left join bdo_dg.dg_tbsubjectcontract t4 on t2.customerId = t4.customerId and t2.projectId = t4.projectId and t2.oneSubjectId = t4.userSubjectId and t4.yyyy = {lockYyyy} left join bdo_dg.dg_projecttb t5 on t4.customerId = t5.customerId and t4.projectId = t5.projectId and t4.reportSubjectId = t5.reportSubjectId where t1.customerId = {lockCustomerId} AND t1.projectId = {lockProjectId}
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u5B58\u8D27\uFF09
DG40019=select t.autoId as autoId_A,t.mergeCustomerId,t.mergeCustomerName,t.classifyCode,t.insideAmount as insideAmount_A,t.tbSubjectCode as tbSubjectCode_A,t.tbSubjectName as tbSubjectName_A,t.subjectId as subjectId_A,t.subjectName as subjectName_A,t.curAmount as curAmount_A,t.fallingPrice as fallingPrice_A,t.groupId from bdo_dg.dg_merchantinside t WHERE t.customerId = {param1} AND t.projectId = {param2} and t.classifyCode = 'A' and t.isCur = '1'
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u7BA1\u7406\u8D39\u7528\uFF09
DG40020=select t.autoId as autoId_B,t.mergeCustomerId,t.mergeCustomerName,t.classifyCode,t.insideAmount as insideAmount_B,t.tbSubjectCode as tbSubjectCode_B,t.tbSubjectName as tbSubjectName_B,t.subjectId as subjectId_B,t.subjectName as subjectName_B,t.groupId from bdo_dg.dg_merchantinside t WHERE t.customerId = {param1} AND t.projectId = {param2} and t.classifyCode = 'B' and t.isCur = '1'
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u4E3B\u8425\u4E1A\u52A1\u9500\u552E\uFF09
DG40021=select t.autoId as autoId_C,t.mergeCustomerId,t.mergeCustomerName,t.classifyCode,t.insideAmount as insideAmount_C,t.tbSubjectCode as tbSubjectCode_C,t.tbSubjectName as tbSubjectName_C,t.grossMargin as grossMargin_C,t.groupId from bdo_dg.dg_merchantinside t WHERE t.customerId = {param1} AND t.projectId = {param2} and t.classifyCode = 'C' and t.isCur = '1'
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u5176\u4ED6\u4E1A\u52A1\u9500\u552E\uFF09
DG40022=select t.autoId as autoId_D,t.mergeCustomerId,t.mergeCustomerName,t.classifyCode,t.insideAmount as insideAmount_D,t.tbSubjectCode as tbSubjectCode_D,t.tbSubjectName as tbSubjectName_D,t.grossMargin as grossMargin_D,t.groupId from bdo_dg.dg_merchantinside t WHERE t.customerId = {param1} AND t.projectId = {param2} and t.classifyCode = 'D' and t.isCur = '1'
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u67E5\u8BE2\u6570\u636E\u6700\u591A\u7684\u5206\u7C7B\uFF09
DG40023=select t.classifyCode,count(1) cnt from bdo_dg.dg_merchantinside t where t.customerId = {param1} AND t.projectId = {param2} and t.isCur = '1' GROUP BY t.classifyCode order by COUNT(1) desc,classifyCode
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2
DG40024=select t.mergeCustomerId,t.mergeCustomerName,t.groupId,a.classifyCode,autoId_A,insideAmount_A,tbSubjectCode_A,tbSubjectName_A,subjectId_A,subjectName_A,curAmount_A,fallingPrice_A,autoId_B,insideAmount_B,tbSubjectCode_B,tbSubjectName_B,subjectId_B,subjectName_B,autoId_C,insideAmount_C,grossMargin_C,autoId_D,insideAmount_D,grossMargin_D from (select distinct t.groupId,t.mergeCustomerId,t.mergeCustomerName from bdo_dg.dg_merchantinside t where t.customerId = {param1} AND t.projectId = {param2} and t.classifyCode in ('A','B','C','D') and t.isCur = '1' and t.groupId is not null) t left join ({insideTableA}) a on t.groupId = a.groupId left join ({insideTableB}) b on t.groupId = b.groupId left join ({insideTableC}) c on t.groupId = c.groupId left join ({insideTableD}) d on t.groupId = d.groupId 
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u5B58\u8D27\u4E0B\u5E74\uFF09
DG40025=select t.mergeCustomerId,t.mergeCustomerName,t.groupId,t.classifyCode,t.classifyName,t.tbSubjectCode,t.tbSubjectName,t.subjectId,t.subjectName,t.subjectFullId,t.subjectFullName,t.curAmount as preAmount,t.insideAmount,t.insideType  from bdo_dg.dg_merchantinside t WHERE t.customerId = {param1} AND t.projectId = {param2} and t.classifyCode = 'A' and t.isCur = '1'
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u56FA\u5B9A\u8D44\u4EA7\uFF09
DG40026=select t.mergeCustomerId,t.mergeCustomerName,t.groupId,t.autoId,t.insideAmount,t.purchaseMethod,t.subjectId,t.subjectName,t.depreciationDate,t.depreciationYear,t.depreciationMethod,t.useSubjectId,t.useSubjectName,t.transferPrice,t.assetIncome,t.curWorkLoad from bdo_dg.dg_merchantinside t WHERE t.customerId = {param1} AND t.projectId = {param2} and t.classifyCode = 'E' and t.isCur = '1'
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u56FA\u5B9A\u8D44\u4EA7\u4E0B\u5E74\uFF09
DG40027=select t.mergeCustomerId,t.mergeCustomerName,t.groupId,t.classifyCode,t.classifyName,t.insideAmount,t.purchaseMethod,t.subjectId,t.subjectName,t.subjectFullId,t.subjectFullName,t.tbSubjectCode,t.tbSubjectName,t.depreciationDate,t.depreciationYear,t.depreciationMethod,t.useSubjectId,t.useSubjectName,t.transferPrice,t.assetIncome,t.curStatus,t.cleanDate,t.insideType,t.curWorkLoad from bdo_dg.dg_merchantinside t WHERE t.customerId = {param1} AND t.projectId = {param2} and t.classifyCode = 'E' and ((t.curStatus = '0' and t.isCur = '0' and t.cleanDate >= {param3}) or t.isCur = '1')
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u65E0\u5F62\u8D44\u4EA7\uFF09
DG40028=select t.mergeCustomerId,t.mergeCustomerName,t.groupId,t.autoId,t.insideAmount,t.subjectId,t.subjectName,t.depreciationDate,t.depreciationYear,t.useSubjectId,t.useSubjectName,t.transferPrice,t.assetIncome from bdo_dg.dg_merchantinside t WHERE t.customerId = {param1} AND t.projectId = {param2} and t.classifyCode = 'F' and t.isCur = '1'
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u65E0\u5F62\u8D44\u4EA7\u4E0B\u5E74\uFF09
DG40029=select t.mergeCustomerId,t.mergeCustomerName,t.groupId,t.classifyCode,t.classifyName,t.insideAmount,t.subjectId,t.subjectName,t.subjectFullId,t.subjectFullName,t.tbSubjectCode,t.tbSubjectName,t.depreciationDate,t.depreciationYear,t.useSubjectId,t.useSubjectName,t.curStatus,t.cleanDate,t.transferPrice,t.assetIncome,t.insideType from bdo_dg.dg_merchantinside t WHERE t.customerId = {param1} AND t.projectId = {param2} and t.classifyCode = 'F' and ((t.curStatus = '0' and t.isCur = '0' and t.cleanDate >= {param3}) or t.isCur = '1')
#\u5173\u8054\u65B9\u4E0B\u62C9
DG40030=select DISTINCT t1.uscc,t1.mergeCustomerId,t1.mergeProjectId,t1.mergeCustomerName,t1.mergeProjectName,t1.checkComplete,t1.checkMan as __ucheckManName,t1.checkTime,t1.checkReason,t1.tradeMan as __utradeManName,t1.tradeTime,t1.tradeComplete,t1.tradeCompleteMan as __utradeCompleteManName,t1.tradeCompleteTime,t1.tradeCompleteReason,case when t3.customerId is null and t4.customerId is null then '1' else '0' end as isShowComplete,t1.mergeScope from bdo_dg.dg_merchantrelated t1 /*START #param4# inner join bdo_dg.dg_merchantlist t2 on t1.uscc = t2.customerUscc and t1.customerId = t2.customerId and t1.projectId = t2.projectId and t2.yyyy = {lockYyyy} and t2.isMerge = 1 #param4# END*/ left join bdo_dg.dg_project t3 on t1.customerId = t3.customerId and t1.projectId = t3.projectId left join bdo_dg.dg_project t4 on t1.mergeCustomerId = t4.customerId and t1.mergeProjectId = t4.projectId where t1.customerId = {param1} and t1.projectId = {param2} AND t1.uscc IS NOT NULL /*START #param3# AND t1.uscc = '{param3}' #param3# END*/
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u5B58\u8D27\u4E0B\u5E74\uFF09
DG40031=select t.mergeCustomerId,t.mergeCustomerName,t.groupId,t.autoId,t.tbSubjectCode,t.tbSubjectName,t.subjectId,t.subjectName,t.curAmount,t.preAmount,t.fallingPrice from bdo_dg.dg_merchantinside t WHERE t.customerId = {param1} AND t.projectId = {param2} and t.classifyCode = 'A' and t.isCur = '0'
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u56FA\u5B9A\u8D44\u4EA7\u4E0B\u5E74\uFF09
DG40032=select t.mergeCustomerId,t.mergeCustomerName,t.groupId,t.autoId,t.insideAmount,t.purchaseMethod,t.subjectId,t.subjectName,t.depreciationDate,t.depreciationYear,t.depreciationMethod,t.useSubjectId,t.useSubjectName,t.transferPrice,t.assetIncome,t.curStatus,t.cleanDate,t.curWorkLoad from bdo_dg.dg_merchantinside t WHERE t.customerId = {param1} AND t.projectId = {param2} and t.classifyCode = 'E' and t.isCur = '0'
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u65E0\u5F62\u8D44\u4EA7\u4E0B\u5E74\uFF09
DG40033=select t.mergeCustomerId,t.mergeCustomerName,t.groupId,t.autoId,t.insideAmount,t.subjectId,t.subjectName,t.depreciationDate,t.depreciationYear,t.useSubjectId,t.useSubjectName,t.transferPrice,t.assetIncome,t.curStatus,t.cleanDate from bdo_dg.dg_merchantinside t WHERE t.customerId = {param1} AND t.projectId = {param2} and t.classifyCode = 'F' and t.isCur = '0'
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u6570\u636E\u6C60\uFF09
DG40034=select a.autoId as tradeId,a.customerId,a.projectId,a.mergeCustomerId,a.mergeProjectId,a.mergeCustomerName,a.uscc,a.merchantId,a.merchantType,a.subjectId,a.subjectFullId,a.subjectName,a.subjectFullName,a.insideAmount,a.tbSubjectCode,a.tbSubjectName,a.oneSubjectId,a.oneSubjectName,concat(a.subjectId,'-',a.subjectFullName) as subjectShowName,a.classifyCode,a.isEntry,a.relatedVoucher from bdo_dg.dg_merchanttrade a LEFT JOIN bdo_dg.dg_merchantinside b on a.customerId = b.customerId and a.projectId = b.projectId and a.autoId = b.tradeId where a.customerId = {param1} and a.projectId = {param2} and b.tradeId is null /*START #param3# AND a.subjectFullName LIKE '%{param3}%' #param3# END*/ /*START #param4# AND a.uscc = '{param4}' #param4# END*/ order by a.subjectId
#\u5185\u90E8\u4EA4\u6613\u67E5\u8BE2\uFF08\u5F53\u524D\u9875\u9762\u5C55\u793A\u7C7B\u578B\uFF09
DG40035=select a.insideType,a.fieldSort,a.classifySort,b.classifyCode,b.classifyName,b.fieldCode,b.fieldName,b.pageFieldType,b.dicCode,b.dataField,b.isCurrent as isCur,b.isCustomize,b.isEdit,b.mergeField from bdo_dg.dg_merchantuserclassify a inner join bdo_dg.dg_merchantclassify b on a.customerId = b.customerId and a.projectId = b.projectId and a.classifyCode = b.classifyCode and a.fieldCode = b.fieldCode where a.customerId = {param1} and a.projectId = {param2} /*START #param3# AND a.classifyCode = '{param3}' #param3# END*/ order by a.insideType,a.classifySort,a.fieldSort
#\u5185\u90E8\u4EA4\u6613\u67E5\u8BE2\uFF08\u67E5\u8BE2\u5206\u7C7B\uFF09
DG40036=select a.insideType,a.classifyCode from bdo_dg.dg_merchantuserclassify a where a.customerId = {param1} and a.projectId = {param2} /*START #param4# and a.insideType = {param4} #param4# END*/ /*START #param5# and a.classifyCode = '{param5}' #param5# END*/ group by a.insideType,a.classifyCode
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u5F71\u54CD\u8868\u5F53\u5E74\uFF09
DG40037=select a.autoId,a.customerId,a.projectId,a.mergeCustomerId,a.mergeProjectId,a.mergeCustomerName,a.uscc,a.insideType,a.classifyCode,a.classifyName,a.tbSubjectCode,a.tbSubjectName,a.oneSubjectId,a.oneSubjectName,a.subjectId,a.subjectFullId,a.subjectName,a.subjectFullName,a.groupId,a.isCur,a.tradeId,a.insideAmount,a.relatedVoucher,a.isEntry,a.colN1,a.colN2,a.colN3,a.colN4,a.colN5,a.colN6,a.colN7,a.colN8,a.colN9,a.colN10,a.colS1,a.colS2,a.colS3,a.colS4,a.colS5,a.colS6,a.colS7,a.colS8,a.colS9 from bdo_dg.dg_merchantinside a where a.customerId = {param1} and a.projectId = {param2} /*START #param3# AND a.classifyCode = '{param3}' #param3# END*/ /*START #param4# AND a.tradeId not in ({param4}) #param4# END*/ /*START #param5# AND a.insideType = '{param5}' #param5# END*/ /*START #param6# AND a.uscc = '{param6}' #param6# END*/ /*START #param7# AND a.subjectId in ({param7}) #param7# END*/ /*START #param8# AND a.isCur = {param8} #param8# END*/ /*START #param9# AND a.isEntry = {param9} #param9# END*/ /*START #param10# AND a.mergeCustomerId = {param10} #param10# END*/ /*START #param11# AND a.mergeProjectId = {param11} #param11# END*/ order by a.uscc,a.groupId
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u5F71\u54CD\u8868\u4E0A\u5E74\uFF09
DG40038=select a.autoId,a.customerId,a.projectId,a.mergeCustomerId,a.mergeProjectId,a.mergeCustomerName,a.uscc,a.insideType,a.classifyCode,a.classifyName,a.tbSubjectCode,a.tbSubjectName,a.oneSubjectId,a.oneSubjectName,a.subjectId,a.subjectFullId,a.subjectName,a.subjectFullName,a.groupId,a.isCur,a.tradeId,a.insideAmount,a.relatedVoucher,a.isEntry,a.colN1,a.colN2,a.colN3,a.colN4,a.colN5,a.colN6,a.colN7,a.colN8,a.colN9,a.colN10,a.colS1,a.colS2,a.colS3,a.colS4,a.colS5,a.colS6,a.colS7,a.colS8,a.colS9 from bdo_dg.dg_merchantinside a where a.customerId = {param1} and a.projectId = {param2} AND (a.classifyCode = '{param4}' or (a.classifyCode = '{param3}' and (t.{curStatus} = '1' or t.{cleanDate} >= {param5}))) order by a.autoId 
#\u5185\u90E8\u4EA4\u6613\u67E5\u8BE2\uFF08\u67E5\u8BE2\u5206\u7C7B\u4E0B\u62C9\uFF09
DG40039=select a.insideType,a.classifyCode,a.classifyName,IF(b.classifyCode is null,'0','1') as isSelect from bdo_dg.dg_merchantclassify a left join bdo_dg.dg_merchantuserclassify b on a.customerId = b.customerId and a.projectId = b.projectId and a.classifyCode = b.classifyCode and a.fieldCode = b.fieldCode and b.insideType = {param4} where a.customerId = {param1} and a.projectId = {param2} and a.isCurrent = 1 /*START #param3# AND a.isCustomize = '{param3}' #param3# END*/ group by a.insideType,a.classifyCode,a.classifyName
#\u5185\u90E8\u4EA4\u6613\u67E5\u8BE2\uFF08\u67E5\u8BE2\u5173\u8054\u65B9\u5BF9\u8D26\u660E\u7EC6\uFF09
DG40040=select * from (select a.autoId,a.customerId,a.projectId,a.mergeProjectId,a.mergeCustomerId,a.mergeProjectName,a.mergeCustomerName,a.yyyy,a.month,a.subjectId,a.assItemId,a.oldVoucherId,a.vchDate,a.adjustDate,a.vchTime,a.typeId,a.summary,a.serail,a.direction,a.occurValue,a.subjectName,a.subjectFullName,a.assItemName,a.assTotalName,a.debitsubjects,a.creditsubjects,a.oppositeAccountTop,a.oppositeAccountLast,a.checkSort,a.checkValue,a.entrySerail,ifnull(GROUP_CONCAT(b.checkEntrySerail SEPARATOR '{param9}'), '') AS checkEntrySerail from bdo_dg.dg_merchantcheck a left join bdo_dg.dg_merchantcheckrelated b on a.customerId = b.customerId and a.projectId = b.projectId and a.mergeCustomerId = b.mergeCustomerId and a.mergeProjectId = b.mergeProjectId and a.entrySerail = b.entrySerail where a.customerId = {param1} and a.projectId = {param2} and a.mergeCustomerId = {param3} and a.mergeProjectId = {param4} /*START #param5# AND a.subjectId = '{param5}' #param5# END*/ /*START #param6# AND a.month = {param6} #param6# END*/ group by a.entrySerail) a where 1=1 /*START #param7# AND a.checkEntrySerail <> '' #param7# END*/ /*START #param8# AND a.checkEntrySerail = '' #param8# END*/ order by a.vchDate is null,a.checkSort,a.vchDate
#\u5185\u90E8\u4EA4\u6613\u67E5\u8BE2\uFF08\u67E5\u8BE2\u5173\u8054\u65B9\u5BF9\u8D26\u5931\u6548\u7684\u5173\u8054\u6570\u636E\uFF09
DG40041=select a.autoId,a.customerId FROM bdo_dg.dg_merchantcheckrelated a left join bdo_dg.dg_merchantcheck b on a.customerId = b.customerId and a.projectId = b.projectId and a.mergeCustomerId = b.mergeCustomerId and a.mergeProjectId = b.mergeProjectId and a.entrySerail = b.entrySerail where a.customerId = {param1} and a.projectId = {param2} and a.mergeCustomerId = {param3} and a.mergeProjectId = {param4} and b.autoId is null
#\u5185\u90E8\u4EA4\u6613\u67E5\u8BE2\uFF08\u67E5\u8BE2\u5173\u8054\u65B9\u5BF9\u8D26\u5931\u6548\u7684\u5173\u8054\u6570\u636E\uFF09
DG40042=select a.autoId,a.customerId FROM bdo_dg.dg_merchantcheckrelated a left join bdo_dg.dg_merchantcheck b on a.customerId = b.mergeCustomerId and a.projectId = b.mergeProjectId and a.mergeCustomerId = b.customerId and a.mergeProjectId = b.projectId and a.checkEntrySerail = b.entrySerail where a.customerId = {param1} and a.projectId = {param2} and a.mergeCustomerId = {param3} and a.mergeProjectId = {param4} and b.autoId is null
#\u5173\u8054\u65B9\u5339\u914D\u67E5\u8BE2
DG40043=select a.autoId,a.mergeCustomerId,a.mergeProjectId,b.customerUscc,b.autoId as listId from bdo_dg.dg_merchantrelated a left join(select a.autoId,a.customerId,a.projectId,a.customerUscc,a.merchantName,b.customerName FROM bdo_dg.dg_merchantlist a INNER JOIN asdb.k_company b ON a.customerUscc = b.customerUscc WHERE a.customerId = {lockCustomerId} AND a.projectId = {lockProjectId} and a.yyyy = {lockYyyy} AND a.isMerge = 1) b on a.customerId = b.customerId and a.projectId = b.projectId and(a.mergeCustomerName = b.merchantName or a.mergeCustomerName = b.customerName) where a.customerId = {lockCustomerId} AND a.projectId = {lockProjectId} and a.uscc is null 
#\u67E5\u8BE2\u591A\u79D1\u76EE\u6302\u8D26\u6307\u5B9A\u7684\u76F8\u540C\u5BA2\u5546
DG40044=select distinct b.assItemId,c.autoId,c.customerId from bdo_fin.fin_assitemsame a inner join bdo_fin.fin_assitemsame b on a.customerId = b.customerId and a.yyyy = b.yyyy and a.assItemCustomerName = b.assItemCustomerName and b.assItemId <> '{param3}' inner join bdo_dg.dg_banklist c on b.assItemId = c.bankId and a.customerId = c.customerId and c.projectId = {param4} and c.bankType = '2' and c.isMerge = '1' where a.customerId = {param1} and a.yyyy = {param2} and a.assItemId = '{param3}' 
#\u67E5\u8BE2\u5BA2\u5546\u5217\u8868\u505A\u66F4\u65B0
DG40045=select * from bdo_dg.dg_merchantlist a where a.customerId = {param1} AND a.projectId = {param2} and a.yyyy = {lockYyyy} /*START #param3# AND a.customerUscc in ({param3}) #param3# END*/
#\u67E5\u8BE2\u5173\u8054\u65B9\u6570\u91CF
DG40046=select count(distinct t1.uscc) as relatedCount from bdo_dg.dg_merchantrelated t1 INNER JOIN bdo_dg.dg_merchantlist t2 ON t1.uscc = t2.customerUscc AND t1.customerId = t2.customerId AND t1.projectId = t2.projectId and t2.yyyy = {lockYyyy} AND t2.isMerge = 1 WHERE t1.customerId = {param1} AND t1.projectId = {param2}
#\u67E5\u8BE2\u5BA1\u8BA1\u8C03\u6574
DG40047=select a.autoId,a.customerId,a.projectId,a.yyyy,a.summary,a.assItemId,a.assItemName,a.indexId,a.subjectId,a.assItemId,a.occurValue,a.dirction,b.dCount,b.cCount,b.dSubject,b.cSubject,b.dSubjectNameTop,b.cSubjectNameTop,b.dSubjectNameLast,b.cSubjectNameLast,date_format(a.CREATION_DATE,'%Y-%m-%d') as adjustDate,a.oppSubjectJson from bdo_dg.dg_subjectentryadjust a inner join(select a.indexId,GROUP_CONCAT(distinct IF(a.dirction = 1,a.subjectId,null)) as dSubject,GROUP_CONCAT(distinct IF(a.dirction = -1,a.subjectId,null)) as cSubject,GROUP_CONCAT(distinct IF(a.dirction = 1,substring_index(a.subjectFullName1,'/',1),null)) as dSubjectNameTop,GROUP_CONCAT(distinct IF(a.dirction = -1,substring_index(a.subjectFullName1,'/',1),null)) as cSubjectNameTop,GROUP_CONCAT(distinct IF(a.dirction = 1,a.subjectFullName1,null)) as dSubjectNameLast,GROUP_CONCAT(distinct IF(a.dirction = -1,a.subjectFullName1,null)) as cSubjectNameLast,count(distinct IF(a.dirction = 1,a.subjectId,null)) as dCount,count(distinct IF(a.dirction = -1,a.subjectId,null)) as cCount from bdo_dg.dg_subjectentryadjust a inner join bdo_dg.dg_subjectentryadjust b on b.customerId={param1} and b.projectId={param2} /*START #param6# and b.yyyy={param6} #param6# END*/ and b.status = '1' /*START #param3# and b.subjectId = '{param3}' #param3# END*/ /*START #param4# and b.subjectId like '{param3}%' and b.assItemId = '{param4}' #param4# END*/ /*START #param5# and b.assItemId = '{param5}' #param5# END*/ and a.indexId = b.indexId WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param6# and a.yyyy={param6} #param6# END*/ and a.status = '1' group by a.indexId) b on a.indexId = b.indexId WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param6# and a.yyyy={param6} #param6# END*/ and a.status = '1' /*START #param7# and a.subjectId = '{param7}' #param7# END*/ /*START #param5# and a.assItemId = '{param5}' #param5# END*/ order by a.indexId,a.dirction,a.subjectId 
#\u5185\u90E8\u4EA4\u6613\u67E5\u8BE2\uFF08\u67E5\u8BE2\u4F59\u989D\u8868\u5173\u8054\u65B9\u5BF9\u8D26\u660E\u7EC6\uFF09
DG40048=select a.autoId,a.customerId,a.projectId,a.mergeProjectId,a.mergeCustomerId,a.mergeProjectName,a.mergeCustomerName,a.subjectId,a.subjectName,a.oppositeSubjectId,a.oppositeSubjectName,a.remain,a.debitOcc,a.creditOcc,a.balance,a.debitAdjust,a.creditAdjust,a.checkValue,a.relatedVoucher,a.direction,a.level,case when (a.debitAdjust is not null or a.creditAdjust is not null) and a.level = 1 then if(a.direction = 1,IFNULL(a.debitAdjust,0) - IFNULL(a.creditAdjust,0),IFNULL(a.creditAdjust,0) - IFNULL(a.debitAdjust,0)) else null end as balanceAdjust,case when (a.debitAdjustRemain is not null or a.creditAdjustRemain is not null) and a.level = 1 then if(a.direction = 1,IFNULL(a.debitAdjustRemain,0) - IFNULL(a.creditAdjustRemain,0),IFNULL(a.creditAdjustRemain,0) - IFNULL(a.debitAdjustRemain,0)) else null end as remainAdjust from bdo_dg.dg_merchantcheckacc a where a.customerId = {param1} and a.projectId = {param2} and a.mergeCustomerId = {param3} and a.mergeProjectId = {param4} and a.level = {param5} /*START #param6# and a.oppositeSubjectId like '%,%' #param6# END*/ order by a.subjectId,a.level
#\u5185\u90E8\u4EA4\u6613\u67E5\u8BE2\uFF08\u67E5\u8BE2\u5173\u8054\u65B9\u5BF9\u8D26\u79D1\u76EE\uFF09
DG40049=select distinct a.subjectId,a.subjectName,a.subjectFullName from bdo_dg.dg_merchantcheck a where a.customerId = {param1} and a.projectId = {param2} and a.mergeCustomerId = {param3} and a.mergeProjectId = {param4} order by a.subjectId
#\u5185\u90E8\u4EA4\u6613\u67E5\u8BE2\uFF08\u67E5\u8BE2\u79D1\u76EE\u8BBE\u7F6E\uFF09
DG40050=select a.autoId,a.customerId,a.projectId,a.subjectId,a.subjectFullId,a.subjectName,a.subjectFullName,a.parentSubjectId,a.isLeaf,a.level,a.classifyCode,a.summaryLevel,GROUP_CONCAT(b.subjectId) as subjectChildren from bdo_dg.dg_merchantsubjectset a left join bdo_dg.dg_merchantsubjectset b on a.customerId = b.customerId and a.projectId = b.projectId and b.subjectFullId like CONCAT(a.subjectFullId,'/%') where a.customerId = {param1} and a.projectId = {param2} /*START #param3# and a.classifyCode is not null #param3# END*/ /*START #param4# and a.isChange = 1 #param4# END*/ group by a.subjectId order by a.subjectId,a.level
#\u5185\u90E8\u4EA4\u6613\u67E5\u8BE2\uFF08\u67E5\u8BE2\u4E2D\u95F4\u6570\u636E\u6C60\uFF09
DG40051=select a.autoId,a.customerId,a.projectId,a.mergeCustomerId,a.mergeProjectId,a.mergeCustomerName,a.uscc,a.merchantId,a.merchantType,a.subjectId,a.subjectFullId,a.subjectName,a.subjectFullName,a.insideAmount,a.tbSubjectCode,a.tbSubjectName,a.oneSubjectId,a.oneSubjectName,a.totalId,a.relatedVoucher,b.subjectName as totalSubjectName,b.subjectFullName as totalSubjectFullName,b.insideAmount as totalInsideAmount from bdo_dg.dg_merchanttrademid a LEFT JOIN bdo_dg.dg_merchanttrademid b on a.customerId = b.customerId and a.projectId = b.projectId and a.totalId = b.autoId where a.customerId = {param1} and a.projectId = {param2} and a.isDetail = 1 /*START #param3# AND a.totalId is not null #param3# END*/ /*START #param4# AND a.uscc in ({param4}) #param4# END*/ /*START #param5# AND a.totalId in ({param5}) #param5# END*/ /*START #param6# AND a.subjectId in ({param6}) #param6# END*/ order by a.uscc,a.totalId
#\u5185\u90E8\u4EA4\u6613\u67E5\u8BE2\uFF08\u67E5\u8BE2\u4E2D\u95F4\u6570\u636E\u6C60\u5408\u8BA1\u6821\u9A8C\u4E0D\u901A\u8FC7\u7684\uFF09
DG40052=select a.totalId from (select a.totalId,sum(a.insideAmount) as totalAmount,b.insideAmount from bdo_dg.dg_merchanttrademid a LEFT JOIN bdo_dg.dg_merchanttrademid b on a.customerId = b.customerId and a.projectId = b.projectId and a.totalId = b.autoId where a.customerId = {param1} and a.projectId = {param2} and a.isDetail = 1 /*START #param3# AND a.totalId is not null #param3# END*/ /*START #param4# AND a.uscc in ({param4}) #param4# END*/ group by a.totalId) a where a.totalAmount <> a.insideAmount
#\u67E5\u8BE2\u5BA1\u8BA1\u8C03\u6574\u660E\u7EC6
DG40053=SELECT '2' AS type,a.subjectId,a.subjectFullName1 as subjectFullName,a.vchDate,a.voucherId,a.autoId,a.summary,a.indexId as oldVoucherId,IF(a.dirction=1,a.occurValue,0) AS debitOcc,IF(a.dirction=-1,a.occurValue,0) AS creditOcc,a.currRate,a.currValue,a.currency FROM bdo_dg.dg_subjectentryadjust a WHERE a.customerId={lockCustomerId} AND a.projectId={lockProjectId} AND a.indexId='{param2}' order by a.autoId
#\u5185\u90E8\u4EA4\u6613\u67E5\u8BE2\uFF08\u67E5\u8BE2\u5185\u90E8\u4EA4\u6613\u4E2D\u95F4\u8868\u5168\u90E8\u79D1\u76EE\uFF09
DG40054=select distinct a.subjectId,a.subjectFullId from bdo_dg.dg_merchanttrademid a where a.customerId = {param1} and a.projectId = {param2} and a.isDetail = 1 /*START #param3# and a.isChange = 1 #param3# END*/ /*START #param4# AND a.uscc in ({param4}) #param4# END*/
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u6570\u636E\u6C60\uFF09
DG40055=select a.autoId,a.customerId,a.projectId,a.mergeCustomerId,a.mergeProjectId,a.mergeCustomerName,a.uscc,a.merchantId,a.merchantType,a.subjectId,a.subjectFullId,a.subjectName,a.subjectFullName,a.insideAmount,a.tbSubjectCode,a.tbSubjectName,a.oneSubjectId,a.oneSubjectName,concat(a.subjectId,'-',a.subjectFullName) as subjectShowName,a.classifyCode,CONCAT(a.vchDate,'|',a.oldVoucherId,'|',a.serail,'|',a.typeId) as entrySerail from bdo_dg.dg_merchanttrade a where a.customerId = {param1} and a.projectId = {param2} /*START #param3# AND a.subjectId in ({param3}) #param3# END*/ /*START #param4# AND a.uscc = '{param4}' #param4# END*/ /*START #param5# AND CONCAT(a.vchDate,'|',a.oldVoucherId,'|',a.serail,'|',a.typeId) in ({param5}) #param5# END*/ /*START #param6# AND a.isEntry = {param6} #param6# END*/ order by a.subjectId
#\u67E5\u8BE2\u5BA2\u5546\u6570\u636E(\u5408\u8BA1)
DG40056=select sum(a.remain) as remain,sum(a.debitOcc) as debitOcc,sum(a.creditOcc) as creditOcc,sum(a.balance) as balance from bdo_dg.dg_merchantlist a where a.customerId = {lockCustomerId} and a.projectId = {lockProjectId} and a.yyyy = {lockYyyy} and a.isMerge = 1 /*START #param3# and a.merchantName like '%{param3}%' #param3# END*/ /*START #param4# and a.isSampling = {param4} #param4# END*/ /*START #param5# and a.customerUscc = '{param5}' #param5# END*/ /*START #param6# and a.subjectFullName like '%{param6}%' #param6# END*/ /*START #param7# and a.subjectFullId like '{param7}%' #param7# END*/ /*START #param9# and (a.customerUscc is null or a.customerUscc = '') #param9# END*/ /*START #param10# and (a.remain <> 0 or a.debitOcc <> 0 or a.creditOcc <> 0 or a.balance <> 0) #param10# END*/
#\u67E5\u8BE2\u5173\u8054\u65B9\u5BF9\u8D26\u7684\u5173\u8054\u6570\u636E
DG40057=select a.autoId,a.customerId,a.entrySerail,a.checkEntrySerail FROM bdo_dg.dg_merchantcheckrelated a where a.customerId = {param1} and a.projectId = {param2} and a.mergeCustomerId = {param3} and a.mergeProjectId = {param4} /*START #param5# and a.entrySerail in ({param5}) #param5# END*/ /*START #param6# and a.checkEntrySerail in ({param6}) #param6# END*/
#\u67E5\u8BE2\u8D44\u4EA7\u8D1F\u503A\u8868\u79D1\u76EE\u4E2D\u6587\u5B57\u5E26  \u6536\u3001\u4ED8\u7684\u4E00\u7EA7\u79D1\u76EE
DG40058=select a.userSubjectId from bdo_dg.dg_tbsubjectcontract a inner join asdb.k_reporttemplate b on a.vocationId = b.vocationId and a.reportSubjectId = b.colCode and b.tableDiv in (1,2) where a.customerId = {lockCustomerId} and a.projectId = {lockProjectId} and a.yyyy = {lockYyyy} and (a.reportSubjectName like '%\u6536%' or a.reportSubjectName like '%\u4ED8%')
#\u67E5\u8BE2\u624B\u52A8\u6DFB\u52A0\u5230\u5185\u90E8\u4EA4\u6613\u6570\u636E\u6C60\u7684\u6570\u636E
DG40059=SELECT CONCAT(vchDate,'|',oldVoucherId,'|',serail,'|',typeId) as voucherId FROM bdo_dg.dg_merchanttrade a where a.customerId = {customerId} and a.projectId = {projectId} and a.isEntry = '1' /*START #param1# and CONCAT(vchDate,'|',oldVoucherId,'|',serail,'|',typeId) in ({param1}) #param1# END*/ /*START #param3# AND a.vchDate >= '{param3}' #param3# END*/ /*START #param4# AND a.vchDate <= '{param4}' #param4# END*/ /*START #param5# AND a.subjectId LIKE '{param5}%' #param5# END*/ /*START #param7# AND a.typeId='{param7}' #param7# END*/ /*START #param8# AND a.oldVoucherId='{param8}' #param8# END*/ /*START #param9# {param9} #param9# END*/ /*START #param10# AND a.assItemId LIKE '{param10}%' #param10# END*/ /*START #param11# and a.direction = {param11} #param11# END*/
#\u67E5\u8BE2\u9700\u5220\u9664\u7684\u5185\u90E8\u4EA4\u6613\u6570\u636E
DG40060=SELECT a.autoId,a.customerId from bdo_dg.dg_merchantinside a where a.customerId = {param1} and a.projectId = {param2} /*START #param3# AND a.tradeId in ({param3}) #param3# END*/
#\u5185\u90E8\u4EA4\u6613\u67E5\u8BE2\uFF08\u67E5\u8BE2\u5173\u8054\u65B9\u5BF9\u8D26\u7EDF\u8BA1\uFF09
DG40061=select ifnull(sum(occurValue),0) as occurValue,ifnull(sum(checkValue),0) as checkValue,(ifnull(sum(checkValue),0) - ifnull(sum(occurValue),0)) as differenceValue,sum(case when checkEntrySerail is null then 0 else 1 end) AS relatedCount,sum(case when checkEntrySerail is null then 1 else 0 end) AS unRelatedCount from (SELECT occurValue,checkValue,GROUP_CONCAT(b.checkEntrySerail SEPARATOR '{param9}') as checkEntrySerail from bdo_dg.dg_merchantcheck a left join bdo_dg.dg_merchantcheckrelated b on a.customerId = b.customerId and a.projectId = b.projectId and a.mergeCustomerId = b.mergeCustomerId and a.mergeProjectId = b.mergeProjectId and a.entrySerail = b.entrySerail where a.customerId = {param1} and a.projectId = {param2} and a.mergeCustomerId = {param3} and a.mergeProjectId = {param4} group by a.autoId) a
#\u67E5\u8BE2dg_customersubject\u8868\u79D1\u76EE
DG40062=select subjectId from bdo_dg.dg_customersubject a where a.customerId = {customerId} and a.projectId = {projectId} and a.yyyy = {yyyy} and a.parentSubjectId in ({subjectId}) and a.userDefined = '1'
#\u67E5\u8BE2\u542B\u6838\u7B97\u7684\u8C03\u6574
DG40063=select a.customerId,a.projectId,a.subjectId,a.assItemId from bdo_dg.dg_subjectentryadjust a where a.customerId = {customerId} and a.projectId = {projectId} and a.yyyy = {yyyy} and a.status = '1' and a.assItemId is not null
#\u67E5\u8BE2\u76F8\u540C\u5BA2\u5546
DG40064=select distinct a.merchantId,a.merchantName,a.customerUscc,a.mergeCustomerId,a.mergeProjectId from bdo_dg.dg_merchantlist a where a.customerId = {customerId} and a.projectId = {projectId} and a.yyyy = {lockYyyy} and a.isMerge = '1' and a.customerUscc is not null and a.customerUscc <> '' /*START #param1# and a.merchantType = '1' and a.merchantName in ({param1}) #param1# END*/ /*START #param2# and a.merchantType = '2' and a.merchantId in ({param2}) #param2# END*/
#\u67E5\u8BE2\u5173\u8054\u65B9\u5BF9\u8D26\u662F\u5426\u521D\u59CB\u5316
DG40065=select count(1) as totalCount, a.mergeCustomerId,a.mergeProjectId from bdo_dg.dg_merchantcheck a where a.customerId = {customerId} and a.projectId = {projectId} group by a.customerId,a.projectId,a.mergeCustomerId,a.mergeProjectId
#\u67E5\u8BE2\u6240\u6709\u5173\u8054\u65B9\u5BF9\u8D26\u8C03\u6574\u6570\u636E
DG40066=select a.autoId,a.customerId,a.checkSort,a.checkValue,a.entrySerail from bdo_dg.dg_merchantcheck a where a.customerId = {customerId} and a.projectId = {projectId} and a.adjustDate is not null
#\u5185\u90E8\u4EA4\u6613\u67E5\u8BE2\uFF08\u4EA4\u6613\u5206\u7C7B\u6811\uFF09
DG40067=select a.insideType,a.classifySort,b.classifyCode,b.classifyName,b.isCurrent as isCur,b.isCustomize,'1' as leaf from bdo_dg.dg_merchantuserclassify a inner join bdo_dg.dg_merchantclassify b on a.customerId = b.customerId and a.projectId = b.projectId and a.classifyCode = b.classifyCode and a.fieldCode = b.fieldCode where a.customerId = {param1} and a.projectId = {param2} /*START #param3# AND a.classifyCode = '{param3}' #param3# END*/ and b.isCurrent = 1 group by b.classifyCode order by a.insideType,a.classifySort
#\u5185\u90E8\u4EA4\u6613\u67E5\u8BE2\uFF08\u4EA4\u6613\u5206\u7C7B\uFF09
DG40068=SELECT a.classifyCode,a.tradeType FROM bdo_dg.dg_merchantclassify a where a.customerId = {param1} and a.projectId = {param2} and a.isCurrent = 1 group by a.classifyCode
#\u5185\u90E8\u4EA4\u6613\u67E5\u8BE2\uFF08\u5185\u90E8\u4EA4\u6613\u6821\u9A8C\uFF09
DG40069=select a.mergeCustomerId,a.mergeProjectId,sum(case when a.classifyCode in ({param5}) then ifnull(a.insideAmount,0) else 0 end) as debitAmount,sum(case when a.classifyCode in ({param6}) then ifnull(a.insideAmount,0) else 0 end) as creditAmount from bdo_dg.dg_merchantinside a where a.customerId = {param1} and a.projectId = {param2} /*START #param3# AND a.mergeCustomerId = {param3} #param3# END*/ /*START #param4# AND a.mergeProjectId = {param4} #param4# END*/ group by a.mergeCustomerId,a.mergeProjectId
#\u5185\u90E8\u4EA4\u6613\u67E5\u8BE2\uFF08\u5185\u90E8\u4EA4\u6613\u5206\u7C7B\u603B\u6570\uFF09
DG40070=select a.insideType,a.classifyCode,count(1) as dataNum FROM bdo_dg.dg_merchantinside a where a.customerId = {param1} and a.projectId = {param2} /*START #param3# AND a.mergeCustomerId = {param3} #param3# END*/ /*START #param4# AND a.mergeProjectId = {param4} #param4# END*/ group by a.insideType,a.classifyCode
#\u67E5\u8BE2\u8C03\u6574\u6570\u636E
DG40071=select a.autoId,a.customerId,a.projectId,a.yyyy,a.summary,a.assItemId,a.assItemName,a.indexId as oldVoucherId,a.autoId as serail,a.subjectId,a.subjectname1 as subjectName,a.subjectFullName1 as subjectFullName,a.occurValue,a.dirction,IF(a.dirction < 0, a.occurValue, '') AS creditValue,IF(a.dirction > 0, a.occurValue, '') AS debitValue,a.oppSubjectJson,case when b.autoId is not null then '1' else 0 end as isAdd from bdo_dg.dg_subjectentryadjust a left join bdo_dg.dg_merchanttrade b on b.customerId = {param1} and b.projectId = {param2} and b.isEntry = '2' and a.customerId = b.customerId and a.projectId = b.projectId and a.indexId = b.oldVoucherId and a.autoId = b.serail where a.customerId = {param1} and a.projectId = {param2} and a.status = '1' /*START #param3# AND a.subjectId in ({param3}) #param3# END*/ /*START #param4# AND a.assItemId like '{param4}%' #param4# END*/ /*START #param5# AND b.autoId is not null #param5# END*/ /*START #param6# AND a.indexId = '{param6}' #param6# END*/ /*START #param7# AND a.indexId in ({param7}) #param7# END*/ and a.yyyy = {param8} group by a.autoId order by a.indexId
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u6570\u636E\u6C60\u8C03\u6574\u6570\u636E\uFF09
DG40072=select a.autoId,a.customerId,a.projectId,CONCAT(a.oldVoucherId,'|',a.serail) as entrySerail from bdo_dg.dg_merchanttrade a where a.customerId = {param1} and a.projectId = {param2} AND a.isEntry = '2' /*START #param3# AND CONCAT(a.oldVoucherId,'|',a.serail) in ({param3}) #param3# END*/ /*START #param4# AND a.relatedVoucher in ({param4}) #param4# END*/
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u624B\u52A8\u6DFB\u52A0\u6570\u636E\uFF09
DG40073=select a.autoId,a.customerId from bdo_dg.dg_merchanttrade a where a.customerId = {param1} and a.projectId = {param2} and a.autoId in ({param3})
#\u5185\u90E8\u4EA4\u6613\u660E\u7EC6\u67E5\u8BE2\uFF08\u4E3B\u8425\u4E1A\u52A1\u9500\u552E,\u5176\u4ED6\u4E1A\u52A1\u9500\u552E\uFF09
DG40074=select GROUP_CONCAT(a.autoId) as autoId,a.customerId,a.projectId,a.mergeCustomerId,a.mergeProjectId,a.mergeCustomerName,a.uscc,a.insideType,a.classifyCode,a.classifyName,a.tbSubjectCode,a.tbSubjectName,a.oneSubjectId,a.oneSubjectName,a.subjectId,a.subjectFullId,a.subjectName,a.subjectFullName,a.groupId,a.isCur,a.tradeId,sum(a.insideAmount) as insideAmount,a.relatedVoucher,a.isEntry,a.colN1,sum(a.colN2) as colN2,sum(a.colN3) as colN3,sum(a.colN4) as colN4,sum(a.colN5) as colN5,sum(a.colN6) as colN6,sum(a.colN7) as colN7,sum(a.colN8) as colN8,sum(a.colN9) as colN9,sum(a.colN10) as colN10,a.colS1,a.colS2,a.colS3,a.colS4,a.colS5,a.colS6,a.colS7,a.colS8,a.colS9 from bdo_dg.dg_merchantinside a where a.customerId = {param1} and a.projectId = {param2} /*START #param3# AND a.classifyCode = '{param3}' #param3# END*/ /*START #param4# AND a.tradeId not in ({param4}) #param4# END*/ /*START #param5# AND a.insideType = '{param5}' #param5# END*/ /*START #param6# AND a.uscc = '{param6}' #param6# END*/ /*START #param7# AND a.subjectId in ({param7}) #param7# END*/ /*START #param8# AND a.isCur = {param8} #param8# END*/ /*START #param9# AND a.isEntry = {param9} #param9# END*/ /*START #param10# AND a.mergeCustomerId = {param10} #param10# END*/ /*START #param11# AND a.mergeProjectId = {param11} #param11# END*/ group by a.uscc,a.subjectId,a.colN1 order by a.uscc,a.groupId
#\u67E5\u8BE2\u73B0\u6709\u5BF9\u8D26\u5173\u8054\u65B9
DG40075=select mergeCustomerId,mergeProjectId from bdo_dg.dg_merchantcheckacc a where a.customerId = {param1} and a.projectId = {param2} group by mergeCustomerId,mergeProjectId
#\u67E5\u8BE2\u73B0\u6709\u4EA4\u6613\u5173\u8054\u65B9
DG40076=select uscc from bdo_dg.dg_merchanttrade a where a.customerId = {param1} and a.projectId = {param2} group by uscc
#\u67E5\u8BE2\u8C03\u6574\u6570\u636E\u5408\u8BA1\u884C
DG40077=select '\u5408\u8BA1' AS subjectName, sum(creditValue) AS creditValue, sum(debitValue) AS debitValue from (select a.autoId,a.customerId,a.projectId,a.yyyy,a.summary,a.assItemId,a.assItemName,a.indexId as oldVoucherId,a.autoId as serail,a.subjectId,a.subjectname1 as subjectName,a.subjectFullName1 as subjectFullName,a.occurValue,a.dirction,IF(a.dirction < 0, a.occurValue, '') AS creditValue,IF(a.dirction > 0, a.occurValue, '') AS debitValue,a.oppSubjectJson,case when b.autoId is not null then '1' else 0 end as isAdd from bdo_dg.dg_subjectentryadjust a left join bdo_dg.dg_merchanttrade b on b.customerId = {param1} and b.projectId = {param2} and b.isEntry = '2' and a.customerId = b.customerId and a.projectId = b.projectId and a.indexId = b.oldVoucherId and a.autoId = b.serail where a.customerId = {param1} and a.projectId = {param2} and a.status = '1' /*START #param3# AND a.subjectId in ({param3}) #param3# END*/ /*START #param4# AND a.assItemId like '{param4}%' #param4# END*/ /*START #param5# AND b.autoId is not null #param5# END*/ /*START #param6# AND a.indexId = '{param6}' #param6# END*/ /*START #param7# AND a.indexId in ({param7}) #param7# END*/ and a.yyyy = {param8} group by a.autoId) a
#\u67E5\u8BE2\u5185\u90E8\u4EA4\u6613\u79D1\u76EE\u5BF9\u7167\u8BBE\u7F6E
DG40078=select a.classifyCode,a.isLeafSummary,b.userSubjectId,b.level0 from asdb.k_merchantsubjectclassify a inner join bdo_dg.dg_tbsubjectcontract b on (a.reportSubjectId = b.reportSubjectId or a.userSubjectName = b.userSubjectName) and a.direction = b.direction and b.yyyy = {yyyy} where b.customerId = {customerId} and b.projectId = {projectId} 
#\u67E5\u8BE2\u542B\u5173\u8054\u65B9\u7684\u8C03\u6574\u6570\u636E
DG40079=select distinct a.indexId from bdo_dg.dg_subjectentryadjust a inner join bdo_dg.dg_merchantlist b on a.customerId = b.customerId and a.projectId = b.projectId and b.isMerge = '1' and b.customerUscc = '{param3}' and ((a.subjectId = b.merchantId and b.merchantType = '1') or (a.assItemId = b.merchantId and b.merchantType = '2')) where a.customerId = {param1} and a.projectId = {param2} and a.yyyy = {param4} and a.status = '1'
####################\u5BA1\u8BA1\u5E73\u53F0\u5F80\u6765#####################
####################\u5BA1\u8BA1\u5E73\u53F0\u94F6\u884C#####################
#\u67E5\u8BE2\u94F6\u884C\u8303\u56F4
DG50001=select a.subjectId,a.subjectName,a.subjectIsBank as subjectIsMerchant,a.assitemIsBank as assitemIsMerchant,GROUP_CONCAT(a.assItemId) as assItemId,GROUP_CONCAT(a.assItemName) as assItemName from bdo_dg.dg_bankrange a where a.customerId = {param1} and a.projectId = {param2} group by a.subjectId,a.subjectName,a.subjectIsBank,a.assitemIsBank order by a.subjectId
#\u67E5\u8BE2\u94F6\u884C\u5217\u8868
DG50002=select distinct a.autoId,a.customerId,a.projectId,a.bankId,a.bankName,a.bankFullName,a.bankType,a.customerUscc,a.companyName as customerName,a.companyEnName as customerEnName,a.officeAddress,a.registeredAddress,a.baiduAddress,a.telephone,a.areaPlace,a.industrycategory,a.industrycategorycode,a.industryclassification,a.industryclassificationcode,a.registerAmount,a.subjectId,a.subjectFullId,a.subjectName,a.subjectFullName,a.remain,a.debitOcc,a.creditOcc,a.balance,IF(c.remain <> 0 and c.remain is not null,CONCAT(ROUND(a.remain * 100/c.remain,2),'%'),'-') as remainRate,IF(c.debitOcc <> 0 and c.debitOcc is not null,CONCAT(ROUND(a.debitOcc * 100/c.debitOcc,2),'%'),'-') as debitOccRate,IF(c.creditOcc <> 0 and c.creditOcc is not null,CONCAT(ROUND(a.creditOcc * 100/c.creditOcc,2),'%'),'-') as creditOccRate,IF(c.balance <> 0 and c.balance is not null,CONCAT(ROUND(a.balance * 100/c.balance,2),'%'),'-') as balanceRate,a.checkStatus,case when checkStatus = '0' then '\u672A\u6838\u5BF9' when checkStatus = '1' then '\u6838\u5BF9\u4E2D' when checkStatus = '2' then '\u5DF2\u6838\u5BF9' else checkStatus end as checkStatusName, a.checkResult,a.checkTime,a.month1,a.month2,a.month3,a.month4,a.month5,a.month6,a.month7,a.month8,a.month9,a.month10,a.month11,a.month12,a.total,d.interestRate,a.checkFileFullPath,a.checkFileName from bdo_dg.dg_banklist a left join asdb.k_company b on a.customerUscc = b.customerUscc LEFT JOIN (select customerId,sum(remain) remain,sum(debitOcc) debitOcc,sum(creditOcc) creditOcc,sum(balance) balance from bdo_dg.dg_banklist WHERE customerId = {lockCustomerId} AND projectId = {lockProjectId}) c on a.customerId = c.customerId left join (select d.customerId,d.projectId,d.bankId,GROUP_CONCAT(ROUND(d.interestRate,2),'(',d.startDate,'~',d.endDate,')' ORDER BY startDate) as interestRate from bdo_dg.dg_bankinterestrate d where d.customerId = {lockCustomerId} and d.projectId = {lockProjectId} group by d.customerId,d.projectId,d.bankId) d on a.customerId = d.customerId and a.autoId = d.bankId where a.customerId = {lockCustomerId} and a.projectId = {lockProjectId} and a.isMerge = 1 /*START #param3# and a.bankName like '%{param3}%' #param3# END*/ /*START #param4# and a.customerUscc = '{param4}' #param4# END*/ /*START #param5# and a.checkStatus = '{param5}' #param5# END*/ order by a.bankId
#\u67E5\u8BE2\u5339\u914D\u6570\u636E
DG50003=select a.autoId,a.customerId,a.bankName,max(b.customerUscc) as customerUscc /*START #param4# ,max(c.customerUscc) as lastUscc #param4# END*/ from bdo_dg.dg_banklist a left join asdb.k_company b on a.bankName = b.customerName /*START #param4# left join bdo_dg.dg_banklist c on a.bankId = c.bankId and a.bankType = c.bankType and c.customerId = {param3} AND c.projectId = {param4} and c.isMerge = 1 and c.customerUscc is not null #param4# END*/ where a.customerId = {param1} and a.projectId = {param2} and a.isMerge = 1 and (a.customerUscc is null or a.customerUscc ='') /*START #param5# and a.bankId = '{param5}' #param5# END*/ group by a.autoId,a.customerId,a.bankName
#\u67E5\u8BE2\u5339\u914D\u767E\u5EA6\u5730\u5740\u6570\u636E
DG50004=select distinct b.companyId,b.customerUscc,b.customerName from bdo_dg.dg_banklist a inner join asdb.k_company b on a.customerUscc = b.customerUscc where a.customerId = {param1} and a.projectId = {param2} and a.customerUscc is not null and a.isMerge = 1 and b.baiduAddress is null
#\u67E5\u8BE2\u5339\u914D\u6570\u91CF
DG50005=select count(1) as totalCount,ifnull(sum(case when a.customerUscc is not null and a.customerUscc <> '' then 1 else 0 end),0) as matchCount from bdo_dg.dg_banklist a where a.customerId = {param1} and a.projectId = {param2} and a.isMerge = 1
#\u67E5\u8BE2\u94F6\u884C\u5BF9\u8D26\u5355
DG50006=select autoId,customerId,projectId,fileIndexId,fileName,uploadDate,bankId from bdo_dg.dg_bankfile a where a.customerId = {param1} and a.projectId = {param2} /*START #param3# and a.bankId = {param3} #param3# END*/ order by a.sortNum
DG50007=SELECT * FROM bdo_dg.dg_banklist a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.merchantType = {param3} AND a.merchantId IN ({param4}) and a.isMerge = 1
DG50008=select * from bdo_dg.dg_banklist where autoId in ({param1})
####################\u5BA1\u8BA1\u5E73\u53F0\u94F6\u884C#####################
####################\u5BA1\u8BA1\u5E73\u53F0\u751F\u6210\u5E95\u7A3F#####################

############################# \u5408\u5E76\u529F\u80FD #############################
DG00267=SELECT subjectId, subjectName, curAmount, preAmount FROM bdo_hb.hb_mergesummary WHERE projectId = {param1} AND customerId = {param2} AND mergeProjectId = {param3} AND summaryType = {param4} AND ACTIVE_FLAG = '1' ORDER BY sortNo
DG00260=SELECT autoId,isUnitChildProject, mergeCustomerId, mergeCustomerName, mergeProjectId, mergeProjectName, mergeFinanceReportType FROM bdo_hb.hb_mergeproject WHERE customerId = {param1} AND projectId = {param2} AND ACTIVE_FLAG = '1' ORDER BY mergeCustomerId, mergeProjectId
DG00261=SELECT b.autoId,a.customerId,a.projectId,a.customerName,a.projectName FROM bdo_dg.dg_project a,bdo_hb.hb_mergeproject b WHERE a.customerId = b.customerId AND a.projectId = b.projectId AND b.mergeCustomerId = {param1} AND b.mergeProjectId = {param2} ORDER BY a.customerId,a.projectId 
DG00266=SELECT subjectId, subjectName, unAuditAmount, adjustAmount, auditAmount, preUnAuditAmount, preAdjustAmount, preAuditAmount FROM bdo_hb.hb_mergesummary WHERE projectId = {projectId} AND customerId = {customerId} AND mergeProjectId = {mergeProjectId} AND summaryType = 0 AND ACTIVE_FLAG = '1' ORDER BY sortNo
#20200103\u53D8\u66F4\u67E5\u8BE2\u6761\u4EF6summaryType = 1\u4E3AsummaryType = {param4}
DG00268=SELECT subjectId, unAuditAmount, adjustAmount, auditAmount, preUnAuditAmount, preAdjustAmount, preAuditAmount FROM bdo_hb.hb_mergesummary WHERE projectId = {projectId} AND customerId = {customerId} AND mergeProjectId = {mergeProjectId} AND summaryType = 0 AND subjectId IN ('S001', 'S002', 'S003', 'S004', 'S005', 'TA01', 'TA02', 'TA03') AND ACTIVE_FLAG = '1'
#20200106\u67E5\u8BE2\u8D44\u4EA7\u8D1F\u503A\u8868\u548C\u5229\u6DA6\u8868
DG00279=SELECT subjectId, subjectName, unAuditAmount, adjustAmount, auditAmount, preAuditAmount FROM bdo_hb.hb_mergesummary WHERE projectId = {param1} AND customerId = {param2} AND mergeProjectId = {param3} AND summaryType = {param4} AND ACTIVE_FLAG = '1' ORDER BY sortNo
#20200108\u67E5\u8BE2\u6240\u6709\u8005\u6743\u76CA\u8868\u5C55\u793A\u768415\u5217\u7684\u5217\u540D
DG00280=SELECT DISTINCT a.columnDesc1, a.columnDesc2, a.columnDesc3, a.columnDesc4, a.columnDesc5, a.columnDesc6, a.columnDesc7, a.columnDesc8, a.columnDesc9, a.columnDesc10, a.columnDesc11, a.columnDesc12, a.columnDesc13, a.columnDesc14, a.columnDesc15 FROM bdo_hb.hb_mergeauditreport a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3}  AND mergeProjectId = {param5}
#20200108\u67E5\u8BE2\u6240\u6709\u8005\u6743\u76CA\u8868\u5C55\u793A\u768415\u5217\u7684\u5217\u503C
DG00281=SELECT a.colCode, a.colDisp, a.column1, a.column2, a.column3, a.column4, a.column5, a.column6, a.column7, a.column8, a.column9, a.column10, a.column11, a.column12, a.column13, a.column14, a.column15 FROM bdo_hb.hb_mergeauditreport a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3}  AND mergeProjectId = {param5} AND isPre ={param6}ORDER BY a.rowNum 
#\u67E5\u8BE2\u62B5\u6D88\u5206\u5F55
DG00296=SELECT reason, autoId, curProjectId, customerId, projectId, projectName, yyyy, indexId, CASE direction WHEN 1 THEN occValue  END AS 'deb', CASE direction WHEN -1 THEN occValue END AS 'cre', tbSubjectCode, tbSubjectName, reportSubjectId, reportSubjectName, userSubjectId, userSubjectName, occValue, direction, adjustType, description, digest, ACTIVE_FLAG, DATE_FORMAT(LAST_UPDATE_DATE, '%Y-%m-%d %H:%i:%s') AS lastUpdateDate, CREATED_BY AS __ufillUserName FROM bdo_hb.hb_offset_entry WHERE customerId = {param1} AND curProjectId = {param2} AND yyyy BETWEEN {param3} AND {param4} AND adjustType = {param5}
# \u67E5\u8BE2 \u5408\u5E76\u9644\u6CE8\u6570\u636E
DG00297=SELECT a.autoId, a.customerId, a.projectId, a.knoteId, a.noteNo, a.noteName, a.colCode, a.colName, a.fileName, a.fullPath, a.reportTplId, a.isForbid, a.isEdited, a.isFinished, a.isCompleteNow, DATE_FORMAT(a.LAST_UPDATE_DATE, '%Y-%m-%d %H:%i:%s') AS updateTime, a.LAST_UPDATED_BY                                    AS __urevisor FROM bdo_hb.hb_mergenoteinfo a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.mergeProjectId = {param3} /*START #param4#  AND a.noteNo = {param4} #param4# END*/ /*START #param5# AND a.colName = {param5}# colName# END*/ /*START #param6# AND a.isForbid = {param6} #param6# END*/ /*START #param7# AND a.isEdited = {param7} #param7# END*/ /*START #param8# AND a.isFinished = {param8} #param8# END*/ ORDER BY a.noteNo DESC
# \u67E5\u8BE2\u6307\u5B9A\u7C7B\u578B\u7684\u6570\u636E\uFF08\u8BD5\u7B97\u5E73\u8861\u8868\u3001\u73B0\u91D1\u6D41\u91CF\u8868\u3001\u8D44\u4EA7\u8D1F\u503A\u8868\u3001\u5229\u6DA6\u8868\uFF09
HB00001=SELECT a.subjectId   as colCode, a.subjectName as colDisp, a.auditAmount as auditedAmount, b.auditAmount as auditedRemain FROM bdo_hb.hb_mergesummary a inner join bdo_hb.hb_mergesummary b on a.customerId = b.customerId and a.projectId = b.projectId and a.mergeProjectId = b.mergeProjectId and a.summaryType = b.summaryType and a.subjectId = b.subjectId and b.year =  {lastYear} WHERE a.customerId = {customerId} AND a.projectId = {projectId} AND a.summaryType = {summaryType} AND a.year = {year} and a.mergeProjectId = {projectId}
#\u5173\u8054\u65B9\u5BFC\u5165\u6811\u67E5\u8BE2
HB00005=select extractionRatio,investmentRatio,lastInitializationTimeContacts,lastInitializationTimeDeal,lastInitializationTimeReport,lastInitializationTimeNote,labels,lastInitializationTime,incomeTaxRate,uscc,curMergeProportion,preMergeProportion,isUnitChildProject,equityRatio,autoId,customerId,mergeCustomerId,mergeCustomerName, mergeProjectId, mergeProjectName, stockBreakRate, stockType, capiType, stockCapi, stockLevel, parentId, stockRemark,  shortName, userDefine, remark, mergeScope, appId, curId, CREATION_DATE, CREATED_BY, LAST_UPDATE_DATE, LAST_UPDATED_BY, ABOLITION_DATE, ABOLISHED_BY, PROGRAM_APPLICATION_ID, PROGRAM_ID, ACTIVE_FLAG from bdo_hb.hb_mergeproject where  customerId = {customerId} and parentId = curId and projectId = {projectId} 
HB00006=select extractionRatio,investmentRatio,lastInitializationTimeContacts,lastInitializationTimeDeal,lastInitializationTimeReport,lastInitializationTimeNote,labels,lastInitializationTime,incomeTaxRate,uscc,curMergeProportion,preMergeProportion,isUnitChildProject,equityRatio,autoId,customerId,mergeCustomerId,mergeCustomerName, mergeProjectId, mergeProjectName, stockBreakRate, stockType, capiType, stockCapi, stockLevel, parentId, stockRemark,  shortName, userDefine, remark, mergeScope, appId, curId, CREATION_DATE, CREATED_BY, LAST_UPDATE_DATE, LAST_UPDATED_BY, ABOLITION_DATE, ABOLISHED_BY, PROGRAM_APPLICATION_ID, PROGRAM_ID, ACTIVE_FLAG from bdo_hb.hb_mergeproject where customerId = {customerId} and parentId = {parentId} and curId !=  {parentId} and projectId = {projectId}
#\u6839\u636E\u90E8\u95E8id\u67E5\u8BE2\u6240\u6709\u9876\u7EA7\u6A21\u677F
HB00007=select type, autoId, templateName, parentId, departId, CREATION_DATE, CREATED_BY, LAST_UPDATE_DATE, LAST_UPDATED_BY, ABOLITION_DATE, ABOLISHED_BY, PROGRAM_APPLICATION_ID, PROGRAM_ID, ACTIVE_FLAG from bdo_hb.hb_offset_template_name where  departId = {departId} and  parentId is  null
# \u6839\u636E\u7236id \u548C\u90E8\u95E8id \u67E5\u8BE2\u5B50\u6A21\u677F
HB00008=select autoId,type, templateName, parentId, departId, CREATION_DATE, CREATED_BY, LAST_UPDATE_DATE, LAST_UPDATED_BY, ABOLITION_DATE, ABOLISHED_BY, PROGRAM_APPLICATION_ID, PROGRAM_ID, ACTIVE_FLAG from bdo_hb.hb_offset_template_name where  departId = {departId} and  parentId = {parentId} 
#\u6839\u636E\u6A21\u677Fid \u90E8\u95E8id \u67E5\u8BE2\u62B5\u6D88\u5206\u5F55\u6A21\u677F secondSubject, autoId,
HB00009=select formula, calculateRule,autoId as id,subjectName as label, offset_type as offsetType,secondSubject, directions  as digest, direction ,templateId from bdo_hb.hb_offset_template where templateId = {templateId}  and departId = {departId}
# \u67E5\u8BE2\u5408\u5E76\u62A5\u8868\u6570\u636E \u5C06\u4E24\u5E74\u7684\u6570\u636E\u5408\u5E76\u4E3A\u4E00\u6761\u6570\u636E
HB00010=select a.autoId, a.projectId, a.customerId, a.mergeProjectId, a.summaryType, a.subjectId, a.subjectName, a.unAuditAmount, a.adjustAmount, a.auditAmount, b.unAuditAmount as 'preUnAuditAmount', b.adjustAmount  as 'preAdjustAmount', b.auditAmount   as 'preAuditAmount', a.curAmount, b.curAmount     as 'preAmount', a.sortNo, a.debValue, a.creValue, b.debValue as 'lastDebValue', b.creValue as 'lastCreValue', a.relatedCode, a.direction, a.year, a.CREATION_DATE,  a.LAST_UPDATE_DATE, a.ABOLITION_DATE, a.ABOLISHED_BY, a.PROGRAM_APPLICATION_ID, a.PROGRAM_ID, a.ACTIVE_FLAG from bdo_hb.hb_mergesummary a inner join bdo_hb.hb_mergesummary b ON a.projectId = b.projectId and a.customerId = b.customerId and a.mergeProjectId = b.mergeProjectId and a.subjectId = b.subjectId where a.customerId = {customerId} and a.projectId = {projectId} and a.mergeProjectId = {mergeProjectId} and a.year = {year} and b.year = {lastYear} order by  sortNo
# \u5408\u5E76\u62A5\u8868 \u6240\u6709\u8005\u6743\u76CA\u53D8\u52A8\u8868\u67E5\u8BE2
HB00011=SELECT autoId, customerId, projectId, mergeProjectId, yyyy, colCode, colDisp, colType, isPre, column1, columnDesc1, column2, columnDesc2, column3, columnDesc3, column4, columnDesc4, column5, columnDesc5, column6, columnDesc6, column7, columnDesc7, column8, columnDesc8, column9, columnDesc9, column10, columnDesc10, column11, columnDesc11, column12, columnDesc12, column13, columnDesc13, column14, columnDesc14, column15, columnDesc15, rowNum, colNum, tableType FROM bdo_hb.hb_mergeauditreport t WHERE t.customerId = {param1} AND t.projectId = {param3}  AND t.mergeProjectId = {param3}  AND t.isPre = {param6} AND t.colType = 'G'
#\u6240\u6709\u8005\u6743\u76CA\u53D8\u52A8\u8868 \u5217\u67E5\u8BE2
HB00012=SELECT DISTINCT a.columnDesc1, a.columnDesc2, a.columnDesc3, a.columnDesc4, a.columnDesc5, a.columnDesc6, a.columnDesc7, a.columnDesc8, a.columnDesc9, a.columnDesc10, a.columnDesc11, a.columnDesc12, a.columnDesc13, a.columnDesc14, a.columnDesc15 FROM bdo_hb.hb_mergeauditreport a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.tableType = {param4}
#\u67E5\u8BE2\u5408\u5E76\u9644\u6CE8
HB00013=SELECT autoId, customerId, projectId, mergeProjectId, knoteId, noteNo, noteName, colCode, colName, fileName, fullPath, noteDgValueInfo, reportTplId, isForbid, isEdited, isFinished, customizeStyle, isCompleteNow, LAST_UPDATED_BY  as '__ulastUpdatedUser', DATE_FORMAT(LAST_UPDATE_DATE, '%Y-%m-%d %H:%i:%s') AS lastUpdateDate FROM bdo_hb.hb_mergenoteinfo WHERE ACTIVE_FLAG = '1' AND customerId = {customerId} AND projectId = {projectId} AND mergeProjectId = {projectId} ORDER BY autoId
HB00014=select customerId,projectId,mergeProjectId, subjectId, subjectName,auditAmount,curAmount, sortNo, debValue, creValue, relatedCode, year from bdo_hb.hb_mergesummary where customerId = {customerId} and projectId  = {projectId} and  mergeProjectId = {mergeProjectId} and year =  {year} and find_in_set(subjectId, {tbCodes}) > 0
#\u67E5\u8BE2\u6307\u5B9A\u9879\u76EE\u7684\u6BCD\u516C\u53F8\u5355\u4F53\u9879\u76EEid\u4E0E\u5BA2\u6237id
HB00015=select mergeCustomerId,mergeProjectId from bdo_hb.hb_mergeproject where customerId = {param1} and projectId = {param2} and isUnitChildProject = 1  and mergeScope = 1 and  ACTIVE_FLAG = 1
#\u67E5\u8BE2\u5408\u5E76\u8D44\u4EA7\u8D1F\u503A\u8868 \u5229\u6DA6\u8868\u6570\u636E\uFF08\u7528\u4E8E\u5206\u6790\u6027\u590D\u6838\u9875\u9762\uFF09
HB00016=select a.autoId,  a.changeReason, a.changeReason as finallyChangeReason,   a.projectId, a.customerId, a.mergeProjectId, a.summaryType, a.subjectId   as colCode, a.subjectName as colDisp, a.unAuditAmount, a.adjustAmount, a.auditAmount as auditedAmount, a.auditAmount as adjustedAmount{year}, b.auditAmount as auditedRemain, b.auditAmount as adjustedRemain{year}, a.sortNo, a.relatedCode, a.direction, a.year, a.CREATION_DATE, a.LAST_UPDATE_DATE, a.ABOLITION_DATE, a.ABOLISHED_BY, a.PROGRAM_APPLICATION_ID, a.PROGRAM_ID, a.ACTIVE_FLAG from bdo_hb.hb_mergesummary a inner join bdo_hb.hb_mergesummary b ON a.projectId = b.projectId and a.customerId = b.customerId and a.mergeProjectId = b.mergeProjectId and a.subjectId = b.subjectId and a.summaryType = b.summaryType where a.customerId = {customerId} and a.projectId = {projectId} and a.mergeProjectId = {mergeProjectId} and a.summaryType > 1 and a.year = {year} and b.year = {lastYear} order by sortNo
#\u8BA1\u7B97\u6307\u6807\u62A5\u8868\u67E5\u8BE2(\u672A\u5BA1)
HB00017=SELECT a.customerId, a.projectId, a.yyyy AS reportYear, '1' AS quotaType, {quotaColumn} FROM (SELECT customerId, projectId, yyyy, {tableCol} FROM (select a.projectId, a.customerId, a.mergeProjectId, a.year        as yyyy, a.summaryType, a.subjectId   as reportSubjectId, a.subjectName, a.auditAmount as adjustedAmount, a.auditAmount as unAuditAmount, b.auditAmount as remain, k.columnName from bdo_hb.hb_mergesummary a inner join bdo_hb.hb_mergesummary b ON a.projectId = b.projectId and a.customerId = b.customerId and a.mergeProjectId = b.mergeProjectId and a.subjectId = b.subjectId left join asdb.k_reporttemplate k on k.colCode = a.subjectId and k.colDisp = a.subjectName and k.vocationId = {templateId} where a.customerId = {customerId} and a.projectId = {projectId} and a.mergeProjectId = {projectId} and a.summaryType > 1 and a.year = {yyyy} and b.year = {lastYear} and k.columnName > '' union select a.autoId, a.projectId, a.customerId, a.mergeProjectId, a.summaryType, a.subjectId as reportSubjectId, a.subjectName, a.curAmount    adjustedAmount, a.auditAmount as unAuditAmount, b.curAmount as remain, k.columnName from bdo_hb.hb_mergesummary a inner join bdo_hb.hb_mergesummary b ON a.projectId = b.projectId and a.customerId = b.customerId and a.mergeProjectId = b.mergeProjectId and a.subjectId = b.subjectId left join asdb.k_reporttemplate k on k.colCode = a.subjectId and k.colDisp = a.subjectName and k.vocationId = {templateId} where a.customerId = {customerId} and a.projectId = {projectId} and a.mergeProjectId = {projectId} and a.summaryType = 1 and a.year = {yyyy} and b.year = {lastYear} and k.columnName > '') a) a, (SELECT '0' AS iCol1, '0' AS iCol2) vv
#\u8BA1\u7B97\u6307\u6807\u62A5\u8868\u67E5\u8BE2(\u5BA1\u5B9A)
HB00018=SELECT a.customerId, a.projectId, a.yyyy AS reportYear, '2' AS quotaType, {quotaColumn} FROM (SELECT customerId, projectId, yyyy, {tableCol} FROM (select a.projectId, a.customerId, a.mergeProjectId, a.year        as yyyy, a.summaryType, a.subjectId   as reportSubjectId, a.subjectName, a.auditAmount as adjustedAmount, a.auditAmount as unAuditAmount, b.auditAmount as remain, k.columnName from bdo_hb.hb_mergesummary a inner join bdo_hb.hb_mergesummary b ON a.projectId = b.projectId and a.customerId = b.customerId and a.mergeProjectId = b.mergeProjectId and a.subjectId = b.subjectId left join asdb.k_reporttemplate k on k.colCode = a.subjectId and k.colDisp = a.subjectName and k.vocationId = {templateId} where a.customerId = {customerId} and a.projectId = {projectId} and a.mergeProjectId = {projectId} and a.summaryType > 1 and a.year = {yyyy} and b.year = {lastYear} and k.columnName > '' union select a.autoId, a.projectId, a.customerId, a.mergeProjectId, a.summaryType, a.subjectId as reportSubjectId, a.subjectName, a.curAmount    adjustedAmount, a.auditAmount as unAuditAmount, b.curAmount as remain, k.columnName from bdo_hb.hb_mergesummary a inner join bdo_hb.hb_mergesummary b ON a.projectId = b.projectId and a.customerId = b.customerId and a.mergeProjectId = b.mergeProjectId and a.subjectId = b.subjectId left join asdb.k_reporttemplate k on k.colCode = a.subjectId and k.colDisp = a.subjectName and k.vocationId = {templateId} where a.customerId = {customerId} and a.projectId = {projectId} and a.mergeProjectId = {projectId} and a.summaryType = 1 and a.year = {yyyy} and b.year = {lastYear} and k.columnName > '') a) a, (SELECT '0' AS iCol1, '0' AS iCol2) vv
#\u5408\u5E76\u8BA1\u5212\u63A7\u5236\u8868
HB00019=SELECT a.autoId, a.customerId, a.projectId, a.tbSubjectId, CONCAT( a.tbSubjectCode, '-', a.tbSubjectName ) AS tbSubject, a.tbSubjectCode, a.tbSubjectName, CONCAT( a.userSubjectId, '-', a.userSubjectName ) AS userSubject, CONCAT(a.baseSubjectId,'-',a.baseSubjectName) AS baseSubject, a.userSubjectId, a.userSubjectName, a.plansE, a.plansC, a.plansA, a.plansV, a.plansP, a.plancsE, a.plancsC, a.plancsA, a.plancsV, a.plancsP, b.plansE AS subjectScoreE, b.plansC AS subjectScoreC, b.plansA AS subjectScoreA, b.plansV AS subjectScoreV, b.plansP AS subjectScoreP, a.subjectEditors,a.subjectEditors AS __usubjectEditorUser, a.remain, a.balance, a.debitTotalOcc, a.creditTotalOcc, a.isNeedToAudit, a.notAuditReasons, IF( a.tbSubjectCode IS NULL, 0, 1 ) AS isEditable FROM bdo_dg.dg_tbsubjectcontract a LEFT JOIN bdo_dg.dg_subjecttree b ON b.customerId = {param1} AND b.projectId = {param2} AND b.tbSubjectCode = a.tbSubjectCode AND b.userSubjectId = a.userSubjectId WHERE a.customerId = {param1} AND a.projectId = {param2} /*START #param3# AND a.yyyy = {param3} #param3# END*/ /*START #param4# AND a.tbSubjectName = {param4} #param4# END*/ /*START #param6# AND a.debitTotalOcc != 0 AND a.creditTotalOcc != 0 #param6# END*/ /*START #param7# AND a.debitTotalOcc = 0 AND a.creditTotalOcc = 0 #param7# END*/ /*START #param10# AND a.subjectEditors = {param10} #param10# END*/ ORDER BY a.autoId
#\u67E5\u8BE2projecttb ORDER BY sortNo
HB00020=SELECT autoId, vocationId, customerId, projectId, departmentId, tbSubjectId, tbSubjectName, reportSubjectId, reportSubjectName, subjectType1, cusCalFun, sortNo, isSubject, calFun, userDefined, direction  FROM bdo_dg.dg_projecttb WHERE customerId = {customerId} AND projectId = {projectId} AND ACTIVE_FLAG = '1' ORDER BY sortNo
# \u6839\u636E\u516B\u4F4D\u5BA2\u6237id\u3001\u4E1A\u52A1\u7C7B\u578B\u3001\u9879\u76EE\u5E74\u5EA6\u3001\u90E8\u95E8id \u67E5\u8BE2\u9879\u76EE\u4FE1\u606F
#HB00003=select z.projectid, auditdept, cus.customerid, accpackageid, audittype, auditpara, projectname, projectcreated, projectend, state, auditpeople, z.property, audittimebegin, audittimeend, realstartdate, realenddate, standbyname, systemid, templatetype, z.departmentid, groupname, groupprojectname, groupprojectid, projecttype, createtime, createuser, projectyear, projectfeeyear, projectfee, shortname, postil, registernum, approvalid, isstateend, sysspecial, isapproval, approvalstate, issign, finalresults, isback, backreson, projectapprovalid, signparaudit, signaudittime, signpar, signadvice, isapt, isaptchanging, aptrelationaudituser, aptrelationauditdate, aptrelationauditstate, aptrelationauditreason, isclose, budgetstate, budgetuser, budgettime, budgetreason, customerlocale, auditstartdate, auditenddate, checkdate, financereporttype, outworktime, auditfee, independencetype,ismilitarysecret, isend, endtime from asdb.z_project z left join bdo_cus.cus_customerinfo cus on cus.customerId = z.CustomerId where cus.restCustomerId = {customerId} and z.AuditPara = {AuditPara} and z.departmentid = {departmentid} and z.projectYear = {year}
#\u5408\u5E76\u62B5\u6D88\u67E5\u8BE2
HB00021=SELECT a.reason, a.autoId, a.curProjectId, a.customerId, a.projectId, a.projectName, a.yyyy, a.indexId, CASE a.direction WHEN 1 THEN occValue END AS 'deb', CASE a.direction WHEN -1 THEN occValue END AS 'cre', a.tbSubjectCode, a.tbSubjectName, a.reportSubjectId, a.reportSubjectName, a.userSubjectId, a.userSubjectName, a.occValue, a.direction, a.adjustType, a.description, a.digest, a.ACTIVE_FLAG, DATE_FORMAT(a.LAST_UPDATE_DATE, '%Y-%m-%d %H:%i:%s') AS lastUpdateDate, a.CREATED_BY AS __ufillUserName FROM bdo_hb.hb_offset_entry a /*START #param11# , bdo_base.base_user b #param11# END*/  WHERE  a.customerId = {param1} AND  a.curProjectId = {param2} /*START #param3# AND  a.yyyy = {param3} #param3# END*/ /*START #param9# AND  a.tbSubjectCode = '{param9}' #param9# END*/ /*START #param11# AND a.CREATED_BY = b.id AND b.NAME LIKE '%{param11}%' #param11# END*/ AND  a.adjustType != 1
#\u5408\u5E76\u5B50\u516C\u53F8\u5BA1\u8BA1\u8C03\u6574\u67E5\u8BE2
HB00022=SELECT a.reason, a.autoId, a.curProjectId, a.customerId, a.projectId, a.projectName, a.yyyy, a.indexId, CASE a.direction WHEN 1 THEN occValue END AS 'deb', CASE a.direction WHEN -1 THEN occValue END AS 'cre', a.tbSubjectCode, a.tbSubjectName, a.reportSubjectId, a.reportSubjectName, a.userSubjectId, a.userSubjectName, a.occValue, a.direction, a.adjustType, a.description, a.digest, a.ACTIVE_FLAG, DATE_FORMAT(a.LAST_UPDATE_DATE, '%Y-%m-%d %H:%i:%s') AS lastUpdateDate, a.CREATED_BY AS __ufillUserName FROM bdo_hb.hb_offset_entry a /*START #param11# , bdo_base.base_user b #param11# END*/  WHERE  a.customerId = {param1} AND  a.curProjectId = {param2} /*START #param3# AND  a.yyyy = {param3} #param3# END*/ /*START #param9# AND  a.tbSubjectCode = '{param9}' #param9# END*/ /*START #param11# AND a.CREATED_BY = b.id AND b.NAME LIKE '%{param11}%' #param11# END*/ AND  a.adjustType = 1 AND  a.ACTIVE_FLAG = 1
#\u5408\u5E76\u5B50\u516C\u53F8\u5BA1\u8BA1\u8C03\u6574\u4F5C\u5E9F\u6570\u636E a a.
HB00023=SELECT a.reason, a.autoId, a.curProjectId, a.customerId, a.projectId, a.projectName, a.yyyy, a.indexId, CASE a.direction WHEN 1 THEN occValue END AS 'deb', CASE a.direction WHEN -1 THEN occValue END AS 'cre', a.tbSubjectCode, a.tbSubjectName, a.reportSubjectId, a.reportSubjectName, a.userSubjectId, a.userSubjectName, a.occValue, a.direction, a.adjustType, a.description, a.digest, a.ACTIVE_FLAG, DATE_FORMAT(a.LAST_UPDATE_DATE, '%Y-%m-%d %H:%i:%s') AS lastUpdateDate, a.CREATED_BY AS __ufillUserName FROM bdo_hb.hb_offset_entry a /*START #param11# , bdo_base.base_user b #param11# END*/  WHERE  a.customerId = {param1} AND  a.curProjectId = {param2} /*START #param3# AND  a.yyyy = {param3} #param3# END*/ /*START #param9# AND  a.tbSubjectCode = '{param9}' #param9# END*/ /*START #param11# AND a.CREATED_BY = b.id AND b.NAME LIKE '%{param11}%' #param11# END*/ AND  a.adjustType = 1 AND  a.ACTIVE_FLAG = 0
#\u67E5\u8BE2\u62B5\u6D88\u5206\u5F55
HB00024=SELECT a.autoId, a.curProjectId, a.customerId, a.projectId, a.yyyy, a.indexId, CASE a.direction WHEN 1 THEN a.occValue END AS 'deb', CASE a.direction WHEN - 1 THEN a.occValue END AS 'cre', a.tbSubjectCode, a.tbSubjectName, a.reportSubjectId, a.reportSubjectName, a.secondSubject, a.occValue, a.direction, a.adjustType, a.description, a.digest, a.ACTIVE_FLAG, a.reason FROM bdo_hb.hb_offset_entry a LEFT JOIN bdo_hb.hb_mergenoteinfo b ON a.customerId = b.customerId AND a.curProjectId = b.projectId AND a.curProjectId = b.mergeProjectId AND a.reportSubjectId = b.colCode WHERE a.customerId = {param1} AND a.curProjectId = {param2} AND a.yyyy BETWEEN {param3} AND {param4} AND a.adjustType = 2 AND a.reportSubjectId IS NOT NULL AND b.autoId = {param5} /*START #param6# AND a.yyyy = {param6} #param6# END*/ AND a.ACTIVE_FLAG = 1
#\u9644\u6CE8\u501F\u8D37\u65B9\u5411
HB00025=SELECT a.tbSubjectId, a.tbSubjectName, a.reportSubjectId, a.reportSubjectName, a.isSubject, a.direction FROM bdo_dg.dg_projecttb a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.reportSubjectId = '{param3}' AND a.tbSubjectName = '{param4}'
#\u67E5\u8BE2\u5B50\u516C\u53F8\u6307\u5B9A\u79D1\u76EE
HB00026=select customerId, projectId, mergeProjectId, subjectId, subjectName, auditAmount, preAuditAmount, curAmount, preAmount sortNo, debValue, creValue, relatedCode, year from bdo_hb.hb_mergesummary where customerId = {customerId} and projectId = {projectId} and mergeProjectId = {mergeProjectId} and find_in_set (subjectId, {tbCodes})
#INSERT INTO bdo_hb.hb_mergesummary (autoId, projectId, customerId, mergeProjectId, summaryType, subjectId, subjectName, unAuditAmount, adjustAmount, auditAmount, preUnAuditAmount, preAdjustAmount, preAuditAmount, curAmount, preAmount, sortNo, debValue, creValue, relatedCode, direction, year, changeReason, CREATION_DATE, CREATED_BY, LAST_UPDATE_DATE, LAST_UPDATED_BY, ABOLITION_DATE, ABOLISHED_BY, PROGRAM_APPLICATION_ID, PROGRAM_ID, ACTIVE_FLAG) VALUES
#\u67E5\u8BE2\u5408\u5E76\u62A5\u544A
HB10001=SELECT a.subjectId,a.subjectName as colDisp,sum(case when a.year = {param5} and a.summaryType <> '1' then a.auditAmount when a.year = {param5} and a.summaryType = '1' then a.curAmount else 0 end) as auditedAmount,sum(case when a.year = {param6} and a.summaryType <> '1' then a.auditAmount when a.year = {param6} and a.summaryType = '1' then a.curAmount else 0 end) as auditedRemain,sum(case when a.year = {param5} then a.debValue else 0 end) as debValue,sum(case when a.year = {param5} then a.creValue else 0 end) as creValue,sum(case when a.year = {param6} then a.debValue else 0 end) as debValueRemain,sum(case when a.year = {param6} then a.creValue else 0 end) as creValueRemain,a.relatedCode,IFNULL(b.auditedAmount,0) as auditedAmountChild,IFNULL(b.auditedRemain,0) as auditedRemainChild,c.calFun from bdo_hb.hb_mergesummary a left join (select a.subjectId,sum(case when a.summaryType <> '1' and (a.auditAmount = 0 or a.auditAmount is null) then 0 when a.summaryType = '1' and (a.curAmount = 0 or a.curAmount is null) then 0 else 1 end) as auditedAmount,sum(case when a.summaryType <> '1' and (a.preAuditAmount = 0 or a.preAuditAmount is null) then 0 when a.summaryType = '1' and (a.preAmount = 0 or a.preAmount is null) then 0 else 1 end) as auditedRemain from bdo_hb.hb_mergesummary a where a.projectId = {param1} and a.customerId = {param3} and a.year is null and a.summaryType = {param4} group by a.subjectId,a.subjectName) b on a.subjectId = b.subjectId left join asdb.k_reporttemplate c on a.subjectId = c.colCode and c.vocationId = {param7} where a.projectId = {param1} and a.mergeProjectId = {param2} and a.customerId = {param3} and a.summaryType = {param4} group by a.subjectId,a.subjectName order by a.sortNo
#\u67E5\u8BE2\u5408\u5E76\u62A5\u544A\u6743\u76CA\u8868
HB10002=SELECT t.autoId, t.customerId, t.yyyy, t.projectId, t.mergeProjectId, t.colCode, t.colDisp, t.colType, t.rowNum, t.column1, t.column2, t.column3, t.column4, t.column5, t.column6, t.column7, t.column8, t.column9, t.column10, t.column11, t.column12, t.column13, t.column14, t.column15, t.isPre, t.columnDesc1, t.columnDesc2, t.columnDesc3, t.columnDesc4, t.columnDesc5, t.columnDesc6, t.columnDesc7, t.columnDesc8, t.columnDesc9, t.columnDesc10, t.columnDesc11, t.columnDesc12, t.columnDesc13, t.columnDesc14, t.columnDesc15 FROM bdo_hb.hb_mergeauditreport t WHERE t.customerId = {param1} AND t.mergeProjectId = {param2} AND t.projectId = {param3} AND t.isPre = {param4} 
#\u5408\u5E76\u9644\u6CE8
HB10003=SELECT a.autoId, a.customerId, a.projectId, a.knoteId, a.noteNo, a.noteName, a.colCode, a.colName, a.fileName, a.fullPath, a.noteDgValueInfo, a.reportTplId, a.isForbid, a.isEdited, a.isFinished FROM bdo_hb.hb_mergenoteinfo a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.mergeProjectId = {param2} AND a.fullPath IS NOT NULL AND a.fullPath <> '' AND ( a.reportTplId = (SELECT tbReportTemplate FROM bdo_dg.dg_project WHERE customerId = {param1} AND projectId = {param2}) OR a.reportTplId IS NULL ) ORDER BY a.knoteId DESC
# \u6839\u636E\u4EA4\u6613\u7C7B\u578B\u67E5\u8BE2\u5185\u90E8\u4EA4\u6613\u62B5\u9500
HB00027=select hot.autoId,hot.subjectName,hot.direction,hot.offset_type,hot.directions,hot.departId,hot.templateId,hot.secondSubject,hot.calculateRule,hot.formula from bdo_hb.hb_offset_template hot left join bdo_hb.hb_offset_template_name hotn on hot.templateId = hotn.autoId where hotn.type = {insideType}
# \u67E5\u8BE2\u5185\u90E8\u4EA4\u6613\u62B5\u9500\uFF08\u62B5\u9500\u5206\u5F55\u9875\u9762\uFF09
HB00028=select otherDescription,dataType,autoId, curProjectId, customerId, projectId, projectName, yyyy, indexId, tbSubjectCode, tbSubjectName, reportSubjectId, reportSubjectName, userSubjectId, userSubjectName, occValue, direction, adjustType, description, digest, templateId, subjectType, reason, secondSubject, CREATION_DATE, CREATED_BY, LAST_UPDATE_DATE, LAST_UPDATED_BY, ABOLITION_DATE, ABOLISHED_BY, PROGRAM_APPLICATION_ID, PROGRAM_ID, ACTIVE_FLAG from bdo_hb.hb_offset_entry where customerId = {customerId} /*START #curProjectId#  and curProjectId =  {curProjectId}    #curProjectId# END*/ /*START #projectId#  and projectId =  {projectId}   #projectId# END*/ /*START #tbSubjectCode#  and tbSubjectCode =  {tbSubjectCode}  #tbSubjectCode# END*/ /*START #tbSubjectName#  and tbSubjectName =  {tbSubjectName}  #tbSubjectName# END*/ /*START #yyyy#  and yyyy =  {yyyy}  #yyyy# END*/ /*START #activeFlag#  and ACTIVE_FLAG =  {activeFlag}  #activeFlag# END*/ and ( templateId in ({templateId}) /*START #isLastStage#   or templateId is null  #isLastStage# END*/ ) /*START #adjustType# and adjustType = {adjustType}  #adjustType# END*/
# \u6839\u636E\u6A21\u677Fid\u67E5\u8BE2\u8BE5\u6A21\u677Fid\u4E0B\u7684\u6240\u6709\u5B50\u8282\u70B9
HB00029=SELECT GROUP_CONCAT(autoId) as 'autoId' FROM bdo_hb.hb_offset_template_name WHERE parentId IN ({templateId})
# \u5408\u5E76\u9644\u6CE8\u8FDB\u5EA6\u67E5\u8BE2sql
HB00030=SELECT IF(totalCount = 0, 0, ROUND(finishedCount * 100 / totalCount,2)) AS percent FROM (SELECT SUM(IF(a.isFinished = '1', 1, 0)) finishedCount, IFNULL(SUM(1), 0) AS totalCount FROM bdo_hb.hb_mergenoteinfo a WHERE a.customerId = {param1} AND a.projectId = {param2} and a.projectId = a.mergeProjectId AND a.isForbid = 0) a
# \u5408\u5E76\u8BD5\u7B97\u5E73\u8861\u8868\u67E5\u8BE2sql
HB00031=select COUNT(1) from bdo_hb.hb_mergesummary a   WHERE a.customerId = {customerId} AND a.projectId = {projectId} AND a.year = {yyyy} and mergeProjectId = projectId and summaryType = 0
# \u5408\u5E76\u62A5\u8868sql
HB00032=select COUNT(1) from bdo_hb.hb_mergesummary a   WHERE a.customerId = {customerId} AND a.projectId = {projectId} AND a.year = {yyyy} and mergeProjectId = projectId and summaryType = 2
# \u67E5\u8BE2\u5408\u5E76\u9644\u6CE8\u5B8C\u6210\u72B6\u6001
HB00033=SELECT a.* FROM (SELECT a.autoId,a.customerId,a.projectId,a.knoteId,a.noteNo,a.noteName,a.colCode,a.colName,a.fileName,a.fullPath,a.reportTplId,a.isFinished    AS haveDone,DATE_FORMAT(a.LAST_UPDATE_DATE, '%Y-%m-%d %T') AS updateTime,a.LAST_UPDATED_BY         AS __urevisor FROM bdo_hb.hb_mergenoteinfo a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.projectId = a.mergeProjectId AND a.ACTIVE_FLAG = '1' AND a.isForbid = '0' ORDER BY a.sortNo ASC) a
HB00034=select group_concat(parentId) parent from bdo_hb.hb_offset_template_name where autoId in ({templateId})

############################# \u5408\u5E76\u529F\u80FD #############################




#\u9519\u62A5\u6C47\u603B\u8868
CB000001=SELECT a.customerId, a.projectId, a.indexId, a.debit1 - a.credit1 AS remain1, a.debit2 - a.credit2 AS remain2, a.debit3 - a.credit3 AS remain3, a.debit4 - a.credit4 AS remain4, a.debit1, a.credit1, a.debit2, a.credit2, a.debit3, a.credit3, a.debit4, a.credit4, a.reportType, a.cbType, a.taxEffect, a.summary, a.subjectName, a.reason, a.editor, a.editTime FROM ( SELECT a.customerId, a.projectId, a.indexId, IF( a.reportType = 'A', IF( a.dirction > 0, a.occurValue, 0 ), 0 ) AS debit1, IF( a.reportType = 'A', IF( a.dirction < 0, a.occurValue, 0 ), 0 ) AS credit1, IF( a.reportType = 'B' OR a.reportType = 'C' OR a.reportType = 'Y' OR a.tbSubjectCode = 'TA02', IF( a.dirction > 0, a.occurValue, 0 ), 0 ) AS debit2, IF( a.reportType = 'B' OR a.reportType = 'C' OR a.reportType = 'Y' OR a.tbSubjectCode = 'TA02', IF( a.dirction < 0, a.occurValue, 0 ), 0 ) AS credit2, a.debit3, a.credit3, IF( a.reportType = 'S', IF( a.dirction > 0, a.occurValue, 0 ), 0 ) AS debit4, IF( a.reportType = 'S', IF( a.dirction < 0, a.occurValue, 0 ), 0 ) AS credit4, a.reportType, a.cbType, a.taxEffect, a.summary, a.subjectFullName1 AS subjectName, a.reason, a.editTime, a.editor FROM ( SELECT a.customerId, a.projectId, a.indexId, a.tbSubjectCode, IFNULL( a.adjustSubjectCodeReport, d.reportSubjectId ) AS adjustSubjectCodeReport, LEFT( REPLACE( IFNULL( a.adjustSubjectCodeReport, d.reportSubjectId ), 'HB_', '' ), 1 ) AS reportType, IF( a.tbSubjectCode <> 'TA01', 0, IF( a.dirction > 0, a.occurValue, 0 )) AS debit3, IF( a.tbSubjectCode <> 'TA01', 0, IF( a.dirction < 0, a.occurValue, 0 )) AS credit3, a.reason, a.summary, a.subjectFullName1, IF( a.cbType = 0, '\u4E8B\u5B9E\u9519\u62A5', IF( a.cbType = 1, '\u5224\u65AD\u9519\u62A5', '\u63A8\u65AD\u9519\u62A5' )) AS cbType, IF(a.taxEffect = 1, '\u662F', '\u5426') AS taxEffect, a.dirction, a.occurValue, DATE_FORMAT( a.LAST_UPDATE_DATE, '%Y-%m-%d %H:%i:%s' ) AS editTime, b. NAME AS editor FROM bdo_dg.dg_subjectentryadjust a LEFT JOIN bdo_base.base_user b ON a.LAST_UPDATED_BY = b.id LEFT JOIN bdo_dg.dg_customersubject c ON a.customerId = c.customerId AND a.projectId = c.projectId AND a.yyyy = c.yyyy AND a.subjectId = c.subjectId LEFT JOIN bdo_dg.dg_tbsubjectcontract d ON c.customerId = d.customerId AND c.projectId = d.projectId AND c.yyyy = d.yyyy AND c.parentSubjectId = d.userSubjectId WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} AND a.adjustType = 2 AND a. STATUS = 0 ) a ) a
CB000002=SELECT CASE a.settingType WHEN 1 THEN a.settingRateTwo1 WHEN 2 THEN a.settingRateTwo2 WHEN 3 THEN a.settingRateTwo3 WHEN 4 THEN a.settingRateTwo4 END AS rate, a.settingTypeValue2, CASE a.settingType WHEN 1 THEN IFNULL(a.constitute1, '') WHEN 2 THEN IFNULL(a.constitute2, '') WHEN 3 THEN IFNULL(a.constitute3, '') WHEN 4 THEN IFNULL(a.constitute4, '') END AS constitute FROM bdo_dg.dg_materiality a WHERE a.customerId = {param1} AND a.projectId = {param2}
CB000003=( SELECT a.tbSubjectId AS subjectId, TRIM(a.tbSubjectName) AS subjectName, a.auditAmount FROM bdo_dg.dg_tbtable a WHERE a.customerId = {param1} AND a.projectId = {param2} AND a.yyyy = {param3} ) UNION ALL ( SELECT a.colCode AS subjectId, TRIM(a.colDisp) AS subjectName, IFNULL(( a.adjustedAmount + IFNULL(b.occurValue, 0)), 0 ) AS auditAmount FROM bdo_dg.dg_unauditreport a LEFT JOIN ( SELECT SUM( IFNULL(occurValue, 0) * IFNULL(dirction, 0)) AS occurValue, adjustSubjectCodeReport AS reportSubjectId, customerId, projectId FROM bdo_dg.dg_subjectentryadjust WHERE customerId = {param1} AND projectId = {param2} AND adjustType = 2 AND ACTIVE_FLAG = 1 GROUP BY adjustSubjectCodeReport ) b ON a.customerId = b.customerId AND a.projectId = b.projectId AND a.colCode = b.reportSubjectId WHERE a.customerId = {param1} AND a.projectId = {param2} GROUP BY a.sortNo )


## \u5E95\u7A3F-\u4E91\u76D8 START
DG60001=SELECT a.projectId, a.customerId, bd.autoid AS departmentId, a.projectName, a.customerName, bd.departName, a.materialityAuditUser, a.trialBalanceAuditUser, a.unauditedAuditUser, a.auditedAuditUser, a.identifiedAuditUser, a.programPlanAuditUser, a.programAuditUser, a.clearQuestionAuditUser, a.noteinfoAuditUser, a.reportAuditUser, a.analysisReviewAuditUser, a.finalAnalysisReviewAuditUser, a.bbReportAuditUser, a.samplingAuditUser, a.manager AS managerUser, a.signUser, a.audit1 AS audit1User, a.audit2 AS audit2User, a.membersId, a.signAccountant2 AS signAccountant2User, a.signAccountant3 AS signAccountant3User, a.reviewPartner AS reviewPartnerUser, a.reaReviewer AS reaReviewerUser, a.issuedPeople AS issuedPeopleUser, pe.bbEditer AS bbEditerUser, pe.cashFlowEditer AS cashFlowEditerUser, pe.unReportEditer AS unReportEditer, pe.tbEditer AS tbEditerUser FROM bdo_dg.dg_project a LEFT JOIN bdo_dg.dg_projectext pe ON pe.projectId = a.projectId AND pe.customerId = a.customerId LEFT JOIN bdo_base.base_user bu ON a.manager = bu.id LEFT JOIN bdo_base.base_department bd ON bu.departmentid = bd.autoid WHERE a.projectId = {param1}
## \u5E95\u7A3F-\u4E91\u76D8 END