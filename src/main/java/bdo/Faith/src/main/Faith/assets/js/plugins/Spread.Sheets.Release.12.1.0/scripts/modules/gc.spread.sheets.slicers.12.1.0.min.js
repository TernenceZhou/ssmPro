/*!
 * 
 * Spread.Sheets Library 12.1.0
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Slicers=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){!function(){"use strict";var b=c(1);c(8),b.SR={},b.SR.en=c(9),a.exports=b}()},function(a,b,c){!function(){"use strict";var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q=c(2),r=c(3),s=c(4),t=c(5),u=c(6),v=c(7),w=r.D,x={},y=function(){return r.C(x.SR)()},z=r.k,A=q.GC$,B=q.To,C=q.Commands,D=q.Ul.Nl,E=q.Ul.Pl,F=q.Ul.Ol,G=z.ac,H=q.Ul.hZa,I=A.isArray,J=A.extend,K=document,L=void 0,M=null,N="normal 11pt calibri",O=parseFloat,P="name",Q="style",R="Style",S="light",T="dark",U="white",V="black",W="solid",X="color",Y="Color",Z="background-color",$="width",_="Width",aa="height",ba="font",ca="setBorders",da="back"+Y,ea="fore"+Y,fa="border",ga=fa+"Width",ha=fa+R,ia=fa+Y,ja=fa+"Left",ka=fa+"Top",la=fa+"Right",ma=fa+"Bottom",na="textDecoration",oa="WithData"+R,pa="WithNoData"+R,qa="electedItem",ra="hovered",sa="wholeSlicer"+R,ta="header"+R,ua="s"+qa+oa,va="s"+qa+pa,wa="unS"+qa+oa,xa="unS"+qa+pa,ya=ra+"S"+qa+oa,za=ra+"S"+qa+pa,Aa=ra+"UnS"+qa+oa,Ba=ra+"UnS"+qa+pa,Ca="undoFilter",Da="undoAdd",Ea="undoRemove",Fa="undoUpdateTableSlicer",Ga="div",Ha="px",Ia="default",Ja="cursor",Ka="position",La="absolute",Ma="padding",Na="top",Oa="margin-"+Na,Pa="left",Qa="right",Ra="text-align",Sa="overflow",Ta="hidden",Ua="auto",Va="text-overflow",Wa="ellipsis",Xa="white-space",Ya="nowrap",Za="unselectable",$a="on",_a="font-weight",ab="font-size",bb="border-radius",cb="box-sizing",db="content-box",eb="button",fb="\u2717",gb="mark",hb="itemValue",ib="Accent ",jb="Slicer"+R,kb="#999999",lb="#828282",mb="#CCCCCC",nb="gc-slicer-",ob="container",pb=nb+ob,qb="header",rb=nb+qb,sb=nb+"header-borderDiv",tb=nb+"caption",ub="clearfilter",vb=nb+ub,wb="body",xb=nb+wb,yb=nb+"table",zb=nb+"tr",Ab=nb+"td1",Bb=nb+"td2",Cb="itemscontainer",Db=nb+Cb,Eb="item",Fb=nb+Eb,Gb="gc-no-user-select",Hb=function(){var a,b,c,d=[da,ea,ba,ja,ka,la,ma,na];function e(a,b,c,e,f,g,h,i){for(var j=0,k=G(d);j<k;j++)this[d[j]](arguments[j])}for(a={constructor:e,setBorders:function(a){var b=this;b[ja](a)[ka](a)[la](a)[ma](a)},fromJSON:function(a){if(a&&!A.isEmptyObject(a)){var b=this;d.forEach(function(c){var d,e=a[c];F(e)&&(c.indexOf(fa)>=0?(d=Jb(),d.fromJSON(e),b[c](d,!1)):b[c](e,!1))})}},toJSON:function(){var a=this,b={};return d.forEach(function(c){var d=a[c]();a[c].isDefault(d)||(b[c]=d&&d.toJSON?d.toJSON():d)}),b}},b=0,c=G(d);b<c;b++)a[d[b]]=E(d[b]);return e.prototype=a,e}();function Ib(a){var b,c;return a&&0!==G(a)?0===a.indexOf(S)?(c=parseInt(a.replace(S,"")),b=f[S+c]()):0===a.indexOf(T)?(c=parseInt(a.replace(T,"")),b=f[T+c]()):f[a]&&(b=f[a]()):b=new Hb,b}b=function(){var a,b,c,d=[ga,ha,ia],e=G(d);function f(a,b,c){for(var f=0;f<e;f++)this[d[f]](arguments[f])}for(a=function(a,b,c){return E(a,b,c,function(b){var c=typeof b;return a===ga?"number"===c&&b>=0:"string"===c})},b={constructor:f,fromJSON:function(a){var b,c;if(a&&!A.isEmptyObject(a))for(b=0;b<e;b++)c=d[b],F(a[c])&&this[c](a[c],!1)},toJSON:function(){var a,b,c,f={};for(a=0;a<e;a++)f[d[a]]=this[d[a]]();b={};for(c in f)f[c]!==L&&f[c]!==M&&(b[c]=f[c]);return b}},c=0;c<e;c++)b[d[c]]=a(d[c],L,L);return f.prototype=b,f}();function Jb(a,c,d){return new b(a,c,d)}function Kb(){var a=new b(0,"",""),c=new Hb(U,V,N);return c.setBorders(a),c}function Lb(a){var b=0,c=17,d=16;return a.indexOf(jb+"Light")>-1&&G(a)===c&&(b=parseInt(a[c-1])),a.indexOf(jb+"Dark")>-1&&G(a)===d&&(b=parseInt(a[d-1])),b>=1&&b<=6}d=function(){var a,b,c,d;function e(a,b,c,d){return E(a,b,c,d)}function f(){var a=this;a[P](""),a[sa](Kb(),!1)}for(a=[P,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba],b={constructor:f,name:e(P,""),fromJSON:function(b){var c,d,e,f;if(b&&!A.isEmptyObject(b))return c=this,d=b.name,F(d)&&(c.name(d,!1),Lb(d))?(e=d.toLocaleLowerCase().replace("slicerstyle","").replace(" ",""),f=Ib(e),void a.forEach(function(a){c[a](f[a](),!1)})):void a.forEach(function(a){var d,e=b[a];a!==P&&F(e)&&(d=Ib(),d.fromJSON(e),c[a](d,!1))})},toJSON:function(){var a,b,c,d=this;a=Lb(d.name())?{name:d.name()}:d.toJSONInternal(),b={};for(c in a)a[c]===M||a[c]===L||q.GC$.isEmptyObject(a[c])||(b[c]=a[c]);return b},toJSONInternal:function(){var b,c,d,e=this,f={},g="toJSON";for(f[P]=e.name(),b=1,c=G(a);b<c;b++)d=a[b],f[d]=e[d]()?e[d]()[g]():M;return f}},c=1,d=G(a);c<d;c++)b[a[c]]=e(a[c]);return f.prototype=b,f}();function Mb(){return new d}e=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){var w,x,y=Mb(),z=jb+a+b;return y[P](z),w=Ib(),w[ba](c)[da](d)[ca](e),y[sa](w),x=Ib(),x[ja](f)[ka](f)[la](f)[ma](g),y[ta](x),y[ua](Ob(h,i,j)),y[va](Ob(k,l,m)),y[wa](Ob(n,o,p)),y[xa](Ob(q,r,s)),Nb(y,Ob(t,u,v)),y};function Nb(a,b){a[ya](b)[za](b)[Aa](b)[Ba](b)}function Ob(a,b,c){var d=Ib();return d[ea](a)[da](b)[ca](c),d}function Pb(a){var b=ib+a;return e("Light",a,N,U,Jb(1,W,b),Jb(0,"",""),Jb(1,W,b),V,b+",Lighter 60%",Jb(1,W,kb),lb,b+",Lighter 80%",Jb(1,W,mb),V,U,Jb(1,W,mb),lb,U,Jb(1,W,"#E0E0E0"),V,"#F9E36F",Jb(1,W,kb))}function Qb(a){var b=ib+a;return e("Dark",a,N,U,Jb(1,W,b),Jb(0,"",""),Jb(1,W,b),U,b,Jb(1,W,b),b+",Darker 25%",b+",Lighter 60%",Jb(1,W,b+",Lighter 60%"),V,"#C0C0C0",Jb(1,W,"#C0C0C0"),"#959595","#DFDFDF",Jb(1,W,"#DFDFDF"),V,"#F9E36F",Jb(1,W,kb))}f=function(){function a(){}for(var b=1;b<=6;b++)a["light"+b]=function(a){return function(){return Pb(a)}}(b),a["dark"+b]=function(a){return function(){return Qb(a)}}(b);return a.other1=function(){return e("Other",1,N,U,Jb(1,W,"#808080"),Jb(0,"",""),Jb(1,W,"#A6A6A6"),V,"#BFBFBF",Jb(1,W,kb),V,"#D9D9D9",Jb(1,W,mb),V,U,Jb(1,W,mb),"#959595",U,Jb(1,W,"#E0E0E0"),V,"#F9E36F",Jb(1,W,kb))},a.other2=function(){return e("Other",2,N,U,Jb(1,W,"#4F81BD"),Jb(0,"",""),Jb(1,W,"#4F81BD"),V,"#A9C1E3",Jb(1,W,kb),lb,"#D5E2F6",Jb(1,W,mb),V,U,Jb(1,W,mb),lb,U,Jb(1,W,"#E0E0E0"),V,"#F9E36F",Jb(1,W,kb))},a}();function Rb(a,b){var c,d,e,f,g,h,i=a.KW,j=a._caption,k=Vb(a.slicerData),l=a.zoomFactor();if(b){b[sa]&&(Xb(a.xo,b[sa],k,j,l),uc(a,ob)),c=a.LW,d=Tb(b[sa],b[ta]),Yb(b)?(e=d[ma],f=e&&e[ga]||0,c[Q][aa]=(a.MW-f)*Zb(b)*l+Ha,Wb(c,e,k,ma),d[ja]=d[ka]=d[la]=d[ma]=M):(c[Q][ma+$]=0+Ha,c[Q][aa]=i[Q][aa]),Xb(i,d,k,j,l),uc(a,qb);for(g in a.NW)w(a.NW,g)&&(h=parseInt(g),rc(a,h))}}function Sb(a,b,c){var d,e,f={};if(b&&c&&G(b)===G(c)){for(d=0,e=G(b);d<e;d++)f[b[d]]=c[d];A(a).css(f)}}function Tb(a,b){var c={},d;if(b)for(d in b)w(b,d)&&(c[d]=b[d]);if(a)for(d in a)c[d]===L&&a[d]!==L&&(c[d]=a[d]);return c}function Ub(a,b){if(!b)return a;var c;return a&&b.getColor&&(c=b.getColor(a)),c}function Vb(a){var b=a&&a.OW&&a.OW();return b&&b.currentTheme()}function Wb(a,b,c,d){if(a){var e=b&&b[ga]||0,f=b&&b[ha]||"",g=b&&b[ia]||"";a[Q][d+_]=e+Ha,a[Q][d+R]=f,a[Q][d+Y]=Ub(g,c)}}function Xb(a,b,c,d,e){var f,g,h,i;a&&b&&(f=b[ea]||V,g=b[da]||U,h=b[ba]||N,a[Q][Z]=Ub(g,c),a[Q][X]=Ub(f,c),a[Q][ba]=H(B.No(h,e)[ba]),Wb(a,b[ja],c,ja),Wb(a,b[ka],c,ka),Wb(a,b[la],c,la),Wb(a,b[ma],c,ma),i=B.So(b[na]),r.u.Bb(a.className,rb)?d[Q][na]=i:r.u.Bb(a.className,Fb)&&(a[Q][na]=i))}function Yb(a){var b,c=a[ta];return!c||!(c[ja]||c[ka]||c[la]||c[la])||(b=Tb(a[sa],c),!(!(b[ma]&&b[ma][ga]>0)||b[ja]&&0!==b[ja][ga]||b[ka]&&0!==b[ka][ga]||b[la]&&0!==b[la][ga]))}function Zb(a){var b,c,d,e,f,g,h,i,j;return a?(b=Tb(a[sa],a[ta]),b&&b[ba]?(c=b[ba],d=1,e=B.Ko,f=B.Jo,g=e(f(N)).fontSize,h=e(f(c)).fontSize,g&&h&&(i=O(g),j=O(h),isNaN(j)||(d=j/i)),d):1):1}function $b(a){var b,c,d,e,f,g=0,h=0;return a&&(b=a[Q],c=b[ja+_],d=b[ka+_],e=b[la+_],f=b[ma+_],c&&(g+=O(c)),d&&(h+=O(d)),e&&(g+=O(e)),f&&(h+=O(f))),{widthOffset:g,heightOffset:h}}function _b(a){var b,c,d=[];if(a)for(c=0;c<G(a);c++)b=a[c]===L||a[c]===M||""===a[c]?y().Blank:a[c]+"",d.push(b);return d}function ac(a){var b=D(Ga);return Sb(b,[Ka,Ma,cb,Sa],[La,6*a.zoomFactor(),db,Ta]),A(b).addClass(pb),uc(a,ob),A(b).append(bc(a)).append(cc(a)),b}function bc(a){var b,c,d,e,f,g,h,i,j=D(Ga),k=D(Ga),l=D("span"),m=D(Ga),n=a.zoomFactor(),o=a.style();return Sb(j,[$,Ka,Na,Pa,Qa,cb,Sa],[Ua,La,0,0,0,db,Ta]),A(j).addClass(rb),a.KW=j,b=a.PW*n,Sb(k,[$,Ka,Pa,Qa,cb,Sa],[Ua,La,b,b,db,Ta]),A(k).addClass(sb),a.LW=k,A(j).append(k),c=a.QW*Zb(o)*n,d=fc(a)*n,Sb(l,[cb,Ka,Na,Sa,$,Va,Xa],[db,La,c,Ta,d,Wa,Ya]),A(l).text(a.captionName()).attr(Za,$a).addClass(tb+" "+Gb),a._caption=l,e=a.RW*n,f=a.SW*n,g=a.TW*Zb(o)*n,h=a.UW*n,i=a.VW*n+Ha,Sb(m,[$,aa,Ja,Ka,Na,Qa,Ra,cb,_a,bb,Sa,ab],[e,f,Ia,La,g,h,"center",db,"normal",2,Ta,i]),A(m).attr("title","Clear Filter (Alt+C)").attr(Za,$a).text(fb).addClass(vb+" "+Gb),a.WW=m,uc(a,qb),A(k).append(l).append(m),j}function cc(a){var b,c=D(Ga),d=D("table"),e=D("tr"),f=D("td"),g=D("td"),h=(a.MW-a.PW+a.XW)*Zb(a.style())*a.zoomFactor();return Sb(c,[$,Sa,Oa,cb],[Ua,Ta,h,db]),A(c).attr(Za,$a).addClass(xb+" "+Gb),a.YW=c,Sb(d,[cb,"border-spacing"],[db,0+Ha]),A(d).attr(Za,$a).addClass(yb+" "+Gb),a.ZW=d,A(e).css(cb,db).addClass(zb),a.$W=e,Sb(f,[Ma,cb],[0,db]),A(f).addClass(Ab),a._W=f,Sb(g,[Ma,cb,Ja],[0,db,Ia]),A(g).addClass(Bb),a.aX=g,A(f).append(dc(a)),b=lc(a),A(g).append(b),a.bX=b,A(e).append(f).append(g),A(d).append(e),A(c).append(d),c}function dc(a){var b,c,d,e,f,g,h,i=D(Ga),j=a.zoomFactor();for(a.cX=i,c=gc(a),a.dX=c,b=hc(a),a.eX=b,Sb(i,[$,aa,ab],[b*j,c*j,a.VW*j+Ha]),A(i).attr(Za,$a).addClass(Db+" "+Gb),d=kc(a),a.fX=d,e=Math.min(jc(a),G(d)),f=0;f<e;f++)g=d[f],h=ec(a,g,f),A(i).append(h),a._items.push(h),a.NW[a.gX.indexOf(g)]=h;return i}function ec(a,b,c){var d=b,e=D(eb),f=a.zoomFactor(),g=a.hX*f+Ha;return Sb(e,[Ra,Xa,Oa,Ja,cb,bb,Ma,Sa,Va,Z],[Pa,Ya,g,Ia,db,5,"1px 6px",Ta,Wa,U]),A(e).attr("type",eb).attr(Za,$a).text(d).addClass(Fb+" "+Gb),(c+1)%a.columnCount()!==0&&A(e).css("margin-right",a.hX*f+Ha),uc(a,Eb,e),e}function fc(a){var b,c,d=a.xo,e=a.KW,f=1,g=1,h=0,i=0,j=function(a){return a?O(a):0},k=fa+"Left"+_,l=fa+"Right"+_;return d&&(b=d.style,f=j(b[k]),g=j(b[l])),e&&(c=e.style,h=j(c[k]),i=j(c[l])),a.width()-(f+g)-2*a.PW-(h+i)-a.RW}function gc(a){var b=$b(a.xo),c=a.height()-2*a.PW-b.heightOffset;return a.showHeader()?c-a.MW*Zb(a.style())-a.XW:c}function hc(a){var b=$b(a.xo),c=a.width()-2*a.PW-b.widthOffset-1;return a.iX()?c-a.jX:c}function ic(a,b){var c=a.columnCount();return(b-(c-1)*a.hX)/c}function jc(a){return Math.ceil(a.dX/(a.itemHeight()+2*(a.kX+a.lX)+a.hX))*a.columnCount()}function kc(a){var b,c,d,e,f,g,h=a.gX,i=a.mX(h.slice(0),a.sortState()),j=a.slicerData.getFilteredOutIndexes(a.columnName,2);if(a.showNoDataItems()){if(a.visuallyNoDataItems()&&a.showNoDataItemsInLast()){for(b=[],d=G(i),e=0;e<d;e++)f=i[e],z.Bb(j,h.indexOf(f))||b.push(f);for(e=0;e<d;e++)f=i[e],z.Bb(j,h.indexOf(f))&&b.push(f);i=b}}else for(b=i.concat(),c=0;c<G(b);c++)z.Bb(j,h.indexOf(b[c]))&&z.Fb(i,b[c]);return g=y().Blank,z.Bb(i,g)&&(z.Fb(i,g),i.push(g)),i}function lc(a){var b,c=new q.hv((!1));return a.nX=c,b=c.Bv(),A(b).bind("scroll.gcScrollbar",function(b,c){var d,e=c.scrollEventType,f=c.scrollOrientation;b.data=a,1===f&&(d=[0,1,2,3,5],d.indexOf(e)>=0&&a.Bw(b,c))}),b}function mc(a){var b=a.slicerData;a.data=b.getData(a.columnName),a.exclusiveDatas=b.getExclusiveData(a.columnName),a.oX=_b(a.data),a.gX=_b(a.exclusiveDatas),a.fX=kc(a),tc(a),qc(a)}function nc(a,b){var c,d=a.style(),e=a.xo;e&&(b!==L&&b!==a.zoomFactor()&&(a.zoomFactor(b),Rb(a,d)),A(e).css(Ma,6*b),uc(a,ob),oc(a),c=a.showHeader()?(a.MW+a.XW-a.PW)*Zb(d)*b:0,A(a.YW).css(Oa,c),pc(a),tc(a))}function oc(a){var b,c,d,e,f,g,h,i,j,k=a.zoomFactor(),l=a.KW,m=a.YW,n=a._caption,o=a.WW,p=a.style();a.showHeader()?(a.xo.firstChild!==l&&(A(l).insertBefore(m),A(m).css(Oa,(a.MW+a.XW)*Zb(p)*k)),A(l).css(aa,a.MW*Zb(p)*k),b=a.PW*k,Sb(a.LW,[Pa,Qa],[b,b]),n.innerHTML!==a.captionName()&&A(n).text(a.captionName()),c=a.QW*Zb(p)*k,d=fc(a)*k,Sb(n,[Na,$,_a],[c,d,"bold"]),e=a.pX,f=e&&G(e)>0?1:0,Ec(a,f),g=a.RW*k,h=g,i=a.TW*Zb(p)*k,j=a.UW*k,Sb(o,[$,aa,Na,Qa],[g,h,i,j]),uc(a,qb)):A(l).remove()}function pc(a){var b,c=a.zoomFactor(),d=gc(a);a.dX=d,b=hc(a),a.eX=b,Sb(a.cX,[$,aa,ab],[b*c,d*c,a.VW*c]),qc(a)}function qc(a){var b,c,d,e,f,g,h,i,j=a.fX;if(j){for(b=a._items,b&&G(b)>0&&A(b).remove(),a._items=[],b=a._items,a.NW={},c=Math.min(jc(a),G(j)),d=a.iX()?a.nX.value()*a.columnCount():0,e=Math.min(d+c,G(j)),f=d;f<e;f++)g=j[f],h=ec(a,g,f),A(a.cX).append(h),b.push(h),a.NW[a.gX.indexOf(g)]=h;if(0!==G(b))for(i in a.NW)w(a.NW,i)&&rc(a,parseInt(i))}}function rc(a,b){var c=a.qX,d=c?a.gX.indexOf(c[hb]):-1,e=a.pX,f=a.rX,g=a.NW[b],h=0;b===d&&(h|=1),h|=z.Bb(e,b)?4:2,h|=z.Bb(f,b)&&a.visuallyNoDataItems()?16:8,sc(a,g,h)}function sc(a,b,c){var d=a.style(),e;if(b&&d){switch(c){case 10:e=ua;break;case 18:e=va;break;case 12:e=wa;break;case 20:e=xa;break;case 11:e=ya;break;case 19:e=za;break;case 13:e=Aa;break;case 21:e=Ba}Xb(b,Tb(d[sa],d[e]),Vb(a.slicerData),a._caption,a.zoomFactor()),uc(a,Eb,b)}}function tc(a){var b,c,d,e,f,g=a.bX,h=a.aX;a.iX()?(g||(g=lc(a)),h.firstChild!==g&&(A(h).append(g),pc(a)),b=a.zoomFactor(),c=a.dX,d=Math.floor(c/(a.itemHeight()+2*a.kX+a.hX)),e=a.nX,e.value(a.sX),e.Vo(a.jX*b,!1),e._v(c*b,!1),e.bw(0),e.cw(Math.ceil(G(a.gX)/a.columnCount())-d),e.dw(d),e.qB(1),e.rB(d-1),e.ew()):(h.firstChild===g&&(f=g.parentElement,f&&f.removeChild(g),pc(a)),a.sX=0)}function uc(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=a.zoomFactor();switch(b){case ob:g=a.xo,h=$b(g),i=a.PW,d=(a.width()-2*i)*n-h.widthOffset,e=(a.height()-2*i)*n-h.heightOffset,f=g;break;case qb:j=a.KW,k=$b(j),l=a.MW*Zb(a.style())*n-k.heightOffset,A(j).css(aa,l),d=a.RW*n,e=a.SW*n,f=a.WW;break;case Eb:m=$b(c),d=ic(a,a.eX)*n-2*a.tX-m.widthOffset,e=a.itemHeight()*n-m.heightOffset,f=c}Sb(f,[$,aa],[d,e])}function vc(a){var b=a.xo,c=".slicer",d="mouse",e="wheel",f="DOMMouseScroll";b&&(A(b).bind(d+"down"+c,function(b){a.AD(b)}).bind(d+"move"+c,function(b){a.BD(b)}).bind(d+"out"+c,function(b){a.uX(b)}),b.addEventListener(d+e,function(b){a.Rw(b)},!1),b.addEventListener(f,function(b){a.Rw(b)},!1),A(K).bind(d+"up"+c,function(b){Dc(a,b)}).bind("keydown"+c,function(b){a.nm(b)}).bind("keyup"+c,function(b){a.om(b)}),K.addEventListener(d+e,function(b){a.Rw(b)},!1),K.addEventListener(f,function(b){a.Rw(b)},!1))}function wc(a){var b=a.xo;b&&A(b).unbind(".slicer")}function xc(a,b){var c,d,e,f=a.exclusiveDatas,g=a.pX,h=Bc(a,b[hb]),i=a.vX,j=a.wX;for(z.Bb(i,h)?z.Fb(i,h):i.push(h),c=0;c<G(f);c++)z.Bb(g,c)||j.push(c);for(d=0;d<G(i);d++)z.Bb(j,i[d])?z.Fb(j,i[d]):j.push(i[d]);if(0===G(j))for(e=0;e<G(a.gX);e++)j.push(e);a.xX=h}function yc(a,b){var c,d,e,f,g,h,i,j,k=a.fX,l=a.gX,m=l[a.xX];for(Ac(a),c=k.indexOf(m),d=k.indexOf(b[hb]),e=Math.min(c,d),f=Math.max(c,d),g=e;g<=f;g++)h=l.indexOf(k[g]),i=a.vX,j=a.wX,i.indexOf(h)===-1&&i.push(h),j.indexOf(h)===-1&&j.push(h)}function zc(a,b){Ac(a);var c=Bc(a,b[hb]);rc(a,c),a.vX.push(c),a.wX.push(c),a.xX=c}function Ac(a){var b,c,d,e,f,g,h=a._items;if(h&&0!==G(h))for(b=a.rX,c=0,d=G(h);c<d;c++)e=h[c],f=a.gX.indexOf(h[c].innerHTML),g=z.Bb(b,f)?20:12,sc(a,e,g)}function Bc(a,b){var c,d,e=a.gX;if(e)for(c=0,d=G(e);c<d;c++)if(e[c]===b)return c;return-1}function Cc(a,b){var c,d,e=a.pX,f=a.rX;for(c=0;c<G(b);c++)d=0,d|=a.yX?z.Bb(e,b[c])?2:4:2,d|=z.Bb(f,b[c])&&a.visuallyNoDataItems()?16:8,sc(a,a.NW[b[c]],d)}function Dc(a,b){var c=a.qX;a.CD(b),c=c?new h(c[gb],c[hb]):M,a.qX=M,Fc(a,c)}function Ec(a,b){var c,d,e,f=a.WW;if(f)switch(c=a.style(),d=Tb(c[sa],c[ta]),e=d&&d[da],e||(e=U),a.zX=e,b){case 0:a.AX=!1,Sb(f,[X,Z],[a.BX,e]);break;case 1:a.AX=!0,Sb(f,[X,Z],[a.CX,e]);break;case 2:A(f).css(Z,a.DX)}}function Fc(a,b){var c,d;if(b)switch(c=a.vX,b[gb]){case 4:if(!a.WW)return;a.AX?Ec(a,1):Ec(a,0);break;case 5:d=a.gX.indexOf(b[hb]),c&&z.Bb(c,d)?Cc(a,c):rc(a,d)}}function Gc(a,b){if(b)switch(b[gb]){case 4:if(!a.WW||!a.AX)return;Ec(a,2);break;case 5:var c=a.gX.indexOf(b[hb]);rc(a,c);break;case 6:a.cX.style.cursor=Ia}}function Hc(a,b){var c,d,e=a._items;if(e&&b!==M)for(c=0;c<G(e);c++)if(d=e[c],d.innerHTML.toLowerCase()===b.toLowerCase())return d;return M}function Ic(a,b){var c,d,e,f,g,i,j,k,l,m,n,o=Jc(a,ob),p=M,q=M;if(!o)return M;if(c=b.pageX,d=b.pageY,e=Jc(a,qb),f=Jc(a,ub),g=Jc(a,wb),i=Jc(a,Cb),e&&e.contains(c,d))p=f&&f.contains(c,d)?4:1;else if(g&&g.contains(c,d))if(j=a._items,i&&i.contains(c,d)&&j){for(k=0;k<G(j);k++)if(l=Jc(a,Eb,k),l&&l.contains(c,d)){p=5;for(m in a.NW)if(a.NW[m]===j[k]){q=a.gX[m];break}break}k>=G(j)&&(n=Jc(a,Eb,G(j)-1),p=d<n.y+a.itemHeight()*a.zoomFactor()?6:7)}else p=8;else p=0;return new h(p,q)}function Jc(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=b===ob?L:Jc(a,ob),p=a.xo,r=a.EX,s=a.PW,t=a.zoomFactor(),u=a.style(),v=a.showHeader(),w=a.MW,x=a.RW,y=a.gX;switch(b){case ob:d=0,e=0,f=p.offsetWidth,g=p.offsetHeight;do d+=p.offsetLeft,e+=p.offsetTop,p=p.offsetParent;while(p);break;case qb:if(!o||!v)return M;d=o.x+r*t,e=o.y+r*t,f=a.width()*t,g=w*Zb(u)*t;break;case ub:if(!o||!v)return M;d=o.x+o.width-(r+s+x)*t,e=o.y+r+a.QW*Zb(u)*t,f=x*t,g=a.SW*t;break;case wb:if(!o)return M;h=r+s,i=0,j=w*Zb(u)+a.XW,d=o.x+h*t,e=o.y+i*t+(v?j*t:0),f=(a.width()-2*h)*t,g=o.height-2*i*t-(v?j*t:0);break;case Cb:if(k=Jc(a,wb),!k)return M;if(!a.iX())return k;d=k.x,e=k.y,f=k.width-a.jX*a.zoomFactor(),g=k.height;break;case Eb:if(!o||0===G(y)||c>=G(y))return M;if(l=Jc(a,Cb),!l)return M;m=a.columnCount(),n=a.hX,f=(l.width-(m-2)*n*t)/m,g=a.itemHeight()*t+2*a.lX,d=l.x+c%m*(f+n*t),e=l.y+Math.floor(c/m)*(g+n*t)}return new q.Rect(d,e,f,g)}function Kc(a){return a>0}g=function(){var a,b,c,d;function e(a){return function(b,c){nc(this),this.onPropertyChanged(a,b,c)}}function f(a){return function(b,c){var d=this;d.fX=kc(d),nc(d),d.onPropertyChanged(a,b,c)}}function g(a,b,c,d){return c||(c=e(a)),q.Ul.Pl(a,b,c,d)}function i(a,b,c){var d=this;d.name(a,!1),d.xo=M,d.PW=6,d.EX=1,d.VW=14,d.KW=M,d.MW=27,d.XW=5,d._caption=M,d.WW=M,d.RW=28,d.SW=25,d.TW=3,d.UW=0,d.AX=!1,d.QW=3,d.YW=M,d.ZW=M,d.$W=M,d._W=M,d.aX=M,d.cX=M,d.eX=0,d.dX=0,d.bX=M,d.FX=2,d._items=[],d.NW={},d.lX=1,d.kX=1,d.tX=6,d.hX=2,d.jX=17,d.sX=0,d.zX=U,d.DX="#F9E578",d.CX="red",d.BX="#B0ADB0",d.GX=!1,d.HX=!1,d.vX=[],d.wX=[],d.xX=0,d.fX=[],d.pX=[],d.rX=[],d.gX=[],d.oX=[],d.slicerData=b,d.columnName=c,d.data=b.getData(c),d.exclusiveDatas=b.getExclusiveData(c),d.slicerData.attachListener(d),d.IX()}for(i.getDefaultStyle=function(){var a=function(a,b,c,d,e,f,g,h){var i={};return i[da]=a,i[ea]=b,i[ba]=c,i[ja]=d,i[ka]=e,i[la]=f,i[ma]=g,i[na]=h,i},b=function(a,b,c){var d={};return d[ga]=a,d[ha]=b,d[ia]=c,d},c=b(1,W,"#808080"),d=b(0,"",""),e=b(1,W,"#999999"),f=b(1,W,"#CCCCCC"),g=b(1,W,"#E0E0E0"),h=a("#F9E36F",V,N,e,e,e,e),i={};return i[sa]=a(U,V,N,c,c,c,c),i[ta]=a(U,V,"bold 11pt calibri",d,d,d,b(1,W,"#A6A6A6")),i[ua]=a("#BFBFBF",V,N,e,e,e,e),i[va]=a("#D9D9D9",V,N,f,f,f,f),i[wa]=a(U,V,N,f,f,f,f),i[xa]=a(U,"#959595",N,g,g,g,g),i[ya]=h,i[za]=h,i[Aa]=h,i[Ba]=h,i},a=[[P],[$,180],[aa,210],["captionName",""],["columnCount",1,M,Kc],["itemHeight",21,M,Kc],["showHeader",!0],["sortState",1,f("sortState")],["showNoDataItems",!0,f("showNoDataItems")],["showNoDataItemsInLast",!0,f("showNoDataItemsInLast")],["visuallyNoDataItems",!0,f("visuallyNoDataItems")],[Q,i.getDefaultStyle(),function(a,b){Rb(this,a),nc(this),this.onPropertyChanged("visuallyNoDataItems",a,b)}],["zoomFactor",1,M,Kc],["isLocked"],["disableResizingAndMoving"]],b={constructor:i,IX:function(){var a=this;a.oX=_b(a.data),a.gX=_b(a.exclusiveDatas),a.xo=ac(a),a.captionName(a.columnName,!1),vc(a),a.onFiltered(),Rb(a,a.style()),nc(a)},getDOMElement:function(){return this.xo},mX:function(a,b){var c,d,e=[];if(0!==b){for(c=s.jf.quickSort(a),d=0;d<G(c);d++)e[d]=c[d].value;return 2===b&&e.reverse(),e}},iX:function(){var a=this,b=a.gX,c=a.showNoDataItems()?G(b):G(b)-G(a.rX),d=Math.ceil(c/a.columnCount())*(a.itemHeight()+2*(a.lX+a.kX)+a.hX);return d>a.dX},Bw:function(a,b){this.JX(a,b)},JX:function(a,b){var c=this,d=b.newValue;d!==c.sX&&d<=c.nX.cw()&&(c.sX=d,tc(c),qc(c))},onDataChanged:function(){mc(this)},onRowsChanged:function(){mc(this)},onColumnNameChanged:function(a,b){var c=this;c.columnName===a&&c._caption&&(c.columnName=b,c.captionName(b,!1),A(c._caption).text(b))},onColumnRemoved:function(a){var b=this;a===b.columnName&&(b.slicerData.doUnfilter(a),wc(b),A(b.xo).remove(),b.xo=M)},onFiltered:function(){var a=this,b=a.slicerData,c=a.columnName;a.fX=kc(a),a.rX=b.getFilteredOutIndexes(c,2),a.pX=b.getFilteredOutIndexes(c,1),nc(a)},xmb:function(a){var b,c=Ic(this,a);return!!c&&(b=c.mark,5===b||6===b||8===b||4===b)},AD:function(a){var b=this,c=Ic(b,a);c&&(8===c[gb]&&(b.HX=!0),5===c[gb]&&(b.wX=[],b.GX=!0,a.ctrlKey?xc(b,c):a.shiftKey?yc(b,c):zc(b,c)),Cc(b,b.vX),(5===c[gb]||6===c[gb]||8===c[gb]||4===c[gb]&&b.AX)&&a.stopPropagation())},CD:function(a){var b,c,d,e=this,f=Ic(e,a);f&&(b=e.slicerData,c=e.vX,d=!1,4===f[gb]?e.AX&&(b.doUnfilter(e.columnName),Ec(e,0),d=!0):c&&G(c)>0&&!e.yX&&!e.KX&&(b.doFilter(e.columnName,{exclusiveRowIndexes:e.wX}),d=!0),e.GX=!1,e.HX=!1,d&&(e.vX=[],e.wX=[]))},BD:function(a){var b,c,d,e,f,g,i,j,k,l,m,n,o,p=this,q=p.qX,r=q?new h(q[gb],q[hb]):M,s=Ic(p,a),t=p.gX,u=p.wX;if(s&&(!r||r[gb]!==s[gb]||5===r[gb]&&r[hb]!==s[hb])){if(!p.GX)return p.qX=s,Fc(p,r),void Gc(p,s);if(5===s[gb])if(b=t.indexOf(s[hb]),c=p.rX,z.Bb(u,b)){for(i=p.fX,j=i.indexOf(t[p.xX]),k=i.indexOf(s[hb]),l=Math.min(j,k),m=Math.max(j,k),n=[],d=0,e=G(u);d<e;d++)o=u[d],f=i.indexOf(t[o]),(f>m||f<l)&&n.push(o);for(d=0,e=G(n);d<e;d++)f=n[d],g=Hc(p,t[f]),z.Bb(c,f)?sc(p,g,20):sc(p,g,12),z.Fb(u,f)}else g=Hc(p,t[b]),z.Bb(c,b)?sc(p,g,18):sc(p,g,10),z.Sb(u,b);p.qX=s}},uX:function(){var a=this,b=a.qX,c=b?new h(b[gb],b[hb]):M;a.qX=M,Fc(a,c)},Rw:function(a){var b=Ic(this,a);return 8===b[gb]&&(a.stopPropagation(),!0)},nm:function(a){var b=this;17!==a.keyCode||b.yX||(b.yX=!0),16!==a.keyCode||b.KX||(b.KX=!0)},om:function(a){var b=this,c=b.slicerData;17===a.keyCode&&b.yX&&(b.yX=!1),16===a.keyCode&&b.KX&&(b.KX=!1),!b.yX&&!b.KX&&G(b.vX)>0&&(c.doFilter(b.columnName,{exclusiveRowIndexes:b.wX}),b.vX=[],b.wX=[])},onPropertyChanged:function(a,b,c){var d,e=this;e.slicerData.OW&&(d=e.slicerData.OW(),d.ITa.xVa(e,a,c))}},c=0,d=G(a);c<d;c++)b[a[c][0]]=g(a[c][0],a[c][1],a[c][2],a[c][3]);return A.extend(i.prototype,b),i}(),h=function(){function a(a,b){var c=this;c[gb]=a===L?M:a,c[hb]=b===L?M:b}return a}();function Lc(a,b,c){var d,e,f,g,h=a.sj,i=h.kj,j=h.dataRange(),k=j.row+j.rowCount-1,l=j.col+j.colCount-1;for(d=j.row;d<=k;d++)for(e=[],b.push(e),f=j.col;f<=l;f++)e.push({value:i.getValue(d,f),text:i.getText(d,f)});for(f=0;f<j.colCount;f++)g=h.getColumnName(f)||"",c.push(g)}function Mc(a,b){var c,d,e=a.kj,f=a.sj.rowFilter();for(e.suspendPaint(),c=f&&f.Je||[],d=0;d<G(c);d++)Nc(a,b,[c[d]]);e.resumePaint()}function Nc(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(d=0;d<c.length;d++){if(e=a.sj,f=a.xr,g=c[d]-e.range().col,h=e.dataRange(),i=g+h.col,j=a.columnNames[g],k=[],l={},z.Bb(f.Je,i)){for(m=[],n=h.row;n<h.row+h.rowCount;n++)f.E0a(n,i)||m.push(n);for(o=0;o<G(m);o++)p=m[o]-h.row,q=a.getExclusiveRowIndex(j,p),l[q]||(l[q]=!0,k.push(q))}else for(r=G(a.getExclusiveData(j)),s=0;s<r;s++)k.push(s);Oc(Pc(a,j),k)||(b.prototype.doFilter.call(a,j,{exclusiveRowIndexes:k}),a.onFiltered(),a.kj.$p())}}function Oc(a,b){var c,d=r.j.Fa;if(d(a)&&d(b))return!0;if(d(a)&&!d(b)||!d(a)&&d(b)||!d(a)&&!d(b)&&(!I(a)||!I(b))||a.length!==b.length)return!1;for(c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function Pc(a,b){var c,d=a.getExclusiveData(b),e=a.getFilteredOutIndexes(b,1),f=[];for(c=0;c<G(d);c++)z.Bb(e,c)&&f.push(c);return f}i=function(a){A.inherit(b,a);function b(b){var c=this,d=[],e=[],f=b.rowFilter();c.sj=b,c.kj=b.kj,c.xr=f,c.MX=M,Lc(c,d,e),a.call(c,d,e),Mc(c,a),f&&(f.filterHandler=function(b){Nc(c,a,b.columns)})}var c={constructor:b,OW:function(){return this.kj},getTable:function(){return this.sj},doFilter:function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this,u=t.kj,w=t.sj,x=t.xr,y=c.ranges,z=c.exclusiveRowIndexes,A=!!z;if(u.ITa.xVa(t,Ca,{columnName:b,oldValue:t.getFilteredIndexes(b)}),e=t.getColumnIndex(b),!(e<0||!A&&!y))if(d)a.prototype.doFilter.call(t,b,c,d);else{if(f=A?t.getExclusiveData(b):t.getData(b),g=[],A)g=z;else for(h=t.ef(),i=t.ff(),h[e]||t.We(e),j=h[e],k=0;k<G(y);k++)for(l=y[k],m=t.Xe(j,l),n=m.start;n<=m.end;n++)g.push(i[e][n]);if(u.suspendPaint(),o=w.startColumn()+e,x&&x.removeFilterItems(o,!0),u.AR(),v)for(p=0;p<G(g);p++)q=new v.$V(2,0,f[g[p]]),q.useWildCards(!1),x&&x.addFilterItem(o,q);a.prototype.hf.call(t,b,c),r=[],s={},t.gf(b,r,s),x&&(x.filter(o,!0),x.onFilter(x.SX(0,[o]))),t.onFiltered(),u.resumePaint()}},doUnfilter:function(b){var c,d=this,e=d.kj,f=d.sj,g=d.getColumnIndex(b),h=d.xr;g!==-1&&(e.ITa.xVa(d,Ca,{columnName:b,oldValue:d.getFilteredIndexes(b)}),c=f.startColumn()+g,h.removeFilterItems(c),a.prototype.if.call(d,b),h.unfilter(c,!0),h.onFilter(h.SX(0,[c])),d.onFiltered(),d.kj.$p())},refresh:function(){var a=this,b=[],c=[];Lc(a,b,c),a.bf(b,c),a.cf()},onColumnNameChanged:function(b,c){var d=this;a.prototype.onColumnNameChanged.call(d,b,c),d.kj.slicers.all().forEach(function(a){a.columnName(c)})},onRowsAdded:function(b,c){var d,e,f=this,g=f.kj,h=f.sj,i=h.dataRange();for(a.prototype.onRowsAdded.call(f,b,c,!0),d=b;d<b+c;d++)for(e=0;e<G(f.columnNames);e++)f.data[d][e]={value:g.getValue(i.row+d,i.col+e),text:g.getText(i.row+d,i.col+e)};f.bf(f.data,f.columnNames),f.cf(b,c,!0,"onRowsChanged")},onRowsRemoved:function(b,c){a.prototype.df.call(this,b,c,!1)},onColumnsAdded:function(a,b){var c,d,e,f,g=this,h=g.kj,i=g.sj,j=i.dataRange(),k=g.data,l=g.columnNames;for(c=0;c<G(k);c++)for(d=a;d<a+b;d++)k[c].splice(d,0,{value:h.getValue(j.row+c,j.col+d),text:h.getText(j.row+c,j.col+d)});for(e=a;e<a+b;e++)f=i.getColumnName(e)||"",l.splice(e,0,f);g.bf(k,l)},onColumnsRemoved:function(b,c){var d,e,f=this,g=f.kj,h=f.sj.name(),i=f.columnNames,j=[];for(d=b;d<b+c;d++)j.push(i[d]);a.prototype.onColumnsRemoved.call(f,b,c),e=g&&g.slicers,j.forEach(function(a){e.all(h,a).forEach(function(a){e.remove(a.name())})})},onTableRemoved:function(a){var b,c,d,e=this;a&&a===e.sj&&(e.MX=[],b=e.kj,c=b.slicers,d=a.name(),c.all(d).forEach(function(a){e.MX.push(a),c.remove(a.name())}),c&&Sc(c,e),e.Ze=[])},onTableAdded:function(a){var b,c=this,d=c.kj,e=d.slicers;e&&a&&a.Aq()&&Rc(e,a.getSlicerData()),b=c.MX||[],b.forEach(function(a){var b=a.name(),c=a.ZX.sj.name(),d=a.columnName(),f=a.style();e.add(b,c,d,f)})}};return A.extend(b.prototype,c),b}(s.GeneralSlicerData),u&&A.extend(u.Table.prototype,{getSlicerData:function(){var a=this;return a.ZX||(a.ZX=new i(a)),a.ZX}});function Qc(a){var b=a.sj,c=b.kj,d=b&&b.rowFilter();return!c.options.isProtected||d&&d.TX(c)}j=function(a){A.inherit(b,a);function b(b,c,d){a.call(this,b,c,d),this.isSelected(!1)}var c={constructor:b,isSelected:E("isSelected",!1),sheet:E("sheet"),slicer:E("slicer"),IX:function(){var b=this,c=b.slicerData;c&&c instanceof i&&(b.sheet(c.OW()),b.sj=c.getTable()),a.prototype.IX.call(this)},onColumnRemoved:function(a){var b,c=this,d=c.sheet(),e=c.sj,f=c.slicerData;a===c.columnName&&(b=f.getFilteredOutIndexes(a,1),0!==G(b)&&f.doUnfilter(a),d&&e&&d.wr.Fb(c.name()))},mX:function(a,b){var c,d,e,f,g,h,i=this,j=i.slicerData,k=j.getColumnIndex(i.columnName),l=i.sj,m=l.dataRange(),n=[];if(0===b)return a;for(c=[],d=j.OW(),e=0;e<G(a);e++)f=j.getRowIndexes(i.columnName,e),c.push(d.getValue(m.row+f[0],m.col+k));for(g=s.jf.quickSort(c),h=0;h<G(g);h++)n[h]=a[g[h].index];return 2===b&&n.reverse(),n},Bw:function(b,c){var d,e,f=this,g=f.sheet(),h=f.slicer();for(h&&g.ER(h)||(c.newValue=c.oldValue),d=Yc(h),e=0;e<G(d);e++)a.prototype.JX.call(d[e],b,c)},AD:function(b){var c,d,e,f=this,g=f.sheet(),h=f.slicer();if(h&&g.ER(h)){if(c=Ic(f,b),!Qc(f)&&(5===c[gb]||6===c[gb]||8===c[gb]))return void b.stopPropagation();for(d=Yc(h),e=0;e<G(d);e++)a.prototype.AD.call(d[e],b)}},CD:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this,q=p.sheet(),r=p.slicer();if(r&&q.ER(r)&&Qc(p)&&(b=Ic(p,a))){for(c=p.slicerData,d=p.vX,e=p.wX,f=c.getExclusiveData(p.columnName),g=!1,h=M,4===b[gb]||5===b[gb]&&G(e)===G(f)&&!p.yX&&!p.KX?(i=c.getFilteredIndexes(p.columnName),h=q.wu().execute({cmd:"unfilterSlicer",sheetName:q.name(),slicerData:c,columnName:p.columnName,value:i}),g=!0):d&&G(d)>0&&!p.yX&&!p.KX&&(j=c.getFilteredIndexes(p.columnName),k=e.concat(),h=q.wu().execute({cmd:"filterSlicer",sheetName:q.name(),slicerData:c,columnName:p.columnName,oldValue:j,newValue:k}),g=!0),l=Yc(r),m=0,n=G(l);m<n;m++)o=l[m],o.GX=!1,o.HX=!1,g&&(o.vX=[],o.wX=[]);return!!h}},BD:function(b){var c,d,e=this,f=e.sheet(),g=e.slicer();if(g&&!e.HX&&f.ER(g))for(c=Yc(g),d=0;d<G(c);d++)a.prototype.BD.call(c[d],b)},uX:function(b){var c,d,e=this,f=e.sheet(),g=e.slicer();if(g&&f.ER(g))for(c=Yc(g),d=0;d<G(c);d++)a.prototype.uX.call(c[d],b)},Rw:function(b){var c,d,e,f,g=this;return!!a.prototype.Rw.call(this,b)||(c=g.sheet(),d=c.slicers,e=d&&d.UX(),f=g.nX,!!(e&&1===G(e)&&g.isSelected()&&g.iX()&&f)&&(f.sC(b),b.stopPropagation(),!0))},om:function(a){var b,c,d,e,f=this,g=f.slicerData,h=f.sheet(),i=f.wX;17===a.keyCode&&f.yX&&(f.yX=!1),16===a.keyCode&&f.KX&&(f.KX=!1),!f.yX&&!f.KX&&G(f.vX)>0&&(b=G(g.getExclusiveData(f.columnName)),G(i)===b?(c=g.getFilteredIndexes(f.columnName),h.wu().execute({cmd:"unfilterSlicer",sheetName:h.name(),slicerData:g,columnName:f.columnName,value:c})):(d=g.getFilteredIndexes(f.columnName),e=i.concat(),h.wu().execute({cmd:"filterSlicer",sheetName:h.name(),slicerData:g,columnName:f.columnName,oldValue:d,newValue:e})),f.vX=[],f.wX=[])}};return A.extend(b.prototype,c),b}(g);function Rc(a,b){var c,d,e=a.VX;if(b){for(c=b.getTable(),d=0;d<G(e);d++)if(e[d].getTable()===c)return;e.push(b)}}function Sc(a,b){z.Fb(a.VX,b)}function Tc(a,b){var c,d,e,f=a.VX;for(c=0;c<G(f);c++)if(d=f[c],e=d.getTable(),d&&e&&e.tableName()===b)return d;return M}function Uc(a,b,c){var d;return b?w(Vc(a),b)&&(d=y().Exp_SlicerNameExist):d=y().Exp_SlicerNameInvalid,d&&c&&(c.error=Error(d)),!d}function Vc(a){var b,c,d,e=a.kj,f={},g=e&&e.parent&&e.parent.sheets;if(g)for(b=0;b<G(g);b++){c=g[b].slicers.XX();for(d in c)w(c,d)&&(f[d]=c[d])}return f}k=function(){function a(a){var b=this;b.kj=a,b.VX=[],b.WX={}}return a.prototype={constructor:a,add:function(a,b,c,d){var e,f=this,g=f.kj,h=g.parent,i=h.jga(b);return i&&i.getColumnIndexInTable(c)!==-1?(g.suspendPaint(),e=new l(a,i,c),d&&e.style(d),f.Cz(e),g.wr.Sb(e),g.resumePaint(),e):M},Cz:function(a){var b,c,d=this,e=d.kj;if(a){if(b=a.name(),c={},!Uc(d,b,c))throw c.error;d.WX[b]=a,Rc(d,a.YX()),e.ITa.xVa(d,Da,b)}},get:function(a){return a===M||a===L?M:this.WX[a]},remove:function(a){var b=this,c=b.kj;b.vV(a),c.wr.Fb(a)},vV:function(a){var b,c,d,e=this,f=e.kj,g=e.WX,h=e.get(a);if(h&&w(g,a)){for(b=h.YX(),c=Yc(h),d=0;d<G(c);d++)b.detachListener(c[d]);f.ITa.xVa(e,Ea,h),delete e.WX[a]}},U3:function(a,b){var c,d=this,e=d.kj,f={};if(!Uc(d,b,f))throw f.error;c=d.WX[a],delete d.WX[a],d.WX[b]=c,e.wr.U3(a,b)},clear:function(){var a=this,b=a.kj;b.suspendPaint(),A.each(this.WX,function(b,c){a.remove(c.name())}),b.resumePaint()},all:function(a,b){var c=[];return A.each(this.WX,function(d,e){a&&(Xc(e).name()!==a||b&&e.columnName()!==b)||c.push(e)}),c},tTa:function(a,b,c){t.FloatingObjectCollection.prototype.tTa.call(this,a,b,c)},XX:function(){return this.WX},HS:function(a){var b,c,d,e=Vc(this);if(!w(e,a))return a;for(b=1,c=" ",d=a.split(c)[0];w(e,d+c+b);)b++;return d+c+b},UX:function(){var a,b,c,d=this,e=d.WX;if(!e||q.GC$.isEmptyObject(e))return[];a=[];for(b in e)w(e,b)&&(c=e[b],c&&c.isSelected()&&a.push(c));return a},W3:function(a){var b,c,d=this,e=d.UX();if(1!==G(e))return!1;if(b=Yc(e[0]),G(b)>0){for(c=0;c<G(b);c++)b[c].Rw(a);return!0}return!1},toJSON:function(){var a,b=this,c=[],d=b.WX;if(d&&!q.GC$.isEmptyObject(d))for(a in d)w(d,a)&&c.push(d[a].toJSON());return c},fromJSON:function(a){var b,c,d,e,f,g,h,i;if(a&&0!==G(a))for(b=this,c=b.kj,d=c.parent,b.WX={},e=0;e<G(a);e++)f=a[e].tableName,g=a[e].columnName,f&&g&&(h=d.jga(f),h&&h.getColumnIndexInTable(g)!==-1&&(i=new l(a[e].name,h,g),i.sheet(c),i.fromJSON(a[e]),c.slicers.Cz(i),c.wr.Sb(i)))}},a}();function Wc(a,b,c){var d,e,f=a.ZX;f&&(d=f.OW(),e=d.slicers,e.all().forEach(function(d){d===a&&(e.U3(b,c),a.onPropertyChanged(P,c,b))}))}function Xc(a){return a.ZX.getTable()}function Yc(a){return a.$X}l=function(a){var b,c,d,e,g,h="nameInFormula",i="captionName",k="columnCount",l="columnName",m="itemHeight",n="showHeader",o="sortState",p="disableResizingAndMoving",r="showNoDataItems",s="showNoDataItemsInLast",t="visuallyNoDataItems",u="isSelected",v="dynamicMove",w="dynamicSize",x="tableName",y="Slicer",z=100,B=100,C=192,D=250;
A.inherit(J,a),b=[];function F(a,c,d,e){return b.push(a),E(a,c,function(b,c){d.call(this,a,b,c)},e)}function H(a){var b,c,d,e,f;if(!a)return!1;if(b=this,c=b.ZX,a===b.name())return!1;if(c&&(d=c.OW(),e=d&&d.slicers,e&&(f={},!Uc(e,a,f))))throw f.error;return!0}function I(a,b,c){var d,e,f=this,g=f.$X||[];for(d=0;d<G(g);d++)g[d][a]&&("style"===a?g[d][a](b.toJSONInternal()):g[d][a](b));e=f.sheet(),e&&(e.ITa.xVa(f,a,c),f.Wq({sheet:e,sheetName:e.name(),slicer:f,propertyName:a}))}function J(b,c,d){a.call(this,b,z,B,C,D);var e=this,f,g;e.typeName=y,e.g3=y,c&&(f=c.kj,e.sheet(f),g=Tc(f.slicers,c.tableName())),g||(g=c.getSlicerData()),e.ZX=g,e[l](d),e.$X=[],e._X=d,e[h](y+"_"+d),e[i](d),e[w](!1),e[v](!1)}for(c=[[P,"",function(a,b,c){Wc(this,c,b)},H],[i,"",I],[k,1,I,Kc],[m,21,I,Kc],[n,!0,I],[o,1,I],[p,!1,function(a,b,c){var d,e=this;e.allowMove(!b,!1),e.allowResize(!b,!1),I.call(e,p,b,c),d=e.sheet(),d&&d.$p()}],[r,!0,I],[s,!0,I],[t,!0,I],[Q,f.light1(),I],[l,"",function(a,b,c){var d,e=this;e._X=b,e.captionName(b,!1),d=e.sheet(),d.ITa.xVa(e,a,c)}]],d={constructor:J,sourceName:function(){return this._X},nameInFormula:F(h,"",I),onPropertyChanged:I,cloneContent:function(){var a=this,b=a.sheet(),c=a.ZX,d=new j(a.name(),c,a.columnName());return d[$](a[$](),!1)[aa](a[aa](),!1)[i](a[i]())[k](a[k]())[m](a[m]())[n](a[n]())[o](a[o]()).isLocked(a.isLocked())[p](a[p]())[r](a[r]())[s](a[s]())[t](a[t]())[Q](a[Q]().toJSONInternal()).zoomFactor(b.zoom())[u](a[u]()).slicer(a),d.sheet()!==b&&d.sheet(b),a.$X.push(d),d.getDOMElement()},YX:function(){return this.ZX},hga:function(){return!1},refresh:function(a){var b,c=this.$X;for(b=0;b<G(c);b++)nc(c[b],a)},refreshContent:function(a){var b=this,c=b.sheet().zoom();c!==b.MP&&(b.MP=c,b.refresh(c))},clone:function(a){var b,c=this;return!c.sheet()&&a&&c.sheet(a,!1),b=new J(c.name(),Xc(c),c.columnName()),b.sheet(c.sheet(),!1),b.fromJSON(c.toJSON(),!1,c.ZX),b},fromJSON:function(c,d,e){var f,g,h,i,j,k,m,n,o,p,r;c&&(f=this,g=c.tableName,h=c[l],g&&h&&(a.prototype.fromJSON.call(this,c),i=f.sheet(),j=i.slicers,k=i.parent,m=e?e:Tc(j,g),m||(n=k.jga(g),m=n.getSlicerData(),Rc(j,m)),f.ZX=m,f[l](h),o=c.x!==L?c.x:z,p=c.y!==L?c.y:B,f.position(new q.Point(o,p),!1),f[$](c[$]!==L?c[$]:C,!1),f[aa](c[aa]!==L?c[aa]:D,!1),c.sourceName!==L&&(f._X=c.sourceName),b.forEach(function(a){var b=c[a];b!==L&&f[a](b,!1)}),c.style!==L&&(r=Mb(),r.fromJSON(c.style),f.style(r,!1))))},toJSON:function(){var a,c,d,e=this,f={},g=["x","y",$,aa,v,w,"isLocked","fixedPosition"];return g.forEach(function(a){var b=e[a]();e[a].isDefault(b)&&a!==v&&a!==w||(f[a]=b)}),a=e._X,a&&(f.sourceName=a),e[Q]()&&(f[Q]=e[Q]().toJSON()),c=e.ZX,d=c.getTable(),d[x]&&(f[x]=d[x]()),b.forEach(function(a){var b=e[a]();a===Q||e[a].isDefault(b)||(f[a]=b)}),f},Wq:function(a){var b=this.sheet();b&&b.Wq(q.Events.SlicerChanged,a)}},e=0,g=G(c);e<g;e++)d[c[e][0]]=F(c[e][0],c[e][1],c[e][2],c[e][3]);return A.extend(J.prototype,d),J}(t.FloatingObject),J(q.Worksheet.prototype,{t4:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n;if(e===L&&(e=3),f=this,g=f.tables){for(h=0;h<c;h++)for(i=0;i<d;i++)j=h+a,k=i+b,l=g.find(j,k),3===e&&l&&l.Aq()&&(m=l.dataRange(),m.contains(j,k)&&(n=l.getSlicerData(),n&&n.onDataChanged([{columnName:l.getColumnName(k-m.col),row:j-m.row,data:{value:f.getValue(j,k),text:f.getText(j,k)}}])));f.ITa.xVa(null,Fa,{row:a,col:b,rowCount:c,colCount:d,sheetArea:e})}}}),m={priority:900,init:function(){var a=this;a.slicers=new k(a)},setHost:function(){var a=this;a.bind("tableRemoved",function(b,c){var d,e,f,g=c.tables;for(d=0;d<G(g);d++)e=a.slicers,f=Tc(e,g[d].name()),f&&Sc(e,f)})},toJson:function(a,b){var c,d=b&&b.ignoreStyle;d||(c=this.slicers.toJSON(),c.length>0&&(a.slicers=c))},preProcessMouseWheel:function(a){var b=this.slicers;b&&b.W3(a.e)&&(a.r=!0)},onGroupChanged:function(a){this.slicers.tTa(a.start,a.end,a.isRow)}},q.Worksheet.$n("slicer",m),n=function(a){var b="unfilterSlicerByKey",c="filterSlicer",d="unfilterSlicer",e="changeSlicerProperty";a.register(b,C[b],67,!1,!1,!0,!1),a.register(c,C[c]),a.register(d,C[d]),a.register(e,C[e])},o={init:function(){n(this.commandManager())},fromJson:function(a,b,c){var d,e,f,g,h,i,j=c&&c.ignoreStyle;if(!j)for(d=this,e=0,f=d.getSheetCount();e<f;e++)g=d.getSheet(e),h=a.sheets&&a.sheets[g.name()],i=h&&h.slicers,i&&g.slicers.fromJSON(i)}},q.Workbook.$n("slicer",o),p=q.lUa,A.extend(p.prototype,{xVa:function(a,b,c){var d,e=this.zTa;e&&(d=e.EUa,d||(d=e.EUa=[]),d.push({slicerItem:a,name:b,value:c}))},yVa:function(a){var b,c,d,e,f,g,h,i,j;if(a)for(b=a.length-1;b>=0;b--)if(c=a[b],d=c.slicerItem,e=c.name,f=c.value,e===Ca)g=f.columnName,h=f.oldValue,d.doFilter(g,{exclusiveRowIndexes:h});else if(e===Da)d.vV(f);else if(e===Ea){if(!f)return;d.Cz(f),i=f.ZX.MX,i&&(j=i.indexOf(f),j>=0&&i.splice(j,1))}else if(e===Fa){if(!f)return;this.kj.t4(f.row,f.col,f.rowCount,f.colCount,f.sheetArea)}else d[e](f)}}),p.$n("SLICER_PROPERTYCHANGE",{priority:5500,undo:function(a){var b=a.EUa;b&&this.yVa(b)}}),x={ItemSlicer:g,SlicerStyleInfo:Hb,SlicerBorder:b,SlicerStyle:d,SlicerStyles:f,TableSlicerData:i,Slicer:l,SlicerCollection:k},a.exports=x}()},function(a,b){a.exports=GC.Spread.Sheets},function(a,b){a.exports=GC.Spread.Common},function(a,b){a.exports=GC.Spread.Slicers},function(a,b){a.exports=GC.Spread.Sheets.FloatingObjects},function(a,b){a.exports=GC.Spread.Sheets.Tables},function(a,b){a.exports=GC.Spread.Sheets.ConditionalFormatting},function(a,b,c){!function(){"use strict";var a=c(2),b=a.Commands,d=a.GC$,e=b.ActionBase,f=function(a){d.inherit(c,a);function c(b,c){a.call(this),this.kj=b,this.VQ=c}var e={canExecute:function(){return!!this.VQ.slicerData},execute:function(){var a,c,d=this,e=d.VQ;return!!d.canExecute()&&(a=d.kj,a.ITa.startTransaction(),d.Lz(a,!0),e.slicerData.doFilter(e.columnName,{exclusiveRowIndexes:e.newValue}),d.Mz(a,!0),c=b.bWa(a.name()),d.VQ[c]=a.ITa.endTransaction(),!0)},canUndo:function(){return!!this.VQ.slicerData},undo:function(){var a,c,d,e=this;return!!e.canUndo()&&(a=e.kj,c=b.bWa(a.name()),d=e.VQ[c],e.Lz(a,!0),a.ITa.undo(d),e.Mz(a,!0),!0)}};return d.extend(c.prototype,e),c}(e),g=function(a){d.inherit(c,a);function c(b,c){a.call(this),this.kj=b,this.VQ=c}var e={canExecute:function(){return!!this.VQ.slicerData},execute:function(){var a,c,d=this,e=d.VQ;return!!d.canExecute()&&(a=d.kj,a.ITa.startTransaction(),d.Lz(a,!0),e.slicerData.doUnfilter(e.columnName),d.Mz(a,!0),c=b.bWa(a.name()),d.VQ[c]=a.ITa.endTransaction(),!0)},canUndo:function(){return!!this.VQ.slicerData},undo:function(){var a,c,d,e=this;return!!e.canUndo()&&(a=e.kj,c=b.bWa(a.name()),d=e.VQ[c],e.Lz(a,!0),a.ITa.undo(d),e.Mz(a,!0),!0)}};return d.extend(c.prototype,e),c}(e),h=function(a){d.inherit(b,a);function b(b,c){a.call(this),this.kj=b,this.VQ=c}var c={canExecute:function(){return!!this.VQ.slicer},execute:function(){var a,b=this,c=b.VQ;return!!b.canExecute()&&(a=b.kj,b.Lz(a,!0),c.slicer[c.propertyName](c.newValue),b.Mz(a,!0),!0)},canUndo:function(){return!!this.VQ.slicer},undo:function(){var a,b=this,c=b.VQ;return!!b.canUndo()&&(a=b.kj,b.Lz(a,!0),c.slicer[c.propertyName](c.oldValue),b.Mz(a,!0),!0)}};return d.extend(b.prototype,c),b}(e),i=b.h4;b.filterSlicer={canUndo:!0,execute:function(a,b,c){return i(a,f,b,c)}},b.unfilterSlicer={canUndo:!0,execute:function(a,b,c){return i(a,g,b,c)}},b.changeSlicerProperty={canUndo:!0,execute:function(a,b,c){return i(a,h,b,c)}},b.unfilterSlicerByKey={canUndo:!1,execute:function(a,c){var d,e,f,g=b.bT(a,c),h=g.slicers.UX();if(1===h.length&&(d=h[0],e=d.YX()))return f=e.getFilteredIndexes(d.columnName()),g.wu().execute({cmd:"unfilterSlicer",sheetName:g.name(),slicerData:e,columnName:d.columnName(),value:f})}}}()},function(a,b){!function(){"use strict";a.exports={Blank:"(blank)",Exp_SlicerNameInvalid:"The slicer name is not valid.",Exp_SlicerNameExist:"The slicer name is already in use, please enter a unique name."}}()}]);