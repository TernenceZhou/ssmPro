/*!
 * 
 * SpreadJS Library 14.0.6
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.CalcEngine=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/sheetsCalc/sheetsCalc.entry.js")}({"./dist/plugins/sheetsCalc/calc-spreadjs.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Core"),f=c("Common"),g=c("./dist/plugins/sheetsCalc/parser-sheets.js"),h=c("CalcEngine"),i=c("./dist/plugins/sheetsCalc/calc.ns.js"),j=f.Common.j,k=f.Common.u,l=j.Ia,m=j.za,n=null,o=void 0,p=["v","n","s","b","d","sn"],q=h.Errors.Value,r=h.Errors.Calc,s=f.Formatter&&f.Formatter.GeneralFormatter,t=h.Convert.vf,u=h.Convert.Fh,v=h.Convert.Ca,w=h.Errors.Reference,x=h.Errors.NotAvailable,y=h.Errors.Name,z=f.Common.A,A=f.Common.B,B=j.Fa,C=function(a){return h.Convert.Na(a,!0)},D=d.Range.prototype.contains,E=k.Nb,F="number",G=h.CalcSource.prototype,G.referenceToArray=function(a,b,c,d,e,f,g,i){var j,k,l,m,p,r,s,t,u,v,w,x,y=this,z=1,A=1,B=[],C=a.getRangeCount();if(0===C)return B.isError=!0,B;for(s=y.getRowCount(),t=y.getColumnCount(),c=c===o||c,u=0;u<C;u++){if(c||(r=[],B.push(r)),z=a.getRowCount(u),0===z)return B.isError=!0,B;if(A=a.getColumnCount(u),0===A)return B.isError=!0,B;if(l=a.getRow(u),m=a.getColumn(u),l>=s||m>=t)return B=[n],B.rowCount=1,B.colCount=1,B.rangeCount=1,B;for(l+z>s&&(z=s-l),m+A>t&&(A=t-m),v=void 0,w=0;w<z;w++)for(j=l+w,c||(v=[],r.push(v)),x=0;x<A;x++){if(k=m+x,p=y.getValue(j,k),d&&h.Convert.vf(p))return B=[p],B.isError=!0,B;if(p=h.Convert.wf(p,b,!h.ExcelCompatibleCalcMode,f,i),e&&p===h.Convert.CalcConvertedError)return B=[q],B.isConvertError=!0,B;p===n&&f||(c?B.push(p):v.push(p))}}return c||1!==C||(B=B[0]),B.rowCount=z,B.colCount=A,B.rangeCount=C,B},G.getSheetReference=function(){var a=this;return a.Df=a.Df||new h.CalcReference(a),a.Df},function(a){a[a.a1=0]="a1",a[a.r1c1=1]="r1c1"}(H=b.ReferenceStyle||(b.ReferenceStyle={})),e.ReferenceStyle=H,I=function(){function a(a,b,c,d,e){var f=this;f.Cj=a,f.Uu=c,f.Vu=d,f.Lf=b,B(e)||(f.kT=e)}return a.prototype.getName=function(){return this.Cj},a.prototype.getRow=function(){return this.Uu},a.prototype.getColumn=function(){return this.Vu},a.prototype.getExpression=function(){return this.Lf},a.prototype.getComment=function(){return this.kT},a.prototype.fg=function(a,b){b&&b.push({type:"customName",nameInfo:this,expr:this.Lf}),this.Lf=a},a}(),b.NameInfo=I,e.NameInfo=I,h.CalcSource.prototype.createSourceModel=function(a){return new h.CalcSourceModel(a,this)},J=function(a){O(b,a);function b(b){var c=a.call(this,n)||this;return c.references=b,c}return b.prototype.toArray=function(a,b,c,d,e){var f,g,h=this.references,i=[];for(f=0;f<h.length;f++){if(g=h[f].xf.referenceToArray(h[f],a,b,c,d,e),g.isError&&c)return g;b?Array.prototype.push.apply(i,g):i.push(g[0]),f||(i.rowCount=g.rowCount,i.colCount=g.colCount)}return i.rangeCount=h.length,i},b}(h.CalcReference),b.SheetRangeReference=J,K=function(a){O(b,a);function b(b,c,e,f){var h,i,j,k=a.call(this,b&&b.yj(),c,e,f)||this;for(b||(b=new d.Worksheet),k.kj=b,k.row=e&&e.row||0,k.column=e&&e.col||0,h=b.getCalcService(),i=h.getResolvers(),j=0;j<i.length;j++)if(i[j]instanceof g.SheetReferenceResolver)return k;return h.addResolver(new g.SheetReferenceResolver(b)),h.addResolver(new g.StructureReferenceResolver(b)),k}return b.prototype.getExternalSource=function(a,b){var c,d,e,f=this,g=f.kj.parent;if(a&&(!g||g.name!==a))return n;if(!g)return k.Mb(f.kj.name(),b)?f.kj.yj():n;if(c=g.sheets,c&&c.length>0)for(d=0;d<c.length;d++)if(e=c[d],k.Mb(e.name(),b))return e.yj();return h.ParserContext.prototype.getExternalSource.call(this,a,b)},b.prototype.getExternalSourceToken=function(a){return a.getName()},b.prototype.getTableByName=function(a){var b,c,d=this.kj.tables,e=d?d.findByName(a):n;if(!e&&(b=this.kj.parent&&this.kj.parent.sheets))for(c=0;c<b.length&&(d=b[c].tables,!d||!(e=d.findByName(a)));c++);return e},b.prototype.getTableByIndex=function(a,b){var c=this.kj.tables;return c?c.find(a,b):n},b.prototype.setSource=function(a){this.source=a;var b=a;b&&b.getSheet&&(this.kj=b.getSheet())},b.prototype.no=function(){this.kj&&this.kj.no()},b}(h.ParserContext),b.SheetParserContext=K,L=new f.Common.ResourceManager(d.SR);function P(a,b,c,d,e){var f=b.getSpan(c,d,e),g=n;return f.row===c&&f.col===d&&(g=a.getValue(c,d,e)),g}function Q(a){return a.indexOf("LET(")>-1&&"LET"}M=function(a){O(b,a);function b(c,d){var e=a.call(this,n)||this;return e.getCalcSourceModel=function(){return this.Bf},e.createSourceModel=function(a){return new h.CalcSourceModel(a,this)},e.getRangeKey=function(a,b){return a.id+","+b.row+","+b.col+","+b.rowCount+","+b.colCount},e.getSheetRangeReference=function(a){var c,d,e,f,g,h=this.kj,i=h&&h.parent;if(a.endSource&&i&&i.sheets&&a.endSource instanceof b){for(c=i.sheets,d=!1,e=void 0,f=[],g=0;g<c.length;g++){if(e=c[g].yj(),e===this)d=!0;else if(e===a.endSource){f.push(e.getReference(a));break}d&&f.push(e.getReference(a))}return new J(f)}},e.kj=c,e.Wz=d?d:3,e}return b.prototype.startCalculation=function(){this.Hu||this.xLb()},b.prototype.endCalculation=function(){this.Hu=n,this.zIc(),this.Iu=n;var a=this.Bf.ug(!1);a&&a.clearListenersCache(),this.Af.calcOnDemand&&this.kj.repaint()},b.prototype.zIc=function(){var a,b=this.Iu;b&&b.length>0&&(a=this.kj,a.Wq(d.Events.RangeChanged,{isUndo:!1,sheet:a,sheetName:a.name(),row:0,col:0,rowCount:a.getRowCount(),colCount:a.getColumnCount(),changedCells:b,action:6},a.vxb))},b.prototype.clearValueCache=function(){this.xLb()},b.prototype.xLb=function(){var a=this.getRowCount(),b=this.getColumnCount();this.Hu={rowCount:a,colCount:b,arrayInfo:[]},this.Iu=[]},b.prototype.OHb=function(){this.Hu=n,this.Iu=n},b.prototype.getValue=function(a,b){var c,e,f,g,i,j,k,l,m,r,s,t,u,v=[];for(c=2;c<arguments.length;c++)v[c-2]=arguments[c];if(e=this,f=e.kj,typeof a===F)g=arguments[0],i=arguments[1],b=arguments[2];else if(a=a,a.row!==o)g=a.row,i=a.col;else if(a.name)return null;return j=e.Wz,b=b||0,g<0||i<0?q:f.Ju&&f.Ku===g&&f.Lu===i?f.Mu:(k=e.Hu,l=p[b],k?(m=k.rowCount,r=k.colCount,s=void 0,t=void 0,u=void 0,g>=m?n:i>=r?n:(s=k[g],s||(s=k[g]={}),t=s[i],t||(t=s[i]={v:f.getValue(g,i,j)}),u=t[l],u===o&&(u=h.Convert.wf(t.v,b,!h.ExcelCompatibleCalcMode),t[l]=u),u=d.Ul.w0a(u))):g>=e.getRowCount()?n:i>=e.getColumnCount()?n:e.kj.getValue(g,i,j))},b.prototype.getIdentity=function(a,b){var c=this,d=b.row,e=b.rowCount||1,f=b.column,g=b.columnCount||1;return d===-1&&(d=0,e=c.getRowCount()),f===-1&&(f=0,g=c.getColumnCount()),c.getName()+"."+d+"."+e+"."+f+"."+g},b.prototype.getReference=function(a){var b,c,d,e,f,g,i=this,j=a.row,k=a.col;if(j===-1&&(a.row=0,a.rowCount=i.getRowCount()),k===-1&&(a.col=0,a.colCount=i.getColumnCount()),b=!1,a.spillRef)if(c=i.yLb().getAnchorCell(j,k))a.rowCount=c.rowCount,a.colCount=c.colCount,b=!c.isValid;else{if(d=i.getCalcSourceModel(),e=d.Qf(j,k))return e.row===j&&e.col===k?(a.rowCount=e.rowCount,a.colCount=e.colCount,new h.CalcReference(i,[a])):void 0;if(f=d.Kf(j,k),!f||33!==f.type)return f&&("@"===f.functionName||f instanceof h.ReferenceExpression)?(a.rowCount=1,a.colCount=1,new h.CalcReference(i,[a])):void 0;b=!0,a.rowCount=1,a.colCount=1}return g=new h.CalcReference(i,[a]),b&&(g.isSpillError=!0),g},b.prototype.getSources=function(a){var c,d,e,f,g;if(this.kj&&this.kj.parent&&this.kj.parent.sheets&&a instanceof b){for(c=this.kj.parent.sheets,d=!1,e=void 0,f=[],g=0;g<c.length;g++){if(e=c[g].yj(),e===this&&(d=!0),e===a){f.push(e);break}d&&f.push(e)}return f}},b.prototype.Ppb=function(a,b){var c,d=this,e=d.Hu,f=e&&e.arrayInfo;f&&(c=!1,f.forEach(function(d,g){if(d){var h=d.reference,i=d.key;D.call(h.yf[0],a,b)&&(delete e[i],f[g]=o,c=!0)}}),c&&(e.arrayInfo=[],f.forEach(function(a){a&&e.arrayInfo.push(a)})))},b.prototype.referenceToArray=function(a,b,c,d,e,f,g,i){var k,l,r,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=this,J=1,K=1,L=[],M=I.kj,N=I.Hu,O=p[b],Q=M.ITa,R=a.getRangeCount();if(0===R)return L.isError=!0,L;if(N&&(x=a.getRangeCount()+"_"+a.getRow(0)+"_"+a.getColumn(0)+"_"+a.getRowCount(0)+"_"+a.getColumnCount(0)+"_"+b+"_"+c,u=N[x]))return I.zLb(u);for(y=this.getRowCount(),z=this.getColumnCount(),c=c===o||c,A=0;A<R;A++){if(c||(v=[],L.push(v)),J=a.getRowCount(A),0===J)return L.isError=!0,I.zLb(L);if(K=a.getColumnCount(A),0===K)return L.isError=!0,I.zLb(L);if(r=a.getRow(A),t=a.getColumn(A),r>=y||t>=z)return L=c?[n]:[[n]],L.rowCount=1,L.colCount=1,L.rangeCount=1,I.zLb(L);for(r+J>y&&(J=y-r),t+K>z&&(K=z-t),B=void 0,C=void 0,D=M.Ju,E=0;E<J;E++)for(k=r+E,c||(B=[],v.push(B)),N&&(N[k]||(N[k]={}),w=N[k]),F=0;F<K;F++){if(l=t+F,D&&M.Ku===k&&M.Lu===l)u=M.Mu,D=!1;else{if(N?(C=w[l],C?u=C.v:(u=P(M,Q,k,l,I.Wz),C=w[l]={v:u})):u=P(M,Q,k,l,I.Wz),g&&(G=M.getFormatter(),H=void 0,H=G instanceof s?G.formatString():G,"@"===H?u=M.getText(k,l):u instanceof Date&&(u=j.Pa(u)),m(C)||(C=w[l]={v:u})),d&&h.Convert.vf(u))return L=[u],L.isError=!0,I.zLb(L);if(C&&C[O]!==o)u=C[O];else if(u=h.Convert.wf(u,b,!h.ExcelCompatibleCalcMode,f,i),C&&(C[O]=u),e&&C===u)return L=[q],L.isConvertError=!0,I.zLb(L)}h.Convert.j$a(u,f)||(c?L.push(u):B.push(u))}}return c||1!==R||(L=L[0]),L.rowCount=J,L.colCount=K,L.rangeCount=R,N&&!isNaN(R)&&!isNaN(J)&&!isNaN(K)&&R*J*K<2500&&N.arrayInfo.length<50&&(N[x]=L,N[x].rowCount=J,N[x].colCount=K,N[x].rangeCount=R,N.arrayInfo.push({reference:a,key:x})),I.zLb(L)},b.prototype.zLb=function(a){var b=[];return b=b.concat(a),b.rowCount=a.rowCount,b.colCount=a.colCount,b.rangeCount=a.rangeCount,b.isError=a.isError,b.isArray=a.isArray,b.isReference=a.isReference,b.isConvertError=a.isConvertError,b},b.prototype.getColumnCount=function(){var a=this.kj;return a.Js?0:a.getColumnCount(this.Wz)},b.prototype.getRowCount=function(){var a=this.kj;return a.Js?0:a.getRowCount(this.Wz)},b.prototype.isHiddenRow=function(a,b){var c=this.kj,d=c.Nu&&c.Nu();return!(!d&&b)&&0===c.getRowHeight(a)},b.prototype.getName=function(){var a=this.Wz;return a===d.SheetArea.colHeader?this.kj.name()+"CH":a===d.SheetArea.rowHeader?this.kj.name()+"RH":this.kj.name()},b.prototype.yLb=function(){var a=this,b=a.ZHb;return b||(b=a.ZHb=a.kj.ITa.ZHb),b},b.prototype.setArray=function(a,b,c,d,e){return this.yLb().setArray(this,a,b,c,d,e)},b.prototype.updateItem=function(a,b,c){return this.yLb().updateItem(this,a,b,c)},b.prototype.GIb=function(a,b){this.yLb().GIb(a,b)},b.prototype.HIb=function(){this.yLb().HIb()},b.prototype.setValue=function(a){var b,c,e,f,g,h,i,j,k,m,n,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F=[];for(b=1;b<arguments.length;b++)F[b-1]=arguments[b];if(c=this,e=c.kj,h=c.Wz,a=a,a.row!==o)f=a.row,g=a.col,i=1;else{if(a.name)return;f=arguments[0],g=arguments[1],i=2}j=arguments[i],k=arguments[i+1],m=c.Hu,m&&(n=m[f],n&&(p=n[g],p&&(p.v=j,p.b!==o&&(p.b=o),p.d!==o&&(p.d=o),p.n!==o&&(p.n=o),p.s!==o&&(p.s=o),p.sn=o))),q=d.Ul.x0a(j),r=e.ITa,s=!1,t=e.tables,u=t&&t.find(f,g),3===h&&u&&(v=u.showHeader()&&f===u.headerIndex(),w=u.showFooter()&&f===u.footerIndex(),v||w||(s=u.yq(f,g,q))),x=e.wq,3===h&&!s&&x&&x.Ou&&(y=x.getValue(f,g),y.hasBinding&&(z=void 0,m?(A=m.bindingRows=m.bindingRows||{},z=A[f],z||(z=A[f]=l({},e.getDataItem(f)))):z=l({},e.getDataItem(f)),r.Cp(f,g,{Dp:z,Ep:y.value}),x.setValue(f,g,q,r.zTa)),s=y.hasBinding),s||(B="hyperlink",C="__proto__","string"==typeof q&&q[B]&&(D=q[B],E={url:D},r.setHyperlink&&r.do("setHyperlink",f,g,E),delete q[C].hyperlink),r.do("setValue",f,g,q,h,!0,!0,arguments[i+2])),this.Iu?this.Iu.push({row:f,col:g}):this.kj.Wq(d.Events.CellChanged,{sheet:this.kj,sheetName:this.kj.name(),row:f,col:g,sheetArea:h,propertyName:"value",oldValue:k,newValue:j})},b.prototype.getCustomFunction=function(a){return this.kj?this.kj.Pu(a):n},b.prototype.getCustomName=function(a){a=E(a);var b=this.kj?this.kj.getCustomName(a):n;return b?b.getExpression():n},b.prototype.getSheet=function(){return this.kj},b.prototype.setFormula=function(a,b,c){},b.prototype.setArrayFormula=function(a,b,c,d,e){},b.prototype.setFormulaByName=function(a,b){},b.prototype.refresh=function(){this.kj.repaint()},b.prototype.toJSON=function(a,b,c,d,e){var f,g,h,i,j,k,l,n,o,p,q,r,s,t,u,v=b,w=a.data||{},x=!0,y=this.Cf();for(y.UIc=!0,k=0;k<=c;k++)if(f=w.dataTable||{},g=v[k]){for(i=f[k],x=!i,i=i||{},l=0;l<=d;l++)if(h=g[l],h&&h.Lf){j=i[l]||{};try{n=y.unparse(this,h.Lf,k,l,!1,!0),o=Q(n),p=void 0,o&&(B(j.prefix)&&(j.prefix={}),p=n,n=p.replace(/_xlpm\./g,"")),!h.Pf&&n&&0===n.indexOf("@")&&$(this.kj,n.slice(1,n.length),0,0)&&(n=n.slice(1,n.length),o&&(p=p.slice(1,p.length))),h.Pf?h.Pf.row===k&&h.Pf.col===l&&(j.arrayInfo=h.Pf,j.formula=n,o&&(j.prefix[o]=p)):(j.formula=n,o&&(j.prefix[o]=p)),x=!1,i[l]=j}catch(a){}}if(x){if(f!==w.dataTable)continue}else f[k]=i;w.dataTable=f}if(e){for(q=w.columnDataArray||[],r=0;r<e.length;r++)s=e[r],s&&s.Lf&&(t=this.Cf().unparse(this,s.Lf,0,r,!1,!0),u=q[r]||{},u.formula=t,q[r]=u);q.length>0&&(w.columnDataArray=q)}m(w)||(a.data=w),delete y.UIc},b}(h.CalcSource),b.SheetSource=M,M.prototype.getParserContext=function(a,b,c){return b=b||h.pf(0,0),new K(this.kj,a,b,c)},N=function(a){O(b,a);function b(b){var c=a.call(this,n)||this;return c.createSourceModel=function(a){return new h.CalcSourceModel(a,this)},c.Qu=b,c}return b.prototype.getCustomFunction=function(a){return this.Qu?this.Qu.getCustomFunction(a):n},b.prototype.getCustomName=function(a){var b=this.Qu?this.Qu.getCustomName(a)||this.Qu.aJb(a):n;return b?b.getExpression():n},b}(h.CalcSource),b.SpreadSource=N;function R(a,b,c,e,f,g){var i,j=a&&a instanceof d.Worksheet&&a,k=new h.Parser;return c=c===o?0:c,e=e===o?0:e,i=new K(j,(!!f),h.pf(c,e)),g&&(i.culture=!0),k.parse(i,b)}b.formulaToExpression=R;function S(a,b,c,e,f,g){var i,j=a&&a instanceof d.Worksheet&&a,k=new h.Parser;return c=c===o?0:c,e=e===o?0:e,i=new K(j,(!!f),h.pf(c,e)),i.YSa=g,k.unparse(i,b)}b.expressionToFormula=S;function T(a,b,c,d,e){c===o&&(c=0),d===o&&(d=0);var f=R(a,b,c,d,e,!0);return U(a,f,c,d)}b.evaluateFormula=T;function U(a,b,c,d,e){var f,g,i=a.Cf();return c===o&&(c=a.getActiveRowIndex()),d===o&&(d=a.getActiveColumnIndex()),f=!0,e&&e.convertNullToZero!==o&&(f=e.convertNullToZero),g=a.yj(),i.Hg(g,b,h.pf(c,d),!1,f)}b.evaluateExpression=U;function V(a,b,c,d,e){var f,j,k,l=a.row,m=a.col,o=a.row+a.rowCount-1,p=a.col+a.colCount-1,q=!1,r=!1,s=!1,t=!1;return arguments.length>=4&&(q=0!==(1&d),r=0!==(4&d),s=0!==(2&d),t=0!==(8&d),l-=q?b:0,o-=r?b:0,m-=s?c:0,p-=t?c:0),e&&(j=W(a,e,b),k=X(a,e,b),j&&k)?f=g.StructureReferenceResolver.create(e,j,k,a.col-e.dataRange().col,a.col+a.colCount-e.dataRange().col-1):(1===a.rowCount&&1===a.colCount?f=h.rf(n,n,l,m,q,s):(a.row<0&&(l=o=i.BAND_INDEX_CONST),a.col<0&&(m=p=i.BAND_INDEX_CONST),f=h.uf(n,n,l,m,o,p,q,s,r,t,b,c)),f)}b.rangeToExpression=V;function W(a,b,c){if(1===a.rowCount){if(b.hasHeadersRow()&&a.row===b.startRow())return 2;if(b.hasTotalsRow()&&a.row===b.endRow())return 8;if(c===a.row)return 1}else{if(b.hasHeadersRow()&&a.row===b.startRow()){if(a.rowCount===b.dataRange().rowCount+1)return 6;if(b.hasTotalsRow()&&a.rowCount===b.dataRange().rowCount+1+1)return 14}if(a.row===b.dataRange().row){if(a.rowCount===b.dataRange().rowCount)return 3;if(b.hasTotalsRow()&&a.rowCount===b.dataRange().rowCount+1)return 12}}return o}function X(a,b,c){return a.col===b.startColumn()&&a.colCount===b.dataRange().colCount?1:1===a.colCount?2:a.col>=b.startColumn()&&a.col+a.colCount-1<=b.endColumn()?4:o}function Y(a,b,c,d,e){var f=V(a,b,c,d),g=new K(n,(!!e),h.pf(b,c)),i=new h.Parser,j=i.unparse(g,f);return g.no(),j}b.rangeToFormula=Y;function Z(a,b,c,d,e,f,g){var i=V(b,c,d,e,g),j=new K(a,(!!f),h.pf(c,d)),k=new h.Parser;return k.unparse(j,i)}b.rangeToFormulaWithStructReference=Z;function $(a,b,c,e){var f,g,h,i,j,k,l,m,n;if(!b)return null;if(c=c?c:0,e=e?e:0,f=a.Cf(),g=f.parse(a.yj(),b,c,e,!0,!0))if(h=g.source,h&&13===g.type);else if(1===g.type&&g.endSource){for(i=g.source,j=g.endSource,k=i.getSources(j),l=!1,m=0;m<k.length;m++)if(k[m]===a.yj()){l=!0;break}g=l&&g}return!g||!g.getRange||h&&h!==a.yj()?null:(n=g.getRange(c,e),n?new d.Range(n.row,n.col,n.rowCount,n.colCount):null)}b.formulaToRange=$;function _(a,b,c,e,f){var i,j,k,l,n,p,q,r,s,t,u=[],v=[];if(!b)return u;for(i={},c=c||0,e=e||0,j=new h.Parser,k=g.qzb(j,b,a,c,e,o,f),l=0;l<k.length;l++)if(n=k[l].sheetRanges,n&&!m(n))for(p=0;p<n.sheets.length;p++)for(q=n.sheets[p],v=i[q],v||(i[q]=v=[],u.push({sheetName:q,ranges:v})),r=n[q],s=0;s<r.length;s++)t=r[s],v.push(new d.Range(t.row,t.col,t.rowCount,t.colCount));return u}b.formulaToRanges=_;function aa(a,b,c,d,e){var f=new h.Parser,g=new K(n,(!!e),h.pf(b,c)),i=ba(f,g,a,b,c,d);return g.no(),i}b.rangesToFormula=aa;function ba(a,b,c,d,e,f){var g,h,i,j="";for(g=0;g<c.length;g++)h=V(c[g],d,e,f),i=a.unparse(b,h),j+=g>0?", "+i:i;return j}b.ALb=ba,b.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15};function ca(a,b,c,d,e,g,h){var i,j,k,l,m=d.getValue(b,c),n=!1,o=100,p=.001,q=.01,r=(C(m)?+m:0)-h,s=d.getValue(e,g),u=(C(s)?+s:0)-h;if(C(s)&&Math.abs(u)<p)n=!0;else if(t(s))n=!1;else for(i=r+(0===r?q:q*r),k=0;!n&&k<o;k++)i=f.Common.o.Lma(i,13),a.setValue(b,c,i),s=d.getValue(e,g),j=(C(s)?+s:0)-h,C(s)&&Math.abs(j)<p?n=!0:t(s)?i=(r+i)/2:r-i===0?i=r+(0===r?q:q*r):u-j===0?i=r+2*(i-r):(l=i-j*(r-i)/(u-j),r=i,u=j,i=l);return n||a.setValue(b,c,m),n}b.goalSeek=ca},"./dist/plugins/sheetsCalc/calc.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.BAND_INDEX_CONST=-2147483648,b.MAX_ROW_COUNT=1048576,b.MAX_COLUMN_COUNT=16384},"./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;Object.defineProperty(b,"__esModule",{value:!0}),d=c("CalcEngine"),e=c("Common"),f=c("./dist/plugins/sheetsCalc/calc.ns.js"),g=c("./dist/plugins/sheetsCalc/parser-sheets.js"),h=c("Core"),i=e.Common.u,j=i.Nb,k=Math.min,l=Math.max,m=void 0,n=null,o=d.Convert.vf,p=d.Errors.Reference,q=h.util.l_a;function u(a,b){var c,d,e,f;return b||(b=this),c=l(a.row,b.row),d=l(a.column,b.column),e=k(a.row+a.rowCount,b.row+b.rowCount),f=k(a.column+a.columnCount,b.column+b.columnCount),c>=e||d>=f?n:{row:c,column:d,rowCount:e-c,columnCount:f-d,intersectWith:u}}r=function(){function a(a,b,c,d,e,f,g,h){var i=this;i.Rj=a,i.Vj=b,i.Wj=c,i.Qj=d,i.Tj=e,i.Uj=f,i.Xj=g,i.Yj=h}return a.prototype.Nj=function(){return this.Tj-this.Vj},a.prototype.Oj=function(){return this.Uj-this.Wj},a.prototype.Sj=function(a,b,c,d,e){var f=this;return f.Rj===a&&(f.Vj===-1||f.Vj<=b&&b+d<=f.Vj+f.Xj)&&(f.Wj===-1||f.Wj<=c&&c+e<=f.Wj+f.Yj)},a.prototype.Pj=function(a,b,c,d,e){var f=this;return f.Qj===a&&(f.Tj===-1||f.Tj<=b&&b+d<=f.Tj+f.Xj)&&(f.Uj===-1||f.Uj<=c&&c+e<=f.Uj+f.Yj)},a.prototype.intersectWith=function(a,b,c,d,e){var f,g,h=this;return h.Qj!==a?n:(f=h.Zj(a,b,c,d,e),g=h.Zj(a,h.Vj,h.Wj,d,e),g.intersectWith(f))},a.prototype.Zj=function(a,b,c,d,e){var f=b===-1?0:b,g=b===-1||d===-1?a.rowCount:d,h=c===-1?0:c,i=c===-1||e===-1?a.colCount:e;return{row:f,column:h,rowCount:g,columnCount:i,intersectWith:u}},a}(),b.MoveSwapInfo=r;function v(a,b,c,d){return(!d||a<b)&&c}function w(a){return[a.row,a.col,a.rowCount,a.colCount].join(",")}function x(a,b,c,d){var e=a[b];e||(e=a[b]={}),e[c]=d}function y(a,b,c){var d=a[b];return!!d&&d[c]}s=function(){function a(){}return a.zj=function(b,c,e,g,h,i,j,l,m,n,o){var q,r,s,t,u,v,w=e,x=a,y=this.zj;if(!e)return w;if(s=e.type,10===s)w=d.Lh(y.call(x,b,c,e.value,g,h,i,j,l,m,n,o));else if(1===s&&e.sf()||33===s){if(q=k((e.source||c).getRowCount(),f.MAX_ROW_COUNT),r=k((e.source||c).getColumnCount(),f.MAX_COLUMN_COUNT),e.rowRelative&&(e.row+g<0||e.row+g>=q)||e.columnRelative&&(e.column+h<0||e.column+h>=r))return d.Hh(p,e.source);w=e.offset(0,0,!1)}else if(1===s){if(q=k((e.source||c).getRowCount(),f.MAX_ROW_COUNT),r=k((e.source||c).getColumnCount(),f.MAX_COLUMN_COUNT),t=e,t.rowRelative&&!e.isFullColumn&&(t.row+g<0||t.row+g>q)||t.columnRelative&&!e.isFullRow&&(t.column+h<0||t.column+h>r)||t.endRowRelative&&!e.isFullColumn&&(t.endRow+g<0||t.endRow+g>q)||t.endColumnRelative&&!e.isFullRow&&(t.endColumn+h<0||t.endColumn+h>r))return d.Hh(p,e.source,e.endSource);w=e.offset(0,0,!1,g,h)}else if(9===e.type)w=d.Kh(e.operatorType,y.call(x,b,c,e.value,g,h,i,j,l,m,n,o),e.value2&&y.call(x,b,c,e.value2,g,h,i,j,l,m,n,o));else if(7===s){if(u=[],e.arguments&&e.arguments.length>0)for(v=0;v<e.arguments.length;v++)u[v]=y.call(x,b,c,e.arguments[v],g,h,i,j,l,m,n,o);w=d.Jh(e,u)}else 13===s&&(w=e.offsetWhenCopy(b,c,g,h,i,j,l,m,n,o));return w},a.copyFormula=function(b,c,e,f,g,h,i,j,l){var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=b,P=f,Q=b.getSource(),R=f.getSource(),S=a;if(O&&P){for(n=R&&R.getSheet().ITa.dUa(),o=c,p=e,q=g,r=h,s=i,t=j,c<0&&(o=0,s=k(b.rC(),f.rC())),e<0&&(p=0,t=k(b.cC(),f.cC())),g<0&&(q=0),h<0&&(r=0),u=new d.CalcSourceModel(b.Cf(),Q),v=0;v<s;v++)for(w=0;w<t;w++)O.Uf(u,v+o,w+p,v,w);for(x={},y=f.Cf(),v=0;v<s;v++)if(!l||!R.isHiddenRow(v+q,!0))for(z=v+q,w=0;w<t;w++)if(A=w+r,B=u.Kf(v,w)){if(B===x)continue;if(B=S.zj(Q,R,u.Kf(v,w),z,A,g-c,h-e,g,h,s,t),C=u.Qf(v,w),R)if(C&&!C.isDynamicArray){for(D=C.rowCount,E=C.colCount,F=o-C.row,F>0&&(D-=F),G=s-v,G<D&&(D=G),H=p-C.col,H>0&&(E-=H),I=t-w,I<E&&(E=I),J=0;J<D;J++)for(K=0;K<E;K++)u.Rf(v+J,w+K,x);f.setArrayFormula(z,A,D,E,y.unparse(R,B,z,A),m,n)}else L=B?y.unparse(R,B,z,A):m,R.setFormula(z,A,L),M=u.Mf(v,w),M&&(N=new d.EvaluateContext(R,d.pf(z,A),(!1)),M=d.Mh(N,B,!1,0,0),M=M===B?m:M),P.ig(z,A,B,M,C,n);else P.Rf(v+q,w+r,B),P.Xf(v+q,w+r,C)}else P&&P.Kf(z,A)&&P.Sf(z,A,n)}},a.moveFormula=function(a,b,c,d,e,f,g,i){var j,l,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=a.Bj(),F=d.Bj(),G=E.Cf();if(E&&F){for(j=E.dUa(),l=F.dUa(),o=G.ih(),b<0&&(b=0,g=k(a.getRowCount(),d.getRowCount())),e<0&&(e=0),c<0&&(c=0,i=k(a.getColumnCount(),d.getColumnCount())),f<0&&(f=0),p=!(a===d&&a.name()===d.name()),E.Sg(b,c,g,i),ca(E,b,c,g,i),F.Sg(e,f,g,i),ca(F,e,f,g,i),q=[],r=0;r<g;r++)for(s=0;s<i;s++)t=E.Kf(r+b,s+c),u=E.Qf(r+b,s+c),v=E.Mf(r+b,s+c),t?(q.push({Lf:t,Pf:u,Nf:v}),E.Sf(r+b,s+c,j)):q.push(n);for(x=p?{}:null,r=0;r<g;r++)for(y=r+e,s=0;s<i;s++)z=q[r*i+s],A=s+f,z?(t=z.Lf,u=z.Pf,G&&u&&!u.isDynamicArray&&u.row===b+r&&u.col===c+s&&(w=h.kf(y,A,u.rowCount,u.colCount)),B=u&&!u.isDynamicArray?w:m,v=z.Nf,F.FTa(l,y,A),F.Rf(y,A,t),F.Xf(y,A,B),F.Wf(y,A,v),p&&(x[y+", "+A]=t)):(F.FTa(l,y,A),F.Rf(y,A,m),F.Xf(y,A,m));o.Dj(E,b,c,g,i),o.Dj(F,e,f,g,i),C=E.getSource().getSheet(),D=C.uja&&(C.parent||C).tja(),o.Ej(D,E.getSource(),b,c,F.getSource(),e,f,g,i,!0,x),p===!0&&o.Ej(D,E.getSource(),b,c,F.getSource(),e,f,g,i,!0,x)}},a.prototype.isAdjustCell=function(a){return a.preAdj||this.imb&&a===this.imb[0]},a.prototype.isAdjust=function(a){return a.preAdj||this.imb&&a===this.imb[0]},a.prototype.hh=function(a,b){var c=this,d,e;isNaN(b)||(c.imb||(c.imb={},c.jmb={}),d=c.imb[b],e=c.jmb[b],a&&!a.preAdj&&a!==d&&(d?e.nextAdj=a:c.imb[b]=a,a.preAdj=e,a.nextAdj=n,c.jmb[b]=a))},a.prototype.Fj=function(a,b){var c,d,e,f=this;isNaN(b)||(c=f.imb&&f.imb[b],a&&(a.preAdj||a===c)&&(d=a.preAdj,e=a.nextAdj,d?d.nextAdj=e:f.imb[b]=e,e?e.preAdj=d:f.jmb[b]=d,a.preAdj=n,a.nextAdj=n))},a.prototype.Gj=function(a,b,c,d,e,f,g){this.Hj(a,D,b,c,d,e,f,g);var h=0,i=0,j=0,k=0;0===b&&(d&&e?j=c:d?h=c:e?k=c:i=c),E(a,D,b,c,h,i,j,k,d,e),H(a,D,b,c,d,e)},a.prototype.Hj=function(a,b,c,d,e,f,g,h){var i,j,k,l,n,o,p,q,r,s,t,u,w,z,A,B,C,D,E,F=this,G=F.imb;if(G){for(q={};G[0];)if(n=G[0],i=n.ah,p=i.dUa(),o=i.getSource(),j=n.row,k=n.column,y(q,j,k))F.Fj(n,0);else{if(l=i.Kf(j,k))if(l=b.call(F,o,j,k,l,a,c,d,e,f,m,g,h),r=i.Qf(j,k)){if(o===a&&(s=f?d:-d,e?c<=r.row&&(r.row+=s):c<=r.col&&(r.col+=s)),j===r.row&&k===r.col)if(r.isDynamicArray)i.fg(j,k,l,r,!0,v(e?j:k,c,p,a.id===o.id));else for(t=j;t<j+r.rowCount;t++)for(q[t]||(q[t]={}),u=k;u<k+r.colCount;u++)i.fg(t,u,l,r,t===j&&u===k,v(e?t:u,c,p,a.id===o.id)),x(q,t,u,!0)}else i.fg(j,k,l,r,!0,v(e?j:k,c,p,a.id===o.id));else(i.getRowExpression&&i.getRowExpression(j)||i.getColumnExpression&&i.getColumnExpression(k))&&i.Ag(j,k,1,1);F.Fj(n,0)}for(;G[1];)n=G[1],i=n.ah,p=i.dUa(),j=n.row,i.getRowExpression&&(l=i.getRowExpression(j),l&&i.fg&&(o=i.getSource(),i.fg(j,-1,b.call(F,o,j,-1,l,a,c,d,e,f),m,!0,v(j,c,p,a.id===o.id)))),F.Fj(n,1);for(;G[2];)n=G[2],i=n.ah,p=i.dUa(),k=n.column,i.getColumnExpression&&(l=i.getColumnExpression(k),l&&i.fg&&(o=i.getSource(),i.fg(-1,k,b.call(F,o,-1,k,l,a,c,d,e,f),m,!0,v(k,c,p,a.id===o.id)))),F.Fj(n,2);for(;G[3];)w=G[3],z=w.name,i=w.ah,l=i.DTa(z),A=b.call(F,i.getSource(),0,0,l,a,c,d,e,f,{isNameID:!0}),i.gg(z,A),F.Fj(w,3);for(B in G)if(C=+B,C>3&&G.hasOwnProperty(B))for(;G[B];)D=G[B],E=D.ah,l=b.call(F,E,0,0,D.expression,a,c,d,e,f),E.setExpression(D.id,D.name,l),F.Fj(D,C)}},a.prototype.ph=function(a){var b=this,c=a.getCalcSourceModel(),d=a.getRowCount(),e=a.getColumnCount();ca(c,0,0,d,e),b.Hj(a,O),E(a,O,0,0,0,0,0,0,!0,!1),H(a,O,0,0,!0,!1)},a.prototype.Ej=function(a,b,c,d,e,f,g,h,i,j,k){var l,n,o,p,q,s,t,u,v,z,A,B,C,D,E,F,G,H,I,K,L,M,N=this,O=$,P=new r(b,c,d,e,f,g,h,i),Q={};if(a&&_(a,P,j),J(b,P,j),t=N.imb,v={},t){for(;t[0];)if(n=t[0],l=n.ah,o=n.row,p=n.column,s=l.dUa(),y(Q,o,p))N.Fj(n,0);else{if(q=l.Kf(o,p),u=l.getSource(),q)if(z=m,k&&k[o+", "+p]&&(u=b,z={crossSheetMoved:!0}),q=O.call(N,u,o,p,q,P,j,z),A=l.Qf(o,p),B=void 0,A&&!A.isDynamicArray)if(B=w(A),o===A.row&&p===A.col)for(v[B]=!0,C=o;C<o+A.rowCount;C++)for(Q[C]||(Q[C]={}),D=p;D<p+A.colCount;D++)l.fg(C,D,q,A,C===o&&D===p,s),x(Q,C,D,!0);else v[B]||(l.fg(o,p,q,A,!1,s),x(Q,o,p,!0));else l.fg(o,p,q,A,!0,s);else(l.getRowExpression&&l.getRowExpression(o)||l.getColumnExpression&&l.getColumnExpression(p))&&l.Ag(o,p,1,1);N.Fj(n,0)}for(;t[1];)n=t[1],l=n.ah,o=n.row,s=l.dUa(),l.getRowExpression&&(q=l.getRowExpression(o),q&&l.jg&&l.jg(o,O.call(N,u,o,-1,q,P,j),m,s)),N.Fj(n,1);for(;t[2];)n=t[2],l=n.ah,p=n.column,s=l.dUa(),l.getColumnExpression&&(q=l.getColumnExpression(p),q&&l.kg&&l.kg(p,O.call(N,u,-1,p,q,P,j),m,s)),N.Fj(n,2);for(;t[3];)E=t[3],F=E.name,l=E.ah,q=l.DTa(F),G=O.call(N,u,0,0,q,P,j),l.gg(F,G),N.Fj(E,3);for(H in t)if(I=+H,I>3&&t.hasOwnProperty(H))for(;t[H];)K=t[H],L=K.ah,M=L.getSource(),q=O.call(N,M,0,0,K.expression,P,j),L.setExpression(K.id,K.name,q),N.Fj(K,I)}},a.prototype.Dj=function(a,b,c,d,e){var f,g,h,i,j,k=this,l=b+d,m=c+e;for(h=b;h<l;h++)for(i=c;i<m;i++)f=a.Yf(h,i),g=a.Kf(h,i),(f||g)&&(k.Fj(f,0),a.Q3(h,i,0),j=a.qg(h,i,!0),k.hh(j,0))},a.prototype.Ij=function(a,b,c){var d,e,f=this;for(d=b;d!==-1&&d<b+c;d++)(a.Yf(-1,d)||a.Kf(-1,d))&&(a.Q3(-1,d,2),e=a.sg(d,!0),f.hh(e,2))},a.prototype.Jj=function(a,b,c){var d,e,f=this;for(d=b;d!==-1&&d<b+c;d++)(a.Yf(d,-1)||a.Kf(d,-1))&&(a.Q3(d,-1,1),e=a.rg(d,!0),f.hh(e,1))},a.prototype.Kj=function(a){var b,c,e,f,g,h=this,i=a.Cf().getAllSourceModels();for(e=0;e<i.length;e++)if(f=i[e],f.lmb)for(b=f.lmb(),g=0;g<b.length;g++)c=b[g],c&&c.isVolatile&&c instanceof d.CellCalc&&!h.isAdjustCell(c)&&h.hh(c,0)},a.prototype.onBeforeAddRemoveRows=function(a,b,c){[a,c].forEach(function(a){if(a){var c=a.rC(),d=a.cC();a.Sg(b,0,c-b,d),a.Ug(b,c-b),ca(a,b,-1,c-b,-1,!0)}})},a.prototype.onAfterAddRemoveRows=function(a,b,c,d,e,f){var g=this;[a,f].forEach(function(a){if(a){var e=a.rC(),f=a.cC();d?a.Ag(b,0,c,f):e+=c,g.Dj(a,b,0,e-b,f),g.Jj(a,b,e-b),g.Kj(a)}}),g.Gj(a.getSource(),b,c,!0,d,m,e),a.Cf().autoCalculation&&a.Cf().recalculateAll(!1)},a.prototype.onAfterAddRemoveColumns=function(a,b,c,d,e,f){var g=this;[a,f].forEach(function(a){if(a){var e=a.rC(),f=a.cC();d?a.Ag(0,b,e,c):f+=c,g.Dj(a,0,b,e,f-b),g.Ij(a,b,f-b),g.Kj(a)}}),g.Gj(a.getSource(),b,c,!1,d,m,e),a.Cf().autoCalculation&&a.Cf().recalculateAll(!1)},a.prototype.onBeforeAddRemoveColumns=function(a,b,c){[a,c].forEach(function(a){if(a){var c=a.rC(),d=a.cC();a.Sg(0,b,c,d-b),a.Wg(b,d-b),ca(a,-1,b,-1,d-b,!0)}})},a.prototype.onAfterRemoveName=function(a,b){var c=a.wg(b,!1);c&&(c.updateListening(!0,!1),c.fh(),c.updateListeningOnRemoved())},a.prototype.adjustFormulaOnRemoveName=function(a,b,c){return da(a,b,c)},a.prototype.invalidName=function(a,b){var c,d;b&&(c=a.getCalcSourceModel(),d=c.wg(b.toUpperCase(),!0),d&&d.Yg())},a.prototype.onAfterRemoveTable=function(b,c){var d,e,f,g,i,j,k,l,m,n,o,p,q=this;for(i=0;i<b.length;i++)j=b[i],ca(j.source().getCalcSourceModel(),j.startRow(),j.startColumn(),j.endRow()-j.startRow()+1,j.endColumn()-j.startColumn()+1);if(k=q.imb)for(l={};k[0];)if(m=k[0],d=m.ah,e=m.row,f=m.column,y(l,e,f))q.Fj(m,0);else{if(g=d.Kf(e,f))if(g=a.adjustExpressionOnRemoveTable(g,b,e,f,c),n=d.Qf(e,f),n&&!n.isDynamicArray)for(n=h.kf(e,f,n.rowCount,n.colCount),o=e;o<e+n.rowCount;o++)for(l[o]||(l[o]={}),p=f;p<f+n.colCount;p++)d.fg(o,p,g,n,o===e&&p===f),x(l,o,p,!0);else d.fg(e,f,g,n,!0);else(d.getRowExpression&&d.getRowExpression(e)||d.getColumnExpression&&d.getColumnExpression(f))&&d.Ag(e,f,1,1);q.Fj(m,0)}},a.adjustExpressionOnRemoveTable=function(b,c,e,f,g){var h,i,j,k,l,m,o,p,q,r,s,t,u,v,w,x,y,z=a.adjustExpressionOnRemoveTable;if(9===b.type){if(h=b.value,i=b.value2,j=z(h,c,e,f,g),k=i&&z(i,c,e,f,g),h!==j||i!==k)return d.Kh(b.operatorType,j,k)}else if(7===b.type){for(l=!1,m=[],o=0;o<b.arguments.length;o++)p=b.arguments[o],q=z(p,c,e,f,g),l=l||p!==q,m.push(q);if(l)return d.Jh(b,m)}else if(10===b.type){if(r=b,s=r.value,t=z(s,c,e,f,g),s!==t)return d.Lh(t)}else if(13===b.type)for(u=b,o=0;o<c.length;o++)if(u.baseTable===c[o])return g?d.Ih:(v=u.getRange(e===-1?0:e,f===-1?0:f,!0),w=e===-1||1===u.referencePortions(),x=1===v.rowCount&&1===v.columnCount,y=u.source,x?d.rf(y,n,v.row,v.col,w,!1):d.uf(y,n,v.row,v.col,v.row+v.rowCount-1,v.col+v.colCount-1,w,!1,w,!1));return b},a}(),b.CalcOperatorAdjustor=s,t=d.CalcService.prototype,t.uzb=function(){return new s};function z(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p;return c>=0||!e?(m=d+(e?c:0),n=f+(g?c:0),o=k&&L(h,a,k),p=!k&&L(h,a,k),(o||p)&&(!l&&i+j<=c||l&&i<=c)&&(m-=e?j:0,n-=g?j:0),o=k&&L(h,b,k),p=!k&&L(h,b,k),(o||p)&&(!l&&i<=m||l&&(e&&c+d>=i||!e&&d>=i)?(m+=j,n+=j):(!l&&i<=n||l&&(g&&c+f>=i||!g&&f>=i))&&(n+=j)),m-=e?c:0,n-=g?c:0,l&&i+j<=c&&(m+=e?j:0,n+=g?j:0),{index:m,endIndex:n}):{index:d,endIndex:f}}function A(a,b,c,e,f,g,h,i,j,k,l,m){if(b&&!m){var n=j?f.row:f.column,p=j?f.rowRelative:f.columnRelative,q=void 0;if(j&&c>=0||!j&&e>=0||!p){if(k)q=z(a,b,j?c:e,n,p,-1,!1,g,h,i,j,l).index;else if(q=K(a,b,j?c:e,n,p,g,h,i,j,l),o(q))return d.Hh(q);q!==n&&(f=f.offset(j?q-n:0,j?0:q-n,!0))}}return f}function B(a,b,c,e,f,g,h,i,j,k,l,m){var n,p,q,r,s,t,u,v;if(b&&!m){if(n=f.tf(),3===n||j&&2===n||!j&&1===n)return f;if(p=j?f.rowRelative:f.columnRelative,q=j?f.endRowRelative:f.endColumnRelative,r=j?f.row:f.column,s=j?f.endRow:f.endColumn,t=void 0,j&&c>=0||!j&&e>=0||!p||!q){if(k)t=z(a,b,j?c:e,r,p,s,q,g,h,i,j,l);else if(t=M(a,b,j?c:e,r,p,s,q,g,h,i,j,l),o(t))return d.Hh(t);u=t.index,v=t.endIndex,u===r&&v===s||(f=f.offset2(j?u-r:0,j?0:u-r,j?v-s:0,j?0:v-s,c,e))}}return f}function C(a,b,c,d,e,f,g,h,i){if(b){var j=e;if(j)return j.offsetWhenInsertRemoveColumn(g,h,i)}return e}function D(a,b,c,e,f,g,h,i,j,k,l,o){var p,q,r,s,t,u,v,w,x=D,y=e;if(e){if(1===e.type&&e.sf()||33===e.type)y=A(a,e.source||a,b,c,e,f,g,h,i,j,l,o);else if(1===e.type)y=B(a,e.source||a,b,c,e,f,g,h,i,j,l,o);else if(10===e.type)p=x(a,b,c,e.value,f,g,h,i,j,m,l,o),
p!==e.value&&(y=d.Lh(p));else if(9===e.type)q=x(a,b,c,e.value,f,g,h,i,j,m,l,o),r=e.value2&&x(a,b,c,e.value2,f,g,h,i,j,m,l,o),q===e.value&&r===e.value2||(y=d.Kh(e.operatorType,q,r));else if(7===e.type){for(s=n,t=void 0,u=void 0,v=e,w=v.arguments.length,u=0;u<w;u++)if(t=v.arguments[u],p=x(a,b,c,t,f,g,h,i,j,m,l,o),p!==t){s=[],s[u]=p;break}if(s){for(u=0;u<w;u++)t=v.arguments[u],s[u]!==m&&s[u]!==n||(s[u]=x(a,b,c,t,f,g,h,i,j,m,l,o));y=d.Jh(v,s)}}else l||i||13!==e.type||(y=C(a,a,b,c,e,f,g,h,j));return y}}function E(a,b,c,d,e,f,g,h,i,j){var k=function(e,f,g,h){return b.call(this,e,g,h,f,a,c,d,i,j)},l=a.getSheet(),m=l.uja&&(l.parent||l).tja(),n=l.ITa&&l.ITa.dUa();F(m,k,i,n)}function F(a,b,c,d){var e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;if(a)for(k=0;k<a.length;k++){for(l=!0,m=!0,n=g.maxRowCount-1,o=g.maxColumnCount-1,e=a[k].validator,p=e.n5,q=0,r=p.length;q<r&&(s=p[q],t=s.rowCount,u=s.colCount,i=s.row,j=s.col,t!==-1&&(m=!1,n=n>i?i:n),u!==-1&&(l=!1,o=o>j?j:o),l||m);q++);if(!(c&&m||!c&&l)&&(h=a[k].sheet,v=h.yj(),f=e.condition(),w=f.getExpressions(),w&&w.length>0)){for(x=0;x<w.length;x++)y=w[x],w[x]=b(v,y,n,o);f.setExpressions(w,d)}}}function G(a){var b=[],c=a.parent,d=c&&c.sheets||[a];return d.forEach(function(a){var c=a.conditionalFormats,d=c&&c.getRules();d&&d.length&&d.forEach(function(c){c.xyb&&b.push({rule:c,sheet:a})})}),b}function H(a,b,c,d,e,f){var g=function(g,h,i,j){return b.call(this,g,i,j,h,a,c,d,e,f)},h=a.getSheet(),i=G(h),j=h.ITa&&h.ITa.dUa();I(i,g,j,e,f)}function I(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;if(a)for(f=0,g=a.length;f<g;f++){if(h=a[f].rule,i=h.ranges(),j=q(i),k=j.r,l=j.c,m=a[f].sheet,n=m.yj(),o=h.condition(),p=m.tables,p&&i&&1===i.length&&(r=i[0],s=r.row,t=r.col,u=r.rowCount,v=r.colCount,w=void 0,e&&d?w=p.KFc(s,t,u,v):m.dJb&&m.zFc&&(w=[m.zFc]),w&&w.length)){for(x=!1,y=0,z=w.length;y<z;y++)if(A=w[y],B=A.row,C=A.col,D=A.rowCount,E=A.colCount,s===B&&u===D&&t>=C&&t+v<=C+E){x=!0;break}if(x)continue}if(o||(h.initCondition(),o=h.condition()),F=o&&o.getExpressions(),F&&F.length>0){for(G=0;G<F.length;G++)H=F[G],F[G]=b(n,H,k,l);o.setExpressions(F,c)}}}function J(a,b,c){var d=function(a,d,e,f){return $.call(this,a,e,f,d,b,c)},e=a.getSheet(),f=G(e);I(f,d,e.ITa.dUa())}function K(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o;if(c>=0||!e){if(k=d+(e?c:0),l=i&&L(f,a,i),m=!i&&L(f,a,i),(l||m)&&g<=c&&(k+=e?h:0),l=i&&L(f,b,i),m=!i&&L(f,b,i),l||m)if(n=c+d,o=c+h+d,!j&&g+h<=k||j&&n>=g+h)k-=h;else if(!j&&g<=k||j&&n>=g&&g<=o&&o<=g+h)return p;return k-=e?c:0,j&&g<=c&&(k-=e?h:0),k}return d}function L(a,b,c){var d=c?{2:!0}:{1:!0};return a===b||a.kj===b.kj&&(3===a.Wz&&d[b.Wz]||d[a.Wz]&&3===b.Wz)}function M(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,q,r,s,t;if(c>=0||!e){if(m=d+(e?c:0),n=f+(g?c:0),o=i+j-1,q=k&&L(h,a,k),r=!k&&L(h,a,k),(q||r)&&i<=c&&(m+=e?j:0,n+=g?j:0),q=k&&L(h,b,k),r=!k&&L(h,b,k),q||r)if(s=c+d,t=c+f,!l&&o<m||l&&o<s)m-=j,n-=j;else{if(!l&&i<=m&&o>=n||l&&i<=s&&o>=t)return p;!l&&i>n||l&&i>t||(!l&&o<=n||l&&o<=t?(m=!l&&i>=m||l&&i>=s?m:i,n-=j):n=i-1)}return m-=e?c:0,n-=g?c:0,l&&i<=c&&(m-=e?j:0,n-=e?j:0),{index:m,endIndex:n}}return{index:d,endIndex:f}}function N(a,b,c){var e,f,g,h,i,k,l,o,p,q,r,s,t,u,v,w,x=N,y=b;if(b)if(b.source)if(h=b.source,i=b.endSource,i&&h!==i){if(k=h.kj&&h.kj.parent,!k)return d.Ih;i===c?(l=c.VDc,y.endSource=k.getSheet(l-1).yj()):h===c&&(o=c.VDc,y.source=k.getSheet(o).yj()),delete c.VDc,y.source===y.endSource&&delete y.endSource}else(a!==c&&h===c||a===c&&h!==c)&&(y=d.Ih);else if(10===b.type)e=x(a,b.value,c),e!==b.value&&(y=d.Lh(e));else if(9===b.type)p=x(a,b.value,c),q=b.value2&&x(a,b.value2,c),p===b.value&&q===b.value2||(y=d.Kh(b.operatorType,p,q));else if(7===b.type){for(r=n,s=b.arguments.length,g=0;g<s;g++)if(f=b.arguments[g],e=x(a,f,c),e!==f){r=[],r[g]=e;break}if(r){for(g=0;g<s;g++)f=b.arguments[g],r[g]!==m&&r[g]!==n||(r[g]=x(a,f,c));y=d.Jh(b,r)}}else 8===b.type&&(t=a||c,u=j(b.value),v=t.getCustomName(u),v&&v.source?h=v.source:(w=t.Af.getGlobalSourceModel()||t.getCalcSourceModel(),v=w.getSource().getCustomName(u),v&&v.source&&(h=v.source)),h&&(a!==c&&h===c||a===c&&h!==c)&&(y=d.Ih));return y}function O(a,b,c,d,e){return N(a,d,e)}function P(a,b){return a.Qj===a.Rj&&b!==a.Qj}function Q(a,b,c,e,f,g,h,i){return h?d.BLb(i,a,b,c,e,f,g):d.rf(a,b,c,e,f,g)}function R(a,b,c,e,f,g){var h,i,j,k,l,m,o=!!e.source,p=e.source||a,q=e.rowRelative,r=e.columnRelative,s=f.Nj(),t=f.Oj(),u=33===e.type,v=u&&e.contextSource;if((b>=0||!q)&&(c>=0||!r)){if(h=e.row+(q?b:0),i=e.column+(r?c:0),g&&g.isNameID||a===f.Rj&&(a===f.Qj?k=f.Pj(f.Qj,b,c,1,1):(l=b,m=c,g&&g.crossSheetMoved&&(l-=s,m-=t),k=f.Sj(f.Rj,l,m,1,1))),p===f.Qj&&f.Pj(p,h,i,1,1)&&!f.Sj(p,h,i,1,1)&&(!q&&!r||!k))return d.Ih;if(j=(o&&p===f.Rj||!o&&a===f.Rj)&&(!k&&f.Sj(f.Rj,h,i,1,1)||k&&f.Pj(f.Qj,q?h:h+s,r?i:i+t,1,1)),k&&(h-=q?s:0,i-=r?t:0),j&&(h+=s,i+=t),h-=q?b:0,i-=r?c:0,p=e.source,f.Rj!==f.Qj&&(j&&k?o&&(p=f.Qj):j?p=f.Qj:k&&!o&&(p=f.Rj)),h!==e.row||i!==e.column||p!==e.source)return Q(p,n,h,i,q,r,u,v)}else if((b>=0||!q)&&c===-1){if(h=e.row+(q?b:0),f.Pj(a,b,c,1,1)&&(h-=q?s:0),f.Sj(p,h,-1,1,-1))h+=s;else if(f.Pj(p,h,-1,1,-1))return d.Ih;if(h-=q?b:0,h!==e.row)return Q(e.source,n,h,e.column,q,e.columnRelative,u,v)}else if(b===-1&&c>=0&&!r){if(i=e.column+(r?c:0),f.Pj(a,b,c,1,1)&&(i-=r?t:0),f.Sj(p,h,i,1,1))i+=t;else if(f.Pj(p,h,i,1,1))return d.Ih;if(i-=r?c:0,h!==e.row||i!==e.column)return Q(e.source,e.endSource,e.row,i,e.rowRelative,r,u,v)}return e}function S(a,b){if(b=a.getIntersect(b,0,0),!b)return n;var c=a.row,d=a.col,e=a.rowCount,f=a.colCount;return a.rowCount===b.rowCount&&a.colCount===b.colCount||(a.rowCount===b.rowCount?(a.col===b.col&&(d=a.col+b.colCount),f=a.colCount-b.colCount):a.colCount===b.colCount&&(a.row===b.row&&(c=a.row+b.rowCount),e=a.rowCount-b.rowCount)),h.kf(c,d,e,f)}function T(a,b,c,d,e){var f,g;return!(!b||!a)&&(f=b.getIntersect(a,0,0),!(f||!(g=b.getIntersect(c,0,0)))||(!(!f||f.rowCount!==b.rowCount||0===e)||!(!f||f.colCount!==b.colCount||0===d)))}function U(a,b,c){var d=a.getRange(b,c);return h.kf(d.row,d.col,d.rowCount,d.colCount)}function V(a,b,c,d){var e,f=S(a,b);return f?(e=f.union(c),d?(e.col=a.col,e.colCount=a.colCount):(e.row=a.row,e.rowCount=a.rowCount)):e=c,{startRow:e.row,endRow:e.row+e.rowCount-1,startColumn:e.col,endColumn:e.col+e.colCount-1}}function W(a,b,c,d,e){var f,g=S(a,b),h=a.getIntersect(b,0,0);return h?(h.row+=d,h.col+=e,f=g?g.union(h):c,{startRow:f.row,endRow:f.row+f.rowCount-1,startColumn:f.col,endColumn:f.col+f.colCount-1}):n}function X(a,b){var c=a.row,d=a.col,e=a.rowCount,f=a.colCount,g=b.row,h=b.col,i=b.rowCount,j=b.colCount;return 1===e&&1!==f?h<d&&d<=h+j-1||h<=d+f-1&&d+f-1<h+j-1:1!==f||1===e||(g<c&&c<=g+i-1||g<=c+e-1&&c+e-1<g+i-1)}function Y(a,b,c,d,e,f){var g,i,j,k,l=U(d,e,f),m=l.row,n=l.row+l.rowCount-1,o=l.col,p=l.col+l.colCount-1,q=a.Vj,r=q+a.Xj-1,s=a.Wj,t=s+a.Yj-1,u=a.Tj,v=a.Uj,w=h.kf(q,s,a.Xj,a.Yj),x=h.kf(u,v,a.Xj,a.Yj),y=l.getIntersect(x,0,0);if(T(w,l,x,b,c))if(i=0!==b,j=void 0,k=void 0,i)if(j=m>=q&&m<=r,k=n>=q&&n<=r,j&&k)m+=b,n+=b;else if(j&&!k)if(b<=0)m+=b;else if(q+b>n);else{if(!(r+b<n))return W(l,w,x,b,c);if(q===m)return V(l,w,x,i);m+=b}else if(!j&&k)if(b>=0)n+=b;else if(r+b<m);else{if(!(u>m))return W(l,w,x,b,c);if(r===n)return V(l,w,x,i);n+=b}else y&&!y.equals(x)&&X(l,x)&&(g=S(l,y),m=g.row,n=g.row+g.rowCount-1,o=g.col,p=g.col+g.colCount-1);else if(j=o>=s&&o<=t,k=p>=s&&p<=t,j&&k)o+=c,p+=c;else if(j&&!k)if(c<0)o+=c;else if(s+c>p);else{if(!(t+c<p))return W(l,w,x,b,c);if(s===o)return V(l,w,x,i);o+=c}else if(!j&&k)if(c>0)p+=c;else if(t+c<o);else{if(!(v>o))return W(l,w,x,b,c);if(t===p)return V(l,w,x,i);p+=c}else y&&!y.equals(x)&&X(l,x)&&(g=S(l,y),m=g.row,n=g.row+g.rowCount-1,o=g.col,p=g.col+g.colCount-1);return{startRow:m,endRow:n,startColumn:o,endColumn:p}}function Z(a,b,c,e,g,h){var i,j,k,l,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,Q,R,S,T,U,V,W,X,Z,$,_,aa,ba,ca,da,ea=!!e.source,fa=ea?e.source:a,ga=e.tf(),ha=g.Nj(),ia=g.Oj(),ja=h&&h.isDataValidator,ka=P(g,a),la=!1;if(0===ga)if(i=e.rowRelative,j=e.columnRelative,k=e.endRowRelative,l=e.endColumnRelative,b>=0||!i||!k||c>=0||!j||!l){if(o=e.row+(i?b:0),p=e.endRow+(k?b:0),q=e.column+(j?c:0),r=e.endColumn+(l?c:0),s=p-o+1,t=r-q+1,!ja&&ka){if(C=g.Sj(g.Rj,o,q,s,t))return e.offset(ha,ia,!0);if(g.Pj(fa,o,q,s,t))return d.Ih;if(fa!==g.Rj||fa!==g.Qj||0!==ha&&0!==ia)return e;la=!0}if(h&&h.isNameID||a===g.Rj&&(a===g.Qj?B=g.Pj(g.Qj,b,c,1,1):(D=b,E=c,h&&h.crossSheetMoved&&(D-=ha,E-=ia),B=g.Sj(g.Rj,D,E,1,1))),(la||a===fa&&a===g.Rj&&a===g.Qj)&&(F=b,G=c,B&&(F-=ha,G-=ia),0===ha||0===ia)){if(H=Y(g,ha,ia,e,F,G),!H)return d.Ih;if(0===ia&&ha&&H.endColumn>=r&&H.startColumn<=q||0===ha&&ia&&H.endRow>=p&&H.startRow<=o)return I=H.startRow,J=H.startColumn,K=H.endRow,L=H.endColumn,I===o&&K===p&&J===q&&L===r?e:(i&&(I-=b),k&&(K-=b),j&&(J-=c),l&&(L-=c),d.uf(e.source,n,I,J,K,L,i,j,k,l,b,c))}if(B&&(M=g.Tj-g.Vj,N=g.Uj-g.Wj,s+=(i?-M:0)+(k?M:0),t+=(j?-N:0)+(l?N:0)),fa===g.Qj&&g.Pj(fa,o,q,s,t)&&!t&&(!i&&!j&&!k&&!l||!B))return d.Ih;if(A=(ea&&fa===g.Rj||!ea&&a===g.Rj)&&(!B&&g.Sj(g.Rj,o,q,s,t)||B&&g.Pj(g.Qj,i?o:o+ha,j?q:q+ia,s,t)),B&&(w=i?ha:0,x=k?ha:0,y=j?ia:0,z=l?ia:0,o-=w,p-=x,q-=y,r-=z),O=!1,A)u=ha,v=ia,o+=u,p+=u,q+=v,r+=v;else if(g.Pj(fa,o,q,s,t)){if(Q=g.intersectWith(fa,o,q,s,t),!Q||Q.rowCount!==s&&Q.colCount!==t)return d.Ih;o=Q.row+ha,q=Q.col+ia,p=o+Q.rowCount,r=q+Q.colCount,O=!0}if(o-=i?b:0,p-=k?b:0,q-=j?c:0,r-=l?c:0,g.Rj===g.Qj?fa=ea?e.source:m:(fa=e.source,A&&B&&ea?fa=g.Qj:A&&B||(A?fa=g.Qj:B&&!ea&&(fa=g.Rj))),o!==e.row||q!==e.column||p!==e.endRow||r!==e.endColumn||O||fa!==e.source)return d.uf(fa,n,o,q,p,r,i,j,k,l,b,c)}else if(!(b>=0)&&i&&k||c!==-1){if(b===-1&&(c>=0||!j||!l)){if(q=e.column+(j?c:0),r=e.endColumn+(l?c:0),q>r)return d.Ih;if(g.Pj(a,b,c,1,1)&&(y=j?ia:0,z=l?ia:0,q-=y,r-=z),t=r-q+1,g.Sj(fa,-1,q,-1,t))v=ia,q+=v,r+=v;else if(g.Pj(fa,-1,q,-1,t))return d.Ih;if(q-=j?c:0,r-=l?c:0,q!==e.column||r!==e.endColumn)return d.uf(e.source,n,e.row,q,e.endRow,r,e.rowRelative,j,e.endRowRelative,l,b,c)}}else{if(o=e.row+(i?b:0),p=e.endRow+(k?b:0),o>p)return d.Ih;if(g.Pj(a,b,c,1,1)&&(w=i?ha:0,x=k?ha:0,o-=w,p-=x),s=p-o+1,g.Sj(fa,o,-1,s,-1))u=ha,o+=u,p+=u;else if(g.Pj(fa,o,-1,s,-1))return d.Ih;if(o-=i?b:0,p-=k?b:0,o!==e.row||p!==e.endRow)return d.uf(e.source,n,o,e.column,p,e.endColumn,i,e.columnRelative,k,e.endColumnRelative,b,c)}else if(1===ga){if(i=e.rowRelative,k=e.endRowRelative,b>=0||!i||!k){if(o=e.row+(i?b:0),p=e.endRow+(k?b:0),o>p)return d.Ih;if(B=a===g.Rj&&a===g.Qj&&g.Pj(g.Qj,b,c,1,1),fa===g.Rj&&fa===g.Qj&&0===g.Wj&&0===g.Uj&&g.Yj===fa.getColumnCount()){if(R=g.Vj,S=g.Tj,T=g.Xj,B&&(o-=ha,p-=ha),U=R+T,V=o>=R&&U>o,W=p>=R&&U>p,V&&W)return B?e:e.offset(ha,ia,!0);if(X=S+T,V&&S<=p?(o+=ha,X>p&&p>=S&&(p=X-1,o=U)):W&&X>=o&&(p+=ha,S<=o&&q<X&&(o=S,p=R-1)),o-=i?b:0,p-=k?b:0,o!==e.row||p!==e.endRow)return d.uf(e.source,e.endSource,o,f.BAND_INDEX_CONST,p,f.BAND_INDEX_CONST,i,j,k,l,b,c)}if(B)return e.offset(-ha,ia,!0)}}else if(2===ga){if(j=e.columnRelative,l=e.endColumnRelative,q=e.column+(j?c:0),r=e.endColumn+(l?c:0),q>r)return d.Ih;if(B=a===g.Rj&&a===g.Qj&&g.Pj(g.Qj,b,c,1,1),fa===g.Rj&&fa===g.Qj&&0===g.Vj&&0===g.Tj&&g.Xj===fa.getRowCount()){if(Z=g.Wj,$=g.Uj,_=g.Yj,B&&(q-=ia,r-=ia),aa=Z+_,ba=q>=Z&&aa>q,ca=r>=Z&&aa>r,ba&&ca)return B?e:e.offset(ha,ia,!0);if(da=$+_,ba&&$<=r?(q+=ia,da>r&&r>=$&&(r=da-1,q=aa)):ca&&da>=q&&(r+=ia,$<=q&&q<da&&(q=$,r=Z-1)),q-=j?c:0,r-=l?c:0,q!==e.column||r!==e.endColumn)return d.uf(e.source,e.endSource,f.BAND_INDEX_CONST,q,f.BAND_INDEX_CONST,r,i,j,k,l,b,c)}if(B)return e.offset(ha,-ia,!0)}return e}function $(a,b,c,e,f,g,h){var i,j,k,l,o,p,q,r=$,s=e;if(1===e.type&&e.sf()||33===e.type)s=g?R(a,b,c,e,f,h):aa(a,b,c,e,f);else if(1===e.type)s=g?Z(a,b,c,e,f,h):ba(a,b,c,e,f);else if(10===e.type)i=r(a,b,c,e.value,f,g,h),i!==e.value&&(s=d.Lh(i));else if(9===e.type)j=r(a,b,c,e.value,f,g,h),k=e.value2&&r(a,b,c,e.value2,f,g,h),j===e.value&&k===e.value2||(s=d.Kh(e.operatorType,j,k));else if(7===e.type){for(l=n,o=void 0,p=void 0,q=e.arguments.length,p=0;p<q;p++)if(o=e.arguments[p],i=r(a,b,c,o,f,g,h),i!==o){l=[],l[p]=i;break}if(l){for(p=0;p<q;p++)o=e.arguments[p],l[p]!==m&&l[p]!==n||(l[p]=r(a,b,c,o,f,g,h));s=d.Jh(e,l)}}return s}b.adjustFormulaOnMoveSwap=$;function _(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=b.Rj.getSheet().ITa.dUa();for(d=0;d<a.length;d++)if(e=a[d].validator,f=e.n5,g=q(f),h=g.r,i=g.c,j=a[d].sheet,k=j.yj(),l=e.condition(),m=l.getExpressions(),m&&m.length>0){for(n=0;n<m.length;n++)o=m[n],m[n]=$(k,h,i,o,b,c,{isDataValidator:!0});l.setExpressions(m,p)}}function aa(a,b,c,d,e){var f,g,h=d.source||a,i=d.rowRelative,j=d.columnRelative,k=e.Nj(),l=e.Oj(),m=33===d.type,o=m&&d.contextSource;if((b>=0||!i)&&(c>=0||!j)){if(f=d.row+(i?b:0),g=d.column+(j?c:0),e.Pj(a,b,c,1,1)?(f-=i?k:0,g-=j?l:0):e.Sj(a,f,g,1,1)&&(f+=i?k:0,g+=j?l:0),e.Sj(h,f,g,1,1)?(f+=k,g+=l):e.Pj(h,f,g,1,1)&&(f-=k,g-=l),f-=i?b:0,g-=j?c:0,f!==d.row||g!==d.column)return Q(d.source,n,f,g,i,j,m,o)}else if((b>=0||!i)&&c===-1){if(f=d.row+(i?b:0),e.Pj(a,b,-1,1,-1)?f-=i?k:0:e.Sj(a,f,-1,1,-1)&&(f+=i?k:0),e.Sj(h,f,-1,1,-1)?f+=k:e.Pj(h,f,-1,1,-1)&&(f-=k),f-=i?b:0,f!==d.row||g!==d.column)return Q(d.source,n,f,d.column,i,d.columnRelative,m,o)}else if(b===-1&&c>=0&&!j&&(g=d.column+0,e.Pj(a,-1,c,-1,1)?g-=0:e.Sj(a,-1,g,-1,1)&&(g+=0),e.Sj(h,-1,g,-1,1)?g+=l:e.Pj(h,-1,g,-1,1)&&(g-=l),g-=0,f!==d.row||g!==d.column))return Q(d.source,n,d.row,g,d.rowRelative,j,m,o);return d}function ba(a,b,c,e,g){var h,i,j,k,l,m,o,p,q,r,s,t,u,v,w,x,y=e.source||a,z=e.tf(),A=g.Nj(),B=g.Oj();if(0===z){if(o=e.rowRelative,p=e.columnRelative,q=e.endRowRelative,r=e.endColumnRelative,!(b>=0)&&o&&q||!(c>=0)&&p&&r)if(!(b>=0)&&o&&q||c!==-1){if(b===-1&&(c>=0||!p||!r)){if(j=e.column+(p?c:0),k=e.endColumn+(r?c:0),j<k)return d.Ih;if(g.Pj(a,-1,c,-1,1)?(v=p?B:0,x=r?B:0,j-=v,k-=x):g.Sj(a,-1,c,-1,1)&&(v=p?B:0,x=r?B:0,j+=v,k+=x),m=k-j,g.Sj(y,-1,j,-1,m)?(t=B,j+=t,k+=t):g.Pj(y,-1,j,-1,m)&&(t=B,j-=t,k-=t),j-=p?c:0,k-=r?c:0,j!==e.column||k!==e.endColumn)return d.uf(e.source,n,j,e.endRow,k,e.rowRelative,p,e.endRowRelative,r,b,c)}}else{if(h=e.row+(o?b:0),i=e.endRow+(q?b:0),h<i)return d.Ih;if(g.Pj(a,b,-1,1,-1)?(u=o?A:0,w=o?A:0,h-=u,i-=w):g.Sj(a,b,-1,1,-1)&&(u=o?A:0,w=o?A:0,h+=u,i+=w),l=i-h,g.Sj(y,h,-1,l,-1)?(s=A,h+=s,i+=s):g.Pj(y,h,-1,l,-1)&&(s=A,h-=s,i-=s),h-=o?b:0,i-=q?b:0,h!==e.row||i!==e.endRow)return d.uf(e.source,n,h,e.column,i,e.endColumn,o,e.columnRelative,q,e.endColumnRelative,b,c)}else if(h=e.row+(o?b:0),i=e.endRow+(q?b:0),j=e.column+(p?c:0),k=e.endColumn+(r?c:0),l=i-h,m=k-j,g.Pj(a,b,c,1,1)?(u=o?A:0,v=p?B:0,w=q?A:0,x=r?B:0,h-=u,i-=w,j-=v,k-=x):g.Sj(a,h,j,l,m)&&(u=o?A:0,v=p?B:0,w=q?A:0,x=r?B:0,h+=u,i+=w,j+=v,k+=x),g.Sj(y,h,j,l,m)?(s=A,t=B,h+=s,i+=s,j+=t,k+=t):g.Pj(y,h,j,l,m)&&(s=A,t=B,h-=s,i-=s,j-=t,k-=t),h-=o?b:0,i-=q?b:0,j-=p?c:0,k-=r?c:0,h!==e.row||j!==e.column||i!==e.endRow||k!==e.endColumn)return d.uf(e.source,n,h,j,i,k,o,p,q,r,b,c)}else if(1===z){if(o=e.rowRelative,q=e.endRowRelative,b>=0||!o||!q){if(h=e.row+(o?b:0),i=e.endRow+(q?b:0),h<i)return d.Ih;if(g.Pj(a,b,-1,1,-1)?(u=o?A:0,w=q?A:0,h-=u,i-=w):g.Sj(a,b,-1,1,-1)&&(u=o?A:0,w=q?A:0,h+=u,i+=w),l=i-h,g.Sj(y,h,-1,l,-1)?(s=A,h+=s,i+=s):g.Pj(y,h,-1,l,-1)&&(s=A,h-=s,i-=s),h-=o?b:0,i-=q?b:0,h!==e.row||i!==e.endRow)return d.uf(e.source,n,h,f.BAND_INDEX_CONST,i,f.BAND_INDEX_CONST,o,!1,q,!1,b,c)}}else if(2===z){if(p=e.columnRelative,r=e.endColumnRelative,j=e.column+(p?c:0),k=e.endColumn+(r?c:0),j>k)return d.Ih;if(g.Pj(a,-1,c,-1,1)?(v=p?B:0,x=r?B:0,j-=v,k-=x):g.Sj(a,-1,c,-1,1)&&(v=p?B:0,x=r?B:0,j+=v,k+=x),m=k-j,g.Sj(y,-1,j,-1,m)?(t=B,j+=t,k+=t):g.Pj(y,-1,j,-1,m)&&(t=B,j-=t,k-=t),j-=p?c:0,k-=r?c:0,j!==e.column||k!==e.endColumn)return d.uf(e.source,n,f.BAND_INDEX_CONST,j,f.BAND_INDEX_CONST,k,!1,p,!1,r,b,c)}return e}function ca(a,b,c,d,e,f){a._g(b,c,d,e,!0,!1,f)}function da(a,b,c){var e,f,g,h,i,j,k,l=da,o=b;if(8===b.type){if(b.value===c&&(!b.source||b.source===a.getSource()))return d.Hh(p,b.source)}else if(10===b.type)e=l(a,b.value,c),e!==b.value&&(o=d.Lh(e));else if(9===b.type)h=l(a,b.value,c),i=b.value2&&l(a,b.value2,c),h===b.value&&i===b.value2||(o=d.Kh(b.operatorType,h,i));else if(7===b.type){for(j=n,k=b.arguments.length,g=0;g<k;g++)if(f=b.arguments[g],e=l(a,f,c),e!==f){j=[],j[g]=e;break}if(j){for(g=0;g<k;g++)f=b.arguments[g],j[g]!==m&&j[g]!==n||(j[g]=l(a,f,c));o=d.Jh(b,j)}}return o}},"./dist/plugins/sheetsCalc/parser-sheets.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("CalcEngine"),g=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),h=c("./dist/plugins/sheetsCalc/calc.ns.js"),i=c("./node_modules/util/util.js"),j=d.util.xq,k=new e.Common.ResourceManager(d.SR),l=k.getResource.bind(k),m=f.Errors.Reference,b.maxRowCount=1048576,b.maxColumnCount=16384,n=[1,26,676],o=void 0,p=null,q=["#all","#data","#headers","#totals","#this row"],r={" ":!0,"'":!0,"[":!0,"]":!0,"?":!0,"\\":!0,"%":!0,'"':!0,"(":!0,")":!0,"|":!0,"{":!0,"}":!0,"#":!0,"@":!0,"!":!0,$:!0,"^":!0,"\uff08":!0,"\uff09":!0,".":!0,";":!0};function B(a){return j(a+1).split("")}function C(a,b){var c=b+1;return a<0?a%c+c:a>b?a%c:a}function D(a){return new f.ErrorSource(a)}function E(a,b,c,d,e,f,g){return 3===g||c>=0&&d>=0||1===g&&c>=0||2===g&&d>=0}function F(a,b,c,d,e){var g,i,j=h.BAND_INDEX_CONST,k={cj:j,dj:j,ej:!0,fj:!0,gj:!1,li:0,Vka:!0},l=b?J(a,c,d,0):I(a,0,e);return l.hj?(k.cj=l.ij,k.ej=l.jj):(k.dj=l.ij,k.fj=l.jj),k.li=l.li,k.gj=l.gj,!l.gj||l.li>=a.length?k:!b&&l.hj||b&&!l.hj?{gj:!1}:(g=a[k.li],!b&&(f.isNumber(g)||"$"===g)||b&&("C"===g||"c"===g)?(i=b?J(a,c,d,k.li):I(a,k.li,e),k.li=i.li,!i.gj||!b&&!i.hj||b&&i.hj?(k.gj=!1,k):(i.CLb&&(k.CLb=!0),k.li<a.length&&(k.Vka=!1),b?(k.dj=i.ij,k.fj=i.jj):(k.cj=i.ij,k.ej=i.jj),k.gj=!0,k)):{gj:!1})}s=[1,10,100,1e3,1e4,1e5,1e6,1e6];function G(a){return f.ei(a)||95===a.charCodeAt(0)}function H(a,b,c){for(var d=a,e=b[a],f=!1;d<c&&!G(e);)d++,d<c&&(e=b[d]);if(d<c){for(;d<c&&G(e);)d++,d<c&&(e=b[d]);d<c&&(f=!0)}return f}function I(a,c,d){var e,g,h,i,j,k,l,m,o,p,q={jj:!0,gj:!1},r=a.length;if(c>=r)return q;if("$"===a[c]&&(q.jj=!1,c++),c>=r)return q;if(e=c,g=0,h=a[e],i=!1,f.isNumber(h)&&"0"!==h){for(q.hj=!0;e<r&&f.isNumber(h);)e++,e<r&&(h=a[e]);if(e+1===r&&"#"===h&&d&&(i=!0),e-c>7)return q;for(j=e-1,k=0;j>=c;j--,k++)g+=(a[j].charCodeAt(0)-48)*s[k];if(g<=b.maxRowCount)return q.ij=g-1,q.li=i?r:e,q.CLb=i,q.gj=!0,q}else if(f.ei(h)){for(q.hj=!1;e<r&&f.ei(h);)e++,e<r&&(h=a[e]);if(l=e-c,l>3)return q;if(H(e,a,r))return q;for(g=0,m=e-1,o=m;o>=c;o--){if(p=a[o].charCodeAt(0),!(p>=65&&p<=90||p>=97&&p<=122))return q;g+=((32|p)-96)*n[m-o]}if(g<=b.maxColumnCount)return q.ij=g-1,q.li=e,q.gj=!0,q}return q}function J(a,c,d,e){var g,i,j,k,l,m=h.BAND_INDEX_CONST,n={li:e,ij:m,hj:!0,jj:!1,gj:!1},o=a.length;if(e>=o)return n;if(g=e,i=a[g],"R"===i||"r"===i)n.hj=!0,j=c;else{if("C"!==i&&"c"!==i)return n;n.hj=!1,j=d}if(e++,g++,e>=o)return n.li=e,n.ij=j,n.jj=!0,n.gj=!0,n;if(i=a[g],"["===i&&(e++,g++,n.jj=!0),e>=o)return n;if(k=!1,i=a[g],n.jj&&"-"===i&&(e++,g++,k=!0),e>=o)return n;if(i=a[g],!f.isNumber(i))return n.jj?n:(n.li=e,n.ij=j,n.jj=!0,n.gj=!0,n);for(;g<o&&f.isNumber(i);)g++,g<o&&(i=a[g]);if(l=parseInt(a.slice(e,g).join(""),10),n.jj){if(g>=o||"]"!==a[g])return n;g++}return l<(n.hj?b.maxRowCount:b.maxColumnCount)?(n.jj?(l=k?-l:l,n.ij=l+j):n.ij=l-1,n.li=g,n.gj=!0,n):void 0}t=[{prefix:"ANCHORARRAY(",surfix:")"},{prefix:"",surfix:"#"}];function K(a,b,c,d){var e,g,h,i,j,k,l,m=a.source&&a.source.Af,n=a.row||0,p=a.column||0,q=a.Eh;if(c.source===f.BangSource)d.push("!");else if(c.source&&(e=N(a,d,c.source,c.endSource),!e))return void d.push("#","R","E","F","!");if(g=c.type,h=33===g,8===g||5===g)d.push(""+c.value);else if(100===g)i="_xlpm.",j=c.bhc,j&&m.UIc?d.push(i+(""+c.value)):d.push(""+c.value);else if(c.value&&c._error)d.push(""+c.value);else if(h||c.sf()){if(k=void 0,i=void 0,l=void 0,h&&(k=t[q?0:1],i=k.prefix,l=k.surfix,d.push(i),c.isReferenceError))return d.push("#REF!"),void d.push(l);!c.source&&a.addSheetName&&a.source&&N(a,d,a.source,o),L(a.useR1C1,n,p,c.row,c.column,c.rowRelative,c.columnRelative,d),h&&d.push(l)}else!c.source&&a.addSheetName&&a.source&&N(a,d,a.source,o),M(a.source,a.useR1C1,n,p,c.row,c.column,c.endRow,c.endColumn,c.rowRelative,c.columnRelative,c.endRowRelative,c.endColumnRelative,d,c.tf())}function L(a,c,d,e,g,h,i,j,k){var l,m;if(k=k||0,l=b.maxRowCount-1,(0===k||1===k)&&e>-l&&e<=2*l&&(e+=h?c:0,e=C(e,l)),m=b.maxColumnCount-1,(0===k||2===k)&&g>-m&&g<=2*m&&(g+=i?d:0,g=C(g,m)),!E(c,d,e,g,h,i,k))return void j.push(""+f.Errors.Reference);if(a){if(2!==k&&(j.push("R"),e>=0&&(c!==e||!h)&&(h?j.push("["+(e-c)+"]"):(e++,j.push(e+""))),g<0))return;1!==k&&(j.push("C"),d===g&&i||(i?j.push("["+(g-d)+"]"):(g++,j.push(g+""))))}else{if(g>=0&&(i||j.push("$"),j.push.apply(j,B(g))),e<0)return;e++,h||j.push("$"),j.push(e+"")}}function M(a,c,d,e,f,g,i,j,k,l,m,n,o,p){p=p||0,3===p&&(f=0,i=a?a.getRowCount():b.maxRowCount-1,p=1),L(c,d,e,f,g,k,l,o,p);var q=h.BAND_INDEX_CONST;(!c||f!==i||g!==j||i!==q&&j!==q)&&(i===q&&j===q||(o.push(":"),L(c,d,e,i,j,m,n,o,p)))}function N(a,b,c,d){if(a.getExternalSourceToken){if(c!==f.BangSource){var e=O(a,a.getExternalSourceToken(c).split(""),d&&a.getExternalSourceToken(d).split(""));if(!(e.length>0))return!1;b.push.apply(b,e)}return b.push("!"),!0}return!1}function O(a,b,c){if(!b||0===b.length||P(a,b)||P(a,c))return[];var d=b,e;if(S(b,!1)||c&&S(c,!1)){for(d=["'"],e=0;e<b.length;e++)"'"===b[e]&&d.push("'"),d.push(b[e]);if(c)for(d.push(":"),e=0;e<c.length;e++)"'"===c[e]&&d.push("'"),d.push(c[e]);d.push("'")}else if(c)for(d.push(":"),e=0;e<c.length;e++)d.push(c[e]);return d}function P(a,b){if(!b||0===b.length||!a.Eh)return!1;var c="'"===b[0]?1:0;return"["===b[c]&&b.indexOf("]")>c}function Q(a,b){var c,d,e;if(!a||0===a.length)return!0;if(!b){if(f.isNumber(a[0]))return!1;if(c=T(a),c.gj&&c.li<=a.length)return!1}for(e=0;e<a.length;e++)if(d=a[e],b){if("*"===d||":"===d||"["===d||"]"===d||"?"===d||"\\"===d||"/"===d)return!1}else if(r[d]||f.operaterTypesMap[d])return!1;return!0}b.jma=Q,b.validateSheetName=Q;function R(a,b){var c,d;if(!a||0===a.length)return!0;for(d=0;d<a.length;d++)if(c=a[d],b){if("*"===c||":"===c||"["===c||"]"===c||"?"===c)return!1;if("'"===c&&(0===d||d>=a.length-1||"'"!==a[d+1]))return!1}else if("'"===c||"["===c||"]"===c||"?"===c||"%"===c||f.operaterTypesMap[c])return!1;return!0}function S(a,b){var c,d,e;return!!f.isDigit(+a[0])||(c=[],d=a,"["===a[0]&&(e=a.lastIndexOf("]"),e>0&&(c=a.slice(1,e),d=a.slice(e+1))),!R(c)||!Q(d,b))}function T(a){var b=F(a,!1,0,0);return b.gj||(b=F(a,!0,0,0)),b}function U(a){var b=new f.Expression(8);return b.value=a,b}function V(a){var b=a;return a&&a.length>=3&&"["===a[0]&&"0"===a[1]&&"]"===a[2]&&(b=3===a.length?"":a.substring(3)),b}function W(a,b,c){var d,e,f,g,h,i=a.source;return i&&(e=i.q$a,f=i.cDc,g=i.dDc,e&&(h=b>=0&&b<f&&c>=g||b>=f&&c>=0&&c<g,h&&(d=i))),d}u=function(a){A(b,a);function b(b){var c=a.call(this,8e3)||this;return c.kj=b,c}return b.prototype.resolveToken=function(a,b,c,d){var e,g,j,k,l,m,n,o,q,r,s,t,u,v,w,x,y,z,A=a.useR1C1,B=a.row||0,C=a.column||0,E=c.length,G=c[d],H=G.ni,I=G.Nc,J=G.hi;if(0!==I&&6!==J)return!1;if(0===I&&0===J&&d<E-2&&":"===c[d+1].ni&&12===c[d+2].hi&&c[d+2].ni.indexOf(":")<0||0===I&&12===J){if(l=void 0,m=void 0,H&&(H.indexOf(":")>0?(n=H.indexOf(":"),l=H.substring(1,n-1),m=H.substring(n+1,H.length-2)):(l=H,"'"===l.charAt(0)&&(l=l.substring(1,l.length-1)),0===J&&(m=c[d+2].ni,"'"===m.charAt(0)&&(m=m.substring(1,m.length-1))))),d++,k=!!l,l=V(l),l&&(g=H?a.getExternalSource("",l):f.BangSource,g=g||D(l),m=V(m),m&&(j=a.getExternalSource("",m),j=j||D(m),d+=2)),G=c[d],!G)return U(H);H=G.ni}if(o=d===E-1?p:c[d+1],X(c,G,d,A,!0)){if(q=a&&a.source&&a.source.Af&&a.source.Af.allowDynamicArray,r=F(G.Qb,A,B,C,q),!r.gj&&!k)return!1;if(G.hi=7,r.gj&&r.Vka){if(s=r.cj,t=r.dj,u=r.ej,v=r.fj,w=r.CLb,d<E-2&&5===o.Nc&&":"===o.ni&&(o=c[d+2],X(c,o,d+2,A,!1)&&(x=F(o.Qb,A,B,C),x.gj&&s===h.BAND_INDEX_CONST==(x.cj===h.BAND_INDEX_CONST)&&t===h.BAND_INDEX_CONST==(x.dj===h.BAND_INDEX_CONST))))return B=s===h.BAND_INDEX_CONST?0:B,C=t===h.BAND_INDEX_CONST?0:C,{index:d+3,expr:f.uf(g,j,s-(u?B:0),t-(v?C:0),x.cj-(x.ej?B:0),x.dj-(x.fj?C:0),u,v,x.ej,x.fj,B,C)};if(s===h.BAND_INDEX_CONST||t===h.BAND_INDEX_CONST){if(A)return s-=s!==h.BAND_INDEX_CONST&&u?B:0,t-=t!==h.BAND_INDEX_CONST&&v?C:0,{index:d+1,expr:f.uf(g,j,s,t,s,t,u,v,u,v,B,C)};if(!g)return!1;e=U(H)}if(!e)return i.isNullOrUndefined(g)&&(g=W(a,B,C)),y=s-(u?B:0),z=t-(v?C:0),e=w?f.BLb(a.source,g,j,y,z,u,v):f.rf(g,j,y,z,u,v),{index:d+1,expr:e}}else e=U(H)}else if(6===G.hi)e=new f.Expression(5),e.value=f.CalcError.parse(G.ni);else{if(!g)return!1;e=U(H)}return g&&(e.source=g),j&&(e.endSource=j),{index:d+1,expr:e}},b.prototype.unparse=function(a,b,c,d){var e=c&&c.type;return(1===e||8===e||5===e||33===e||100===e)&&(K(a,b,c,d),!0)},b}(f.TokenResolver),b.SheetReferenceResolver=u;function X(a,b,c,d,e){return 0===b.Nc&&0===b.hi||!d&&0===b.Nc&&4===b.hi&&(!e||c<a.length-2&&":"===a[c+1].ni&&0===a[c+2].Nc&&4===a[c+2].hi)}!function(a){a[a.ThisRow=1]="ThisRow",a[a.Headers=2]="Headers",a[a.Data=3]="Data",a[a.Totals=8]="Totals",a[a.HeadersAndData=6]="HeadersAndData",a[a.DataAndTotals=12]="DataAndTotals",a[a.All=14]="All",a[a.NotSpecific=16]="NotSpecific"}(v=b.StructReferencePortions||(b.StructReferencePortions={})),function(a){a[a.All=1]="All",a[a.NotSpecific=1]="NotSpecific",a[a.SingleColumn=2]="SingleColumn",a[a.ColumnRange=4]="ColumnRange"}(w=b.StructReferenceColumnSpecifier||(b.StructReferenceColumnSpecifier={}));function Y(a,b,c,d,e){return b<=a.startRow()&&c<=a.startColumn()&&b+d>a.endRow()&&c+e>a.endColumn()}x=function(a){A(b,a);function b(){return a.call(this,13)||this}return b.prototype.tableName=function(){return this.lj.tableName()},Object.defineProperty(b.prototype,"baseTable",{get:function(){return this.lj},set:function(a){this.lj=a,this.source=a.source()},enumerable:!0,configurable:!0}),b.prototype.JUa=function(){this.vzb=this.lj.startColumn()},b.prototype.columnReferenceStart=function(){return this.oj+this.lj.startColumn()},b.prototype.columnReferenceEnd=function(){return this.pj+this.lj.startColumn()},b.prototype.referencePortions=function(){return this.qj},b.prototype.referenceColumnSpecifier=function(){return this.rj},b.prototype.getRange=function(a,b,c){var d,e,g,h,i,j,k,l,m,n,o,q=this,r=q.lj;switch(q.JUa(),k=r.startRow(),l=r.endRow(),m=r.hasTotalsRow(),n=r.hasHeadersRow(),q.qj){case 3:case 16:d=n?k+1:k,g=m?l-1:l;break;case 2:if(n)d=k,g=k;else{if(!c)return p;d=k-1,g=k-1}break;case 8:if(m)d=l,g=l;else{if(!c)return p;d=l+1,g=l+1}break;case 1:d=a,g=a;break;case 6:d=k+(c&&!n?-1:0),g=m?l-1:l;break;case 12:d=n?k+1:k,g=l+(c&&!m?1:0);break;case 14:default:d=k+(c&&!n?-1:0),g=l+(c&&!m?1:0)}return e=q.columnReferenceStart(),h=q.columnReferenceEnd(),o=r.endColumn(),1===q.rj&&(h=o),e>o||h>o?(q._error=!0,p):g<d||!c&&d<k||!c&&g>l?p:(i=g-d+1,j=h-e+1,f.qf(d,e,i,j))},b.prototype.offsetWhenInsertRemoveColumn=function(a,c,d,e){var g,h,i=this,j=i.vzb;return a<j||a===j&&d&&!e||a>i.pj+j?i:(c=d?c:-c,g=a-j,h=new b,h.baseTable=i.lj,h.pj=i.pj+c,h.oj=i.oj,a<=j+i.oj&&(h.oj+=c,h.oj<g&&(h.oj=g)),h.rj=i.rj,h.qj=i.qj,h.pj<h.oj?f.Ih:h)},b.prototype.offsetWhenCopy=function(a,b,c,d,e,h,i,j,k,l){var m,n,o,p,q,r,s=this,t=new g.SheetParserContext(b.kj,b.Af.useR1C1,f.pf(c,d)),u=t.getTableByIndex(c,d),v=s.offset();return u&&(m=c-e,n=d-h,o=i-e,p=j-h,q=void 0,a===b?q=t.getTableByIndex(m,n):(r=new g.SheetParserContext(a.kj,a.Af.useR1C1,f.pf(m,n)),q=r.getTableByIndex(m,n)),q!==u&&q===s.lj&&Y(q,o,p,k,l)&&Y(u,i,j,k,l)&&(v.baseTable=u)),v},b.prototype.Jma=function(a){var c,d=this,e=new b;return e.baseTable=d.lj,e.pj=d.pj,e.oj=d.oj,2===d.rj&&a&&(c=d.lj.endColumn()-d.lj.startColumn()+1,a%=c,e.oj+=a,e.oj<0&&(e.oj+=c),e.pj=e.oj),e.rj=d.rj,e.qj=d.qj,e},b.prototype.offset=function(a,c,d){var e=this,f=new b;return f.baseTable=e.baseTable,f.qj=e.qj,f.oj=e.oj,f.pj=e.pj,f.rj=e.rj,f},b.prototype.Kma=function(a,b){var c=this.lj;return a>=c.startRow()&&b>=c.startColumn()&&a<=c.endRow()&&b<=c.endColumn()},b.prototype.tzb=function(a,b,c){this.lj.wzb(a,b,c)},b}(f.Expression),b.xzb=x,y=function(a){A(b,a);function b(b){var c=a.call(this,7900)||this;return c.kj=b,c}return b.prototype.resolveToken=function(a,c,d,e){var f,g,h,i=d[e];if(0===i.Nc&&(0===i.hi||7===i.hi))if(f=i.ni,"]"===f.charAt(f.length-1))try{return g=new x,Z(a,f.split(""),g),g}catch(a){}else if(h=a.getTableByName&&a.getTableByName(f))return b.create(h);return p},b.prototype.unparse=function(a,b,c,d){var e,g,h,i,j,k,l,m,n;return 13===c.type&&(e=c,a.YSa?(g=e.getRange(a.row,a.column,!0),h=f.uf(e.source,p,g.row,g.col,g.row+g.rowCount-1,g.col+g.colCount-1,!1,!1,!1,!1),K(a,b,h,d),!0):16===e.qj&&1===e.rj?(d.push(e.lj.tableName()),void(a.Eh&&d.push("[]"))):(j=d.length,k=a.source===e.lj.source()&&e.Kma(a.row,a.column),k&&!a.Eh||d.push(e.lj.tableName()),d.push("["),16!==e.qj&&(l=la(e.qj,1!==e.rj,a.Eh),d.push(l)),1!==e.rj&&(1===e.qj&&!a.Eh||16===e.qj||d.push(", "),m=e.lj.getColumnName(e.oj),m?m=ea(m.split("")).join(""):i=!0,i||(4===e.rj?(n=e.lj.getColumnName(e.pj),n?(n=ea(n.split("")).join(""),d.push("[",m,"]:[",n,"]")):i=!0):1===e.qj&&!a.Eh&&!fa(m)||16===e.qj?d.push(m):d.push("[",m,"]"))),i?(d.length=j,d.push("#REF!")):d.push("]"),!0))},b.create=function(a,b,c,d,e){void 0===b&&(b=v.NotSpecific),void 0===c&&(c=w.NotSpecific),void 0===d&&(d=0),void 0===e&&(e=a.endColumn()-a.startColumn());var f=new x;return f.baseTable=a,f.qj=b,f.oj=d,f.pj=e,f.rj=c,f},b}(f.TokenResolver),b.StructureReferenceResolver=y;function Z(a,b,c){var d,e,f,g,h,j,k,l,m,n=c,o=0,p=b[o],q=ja(a,b,o,p),r=q.sj;for(r||ka(),n.baseTable=r,o=q.tj,o++,p=b[o],d=o;" "===p;)o++,p=b[o];for("@"!==p&&"["!==p&&(o=d,p=b[o]),e=1,f=!1,g=!1,h=b.length;0!==e&&o<h;)if("["===p&&(e++,o++,p=b[o]),"#"===p)f&&e<=1&&ka(),j=ia(b,o,p,e),k=j.vj,o=j.tj,p=j.uj,e=j.wj,f?2===n.qj&&3===k||2===k&&3===n.qj?n.qj=6:3===n.qj&&8===k||3===k&&8===n.qj?n.qj=12:ka():n.qj=k,f=!0;else if("@"===p){for((e>1||f)&&ka(),f=!0,n.qj=1,o++,p=b[o];" "===p;)o++,p=b[o];","===p&&ka()}else{for(l=o;!i.isNullOrUndefined(p)&&"]"!==p&&"["!==p;)if("'"===p&&o++,","===p){for(o++,p=b[o],m=o;" "===p;)o++,p=b[o];if("["===p){o=m,p=",";break}}else o++,p=b[o];if(o>l&&((g||"["===p&&e>1)&&ka(),j=_(n,b,o,p,e,l),o=j.tj,p=j.uj,e=j.wj,g=!0),"]"===p){if(e--,0===e)break;o>=b.length&&ka(),o++,p=b[o]}","===p&&(o++,p=b[o])}f||(n.qj=a.DLb?1:16),g||(n.oj=0,n.pj=n.lj.endColumn()-n.lj.startColumn(),n.rj=1)}function $(a,b,c){return a.slice(b,c).join("")}function _(a,b,c,d,e,f){var g,h,i,j,k,l,m=a,n=[],p="",q=!1,r=!1;if(e>1)q=!0,e--,n=b.slice(f,c),c++,d=b[c],":"===d&&(c++,d=b[c],r="["===d,h=ga(b,c,d,e),p=h.xj,c=h.tj,d=h.uj,e=h.wj);else if("["===d){for(r=!0,g=c-1,d=b[g];" "===d;)g--,d=b[g];":"!==d&&ka(),n=b.slice(f,g),n=aa(n),d=b[c],h=ga(b,c,d,e),p=h.xj,c=h.tj,d=h.uj,e=h.wj}else m.qj!==o&&16!==m.qj||(q=!0),i=b.slice(f,c),g=i.indexOf(":"),g>0?(n=i.slice(0,g),p=i.slice(g+1),"["!==p[0]&&ka()):n=i;if(j=ca(m,n,q),p?(k=ca(m,p,r),m.rj=4):(k=j,m.rj=2),j>k&&(l=j,j=k,k=l),m.oj=j,m.pj=k,c++,c<b.length)for(d=b[c];" "===d;)c++,d=b[c];return{tj:c,uj:d,wj:e}}function aa(a){for(var b=a.length-1;b>=0&&" "===a[b];)b--;for(;b>=0&&" "!==a[b];)b--;return b>=0?a.slice(b+1,a.length-b-1):a}function ba(a){for(var b=0,c=a.length,d=0;b<c&&" "===a[b];)b++;for(d=b,b=c-1;b>d&&" "===a[b];)b++;return b>=d?a.slice(d,b+1):a}function ca(a,b,c){var d,e,f,g;if(b&&da(b,c)){for(d=[],e=0,f=b.length;e<f;e++)"'"===b[e]&&e<f-1&&e++,d.push(b[e]);return b=d,g=a.lj.getColumnIndexInTable(b.join("")),g<0&&ka(),g}return-1}function da(a,b){var c,d,e;if(b)return!0;if(c="",c=a[0],d=c,"#"===c||"@"===c||" "===c||","===c||":"===c||"["===c||"]"===c)return!1;for(e=1;e<a.length;e++){if(c=a[e],","===c||":"===c||"["===c&&"'"!==d||"]"===c&&"'"!==d||"@"===c&&"'"!==d||"#"===c&&"'"!==d)return!1;d=c}return!0}function ea(a){var b,c,d=[];for(c=0;c<a.length;c++)b=a[c],"["!==b&&"]"!==b&&"@"!==b&&"#"!==b&&"'"!==b||d.push("'"),
d.push(b);return d}function fa(a){var b,c="";if(c=a[0],"#"===c||" "===c||"@"===c||" "===c||","===c||":"===c||"["===c||"]"===c)return!0;for(b=1;b<a.length;b++)if(c=a[b]," "===c||","===c||":"===c||"["===c||"]"===c||"@"===c||"#"===c)return!0;return!1}function ga(a,b,c,d){var e,f,g=!1;if("["===c)for(g=!0,d++,b++,c=a[b];" "===c;)b++,c=a[b];for(e=b;"]"!==c&&(","!==c||d>1);)"'"===c&&b++,b++,c=a[b];return b<=e&&ka(),f=a.slice(e,b),d>1&&d--,g||(f=ba(f)),{xj:f,tj:b,uj:c,wj:d}}z={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1};function ha(a){var b,c=f.getMapping()&&f.getMapping().tableFunctionsMapping;if(!i.isNullOrUndefined(c))for(b in c)if(c[b].toLowerCase()===a)return b.toLowerCase();return a}function ia(a,b,c,d){for(var e,f,g,h,i=14,j=b;"]"!==c;)"'"===c&&b++,b++,c=a[b];for(e=$(a,j,b).toLowerCase().trim(),e=ha(e),f=!1,g=0;g<q.length;g++)if(h=q[g],e===h){i=z[e],f=!0;break}if(f||ka(),b++,b>=a.length)d--;else{for(c=a[b];" "===c;)b++,c=a[b];if(","===c){for(d<=1&&ka(),b++,c=a[b];" "===c;)b++,c=a[b];"["===c&&(d++,b++,c=a[b])}d>1&&d--}return{vj:i,tj:b,uj:c,wj:d}}function ja(a,b,c,d){for(var e,f,g=0,h=b.length;"["!==d&&c<h;)c++,d=b[c];return g=c,g>0?(f=$(b,0,g),e=a.getTableByName(f)):e=a.getTableByIndex(a.row,a.column),{sj:e,tj:c,uj:d}}function ka(){throw l().Exp_FormulaInvalid}function la(a,b,c){var d=f.getMapping()&&f.getMapping().tableFunctionsMapping,e=f.sR().B2,g=d?d["#All"]:e.All.name,h=d?d["#This row"]:e.thisRow.name,i=d?d["#Headers"]:e.Headers.name,j=d?d["#Data"]:e.Data.name,k=d?d["#Totals"]:e.Totals.name;switch(a){case 1:return c?"["+h+"]":"@";case 2:return b?"["+i+"]":i;case 3:return b?"["+j+"]":j;case 8:return b?"["+k+"]":k;case 6:return"["+i+"], ["+j+"]";case 12:return"["+j+"], ["+k+"]";case 14:case 16:}return b?"["+g+"]":g}function ma(a,b){var c,d,e,g,h,i,j,k,l,m,n=0;for(a.unshift(new f.FormulaToken("=",1,0,0,0)),g=[],h=0,e=a.length-1;e>0;e--)a[e].mi===a[e-1].mi&&a[e].ni===a[e-1].ni||(g[h]=a[e],h++);for(g[h]=a[e],g.reverse(),i=[],j=0,k=0;k<g.length-1;k++,j++)d=na(g[k]),i[j]=g[k],n=g[k+1].mi-g[k].mi-d,n>0&&(c=new f.FormulaToken(b.slice(g[k].mi+d,g[k+1].mi),7,g[k].mi+d),++j,i[j]=c);for(i[j]=g[k],d=na(i[j]),i.length>0&&b.length>i[j].mi+d&&(c=new f.FormulaToken(b.slice(i[j].mi+d,b.length),7,i[j].mi+d),i[j+1]=c),l=0;l<i.length;l++)m=i[l].ni.trim(),3===i[l].hi?i[l].ni='"'+i[l].ni+'"':"("===m||"{"===m?(i[l].Nc=1,i[l].hi=1):")"!==m&&"}"!==m||(i[l].Nc=1,i[l].hi=2);return i}function na(a){return 1===a.Nc&&"ARRAY"===a.ni?1:0===a.Nc&&3===a.hi?(a.HTa||a.ni).length+2:0===a.Nc&&12===a.hi?a.ni.length+3:a.ni.length}function oa(a,b,c){var d,e;a&&b&&(d=b.getName&&b.getName()||"!",e=a[d],e||(e=a[d]=[],a.sheets||(a.sheets=[]),a.sheets.push(d)),e.push(c))}function pa(a,b,c,d,e,g){var h,i,j,k;if(a){for(;10===a.type;)a=a.value;if(12===a.type&&(i=a,a=i.value),a.type>=2&&a.type<=6);else if(1===a.type)h=a.getRange(e,g),!d.source||a.source&&a.source!==d.source||b.push(h),oa(c,a.source||d.source,h);else if(13===a.type)h=a.getRange(e,g),a.source===d.source&&h&&b.push(h),oa(c,a.source||d.source,h);else if(8===a.type)j=p,a.source?a.source.Cf()&&(j=new f.EvaluateContext(a.source,f.pf(e,g))):j=d,pa(j.getName(a.value),b,c,j,e,g);else if(9===a.type)pa(a.value,b,c,d,e,g),a.value2&&pa(a.value2,b,c,d,e,g);else if(7===a.type)for(k=0;k<a.arguments.length;k++)pa(a.arguments[k],b,c,d,e,g)}}function qa(a,b,c,d,e,g,h){var i,j,k;a.setParserOption(g),i=[],j=b.split("");try{k=c.yj().getParserContext(!h&&c.Cf().useR1C1,f.pf(d,e),p),i=a.parseToTokens(k,j,!1)}catch(a){}return i=ma(i,j),ra(a,i,j,c,d,e,h)}b.qzb=qa;function ra(a,b,c,d,e,h,i){var j,k,l,m,n,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F=o,G=d.yj(),H=d.Cf();for(H?(j=new g.SheetParserContext(d,!i&&H.useR1C1,f.pf(e,h)),F=new f.EvaluateContext(G,f.pf(e,h),(!1))):j=new f.ParserContext(p,(!1),f.pf(0,0)),j.ignoreError=!0,k=[],m=0;m<b.length;m++)try{if(l=b[m],"["===l.ni||"#"===l.Qb[0]||3===l.hi){k.push({text:l.HTa||l.ni,type:l.Nc,subType:l.hi,canDrag:!1,ranges:l.ranges,value:l.ni});continue}if(n=[],m=sa(a,j,b,m,n),q=void 0,n.length>0){for(r=0;r<n.length;r++)if(s=n[r],s instanceof f.FormulaToken)k.push({text:c.slice(s.mi,s.li+1).join(""),type:s.Nc,subType:s.hi,canDrag:q,ranges:[],value:s.ni});else if(s.Lf){if(t=s.Lf,u=t.type,v=t.source,w=c.slice(s.mi,s.li+1).join(""),x=[],y={},q=!0,z=t.getRange&&t.getRange(e,h),8===u)q=!1,F&&(A=F,t.source&&(A=new f.EvaluateContext(t.source,f.pf(e,h),(!1))),B=A.getName(t.value),pa(B,x,y,F,e,h));else if(13===u)q=!1,v===G&&z?x.push(z):x=null,oa(y,v,z);else if(33===u)(v||t.contextSource)===G&&(z||(z=f.getRangeForReference(t,e,h)),x.push(z),v||(v=G)),oa(y,v,z);else if(1===u)if(t.endSource)for(C=v,D=t.endSource,E=C.getSources(D),r=0;r<E.length;r++){if(E[r]===G){x.push(z);break}oa(y,E[r],z)}else oa(y,v||G,z),v&&v!==G||x.push(z);else x=null;x&&x.length>0?k.push({text:w,type:0,subType:7,canDrag:q,ranges:x,value:w,sheetRanges:y}):k.push({text:w,type:l.Nc,subType:l.hi,canDrag:q,ranges:x,value:w,sheetRanges:y})}}else k.push({text:l.ni,type:l.Nc,subType:l.hi,canDrag:!1,ranges:l.ranges,value:l.ni})}catch(a){k.push({text:l.ni,type:l.Nc,subType:l.hi,canDrag:!1,ranges:l.ranges,value:l.ni})}return k}function sa(a,b,c,d,e){var f,g,h,i,j,k,l=c[d];return l&&"function"!=typeof l&&0===l.Nc?(f=[],g=a.resolveToken(b,c,f,d)-1,h=f[0],i=h.type,1===i||13===i||33===i||8===i||5===i&&h.source?(j=c[g],k={mi:l.mi,li:j.li,Lf:h},e.push(k),g):d):d}},"./dist/plugins/sheetsCalc/sheetsCalc.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/sheetsCalc/calc.ns.js")),d(c("./dist/plugins/sheetsCalc/parser-sheets.js")),d(c("./dist/plugins/sheetsCalc/calc-spreadjs.js")),d(c("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js")),d(c("./dist/plugins/sheetsCalc/worksheet-formula.js")),c("./dist/plugins/sheetsCalc/workbook-formula.js")},"./dist/plugins/sheetsCalc/workbook-formula.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Core"),f=c("Common"),g=c("CalcEngine"),h=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),i=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),j=h.SpreadSource,k=f.Common.u.Nb,l=new f.Common.ResourceManager(d.SR),m=l.getResource.bind(l),n=void 0,o=null,p=f.Common.j,q=p.Fa,r=d.Workbook.prototype,r.qv=function(a){var b=this,c=b.Wu;b.Wu=new g.CalcService,b.Wu.useR1C1=1===b.options.referenceStyle,b.Wu.allowDynamicArray=b.options.allowDynamicArray,b.Wu.iterativeCalculation=b.options.iterativeCalculation,b.Wu.iterativeCalculationMaximumIterations=b.options.iterativeCalculationMaximumIterations,b.Wu.iterativeCalculationMaximumChange=b.options.iterativeCalculationMaximumChange,a&&c&&b.Wu.cloneFrom(c),b.yv=new j(b),b.zv=b.Wu.getGlobalSourceModel(b.yv)},r.addCustomFunction=function(a){this.Xu(a)},r.Xu=function(a){if(!(a&&a instanceof g.Functions.Function))throw Error(m().Exp_InvalidCustomFunction);this.Su[k(a.name)]=a},r.getCustomFunction=function(a){return a?this.Su[k(a)]:n},r.removeCustomFunction=function(a){a&&(delete this.Su[k(a)],this.iK())},r.clearCustomFunctions=function(){this.Su={}},r.addCustomName=function(a,b,c,d,e){this.Yu(this.Tu,a,b,c,d,!1,e)},r.H$a=function(a){return!this.Tu[k(a)]},r.isValidCustomName=function(a){return a&&d.Ul.G$a(a)&&this.H$a(a)},r.Yu=function(a,b,c,d,e,f,g){var h,j,l,n,p=this;if(!b||!c||!f&&!p.isValidCustomName(b))throw Error(m().Exp_InvalidCustomName);if(p.Wu){if(h=this.getActiveSheet(),j=h?h.yj():o,l=void 0,f)try{l=p.Wu.parse(j,c,d,e,!1,!1,!0)}catch(a){}else l=p.Wu.parse(j,c,d,e);a[k(b)]=new i.NameInfo(b,l,d,e,g),f||(n={},n[b]=b,this.Zu(n,!0))}},r.getCustomName=function(a){return a?this.Tu[k(a)]:n},r.aJb=function(a){return a?this.QHb[k(a)]:n},r.getCustomNames=function(){var a=[];return d.GC$.each(this.Tu,function(b,c){a.push(c)}),a},r.ELb=function(){var a=[];return d.GC$.each(this.QHb,function(b,c){a.push(c)}),a},r.removeCustomName=function(a){if(a){delete this.Tu[k(a)];var b={};b[a]=a,this.Zu(b,!1)}},r.RHb=function(a){if(a){delete this.QHb[k(a)];var b={};b[a]=a,this.Zu(b,!1)}},r.clearCustomNames=function(){var a=this.Tu;this.Tu={},this.Zu(a,!1)},r.FLb=function(){var a=this.QHb;this.QHb={},this.Zu(a,!1)},r.Zu=function(a,b){var c,d;if(a){c=this.zv;for(d in a)c&&c.updateNameCalc(d,b);this.iK()}},r.iK=function(){if(this.Wu&&!this.Wu.IsSuspended()){var a=this.getActiveSheet();a&&(a.suspendPaint(),this.Wu.recalculateAll(),a.resumePaint())}},r.getCalcService=function(){return this.Wu},r.Cf=function(){return this.Wu},r.suspendCalcService=function(a){this.Wu&&this.Wu.suspend(a)},r.resumeCalcService=function(a){this.Wu&&this.Wu.resume(a)},r.getCircularReference=function(){var a,b,c,d=this.chc();d=this.dhc(d),a=[];for(b in d)Object.prototype.hasOwnProperty.call(d,b)&&(c=b.split("\\"),a.push({row:+c[1],col:+c[2],rowCount:1,colCount:1,sheetName:c[0]}));return a},r.chc=function(){var a={};return this.sheets.forEach(function(b){var c,d,e,f,g,h,i,j=b.Bj(),k=b.getRowCount(),l=b.getColumnCount(),m=b.name();if(j)for(c=0;c<k;c++)for(d=0;d<l;d++)for(e=m+"\\"+c+"\\"+d,f=b.getDependents(c,d),!a[e]&&f.length>0&&(a[e]={from:[],to:[]}),g=0;g<f.length;g++)h=f[g],i=h.sheetName+"\\"+h.row+"\\"+h.col,a[i]||(a[i]={from:[],to:[]}),a[i].from.push(e),a[e].to.push(i)}),a},r.dhc=function(a){var b,c,d;function e(a,b){a.splice(a.indexOf(b),1)}for(b=!0;Object.keys(a).length>0&&b;){b=!1,c=function(c){if(Object.prototype.hasOwnProperty.call(a,c)){var d=a[c];0===d.from.length?(d.to.forEach(function(b){e(a[b].from,c)}),delete a[c],b=!0):0===d.to.length&&(d.from.forEach(function(b){e(a[b].to,c)}),delete a[c],b=!0)}};for(d in a)c(d)}return a},d.Workbook.$n("calc",{priority:1e3,init:function(){this.Su={},this.Tu={},this.QHb={}},toJson:function(a){var b,c,e,f,g,h,i,j=this,k=j.Su;d.GC$.isEmptyObject(k)||(a.customFunctions=k),b=[],c=[],e=j.getCustomNames(),f=j.ELb(),g=j.Wu,h=this.getActiveSheet(),i=h?h.yj():o,e&&g&&(d.GC$.each(e,function(a,c){var d,e,f=c.getName(),h=c.getRow(),j=c.getColumn(),k=c.getExpression(),l=c.getComment();k&&(d=g.unparse(i,k,h,j,!1,!0),e={name:f,formula:d,row:h,col:j},l&&(e.comment=l),b.push(e))}),d.GC$.each(f,function(a,b){var d,e,f=b.getName(),h=b.getRow(),j=b.getColumn(),k=b.getExpression(),l=b.getComment();k&&(d=g.unparse(i,k,h,j,!1,!0),e={name:f,formula:d,row:h,col:j},l&&(e.comment=l),c.push(e))}),b.length>0&&(a.names=b),c.length>0&&(a.formatStringNames=c))},fromJson:function(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=this,z=y.Wu;if(z&&z.suspend(),y.clearCustomNames(),d=a.names)for(f=0;f<d.length;f++)g=d[f],y.Yu(this.Tu,g.name,g.formula,g.row,g.col,!0,g.comment);if(y.FLb(),h=a.formatStringNames)for(f=0;f<h.length;f++)g=h[f],y.Yu(this.QHb,g.name,g.formula,g.row,g.col,!0,g.comment);if(y.clearCustomFunctions(),i=a.customFunctions)for(j in i)i.hasOwnProperty(j)&&(k=i[j],l=e.getTypeFromString(k.typeName),l&&(m=new l,m.fromJSON(k,b),y.Xu(m)));if(p=a.sheets,q=[],p){n=0;for(s in p)"string"==typeof s&&(t=p[s],o=y.getSheetFromName(t.name||s),q.push(o),o.nameFunctionsFromJSON(t,b,c),n++);for(r=q.length,n=0;n<r;n++)o=q[n],o.yj().q$a=!0,o.formulaFromJSON(p[o.name()],b,c)}for(u=a.noRecalc||c&&c.doNotRecalculateAfterLoad,z&&(u?z.resumeWithoutCalc():z.resume(!0)),v=0,w=q;v<w.length;v++)o=w[v],x=o.yj(),x.HIb(),delete x.q$a},egc:function(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this,u=t.Wu;if(u&&u.suspend(),t.clearCustomNames(),d=a.names)for(f=0;f<d.length;f++)g=d[f],t.Yu(this.Tu,g.name,g.formula,g.row,g.col,!0,g.comment);if(t.clearCustomFunctions(),h=a.customFunctions)for(i in h)h.hasOwnProperty(i)&&(j=h[i],k=e.getTypeFromString(j.typeName),k&&(l=new k,l.fromJSON(j,b),t.Xu(l)));if(o=a.sheets,p=[],o){m=0;for(r in o)"string"==typeof r&&(s=o[r],n=t.getSheetFromName(s.name||r),p.push(n),n.nameFunctionsFromJSON(s,b,c),m++);for(q=p.length,m=0;m<q;m++)n=p[m],n.yj().q$a=!0,n.formulaFromJSON(o[n.name()],b,c)}c.incrementLoadTask.addTask(function(b,d,e){var f,g,h;for(u&&(a.noRecalc||c&&c.doNotRecalculateAfterLoad?u.resumeWithoutCalc():u.resume(!0)),f=0,g=p;f<g.length;f++)n=g[f],h=n.yj(),h.HIb(),delete h.q$a},[u,a,c])}})},"./dist/plugins/sheetsCalc/worksheet-formula.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Core"),f=c("Common"),g=c("CalcEngine"),h=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),i=c("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),j=null,k=void 0,l=d.GC$.each,m=f.Common.u.Nb,n=new f.Common.ResourceManager(d.SR),o=n.getResource.bind(n),p=f.Common.j.Fa,q=parseInt;function s(a){return a.columnRelative}function t(a){return a.endColumnRelative}function u(a){return a.rowRelative}function v(a){return a.endRowRelative}function w(a){return a.Cf()}function x(a){return a.column}function y(){var a=this;return a.Ru?void(a.Ru=!1):(a.Su={},a.Tu={},a.eDc?a.eDc.clearAll():a.fDc=new h.SheetSource(a,d.SheetArea.colHeader),a.gDc?a.gDc.clearAll():a.hDc=new h.SheetSource(a,d.SheetArea.rowHeader),void(a.et?a.et.clearAll():a.ft=new h.SheetSource(a,d.SheetArea.viewport)))}function z(a,b,c,d,e,f){var g=a.Ms(b,c,d,e,f),h=g&&g.formulas;return h&&h.length>0}function A(a,b,c,d,e,f,g){var h=z(a,b,c,d,e,3);return!h&&f&&(e=a.getColumnCount(2),h=z(a,b,0,d,e,2)),!h&&g&&(d=a.getRowCount(1),h=z(a,0,c,d,e,1)),h}function B(a){var b,c,d,e=[],f=[];for(b=0;b<a.length;b++)c=a[b],d=""+c.row+c.col+c.rowCount+c.colCount+c.sheetName,e.indexOf(d)<0&&(e.push(d),f.push(c));return f}function C(a,b){var c=a.formulaLoad/a.total;return b?.4*c+.5:.3*c+.4}function D(a,b,c,d,e,f){var g,h=d.yj(),i=a&&a.formula;i&&(i=i.replace(/ANCHORARRAY\(([A-Z]+[0-9]+)\)/gi,"$1#").replace(/SINGLE\((.*)\)/gi,"@$1").replace(/ANCHORARRAY\((#[A-Z]+[\?!])\)/gi,"$1#"),g=a.arrayInfo,g&&!g.isDynamicArray?d.bv(b,c,q(g.rowCount,10),q(g.colCount,10),i,!0,f):(g&&g.isInvalid&&h.GIb(b,c),d._u(b,c,i,j,!0,f,!0,!g)))}function E(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q=e&&e.incrementLoadTask;if(q&&!q.isTerminated){for(h=q.isBusyFunc,f=f||0,i=f,a.suspendPaint(),j=30,k=new Date;i<c;){if(l=b[i])for(m=0;m<d;m++)D(l[m],i,m,a,!0,g);if(i++,h&&h())break;if(n=new Date,n-k>j)break}a.resumePaint(),e||(e={}),o=e&&e.incrementalLoading,o&&o.loading&&(o.loadStatus.formulaLoad+=i-f,p=C(o.loadStatus,e.doNotRecalculateAfterLoad),o.loading(p)),i<c&&e.incrementLoadTask.pushTask(E,[a,b,c,d,e,i])}}function F(a,b,c,d,e){var f,g,h;for(f=0;f<c;f++)if(g=b[f])for(h=0;h<d;h++)D(g[h],f,h,a,!0,e)}function G(a,b,c,e){var f=d.Worksheet._n;f&&l(f,function(d,f){var g=f.fromJsonAfterFormula;g&&g.call(a,b,c,e)})}r=d.Worksheet.prototype,r.resetCalc=function(){y.call(this),this.Ru=!0},r.recalcAll=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=w(this);if(q){if(this.suspendPaint(),q.suspend(!0),a)for(b=this.parent,c=void 0,c=b&&b.sheets||[this],d=0;d<c.length;d++){if(e=c[d],f=e.Tu,g=e.yj(),f)for(h in f)i=f[h],j=i.Lf,k=q.unparse(g,j,0,0),i.Lf=q.parse(g,k,0,0);for(l=g.getCalcSourceModel(),m=l.getAllNodes(),n=0;n<m.length;n++)o=m[n],p=o.calc,p&&o.Lf&&J(q,p)}q.resume(!0),this.resumePaint()}},r.recalcRange=function(a,b,c,d){var e=w(this);e&&e.recalcRange(this.yj(),a,b,c,d)},r.recalcRows=function(a){var b,c=w(this);if(c&&!c.ignoreDirty()){for(c.suspend(),b=0;b<a.length;b++)c.recalculate(this.ft,a[b],-1);c.resume(!1)}},r.recalcCols=function(a){var b,c=w(this);if(c&&!c.ignoreDirty()){for(c.suspend(),b=0;b<a.length;b++)c.recalculate(this.ft,-1,a[b]);c.resume(!1)}},r.zq=function(a,b,c){var d,e=w(this);e&&!e.ignoreDirty()&&(d=this.ft,1===c?d=this.fDc:2===c&&(d=this.hDc),e.recalculate(d,a,b))},r.getCalcService=function(){return this.Wu||(this.Wu=new g.CalcService,this.yj(d.SheetArea.colHeader).setCalcService(this.Wu),this.yj(d.SheetArea.rowHeader).setCalcService(this.Wu),this.yj().setCalcService(this.Wu),this.Wu.initParserContext(this.yj())),this.Wu},r.Cf=function(){return this.getCalcService()},r.suspendCalcService=function(a){var b=w(this);b&&b.suspend(a)},r.resumeCalcService=function(a){var b=w(this);b&&b.resume(a)},r.yj=function(a){return p(a)||3===a?this.ft:1===a?this.fDc:2===a?this.hDc:j},r.Bj=function(a){var b=this;return 1===a?(!b.eDc&&b.fDc&&(b.eDc=b.Cf().getSourceModel(b.fDc)),b.eDc):2===a?(!b.gDc&&b.hDc&&(b.gDc=b.Cf().getSourceModel(b.hDc)),b.gDc):(!b.et&&b.ft&&(b.et=b.Cf().getSourceModel(b.ft)),b.et)},r.iDc=function(a,b,c,d,e){var f=this.Bj(e);return f&&f.tg(a,b,c,d,!0,!0)},r.Ns=function(a,b,c,d,e,f){var g=this.iDc(a,b,c,d,3);return!g&&e&&(d=this.getColumnCount(2),g=this.iDc(a,0,c,d,2)),!g&&f&&(c=this.getRowCount(1),g=this.iDc(0,b,c,d,1)),g},r.Ms=function(a,b,c,d,e){var f=this.Bj(e);return f&&f.tg(a,b,c,d,!1,!0)},r.Vq=function(a,b,c,d,e,f,g){var h,i;return void 0===e&&(e=!0),h=e&&this.Ns(a,b,c,d,f,g),i=!e&&A(this,a,b,c,d,f,g),!h&&!i||(this.Os(4,o().Exp_ChangePartOfArray),!1)},r.addCustomFunction=function(a){this.Xu(a),this.recalcAll()},r.Xu=function(a){if(!(a&&a instanceof g.Functions.Function))throw Error(o().Exp_InvalidCustomFunction);this.Su[m(a.name)]=a},r.getCustomFunction=function(a){return a?this.Su[m(a)]:j},r.removeCustomFunction=function(a){a&&(delete this.Su[m(a)],this.recalcAll())},r.clearCustomFunctions=function(){this.Su={},this.recalcAll()},r.Pu=function(a){var b,c,d;return a?(b=this,c=b.parent,d=b.getCustomFunction(a),!d&&c&&c.getCustomFunction&&(d=c.getCustomFunction(a)),d):j},r.addCustomName=function(a,b,c,d,e){this.Yu(a,b,c,d,!1,e)},r.getCustomName=function(a){return a?this.Tu[m(a)]:k},r.getCustomNames=function(){var a=[];return l(this.Tu,function(b,c){a.push(c)}),a},r.removeCustomName=function(a){var b,c;a&&(b=m(a),delete this.Tu[b],c={},c[b]=b,this.Zu(c,!1))},r.clearCustomNames=function(){var a=this,b=a.Tu;a.Tu={},this.Zu(b,!1)},r.createNameInfo=function(a,b,c,d,e){var f,g=this,i=w(g),k=g.yj();return i&&k?(f=i.parse(k,b,d,e),new h.NameInfo(a,f,d,e,c)):j},r.H$a=function(a){var b,c=this,d=!c.Tu[m(a)];return d&&(b=c.tables,b&&(d=!b.findByName(a))),d},r.isValidCustomName=function(a){return a&&d.Ul.G$a(a)&&this.H$a(a)},r.Yu=function(a,b,c,d,e,f){var g,i,j,k,l=this;if(!a||!b||!e&&!l.isValidCustomName(a))throw Error(o().Exp_InvalidCustomName);if(g=w(l),i=l.yj(),g&&i){if(j=void 0,e)try{j=g.parse(i,b,c,d,!1,!1,!0)}catch(a){}else j=g.parse(i,b,c,d);l.Tu[m(a)]=new h.NameInfo(a,j,c,d,f),e||(k={},k[a]=a,this.Zu(k,!0))}},r.Zu=function(a,b){var c,d=this.Bj();if(d){for(c in a)d.updateNameCalc(c,b);this.recalcAll()}},r.$u=function(a){var b,c,d;return a?(b=this,c=b.parent,d=b.getCustomName(a),!d&&c&&c.getCustomName&&(d=c.getCustomName(a)),d):j},r.setFormula=function(a,b,c,d){this._u(a,b,c,j,!1,d)},r._u=function(a,b,c,d,e,f,g,h,i){var l,m,n,q,r,s,t,u,v,w=this;return p(f)&&(f=3),a<0||a>=w.getRowCount(f)||b<0||b>=w.getColumnCount(f)?void w.Os(0,o().Exp_IndexOutOfRange):(l=a>=0?a:0,m=b>=0?b:0,n=w.yj(f),d=d||(c&&w.Wu?w.Wu.parse(n,c,l,m,!1,e,e):j),h&&(d.ensureSingle=!0),q=w.tables,void(3===f&&a>=0&&b>=0&&q&&!(r=q.Hma(a,b,1,1,c,d))||(s=w.Bj(f),t=w.conditionalFormats,s&&(u=s.getFormula(a,b),v=w.ITa,s.setFormula(a,b,c,d,e,k,v.dUa(),i),t&&t.Nm(),g||w.Bq("formula",a,b,f,u,c)),w.t4&&w.t4(a,b,1,1,f),w.$p())))},r.setArrayFormula=function(a,b,c,d,e,f){this.bv(a,b,c,d,e,!1,f)},r.bv=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,p,q;if(void 0===g&&(g=3),i=this,a<0||a+c>i.getRowCount()||b<0||b+d>i.getColumnCount())return void i.Os(0,o().Exp_IndexOutOfRange);if(i.ITa.MTa(a,b,c,d))return void i.Os(0,o().Exp_ArrayFormulaSpan);if(j=i.tables,!(3===g&&a>=0&&b>=0&&j)||(k=j.Hma(a,b,c,d,e))){if(l=i.Bj(g),m=i.conditionalFormats,l&&(i.suspendEvent(),l.setArrayFormula(a,b,c,d,e,f,i.ITa.dUa(),h),i.resumeEvent(),m&&m.Nm(),i.jm<1)){for(n=[],p=a;p<a+c;p++)for(q=b;q<b+d;q++)n.push({row:p,col:q});i.Bu(a,b,c,d,n,5,g,e)}i.$p()}},r.getFormula=function(a,b,c,d){var e=this.Bj(c);return e?e.getFormula(a,b,d):j},r.Ima=function(a,b,c){var d=this.Bj(c);return d?d.Kf(a,b):j},r.getFormulaInformation=function(a,b){var c,e,f,g,h,i={},j=this.Bj();return j&&(c=j.Kf(a,b),c?(e=j.Qf(a,b),i.hasFormula=!0,e&&!e.isDynamicArray&&(i.baseRange=new d.Range(e.row,e.col,e.rowCount,e.colCount)),i.isArrayFormula=e&&!e.isDynamicArray,a=e?e.row:a,b=e?e.col:b,i.formula=this.Wu.unparse(this.ft,c,a,b),i.formulaWithCulture=this.Wu.unparse(this.ft,c,a,b,!0),i.hasFormula=!!i.formula):(f=this.ITa.getDynamicArrayInfo(a,b),f&&f.isValid&&(g=f.row,h=f.col,a===g&&b===h||(c=j.Kf(g,h),i.formulaWithCulture=this.Wu.unparse(this.ft,c,g,h,!0),i.hasFormula=!0,i.isDynamicArray=!0)))),i},r.ngc=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r;for(c||(c=this,d=a,e=b,f=[]),g=c.getDependents(d,e),h=this.name(),i=0;i<g.length;i++){if(j=g[i],k=j.sheetName+"_"+j.row+"_"+j.col+"_"+j.rowCount+"_"+j.colCount,f[k])return!1;if(f[k]=!0,(j.row<=a&&a<j.row+j.rowCount||j.rowCount===-1)&&(j.col<=b&&b<j.col+j.colCount||j.colCount===-1)&&h===j.sheetName)return!0;for(l=j.sheetName===h?c:c.parent.getSheetFromName(j.sheetName),m=j.rowCount,n=j.row,o=j.colCount,p=j.col,m===-1&&(m=l.getRowCount(),n=0),o===-1&&(o=l.getColumnCount(),p=0),q=n;q<m+n;q++)for(r=p;r<o+p;r++)if(this.ngc(a,b,l,n,p,f))return!0}return!1},r.getPrecedents=function(a,b){var c,d,e,f,g,h=[],i=this.Bj();return i&&(c=i.Mf(a,b)||i.Kf(a,b),d=this.getFormulaInformation(a,b),e=d.baseRange,f=e?e.row:a,g=e?e.col:b,this.VGb(c,f,g,h),h=B(h)),h},r.getDependents=function(a,b){var c,d,e,f,g,h,i,j=[],k=this.Bj().qg(a,b),l=this.Bj().ug();if(k){c=k[0];for(d in c)c.hasOwnProperty(d)&&(e=c[d],f=e.ah.xf,g=f?f.kj.name():this.name(),j.push({row:e.row,col:e.column,rowCount:1,colCount:1,sheetName:g}))}if(l){h=l[0];for(d in h)h.hasOwnProperty(d)&&(i=h[d],(i.row===-1||i.row<=a&&a+1<=i.row+i.rowCount)&&(i.col===-1||i.col<=b&&b+1<=i.col+i.colCount)&&(e=i[0],f=e.ah.xf,g=f?f.kj.name():this.name(),j.push({row:e.row,col:e.column,rowCount:1,colCount:1,sheetName:g})))}return j},r.VGb=function(a,b,c,d){var e,f,h,i,j,k;if(a)switch(e=a.type){case g.ExpressionType.reference:case g.ExpressionType.structReference:case g.ExpressionType.spillReference:f=a.getRange(b,c),d.push({row:f.row,col:f.col,rowCount:f.rowCount,colCount:f.colCount,sheetName:a.source&&a.source.kj?a.source.kj.name():this.name()});break;case g.ExpressionType.operator:this.VGb(a.value,b,c,d),this.VGb(a.value2,b,c,d);break;case g.ExpressionType.expand:case g.ExpressionType.parentheses:this.VGb(a.value,b,c,d);break;case g.ExpressionType.name:h=this.$u(a.value),this.VGb(h.getExpression(),b,c,d);break;case g.ExpressionType.function:for(i=a.arguments,j=0;j<i.length;j++)k=i[j],this.VGb(k,b,c,d)}},r.hasFormula=function(a,b){var c=this.Bj();return!!c&&c.hasFormula(a,b)},r.dv=function(){var a,b,c,d,e,f=this.Bj();if(f)for(a=0,b=f.rC(),c=f.cC();a<b;){for(d=0;d<c;)e=f.qg(a,d),e&&(e.ng(),e.og()),d++;a++}},r.clearFormula=function(a,b,c,d,e){var f,g,h=this;for(a<0&&(a=0,c=h.getRowCount()),b<0&&(b=0,d=h.getColumnCount()),f=0;f<c;f++)if(e(h,f+a))for(g=0;g<d;g++)h.setFormula(f+a,g+b,j)},r.nameFunctionsFromJSON=function(a,b,c,d){var f,g,h,i,j,k,l,m,n;if(a){if(f=this,g=a.customFunctions)for(h in g)g.hasOwnProperty(h)&&(i=g[h],j=e.getTypeFromString(i.typeName),j&&(k=new j,k.fromJSON(i,b),f.Xu(k)));if(l=a.names,l&&l.length>0){for(m=0;m<l.length;m++)n=l[m],f.Yu(n.name,n.formula,n.row,n.col,!0,n.comment);f.dv()}d&&d()}},r.formulaFromJSON=function(a,b,c){var d,e,f;a&&(d=this,e=c&&c.ignoreFormula,f=c&&c.incrementalLoading,[a.colHeaderData,a.rowHeaderData,a.data].forEach(function(a,b){var g,h,i,j;a&&!e&&a.dataTable&&(g=b+1,h=a.dataTable,i=d.getRowCount(g),j=d.getColumnCount(g),f?E(d,h,i,j,c,0,g):F(d,h,i,j,g))}),f?c.incrementLoadTask.pushTask(G,[d,a,b,c]):G(d,a,b,c))},r.ev=function(a){var b=this,c=b.Wu;c&&!a||(b.Wu=a?a:new g.CalcService,b.yj(d.SheetArea.colHeader).setCalcService(b.Wu),b.yj(d.SheetArea.rowHeader).setCalcService(b.Wu),b.yj(d.SheetArea.viewport).setCalcService(b.Wu),b.Wu.initParserContext(b.yj()),c?(a.setSourceModel(b.fDc,c.getSourceModel(b.fDc)),a.setSourceModel(b.hDc,c.getSourceModel(b.hDc)),a.setSourceModel(b.ft,c.getSourceModel(b.ft))):(b.eDc=b.Wu.getSourceModel(b.fDc),b.gDc=b.Wu.getSourceModel(b.hDc),b.et=b.Wu.getSourceModel(b.ft)))},r.setCalc=function(a,b){this.Wu=a,this.ft=b||this.ft,this.et=a.getSourceModel(this.ft),this.parent&&(this.parent.Wu=a)},r.fv=function(){this.gv(!1,1)},r.mUa=function(a,b){var c,e,f,g,h,i,j,k,l=this,m=a.changeType,n=a.row,o=a.rowCount,p=a.col,q=a.colCount,r=l.Bj();r&&(c=l.ITa,e=c.dUa(),f=w(r),g=r.xf,h=f.ih(),i=f.lh.asyncManager,"addingRows"===m?l.Vq(n,0,0,l.getColumnCount(),void 0,!0,!1)?(j=l.Bj(2),h.onBeforeAddRemoveRows(r,n,j),b||d.clearSpillValuesOnAddRemove(c,n,o,!0,!0),H(l,n,o,!0,!0),[r,j].forEach(function(a){a.addRows(n,o)}),i.addRows(g,n,o)):a.canAdd=!1:"addRows"===m?(f.suspend(),j=l.Bj(2),h.onAfterAddRemoveRows(r,n,o,!0,b,j),f.resume(!1),e&&e.push({type:"addRows",row:n,rowCount:o})):"deletingRows"===m?l.Vq(n,0,o,l.getColumnCount(),void 0,!0,!1)?(j=l.Bj(2),h.onBeforeAddRemoveRows(r,n,j),b||d.clearSpillValuesOnAddRemove(c,n,o,!1,!0),H(l,n,o,!1,!0),[r,j].forEach(function(a){a.deleteRows(n,o)}),i.deleteRows(g,n,o)):a.canDelete=!1:"deleteRows"===m?(f.suspend(),j=l.Bj(2),h.onAfterAddRemoveRows(r,n,o,!1,b,j),f.resume(!1),e&&e.push({type:"deleteRows",row:n,rowCount:o})):"addingColumns"===m?l.Vq(0,p,l.getRowCount(),0,void 0,!1,!0)?(k=l.Bj(1),h.onBeforeAddRemoveColumns(r,p,k),b||d.clearSpillValuesOnAddRemove(c,p,q,!0,!1),H(l,p,q,!0,!1),[r,k].forEach(function(a){a.addColumns(p,q)}),i.addColumns(g,n,o)):a.canAdd=!1:"addColumns"===m?(f.suspend(),k=l.Bj(1),h.onAfterAddRemoveColumns(r,p,q,!0,b,k),f.resume(!1),e&&e.push({type:"addColumns",col:p,colCount:q})):"deletingColumns"===m?l.Vq(0,p,l.getRowCount(),q,void 0,!1,!0)?(k=l.Bj(1),h.onBeforeAddRemoveColumns(r,p,k),b||d.clearSpillValuesOnAddRemove(c,p,q,!1,!1),H(l,p,q,!1,!1),[r,k].forEach(function(a){a.deleteColumns(p,q)}),i.deleteColumns(g,n,o)):a.canDelete=!1:"deleteColumns"===m&&(f.suspend(),k=l.Bj(1),h.onAfterAddRemoveColumns(r,p,q,!1,b,k),f.resume(!1),e&&e.push({type:"deleteColumns",col:p,colCount:q})))},r.nUa=function(a,b,c){var d=c.type,e=this;"addRows"===d?(c.changeType="deletingRows",e.mUa(c,!0),c.changeType="deleteRows",e.mUa(c,!0)):"deleteRows"===d?(c.changeType="addingRows",e.mUa(c,!0),c.changeType="addRows",e.mUa(c,!0)):"addColumns"===d?(c.changeType="deletingColumns",e.mUa(c,!0),c.changeType="deleteColumns",e.mUa(c,!0)):"deleteColumns"===d?(c.changeType="addingColumns",e.mUa(c,!0),c.changeType="addColumns",e.mUa(c,!0)):"customName"===d?c.nameInfo.fg(c.expr):"condition"===d&&c.condition.setExpressions(c.expressions)},r.gUa=function(a){var b,c=w(this),d=this.Bj();for(c.suspend();a.length;)b=a.pop(),b.type?this.nUa(c,d,b):d.$Va.apply(d,b);c.resume(!1)},r.getReferenceRange=function(a){var b,c,e,f=this.yj(),h=this.getCalcService(),i=h.evaluate(f,a,0,0,!0);if(i instanceof g.CalcReference&&(b=i.getSource().getName(),i.getRangeCount()>0))return c=0,e=d.kf(i.getRow(c),i.getColumn(c),i.getRowCount(c),i.getColumnCount(c)),{sheetName:b,range:e}};function H(a,b,c,d,e){var f,g,h,i,j,k,m,n;if(!a.parent||!a.parent.sheets)return f=a.getCustomNames(),void(f&&l(f,function(f,i){g=i.getExpression(),h=I(a,a,b,c,d,e,g),h!==g&&i.fg(h)}));for(i=a.parent.sheets,j=a.parent.getCustomNames(),k=a.parent.ELb(),j&&l(j,function(f,i){g=i.getExpression(),h=I(null,a,b,c,d,e,g),h!==g&&i.fg(h)}),k&&l(k,function(f,i){g=i.getExpression(),h=I(null,a,b,c,d,e,g),h!==g&&i.fg(h)}),m=function(j){f=i[j].getCustomNames(),f&&l(f,function(f,k){g=k.getExpression(),h=I(i[j],a,b,c,d,e,g),h!==g&&k.fg(h)})},n=0;n<i.length;n++)m(n)}b.kDc=H;function I(a,b,c,d,e,f,h){var i,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,J,K,L,M,N=b.yj(),O=g.Hh(g.Errors.Reference,N);if(9===h.type){if(k=h.value,l=h.value2,m=I(a,b,c,d,e,f,k),n=l&&I(a,b,c,d,e,f,l),k!==m||l!==n)return g.Kh(h.operatorType,m,n)}else if(7===h.type){for(o=!1,p=[],q=void 0,r=0;r<h.arguments.length;r++)q=h.arguments[r],s=I(a,b,c,d,e,f,q),o=o||q!==s,p.push(s);if(o)return g.Jh(h,p)}else if(1===h.type&&h.sf()){if(i=h.source||a&&a.yj(),t=h.row,u=h.column,v=t,w=u,i&&i===N&&(f&&!h.rowRelative||!f&&!h.columnRelative)){if(f&&e)t+=t>=c?d:0;else if(!f&&e)u+=u>=c?d:0;else if(f){if(t>=c+d)t-=d;else if(t>=c)return O}else if(u>=c+d)u-=d;else if(u>=c)return O;if(t!==v||u!==w)return g.rf(N,j,t,u,h.rowRelative,h.columnRelative)}}else if(1===h.type){if(i=h.source||a&&a.yj(),x=h.row,y=h.column,z=h.endRow,A=h.endColumn,B=h.rowRelative,C=h.columnRelative,D=h.endRowRelative,E=h.endColumnRelative,F=x,G=y,H=z,J=A,i&&i===N){if(f&&e)x+=!B&&x>=c?d:0,z+=!D&&z>=c?d:0;else if(!f&&e)y+=!C&&y>=c?d:0,A+=!E&&A>=c?d:0;else if(f&&!e){if(!B&&x>=c&&!D&&z<c+d)return O;if(B&&D||z<c)return h;if(!B)if(x>=c+d)x-=d;else if(x<c);else{if(D)return O;x>c&&(x=c)}if(!D)if(z>=c+d)z-=d;else{if(B)return O;z<c+d&&(z=c-1)}}else{if(!C&&y>=c&&!E&&A<c+d)return O;if(C&&E||A<c)return h;if(!C)if(y>=c+d)y-=d;else if(y<c);else{if(E)return O;y>c&&(y=c)}if(!E)if(A>=c+d)A-=d;else{if(C)return O;A<c+d&&(A=c-1)}}if(y!==G||A!==J||x!==F||z!==H)return g.uf(N,j,x,y,z,A,B,C,D,E)}}else if(10===h.type){if(K=h.value,L=I(a,b,c,d,e,f,K),K!==L)return g.Lh(L)}else 13===h.type&&(i=h.source||a&&a.yj(),i&&i===N&&!f&&(M=h,h=M.offsetWhenInsertRemoveColumn(c,d,e)));return h}function J(a,b){var c,d,e,f,g,h,i,j=b.ah,k=j.getSource(),l=-1,m=-1;b.name?(d=b.name,f=b.id,p(f)?c=j.getNodeByName(d):(c={Lf:b.expression},e=!0)):(l=b.row,m=b.column,l=void 0===l?-1:l,m=void 0===m?-1:m,c=j.getNode(l,m)),g=c.Lf,h=c.Pf,i=a.unparse(k,g,l<0?0:l,m<0?0:m),h&&(a.allowDynamicArray!==!0||a.allowDynamicArray===!0&&!h.isDynamicArray)?l===h.row&&m===h.col&&j.setArrayFormula(h.row,h.col,h.rowCount,h.colCount,i):d?e?j.setFormula(f,d,i):j.setFormulaByName(d,i):j.setFormula(l,m,i,null,!0,!0),c.Lf.ehc=g.ehc}function K(a){var b,c,e,f,h,i,j,k,l,m,n,o=w(a),p=o.getSourceModel(a.yj(d.SheetArea.colHeader)),q=o.getSourceModel(a.yj(d.SheetArea.rowHeader)),r=o.getSourceModel(a.yj()),s=[p,q,r];for(b=0;b<s.length;b++){if(c=s[b],!c)return;for(e=c.getAllNodes(),f=0;f<e.length;f++)if(h=e[f],i=h.calc)for(j=i.Ze,k=void 0,l=0;l<j.length;l++)if(m=i[j[l]])for(n in m)k=m[n],k&&k instanceof g.PathCalc&&J(o,k)}}function L(a,b,c,d,e,f,g,h,j){i.CalcOperatorAdjustor.copyFormula(a.Bj(),b,c,d.Bj(),e,f,g,h,j)}b.vyb=L;function M(a,b){var c=a.offset(0,0,!1,0,0);return c.rowRelative=c.endRowRelative=c.columnRelative=c.endColumnRelative=b,c}function N(a,b,c,d,e,f,h,j,k,l){var m,n,o,p,q,r,w,x,y,z,A,B,C,D,E,F,G,H;if(9===l.type){if(m=l.value,n=l.value2,o=N(a,b,c,d,e,f,h,j,k,m),p=n&&N(a,b,c,d,e,f,h,j,k,n),m!==o||n!==p)return g.Kh(l.operatorType,o,p)}else if(7===l.type){for(q=!1,r=[],w=void 0,x=0;x<l.arguments.length;x++)w=l.arguments[x],y=N(a,b,c,d,e,f,h,j,k,w),q=q||w!==y,r.push(y);if(q)return g.Jh(l,r)}else if(1===l.type){if(z=!u(l)&&!s(l),A=!v(l)&&!t(l),B=b.yj(),(!l.source||l.source===B)&&z&&A)return C=e.yj(),D=new i.MoveSwapInfo(B,c,d,C,f,h,j,k),E=M(l,!0),F=i.adjustFormulaOnMoveSwap(B,0,0,E,D,!0),F===E?l:1===F.type&&M(F,!1)||F}else if(10===l.type&&(G=l.value,H=N(a,b,c,d,e,f,h,j,k,G),G!==H))return g.Lh(H);return l}b.uyb=N,d.Worksheet.$n("calc",{priority:1e3,init:y,dispose:function(a){var b,c,d,e=this;a.clearCache!==!1&&(e.ft=j,e.hDc=j,e.fDc=j,e.Wu=j,b=e.et,b&&(a.isSheetDestroy===!0?b.eHb():b.rzb(),e.et=j),c=e.gDc,c&&(a.isSheetDestroy===!0?c.eHb():c.rzb(),e.gDc=j),d=e.eDc,d&&(a.isSheetDestroy===!0?d.eHb():d.rzb(),e.eDc=j))},attach:function(a){var b=this;a instanceof d.Workbook?b.ev(a.Wu):b.ev()},onLayoutChanged:function(a){this.Cf().isAdjustSuspended()||this.mUa(a)},toJson:function(a,b){var c,e,f,g,h,i=this,j=i.Su;d.GC$.isEmptyObject(j)||(a.customFunctions=j),c=[],e=i.getCustomNames(),f=w(i),e&&f&&(l(e,function(a,b){var d,e,g=b.getName(),h=b.getRow(),j=b.getColumn(),k=b.getExpression(),l=b.getComment();k&&(d=f.unparse(i.yj(),k,h,j,!1,!0,!0),e={name:g,formula:d,row:h,col:j},l&&(e.comment=l),c.push(e))}),c.length>0&&(a.names=c)),g=b&&b.ignoreFormula,g||(h=[i.et,i.eDc,i.gDc],[a.data,a.colHeaderData,a.rowHeaderData].forEach(function(a,b){var c=h[b];c&&c.toJSON({data:a})}))},fromJson:function(a,b,c,d){var e=this,f=c&&c.incrementalLoading;f||(e.clearCustomFunctions(),e.clearCustomNames()),d&&(e.nameFunctionsFromJSON(a,b,c),e.formulaFromJSON(a,b,c))},setName:function(a){var b,c,d;K(this),b=this.Bj(),c=w(b),d=c.lh.asyncManager,d.changeSourceName(a.oldName,a.newName)},beforeSetName:function(){this.uja&&(this.parent||this).tja();
}})},"./node_modules/process/browser.js":function(a,b){var c,d,e,f,g,h,i=a.exports={};function j(){throw Error("setTimeout has not been defined")}function k(){throw Error("clearTimeout has not been defined")}!function(){try{c="function"==typeof setTimeout?setTimeout:j}catch(a){c=j}try{d="function"==typeof clearTimeout?clearTimeout:k}catch(a){d=k}}();function l(a){if(c===setTimeout)return setTimeout(a,0);if((c===j||!c)&&setTimeout)return c=setTimeout,setTimeout(a,0);try{return c(a,0)}catch(b){try{return c.call(null,a,0)}catch(b){return c.call(this,a,0)}}}function m(a){if(d===clearTimeout)return clearTimeout(a);if((d===k||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(a);try{return d(a)}catch(b){try{return d.call(null,a)}catch(b){return d.call(this,a)}}}e=[],f=!1,h=-1;function n(){f&&g&&(f=!1,g.length?e=g.concat(e):h=-1,e.length&&o())}function o(){var a,b;if(!f){for(a=l(n),f=!0,b=e.length;b;){for(g=e,e=[];++h<b;)g&&g[h].run();h=-1,b=e.length}g=null,f=!1,m(a)}}i.nextTick=function(a){var b,c=Array(arguments.length-1);if(arguments.length>1)for(b=1;b<arguments.length;b++)c[b-1]=arguments[b];e.push(new p(a,c)),1!==e.length||f||l(o)};function p(a,b){this.fun=a,this.array=b}p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={};function q(){}i.on=q,i.addListener=q,i.once=q,i.off=q,i.removeListener=q,i.removeAllListeners=q,i.emit=q,i.prependListener=q,i.prependOnceListener=q,i.listeners=function(a){return[]},i.binding=function(a){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(a){throw Error("process.chdir is not supported")},i.umask=function(){return 0}},"./node_modules/util/node_modules/inherits/inherits_browser.js":function(a,b){"function"==typeof Object.create?a.exports=function a(b,c){b.super_=c,b.prototype=Object.create(c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function a(b,c){b.super_=c;var d=function(){};d.prototype=c.prototype,b.prototype=new d,b.prototype.constructor=b}},"./node_modules/util/support/isBufferBrowser.js":function(a,b){a.exports=function a(b){return b&&"object"==typeof b&&"function"==typeof b.copy&&"function"==typeof b.fill&&"function"==typeof b.readUInt8}},"./node_modules/util/util.js":function(a,b,c){(function(a){var d,e,f,g,h=Object.getOwnPropertyDescriptors||function a(b){var c,d=Object.keys(b),e={};for(c=0;c<d.length;c++)e[d[c]]=Object.getOwnPropertyDescriptor(b,d[c]);return e},i=/%[sdj%]/g;b.format=function(a){var b,c,d,e,f,g;if(!y(a)){for(b=[],c=0;c<arguments.length;c++)b.push(j(arguments[c]));return b.join(" ")}for(c=1,d=arguments,e=d.length,f=(a+"").replace(i,function(a){if("%%"===a)return"%";if(c>=e)return a;switch(a){case"%s":return d[c++]+"";case"%d":return+d[c++];case"%j":try{return JSON.stringify(d[c++])}catch(a){return"[Circular]"}default:return a}}),g=d[c];c<e;g=d[++c])f+=v(g)||!C(g)?" "+g:" "+j(g);return f},b.deprecate=function(c,d){if(void 0!==a&&a.noDeprecation===!0)return c;if(void 0===a)return function(){return b.deprecate(c,d).apply(this,arguments)};var e=!1;function f(){if(!e){if(a.throwDeprecation)throw Error(d);a.traceDeprecation?console.trace(d):console.error(d),e=!0}return c.apply(this,arguments)}return f},d={},b.debuglog=function(c){if(A(e)&&(e=a.env.NODE_DEBUG||""),c=c.toUpperCase(),!d[c])if(RegExp("\\b"+c+"\\b","i").test(e)){var f=a.pid;d[c]=function(){var a=b.format.apply(b,arguments);console.error("%s %d: %s",c,f,a)}}else d[c]=function(){};return d[c]};function j(a,c){var d={seen:[],stylize:l};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),u(c)?d.showHidden=c:c&&b.Ia(d,c),A(d.showHidden)&&(d.showHidden=!1),A(d.depth)&&(d.depth=2),A(d.colors)&&(d.colors=!1),A(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=k),n(d,a,d.depth)}b.inspect=j,j.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},j.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function k(a,b){var c=j.styles[b];return c?"\x1b["+j.colors[c][0]+"m"+a+"\x1b["+j.colors[c][1]+"m":a}function l(a,b){return a}function m(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function n(a,c,d){var e,f,g,h,i,j,k,l,u,v;if(a.customInspect&&c&&F(c.inspect)&&c.inspect!==b.inspect&&(!c.constructor||c.constructor.prototype!==c))return e=c.inspect(d,a),y(e)||(e=n(a,e,d)),e;if(f=o(a,c))return f;if(g=Object.keys(c),h=m(g),a.showHidden&&(g=Object.getOwnPropertyNames(c)),E(c)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return p(c);if(0===g.length){if(F(c))return i=c.name?": "+c.name:"",a.stylize("[Function"+i+"]","special");if(B(c))return a.stylize(RegExp.prototype.toString.call(c),"regexp");if(D(c))return a.stylize(Date.prototype.toString.call(c),"date");if(E(c))return p(c)}return j="",k=!1,l=["{","}"],t(c)&&(k=!0,l=["[","]"]),F(c)&&(u=c.name?": "+c.name:"",j=" [Function"+u+"]"),B(c)&&(j=" "+RegExp.prototype.toString.call(c)),D(c)&&(j=" "+Date.prototype.toUTCString.call(c)),E(c)&&(j=" "+p(c)),0!==g.length||k&&0!=c.length?d<0?B(c)?a.stylize(RegExp.prototype.toString.call(c),"regexp"):a.stylize("[Object]","special"):(a.seen.push(c),v=k?q(a,c,d,h,g):g.map(function(b){return r(a,c,d,h,b,k)}),a.seen.pop(),s(v,j,l)):l[0]+j+l[1]}function o(a,b){if(A(b))return a.stylize("undefined","undefined");if(y(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return x(b)?a.stylize(""+b,"number"):u(b)?a.stylize(""+b,"boolean"):v(b)?a.stylize("null","null"):void 0}function p(a){return"["+Error.prototype.toString.call(a)+"]"}function q(a,b,c,d,e){var f,g,h=[];for(f=0,g=b.length;f<g;++f)K(b,f+"")?h.push(r(a,b,c,d,f+"",!0)):h.push("");return e.forEach(function(e){e.match(/^\d+$/)||h.push(r(a,b,c,d,e,!0))}),h}function r(a,b,c,d,e,f){var g,h,i;if(i=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},i.get?h=i.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):i.set&&(h=a.stylize("[Setter]","special")),K(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(i.value)<0?(h=v(c)?n(a,i.value,null):n(a,i.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),A(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function s(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function t(a){return Array.isArray(a)}b.isArray=t;function u(a){return"boolean"==typeof a}b.isBoolean=u;function v(a){return null===a}b.isNull=v;function w(a){return null==a}b.isNullOrUndefined=w;function x(a){return"number"==typeof a}b.isNumber=x;function y(a){return"string"==typeof a}b.isString=y;function z(a){return"symbol"==typeof a}b.isSymbol=z;function A(a){return void 0===a}b.isUndefined=A;function B(a){return C(a)&&"[object RegExp]"===H(a)}b.isRegExp=B;function C(a){return"object"==typeof a&&null!==a}b.isObject=C;function D(a){return C(a)&&"[object Date]"===H(a)}b.isDate=D;function E(a){return C(a)&&("[object Error]"===H(a)||a instanceof Error)}b.isError=E;function F(a){return"function"==typeof a}b.isFunction=F;function G(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||void 0===a}b.isPrimitive=G,b.isBuffer=c("./node_modules/util/support/isBufferBrowser.js");function H(a){return Object.prototype.toString.call(a)}function I(a){return a<10?"0"+a.toString(10):a.toString(10)}f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function J(){var a=new Date,b=[I(a.getHours()),I(a.getMinutes()),I(a.getSeconds())].join(":");return[a.getDate(),f[a.getMonth()],b].join(" ")}b.log=function(){console.log("%s - %s",J(),b.format.apply(b,arguments))},b.inherits=c("./node_modules/util/node_modules/inherits/inherits_browser.js"),b.Ia=function(a,b){var c,d;if(!b||!C(b))return a;for(c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a};function K(a,b){return Object.prototype.hasOwnProperty.call(a,b)}g="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0,b.promisify=function a(b){if("function"!=typeof b)throw new TypeError('The "original" argument must be of type Function');if(g&&b[g]){var c=b[g];if("function"!=typeof c)throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(c,g,{value:c,enumerable:!1,writable:!1,configurable:!0}),c}function c(){var a,c,d,e=new Promise(function(b,d){a=b,c=d}),f=[];for(d=0;d<arguments.length;d++)f.push(arguments[d]);f.push(function(b,d){b?c(b):a(d)});try{b.apply(this,f)}catch(a){c(a)}return e}return Object.setPrototypeOf(c,Object.getPrototypeOf(b)),g&&Object.defineProperty(c,g,{value:c,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(c,h(b))},b.promisify.custom=g;function L(a,b){if(!a){var c=Error("Promise was rejected with a falsy value");c.reason=a,a=c}return b(a)}function M(b){if("function"!=typeof b)throw new TypeError('The "original" argument must be of type Function');function c(){var c,d,e,f,g=[];for(c=0;c<arguments.length;c++)g.push(arguments[c]);if(d=g.pop(),"function"!=typeof d)throw new TypeError("The last argument must be of type Function");e=this,f=function(){return d.apply(e,arguments)},b.apply(this,g).then(function(b){a.nextTick(f,null,b)},function(b){a.nextTick(L,b,f)})}return Object.setPrototypeOf(c,Object.getPrototypeOf(b)),Object.defineProperties(c,h(b)),c}b.callbackify=M}).call(this,c("./node_modules/process/browser.js"))},CalcEngine:function(a,b){a.exports=GC.Spread.CalcEngine},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets}});