/*!
 * jQuery.jsForm v1.2.0 | (c) 2013 Niko Berger http://www.gargan.org/
 * Usage: https://github.com/corinis/jsForm
 */
(function(t,e,a){"use strict";function i(e,a){var i=t(e);this.options=t.extend({},{controls:!0,data:null,prefix:"data",trackChanges:"changed",validateHidden:!0,skipEmpty:!1,renderer:null,processors:null,connect:null,viewClass:"value"},a),!i.attr("data-prefix")||"data"!==this.options.prefix&&""!==this.options.prefix||""!==i.attr("data-prefix")&&(this.options.prefix=i.attr("data-prefix")),this.element=e,this._init()}var s={},n={};i.prototype._init=function(){if(this._domInit(),this.options.controls)if(t.jsFormControls)t.each(this._getForm(),function(){t(this).jsFormControls()});else try{"undefined"!=typeof console&&console.log("jquery.JsForm.controls not available!")}catch(e){}this._fill(this.options)},i.prototype.connect=function(e){this._initCollection(e,this.options.prefix),this._initConditional(e,this.options.prefix,this.options),this.options.controls&&t.jsFormControls&&t(e).jsFormControls(),this._fillDom(e),this.options.connect||(this.options.connect=[]),this.options.connect.push(e)},i.prototype.getNodes=function(){return this._getForm()},i.prototype._domInit=function(){var e=this;t.each(this._getForm(),function(){e._initCollection(this,e.options.prefix),e._initConditional(this,e.options.prefix,e.options)})},i.prototype._debug=function(a,i){try{if(!e.console||!e.console.log)return;var s=null;s=t.isPlainObject(i)?JSON.stringify(i,null," "):i,s||(s=""),e.console.log(a+s)}catch(n){}},i.prototype._initConditional=function(e,a,i){var s=this,n=function(e,a,i){var n=!1;t.each(i,function(){var t=s._getValueWithArrays(a,this);if(t&&""!==t&&0!==t&&-1!==t)return n=!0,!1}),n?e.show():e.hide()},r=function(e,a,i){var n=!1;t.each(i,function(){var t=s._getValueWithArrays(a,this);if(t&&""!==t&&0!==t&&-1!==t)return n=!0,!1}),n?e.hide():e.show()};this.conditionals=t(e).find(".conditional"),this.conditionals.each(function(){t(this).data().conditionalEval=[];var e=t(this).attr("data-show");e&&e.length>0&&t(this).data().conditionalEval.push({func:n,field:e.split(" ")}),e=t(this).attr("data-hide"),e&&e.length>0&&t(this).data().conditionalEval.push({func:r,field:e.split(" ")}),e=t(this).attr("data-eval"),e&&e.length>0&&i.conditionals[e]&&t(this).data().conditionalEval.push({func:i.conditionals[e]})})},i.prototype._evaluateConditionals=function(e,a){this.conditionals.each(function(){var e=t(this);t.each(e.data().conditionalEval,function(){this.func(e,a,this.field)})})},i.prototype._initCollection=function(e,a){var i={},s=this;t(e).data().collections=i,t(".collection",e).each(function(){var e=t(this).attr("data-field");if(e&&0===e.indexOf(a+".")){var n=t(this),r=i[e];if(r?r.push(n):i[e]=[n],s._initList(n),!n.hasClass("ui-sortable")&&n.hasClass("sortable")&&n.sortable){var o=n.attr("data-sortable");o=o?JSON.parse(o):{},n.sortable(o),n.on("sortstop",function(){s._reorder(n)})}}}),t(".add",e).each(function(){var e=t(this).attr("data-field");e&&(t(this).data("collections")||(t(this).data().collections=i[e],t(this).click(function(a){a.preventDefault(),t.each(t(this).data("collections"),function(){var a=t(this).data("template");if(a){var i=a.clone(!0);t(i).addClass("POJO"),t(i).data().pojo={};var n=t(this).data("prefill");n||(n=t(this).val("data-prefill")),n&&(t.isFunction(n)?n(t(i).data().pojo,t(i)):n.substring?t(i).data().pojo=JSON.parse(n):t.isPlainObject(n)&&(t(i).data().pojo=n)),t(this).append(i),s._enableTracking(t("input,textarea,select",i)),s.options.trackChanges&&t("input,textarea,select",i).addClass(s.options.trackChanges),s._addCollectionControls(i),s._initCollection(i,e.substring(e.indexOf(".")+1)),t(this).trigger("addCollection",[i,t(i).data().pojo]);var r=t(this).children(".POJO").length;s._fillData(i,t(i).data().pojo,e.substring(e.indexOf(".")+1),r),t(this).trigger("postAddCollection",[i,t(i).data().pojo])}})})))}),t(".insert",e).each(function(){var e=t(this).attr("data-field");e&&(t(this).data("collections")||(t(this).data("collections",i[t(this).attr("data-field")]),t(this).on("insert",function(a,i){if(i||(i=t(this).data().pojo),i){var n=t(this).data("beforeInsert");n&&t.isFunction(n)&&!(i=n(i))||(t.each(t(this).data("collections"),function(){var a=t(this).data("template");if(a){var n=a.clone(!0);n.addClass("POJO"),n.data().pojo=i,s._addCollectionControls(n),s._initCollection(n),t(this).trigger("addCollection",[n,i]);var r=t(this).children(".POJO").length;s._fillData(n,i,e.substring(e.indexOf(".")+1),r),t(this).append(n),t(this).trigger("postAddCollection",[n,i])}}),t(this).val(""),t(this).data().pojo=null,t(this).focus())}})))}),t(".insertAction",e).each(function(){var e=t(this).attr("data-field");if(e&&!t(this).data("inserter")){var a=t(this).parent().find(".insert");a&&(t(this).data("inserter",a),t(this).click(function(e){return e.preventDefault(),t(this).data("inserter").trigger("insert"),!1}))}}),t("input.object",e).each(function(){t(this).on("update",function(){var e=t(this).data().pojo;e&&t(this).attr("data-display")&&t(this).val(s._renderObject(e,t(this).attr("data-display")))})}),t("input.blob",e).each(function(){if("file"===t(this).attr("type")){var e=t(this);t(this).on("change",function(a){var i=t(this).val().split(/\\/).pop();e.data("name",i);var s=a.target.files;s&&s.length&&t.each(s,function(){var a=new FileReader;a.onload=function(t){e.data("blob",t.target.result)},a.readAsDataURL(this),t(this).trigger("fileChange")})})}})},i.prototype._initList=function(t){if(!t.data("template")){var e=t.children().detach();e.removeAttr("id"),t.data("template",e)}},i.prototype._getForm=function(){var e=[t(this.element)];return this.options.connect&&t.each(this.options.connect,function(){e.push(t(this))}),e},i.prototype._clear=function(e,a){a||(a=this.options.prefix),t(e).removeData("pojo"),t("input,select,textarea",e).each(function(){var e=t(this).attr("name");e&&0===e.indexOf(a+".")&&(e=e.substring((a+".").length),1>e.length||(t(this).removeData("pojo"),"checkbox"===t(this).attr("type")?t(this).prop("checked",!1):t(this).val(""),t(this).hasClass("blob")&&t(this).removeData("blob"),t(this).is("select")&&(t('option[selected="selected"]',this).prop("selected",!1),t("option:first",this).prop("selected",!0),t(this).val(t("option:first",this).val()).change()),t(this).change()))}),t(".collection",e).each(function(){var e=t(this).attr("data-field");e&&0===e.indexOf(a+".")&&t(this).empty()})},i.prototype._createPojoFromInput=function(e,i,s){var n=null,r=this;return t(e).data("pojo")&&(n=t(e).data("pojo")),n&&t.extend(!0,s,n),t(e).find("input,select,textarea,.jsobject").each(function(){var e=t(this).attr("data-name");if(e||(e=t(this).attr("name")),e&&!t(this).hasClass("transient")&&0===e.indexOf(i+".")){t(this).trigger("validate",!0),e=e.substring((i+".").length);var n=t(this).val();if(t(this).hasClass("jsobject"))n=t(this).data("pojo");else{if(r.options.skipEmpty&&(!n||""===n||""===n.trim()))return;if(!t(this).hasClass("emptynull")||n&&""!==n&&"null"!==n&&""!==n.trim())if(t(this).hasClass("object")||t(this).hasClass("POJO"))if(t("option:selected",this).data()&&t("option:selected",this).data().pojo?t("option:selected",this).data().pojo?n=t("option:selected",this).data().pojo:t("option:selected",this).attr("data-obj")&&(n=JSON.parse(t("option:selected",this).attr("data-obj"))):n=t(this).data("pojo"),t.isFunction(t(this).data().processor))n=t(this).data().processor(n);else{var o=t(this).attr("data-processor");o&&r.options.processors[o]&&(n=r.options.processors[o](n))}else t(this).hasClass("blob")?n=t(this).data("blob"):""===n&&(t(this).hasClass("number")||t(this).hasClass("percent")||t(this).hasClass("integer")||t(this).hasClass("dateFilter")||t(this).hasClass("dateTimeFilter"))&&(n=null);else n=null;if(t(this).hasClass("percent"))n=r._getNumber(n),isNaN(n)?n=0:n/=100;else if(t(this).hasClass("number")||t(this).hasClass("integer")){if(t(this).hasClass("date")&&isNaN(n))if(t.format){var l=t.format.date(n);l.setHours(0),l.setMinutes(0),l.setSeconds(0),l.setMilliseconds(0),n=l.getTime()}else n=new Date(n).getTime();else n=r._getNumber(n);isNaN(n)&&(n=0)}else"checkbox"===t(this).attr("type")||"CHECKBOX"===t(this).attr("type")?t(this).hasClass("array")?(n=t(this).val(),t(this).attr("data-obj")&&(n=JSON.parse(t(this).attr("data-obj")))):n=t(this).is(":checked"):t(this).hasClass("bool")&&(n="true"===t(this).val())}if(1>e.length)return s=n,!1;if(-1===e.indexOf("."))if(t(this).hasClass("array"))if(s[e]||(s[e]=[]),"checkbox"===t(this).attr("type")||"CHECKBOX"===t(this).attr("type")){var h=t(this).is(":checked"),c=!0;t.each(s[e],function(t,i){return this==n?(c=!1,h||s[e].splice(i,1),!1):a}),c&&h&&s[e].push(n)}else{var d=t(this).attr("data-array");d=!d||isNaN(d)?null:Number(d),null===d?s[e].push(n):s[e][d]=n}else s[e]=n;else{var u,p,f=e.split("."),m=s[f[0]];m&&t.isPlainObject(m)||(s[f[0]]={},m=s[f[0]]),2===f.length?m[f[1]]=n:3===f.length?(u=m[f[1]],(u===a||null===u)&&(u={},m[f[1]]=u),u[f[2]]=n):4===f.length&&(u=m[f[1]],(null===u||u===a)&&(u={},m[f[1]]=u),p=u[f[2]],(p===a||null===u)&&(p={},u[f[2]]=p),u[f[2]]=n,p[f[3]]=n)}}}),s},i.prototype._enableTracking=function(e){var a=this;a.options.trackChanges&&!t(e).data().track&&(t(e).data().track=!0,t(e).change(function(){t(this).val()!==t(this).data().orig?t(this).addClass(a.options.trackChanges):t(this).removeClass(a.options.trackChanges)}))},i.prototype._fillData=function(e,i,s,n){var r=this,o=t(e);o.find(".field").each(function(){var e=t(this).data("name");if(e||("A"===this.nodeName.toUpperCase()?(e=t(this).attr("href"),t(this).attr("href","#")):"IMG"===this.nodeName.toUpperCase()?(e=t(this).attr("src"),0===e.indexOf("#")&&(e=e.substring(1)),t(this).attr("src","#")):e=t(this).text(),t(this).data("name",e),t(this).show()),!s||e.indexOf(s+".")>=0){var a=e;s&&(a=a.substring(s.length+1));var o=r._get(i,a,!1,n);o||0===o||o===!1||(o=""),t(this).hasClass("percent")&&!isNaN(o)?o=100*Number(o):t(this).hasClass("currency")&&(o||(o=0)),t.jsFormControls&&(o=t.jsFormControls.Format.format(this,o)),"A"===this.nodeName.toUpperCase()?t(this).attr("href",o):"IMG"===this.nodeName.toUpperCase()?t(this).attr("src",o):"DIV"===this.nodeName.toUpperCase()?t(this).html(o):t(this).text(o)}}),t("input, textarea",o).each(function(){var e=t(this).attr("name");if(e&&(r._enableTracking(this),"file"!=t(this).attr("type")&&(!s||e.indexOf(s+".")>=0))){var o=e;s&&(o=o.substring(s.length+1));var l=r._get(i,o,!1,n);if(t(this).hasClass("object")?(t(this).data().pojo=l,t(this).addClass("POJO"),(t(this).attr("data-display")||t(this).attr("data-render"))&&(l=r._renderObject(l,t(this).attr("data-display"),t(this).attr("data-render")))):t(this).hasClass("jsobject")?(t(this).data().pojo=l,t(this).addClass("POJO")):t(this).hasClass("percent")&&!isNaN(l)?l=100*Number(l):t.isPlainObject(l)&&(t(this).data().pojo=l,t(this).addClass("POJO"),l=r._renderObject(l,t(this).attr("data-display"),t(this).attr("data-render"))),"checkbox"===t(this).attr("type"))if(t(this).hasClass("array")){var h=t(this).val(),c=null;t(this).attr("data-obj")&&(h=JSON.parse(t(this).attr("data-obj"))),t(this).attr("data-id")&&(c=t(this).attr("data-id"),h=h[c]);var d=!1;l&&t.each(l,function(){var t=this;return c&&(t=t[c]),t==h?(d=!0,!1):a}),t(this).prop("checked",d)}else t(this).prop("checked",l===!0||"true"===l);else if(l||(l=""),t.jsFormControls&&(l=t.jsFormControls.Format.format(this,l)),t(this).hasClass("array")){var u=t(this).attr("data-array");u=!u||isNaN(u)?null:Number(u),null!==u&&l&&l.length>u?t(this).val(l[u]):t(this).val("")}else t(this).val(l);r.options.trackChanges&&(t(this).data().orig=t(this).val()),t(this).change(),t(this).trigger("fill")}}),t("select",o).each(function(){var e=t(this).attr("name");if(e&&(!s||e.indexOf(s+".")>=0)){var o=e;s&&(o=o.substring(s.length+1)),r._enableTracking(this),t(this).children("option:selected").prop("selected",!1);var l=t(this).attr("data-key");l||(l="id");var h=r._get(i,o,!1,n);if(h[l]||!isNaN(h[l]))return t(this).children("option[value='"+h[l]+"']").prop("selected",!0),t(this).val(h[l]).change(),a;t(this).hasClass("bool")&&(h=h?"true":"false"),t(this).children("option[value='"+h+"']").prop("selected",!0),t(this).val(h),r.options.trackChanges&&(t(this).data().orig=t(this).val()),t(this).change().trigger("fill")}})},i.prototype.get=function(e){var a=this,i=this.options.data,s=this.options.prefix,n={};i&&t.isPlainObject(i)&&(n=t.extend({},i));var r=!1;return t.each(this._getForm(),function(){a._createPojoFromInput(this,s,n),a.options.validateHidden?this.find(".invalid").each(function(){return r=!0,t(this).focus(),!1}):this.find(".invalid").filter(":visible").each(function(){return r=!0,t(this).focus(),e||a._debug("Found invalid field: "+t(this).attr("name")),!1}),a._getCollection(this,s,n,e)&&(r=!0)}),!e&&r?null:n},i.prototype._getCollection=function(e,a,i,s){var n=this,r=!1;return e.find(".collection").each(function(){if(s||!r){var e=t(this).attr("data-field");if(e&&0===e.indexOf(a+".")){e=e.substring((a+".").length);var o=n._getParent(i,e,!0);-1!==e.indexOf(".")&&(e=e.substring(e.lastIndexOf(".")+1)),o[e]=[],t(this).children().each(function(){var a={};if(a=n._createPojoFromInput(t(this),e,a),n._getCollection(t(this),e,a,s),n._isEmpty(a))t(".invalid",this).removeClass("invalid");else{if(t(".invalid",this).length>0&&(r=!0,!s))return!1;o[e].push(a)}})}}}),r},i.prototype.getData=function(){return this.options.data||(this.options.data={}),this.options.data},i.prototype.preventEditing=function(e){var i=t(this.element),s=this.options.viewClass;if(e===a)e=i.data("disabled")?!1:!0;else if(e===i.data("disabled"))return;e?(i.find("input, textarea").each(function(){if(!t(this).closest("span."+s)[0]&&"hidden"!=t(this).attr("type")){var e=t(this).val();("null"===e||null===e||"submit"===t(this).attr("type"))&&(e=""),t(this).hasClass("trueFalse")&&(e=t(this).is(":checked")?"X":"&#160;"),e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br/>");var a=t('<span class="'+s+'">'+e+"</span>");t(this).parent().hasClass("ui-wrapper")?t(this).parent().hide().wrap(a):t(this).hide().wrap(a)}}),i.find("select").each(function(){if(!t(this).closest("span."+s)[0]){var e=t(this).children(":selected").html();("null"===e||null===e)&&(e="");var a=t('<span class="'+s+'">'+e+"</span>");t(this).hasClass("ui-toggle-switch")?t(this).prev().hide().wrap(a):t(this).hide().wrap(a)}})):i.find("span."+s).each(function(){var e=t(this).children("input,select,textarea,.ui-wrapper,.ui-toggle-switch").show().detach();t(this).before(e),t(this).remove()}),i.data("disabled",e)},i.prototype.validate=function(){var e=!0;return t.each(this._getForm(),function(){t(".required,.regexp,.date,.mandatory,.number,.validate,.integer",this).change(),t(".invalid",this).length>0&&(e=!1)}),e},i.prototype._fill=function(){var e=this;t(this.element).addClass("POJO"),t(this.element).data("pojo",this.options.data),t.each(this._getForm(),function(){e._fillDom(this)})},i.prototype._fillDom=function(t){var e=this;e._clear(t,e.options.prefix),e._fillData(t,e.options.data,e.options.prefix),e._fillCollection(t,e.options.data,e.options.prefix),e._evaluateConditionals(t,e.options.data)},i.prototype._fillCollection=function(e,a,i){var s=this;t(".collection",e).each(function(){var e=t(this),n=t(this).attr("data-field");if(a&&n&&0===n.indexOf(i+".")){var r=null,o=n;i&&(o=o.substring(i.length+1)),r=s._get(a,o),r&&s._fillList(e,r,o)}})},i.prototype._fillList=function(e,a,i,s){var n=e.data("template"),r=this;if(n&&(e.empty(),t.isArray(a))){if(-1!==i.indexOf(".")&&(i=i.substring(i.lastIndexOf(".")+1)),e.hasClass("sort")){var o=e.attr("data-sort");if(o){switch(e.attr("data-sorttype")){case"alpha":a.sort();break;case"alphainsensitiv":a.sort(function(t,e){return t=t[o],e=e[o],t&&(t=t.toLowerCase()),e&&(e=e.toLowerCase()),e>t?-1:t>e?1:0});break;default:a.sort(function(t,e){return t[o]-e[o]})}e.attr("data-sortdesc")&&a.reverse()}}s||t.isFunction(i)&&(s=i,i=null);for(var l=0;a.length>l;l++){var h=a[l],c=n.clone(!0);c.data().pojo=h,c.addClass("POJO"),s&&s(c,h)===!1||(r._addCollectionControls(c),e.trigger("addCollection",[c,h]),i&&(r._fillData(c,h,i,l+1),r._initCollection(c,i),r._fillCollection(c,h,i)),e.append(c),e.trigger("postAddCollection",[c,t(c).data().pojo]))}}},i.prototype._addCollectionControls=function(e){var a=this;t.jsFormControls&&t(e).jsFormControls(),t(".delete",e).click(function(){var e=t(this).closest(".POJO"),a=t(e).data().pojo,i=t(this).closest(".collection");e.detach(),t(i).trigger("deleteCollection",[e,a])}),t(".sortUp",e).click(function(){var e=t(this).closest(".POJO"),i=e.prev(".POJO");0!==i.size()&&(e.detach(),i.before(e),a._reorder(e))}),t(".sortDown",e).click(function(){var e=t(this).closest(".POJO"),i=e.next(".POJO");0!==i.size()&&(e.detach(),i.after(e),a._reorder(e))});var i=t(e).closest(".collection");i.hasClass("sortable")&&t(i).sortable&&i.sortable("refresh")},i.prototype._reorder=function(e){e.attr("data-sort")||(e=e.closest(".collection"));var a=t(e).attr("data-sort");if(!(!a||t(e).attr("data-sorttype")&&"number"!==t(e).attr("data-sorttype")||t(e).attr("data-sortdesc")&&"false"!==t(e).attr("data-sortdesc"))){var i=0;t.each(t(e).children(),function(){var e=t(this).data("pojo");e||(e={},t(this).data("pojo",e)),e[a]=i++})}},i.prototype._renderObject=function(e,a,i){if(!e||!a&&!i)return"";if(i)return this.options.renderer&&this.options.renderer[i]?this.options.renderer[i](e):(this._debug("Unable to find renderer: "+i),"");var s=this,n="";return t.each(a.split(","),function(){var t=this.trim();n+=0===t.indexOf("'")||0===t.indexOf('"')?t.substring(1,t.length-1):s._get(e,t)}),n},i.prototype._get=function(t,e,i,s){var n,r,o,l="";if("function"==typeof e)return e(t);if(!t)return"";if(""===e)return t;if("$idx"===e)return s;if(n=t[e],!n)try{if("string"==typeof e&&(l=e.split(".")),o=l.length)for(n=t;n&&o--;)r=l.shift(),i&&!n[r]&&(n[r]={}),n=n[r]}catch(h){}return(null===n||n===a)&&(n=""),n.trim?n.trim():n},i.prototype._getValueWithArrays=function(t,e){e=e.split(".");for(var a=/(.*)\[(\d+)\]/,i=1;e.length>i;i++){var s=a.exec(e[i]);try{t=s?t[s[1]][parseInt(s[2],10)]:t[e[i]]}catch(n){this._debug(e+" "+n)}}return t},i.prototype._getParent=function(t,e,a){return-1===e.indexOf(".")?t:(e=e.substring(0,e.lastIndexOf(".")),this._get(t,e,a))},i.prototype._getNumber=function(e){return e?t.jsFormControls?t.jsFormControls.Format._getNumber(e):(-1!=e.indexOf(",")&&(e=e.replace(RegExp(",","g"),"")),Number(e)):null},i.prototype._isEmpty=function(e){if(!e)return!0;if(t.isArray(e)){if(0===e.length)return!0;for(var a=0;e.length>a;a++)if(!this._isEmpty())return!1;return!0}if(t.isPlainObject(e)){if(t.isEmptyObject(e))return!0;for(var i in e)if(!this._isEmpty(e[i]))return!1;return!0}return isNaN(e)?""===e||" "===e:0===Number(e)||-1===Number(e)?!0:!1},i.prototype._equals=function(t,e,i){if(!t&&e&&e.length&&0===e.length)return!0;if(!e&&t&&t.length&&0===t.length)return!0;if(!t&&!e)return!0;var s=null;for(s in t){if(e[s]===a&&null!==t[s]&&""!==t[s]&&0!==t[s].length){if(("0"===t[s]||0===t[s])&&!e[s])continue;return!1}if(t[s])switch(typeof t[s]){case"object":if(i&&t[s][i]&&t[s][i]===e[s][i])continue;if(!this._equals(t[s],e[s]))return!1;break;case"function":break;default:if(!t[s]&&!e[s])break;if((t===!0||t===!1)&&t!==e)return!1;if(!isNaN(t[s])||!isNaN(e[s])){if(1e-7>Math.abs(Number(t[s])-Number(e[s])))break;return!1}if((""+t[s]).length!==(""+e[s]).length)return!1;if(t[s]!==e[s]&&Number(t[s])!==Number(e[s]))return!1}else if(e[s])return!1}for(s in e)if((!t||t[s]===a)&&null!==e[s]&&""!==e[s])return!1;return!0},i.prototype.equals=function(t,e){var a=this.get(!1);return this._equals(a,t,e)},i.prototype.changed=function(){if(!this.options.trackChanges)return!1;var e=!1,i=this;return t.each(this._getForm(),function(){return t("."+i.options.trackChanges,this).size()>0?(e=!0,!1):a}),e},i.prototype.resetChanged=function(){if(!this.options.trackChanges)return!1;var e=!1,a=this;return t.each(this._getForm(),function(){t("."+a.options.trackChanges,this).each(function(){t(this).removeClass(a.options.trackChanges),t(this).data().orig=t(this).val()})}),e},i.prototype._equalsCollection=function(e,i,s){var n=this,r=!1;return t(".collection",e).each(function(){if(!r){var e=t(this).attr("data-field");if(e&&0===e.indexOf(i+".")&&(e=e.substring((i+".").length),!(1>e.length))){var o=0;t(this).children().each(function(){if(!r){if(o>=s[e].length)return r=!0,a;var i=s[e][o++];n._pojoDifferFromInput(t(this),e,i)&&(r=!0),n._equalsCollection(t(this),e,i)||(r=!0)}}),s[e]&&s[e].length>o&&(r=!0)}}}),!r},i.prototype.fill=function(e){this.options.data=t.extend({},e),this._fill()},i.prototype.applyConditions=function(t){t||(t=this.get(!0)),this._evaluateConditionals(this.element,t)},i.prototype.reset=function(){this.fill({})},i.prototype.clear=function(){var e=this;t.each(this._getForm(),function(){e._clear(this,e.options.prefix)})},i.prototype.destroy=function(){return t(this.element).each(function(){t(this).removeData("jsForm"),t.jsFormControls&&t(this).jsFormControls("destroy")})},t.fn.jsForm=function(e){if("object"!=typeof e&&e){var s,n=Array.prototype.slice.call(arguments,1);if(0===this.length)return null;if(1===this.length&&(s=t(this).data("jsForm"))){if(0!==e.indexOf("_")&&s[e]){var r=s[e].apply(s,n);return r}return t.error("Method "+e+" does not exist on jQuery.jsForm"),!1}return this.each(function(){return s=t.data(this,"jsForm"),s?0!==e.indexOf("_")&&s[e]?s[e].apply(s,n):(t.error("Method "+e+" does not exist on jQuery.jsForm"),!1):a})}return this.each(function(){t(this).data("jsForm")||t(this).data("jsForm",new i(this,e))})},t.jsForm=function(e,a){var i=n[e];if(t.isFunction(a))i&&t.each(i,function(){a(this,t(this.element))}),s[e]=a;else if(i){var r=a,o=Array.prototype.slice.call(arguments,2);t.each(portlets,function(){this[r].apply(this,o)})}}})(jQuery,window),function(t){"use strict";function e(t){this.element=t,this._domInit()}var a={},i={};"undefined"!=typeof Handlebars&&(Handlebars.registerHelper("currency",function(e){return e?t.jsFormControls.Format.currency(e):t.jsFormControls.Format.currency(0)}),Handlebars.registerHelper("dec",function(e){return e?t.jsFormControls.Format.decimal(e):""}),Handlebars.registerHelper("percent",function(e){return e?t.jsFormControls.Format.decimal(100*e):"0"}),Handlebars.registerHelper("date",function(e){return e?t.jsFormControls.Format.date(e):""}),Handlebars.registerHelper("time",function(e){return e?t.jsFormControls.Format.time(e):""}),Handlebars.registerHelper("datetime",function(e){return e?t.jsFormControls.Format.dateTime(e):""}),Handlebars.registerHelper("dateTime",function(e){return e?t.jsFormControls.Format.dateTime(e):""}),Handlebars.registerHelper("timespan",function(e){return e?t.jsFormControls.Format.humanTime(e):""}),Handlebars.registerHelper("byte",function(e){return e?t.jsFormControls.Format.byte(e):""})),e.prototype._domInit=function(){var e=t(this.element);e.find("input.mandatory,textarea.mandatory").on("keyup",function(){t(this).val().length>0&&"null"!==t(this).val()?t(this).addClass("valid").removeClass("invalid"):t(this).removeClass("valid").addClass("invalid")}),e.find("input.mandatory,textarea.mandatory").on("change",function(){return t(this).hasClass("object")?(t(this).data().pojo?t(this).addClass("valid").removeClass("invalid"):t(this).removeClass("valid").addClass("invalid"),undefined):(t(this).val().length>0&&"null"!==t(this).val()?t(this).addClass("valid").removeClass("invalid"):t(this).removeClass("valid").addClass("invalid"),undefined)}).change(),e.find("select.mandatory").change(function(){null!==t(this).val()&&"null"!==t(this).val()&&t(this).val().length>0?t(this).addClass("valid").removeClass("invalid"):t(this).removeClass("valid").addClass("invalid")}).change(),e.find("input.date").each(function(){var e=t(this).attr("data-format");t(this).datepicker&&(e?t(this).datepicker({dateFormat:e}):t(this).datepicker())});var a=RegExp("^[0-9.,-]+$");e.find("input.number").keyup(function(){var e=t(this).val();t(this).hasClass("currency")&&e&&(e=t.jsFormControls.Format._getNumber(e)),e.length>0&&(t(this).hasClass("autoclean")?t(this).val(e.replace(/[^0-9.,-]/g,"")):a.test(t(this).val())?t(this).addClass("valid").removeClass("invalid"):t(this).removeClass("valid").addClass("invalid"))}).keyup(),e.find("input.currency").each(function(){t(this).on("change blur",function(){var e=t(this).val();e.length>0&&t(this).val(t.jsFormControls.Format.currency(t.jsFormControls.Format._getNumber(e)))}),t(this).focus(function(){var e=t(this).val();e.length>0&&t(this).val(t.jsFormControls.Format._getNumber(e))})}),e.find("input.percent").change(function(){var e=t(this).val();e.length>0&&t(this).val(t.jsFormControls.Format.decimal(t.jsFormControls.Format._getNumber(e))),t(this).focus(function(){var e=t(this).val();e.length>0&&t(this).val(t.jsFormControls.Format._getNumber(e))})}),e.find("input.decimal").change(function(){var e=t(this).val();e.length>0&&t(this).val(t.jsFormControls.Format.decimal(t.jsFormControls.Format._getNumber(e)))});var i=RegExp("^[0-9]+$");e.find("input.integer").keyup(function(){var e=t(this).val();e.length>0&&(t(this).hasClass("autoclean")?t(this).val(e.replace(/[^0-9]/g,"")):i.test(t(this).val())?t(this).addClass("valid").removeClass("invalid"):t(this).removeClass("valid").addClass("invalid"))}).keyup(),e.find("input.regexp").each(function(){t(this).hasClass("autoclean")?t(this).data("regexp",RegExp(t(this).attr("data-regexp"),"g")):t(this).data("regexp",RegExp(t(this).attr("data-regexp"))),t(this).keyup(function(){var e=t(this).val();if(e.length>0){var a=t(this).data("regexp");t(this).hasClass("autoclean")?t(this).val(e.replace(a,"")):a.test(t(this).val())?t(this).addClass("valid").removeClass("invalid"):t(this).removeClass("valid").addClass("invalid")}else t(this).hasClass("mandatory")||t(this).removeClass("invalid").addClass("valid")}).keyup(),t(this).change(function(){t(this).keyup()})}),e.find("input.rotatestate").each(function(){var e=t(this).attr("data-state-values"),a=t(this).attr("data-state-class");if(e){try{e=JSON.parse(e)}catch(i){return}var s=t("<span></span>");t(this).attr("title")&&s.attr("title",t(this).attr("title")),t(this).attr("data-state-style")&&s.attr("style",t(this).attr("data-state-style")),s.data("states",e),s.data("control",this),s.data("activeState",null),t(this).data("control",s),a&&s.addClass(a),s.click(function(){var e=t(this).data().activeState,a=t(this).data().states,i=t(this).data().control,s=null;if(null!==e){for(var n=0;a.length>n;n++)if(a[n].value===e.value){s=n===a.length-1?a[0]:a[n+1];break}}else s=a[0];t(i).attr("value",s.value),t(i).change()}),t(this).change(function(){var e=t(t(this).data().control),a=e.data().activeState,i=e.data().states;null!==a&&e.removeClass(a["class"]);var s=t(this).val();t.each(i,function(){return this.value===s?(e.data().activeState=this,this.title&&e.attr("title",this.title),e.addClass(this["class"]),!1):undefined})}),t(this).change(),t(this).after(s),t(this).hide()}})},e.prototype.validate=function(){return t(".required,.regexp,.date,.mandatory,.number,.validate",this.element).change(),t(".invalid",this.element).length>0?!1:!0},e.prototype.destroy=function(){return t(this.element).each(function(){t(this).removeData("jsFormControls")})},t.fn.jsFormControls=function(a){if("object"!=typeof a&&a){var i=Array.prototype.slice.call(arguments,1);if(1==this.length){var s=t(this).data("jsFormControls");if(s){if(0!==a.indexOf("_")&&s[a]){var n=s[a].apply(s,i);return n}return t.error("Method "+a+" does not exist on jQuery.jsFormControls"),!1}}return this.each(function(){var e=t.data(this,"jsFormControls");return e?0!==a.indexOf("_")&&e[a]?e[a].apply(e,i):(t.error("Method "+a+" does not exist on jQuery.jsFormControls"),!1):undefined})}return this.each(function(){t(this).data("jsFormControls")||t(this).data("jsFormControls",new e(this,a))})},t.jsFormControls=function(e,s){var n;if(t.isFunction(s))n=i[e],n&&t.each(n,function(){s(this,t(this.element))}),a[e]=s;else if(n=i[e]){var r=s,o=Array.prototype.slice.call(arguments,2);t.each(portlets,function(){this[r].apply(this,o)})}},t.jsFormControls.Format={format:function(e,a){return t(e).hasClass("dateTime")?isNaN(a)?a:t.jsFormControls.Format.dateTime(a):t(e).hasClass("datetime")?isNaN(a)?a:t.jsFormControls.Format.dateTime(a):t(e).hasClass("date")?isNaN(a)?a:t.jsFormControls.Format.date(a):t(e).hasClass("currency")?t.jsFormControls.Format.currency(a):t(e).hasClass("byte")?isNaN(a)?a:t.jsFormControls.Format.byte(a):t(e).hasClass("decimal")?t.jsFormControls.Format.decimal(a):t(e).hasClass("percent")?t.jsFormControls.Format.decimal(a):a},_getValue:function(t,e,a){return e===undefined&&a===undefined?t:isNaN(t)||e===undefined||a===undefined?undefined:a},checkBox:function(e,a,i,s){return i=t.jsFormControls.Format._getValue(e,a,i,s),i?'<span class="ui-icon ui-icon-check">&nbsp;</span>':'<span class="ui-icon ui-icon-close">&nbsp;</span>'},_getNumber:function(e){if(!e)return null;var a={format:"#,##0.###",groupingSeparator:",",decimalSeparator:"."},i=null,s=null;return"undefined"!=typeof i18n?(a=i18n.number,i18n.currency&&(i=i18n.currency.prefix,s=i18n.currency.suffix)):t(document).data().i18n&&t(document).data().i18n.number&&(a=t(document).data().i18n.number,t(document).data().i18n.currency&&(i=t(document).data().i18n.currency.prefix,s=t(document).data().i18n.currency.suffix)),e=""+e,i&&i.length>0&&0===e.indexOf(i)&&(e=e.substring(i.length)),s&&s.length>0&&e.indexOf(s)>0&&(e=e.substring(0,e.length-s.length)),e=t.trim(e),-1!==e.indexOf(a.groupingSeparator)&&(e=e.replace(RegExp("\\"+a.groupingSeparator,"g"),"")),"."!==a.decimalSeparator&&-1!==e.indexOf(a.decimalSeparator)&&(e=e.replace(RegExp(a.decimalSeparator,"g"),".")),Number(e)},_pad:function(t){var e=10>t?"0":"";return e+=t},asNumber:function(e){return t.jsFormControls.Format._getNumber(e)},"byte":function(t){if(""===t||!t||isNaN(t))return t;var e=1024;if(e>t)return t+" B";var a=Math.floor(Math.log(t)/Math.log(e)),i="KMGTPE".charAt(a-1)+"B";return Math.round(10*t/Math.pow(e,a))/10+i},decimal:function(e){if(""===e||!e||isNaN(e))return e;var a={format:"#,##0.###",groupingSeparator:",",decimalSeparator:"."};"undefined"!=typeof i18n?a=i18n.number:t(document).data().i18n&&t(document).data().i18n.number&&(a=t(document).data().i18n.number);var i=0;Math.abs(e-Math.floor(e))>.001&&(i=2);var s=e,n=isNaN(n=Math.abs(i))?2:i,r=a.decimalSeparator,o=a.groupingSeparator,l=parseInt(s=Math.abs(+s||0).toFixed(n),10)+"",h=(h=l.length)>3?h%3:0;return(0>e?"-":"")+(h?l.substr(0,h)+o:"")+l.substr(h).replace(/(\d{3})(?=\d)/g,"$1"+o)+(n?r+Math.abs(s-l).toFixed(n).slice(2):"")},currency:function(e,a,i,s){if(i=t.jsFormControls.Format._getValue(e,a,i,s),!i){if(a)return"&#160;";i=0}var n=t.jsFormControls.Format.decimal(i),r=null,o=null;return"undefined"!=typeof i18n?i18n.currency&&(r=i18n.currency.prefix,o=i18n.currency.suffix):t(document).data().i18n&&t(document).data().i18n.number&&t(document).data().i18n.currency&&(r=t(document).data().i18n.currency.prefix,o=t(document).data().i18n.currency.suffix),r&&(n=r+n),o&&(n+=o),n},dateTime:function(e,a,i,s){return i=t.jsFormControls.Format._getValue(e,a,i,s),i?this.date(i)+" "+this.time(i):a?"&#160;":""},date:function(e,a,i,s){if(i=t.jsFormControls.Format._getValue(e,a,i,s),!i||""===i||isNaN(i))return a?"&#160;":"";var n=new Date;n.setTime(i);var r=n.getYear();1900>r&&(r+=1900);var o=null;return"undefined"!=typeof i18n?o=i18n.date:t(document).data().i18n&&t(document).data().i18n.date&&(o=t(document).data().i18n.date),t.format?t.format.date(n,o.shortDateFormat):this._pad(n.getDate())+"."+this._pad(n.getMonth()+1)+"."+this._pad(r)},time:function(e,a,i,s){if(i=t.jsFormControls.Format._getValue(e,a,i,s),!i||""===i||isNaN(i))return a?"&#160;":"";var n=new Date;n.setTime(i);var r="HH:mm";return"undefined"!=typeof i18n?i18n.timeFormat?r=i18n.timeFormat:i18n.date&&i18n.date.timeFormat&&(r=i18n.date.timeFormat):t(document).data().i18n&&t(document).data().i18n.timeFormat!==undefined&&(r=t(document).data().i18n.timeFormat),t.format?t.format.date(n,r):this._pad(n.getHours())+":"+this._pad(n.getMinutes())},timespan:function(e,a,i,s){i=t.jsFormControls.Format._getValue(e,a,i,s);for(var n=i.split(":"),r=0;n.length>r;r++){var o=Number(n[r]);
o&&"NaN"!==o||(o=0),n[r]=this._pad(o)}return 0>=n.length?"0:00":1==n.length?"0:"+this._pad(allowkomma?n[0]:Math.floor(n[0])):2==n.length?allowkomma?n[0]:Math.floor(n[0])+":"+this._pad(allowkomma?n[1]:Math.floor(n[1])):allowkomma?n[0]:Math.floor(n[0])+":"+this._pad(allowkomma?n[1]:Math.floor(n[1]))+":"+pad(allowkomma?n[2]:Math.floor(n[2]))},humanTime:function(e,a,i,s){if(i=t.jsFormControls.Format._getValue(e,a,i,s),isNaN(i))return i&&0!==i.length?i:"-";var n=Math.floor(i/36e5);i-=36e5*n;var r=Math.floor(i/6e4);i-=6e4*r;var o=Math.floor(i/1e3);i-=1e3*o;var l="";return n>0&&(l+=n+"h ",o=0,i=0),r>0&&(l+=r+"m ",i=0),o>0&&(l+=o+"s ",i=0),i>0&&(l+=i+"ms"),l.trim()}}}(jQuery,window),String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.startsWith=function(t){return null===this||0>=this.length?!1:null===t||"null"==t||0>=t.length?!1:this.substr(0,t.length)==t?!0:!1},String.prototype.startsWithIgnoreCase=function(t){return null===this||0>=this.length?!1:null===t||"null"==t||0>=t.length?!1:this.substr(0,t.length).toLowerCase()==t.toLowerCase()?!0:!1},String.prototype.endsWith=function(t){return null===this||0>=this.length?!1:null===t||"null"==t||0>=t.length||t.length>this.length?!1:this.substr(this.length-t.length)==t?!0:!1};
//@ sourceMappingURL=dist/jquery.jsForm.min.map