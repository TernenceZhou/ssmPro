/*!
 * 
 * Spread.Sheets Library 11.2.2
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Touch=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){!function(){"use strict";var b=c(1);b.SR={},b.SR.en=c(4),a.exports=b}()},function(a,b,c){!function(){"use strict";var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s={},t=c(2),u=c(3),v=t.j.Fa,w=u.Go,x=u.GC$,y=x.extend,z=x.isEmptyObject,A=x.inherit,B=u.Ul,C=B.Nl,D=u.Im,E=u.Rect,F=u.Vl,G=u.En,H=u.kf,I=u.Events,J=u.zp,K=u.yp,L=B.nl,M=B.Ml.mozilla,N=u.Im.Lm,O=B.rl(),P=O.ipad||O.iphone,Q=null,R=void 0,S=Math.abs,T=Math.min,U=Math.max,V=Math.pow,W=Math.atan2,X=Math.PI,Y=Math.round,Z=Math.sqrt,$=Math.atan,_=Math.log,aa=Math.floor,ba=100,ca="touch",da="none",ea="MSPointerDown",fa="MSPointerMove",ga="MSPointerUp",ha="pointerdown",ia="pointermove",ja="pointerup",ka="touchstart",la="touchmove",ma="touchend",na="MSPOINTER_TYPE_TOUCH",oa=isNaN,pa=parseInt,qa=parseFloat,ra=window,sa=document,ta=ra.Yl,ua="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB",va="AAAAAElFTkSuQmCC",wa=u.Bn;function xa(){return t.C(s.SR)()}function ya(a){return a.height}function za(a){return a.width}function Aa(a){clearInterval(a)}function Ba(){return(new Date).valueOf()}function Ca(a,b){var c,d,e,f,g,h,i,j;return!(!a||!b)&&(c=13,d=15,e=c,f=c,g=d,h=d,i=a.X-b.X,j=a.Y-b.Y,S(i)<e&&S(j)<f&&Z(i*i+j*j)<T(g,h))}function Da(a){return a.getActiveSheet()}function Ea(a){return a.getSelections()}function Fa(a){return a.frozenTrailingColumnCount()}function Ga(a){return a.frozenTrailingRowCount()}function Ha(a,b){return a.getColumnCount(b)}function Ia(a,b){return a.getRowCount(b)}b=400,d=1e3,e=20;function Ja(a){var b=x(a).offset(),c=sa.body,d=0,e=0;return b&&(d=b.top+c.clientTop||0,e=b.left+c.clientLeft||0),{FB:d,EB:e}}function Ka(){var a=this;a.rM=[],a.sM={length:0},a.tM=new Qa,a.uM=new Ra}y(Ka.prototype,{vM:function(a){this.tM.vM=a},wM:function(a){this.tM.wM=a},xM:function(a){var b=this;b.tM.xM=function(c){if(a){a(c);var d=b.yM;d&&d.zM()}}},AM:function(a){this.tM.AM=a},BM:function(a){this.tM.BM=a},CM:function(a){this.uM.CM=a},DM:function(a){this.uM.DM=a},EM:function(a){this.uM.EM=a},FM:function(a){this.GM=a},HM:function(a){this.IM=a},JM:function(a,b){var c=b?b.KM:this.LM.KM;return B.Z3(a,c)},MM:function(a,b){var c,d,e,f,g,h,i=this,j=b.pointerType,k=b.target,l=b.offsetX,m=b.offsetY;j!==b[na]&&j!==ca||(c=i.JM(k,a),d=c.EB,e=c.FB,f=i.NM(a,k,b.pointerId,new Sa(l+d,m+e),b.timeStamp),f&&L(b),"sheet"===i.LM.OM&&(g=b.pageX-(l+d),h=b.pageY-(m+e),i.LM.KM.canvasOffset={top:h,left:g}))},PM:function(a){var b,c,d=this,e=a.pointerType,f=a.pointerId;if(e===a[na]||e===ca){if(d.sM[f]===R)return!1;b=d.JM(a.target),c=d.aB(f,new Sa(a.offsetX+b.EB,a.offsetY+b.FB),a.timeStamp),c&&L(a)}},QM:function(a){var b,c,d=this,e=a.pointerType,f=a.pointerId;if(e===a[na]||e===ca){if(d.sM[f]===R)return!1;b=d.JM(a.target),c=d.RM(f,new Sa(a.offsetX+b.EB,a.offsetY+b.FB)),c&&L(a)}},SM:function(a){var b,c,d=this,e=a.pointerType,f=a.pointerId;if(e===a[na]||e===ca){if(d.sM[f]===R)return!1;b=d.JM(a.target),c=d.TM(f,new Sa(a.offsetX+b.EB,a.offsetY+b.FB)),c&&L(a)}},UM:function(a,b){var c,d,e,f=Ja(a.KM),g=b.changedTouches,h=!1;for(c=0;c<g.length;c++)d=g[c],e=M?Ba():b.timeStamp,h=this.NM(a,b.target,d.identifier,new Sa(d.pageX-f.EB,d.pageY-f.FB),e)||h;h&&L(b)},VM:function(a){var b,c,d,e=this,f=Ja(e.LM.KM),g=a.changedTouches,h=!1;for(b=0;b<g.length;b++)c=g[b],d=M?Ba():a.timeStamp,h=e.aB(c.identifier,new Sa(c.pageX-f.EB,c.pageY-f.FB),d)||h;h&&L(a)},WM:function(a){var b,c,d=this,e=Ja(d.LM.KM),f=a.changedTouches,g=!1;for(b=0;b<f.length;b++)c=f[b],g=d.RM(c.identifier,new Sa(c.pageX-e.EB,c.pageY-e.FB))||g;g&&L(a)},XM:function(a){var b,c,d=this,e=Ja(d.LM.KM),f=a.changedTouches,g=!1;for(b=0;b<f.length;b++)c=f[b],g=d.TM(c.identifier,new Sa(c.pageX-e.EB,c.pageY-e.FB))||g;g&&L(a)},YM:function(a){var b,c,d=this,e=d.LM,f=d.ZM;e!==f&&(b=x(e.KM).offset(),c=x(f.KM).offset(),a.X+=b.left-c.left,a.Y+=b.top-c.top)},$M:function(a){var b,c,d,e,f,g=this,h=g.rM;for(g.ZM=Q,g.yM=Q,c=0;c<h.length;c++)if(h[c]===a){if(d=h[c],e=Q,f=Q,d._M&&!d._M()){for(c=0;c<h.length;c++)if(b=h[c],b!==d&&b.aN>=0&&b.aN<d.aN&&(!b._M||b._M())){e=b;break}if(e===Q)return!1}if(d.bN&&!d.bN()){for(c=0;c<h.length;c++)if(b=h[c],b!==d&&b.aN>=0&&b.aN<d.aN&&(!b.bN||b.bN())){f=b;break}if(f===Q)return!1}e===Q&&(e=d),f===Q&&(f=d),g.LM=d,g.ZM=e,g.cN=f,g.vM(f.dN||Q),g.wM(e.eN||Q),g.BM(e.fN||Q),g.AM(e.gN||Q),g.xM(e.hN||Q),g.CM(f.iN||Q),g.DM(f.jN||Q),g.EM(f.kN||Q),g.FM(e.GM||Q),g.HM(e.IM||Q),e.lN&&(g.yM=d.lN);break}return!0},NM:function(a,b,c,d,e){var f=this;return f.sM[c]===R&&(!(0===f.sM.length&&!f.$M(a,b))&&(!!f.ZM&&(f.sM.length>=f.ZM.mN||(!f.yM||!f.yM.nN())&&(f.YM(d),f.yM&&0===f.sM.length&&f.yM.oN(),f.sM[c]={id:c,time:Ba(),position:d},f.sM.length++,f.tM.pN(b,c,d,e),f.tM.qN(c,d,f.sM.length,e),1===f.sM.length&&f.uM.qN(d),1===f.sM.length&&f.GM&&f.GM({rN:d}),!0))))},aB:function(a,b,c){var d=this;return d.sM[a]!==R&&((!d.yM||!d.yM.sN())&&(d.YM(b),d.sM[a]={id:a,time:Ba(),position:b},d.tM.tN(a,b,c),!0))},RM:function(a,b){var c=this;return c.sM[a]!==R&&(delete c.sM[a],c.sM.length--,(!c.yM||!c.yM.uN())&&(c.YM(b),c.tM.vN(a),c.tM.wN(a),0===c.sM.length&&(c.uM.vN(b),c.uM.wN(b)),0===c.sM.length&&c.IM&&c.IM({rN:b}),c.yM&&0===c.sM.length&&0===c.tM._process&&c.yM.zM(),!0))},TM:function(a,b){return this.RM(a,b)},xN:function(a,b){var c,d,e,f,g,h=this,i="."+a.OM,j=".gcSheet",k=ea+j,l=fa+j+i,m=ga+j+i,n="MSPointerCancel"+j+i,o="MSLostPointerCapture"+j+i,p=ha+j,q=ia+j+i,r=ja+j+i,s="LostPointerCapture"+j+i,u="pointercancel"+j+i,w=ka+j,y=la+j,z=ma+j,A="touchcancel"+j;function C(){x(sa).bind(l,F).bind(m,G).bind(q,F).bind(r,G).bind(n,H).bind(o,H).bind(s,H).bind(u,H)}function D(){x(sa).unbind(l).unbind(q).unbind(m).unbind(r).unbind(n).unbind(u).unbind(o).unbind(s)}function E(b){C(),h.MM(a,b)}function F(a){h.PM(a)}function G(a){h.QM(a),0===h.sM.length&&D()}function H(a){h.SM(a),0===h.sM.length&&D()}c=a.KM,d=h.rM,e=t.k.Cb(d,a),e>=0&&b||e<0&&!b||(f=B._Va(),b?f?(g=c.style,v(g.msTouchAction)||(g.msTouchAction=da),v(g.touchAction)||(g.touchAction=da),x(c).bind(k,E).bind(p,E)):(x(c).bind(w,function(b){h.UM(a,b)}),x(c).bind(y,function(a){h.VM(a)}).bind(z,function(a){h.WM(a)}).bind(A,function(a){h.XM(a)})):f?x(c).unbind(k).unbind(p):x(c).unbind(w).unbind(y).unbind(z).unbind(A),b?d.push(a):d.splice(e,1))},no:function(){var a,b=this,c=b.rM;for(a=c.length-1;a>=0;a--)b.xN(c[a],!1)}});function La(a,b){var c=W(b.Y,b.X)-W(a.Y,a.X);return c>X?c-=2*X:c<-X&&(c+=2*X),c}function Ma(a,b){return Z((b.X-a.X)*(b.X-a.X)+(b.Y-a.Y)*(b.Y-a.Y))}function Na(a,b,c){var d=new Sa(c._Center.X,c._Center.Y),e=new Sa(b.X-d.X,b.Y-d.Y),f=new Sa(a.X-d.X,a.Y-d.Y),g=T(1,V(Ma(b,d)/c._Radius,4)),h=La(e,f);return oa(h)?0:h*g}function Oa(a){return S(a)<=2.220446049250313e-16}function Pa(a,b){var c=!1,d=!1,e;return 0!==a&&(e=$(b/a)/X*180,e<20&&(c=!0)),0===a?d=!0:(e=$(b/a)/X*180,e>75&&e<105&&(d=!0)),{yN:c,zN:d}}function Qa(){var a=this;a.AN=0,a.BN=0,a.CN=1,a.DN=0,a.EN=0,a._process=0,a.FN=511,a.GN=new $a,a.HN=20,a.IN=new Ua}y(Qa.prototype,{pN:function(a,b,c,d){var e,f=this;3===f._process&&f.JN(!0),f.KN=2===f._process&&1===f.GN.MN(),f.NN=a,e={},e.Np=b,e.ON=c,e.PN=c,f.GN.QN(e),f.RN=d,f.GN.MN()>1&&(f.SN=!1,f.TN=!1,1===f._process&&f.UN())},qN:function(a,b,c){0===this._process&&1===c&&this.VN(this.GN.WN(0).PN)},tN:function(a,b,c){var d,f,g,h,i,j,k,l=this;if(0!==l.FN&&l.GN.XN(a)){if(1===l._process&&1===l.GN.MN()){if(d=l.YN(),!l.ZN(1)&&!l.ZN(2)&&!d)return;if(f=l.GN.$N(a).PN,Ca(b,f))return;g=S(b.X-f.X),h=S(b.Y-f.Y),l._N(g,h)}if(!(c-l.RN<e)){if(l.GN.$N(a).aO=b,i=l.GN.MN(),i>1)for(j=0;j<i;j++)if(k=l.GN.WN(j),!k.aO)return;for(l.bO(c),l.RN=c,i=l.GN.MN(),j=0;j<i;j++)k=l.GN.WN(j),k.ON=k.aO,k.aO=Q}}},wN:function(){var a=this;a.cO&&(a.dO(a.cO),a.cO=Q)},vN:function(a){var b=this;b.GN.XN(a)&&(b.GN.eO(a),2===b._process?0===b.GN.MN()&&(b.ZN(64)||b.ZN(256)||b.ZN(128)?b.fO():b.JN(!0)):2===b._process||3===b._process?b.JN(!0):1===b._process&&b.JN(!1))},bO:function(a){var b,c,d,e,f,g=this,h=g.gO(),i=h.hO,j=h.iO,k=h.SH,l=g.jO(),m=l.kO,n=l.eb,o=l.lO;if(g.AN+=i,g.BN+=j,g.CN*=n,g.DN+=m,g.EN+=o,b={},b.lO=o,b.kO=m,b.mO=a-g.RN,b.hO=i,b.iO=j,g.IN.nO(b),g.oO=k,1===g._process||2===g._process){if(1===g._process&&(c=g.UN()))return;if(d=new Za,d.pO=o,d.qO=m,d.rO=n,d.sO=new Sa(i,j),e=new Va(g.IN),f=new bb(g.NN,g.tO(),d,(!1),k,e),g.uO(f),f.vO)return void g.JN(!0)}},UN:function(){var a,b=this;return b._process=2,a=new db(b.NN,b.GN.MN(),b.tO(),b.GN.WN(0).PN),b.wO(a),!!a.vO&&(b.JN(!0),!0)},_N:function(a,b){var c=Pa(a,b);this.SN=c.yN,this.TN=c.zN},gO:function(){var a=0,b=0,c=this.xO(),d=c.yO,e=c.zO,f=new Sa(d.X,d.Y);return a=d.X-e.X,b=d.Y-e.Y,{hO:a,iO:b,SH:f}},jO:function(){var a,b=this,c=0,d=1,e=0;return b.ZN(16)&&1===b.GN.MN()&&b.YN()&&(c=Na(b.GN.WN(0).aO,b.GN.WN(0).ON,b.AO)),b.GN.MN()>1&&(a=b.BO(),c=a.kO,d=a.eb,e=a.lO),c=c/X*180,{kO:c,eb:d,lO:e}},BO:function(){var a,b,c,d,e,f,g,h,i,j,k,l=this,m=l.xO(),n=m.yO,o=m.zO,p=l.YN(),q=p?l.AO._Center:new Sa(0,0),r=0,s=1,t=0,u=0,v=0,w=0,x=0,y=l.GN.MN();for(a=0;a<y;a++)b=l.GN.WN(a),c=b.aO,d=b.ON,e=Ma(c,n),f=Ma(d,o),g=p?new Sa(d.X-q.X,d.Y-q.Y):new Sa(d.X-o.X,d.Y-o.Y),h=p?new Sa(c.X-q.X,c.Y-q.Y):new Sa(c.X-n.X,c.Y-n.Y),i=Ma(d,q),j=Ma(c,q),f>=l.HN&&e>=l.HN&&(v++,w+=e,x+=f,(!p||i>=l.HN)&&j>=l.HN&&(k=La(g,h),r+=k,u++));return u>0&&l.ZN(16)?r/=u:r=0,v>0&&l.ZN(32)?(l.KN||(s=w/x),t=(w-x)/v,l.CO=w/v):l.CO=0,{kO:r,eb:s,lO:t}},ZN:function(a){return 0!==(this.FN&a)},xO:function(){var a,b,c,d,e,f,g=0,h=0,i=0,j=0,k=this.GN,l=k.MN();for(a=0;a<l;a++)b=k.WN(a),c=b.ON,d=b.aO,g+=c.X,h+=c.Y,i+=d.X,j+=d.Y;return e=new Sa(g/l,h/l),f=new Sa(i/l,j/l),{yO:f,zO:e}},YN:function(){var a=this.AO;return a&&!oa(a._Radius)},VN:function(a){var b=this,c=new eb(b.NN,b.FN,Q,a);return c.DO=511,b.EO(c),b.FO=c.DO,0===c.DO?(b.JN(!1),!1):(b.FN=c.DO,b.AO=c.GO,b._process=1,!0)},JN:function(a){var b,c=this,d=3===c._process;c._process=0,c.HO&&(Aa(c.HO),c.HO=Q),a&&(b=new ab(c.NN,c.tO(),d,Ta(c.oO),new Va(c.IN)),3===c._process?c.cO=b:c.dO(b)),c.IN.IO(),c.GN.IO(),c.AO=Q,c.AN=0,c.BN=0,c.CN=1,c.DN=0,c.EN=0,c.SN=!1,c.TN=!1,c.FN=0},fO:function(){var a,b,c=this,d={},e=new Va(c.IN);return d.JO=c.ZN(64)?e.KO().X:0,d.LO=c.ZN(64)?e.KO().Y:0,d.MO=c.ZN(256)?e.pO():0,d.NO=c.ZN(128)?e.OO():0,0===d.JO&&0===d.LO&&0===d.MO&&0===d.NO?void c.JN(!0):(d.PO=new Ya(d.JO,d.LO),d.QO=new Wa(d.MO),d.RO=new Xa(d.NO),e=new Va(Q,d.JO,d.LO,d.NO,d.MO),a=new cb(c.NN,c.tO(),new Za,e,d.QO,d.RO,d.PO),c.SO(a),d.PO=a.TO,d.QO=a.QO,d.RO=a.RO,d.PO.UO<=0&&d.PO.VO<=0&&d.PO.WO(.003),d.QO.XO()<=0&&d.QO.WO(.002),d.RO.XO()<=0&&d.RO.WO(.003),b=Ba(),d.YO=b,d.ZO=b,d.$O=0,d._O=0,c._process=3,void(c.HO=setInterval(function(){try{c.aP(d)}catch(a){}},20)))},aP:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=Ba(),q=p-a.ZO;if(0!==q){if(b=a.JO,c=a.LO,d=a.MO,e=a.NO,a.JO=o.bP(q,a.PO.UO,a.JO),a.LO=o.bP(q,a.PO.VO,a.LO),a.MO=o.bP(q,a.QO.XO(),a.MO),a.NO=o.bP(q,a.RO.XO(),a.NO),b=(b+a.JO)/2,c=(c+a.LO)/2,d=(d+a.MO)/2,e=(e+a.NO)/2,a.ZO=p,f=!1,Oa(b)&&Oa(c)&&Oa(d)&&Oa(e)&&(f=!0),g=q*b,h=q*c,i=q*d,j=q*e,k=1,o.CO>0&&(o.CO+2*i<0&&(i=-o.CO/2+1),0!==o.CO&&(k=(o.CO+2*i)/o.CO)),o.EN+=i,o.DN+=j,o.AN+=g,o.BN+=h,o.CN*=k,o.CO+=i,o.oO=new Sa(o.oO.X+g,o.oO.Y+h),a.$O+=g,a._O+=h,f){if(g=Y(a.$O),h=Y(a._O),Oa(g)&&Oa(h))return void o.JN(!0)}else S(a.$O)>=1&&(g=a.$O,a.$O-=g),S(a._O)>=1&&(h=a._O,a._O-=h);return l=new Za,l.sO=new Sa(g,h),l.rO=k,l.pO=i,l.qO=j,m=new Va(Q,a.JO,a.LO,a.NO,a.MO),n=new bb(o.NN,o.tO(),l,(!0),Ta(o.oO),m),o.uO(n),n.vO?void o.JN(!0):void(f&&o.JN(!0))}},bP:function(a,b,c){if(Oa(c))return 0;var d;return d=c<0?c+b*a:c-b*a,(d<0&&c>0||d>0&&c<0)&&(d=0),d},tO:function(){var a=this,b=new Za;return b.pO=a.EN,b.qO=a.DN,b.rO=a.CN,b.sO=new Sa(a.AN,a.BN),b},cP:function(a,b,c,d){var e,f=this,g=new Za,h=new Za,i=0,j=0,k=0,l=0,m=f.ZN(4)&&f.SN,n=f.ZN(8)&&f.TN;return!f.ZN(1)||n||a&&!f.ZN(64)||(g.sO.X=b.sO.X,h.sO.X=c.sO.X,i=d.KO().X),!f.ZN(2)||m||a&&!f.ZN(64)||(g.sO.Y=b.sO.Y,h.sO.Y=c.sO.Y,j=d.KO().Y),!f.ZN(32)||a&&!f.ZN(256)?(g.rO=b.rO,h.rO=1):(g.rO=b.rO,g.pO=b.pO,h.rO=c.rO,h.pO=c.pO,l=d.pO()),!f.ZN(16)||a&&!f.ZN(128)||(g.qO=b.qO,h.qO=c.qO,k=d.OO()),e=new Va(Q,i,j,k,l),new _a(g,h,e)},EO:function(a){this.vM&&a&&this.vM(a)},wO:function(a){this.wM&&a&&this.wM(a)},dO:function(a){var b,c=this;c.xM&&a&&(b=c.cP(!1,a.dP,a.dP,a.eP),a.dP=b.dP,a.eP=b.eP,c.xM(a))},SO:function(a){var b,c=this;c.AM&&a&&(b=c.cP(!1,a.dP,a.fP,a.eP),a.dP=b.dP,a.fP=b.fP,a.eP=b.eP,c.AM(a))},uO:function(a){var b,c=this;c.BM&&a&&(b=c.cP(a.gP,a.dP,a.fP,a.eP),a.dP=b.dP,a.fP=b.fP,a.eP=b.eP,c.BM(a))}});function Ra(){}y(Ra.prototype,{qN:function(a){var c,d=this;d._pointerCount++,d._pointerCount>1||(c=Ba(),d.hP&&Ca(a,d.hP)&&c-d.iP<b?d.Jb++:(d.hP=a,d.Jb=1),d.jP=a,d.iP=c)},wN:function(){var a=this;a.cO&&(a.cO instanceof fb?a.kP(a.cO):a.cO instanceof gb&&a.lP(a.cO),a.cO=Q)},vN:function(a){var b,c=this;c._pointerCount--,c._pointerCount>0||(b=Ba(),Ca(a,c.jP)?b-c.iP>d?c.cO=new gb(c.jP):c.Jb>1?(c.Jb=0,c.mP(new hb(c.hP)),c.hP=Q):c.cO=new fb(c.jP):c.hP=Q)},nP:function(){this.hP=Q},kP:function(a){this.CM&&a&&this.CM(a)},mP:function(a){this.DM&&a&&this.DM(a)},lP:function(a){this.EM&&a&&this.EM(a)}});function Sa(a,b){this.X=a,this.Y=b}function Ta(a){return new Sa(a?Y(a.X):-1,a?Y(a.Y):-1)}s.oP=Sa;function Ua(){var a=this;a.Jb=0,a.oI=0,a.pP=10,a.qP=[]}y(Ua.prototype,{rP:function(a){var b,c,d,e,f,g,h=this;if(0===h.Jb)return 0;for(b=0,c=(1+h.Jb)*h.Jb/2,d=h.Jb-1;d>=0;d--)e=0,f=h.sP(d),0===a?e=f.hO:1===a?e=f.iO:2===a?e=f.lO:3===a&&(e=f.kO),g=h.tP(e,f.mO),g*=d+1,b+=g;return b/c},tP:function(a,b){return a/b},sP:function(a){return this.qP[this.uP(a)]},vP:function(){return this.qP[this.Jb-1]},nO:function(a){var b,c,d=this;for(10===d.Jb&&d.wP(),d.Jb++,d.qP[d.uP(d.Jb-1)]=a,b=e*d.pP,c=0;c<d.Jb;c++)a.mO-d.qP[c].mO>b&&(d.wP(),c--)},wP:function(){var a=this;a.oI++,a.oI===a.pP&&(a.oI=0),a.Jb--},IO:function(){this.Jb=0},uP:function(a){return(this.oI+a)%this.pP}});function Va(a,b,c,d,e){var f=this;a?f.qP=a:(f.xP=new Sa(b,c),f.yP=d,f.lO=e)}y(Va.prototype,{KO:function(){var a=this;return a.xP||(a.xP=new Sa(a.qP.rP(0),a.qP.rP(1))),a.xP},OO:function(){var a=this;return v(a.yP)&&(a.yP=a.qP.rP(3)),a.yP},pO:function(){var a=this;return v(a.lO)&&(a.lO=a.qP.rP(2)),a.lO}});function Wa(a){this.zP=a,this.AP=0}y(Wa.prototype,{XO:function(){var a=this,b=a._DesiredExpansion,c=a._DesiredDeceleration,d=a.zP;return oa(b)||0===b?oa(c)?a.AP:c:.5*d*d/b},WO:function(a){this.AP=a}});function Xa(a){this.zP=a,this.AP=0}y(Xa.prototype,{XO:function(){var a=this,b=a._DesiredRotation,c=a._DesiredDeceleration,d=a.zP;return oa(b)||0===b?oa(c)?a.AP:c:.5*d*d/b},WO:function(a){this.AP=a}});function Ya(a,b){var c=this;c.BP=a,c.CP=b,c.UO=0,c.VO=0,c.AP=0,c.DP=Z(a*a+b*b)}y(Ya.prototype,{EP:function(){var a=this,b=a._DesiredDisplacement,c=a.DP,d=a.BP,e=a.CP,f=a.XO();oa(b)||0===b?oa(f)||0===f?(a.UO=0,a.VO=0):(a.UO=f*S(d)/c,a.VO=f*S(e)/c):(a.UO=.5*c*S(d)/b,a.VO=.5*c*S(e)/b)},XO:function(){var a=this,b=a._DesiredDeceleration;return oa(b)&&oa(a._DesiredDisplacement)?a.AP:b},WO:function(a){this.AP=a,this.EP()}});function Za(){var a=this;a.sO=new Sa(0,0),a.rO=0,a.qO=0,a.pO=0}function $a(){this.FP=[]}y($a.prototype,{XN:function(a){var b,c,d=this.FP;for(b=0;b<d.length;b++)if(c=d[b],c.Np===a)return!0;return!1},QN:function(a){this.FP.push(a)},eO:function(a){var b,c=this.FP;for(b=0;b<c.length;b++)if(c[b].Np===a){c.splice(b,1);break}},MN:function(){return this.FP.length},WN:function(a){return this.FP[a]},$N:function(a){var b,c,d=this.FP;for(b=0;b<d.length;b++)if(c=d[b],c.Np===a)return c;return Q},IO:function(){var a=this.FP;a.splice(0,a.length)}});function _a(a,b,c){var d=this;d.dP=a,d.fP=b,d.eP=c}function ab(a,b,c,d,e){var f=this;f.GP=a,f.dP=b,f.gP=c,f.rN=d,f.eP=e}function bb(a,b,c,d,e,f){var g=this;g.GP=a,g.dP=b,g.fP=c,g.gP=d,g.rN=e,g.eP=f}function cb(a,b,c,d,e,f,g){var h=this;h.GP=a,h.dP=b,h.fP=c,h.eP=d,h.QO=e,h.RO=f,h.TO=g}function db(a,b,c,d){var e=this;e.GP=a,e.HP=b,e.dP=c,e.rN=d}function eb(a,b,c,d){var e=this;e.GP=a,e.DO=b,e.GO=c,e.rN=d}function fb(a){this.rN=a}function gb(a){this.rN=a}function hb(a){this.rN=a}function ib(a,b){var c=a*b;return c>4?c=4:c<.5&&(c=.5),c}function jb(a){this.kj=a}y(jb.prototype,{IP:function(a,b){var c=this.Xs;return c?a===G.Nn(c)&&b===G.On(c)||G.Pn(c,a,b):(c=C("canvas"),G.Kn(c,Q,this.kj),G.Pn(c,a,b)),c},JP:function(a,b,c,d){var e=this,f=G.Nn(a),g=G.On(a),h=e.IP(f,g),i=h.getContext("2d"),j=G.Ln(h),k=G.Mn(h);wa.Cn(i,1,1),i.drawImage(a,0,0,za(h),ya(h),0,0,za(h),ya(h)),wa.Cn(i,j,k),e.Xs=h,e.KP=b,e.LP=c,e.MP=d},NP:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this,o=n.kj,p=G.Nn(a),q=G.On(a),r=Fa(o),s=Ga(o),t=r>0?1:0,u=s>0?1:0,v=n.LP,w=tb(o),x=n.KP,y=o.am(),z=b/n.MP,A=a.getContext("2d"),B=G.Ln(a),C=G.Mn(a),D=n.Xs;A.save(),A.fillStyle=c,A.fillRect(0,0,p,q),l=o.rowOutlines,m=o.columnOutlines,l&&l.jp(o,A,Q,!0),m&&m.jp(o,A,Q,!1),d=v.x+za(v),e=v.y+ya(v),f=x.lt-d-t,g=x.ot-e-u,h=w.x+za(w),i=w.y+ya(w),j=f*z,k=g*z,d*=B,e*=C,f*=B,g*=C,h*=B,i*=C,j*=B,k*=C,wa.Cn(A,1,1),A.drawImage(D,d,e,f,g,h,i,j,k),r>0&&(d=x.lt-t,e=v.y+ya(v),f=x.js+t,g=x.ot-e-u,h=y.lt-t,i=w.y+ya(w),j=y.js+t,k=g*z,d*=B,e*=C,f*=B,g*=C,h*=B,i*=C,j*=B,k*=C,A.drawImage(D,d,e,f,g,h,i,j,k)),s>0&&(d=v.x+za(v),e=x.ot-u,f=x.lt-d-t,g=x.gs+u,h=w.x+za(w),i=y.ot-u,j=f*z,k=y.gs+u,d*=B,e*=C,f*=B,g*=C,h*=B,i*=C,j*=B,k*=C,A.drawImage(D,d,e,f,g,h,i,j,k)),r>0&&s>0&&(d=x.lt-t,e=x.ot-u,f=x.js+t,g=x.gs+u,h=y.lt-t,i=y.ot-u,j=y.js+t,k=y.gs+u,d*=B,e*=C,f*=B,g*=C,h*=B,i*=C,j*=B,k*=C,A.drawImage(D,d,e,f,g,h,i,j,k)),wa.Cn(A,B,C),A.restore()},OP:function(){var a=this,b=a.kj,c=b.zoom(),d=b.yl.vI();d&&a.JP(d.canvas,b.am(),tb(b),c)},PP:function(a){var b,c,d,e=this,f=e.kj;f.endEdit()&&(b=ib(a,e.MP),f.zoom()!==b&&(f.Wq(I.UserZooming,{sheet:f,sheetName:f.name(),oldZoomFactor:f.zoom(),newZoomFactor:b}),f.XSa(b),f.invalidateLayout(),c=f.yl,d=c.bm(),d&&e.NP(d.canvas,b,c.zI(!1)),f.QP&&f.QP(Q,b),f.RP&&f.RP(Q)))},SP:function(a){var b=this,c=b.kj;c.XSa(ib(a,b.MP)),c.oq=!0,c.jq=!0,c.$p()}}),s.TP=jb,f=200,g=20;function kb(a,b,c){var d=c,e=0,f=0,g=a.ss,h,i,j=a.am().qt,k=a.jt(1).findRow(d);if(k)if(b>0){for(h=a.Rt(-1),e=j-k.y;d>h&&e<b;)d--,e+=g.Sl(d);f=b-e}else if(b<0){for(i=a.ns(),e=-(k.y+ya(k)-j);d<i&&e>b;)d++,e-=g.Sl(d);f=b-e}return{cj:d,UP:f}}function lb(a,b,c){var d=c,e=0,f=0,g,h,i=a.ss,j=a.am().pt,k=a.it(1).findCol(d);if(k)if(b>0){for(g=a.Ot(-1),e=j-k.x;d>g&&e<b;)d--,e+=i._m(d);f=b-e}else if(b<0){for(h=a.ps(),e=-(k.x+za(k)-j);d<h&&e>b;)d++,e-=i._m(d);f=b-e}return{dj:d,UP:f}}function mb(a,b){return pa(-b/(a/b+1)+b)}function nb(a,b){return pa(b*(-b/(a-b)-1))}function ob(a,b,c,d,e,f){a.fillStyle=b,a.fillRect(c,d,e,f)}function pb(a,b,c,d,e){var f,g,h,i,j,k=D.Km(0,"gc-columnHeader-normal"),l=k&&k.backgroundImage,m=k&&k.backgroundColor;if(l&&l.indexOf("linear-gradient")!==-1)for(g=B.wl(l),f=a.createLinearGradient(b+d/2,c,b+d/2,c+e),h=0,i=g.length;h<i;h++)j=g[h],f.addColorStop(j.point,j.color);else m&&(f=m);return f}function qb(){var a=D.Km(0,"gc-rowHeader-normal");return a&&a.backgroundColor}function rb(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p=a.am(),q=a.yl,r=a.options,s=r.sheetAreaOffset,t=s.left,u=s.top,v=q.zI(!1),w=q.bm(),x=q.vI(),y=a.jt(1),z=tb(a),A=p.zr,B=t>=1?1:0,C=u>=1?1:0,D=za(p),E=a.Rt(-1),F=y.findRow(E);F&&(c=p.qt,d=F.y-c-1-C,d>0&&(b?(e=p.Br,f=qb(),ob(w,f,A,c,e-1,d+1),ob(x,f,A,c,e-1,d+1),ob(w,v,A+e,c,D-e-z.width,d),ob(x,v,A+e,c,D-e-z.width,d)):(ob(w,v,A,c,D,d),ob(x,v,A,c,D,d)))),g=a.Rt(Ia(a),!0),h=y.findRow(g),h&&(c=h.y+ya(h),d=p.ot-c-1-C,d>0&&(ob(w,v,A,c,D,d),ob(x,v,A,c,D,d))),i=a.it(1),c=p.Ar,d=ya(p),j=a.Ot(-1),k=i.findCol(j),k&&(A=p.pt,D=k.x-A-1-B,D>0&&(b?(l=p.Cr,m=pb(w,A,c,D+1,l-1),ob(w,m,A,c,D+1,l-1),ob(x,m,A,c,D+1,l-1),ob(w,v,A,c+l,D,d-l-z.height),ob(x,v,A,c+l,D,d-l-z.height)):(ob(w,v,A,c,D,d),ob(x,v,A,c,D,d)))),n=a.Ot(Ha(a),!0),o=i.findCol(n),o&&(A=o.x+za(o),D=p.lt-A-1-B,D>0&&(ob(w,v,A,c,D,d),ob(x,v,A,c,D,d)))}function sb(a,b,c,d,e,f){a.beginPath(),a.strokeStyle=b,a.moveTo(c,d),a.lineTo(e,f),a.stroke()}function tb(a){var b=a.options,c=b.sheetAreaOffset;return a.Gt&&a.Gt()||{x:c.left,y:c.top,width:0,height:0}}function ub(a,b){var c,d,e,f,g,h,i,j=a.am(),k=a.yl,l=k.bm(),m=a.jt(1),n=tb(a),o=a.Rt(-1),p=m.findRow(o),q=N("gc-group").color;p&&(c=j.qt,d=p.y-c,d>0&&b&&n.width>0&&0===j.Br&&sb(l,q,j.kt-.5,c,j.kt-.5,p.y)),e=a.it(1),f=a.Ot(-1),g=e.findCol(f),g&&(h=j.pt,i=g.x-h,i>0&&b&&n.height>0&&0===j.Cr&&sb(l,q,h,j.nt-.5,g.x,j.nt-.5))}function vb(a,b){var c,d,e,f,g,h=a.am(),i=a.yl,j=a.options.gridline.color,k=D.Km(0,"gc-columnHeader-normal"),l=k&&k.borderBottomColor,m=i.bm(),n=a.jt(1),o=tb(a),p=h.zr,q=za(h),r=a.Rt(-1),s=n.findRow(r);s&&(c=h.qt,d=s.y-c,d>0&&(sb(m,j,p,s.y-.5,p+q-o.width,s.y-.5),b&&(0===o.width&&sb(m,j,h.zr-.5,c,h.zr-.5,s.y),sb(m,l,h.kt-.5,c,h.kt-.5,s.y)))),e=a.it(1),c=h.Ar,d=ya(h),f=a.Ot(-1),g=e.findCol(f),g&&(p=h.pt,q=g.x-p,q>0&&(sb(m,j,g.x-.5,c,g.x-.5,c+d-o.height),b&&(0===o.height&&sb(m,j,p,h.Ar-.5,g.x,h.Ar-.5),sb(m,l,p,h.nt-.5,g.x,h.nt-.5))))}function wb(a,b){var c=0;return a||(c|=1),b||(c|=2),c}function xb(a){this.kj=a}function yb(a,b){for(var c,d=new K,e=a.ss,f=a.am(),g=U(a.frozenColumnCount(),a.qq),h=Ha(a)-Fa(a),i=f.pt+b,j=f.er-b;j>0&&g<h;g++)c=e._m(g),d.push(new J((-1),g,i,(-1),c,(-1))),i+=c,j-=c;return d}function zb(a,b){for(var c,d=new K,e=a.ss,f=a.am(),g=U(a.frozenRowCount(),a.lq),h=Ia(a)-Ga(a),i=f.qt+b,j=f.jr-b;j>0&&g<h;g++)c=e.Sl(g),d.push(new J(g,(-1),(-1),i,(-1),c)),i+=c,j-=c;return d}function Ab(a,b){var c=0;return c|=0!==a?1:0,c|=0!==b?2:0}y(xb.prototype,{VP:function(a){var b=this.kj,c=b.bs;c.viewport||(c.viewport={}),c.viewport[1]=yb(b,a)},WP:function(a){var b=this.kj,c=b.as;c.viewport||(c.viewport={}),c.viewport[1]=zb(b,a)},XP:function(){var a=this.kj,b=a.bs.viewport,c=a.as.viewport;a.invalidateLayout(),a.bs.viewport=b,a.as.viewport=c},ju:function(a,b,c,d){var e,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=this,x=w.kj,y=x.options,z=x.lq,A=kb(x,a,z),B=A.cj,C=A.UP;if(x.lq=B,x.Xq>0)return!1;if(e=x.Dr(),h=x.am(),i=h.qt,j=h.jr,k=e?e.x:h.x,l=za(h),p=y.sheetAreaOffset,l+=p.left,a<0)w.YP=0,w.ZP=0,s=x.jt(1),s&&s.length>0&&(q=s.findRow(B)),q&&(r=s[s.length-1],r.row>=B&&(m=p.top,n=i+S(a),o=T(i+j,r.y+ya(r))-n,o>=0&&(o-=m,w.WP(C-ya(q)),c.x=k,c.y=n,c.width=l,c.height=o,c.tx=k,c.ty=i,d.x=k,d.y=i+o,d.width=l,d.height=j-o)));else if(a>0){if(t=x.Rt(-1),B===t&&C>0)if(w.YP>0&&w.ZP>0){if(u=w.YP+a,v=mb(u,f),a=v-w.ZP,C=v,a<=0)return b;if(b&&v>=g)return!0;w.YP=u,w.ZP=v}else{if(C>=f&&(a-=C-(f-1),C=f-1,a<=0))return b;if(u=nb(C,f),v=C,b&&v>=g)return!0;w.YP=u,w.ZP=v}else w.YP=0,w.ZP=0;a<j&&(m=p.top,n=i,o=j-a,Ga(x)>0&&(o-=1),w.WP(C),c.x=k,c.y=n,c.width=l,c.height=o,c.tx=k,c.ty=n+a,d.x=k,d.y=n,d.width=l,d.height=a+m)}return!1},lu:function(a,b,c,d){var e,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=this,x=w.kj,y=x.qq,z=lb(x,a,y),A=z.dj,B=z.UP;if(x.qq=A,x.Xq>0)return!1;if(e=x.Dr(),h=x.am(),i=h.pt,j=h.er,k=e?e.y:h.y,l=ya(h),r=x.options.sheetAreaOffset,l+=r.top,a<0)w.$P=0,w._P=0,u=x.it(1),u&&u.length>0&&(s=u.findCol(A)),s&&(t=u[u.length-1],t.col>=A&&(m=r.left,n=i+S(a),o=T(i+j,t.x+za(t))-n,o>=0&&(o-=m,w.VP(B-za(s)),c.x=n,c.y=k,c.width=o,c.height=l,c.tx=i,c.ty=k,d.x=i+o,d.y=k,d.width=j-o,d.height=l)));else if(a>0){if(v=x.Ot(-1),A===v&&B>0)if(w.$P>0&&w._P>0){if(p=w.$P+a,q=mb(p,f),a=q-w._P,B=q,a<=0)return b;if(b&&q>=g)return!0;w.$P=p,w._P=q}else{if(B>=f&&(a-=B-(f-1),B=f-1,a<=0))return b;if(p=nb(B,f),q=B,b&&q>=g)return!0;w.$P=p,w._P=q}else w.$P=0,w._P=0;a<j&&(m=r.left,n=i,o=j-a,Fa(x)>0&&(o-=1),w.VP(B),c.x=n,c.y=k,c.width=o,c.height=l,c.tx=n+a,c.ty=k,d.x=n,d.y=k,d.width=a+m,d.height=l)}return!1},aQ:function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=this,y=x.kj,z=!0,A=!0,B=y.yl,C=B.bm(),D=0!==(2&c),F=0!==(1&c);if(F||D)return i=y.Dr(),j=y.am(),k=i?i.y:j.y,l=ya(j),m=i?i.x:j.x,n=za(j),D&&(f={},e={},z=x.ju(b,d,e,f),B.Ow(e.x,e.y,za(e),ya(e),e.tx,e.ty)),F&&(g={},h={},A=x.lu(a,d,g,h),B.Ow(g.x,g.y,za(g),ya(g),g.tx,g.ty),D||(f=h)),o=y.parent,o&&!o.options.scrollbarShowMax&&(F&&(y.oq=!0),D&&(y.jq=!0)),x.XP(),p=y.rowOutlines&&!y.rowOutlines.iT()?1:0,q=y.columnOutlines&&!y.columnOutlines.iT()?1:0,F&&D?B._l(C,new E(f.x,f.y,za(f),ya(f)+p),new E(h.x,h.y,za(h)+q,ya(h))):B._l(C,new E(f.x,f.y,za(f)+q,ya(f)+p)),r=new E(m,k,n,l),s=y.getSelections(),s&&s.length>0&&(t=y.getRangeRect(1,1,s[0]),u=U(r.x+r.width,t.x+t.width),v=U(r.y+r.height,t.y+t.height),r.x=T(r.x,t.x),r.y=T(r.y,t.y),r.width=u-r.x+1,r.height=v-r.y+1),B.Pw(C,r),vb(y,!0),rb(y,!0),x.bQ(F,D),ub(y,!0),w=y.options.sheetAreaOffset,y.options.rowHeaderVisible||B.t_a(C,new E(m,k,2,l+w.top)),y.options.colHeaderVisible||B.t_a(C,new E(m,k,n+w.left,2)),z&&A},bQ:function(a,b){var c,d=this.kj;b&&d.os(),a&&d.qs(),d.mm.Qw(),c=d.ITa.Ky,c&&c.cQ()},dQ:function(a,b,c){function d(a,b,c,d){return a/=c,V(.75,a)*d*(b?1:-1)}function e(a,b,c){return a=S(a),a/=c,_(a)/_(.75)*b}var g=this,h=g.kj,i=f,j=10,k=20,l=100,m=e(a,j,i),n=e(b,j,i),o=a,p=b,q=0,r=0,s=!1,t=!1;g.jI=setInterval(function(){var e,f,u,v,w;return s&&t?(h.ss.jn(),e=h.parent,e&&!e.options.scrollbarShowMax&&(h.oq=!0,h.jq=!0),h.ss.kn(),h.$p(),h.qs(),h.os(),Aa(g.jI),void(g.jI=Q)):(m+=k,n+=k,void(m>l&&n>l?(g.aQ(a-q,b-r,wb(s,t),c),s=!0,t=!0):(m>l&&!s&&(g.aQ(a-q,0,1,c),s=!0),n>l&&!t&&(g.aQ(0,b-r,2,c),t=!0),f=d(m,a>0,j,i),u=d(n,b>0,j,i),v=aa(o-f),w=aa(p-u),g.aQ(v,w,wb(s,t),c),o=f,p=u,q+=v,r+=w)))},k)},qG:function(a){var b=this,c=b.kj,d=c.ss;b.jI&&(d.kn(),Aa(b.jI),b.jI=Q),b.$P=0,b._P=0,b.YP=0,b.ZP=0,b.eQ=c.lq,b.fQ=c.qq,a&&d.hn()},NG:function(a,b){var c=pa(a.X),d=pa(a.Y),e=Ab(c,d);return this.aQ(c,d,e,b)},gQ:function(a){var b,c,d,e,f,g,h,i,j=this,k=j.kj,l=k.am(),m=l.pt,n=l.qt,o=k.lq,p=k.qq,q=k.it(1),r=k.ps();q&&q.length>0&&(b=q.findCol(p),p<r&&b&&b.x+za(b)-m<za(b)/2&&p++),c=k.jt(1),e=k.ns(),c&&c.length>0&&(d=c.findRow(o),o<e&&d&&d.y+ya(d)-n<ya(d)/2&&o++),f=0,g=0,q&&q.length>0&&(b=q.findCol(p),f=m-b.x),c&&c.length>0&&(d=c.findRow(o),g=n-d.y),h=j.eQ,o!==h&&k.mq(o),i=j.fQ,p!==i&&k.rq(p),j.dQ(f,g,a)}});function Bb(a,b,c,d,e){var f,g,h,i,j,k=a.parent,l=a.mm,m=a.options,n=b.rowViewportIndex,o=b.colViewportIndex,p=Ea(a),q=Q;return a.CH&&p.length>0&&(f=p[p.length-1],g=f.row,h=f.row+f.rowCount-1,i=f.col,j=f.col+f.colCount-1,k&&!k.options.allowUserResize||(g!==-1&&i===-1&&n>=0&&o<0&&m.rowHeaderVisible?(q=l.mH(a,b,e,2,d),!q||"sizeRow"!==q.action&&"sizeHiddenRow"!==q.action||2!==q.sheetArea||q.index===h||(q=Q)):g===-1&&i!==-1&&n<0&&o>=0&&m.colHeaderVisible&&(q=l.oH(a,b,e,1,c),!q||"sizeCol"!==q.action&&"sizeHiddenCol"!==q.action||1!==q.sheetArea||q.index===j||(q=Q)))),q}function Cb(a,b,c,d){var e,f,g,h,i,j,k,l,m;if(0===a.selectionPolicy())return Q;for(e=b.hitTestType,f=Xb(a),g=Ea(a),h=3,a.CH&&g.length>0&&(i=g[g.length-1],i.row!==-1&&i.col!==-1?h=3:i.row!==-1?h=2:i.col!==-1&&(h=1)),j=0;j<f.length;j++)if(k=f[j],k&&(k.x-=za(k),k.y-=ya(k),k.width*=3,k.height*=3,k.contains(c,d)))return v(b.row)&&(l=a.jt(1),l&&l.length>0&&(b.row=l[l.length-1].row)),v(b.col)&&(m=a.it(1),m&&m.length>0&&(b.col=m[m.length-1].col)),{x:c,y:d,type:h,isHeader:!1,isFirstIndicator:0===j};return 1===e?{x:c,y:d,type:1,isHeader:!0}:2===e?{x:c,y:d,type:2,isHeader:!0}:Q}function Db(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q=Q,r=b.rowViewportIndex,s=b.colViewportIndex;if(v(r)||v(s))return q;if(e=a.parent,f=a.Ix(),r>=0&&s>=0&&1===a.ITa.getSelections().length){if(g=a.Tq(f),h=Fa(a),i=Ga(a),j=Ha(a)-h,k=Ia(a)-i,1===s&&h>0&&g.col<j&&g.col+g.colCount>j&&(l=a.Hr(s),l&&l.length>0&&(m=l[l.length-1],c>m.x+za(m))))return q;if(1===r&&i>0&&g.row<k&&g.row+g.rowCount>k&&(n=a.Gr(r),n&&n.length>0&&(o=n[n.length-1],d>o.y+ya(o))))return q}return p=Ub(a),p&&(q||(p.x-=za(p),p.y-=ya(p),p.width*=3,p.height*=3,p.contains(c,d)&&(q={action:"drag",side:"corner"})),e&&e.options.allowUserDragFill||q&&"corner"===q.side&&(q.side=Q)),q}function Eb(a,b,c,d){var e,f,g,h,i,j,k,l,m=!1,n=a.ITa.getSelections();for(e=0,f=n.length;e<f;e++){if(g=n[e],h=3===d||v(d),h&&(g=a.Tq(g)),i=g.row,j=g.col,k=g.rowCount,l=g.colCount,h)m=i<=b&&b<i+k&&j<=c&&c<j+l;else if(2===d)m=j===-1&&i<=b&&b<i+k;else if(1===d)m=i===-1&&j<=c&&c<j+l;else if(0===d)return m;if(m)break}return m}function Fb(a,b,c,d){if(!b){var e=Ea(a),f=e[e.length-1];c?3===d?(a.Jl=f.row+f.rowCount-1,a.Kl=f.col+f.colCount-1):2===d?(a.Jl=f.row+f.rowCount-1,a.Kl=0):1===d&&(a.Jl=0,a.Kl=f.col+f.colCount-1):3===d?(a.Jl=f.row,a.Kl=f.col):2===d?(a.Jl=f.row,a.Kl=0):1===d&&(a.Jl=0,a.Kl=f.col)}}function Gb(a,b,c,d){var e=Ea(a),f=e[e.length-1];(b||c)&&(3===d?(a.Jl=f.row,a.Kl=f.col):2===d?(a.Jl=f.row,a.Kl=0):1===d&&(a.Jl=0,a.Kl=f.col))}function Hb(a){var b=this;b.KN=!1,b.hQ=new jb(a),b.iQ=new xb(a),b.kj=a}y(Hb.prototype,{jQ:function(a){var b=this,c=b.kj,d=c.am(),e=d.pt,f=d.qt,g=d.lt,h=d.ot,i=a.rN,j=0,k=b.kQ(i.X,i.Y),l=k.dragInfo,m=k.x,n=k.y;k&&(k.resizeInfo||l&&"corner"===l.side||k.selectionHitInfo)?(j|=2,j|=1):(f<=n&&n<h&&(j|=2),e<=m&&m<g&&(j|=1),j|=96,c.parent&&(j|=12)),a.DO=j},lQ:function(a){var b,c,d,e,f=this,g=a.rN,h=f.kj,i=h.parent,j=h.mm,k=h.yl,l=f.kQ(g.X,g.Y),m=l.dragInfo,n=l.selectionHitInfo;if(h.yt=l,l.resizeInfo){if(!h.endEdit())return;j.fG(l)}else if(m&&"corner"===m.side)j.hG&&j.hG(l);else if(n){if(!h.endEdit())return;b=n.isHeader,c=n.isFirstIndicator,d=n.type,b&&j.ZG(l,!0),e=l.hitTestType,l.hitTestType=d,j.bH(l),l.hitTestType=e,Fb(h,b,c,d),h.mQ=!1,k.DH()}else h.nQ&&(h.nQ().oQ=!1),h.mQ=!1,k.DH(),a.HP>1&&i&&i.options.allowUserZoom?(f.KN=!1,f.hQ.OP()):(f.KN=!0,f.iQ.qG(1===a.HP))},pQ:function(a){var b,c,d,e,f=this,g=a.rN,h=f.kj,i=h.mm,j=h.yt,k=g.X,l=g.Y;if(j)if(b=j.dragInfo,c=j.selectionHitInfo,j.resizeInfo)i.$F={e:a,x:k,y:l},i.WG();else if(b&&"corner"===b.side)i.$F={e:a,x:k,y:l},i.CG&&i.CG();else if(c||i.xG){if(c){if(!i.rG||!i.OG)return;if(i.DA===!0)return;d=c.type,i.$F={e:a,x:k,y:l},3===d?i.cH():2===d?i.dH():1===d&&i.eH()}}else f.KN?a.vO=f.iQ.NG(a.fP.sO,a.gP):(e=a.dP.rO,f.hQ.PP(e))},qQ:function(a){var b,c,d,e=this,f=e.kj,g=f.mm;f.mQ=!0,b=f.yt,c=b.selectionHitInfo,b.resizeInfo?g.YG():b.dragInfo&&g.BG?(g.xH&&g.xH(),f.parent.touchToolStrip.rQ()):c||g.xG?(g.hH(),c&&Gb(f,c.isHeader,c.isFirstIndicator,c.type),f.yl.im()):(f.nQ&&(f.nQ().oQ=!0),e.KN?e.iQ.gQ(a.gP):(d=a.dP.rO,e.hQ.SP(d)))},sQ:function(a){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,w,x,y,z,A,B,C=this,D=a.rN,E=C.kj,F=E.parent,G=!1;if(E.Uja=R,C.tQ(),E.uQ&&E.uQ(),c=E.ITa.Ky,c&&c.vQ(),d=E.mm,e=C.kQ(D.X,D.Y,!0),f=e.filterButtonHitInfo,g=e.hitTestType,h=e.row,i=e.col,j=e.outlineHitInfo)E.isEditing()||(k=j.what,l=E.rowOutlines,m=E.columnOutlines,"rg"===k||"rgh"===k?l&&l.UL(E,j):"cg"!==k&&"cgh"!==k||m&&m.UL(E,j));else if(E.yt=e,f){if(!E.endEdit())return;n=f.rowFilter,n&&n.openFilterDialog(f)}else if(e.resizeInfo);else if(E.Qs(e.rowViewportIndex<0?-1:h,e.colViewportIndex<0?-1:i)){if(E.wQ&&!d.BG&&F.touchToolStrip.rQ(),o=E.getActiveRowIndex(),p=E.getActiveColumnIndex(),q=e.cellTypeHitInfo){if(r=E.getCellType(q.row,q.col,g),q.sheet||(q.sheet=E),C.Sia(r,q))if(s=q.sheetArea,!v(s)&&3!==s||h===o&&i===p)E.yl.DH();else{if(E.suspendPaint(),!E.endEdit())return;if(t={sheet:E,sheetName:E.name(),row:o,col:p,cancel:!1},E.Wq(I.LeaveCell,t),t&&t.cancel===!0)return;u=E.ITa.getSelections(),w=E.ITa.getSpan(h,i),x=[H(w.row,w.col,w.rowCount,w.colCount)],E.yu(u,x),y=q.isReservedLocation&&q.isFocusAware,E.Sr(h,i,R,R,y?0:1),z={sheet:E,sheetName:E.name(),row:h,col:i},E.Wq(I.EnterCell,z),E.Wq(I.FormulatextboxEnterCell,z),E.Au(u),E.Uja=!0,d.cs&&d.cs(h,i),E.resumePaint(),G=!0}r.processCellAndPaddingMouseDown(q),r.processMouseUp(q)}if(q&&q.isReservedLocation)return!0;E.Wq(I.CellClick,{sheet:E,sheetName:E.name(),sheetArea:g,row:e.row,col:e.col});try{if(d.mG=e,E.isEditing()&&o===E.getActiveRowIndex()&&p===E.getActiveColumnIndex()&&!E.endEdit())return}finally{d.mG=Q}if(v(h)||v(i))return;3===g&&d.cs&&d.cs(h,i),Eb(E,h,i,g)&&!G?C.xQ=setTimeout(function(){var a={x:e.x,y:e.y,handled:!1},b=F.touchToolStrip;E.Wq(I.TouchToolStripOpening,a),a.handled||b.open(e.x,e.y-ba),C.tQ()},b+20):(A=E.ITa.getSelections(),d.ZG(e),B=E.ITa.getSelections(),E.yu(A,B),d.hH())}},Sia:function(a,b){return!(a&&a.activedOnClick&&!a.activedOnClick()&&b.isReservedLocation)},yQ:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=this,o=n.kj,p=a.rN;if(n.tQ(),d=o.yt,d&&(o.Wq(I.CellDoubleClick,{sheet:o,sheetName:o.name(),sheetArea:d.hitTestType,row:d.row,col:d.col}),e=d.resizeInfo))if(f=o.ITa.getSelections(),"sizeRow"===e.action||"sizeHiddenRow"===e.action){if(g=[],o.tp(e.index)){
for(b=0;b<f.length;b++)if(c=f[b],c.col===-1)for(c=o.Tq(c),h=0;h<c.rowCount;h++)g.push({row:c.row+h})}else g.push({row:e.index});o.wu().execute({cmd:"autoFitRow",sheetName:o.name(),rows:g,columnHeader:1===e.sheetArea})}else{if(i=[],o.sp(e.index)){for(b=0;b<f.length;b++)if(c=f[b],c.row===-1)for(c=o.Tq(c),j=0;j<c.colCount;j++)i.push({col:c.col+j})}else i.push({col:e.index});o.wu().execute({cmd:"autoFitColumn",sheetName:o.name(),columns:i,rowHeader:2===e.sheetArea})}else k=n.kQ(p.X,p.Y,!0),!(k&&k.row>=0&&k.col>=0&&k.rowViewportIndex>=0&&k.colViewportIndex>=0)||k.resizeInfo||o.options.isProtected&&o.tq(k.row,k.col,"locked")||(o.Tr(),l=o.Er(k.row),m=o.Fr(k.col),o.Kr(k.row,k.col,l,m,!0),o.addSelection(k.row,k.col,1,1),o.mm.dI(!1,!0),o.EF(o.Ws(),k.row,k.col))},zQ:function(a){var b,c=this,d=c.kj,e=a.rN,f=c.kQ(e.X,e.Y);d.isEditing()?f.row===d.Jl&&f.col===d.Kl||d.mm.cI(f):(c._target=f,b=c.kQ(e.X,e.Y,!0),b&&b.cellTypeHitInfo&&b.cellTypeHitInfo.isEditting||d.mm.cI(b))},AQ:function(){var a,b,c,d,e=this,f=e.kj;f.isEditing()||(a=e._target,b=!0,a&&(c=a.cellTypeHitInfo,c&&c.isReservedLocation?b=!1:(d=f.getCellType(a.row,a.col),d&&d.isEditting()&&(b=!1))),b&&f.mm.dI(!0))},kQ:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=this,t=s.kj;return t.am(),d={x:a,y:b,rowViewportIndex:Q,colViewportIndex:Q,row:-1,col:-1,resizeInfo:Q,hitTestType:Q,outlineHitInfo:Q,filterButtonHitInfo:Q,dragInfo:Q,cellTypeHitInfo:Q,selectionHitInfo:Q},e=t.rowOutlines,f=t.columnOutlines,e&&(g=e.hitTest(t,a,b)),!g&&f&&(g=f.hitTest(t,a,b)),g?d.outlineHitInfo=g:(h=t.nr(b),i=t.or(a),d.rowViewportIndex=h,d.colViewportIndex=i,d.row=t.pr(b,h),d.col=t.qr(a,i),h>=0&&h<=2&&i>=0&&(j=t.rr(h,i,R,d.row,d.col),j&&(d.row=j.row,d.col=j.col)),d.hitTestType=t.sr(h,i),k=Bb(t,d,a,b,10),m=t.xr,n=m&&m.hitTest(d,a,b),n||(p=t.tables,q=p&&p.find(d.row,d.col),r=q&&q.xr,n=r&&r.hitTest(d,a,b)),t.wQ?(l=Db(t,d,a,b),d.dragInfo=l):k?d.resizeInfo=k:n?d.filterButtonHitInfo=n:c?d.cellTypeHitInfo=t.yr(d,a,b):(o=Cb(t,d,a,b),d.selectionHitInfo=o)),d},tQ:function(){var a=this,b=a.xQ;b&&(clearTimeout(b),a.xQ=Q)}});function Ib(a,b,c){var d=this;d.BQ=c,d.yM=new Nb(b),d.CQ=new Hb(b),d.DQ=new Ob(a,"sheet",d.yM,100,10),d.BQ.xN(d.DQ,!0)}y(Ib.prototype,{EQ:function(){var a=this,b=a.CQ,c=a.DQ;c.dN=function(a){return b.jQ(a)},c.eN=function(a){return b.lQ(a)},c.fN=function(a){return b.pQ(a)},c.hN=function(a){return b.qQ(a)},c.iN=function(a){return b.sQ(a)},c.jN=function(a){return b.yQ(a)},c.GM=function(a){return b.zQ(a)},c.IM=function(a){return b.AQ(a)}},FQ:function(){var a=this,b=a.DQ;b&&(a.BQ.xN(b,!1),b.dN=Q,b.eN=Q,b.fN=Q,b.gN=Q,b.hN=Q,b.iN=Q,b.jN=Q,b.kN=Q,b.GM=Q,b.IM=Q,a.DQ=Q)},GQ:function(a){return this.yM.GQ(a)},HQ:function(a){return this.yM.HQ(a)},IQ:function(a){return this.yM.IQ(a)}}),h="gc-toolstrip-button",i="gc-toolstrip-text",j="gc-toolstrip-image",k="gc-toolstrip-item",l="gc-touch-sperate-line",m="height",n="width",o="px",p="button",A(Jb,w);function Jb(a,b){var c,d=this;w.call(d,b,B.vl(a.qo)),d.JQ=32,d.KQ=45,d.LQ={},d.MQ=!1,d.OC=a,c=d.yo(),d.NQ=c,c.addClass("gc-toolstrip-default ui-state-default well"),c.appendTo(d.zo()),c.hide(),d.OQ(),d.PQ(),d.QQ()}y(Jb.prototype,{open:function(a,b){var c,d,e,f,g=this,h=Da(g.OC);if(h&&(F.Zl(Q,!0),g.NQ.css({left:a,top:b}),g.Ao(),g.MQ=!0,g.Do(),!z(g.LQ))){c=g.LQ;for(d in c)c.hasOwnProperty(d)&&(e=c[d],f=!e.RQ||e.RQ.call(g),f?x("#"+d).show():x("#"+d).hide())}},add:function(a){var b,c,d,e;a&&(b=this,c=b.LQ,a instanceof Mb?(d=a.name(),d&&(c[d]=a,b.SQ(a.TQ(l,b.KQ+o)))):a instanceof Lb&&(e=a.name(),b.getItem(e)||(c[e]=a,b.SQ(a.TQ(j,b.JQ+o,i,h)))))},getItem:function(a){return this.LQ[a]},getItems:function(){var a,b=this,c=[],d=b.LQ;if(!z(d)){for(a in d)d.hasOwnProperty(a)&&c.push(d[a]);return c}return Q},remove:function(a){var b,c=this;return c.getItem(a)?(x("#"+a).parent().remove(),b=c.LQ[a],delete c.LQ[a],b):Q},clear:function(){var a=this;a.NQ&&(a.NQ.find("td."+k).remove(),a.LQ={})},close:function(){var a,b,c=this;ta.Hm(),c.NQ&&c.NQ.hide(),c.MQ=!1,c.Eo(),a=Da(c.OC),a&&(a.zt(),b=Ea(a),b.length>0&&!a.wQ&&b[0].row===-1&&b[0].col===-1&&a.Tr())},imageAreaHeight:function(a){var b=this;return 0===arguments.length?b.JQ:(a>0&&(b.JQ=a,b.NQ.find("span."+j).css(m,a+o)),b)},itemHeight:function(a){var b=this,c=b.NQ.find("button."+h);return 0===arguments.length?qa(c.css(m)):(a>0&&c.css(m,a+o),b)},itemWidth:function(a){var b,c,d=this,e=d.NQ.find("button."+h);return 0===arguments.length?qa(e.css(n)):(a>0&&(b="min-width",c=qa(e.css(b)),c>a&&e.css(b,a+o),e.css(n,a+o)),d)},separatorHeight:function(a){var b=this;return 0===arguments.length?b.KQ:(a>0&&(b.KQ=a,b.NQ.find("div."+l).css(m,a+o)),b)},OQ:function(){var a="table",b=this,c=x(C(a)).css({padding:0,display:a}).attr({cellspacing:0,cellpadding:0});b.UQ=x(C("tr")).appendTo(c),c.appendTo(b.NQ)},no:function(){var a=this,b=a.NQ;b&&(a.MQ&&ta.Hm(),b.remove(),a.Eo(),a.NQ=Q)},QQ:function(){var a=this;a.NQ.bind("click",function(b){var c,d,e,f=b.target,g=f.tagName.toLowerCase();g===p?c=f.id:(d=f.parentElement,d&&d.tagName.toLowerCase()===p&&(c=d.id)),e=a.LQ[c],c&&e&&e.VQ.call(a)})},SQ:function(a){this.NQ&&a&&x(C("td")).append(a).appendTo(this.UQ).addClass(k)},PQ:function(){var a,b,c,d,e,f,g;function h(a){for(var b=0,c=a+b;sa.getElementById(c);)b++,c=a+b;return c}a="gAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAA",b={0:ua+a+"A8ElEQVRIS92VwQ3CMAxFe+qZERiHY8dgDI4cYYNOhDhwY4ayQviW4q/Eddu0KRe+9CQ72P8rEpAmhPBT3ENLd76EiPv5HO5hSmK+KYTFsz+04A4G9NZ0hAizn7jTos2MFRYYugFZQlscoFzRZsYKCwwNulAqnZddtJmxwiIZ3oT6WFh4S2tQHwsLb2kN6mNh4S2tQX0sLLwly4IyY4WFZ2gReV/ZhBOQH2ddgKcYwBAc7R/weL0ZgqO6gGPXE1E0JlBdwJx2CUhvkCL63xvw33QKUc0N+B5MIaq5gb5o8kotBszJDShFlkvQ+ZHBvoTmC+fiVfoq/m86"+va,1:ua+a+"BkklEQVRIS7WTUXECQRBEcYCFOIiESAAH/OYPCcQBEogDJCABCUhAwqXf1QzVM0cojko+Xt3ObG/33t7eYhiGf6UU68+vneD5Mu4HpZDgKja+YCYH94NSSHAUg3glZC9k8zgAYwLmhuS6o/tBKUJ8CTGsoveIsin3g1LEAkxzAd/kXbihwxwatGys+EEpEAT5LR6FuDmMb+t+UAoEwVL44h7CvB8lGxrn3A9KkaLAj8pDMD9HL/v0ZgfAQfSAk/WgXAT3g1K4MPCj2AoPhNvRJO4HpejigF1jxtjNy9Ek7gel6GIjfzoP+Ihewf2gFPcWNNL817/c/aAUKXpbfy/FXlzFIM6gOYy3Gp+iz/xBPHeLQGLAMI2PNmYOw1uojZfdCyYNCXexiGcGpiljdp9hsBGjvnvBpCHhRbgBZChjAgj0eXrX7gWThoR992lAMGOOLMfJuIHuBZMGQuE75KN66Cpq14xH2L1g0kixyLNm3I8sNbwJulHfvWDSkJArmou4hlxXeh4AvBEBuZnnbtHfMix+AHqkr6wgQ4Q7"+va,2:ua+a+"A3UlEQVRIS72PwQ3CMAxFOwrjcOyZCTgyAjfWYCJO3JiCCVL/iFSO9W0MDTzpqYob+ztTKeWn0uJIadE6H8/ljXsR96q6tzt4YogH/olPcQ2R8mp3CHRBwO3+6EKkvNodcDkSgyyoAx0iRz/AA/8Op0sdtJuv1Va3Ct8FYHgL8dgUAGxIe41+kRAH6CbdaGW86nFAhnaXLSLEAbqJCbxlUgEZ2DIgFaCbmMBbJhWQgS0DUgG6iQm8ZVIBGTYFsK21oN3F1yrEARnsIM/u8JeAT9S9nrQ4UlocKS2Os0wLtkPMdu9POt0AAAAASUVORK5CYII=",3:ua+"UAAAAXCAIAAABrvZPKAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAIdJREFUOE/tzEEKgCAQheEOWLdx351adYc8Qgs3rbuAUC9nkkF0BKNN9CMy0Xx25llf8Edr7d57j/tlP4wTHf4W/b7gsT0vLs7Sz9bFWfM9nrDXE9ITphlVPO512wkkM++FNF86vBfKeKR43rjLe5QwOvxPVPSoipHmkY5RxSMFo7rXY9+eMSdet07b6c/bnwAAAABJRU5ErkJggg=="},c=this,d=b[0],e=b[1],f=b[2],g=b[3],c.WQ=new Lb(h("wijspread_toolstrip_paste"),xa().ToolStrip_PasteText,d,c.XQ),c.YQ=new Lb(h("wijspread_toolstrip_cut"),xa().ToolStrip_CutText,e,c.ZQ),c.$Q=new Lb(h("wijspread_toolstrip_copy"),xa().ToolStrip_CopyText,f,c._Q),c.aR=new Lb(h("wijspread_toolstrip_autofill"),xa().ToolStrip_AutoFillText,g,c.bR,c.cR),c.add(c.WQ),c.add(c.YQ),c.add(c.$Q),c.add(new Mb(c.cR)),c.add(c.aR)},cR:function(){var a,b,c,d=Da(this.OC);if(!d)return!1;for(a=Ea(d),b=0;b<a.length;b++)if(c=a[b],c.row===-1&&c.col===-1)return!1;return!0},bR:function(){var a,b;this.close(),a=Da(this.OC),a&&(b=Ea(a).length,b<=1&&(a.wQ=!0,a.yl.im()))},rQ:function(){var a=Da(this.OC);a&&(a.wQ=!1,a.yl.im())},_Q:function(){var a=Da(this.OC);a&&(this.dR=a.ux(!0)),this.close()},ZQ:function(){var a=Da(this.OC);a&&(this.dR=a.sx(!0)),this.close()},XQ:function(){var a=this,b=a.dR,c=Da(a.OC);c&&!v(b)&&c.vx({pasteHtml:b.copyHtml,pasteText:b.copyText}),a.close()},eR:function(){var a=this,b="span."+i;x("#"+a.WQ.Cj).find(b).text(xa().ToolStrip_PasteText),x("#"+a.YQ.Cj).find(b).text(xa().ToolStrip_CutText),x("#"+a.$Q.Cj).find(b).text(xa().ToolStrip_CopyText),x("#"+a.aR.Cj).find(b).text(xa().ToolStrip_AutoFillText)}}),s.TouchToolStrip=Jb;function Kb(a,b,c){var d,e=C("span"),f=sa.body;return e.className=c,e.style.font=a,e.style.cssFloat="left",e.textContent=b,f.insertBefore(e,Q),d=x(e).width(),f.removeChild(e),d}function Lb(a,b,c,d,e){this.MC="normal 12px Arial";var f=this;f.Cj=a,f._text=b,f.fR=c,d&&(f.VQ=d),e&&(f.RQ=e)}y(Lb.prototype,{name:function(a){var b=this;return 0===arguments.length?b.Cj:(x("#"+b.Cj).attr("id",a),x("#"+b.Cj+"Text").attr("id",a+"Text"),x("#"+b.Cj+"Image").attr("id",a+"Image"),b.Cj=a,b)},text:function(a){var b=this;return 0===arguments.length?b._text:(b._text=a,x("#"+b.name()+"Text").text(a),b)},font:function(a){var b=this,c=x("#"+b.name()+"Text");return 0===arguments.length?b.MC:(b.MC=a,c.css("font",a),b)},foreColor:function(a){var b=this,c=x("#"+b.name()+"Text");return 0===arguments.length?b.Nra?b.Nra:c.css("color"):(c.css("color",a),b)},image:function(a){var b=this;return 0===arguments.length?b.fR:(b.fR=a,x("#"+b.name()+"Image").css("background-image","url("+a+")"),b)},TQ:function(a,b,c,d){var e,f,g,h,i=this,j=i.name(),k=i.font(),l=i.text(),m=x(C("span"));return m.attr("id",j+"Image"),m.addClass(a),m.css({"background-image":"url("+i.image()+")","background-repeat":"no-repeat",display:"block",height:b,"background-position-x":"50%"}),e=x(C("span")),e.attr("id",j+"Text"),e.addClass(c),e.css("font",k),e.text(l),f=Kb(k,l,c),g=60,f>g&&(g=f),h=x(C(p)),h.attr("type",p),h.attr("id",j),h.addClass(d+" gc-toolstrip-button-style ui-state-default ui-widget btn btn-default"),h.css({"box-sizing":"content-box",border:"0px",padding:"4px",margin:"3px",width:g+o}),h.append(m),h.append(e),h[0]}}),s.TouchToolStripItem=Lb;function Mb(a){function b(){for(var a="separator",b=0,c=a+(""+b);sa.getElementById(c);)b++,c=a+(""+b);return c}this.Cj=b(),a&&(this.RQ=a)}y(Mb.prototype,{name:function(){return this.Cj},TQ:function(a,b){var c=x(C("div"));return c.attr("id",this.name()),c.addClass(a),c.css({width:"1px",height:b,display:"inline-block;","background-color":"#CCC","margin-left":"5px","margin-right":"5px",opacity:.6}),c[0]}}),s.TouchToolStripSeparator=Mb;function Nb(a){this.tc=a}y(Nb.prototype,{oN:function(){this.gR=2,this.tc.CH=!0},zM:function(){this.gR=0,this.hR=Ba()},nN:function(){return 1===this.gR},uN:function(){return 1===this.gR},sN:function(){return 1===this.gR},GQ:function(){var a=this;if(2===a.gR)return!0;if(a.hR){if(Ba()-a.hR<=200)return a.iR++,!0;a.hR=0,a.iR=0,a.gR=1}else a.gR=1;return a.tc.CH=!1,!1},HQ:function(){var a=this;return a.iR?(a.iR--,!0):2===a.gR||(a.gR=0,!1)},IQ:function(){return 2===this.gR}}),s.jR=Nb;function Ob(a,b,c,d,e){var f=this;f.KM=a,f.lN=c,f.OM=b,f.mN=d,f.aN=e}s.kR=Ob;function Pb(){}y(Pb.prototype,{lR:function(a,b){var c,d,e=a,f=e.touches,g=e.targetTouches,h=e.changedTouches;e.isPrimary!==!1&&(f&&f.length>=1&&g&&g.length>=1&&(f[0].clientX!==g[0].clientX||f[0].clientY!==g[0].clientY)||(L(a),c=v(h)?e:h[0],d=sa.createEvent("MouseEvents"),d.initMouseEvent(b,!0,!0,ra,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,Q),a.target.dispatchEvent(d)))},NM:function(a){var b,c=a.pointerType;if(!c||c===a[na]||c===ca){if(b=a.data,b.mR)return;b.mR=!0,b.nR=!1,b.lR(a,"mouseover"),b.lR(a,"mousemove"),b.lR(a,"mousedown")}},aB:function(a){var b,c=a.pointerType;if(!c||c===a[na]||c===ca){if(b=a.data,!b.mR)return;b.nR=!0,b.lR(a,"mousemove")}},RM:function(a){var b,c=a.pointerType;if(!c||c===a[na]||c===ca){if(b=a.data,!b.mR)return;b.lR(a,"mouseup"),b.lR(a,"mouseout"),b.nR||b.lR(a,"click"),b.mR=!1}},oR:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=this,p=c.charAt(0);"."!==p&&(c="."+c),d=ea+c,e=fa+c,f=ga+c,g=ha+c,h=ia+c,i=ja+c,j=ka+c,k=la+c,l=ma+c,m=B._Va(),b?m?(n=a.style,v(n.msTouchAction)||(n.msTouchAction=da),v(n.touchAction)||(n.touchAction=da),x(a).bind(d,o,o.NM).bind(g,o,o.NM),x(sa).bind(e,o,o.aB).bind(h,o,o.aB).bind(f,o,o.RM).bind(i,o,o.RM)):x(a).bind(j,o,o.NM).bind(k,o,o.aB).bind(l,o,o.RM):m?(x(a).unbind(d).unbind(g),x(sa).unbind(e).unbind(h).unbind(f).unbind(i)):x(a).unbind(j).unbind(k).unbind(l)}}),s.pR=Pb,q="newSheet";function Qb(a){this.hq=a}y(Qb.prototype,{Eda:function(a){var b,c=[];for(b=0;b<a.sheets.length;b++)c.push(a.sheets[b].name());return c},lQ:function(a){var b,c,d,e,f,g,h,i,j,k,l,m=this,n=a.rN,o=m.hq,p=Da(o.OC);o.FD&&o.GD(p,!1),b="resize",c=m.Eda(o.OC),d=o.hitTest(n.X,n.Y),e=d.element,e===b?(o.HD=!0,o.ID=n.X):(c.indexOf(e)>=0||e===q||""===e)&&(f=o.Xs,g=G.Nn(f),h=G.On(f),i=m.IP(g,h),j=i.getContext("2d"),k=G.Ln(i),l=G.Mn(i),wa.Cn(j,1,1),j.drawImage(f,0,0,za(i),ya(i),0,0,za(i),ya(i)),wa.Cn(j,k,l),m.Xs=i,m.qR=o.gq,m.rR=o.VC(),m.sR=o.UC(),m.KC=o.TC(),o.SC=!0),m.tR=o.jw(-1),m.uR=o.rD(o.sD())},pQ:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,w,x,y,z,A,B,C,F,H,I=this,J=a.rN.X,K=I.hq;if(K.HD)b=J-K.ID,c=K.OC,d=c.options,e=c.xs.clientWidth,d.tabStripRatio=c.Iv()+b/e,f=K.kw/e,g=1,c.Iv()<f?(d.tabStripRatio=f,K.ID=K.kw):c.Iv()>=g?(d.tabStripRatio=g,K.ID=e):K.ID=J;else{if(h=I.Xs,i=I.qR,!h||v(i))return;j=I.tR,k=I.uR,l=I.KC,m=I.rR,n=I.sR,o=a.dP.sO.X,p=I.vR(o,i),K.gq=p.gq,q=p.Vo,o>0&&i===j&&K.gq===j?q=0:o<0&&i===k&&K.gq===k&&(q=0),o>0&&o>q+l?o=q+l:o<0&&o<q-l&&(o=q-l),0!==o&&(r=K.Xs,s=r.getContext("2d"),t=G.Ln(r),u=G.Mn(r),s.save(),s.clearRect(0,0,G.Nn(r),G.On(r)),w=K.Dr(),K.dD(s,w),y=0,A=ya(w),o>0?(x=m,B=x+o,z=n-B,z>0&&(wa.Cn(s,1,1),s.drawImage(h,x*t,y,z*t,A*u,B*t,y,z*t,A*u),wa.Cn(s,t,u)),C=o-q,n-m<=o&&(C=0),z=q,x=m,z>0&&(wa.Dn(s,C,0),K.iE(s,new E(x,y,z,A)),wa.Dn(s,-C,0))):o<0&&(B=m,x=B+S(o),z=n-x,z>0&&(wa.Cn(s,1,1),s.drawImage(h,x*t,y,z*t,A*u,B*t,y,z*t,A*u),wa.Cn(s,t,u)),C=o-q,n-m<=S(o)&&(C=0),z=S(q),x=n-z,z>0&&(wa.Dn(s,C,0),K.iE(s,new E(x,y,z,A)),wa.Dn(s,-C,0))),wa.Cn(s,1,1),x=0,z=m,s.drawImage(h,x*t,y,z*t,A*u,x*t,y,z*t,A*u),F=D.Lm(""),H=pa(F.zIndex),H>2007&&(x=n,z=w.x+za(w)-K.kw-x,s.drawImage(h,x*t,y,z*t,A*u,x*t,y,z*t,A*u)),x=za(w)-K.kw,z=K.kw,s.drawImage(h,x*t,y,z*t,A*u,x*t,y,z*t,A*u),wa.Cn(s,t,u),s.restore())}},qQ:function(){var a=this.hq;a.HD?(a.HD=!1,a.OC.aq()):(a.SC=R,a.repaint())},sQ:function(a){var b,c,d,e,f,g=this.hq,h=g.OC,i=a.rN,j=Da(h);g.FD&&g.GD(j,!1),b=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],c=this.Eda(h),d=g.hitTest(i.X,i.Y),e=d.element,h.mv=!0;try{b.indexOf(e)>=0?g.JD(d.index,!0):c.indexOf(e)>=0?g.KD(d.index,d.position):e===q&&g.MD(d.position)}finally{h.mv=!1,f=Da(h),f!==j&&(f.CH=!0,f.zt())}},yQ:function(a){return this.hq.cE(a.rN.X,a.rN.Y)},IP:function(a,b){var c=this.Xs;return c?a===G.Nn(c)&&b===G.On(c)||G.Pn(c,a,b):(c=C("canvas"),G.Kn(c,this.hq.OC),G.Pn(c,a,b)),c},vR:function(a,b){var c=this,d=c.hq,e=d.WC,f=c.tR,g=c.uR,h=b,i=0;if(a>0){for(;h>=f&&!(i>a);)i+=e[h],h--;h<f&&(h=f)}else if(a<0&&g!==-1){for(;h<=g&&!(i<a);)i-=e[h],h++;h>g&&(h=g)}return{gq:h,Vo:i}}});function Rb(a,b,c){var d,e,f=this;f.yM=new Nb(f),f.DQ=new Ob(a,"tabStrip",f.yM,1,(-1)),f.BQ=c,f.CQ=new Qb(b),d=f.CQ,e=f.DQ,e.eN=function(a){return d.lQ(a)},e.fN=function(a){return d.pQ(a)},e.hN=function(a){return d.qQ(a)},e.iN=function(a){return d.sQ(a)},e.jN=function(a){return d.yQ(a)}}y(Rb.prototype,{EQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!0)},FQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!1)},GQ:function(a){return this.yM.GQ(a)},HQ:function(a){return this.yM.HQ(a)},IQ:function(a){return this.yM.IQ(a)}});function Sb(a,b,c,d){var e=a.vu();e.ko(b)?c.drawImage(e.lo(b),d.x,d.y,za(d),ya(d)):e.fo(b)}function Tb(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p=a.am(),q=16,r=Ea(a);a.CH&&r.length>0&&(g=r[r.length-1],h=g.row,i=g.row+g.rowCount-1,j=g.col,k=g.col+g.colCount-1,l=a.parent,m="AAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADs",l&&!l.options.allowUserResize||(h!==-1&&j===-1&&a.getRowResizable(i)?(n=a.Er(i),c=ua+m+"MAAA7DAcdvqGQAAABaSURBVDhPY/z//z8DLsDIyAiWBKphBAtgAUxQGgPANIMAMhsdYDUAmwZchtDOC8SCgTcA5DfcgUAEoNwFo7GAPQxwJVtsYYHVBdgU4gpInF5A1oBLMwMDAwMApuAtD6Z7YxQAAAAASUVORK5CYII=",d=a.getCellRect(i,Ha(a,2)-1,n,-1),f=p.fm(n),f.y<=d.y&&d.y+ya(d)<=f.y+ya(f)&&(e=new E(p.kt-q,d.y+ya(d)-q/2,q,q))):h===-1&&j!==-1&&a.getColumnResizable(k)&&(o=a.Fr(k),c=ua+m+"IAAA7CARUoSoAAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAE1JREFUOE/ljtEKACAIA/v/nzZ9mFhsJPRocLEuGS4zk/iJyyP/D6gE0wrYoCqoLoUafPl8fEBln3ulSscfErk65TMjMFRBhUowosDWBoHpba8+C7w0"+va,d=a.getCellRect(Ia(a,1)-1,k,-1,o),f=p.gm(o),f.x<=d.x&&d.x+za(d)<=f.x+za(f)&&(e=new E(d.x+za(d)-q/2,p.nt-q,q,q))),c&&e&&Sb(a,c,b,e)))}function Ub(a){var b,c,d,e,f=Q,g=Ea(a),h=g.length;return a.CH&&h>0&&(b=g[h-1],c=a.cm(b),d=17,e=20,f=new E(c.x+za(c)-d,c.y+ya(c),d,e)),f}function Vb(a,b,c){var d=a.Er(b),e=a.Fr(c),f=a.jt(d),g=a.it(e),h=0,i=0,j=0,k=0;return f.length>0&&(h=f[0].row,i=f[f.length-1].row),g.length>0&&(j=g[0].col,k=g[g.length-1].col),H(h,j,i-h+1,k-j+1)}function Wb(a,b,c){var d,e,f,g=a.Er(b),h=a.Fr(c),i=a.am(),j=i.Ft(g,h),k=!1,l=a.it(h),m=c===-1?l[0]:l.findCol(c);return m&&(k=j.x<=m.x&&m.x+za(m)<=j.x+za(j)),d=!1,e=a.jt(g),f=b===-1?e[0]:e.findRow(b),f&&(d=j.y<=f.y&&f.y+ya(f)<=j.y+ya(j)),k&&d}function Xb(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,F,G,H,I=Ea(a),J=[];if(a.CH&&I.length>0)for(b=I[I.length-1],c=a.cm(b),d=8,e=a.am(),f=b.row,g=b.row+b.rowCount-1,h=b.col,i=b.col+b.colCount-1,j=Vb(a,f,h),k=Vb(a,g,i),l=j.row,m=k.row+k.rowCount-1,n=j.col,o=k.col+k.colCount-1,r=g===m&&Wb(a,m,-1),s=i===o&&Wb(a,-1,o),b.row!==-1&&b.col!==-1?(n<=h&&h<=o&&l<=f&&f<=m&&(J[0]=new E(c.x-d,c.y-d,2*d,2*d)),(n<=i&&i<o||s)&&(l<=g&&g<m||r)&&(J[1]=new E(c.x+za(c)-d,c.y+ya(c)-d,2*d,2*d))):b.row!==-1?(p=e.Ft(1,0),q=e.Ft(1,1),t=p.x+(za(p)+za(q))/2-d,u=Ha(a)-1-Fa(a),v=a.it(1),w=v.findCol(u),w&&(x=a.it(0),y=x[0]||v[0],y&&(t=y.x+(w.x+za(w)-y.x)/2-d)),l<=f&&f<=m&&(J[0]=new E(t,c.y-d,2*d,2*d)),(l<=g&&g<m||r)&&(J[1]=new E(t,c.y+ya(c)-d,2*d,2*d))):b.col!==-1&&(p=e.Ft(0,1),q=e.Ft(1,1),z=p.y+(ya(p)+ya(q))/2-d,A=Ia(a)-1-Ga(a),B=a.jt(1),C=B.findRow(A),C&&(D=a.jt(0),F=D[0]||B[0],F&&(z=F.y+(C.y+ya(C)-F.y)/2-d)),n<=h&&h<=o&&(J[0]=new E(c.x-d,z,2*d,2*d)),(n<=i&&i<o||s)&&(J[1]=new E(c.x+za(c)-d,z,2*d,2*d))),H=J.length-1;H>=0;H--)G=J[H],(!G||G.x<0||G.y<0)&&(J[H]=Q);return J}function Yb(a,b,c){var d,e,f,g,h=a.parent;if(F.Wl(a)||h&&!h.options.hideSelection){if(a.isEditing()||!b||0===a.selectionPolicy())return;if(d=Xb(a),e=d.length,e>0){for(c.save(),c.fillStyle=a.e_a()||"white",c.strokeStyle=a.getSelectionBorderColor(),g=0;g<e;g++)f=d[g],f&&(c.beginPath(),c.arc(f.x+za(f)/2,f.y+ya(f)/2,za(f)/2,0,2*Math.PI,!1),c.fill(),c.stroke());c.restore()}}}function Zb(a,b){var c,d=Ub(a);d&&(c=ua+"EAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1"+va,Sb(a,c,b,d))}u.oJ.prototype.DH=function(){var a=this,b=a.kj,c=Ea(b),d=c.length;b.Xq<=0&&d>0&&a.im(c[d-1],R,R,!0)},u.Worksheet.$n(ca,{init:function(){this.wQ=!1,this.mQ=!0},setHost:function(a){var b=this,c=b.parent,d=c&&c.BQ||new Ka,e=new Ib(a[0],b,d);e.EQ(),b.wR=e},dispose:function(a){var b=this;b.wR&&b.wR.FQ(),a!==!1&&(b.wR=Q)},startEdit:function(){this.yl.DH()},paintAdornment:function(a){var b=this,c=a.ctx;b.CH&&(b.options.isProtected||Tb(b,c),b.wQ?Zb(b,c):Yb(b,b.mQ,c))},preProcessMouseDown:function(a){var b=a.e,c=this.wR;(P||c.GQ(b))&&(L(b),a.r=!0)},preProcessMouseMove:function(a){var b=a.e,c=this.wR;(P||c.IQ(b))&&(L(b),a.r=!0)},preProcessMouseUp:function(a){var b=a.e,c=this.wR;(P||c.HQ(b))&&(L(b),a.r=!0)},preProcessMouseDbClick:function(a){(P||this.CH)&&(a.r=!0)},preProcessMouseOut:function(a){P&&(a.r=!0)},preProcessMouseWheel:function(a){P&&(a.r=!0)}}),u.Workbook.$n(ca,{init:function(){this.BQ=new Ka},setHost:function(){var a=this;a.touchToolStrip=new Jb(a,a.xv())},dispose:function(){var a=this,b=a.BQ,c=a.touchToolStrip;b&&b.no(),c&&(c.no(),a.touchToolStrip=Q)},onCultureChanged:function(){var a=this.touchToolStrip;a&&a.eR()}}),u.DC.$n(ca,{setHost:function(){var a=this,b=new Rb(a.Xs,a,a.OC.BQ);b.EQ(),a.wR=b},dispose:function(){var a=this,b=a.wR;b&&(b.FQ(),a.wR=Q)},preProcessMouseDown:function(a){var b=this.wR,c=a.e;(P||b.GQ(c))&&(L(c),a.r=!1)},preProcessMouseMove:function(a){var b=this.wR,c=a.e;(P||b.IQ(c))&&(L(c),a.r=!1)},preProcessMouseUp:function(a){var b=this.wR,c=a.e;(P||b.HQ(c))&&(L(c),a.r=!1)},preProcessMouseDbClick:function(a){var b=Da(this.OC);(P||b.CH)&&(a.r=!1)},preProcessMouseOut:function(a){P&&(a.r=!1)}}),r=".gcScrollbar",u.hv.$n(ca,{initEvents:function(a){var b=this.xR=new Pb;b.oR(a,!0,r)},dispose:function(a){var b=this.xR;b&&b.oR(a,!1,r)}}),a.exports=s}()},function(a,b){a.exports=GC.Spread.Common},function(a,b){a.exports=GC.Spread.Sheets},function(a,b){!function(){"use strict";a.exports={ToolStrip_PasteText:"Paste",ToolStrip_CutText:"Cut",ToolStrip_CopyText:"Copy",ToolStrip_AutoFillText:"AutoFill"}}()}]);