/*!
 * 
 * Spread.Sheets Library 12.1.0
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.CellTypes=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){!function(){"use strict";c(1),c(4),c(5),a.exports=c(6)}()},function(a,b,c){!function(){"use strict";var b,d,e,f=c(2),g=c(3),h=f.Ul.Nl,i=g.j.Fa,j=f.Ul,k=j.fp,l=j.nl,m=f.CellTypes,n=m.Context,o=m.Base,p=f.GC$,q=p.each,r=j.hZa,s=null,t=void 0,u=Math.max,v=parseInt,w="position",x="absolute",y="font",z="left",A="right",B="top",C="alphabetic",D=".gcEditingInput",E="background-color",F="white",G="green",H="div",I="_isFirstMouseUp",J="_mouseupToken";function K(a,b,c,d){var e,f=a.ITa;f&&(f.do("setValueForKey",b,c,I,t,d),e=f.getValueForKey(b,c,J,d),e&&(clearTimeout(e),f.do("setValueForKey",b,c,J,t,d)))}m.CheckBoxTextAlign={top:0,bottom:1,left:2,right:3},p.inherit(L,o),b=12,d={caption:"",textTrue:"",textIndeterminate:"",textFalse:"",textAlign:3,isThreeState:!1};function L(){var a=this;o.call(a),a.typeName="5",q(d,function(b,c){a["_"+b]=c})}function M(a){return 5*a}function N(a,c,d,e,f){var g=M(f),h=c.hAlign,i=d.x-1,j=d.width+1,k=0,l=0;return 0===a||1===a?(l=i+g,1===h?l=i+j/2-b/2:2===h&&(l=i+j-g-b)):2===a?(k=b+e,l=i+g+e,1===h?l=i+j/2-k/2+e:2===h&&(l=i+j-g-k+e)):(k=b+e,l=i+g,1===h?l=i+j/2-k/2:2===h&&(l=i+j-g-k)),l-i}function O(a,c,d,e,f){var g=M(f),h=c.vAlign,i=d.y-1,j=d.height+1,k=0,l=0;return 0===a?(k=b+e,l=i+g+e,1===h?l=i+j/2-k/2+e:2===h&&(l=i+j-g-k+e)):1===a?(k=b+e,l=i+g,1===h?l=i+j/2-k/2:2===h&&(l=i+j-g-k)):(l=i+g,1===h?l=i+j/2-b/2:2===h&&(l=i+j-g-b)),l-i}function P(a,b,c,d,e){var f=b.getValue(c,d,e),g=a.rK(f),h={cmd:"editCell",sheetName:b.name(),row:c,col:d,newValue:g,autoFormat:!0};b.wu().execute(h),a.tw(b,c,d,e)}function Q(a,b,c,d,e){var f=e&&e.sheet,g=a.getEditorValue(b,e);a.setEditorValue(b,g,e),a.updateEditor(b,c,d,e),a.tw(f,f.Jl,f.Kl,e.sheetArea)}e={paintValue:function(a,c,d,e,g,h,l,m){var n,o,p,q,r,s,t,u,w,x,y,B,D,E,H,I,J,K,L,M,P;a&&(a.save(),a.rect(d,e,g,h),a.clip(),a.beginPath(),n=l.hAlign,o=l.font,p=l.foreColor,q=this,r=q._textAlign,s=q.getText(c,m),t=0,u=0,w=m.sheet,w&&(t=w.dp(s,o),u=k(o),s&&(x=s.split(/\r\n|\r|\n/),u*=x.length)),y=w.zoom(),B=b/2,D=new f.Rect((++d),(++e),(--g),(--h)),E=v(""+(d+N(r,l,D,t,y))),H=v(""+(e+O(r,l,D,u,y))),I=z,J=E+1,1===n?(I="center",J+=B):2===n&&(I=A,J+=2*B),o&&a.font!==o&&j.lZa(a,o),p&&(a.fillStyle=p),K=l.textDecoration,L=m.fontInfo.fontSize,M=L>8?Math.floor((L-8)/5+2):1,P=u/2-L/2+M-1,a.textBaseline!==C&&(a.textBaseline=C),2===r?(a.textAlign=A,a.fillText(s,E+1-2,H+B+u/2-P),K&&q.ip(a,K,E+1-2,H+B+u/2-P,t,L,M)):0===r&&(a.textAlign=I,a.fillText(s,J,H-2-P),K&&q.ip(a,K,J,H-2-P,t,u)),a.save(),a.strokeStyle="black",a.strokeRect(E+.5,H+.5,2*B+.05,2*B+.05),a.fillStyle=F,a.fillRect(E+1,H+1,2*B-1,2*B-1),q._isThreeState&&i(c)?(a.beginPath(),a.fillStyle=G,a.rect(E+3,H+3,2*(B-2.5),2*(B-2.5)),a.fill()):!!c==!0&&(a.beginPath(),a.lineWidth=2.5,a.moveTo(E+3,H+B),a.lineTo(E+B,H+2*B-3.5),a.lineTo(E+2*B-1.5,H+3),a.stroke()),a.restore(),p&&(a.fillStyle=p),3===r?(a.textAlign=z,a.fillText(s,E+1+2*B+2,H+B+u/2-P),K&&q.ip(a,K,E+1+2*B+2,H+B+u/2-P,t,L,M)):1===r&&(a.textAlign=I,a.fillText(s,J,H+2*B+2+u-P),K&&q.ip(a,K,J,H+2*B+2+u-P,t,L,M)),a.restore())},getText:function(a,b){return this.sK(a)},focus:function(a,b){a&&a.parentNode.focus()},createEditorElement:function(a,c){var d,e,f,g,i=a&&a.sheet&&a.sheet.parent&&a.sheet.parent.qo,k=j.vl(i)+1e3;return p(c).css("z-index",k).attr("tabindex",1).attr("gcUIElement","gcEditingInput"),d=p(c.firstChild),d.css("overflow","hidden"),e=p(h("input")),e.attr("type","checkbox"),d.append(e),f=p(h("span")),f.css(w,x).css(y,r("normal 11pt calibri")).css("cursor","default").css("white-space","nowrap"),d.append(f),g=p(h(H)),g.css(w,x).css(E,G).css("width",2*(b/2-2.5)).css("height",2*(b/2-2.5)),d.append(g),s},rK:function(a){var b;return b=this._isThreeState?!i(a)&&(!!a!=!0||s):!a},setEditorValue:function(a,b,c){var d,e,f,g,h,j,k,l;a&&(d=a.parentNode.children,e=d[0],f=d[1],g=d[2],e&&f&&g&&(h=this,j=c&&c.sheet,k=j&&j.HF,k||(b=h.rK(b)),h._isThreeState?i(b)?(l=!1,p(g).show()):(l=!!b,p(g).hide()):l=!!b,e.checked=l,p(f).text(h.sK(b))))},getEditorValue:function(a,b){if(a){var c=a.parentNode.children,d=c[0],e=c[1],f=c[2];if(d&&e&&f&&(!this._isThreeState||!p(f).isVisible()))return d.checked}return s},tw:function(a,b,c,d){var e=a.parent;e&&e.tw(a,b,c,d)},activateEditor:function(a,b,c,d){var e,f,g=d&&d.sheet;a&&g&&(e=p(a.parentNode.parentNode),f=this,e.bind("mousedown"+D,function(a){l(a)}),e.bind("mouseup"+D,function(){Q(f,a,b,c,d)}),e.bind("keydown"+D,function(a){var b=a.keyCode;if(!a.ctrlKey&&!a.shiftKey&&!a.altKey){if(32===b)return f.tK=!0,l(a),!1;8===b&&l(a)}}),e.bind("keyup"+D,function(e){!f.tK||32!==e.keyCode||e.ctrlKey||e.shiftKey||e.altKey||(f.tK=!1,Q(f,a,b,c,d))}),p(a).bind("click",function(a){l(a)}))},updateEditor:function(a,c,d,e){var f,g,h,i,j,l,m,n,o,q,s,t,u,v,w,x,A,C,D,E,F,G,H,I,J,K,L,M,P,Q=e&&e.sheet;a&&Q&&(f=Q.yl,g=a.parentNode,h=g.children,i=h[0],j=h[1],l=h[2],i&&j&&l&&(p(g).width(d.width).height(d.height),m=p(j),n=m.text(),o=c.foreColor,q=c.font,s=c.hAlign,t=c.textDecoration,o&&m.css("color",o),u=q?q:f.Bl(),v=Q.zoom(),v>1&&(u=f.Cl(u)),m.css(y,r(u)),w=Q.rt(n,u),x=k(u),n&&(A=n.split(/\r\n|\r|\n/),x*=A.length),C=this,D=C._textAlign,E=N(D,c,d,w,v),F=O(D,c,d,x,v),p(i).css("margin-left",E).css("margin-top",F),G=i.offsetLeft,H=i.offsetTop,I=i.offsetWidth,J=i.offsetHeight,K=0,L=0,0===D?(K=G,1===s?K=G+b/2-w/2:2===s&&(K=G+b-w),L=H-x):1===D?(K=G,1===s?K=G+b/2-w/2:2===s&&(K=G+b-w),L=H+J):2===D?(K=G-w-2,L=H+b/2-x/2):(K=G+I+2,L=H+b/2-x/2),m.css(z,K).css(B,L),C._isThreeState?(M=G+(I-l.offsetWidth)/2,P=H+(J-l.offsetHeight)/2,p(l).css(z,M).css(B,P).toggle().toggle()):p(l).hide(),t&&C.lp(m,t)))},sK:function(a){var b=this,c=b._caption;return b._isThreeState&&i(a)?b._textIndeterminate||c:!!a==!0?b._textTrue||c:b._textFalse||c},getHitInfo:function(a,b,c,d,e){if(e){var f=e.sheetArea;if(i(f)||3===f)return{x:a,y:b,row:e.row,col:e.col,cellRect:d,sheetArea:3,isReservedLocation:!0,sheet:e.sheet}}return s},processMouseDown:function(a){return!!a&&void(a.isReservedLocation&&(this.uK=!0))},processMouseUp:function(a){var b,c,d,e,f,g=this,h=a&&a.sheet;if(h&&g.uK&&a.isReservedLocation){if(g.uK=!1,b=a.row,c=a.col,d=a.sheetArea,e=h.ITa.getValueForKey(b,c,I,d),!e)return P(g,h,b,c,d),h.ITa.do("setValueForKey",b,c,I,!0,d),f=setTimeout(function(){K(h,b,c,d)},250),h.ITa.do("setValueForKey",b,c,J,f,d),!0;K(h,b,c,d)}return!1},processMouseLeave:function(a){return!!a&&void(this.uK=!1)},isReservedKey:function(a,b){return 32===a.keyCode&&!a.ctrlKey&&!a.shiftKey&&!a.altKey},processKeyUp:function(a,b){return P(this,b.sheet,b.row,b.col,b.sheetArea),!0},getAutoFitWidth:function(a,c,d,e,f){var g=this,h=g._textAlign,i=n.cp(a,g.sK(a),d,e,f);return 0===h||1===h?i=u(i,b):i+=b,i+5+2},getAutoFitHeight:function(a,c,d,e,f){var g=this,h=g._textAlign,i=n.ep(a,g.sK(a),d,e,f);return 0===h||1===h?i+=b:i=u(i,b),i+5},JH:function(a){this.isReservedKey(a)&&l(a)},isImeAware:function(a){return!1},gQa:function(){},toJSON:function(){var a,b=this,c={typeName:b.typeName};return q(d,function(d,e){a=b["_"+d],a!==e&&(c[d]=a)}),c},fromJSON:function(a){var b=this;q(d,function(c){var d=a[c];i(d)||(b["_"+c]=d)})}},q(d,function(a){e[a]=function(b){return 0===arguments.length?this["_"+a]:(this["_"+a]=b,this)}}),p.extend(L.prototype,e),m.CheckBox=L,m._o[5]=L,a.exports=m}()},function(a,b){a.exports=GC.Spread.Sheets},function(a,b){a.exports=GC.Spread.Common},function(a,b,c){!function(){"use strict";var b,d,e,f,g,h=c(2),i=c(3),j=h.Events.SelectionChanged,k=i.j.Fa,l=h.Ul,m=l.nl,n=h.CellTypes,o=n.Context,p=n.Text,q=n.Base,r=h.GC$,s=r.each,t=null,u=void 0,v="_isFirstMouseUp",w="_mouseupToken";function x(a,b,c,d){var e,f=a.ITa;f&&(f.do("setValueForKey",b,c,v,u,d),e=f.getValueForKey(b,c,w,d),e&&(clearTimeout(e),f.do("setValueForKey",b,c,w,u,d)))}r.inherit(y,q),b="#707070",d="#34B4E3",e=".buttonCellType",f={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,text:"",buttonBackColor:t,buttonState:0};function y(){var a=this;q.call(a),a.typeName="6",s(f,function(b,c){a["_"+b]=c})}g={paintValue:function(a,c,e,f,g,h,i,j){var k,l,m,n,o,q,r,s,t,u,v,w,x;a&&(k=this,l=k._marginLeft,m=k._marginTop,n=e+l,o=f+m,q=g-l-k._marginRight,r=h-m-k._marginBottom,s=n+q>e&&n<e+g&&o+r>f&&o<f+h,q-2>0&&r-2>0&&s&&(a.save(),(n<e||n+q>e+g||o<f||o+r>f+h)&&(a.rect(e,f,g,h),a.clip()),a.beginPath(),t=b,t&&a.strokeStyle!==t&&(a.strokeStyle=t),a.strokeRect(n+.5,o+.5,q-1,r-1),v=k._buttonState,w=k._text,2===v?u=d:(u=k._buttonBackColor,u||(x=a.createLinearGradient(e+g/2,f,e+g/2,f+h),x.addColorStop(.125,"#F6FAFB"),x.addColorStop(1,"#D2DBEB"),u=x)),a.fillStyle!==u&&(a.fillStyle=u),a.fillRect(n+1,o+1,q-2,r-2),a.restore(),w&&p.prototype.paintValue.call(k,a,w,n,o,q,r,i,j)))},getText:function(a,b){return a},tw:function(a,b,c,d){var e=a.parent;e&&e.tw(a,b,c,d)},getHitInfo:function(a,b,c,d,e){var f,g,h,i,j,l,m=this;return e&&(f=e.sheetArea,(k(f)||3===f)&&d)?(g=d.x+m._marginLeft,h=d.x+d.width-m._marginRight,i=d.y+m._marginTop,j=d.y+d.height-m._marginBottom,l={x:a,y:b,row:e.row,col:e.col,cellRect:d,sheetArea:f,sheet:e.sheet},g<=a&&a<=h&&i<=b&&b<=j&&(l.isReservedLocation=!0),l):t},processMouseDown:function(a){var b=this,c=a&&a.sheet;return!(!c||!a.isReservedLocation||b.uK)&&(b.uK=!0,b._buttonState=2,c.repaint(a.cellRect),!0)},processMouseUp:function(a){var b,c,d,e,f,g=this,h=a&&a.sheet;if(g.uK&&h&&a.isReservedLocation){if(g._buttonState=0,h.repaint(a.cellRect),g.uK=!1,b=a.row,c=a.col,d=a.sheetArea,e=h.ITa.getValueForKey(b,c,v,d),!e)return g.tw(h,b,c,d),h.ITa.do("setValueForKey",b,c,v,!0,d),f=setTimeout(function(){x(h,b,c,d)},250),h.ITa.do("setValueForKey",b,c,w,f,d),!0;x(h,b,c,d)}return!1},processMouseLeave:function(a){var b=this,c=a&&a.sheet;c&&b.uK&&(b._buttonState=0,c.repaint(a.cellRect),b.uK=!1)},processKeyDown:function(a,b){var c,d=b.sheet,f=this;return!(!d||f.vK)&&(c=d.getCellRect(b.row,b.col),f._buttonState=2,d.repaint(c),d.Fu(j+e,function(){d.Gu(j+e),f.vK=!1,f._buttonState=0,d.repaint(c)}),f.vK=!0,!0)},processKeyUp:function(a,b){var c,d,f,g=b.sheet,h=this;return!(!g||!h.vK)&&(c=b.row,d=b.col,f=g.getCellRect(c,d),h._buttonState=0,g.repaint(f),g.Gu(j+e),h.tw(g,c,d,b.sheetArea),h.vK=!1,!0)},isReservedKey:function(a,b){return 32===a.keyCode&&!a.ctrlKey&&!a.shiftKey&&!a.altKey},getAutoFitWidth:function(a,b,c,d,e){var f=this,g=o.cp(a,f._text,c,d,e);return g+f._marginLeft+f._marginRight},getAutoFitHeight:function(a,b,c,d,e){var f=this,g=o.ep(a,f._text,c,d,e);return g+f._marginTop+f._marginBottom},JH:function(a){this.isReservedKey(a)&&m(a)},isImeAware:function(a){return!1},toJSON:function(){var a,b=this,c={typeName:b.typeName};return s(f,function(d,e){"buttonState"!==d&&(a=b["_"+d],a!==e&&(c[d]=a))}),c},fromJSON:function(a){var b=this;s(f,function(c){var d=a[c];k(d)||(b["_"+c]=d)})},a5:function(a){},gQa:function(){}},s(f,function(a){g[a]=function(b){return 0===arguments.length?this["_"+a]:(this["_"+a]=b,this)}}),r.extend(y.prototype,g),n.Button=y,n._o[6]=y,a.exports=n}()},function(a,b,c){!function(){"use strict";var b,d,e=c(2),f=c(3),g=e.Ul.Nl,h=f.j.Fa,i=e.Ul,j=i.fp,k=i.Ml,l=k.mozilla,m=e.CellTypes,n=m.Base,o=e.GC$,p=o.each,q=e.Vn,r=null,s=Math.max,t=Math.min,u=Math.floor,v=window.open,w="position",x="absolute",y="margin",z="font",A="left",B="top",C="padding",D="border",E="box-sizing",F="background-color",G="content-box",H="default",I="white",J="div",K="hyperlinkInfo";function L(a,b){a.removeChild(b)}m.HyperLinkTargetType={blank:0,self:1,parent:2,top:3},o.inherit(M,n),b={linkColor:"#0066cc",visitedLinkColor:"#3399ff",text:"",linkToolTip:"",target:0,activeOnClick:!0};function M(){var a=this;n.call(a),a.typeName="8",a.yn=M.wK(),p(b,function(b,c){a["_"+b]=c}),a._onAction=function(a){var b=a&&a.sheet,c=a.row,d=a.col,e=a.sheetArea,f=b.getValue(c,d,e),g=N(this._target);f&&v(f,g)}}function N(a){return["_blank","_self","_parent","_top"][a]}function O(a,b,c,d,e,f){var g=0,h=0,i=a.width,j=a.height;return g=f=f||0,1===d?g=(i-b)/2:2===d&&(g=i-b-f),1===e?h=(j-c)/2:2===e&&(h=j-c),{x:g,y:h}}function P(a,b,c,d){var e=R(a,c),f=e.width;return f+=(1!==b&&!h(d))==!0?d:0,e.width=f,e}function Q(a,b,c,d,e,f){var g=R(a,d),h=O(e,g.width,g.height,b,c,f);return g.x=h.x,g.y=h.y,g}function R(a,b){var c=j(b),d=Math.max(0,q.Xn(a,b,!0)),e=a.split(/\r\n|\r|\n/).length*c;return{x:0,y:0,width:d,height:e}}function S(a,b,c,d,e,f){var g,i,j,k,l,m,n,o,p,r,s,u=e.sheet,v=u.yl;if(h(c))return!1;if(f||(g=u.getValue(e.row,e.col,e.sheetArea),h(g)||(f=g+"")),!f)return!1;for(f=f.replace(/\s+/g," "),i=c&&c.font?c.font:v.Bl(),u.zoom()>1&&(i=v.Cl(i)),j=[f],k=T(c),c.wordWrap&&(j=q.Wn(f,d.width-3-k,i),f=j.join("\r\n")),l=Q(f,c.hAlign,c.vAlign,i,d,k),m=d.y+l.y,n=0;n<j.length;n++)if(o=Q(j[n],c.hAlign,c.vAlign,i,d,k),p=d.x+o.x,r=t(p+o.width,d.x+d.width),s=m,m=t(s+o.height,d.y+d.height),p<=a&&a<r&&s<=b&&b<m)return!0;return!1}function T(a){return 8*(a.textIndent||0)}function U(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,r,s,t=d&&d.sheet;if(t){if(f=t.yl,g=b.font||f.Bl(),c>1&&(g=f.Cl(g)),h=T(b),b.wordWrap||e){if(b.wordWrap){if(i=d.row,j=d.col,k=d.sheetArea,l=0,m=t.ITa.findSpan(i,j,k)){if(m.row>=i&&m.rowCount<=1&&m.col>=j&&j===m.col&&(l=t.Tl(j),m.colCount>1))for(n=j+1;n<j+m.colCount;n++)l+=t.Tl(n)}else l=t.Tl(j);if(o=q.Wn(a,l-3-h,g),e&&a.split(/\r\n|\r|\n/).length>1){for(p=0,r=0;r<o.length;r++)p=Math.max(p,P(o[r],b.hAlign,g,T(b)).width);return p}e||(a=o.join("\r\n"))}}else a=a.replace(/\s+/g," ");return s=P(a,b.hAlign,g,T(b)),e?s.width:s.height}return 0}d={Eka:function(a,b,c,d,e,f,g,h,i,j){var m,n,o,p,q,r,s,t,v,w=1,x=A,y=g.hAlign,z=g.vAlign,B=h.lineHeight,C=i.length;for(w+=b,1===y?(w=e/2,x="center"):2===y&&(w=e-1,w-=b,x="right"),a.textAlign!==x&&(a.textAlign=x),m=1,n="alphabetic",o=h.fontInfo.fontSize,p=o>8?u((o-8)/5+2):1,q=B/2-o/2+p-1,m+=B-q,1===z?B<f&&(m=l?(f-j)/2+1:k.msie?(f-j)/2+.5:(f-j)/2,u(m)!==m&&(m+=.5),m+=B/2-q):2===z&&(m=f-j-2.5-q),a.textBaseline!==n&&(a.textBaseline=n),r=d+m,s=0;s<C;s++)a.fillText(i[s],c+w,r),t=a.measureText(i[s]).width,v=g.textDecoration,v&&this.ip(a,v,c+w,r,t,o,p),r+=B},Fka:function(a,b,c,d,f,g,h,i,j){var k,l,m,n,o,p,q,r=h.hAlign,t=h.vAlign,v=i.lineHeight,w=j.length,x=0,y=0,z=0,A=0;for(2!==r&&(z=1),2===h.vAlign&&(A=-2.5),A-=s(0,Math.round(v/9)-1),a.strokeStyle!==a.fillStyle&&(a.strokeStyle=a.fillStyle),o=i.fontInfo.fontSize,p=u((o-12)/21+1),a.lineWidth=p,a.beginPath(),q=0;q<w;q++)k=a.measureText(j[q]).width,n=O(new e.Rect(c,d,f,g),k,v*w,r,t,b),l=z+c+n.x,m=l+k,x=A+d+n.y+v,u(x)===x&&(x+=.5),y=x,a.moveTo(l,x),a.lineTo(m,y),a.stroke(),A+=v},paintValue:function(a,b,c,d,e,f,g,j){var k,l,m,n,o,p,r,s,t,u,v,w,x,y,z,A,B,C,D=this;if(a&&(k=D.getText(b,j),!h(k))){for(k+="",l=k.split(/\r\n|\r|\n/),m=0;m<l.length;)l[m]=l[m].replace(/\s+/g," "),m++;k=l.join("\r\n"),n=!1,o=j.sheet.ITa,p=j.row,r=j.col,s=j.sheetArea,t=o.getValueForKey(p,r,K,s),t&&(D.yn===t.id?n=t.visited:o.do("setValueForKey",p,r,K,void 0,s)),a.save(),a.beginPath(),u=n?D._visitedLinkColor:D._linkColor,u&&a.fillStyle!==u&&(a.fillStyle=u),v=g.font,v&&a.font!==v&&i.lZa(a,v),w=T(g),j.sheet.outlineColumn&&j.sheet.outlineColumn.XQa(j.col)&&(w=0),x=g.wordWrap,y=[],z=0,A=0,x?(B=e-3-w,B-=1,y=q.Wn(k,B,v),z=y.length,z>1&&0!==g.vAlign&&(C=j.lineHeight,A=(z-1)*C)):y.push(k),a.rect(c,d,e,f),a.clip(),a.beginPath(),D.Eka(a,w,c,d,e,f,g,j,y,A),D.Fka(a,w,c,d,e,f,g,j,y),a.restore()}},getText:function(a,b){return this._text||a},tw:function(a,b,c,d){if(!a.HF){var e=a.parent;e&&e.tw(a,b,c,d)}},getHitInfo:function(a,b,c,d,e){var f,g=this;return e&&(f=e.sheetArea,(h(f)||3===f)&&c&&d)?{x:a,y:b,row:e.row,col:e.col,cellStyle:c,cellRect:d,sheetArea:f,isFocusAware:!0,sheet:e.sheet,isReservedLocation:S(a,b,c,d,e,g._text)}:r},processMouseDown:function(a){var b=a&&a.sheet,c=this;b&&!b.isEditing()&&a.isReservedLocation&&(c.AK=!0)},processMouseUp:function(a){var b,c=a&&a.sheet;c&&!c.isEditing()&&(b=this,a.isReservedLocation&&b.AK&&b.Eia(a),b.AK=!1)},processMouseMove:function(a){var b,c=a.row,d=a.col,e=a.sheet,f=this;!e||e.isEditing()&&e.getActiveRowIndex()===c&&e.getActiveColumnIndex()===d||(b=e.Ws(),a.isReservedLocation?b&&(f.BK(e,a),b.style.cursor="pointer"):(f.CK(e),b&&(b.style.cursor=H)))},processMouseLeave:function(a){var b,c=a.sheet,d=this;d.AK=!1,d.CK(c),c&&(b=c.Ws(),b&&(b.style.cursor=H))},BK:function(a,b){var c,d,e,f,g,h,i=this;i._linkToolTip&&(c=i.DK(),d=o(c),d.text(i._linkToolTip),e=a.mm.bG(),f=e.left+b.x,g=e.top+b.y+20,0===d.parent().length&&(h=a&&a.zo(),h&&h.insertBefore(c,r),d.css(B,g).css(A,f)))},CK:function(a){var b,c=this;c.EK&&(b=a&&a.zo(),b&&c.EK.parentElement===b&&L(b,c.EK),c.EK=r)},DK:function(){var a,b=this;return b.EK||(a=g(J),o(a).css(w,x).css(y,0).css(C,2).css(D,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(E,G).css(F,I).css(z,"9pt Arial"),b.EK=a),b.EK},isReservedKey:function(a,b){return 32===a.keyCode&&!a.ctrlKey&&!a.shiftKey&&!a.altKey},processKeyUp:function(a,b){var c=b.sheet,d=this;return!!c&&(d.Eia(b),!0)},getAutoFitWidth:function(a,b,c,d,e){return U(this._text||a,c,d,e,!0)},getAutoFitHeight:function(a,b,c,d,e){return U(this._text||a,c,d,e)},isImeAware:function(a){return!1},Eia:function(a){var b=a&&a.sheet,c=this,d=a.row,e=a.col,f=a.sheetArea,g=c.onClickAction();g.call(this,a),b.ITa.do("setValueForKey",d,e,K,{id:c.yn,visited:!0},f),b.repaint(b.getCellRect(d,e)),c.tw(b,d,e,f)},onClickAction:function(a){return 0===arguments.length?this._onAction:(a&&(this._onAction=a),this)},toJSON:function(){var a,c=this,d={typeName:c.typeName};return p(b,function(b,e){a=c["_"+b],a!==e&&(d[b]=a)}),d},fromJSON:function(a){var c=this;p(b,function(b){var d=a[b];h(d)||(c["_"+b]=d)})},a5:function(a){},gQa:function(){var a,c=this,d=new M;return p(b,function(b,e){a=c["_"+b],a!==e&&(d["_"+b]=a)}),d._onAction=c._onAction,d}},p(b,function(a){d[a]=function(b){return 0===arguments.length?this["_"+a]:(this["_"+a]=b,this)}}),o.extend(M.prototype,d),M.wK=function(){var a=this;return h(a.yn)&&(a.yn=0),"id_"+a.yn++},m.HyperLink=M,m._o[8]=M,a.exports=m}()},function(a,b,c){!function(){"use strict";var b,d,e,f,g,h,i,j,k,l,m,n,o=c(2),p=c(3),q=o.Ul.Nl,r=p.j.Fa,s=o.Ul,t=s.nl,u=o.CellTypes,v=u.Base,w=o.GC$,x=w.extend,y=w.each,z=s.hZa,A=s.Nzb,B=document,C=null,D=void 0,E=Math.max,F=parseInt,G="click",H="keydown",I="mouseover",J="mouseout",K="position",L="absolute",M="font",N="left",O="top",P="gcUIElement",Q="tabindex",R="none",S="width",T="height",U="outline",V="box-sizing",W="color",X="background-color",Y="z-index",Z="display",$="content-box",_="white",aa="black",ba="title",ca="div",da="span",ea="text",fa="value",ga="border",ha=s.K_a;function ia(a,b){a.appendChild(b)}function ja(a,b){a.removeChild(b)}function ka(a){return a&&a.parentNode.parentNode.comboBox}u.EditorValueType={text:0,index:1,value:2},b=17,d=20,e=0,f=1,g=1,h=f,i="EndEdit.gcEditingInput",j=18,k="lightgrey",l="#1E90FF",m={editorValueType:0,items:C,itemHeight:22,editable:!1,maxDropDownItems:d},w.inherit(la,v);function la(){var a=this;v.call(a),a.typeName="7",a.DF=!1,a.GK=!1,y(m,function(b,c){"items"===b&&(c=[]),a["_"+b]=c})}function ma(a,b){return a.hasOwnProperty(b)}n={isReservedKey:function(a,b){return this.GK},paintValue:function(a,c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r=this,s=i.sheet,t=s.zoom?s.zoom():1,v=b,w=E(0,f-v-1);3===h.hAlign&&(h.hAlign=0),h.wordWrap&&(h.wordWrap=!1),w>0&&g>0&&(j={},i.quotePrefix=h.quotePrefix,l=h.formatter&&"General"!==h.formatter,m=h._autoFormatter&&h._autoFormatter.formatCached&&"General"!==h._autoFormatter.formatCached,o=this.getItemValue(c),n=l?h.formatter:m?h._autoFormatter:u.Context.wzb(a,o,w+1,h,t),k=this.format(ha(c),n,j,i),k&&(p=h.isVerticalText,A(o)&&!p&&h.shrinkToFit!==!0&&(q=u.Context.xzb(a,k,w+1,h,t),k!==q&&(delete j.content,h.textIndent=0),k=q),this.paintText(a,r.getText(c,i),d,e,w,g,h,i,k,j))),a.save(),(v>f||v>g)&&(a.rect(d,e,f,g),a.clip()),a.beginPath(),a.lineWidth=2,a.fillStyle=aa,a.moveTo(d+f-v+3,e+(g-2)/2-2.5),a.lineTo(d+f-v+6,e+(g-2)/2+3.5),a.lineTo(d+f-v+9,e+(g-2)/2-2.5),a.fill(),a.restore()},getText:function(a,b){return a},createEditorElement:function(a,b){var c,d=a&&a.sheet,e=d&&d.parent,f=e&&e.qo,g=s.vl(f)+1e3,h=d.defaults,i=this,j=new na(b,0,0,h.colWidth,h.rowHeight,g);return j.editorValueType(i._editorValueType),j.items(i._items),j.itemHeight(i._itemHeight),j.itemCountPerPage(i._maxDropDownItems),j.editable(i._editable),c=j.getComboBox(),Object.defineProperty(c,"comboBox",{get:function(){return this.ixb},set:function(a){this.ixb!==a&&(this.ixb&&this.ixb.dispose(),this.ixb=a)}}),c.comboBox=j,C},getEditorValue:function(a,b){var c=ka(a);return c&&(this.DF=!c.HK),c&&c.editorValue()},setEditorValue:function(a,b,c){var d=ka(a);d&&d.editorValue(b)},focus:function(a,b){var c=ka(a);c&&c.focus()},selectAll:function(a,b){var c=ka(a);c&&c.selectAll()},activateEditor:function(a,b,c,d){var e=this,f=d.sheet,g=ka(a);g&&(g.editorValueType(e._editorValueType),g.items(e._items),g.itemHeight(e._itemHeight),g.itemCountPerPage(e._maxDropDownItems),g.editable(e._editable),g.bind(i,function(a,b){var c,d,e,h,i,j=b.keyCode;if(j){if(c=f.wu(),d=c.getShortcutKey(j,!1,!1,!1,!1),e=c.getCommands(d))for(h=0,i=e.length;h<i;h++)if("navigationLeft"!==e[h].Cj&&"navigationRight"!==e[h].Cj||(f.Px=1),e[h].execute(f.parent,{sheetName:f.name()}))return!0}else b.isMouse&&g.IK&&f.endEdit()})),e.GK=!0},deactivateEditor:function(a,b){if(a){var c=ka(a);c&&(c.unbind(i),c.closeDropDownList(),c.IK=!1)}this.GK=!1},updateEditor:function(a,b,c,d){var e,f,g=a&&d&&d.sheet;g&&(e=ka(a),b&&e&&(f=g.yl,e.updateStyle(b.backColor,b.foreColor,f.Cl(b.font||f.Bl()))),c&&e&&e.updateLocationAndSize(c.x,c.y,c.width,c.height))},format:function(a,b,c,d){var e,f;return r(a)?"":(e=this,f=e.getItemValue(a),v.prototype.format.call(e,f||a,b,c))},getItemValue:function(a){var b,c,d,e,f,g=this,h=g._editorValueType,i=g._items;if(i)if(d=i.length,1===h){if(e=F(a),0<=e&&e<d&&(b=i[e],b!==D&&b!==C))return c=ma(b,ea)?b.text:b}else if(2===h)for(f=0;f<d;f++)if(b=i[f],b&&ma(b,fa)&&b.value===a)return c=b.text},parse:function(a,b,c){var d,e,f,g=this,h=g._editorValueType,i=g._items,j=v.prototype.parse.call(g,a,b);if(i){if(f=i.length,0===h)return j;if(1===h){for(e=0;e<f;e++)if(d=i[e],d&&ma(d,ea)&&d.text===j||d===j)return e}else if(2===h)for(e=0;e<f;e++)if(d=i[e],d&&ma(d,ea)&&d.text===j)return d.value}return j},getHitInfo:function(a,c,d,e,f){var g,h,i,j;return f?(g=f.sheetArea,h=f.sheet,(r(g)||3===g)&&e&&(i=e.x+e.width,j={x:a,y:c,row:f.row,col:f.col,cellStyle:d,cellRect:e,sheetArea:g,sheet:h},i-b<=a&&a<i)?(j.isReservedLocation=!0,j):C):C},processMouseDown:function(a){var b,c=a.sheet,d=a.sheetArea;(r(d)||3===d)&&a.isReservedLocation&&c&&(c.startEdit(),b=ka(c.BF),b&&(s.Ml.mozilla&&(b.JK=(new Date).valueOf()),b.showDropDownList(),b.IK=!0))},getAutoFitWidth:function(a,c,d,e,f){d&&d.wordWrap&&(d.wordWrap=!1);var g=u.Context.cp(a,c,d,e,f);return g+b},getAutoFitHeight:function(a,b,c,d,e){return c&&c.wordWrap&&(c.wordWrap=!1),u.Context.ep(a,b,c,d,e)},isImeAware:function(a){return!0},gQa:function(){},toJSON:function(){var a,b=this,c={typeName:b.typeName};return y(m,function(d,e){a=b["_"+d];var f="items"===d?a&&a.length>0:a!==e;f&&(c[d]=a)}),c},fromJSON:function(a){var b=this;y(m,function(c){var d=a[c];r(d)||(b["_"+c]=d)})}},y(m,function(a){n[a]=function(b){return 0===arguments.length?this["_"+a]:(this["_"+a]=b,this)}}),x(la.prototype,n),u.ComboBox=la,u._o[7]=la;function na(a,c,f,g,h,j){var k,l,m,n,p,s,t,u,v=this;v.KK=a,k=a.firstChild,w(a).bind(H,function(a){v.LK(a)}).css(Y,j||0).css(N,c).css(O,f).css(S,g).css(T,h).css("overflow","visible").attr(P,"gcComboBox"),l=E(0,g-b),v._editable=!1,v.MK=m=q(ca),v.NK=n=q("textarea"),v.PK=m,ia(k,m),oa(m),oa(n),w(n).bind("keyup",function(){var a,b=v.PK.value;v._text=b,a=v.QK(b),v.editorValue(a),v.RK(b),v.SK()}).bind(I,function(){v.TK()}).bind(J,function(){v.SK()}),w(m).bind(G,function(){v.IK?v.Wq(i,{isMouse:!0}):v.UK()}).bind(I,function(){v.TK()}).bind(J,function(){v.SK()}),v.VK(0,0,l,h),p=v.WK=q(ca),ia(k,p),w(p).css(ga,R).css(K,L).css(X,_).css(V,$).attr(P,"gcDropDownButton").bind(G,function(){var a,b;!r(v.JK)&&(a=v.JK,v.JK=D,b=(new Date).valueOf(),b-a<100)||(v.IK?v.Wq(i,{isMouse:!0}):v.UK())}),s=q("canvas"),v.Xs=s,v.XK(l,0,g-l,h),ia(p,s),t=v.YK=q(ca),ia(k,t),v.ZK=!1,w(t).css(K,L).css(ga,"1px solid").css(X,_).css(Y,j||0).css(U,R).css(Z,R).css("cursor","default").css(V,$).attr(P,"gcDropDownWindow").attr(Q,-1).css(S,g-2*e).css(T,h),v.$K(0,h-2*e),v._K=0,u=v.aL=q(ca),ia(t,u),v.bL=new o.IB(t,u),v._itemHeight=22,v.cL=d,v.dL=-1,v._editorValueType=0,v._items=[]}function oa(a){w(a).css("margin",0).css("overflow","hidden").css("resize",R).css(K,L).css("padding",g+"px 0px 0px "+f+"px").css(U,R).css(X,_).css("white-space","nowrap").css(V,$).css(ga,R).attr(P,"gcComboBoxEditor").attr(Q,-1)}x(na.prototype,{getComboBox:function(){return this.KK},dispose:function(){var a=this;w(a.KK).unbind(H),w(a.NK).unbind("keyup").unbind(I).unbind(J),w(a.MK).unbind(G).unbind(I).unbind(J),w(a.WK).unbind(G),w(a.aL).find("div").forEach(function(a){w(a).unbind(I).unbind(J).unbind(G)}),a.bL.dispose()},updateLocationAndSize:function(a,c,d,f){var g=this,h=E(0,d-b);g.VK(0,0,h,f),g.XK(h,0,d-h,f),g.$K(0,f-2*e),g.listWidth(d-2*e),g.eL()},updateStyle:function(a,b,c){var d=this;c=z(c),a=a?a:D,w(d.PK).css(X,a).css(W,b).css(M,c),w(d.WK).css(X,a).css(W,b).css(M,c),w(d.YK).css(X,a).css(W,b).css(M,c),w(d.KK).css(X,"transparent")},editorValueType:function(a){return 0===arguments.length?this._editorValueType:(this._editorValueType=a,this)},editorValue:function(a){var b,c=this;return 0===arguments.length?c.fL:(a!==c.fL&&(c.fL=a,b=c.gL(a),c.text(b),c.RK(b,!0)),c)},gL:function(a){var b,c,d,e,f=this,g=f._items,h=g.length,i=f._editorValueType;if(f.HK=!0,1===i)c=g[a],b=c&&ma(c,ea)?c.text:c,b===D&&(b=a,f.HK=!1);else if(0===i){for(b=a,d=0;d<h&&(c=g[d],!(c&&ma(c,ea)&&c.text===a||c===a));d++);d>=h&&(f.HK=!1)}else if(2===i){for(e=0;e<h;e++)if(c=g[e],c&&ma(c,fa)&&c.value===a){b=c.text;break}e>=h&&(b=a,f.HK=!1)}return r(a)&&(b=""),b},QK:function(a){var b,c,d,e=this,f=e._items,g=f.length,h=e._editorValueType,i=a;if(1===h)for(c=0;c<g;c++)b=f[c],(b&&ma(b,ea)&&b.text===a||b===a)&&(i=c);else if(2===h)for(d=0;d<g;d++)b=f[d],b&&ma(b,ea)&&b.text===a?i=b.value:b===a&&(i=D);return i},RK:function(a,b){var c,d,e,f;if(a){for(d=this._items,e=d.length,c=0;c<e&&(f=d[c],ma(f,ea)&&(f=f.text),(b?f:(""+f).substr(0,a.length))!==a);c++);c>=e&&(c=-1)}else c=-1;this.hL(c)},SK:function(){w(this.PK).removeAttr(ba)},TK:function(){var a=this,b=a.Xn(a._text),c=w(a.PK),d=c.width();b>d+f?c.attr(ba,a._text):c.removeAttr(ba)},VK:function(a,b,c,d){c-=e,d-=2*e,w(this.PK).css(N,a).css(O,b).css(S,c-f).css(T,d-g)},updateImeMode:function(a,b){if(this.isImeAware()){var c=ka(a);c&&c.PK&&w(c.PK).css("ime-mode",b)}},editable:function(a){var b,c,d,e,f,g=this;return 0===arguments.length?g._editable:g._editable!==a?(g._editable=a,b=g.KK.firstChild,c=g.PK,d=w(c),e={left:F(d.css(N)),top:F(d.css(O)),width:F(d.css(S)),height:F(d.css(T))},f={backColor:d.css(X),foreColor:d.css(W),font:c.style.font},ja(b,c),g.PK=a?g.NK:g.MK,ia(b,g.PK),w(g.PK).css(X,f.backColor).css(W,f.foreColor).css(M,f.font),g.VK(e.left,e.top,e.width,e.height),g):void 0},text:function(a){var b=this,c=b.PK;return 0===arguments.length?b._text:void(a!==b._text&&(b._text=a,b._editable?c.value=a:c.textContent=a))},focus:function(){var a=this,b=a.PK;b.focus(),a._editable&&(b.selectionStart=b.value.length)},selectAll:function(){var a=this;a._editable&&a.PK.select()},XK:function(a,c,d,f){var g,h,i,j,k;d-=e,f-=2*e,g=this,h=g.Xs,w(g.WK).css(N,a).css(O,c).css(S,d).css(T,f),w(h).attr(S,d).attr(T,f),i=h.width,j=h.height,k=h.getContext("2d"),k.beginPath(),k.lineWidth=2,k.fillStyle=aa,k.moveTo(i-b+4,(j-2)/2-2.5),k.lineTo(i-b+7,(j-2)/2+3.5),k.lineTo(i-b+10,(j-2)/2-2.5),k.fill()},showDropDownList:function(){var a=this,b=a.bL;a.ZK=!0,w(a.YK).bind(H,function(b){a.LK(b)}).show(),a.iL=!1,a.jL(),a.eL(),a.iL&&(b.lB(w(a.aL.children).height()),b.ew(!1)),a.kL(l),a.lL(a.dL),a.focus()},closeDropDownList:function(){var a=this;a.ZK=!1,w(a.YK).unbind(H).hide(),a.kL(""),a.focus()},UK:function(){this.ZK?this.closeDropDownList():this.showDropDownList()},listWidth:function(a){var b=this,c=w(b.YK);return 0===arguments.length?c.width():void(a>0&&(c.width(a),b.bL.ew(!1)))},listHeight:function(a){var b=this,c=w(b.YK);return 0===arguments.length?c.height():void(a>0&&(c.height(a),b.bL.ew(!1)))},$K:function(a,b){w(this.YK).css(N,a).css(O,b)},items:function(a){var b,c,d,e,f,g=this;if(0===arguments.length)return g._items;if(a){for(g._items=a,b=g.aL,w(b).find("div").forEach(function(a){w(a).unbind(I).unbind(J).unbind(G)});c=b.firstChild;)ja(b,c);for(g._K=0,d=0,e=a.length;d<e;d++)f=a[d],g.mL(ma(f,ea)?f.text:f);return g}},mL:function(a){var b=this,c=q(ca),d=q(da);d.textContent=""+a,d.style.paddingLeft=h+"px",ia(c,d),ia(b.aL,c),b._K++,w(c).bind(G,function(){var a=w(c).index();b.selectedIndex(a),b.closeDropDownList(),b.Wq(i,{isMouse:!0})}).bind(I,function(){var a=w(c);c.oldBackColor=a.css(X),a.css(X,k)}).bind(J,function(){w(c).css(X,c.oldBackColor||"")})},nL:function(){var a=this;a.Po=q(da),w(a.Po).css(Z,R).css(M,a.YK.style.font).appendTo(B.body)},oL:function(){ja(B.body,this.Po)},pL:function(a){return this.Po.textContent=a,w(this.Po).width()+2+h},kL:function(a){var b=this,c=b.dL;0<=c&&c<b._K&&w(b.aL.children[c]).css(X,a)},LK:function(a){var b,c,d,e=this,f=a.keyCode,g=a.which;a.ctrlKey||a.shiftKey||a.altKey||a.metaKey||(37===g||39===g)&&e.editable()||(b=e._K,c=e.dL,d=0,38===g||40===g?(c>=0&&c<b&&(d=c+(38===g?-1:1)),d>=0&&d<b&&e.selectedIndex(d),e.ZK&&e.lL(d),t(a)):13===g||37===g||39===g||9===g?(e.selectedIndex(e.dL),e.closeDropDownList(),e.Wq(i,{keyCode:f}),t(a)):27===g&&(e.closeDropDownList(),e.Wq(i,{keyCode:f}),t(a)))},getSelectedValue:function(a,b,c){var d,e=b[a];return r(e)||(1===c?d=a:0===c?d=ma(e,ea)?e.text:e:2===c&&ma(e,fa)&&(d=e.value)),d},hL:function(a){var b=this;b.kL(""),b.dL=a,b.kL(l),b.lL(a)},selectedIndex:function(a){var b,c=this;return 0===arguments.length?c.dL:void(0<=a&&a<c._K&&(c.hL(a),b=c.getSelectedValue(c.dL,c._items,c._editorValueType),r(b)||c.editorValue(b)))},itemCountPerPage:function(a){return 0===arguments.length?this.cL:void(a>0&&(this.cL=a))},Xn:function(a){this.nL();var b=this.pL(a);return this.oL(),b},itemHeight:function(a){return 0===arguments.length?this._itemHeight:void(a>0&&(this._itemHeight=a))},jL:function(){var a,b,c,d,e,f=this;f.nL(),a=f._items[0],b=E(f._itemHeight,w(f.Po).text(r(a)?"":a).height()),w(f.aL.children).css(T,b),d=f._K,e=f.cL,d<=e?c=d*b:(c=e*b,f.iL=!0),f.listHeight(c),f.oL()},eL:function(){var a,b,c,d,e,f,g=this;if(g.nL(),a=0,c=g._items)for(d=0,e=c.length;d<e;d++)f=c[d],b=g.pL(ma(f,ea)?f.text:f),a<b&&(a=b);g.oL(),g.listWidth()<a+j&&g.listWidth(a+j)},lL:function(a){if(a>=0&&a<this._K){var b=this.aL.children[a];this.bL.BB(b)}},bind:function(a,b,c){w(this.KK).bind(a,b,c)},unbind:function(a,b){w(this.KK).unbind(a,b)},Wq:function(a,b){w(this.KK).trigger(a,b)}}),a.exports=u}()}]);