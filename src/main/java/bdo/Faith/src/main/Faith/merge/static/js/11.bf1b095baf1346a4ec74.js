webpackJsonp([11],{"3BhD":function(e,t){},UVLa:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i("mvHQ"),s=i.n(o),r=i("pFYg"),n=i.n(r),a=i("ABj6"),l=i("ZHXk"),c=i.n(l),u=(i("0RKR"),{components:{BdoTable:a.a},prop:"mergeNoteInfo",props:{customerData:Array},computed:{refreshImportRelate:function(){return this.$store.state.refreshPagesMenuId}},watch:{refreshImportRelate:{handler:function(e){("object"===(void 0===e?"undefined":n()(e))&&e.menuID===this.flag&&window.location.hash.indexOf("/MergeNoteInfo")>-1||e===this.flag)&&this.handleCustomerInformation()},immediate:!0,deep:!0}},data:function(){return{dataNum:0,flag:"HB006-MNI001",columnTitle:"",colName:"",curYear:"",noteInfo:[],mergeInfo:[],editDialogVisible:!1,modifyNoteName:"",uploadDialogVisible:!1,excelName:"",excelFile:"",currentRow:{},fullscreenLoading:!1,rowMergeProjectId:null,curAutoId:null,tableHeight:430,customerId:"",curProjectId:"",projectId:"",isSingle:!1,customerName:"",projectName:"",buttonTitle:"初始化合并附注",allAlign:"right",isShort:!1,isPreCheckSort:!1,isNoteNoSort:!1,fullScreen:!1,batchUploadDialogVisible:!1,mergeTableVisible:!1,uploadFileList:[],filedata:[],columns:[{label:"操作",prop:"action"},{label:"项目简称",prop:"shortName",width:"100"},{label:"审定数",prop:"auditedAmount",width:"200"},{label:"年初数",prop:"preAuditAmount",width:"200"},{label:"本期校验",prop:"curCheck",width:"200"},{label:"上期校验",prop:"preCheck",width:"200"},{label:"状态",prop:"isCompleteNow",width:"80"},{label:"更新人",prop:"__ulastUpdatedUserName",width:"80"},{label:"更新时间",prop:"lastUpdateDate",width:"160"}],requestParam:{}}},methods:{cellClickEvent:function(e){var t=e.row,i=e.column;this.columnTitle="","审定数"!=i.title&&"年初数"!=i.title||(this.mergeTableVisible=!0,this.colName=t.colName,this.viewAllSubNoteInfo(),this.columnTitle=t.colName)},footerMethod:function(e){var t=this,i=e.columns,o=e.data;return[i.map(function(e,i){return 0===i?"合计":["preAuditAmount","auditedAmount","curCheck","preCheck"].includes(e.property)?t.countAmount(c.a.sum(o,e.property,{digits:2})):["preAuditAmountRate","auditedAmountRate"].includes(e.property)?100*t.countAmount(c.a.sum(o,e.property,{digits:2}))+"%":null})]},viewAllSubNoteInfo:function(){var e=this,t=JSON.parse(sessionStorage.getItem("curCustomerData")),i=(t.curProjectId,t.curCustomerId,t.curYear,{customerId:this.customerId,projectId:this.projectId,yyyy:this.curYear,noteName:this.colName});this.$sacpApis.viewAllSubNoteInfo(i).then(function(t){e.mergeInfo=t.data[0].list}).catch(function(e){}).finally(function(){})},fullScreenChange:function(){this.fullScreen=!this.fullScreen},refreshTable:function(){this.currentPageInit()},noteNoSort:function(e){var t=[];t=this.isNoteNoSort?this.noteInfo.sort(function(e,t){return Number(e.sortNo)-Number(t.sortNo)}):this.noteInfo.sort(function(e,t){return Number(e.sortNo)-Number(t.sortNo)}).reverse(),this.isNoteNoSort=!this.isNoteNoSort,this.noteInfo=t},preCheckSort:function(e){"curCheck"==e&&(this.isShort?this.isShort=!1:this.isShort=!0),this.isPreCheckSort?this.isPreCheckSort=!1:this.isPreCheckSort=!0,this.handleSortData(this.noteInfo,e)},editNoteInfo:function(e){this.currentRow=e,this.modifyNoteName=e.noteName,this.editDialogVisible=!0},submitEditInfo:function(){this.editDialogVisible=!1,this.currentRow.noteName=this.modifyNoteName},uploadNoteInfo:function(e){this.curAutoId=e.autoId,this.uploadDialogVisible=!0},batchUploadNoteInfo:function(e){this.curAutoId=e.autoId,this.batchUploadDialogVisible=!0},importExcel:function(){this.$refs.uploadExcel.click()},readExcel:function(e){var t=e.target.files;this.excelName=t[0].name,this.excelFile=this.$refs.uploadExcel.files[0]},confirUpload:function(){var e=this;this.uploadDialog=!1;var t=this.excelName.split(".");if("xlsx"!=t[t.length-1])return this.$message.error("仅支持.xlsx类型文件!");var i=new FormData;i.append("file",this.excelFile),this.$sacpApis.uploadExcel(i).then(function(t){if(t.success){e.$message.success("上传成功");e.$refs.uploadExcel;var i={fileId:t.data[0].fileId};e.uploadSuccessCB(i),e.$eventBus.$emit("page-refresh",t.resultInfo.refreshIndexes)}else{var o=t.resultInfo.statusText;e.$message.error(o)}})},batchUploadBut:function(){this.batchUploadDialogVisible=!0},batchUpload:function(){var e=this;return this.uploadFileList.some(function(e){return"xlsx"!==e.name.split(".")[e.name.split(".").length-1]})?this.$message.error("仅支持.xlsx类型文件!"):this.uploadFileList&&this.uploadFileList.length?(this.filedata=new FormData,this.uploadFileList.map(function(t,i){e.filedata.append("file"+i,t)}),void this.$sacpApis.bulkUpload(this.filedata).then(function(t){if(t.success)e.uploadFileList=[],e.filedata=[],e.uploadAllNoteInfo(t.data),e.$eventBus.$emit("page-refresh",t.resultInfo.refreshIndexes);else{var i=t.resultInfo.statusText;e.$message.error(i)}})):this.$message.error("请上传文件!")},uploadAllNoteInfo:function(e){var t=this,i=JSON.parse(sessionStorage.getItem("curCustomerData")),o=(i.curProjectId,i.curCustomerId,i.curYear),s={customerId:this.customerId,mergeProjectId:this.curProjectId,projectId:this.projectId,yyyy:o,fileId:e};this.$sacpApis.uploadAllNoteInfo(s).then(function(e){e.success?(t.batchUploadDialogVisible=!1,t.$message.success("上传成功"),t.currentPageInit()):t.$message.error(e.resultInfo.statusText)}).catch(function(e){t.$message.error(e)}).finally(function(){t.fullscreenLoading=!1,t.batchUploadDialogVisible=!1})},cancelUpload:function(){this.batchUploadDialogVisible=!1,this.uploadFileList=[],this.filedata=[]},uploadChange:function(e,t){if(this.uploadFileList.some(function(t){return t.name==e.name}))return this.$message.warning("不可以重复上传相同文件名文件,请删除!");this.uploadFileList.push(e.raw)},beforeRemove:function(e,t){this.uploadFileList=this.uploadFileList.filter(function(t){return t.name!=e.name})},downloadAllNoteInfo:function(){var e=this,t=JSON.parse(sessionStorage.getItem("curCustomerData")),i=t.curProjectId,o=(t.curCustomerId,t.curYear),s=(t.curProjectName,{customerId:this.customerId,mergeProjectId:this.curProjectId,projectId:this.projectId,yyyy:o}),r=i+"-合并附注-"+(new Date).getTime();this.$sacpApis.downloadAllNoteInfo(s,r).then(function(e){e.success}).catch(function(t){e.$message.error(t)})},uploadSuccessCB:function(e){var t=this,i={fileId:e.fileId,autoId:this.curAutoId};this.$sacpApis.mergeNoteInfoUploadCB(i).then(function(e){e.success?t.uploadDialogVisible=!1:t.$message.error(e.resultInfo.statusText)}).catch(function(e){t.$message.error(e)}).finally(function(){t.fullscreenLoading=!1,t.uploadDialogVisible=!1,t.excelFile="",t.excelName="",t.typeValue=""})},downloadNoteInfo:function(e){var t={autoId:e.autoId};this.$sacpApis.mergeNoteInfoDownLoad(t,e.fileName)},editFile:function(e){var t={extraOptions:e,currentNode:{extraOptions:e}};t.autoId=t.extraOptions.autoId,sessionStorage.setItem("mergeNoteInfoNode",s()(t)),window.open("/Faith/dgcenter.do?m=openMergeNoteInfo&noteNo="+t.extraOptions.noteNo)},resetFile:function(e){var t=this;this.fullscreenLoading=!0;var i={customerId:this.customerId,projectId:this.projectId,autoId:e.autoId};this.$sacpApis.singleNoteInfoReset(i).then(function(e){e.success?(t.$message.success("重置文件成功"),t.currentPageInit(),e.resultInfo.refreshIndexes&&t.$eventBus.$emit("page-refresh",e.resultInfo.refreshIndexes)):t.$message.error(e.resultInfo.statusText)}).catch(function(e){return t.$message.error(e)}).finally(function(){return t.fullscreenLoading=!1})},isDisabledAndFinished:function(e,t,i,o){var s=this,r={customerId:this.customerId,projectId:this.projectId,mergeProjectId:t.mergeProjectId,noteId:t.autoId,type:o,value:""};switch(o){case"forbid":this.$confirm("确定要禁用这条数据吗？","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.value=e?"1":"0",s.mergeNoteInfoDisabledFinished(r,o,t)}).catch(function(i){t.isForbid=!e});break;case"finish":r.value=e?"1":"0",this.mergeNoteInfoDisabledFinished(r,o,t)}},mergeNoteInfoDisabledFinished:function(e,t,i){var o=this;this.fullscreenLoading=!0,this.$sacpApis.mergeNoteInfoDisabledFinished(e).then(function(e){if(e.success){o.fullscreenLoading=!1;var s="";switch(t){case"forbid":s="禁用状态更新成功!";break;case"finish":s="已完成状态更新成功!"}o.$message.success(s)}else"finish"===t&&(i.isFinished=!1),o.$message.error(e.resultInfo.statusText)}).catch(function(e){return o.$message.error(e)}).finally(function(){o.fullscreenLoading=!1})},initMergeNoteInfo:function(){var e=this;this.fullscreenLoading=!0;var t={customerId:this.customerId,projectId:this.projectId};this.$sacpApis.mergeNoteInfoInitBtn(t).then(function(t){t.success?(e.currentPageInit(!0),e.$message.success("初始化合并附注成功!")):e.$message.error(t.resultInfo.statusText)}).catch(function(t){return e.$message.error(t)})},currentPageInit:function(e){var t=this;this.fullscreenLoading=!0,this.requestParam={customerId:this.customerId,mergeProjectId:this.curProjectId,projectId:this.projectId},this.$sacpApis.mergeNoteInfoInit(this.requestParam).then(function(i){i&&i.success?i.data&&(i.data.forEach(function(t){"0"===t.isForbid?(t.isForbid=!1,"0"===t.isFinished?t.isFinished=!1:t.isFinished=!0):t.isForbid=!0,t.curCheck&&void 0===t.preCheck&&(t.isForbid=!1),e&&0===t.preAuditAmount&&0===t.auditedAmount&&(t.isForbid=!0)}),t.noteInfo=i.data,t.dataNum=i.data.length):t.$message.error(i.resultInfo.statusText)}).catch(function(e){return t.$message.error(e)}).finally(function(){t.fullscreenLoading=!1,t.$store.commit("setRemoveBagdeScope","MergeNoteInfo")})},handleSortData:function(e,t){var i=[],o=[],s=[],r=[];e.forEach(function(e){e[t]>0?i.push(e):e[t]<0&&Math.abs(e[t])>0?o.push(e):0==e[t]?s.push(e):e[t]||r.push(e)});var n=[];if(this.isPreCheckSort||this.isShort)n="curCheck"==t?i.sort(this.sortCurCheck).reverse().concat(o.sort(this.sortCurCheck).reverse()).concat(s).concat(r):i.sort(this.sortNumber).reverse().concat(o.sort(this.sortNumber).reverse()).concat(s).concat(r),this.noteInfo.forEach(function(e){"1"===e.isForbid?e.isHidden=!0:e.isHidden=!1}),this.noteInfo=n.sort(function(e,t){return Number(e.sortNo)-Number(t.sortNo)});else{if("curCheck"==t){var a=i.sort(this.sortCurCheck).reverse(),l=o.sort(this.sortCurCheck).reverse();n=a.concat(l).concat(s).concat(r)}else{var c=i.sort(this.sortNumber).reverse(),u=o.sort(this.sortNumber).reverse();n=c.concat(u).concat(s).concat(r)}this.noteInfo=n.sort(function(e,t){return Number(e.sortNo)-Number(t.sortNo)}).reverse()}},commafyFn:function(e){var t=e.cellValue;e.row,e.column;return c.a.commafy(t,{digits:2})},fmtEquity:function(e){var t=e.cellValue;e.row,e.column;return(100*Number(t)).toFixed(2)+"%"},sortNumber:function(e,t){return e.preCheck-t.preCheck},sortCurCheck:function(e,t){return e.curCheck-t.curCheck},countAmount:function(e){var t;return t=e,c.a.commafy(t,{digits:2})},handleCustomerInformation:function(){var e=JSON.parse(sessionStorage.getItem("curCustomerData"));this.customerId=e.curCustomerId,this.projectId=e.curProjectId,this.customerName=e.curCustomerName,this.projectName=e.curProjectName,this.curProjectId=this.projectId,this.curYear=e.curYear,this.currentPageInit()},cellClassName:function(e){var t=e.row,i=(e.rowIndex,e.column);e.columnIndex;return"curCheck"===i.property&&t.curCheck&&0!=t.curCheck?"col-red":"preCheck"===i.property&&t.preCheck&&0!=t.preCheck?"col-red":void 0},refresh:function(){this.handleCustomerInformation()},isFinishedState:function(e){return!!e.isForbid||!(!e.curCheck&&!e.preCheck)&&(e.preCheck||e.curCheck,!0)},exportFile:function(){var e={columns:this.columns,params:{},jsonData:this.requestParam,url:"dgCenter/HbMergeProjectNoteInfo.queryMergeNoteInfo.json",fileName:"合并附注"};this.exportExcel(e)}},created:function(){this.handleCustomerInformation()}}),d={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"mergeNoteInfo"},[o("div",{class:{fullScreen:e.fullScreen?"fullScreen":"",fullScreenBox:!0}},[o("el-container",{staticClass:"container"},[o("el-main",[o("div",{staticClass:"columnsVisiable",staticStyle:{float:"right"}},[o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"批量上传",placement:"top-start"}},[o("el-button",{staticStyle:{"margin-bottom":"8px"},attrs:{type:"primary",size:"small",circle:"",icon:"el-icon-upload2"},on:{click:e.batchUploadBut}})],1),e._v(" "),o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"批量下载",placement:"top-start"}},[o("el-button",{staticStyle:{"margin-bottom":"8px"},attrs:{type:"primary",size:"small",circle:"",icon:"el-icon-download"},on:{click:e.downloadAllNoteInfo}})],1),e._v(" "),o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.buttonTitle,placement:"top-start"}},[o("el-button",{staticClass:"setBtn",staticStyle:{"margin-bottom":"8px"},attrs:{type:"primary",size:"small",circle:"",icon:"el-icon-switch-button"},on:{click:e.initMergeNoteInfo}})],1),e._v(" "),o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"刷新",placement:"top-start"}},[o("el-button",{attrs:{type:"primary",circle:"",icon:"el-icon-refresh",size:"small"},on:{click:e.refreshTable}})],1),e._v(" "),o("el-tooltip",{attrs:{effect:"dark",content:e.fullScreen?"取消全屏":"全屏",placement:"top-start"}},[o("el-button",{class:{fullScreenBtn:!0},attrs:{type:"primary",circle:"",size:"small"},on:{click:e.fullScreenChange}},[e.fullScreen?e._e():o("img",{attrs:{src:i("/Dxn"),alt:""}}),e._v(" "),e.fullScreen?o("img",{attrs:{src:i("W+0t"),alt:""}}):e._e()])],1)],1),e._v(" "),o("div",{staticClass:"showDataLength"},[o("i",{staticClass:"el-icon-s-flag"}),o("span",[e._v("共查询到数据"+e._s(e.dataNum)+"条")]),e._v(" "),o("el-button",{attrs:{size:"mini",icon:"el-icon-refresh",type:"text"},on:{click:e.refresh}},[e._v("刷新")]),e._v(" "),[o("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),o("el-button",{attrs:{size:"mini",icon:"el-icon-download",type:"text"},on:{click:e.exportFile}},[e._v("导出")])]],2),e._v(" "),o("div",{staticClass:"tableDiv"},[o("vxe-table",{ref:"multipleTable",attrs:{resizable:"",border:"",height:"auto","highlight-hover-row":"","show-overflow":"","show-header-overflow":"","highlight-current-row":"","header-align":"center",data:e.noteInfo,"keep-source":"","auto-resize":!0,"cell-class-name":e.cellClassName,"scroll-y":{vSize:1e4}},on:{"cell-dblclick":e.cellClickEvent}},[o("vxe-table-column",{attrs:{title:"操作",width:"160",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return t.rowIndex,[o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"上传",placement:"top-start"}},[o("el-button",{staticClass:"uploadBtnCol",attrs:{size:"small",type:"text",icon:"el-icon-upload normalWeight"},on:{click:function(t){return e.uploadNoteInfo(i)}}})],1),e._v(" "),o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下载",placement:"top-start"}},[o("el-button",{staticClass:"downloadBtnCol",attrs:{size:"small",type:"text",icon:"el-icon-download normalWeight"},on:{click:function(t){return e.downloadNoteInfo(i)}}})],1),e._v(" "),o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑文件",placement:"top-start"}},[o("el-button",{staticClass:"editFileBtnCol",attrs:{size:"small",type:"text",icon:"el-icon-document-copy normalWeight",disabled:"0"===i.isCompleteNow},on:{click:function(t){return e.editFile(i)}}})],1),e._v(" "),o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"重置文件",placement:"top-start"}},[o("el-button",{staticClass:"resetBtnCol",attrs:{size:"small",type:"text",icon:"el-icon-switch-button"},on:{click:function(t){return e.resetFile(i)}}})],1)]}},{key:"header",fn:function(t){var i=t.column;return[o("span",[e._v(e._s(i.title))]),e._v(" "),o("span",{staticClass:"custom-sort",class:{"is-order":e.isNoteNoSort}},[o("i",{class:[e.isNoteNoSort?"vxe-icon--caret-bottom":"vxe-icon--caret-top"],on:{click:function(t){return e.noteNoSort("noteNo")}}})])]}}])}),e._v(" "),o("vxe-table-column",{attrs:{field:"noteName",title:"附注名称","min-width":"100","edit-render":{name:"input"},fixed:"left"}}),e._v(" "),o("vxe-table-column",{attrs:{field:"colName",title:"报表科目","min-width":"150","edit-render":{name:"input"},fixed:"left"}}),e._v(" "),o("vxe-table-column",{attrs:{field:"auditedAmount",title:"审定数","min-width":"200","edit-render":{name:"input"},formatter:e.commafyFn,align:e.allAlign,"header-align":"center"}}),e._v(" "),o("vxe-table-column",{attrs:{field:"preAuditAmount",title:"年初数","min-width":"200","edit-render":{name:"input"},formatter:e.commafyFn,align:e.allAlign,"header-align":"center"}}),e._v(" "),o("vxe-table-column",{attrs:{field:"curCheck",title:"本期校验","min-width":"200","edit-render":{name:"input"},formatter:e.commafyFn,align:e.allAlign,"header-align":"center",sortable:""},scopedSlots:e._u([{key:"header",fn:function(t){var i=t.column;return[o("span",[e._v(e._s(i.title))]),e._v(" "),o("span",{staticClass:"custom-sort",class:{"is-order":e.isShort}})]}}])}),e._v(" "),o("vxe-table-column",{attrs:{field:"preCheck",title:"上期校验","min-width":"200","edit-render":{name:"input"},formatter:e.commafyFn,align:e.allAlign,"header-align":"center",sortable:""},scopedSlots:e._u([{key:"header",fn:function(t){var i=t.column;return[o("span",[e._v(e._s(i.title))]),e._v(" "),o("span",{staticClass:"custom-sort",class:{"is-order":e.isPreCheckSort}})]}}])}),e._v(" "),o("vxe-table-column",{attrs:{field:"isCompleteNow",title:"状态","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return t.rowIndex,["1"===i.isCompleteNow?o("span",[e._v("加载完成")]):"0"===i.isCompleteNow?o("span",[e._v("加载中")]):e._e()]}}])}),e._v(" "),o("vxe-table-column",{attrs:{field:"isForbid",title:"禁用","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row,s=t.rowIndex;return[o("el-checkbox",{on:{change:function(t){e.isDisabledAndFinished(t,i,s,"forbid")}},model:{value:i.isForbid,callback:function(t){e.$set(i,"isForbid",t)},expression:"row.isForbid"}})]}}])}),e._v(" "),o("vxe-table-column",{attrs:{field:"isEdited",title:"已编辑","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return t.rowIndex,[o("el-checkbox",{attrs:{disabled:""},model:{value:i.isEdited,callback:function(t){e.$set(i,"isEdited",t)},expression:"row.isEdited"}})]}}])}),e._v(" "),o("vxe-table-column",{attrs:{field:"isFinished",title:"已完成","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row,s=t.rowIndex;return[o("el-checkbox",{attrs:{disabled:e.isFinishedState(i)},on:{change:function(t){e.isDisabledAndFinished(t,i,s,"finish")}},model:{value:i.isFinished,callback:function(t){e.$set(i,"isFinished",t)},expression:"row.isFinished"}})]}}])}),e._v(" "),o("vxe-table-column",{attrs:{field:"__ulastUpdatedUserName",title:"更新人","min-width":"80"}}),e._v(" "),o("vxe-table-column",{attrs:{field:"lastUpdateDate",title:"更新时间","min-width":"160"}})],1)],1)])],1),e._v(" "),o("el-dialog",{attrs:{title:"编辑",visible:e.editDialogVisible,width:"30%"},on:{"update:visible":function(t){e.editDialogVisible=t}}},[o("div",{staticClass:"editDialogContent"},[e._v("\n                附注名称:\n                "),o("el-input",{staticStyle:{width:"80%"},attrs:{type:"text"},model:{value:e.modifyNoteName,callback:function(t){e.modifyNoteName=t},expression:"modifyNoteName"}})],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"info",size:"small"},on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.submitEditInfo}},[e._v("确 定")])],1)]),e._v(" "),o("el-dialog",{attrs:{title:"上传页面",visible:e.uploadDialogVisible,"destroy-on-close":!0,width:"35%"},on:{"update:visible":function(t){e.uploadDialogVisible=t}}},[o("div",{staticClass:"updateBox"},[o("el-input",{staticStyle:{width:"300px",marginright:"20px"},attrs:{type:"text"},model:{value:e.excelName,callback:function(t){e.excelName=t},expression:"excelName"}}),e._v(" "),o("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"uploadExcel",attrs:{type:"file",id:"uploadExcel",accept:".xlsx"},on:{change:e.readExcel}}),e._v(" "),o("el-button",{staticClass:"btnText uploadBtn",attrs:{type:"primary",size:"small"},on:{click:e.importExcel}},[o("i",{staticClass:"el-icon-folder-opened"}),e._v("浏览\n                ")])],1),e._v(" "),o("div",{staticClass:"buttonList"},[o("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirUpload}},[e._v("确定")]),e._v(" "),o("el-button",{attrs:{type:"info",size:"small"},on:{click:function(t){e.uploadDialogVisible=!1}}},[e._v("取消")])],1)]),e._v(" "),o("el-dialog",{staticStyle:{top:"-80px","overflow-y":"hidden"},attrs:{title:"批量上传",visible:e.batchUploadDialogVisible,"destroy-on-close":!0,"before-close":e.cancelUpload,width:"40%"},on:{"update:visible":function(t){e.batchUploadDialogVisible=t}}},[o("div",[o("el-row",{attrs:{gutter:10}},[o("el-col",{staticClass:"reasonUpload",attrs:{span:24}},[o("el-upload",{ref:"uploadFile",staticClass:"uploadTool",attrs:{drag:"",action:"",multiple:"","file-list":e.uploadFileList,accept:".xlsx","auto-upload":!1,"on-change":e.uploadChange,"on-remove":e.beforeRemove}},[o("i",{staticClass:"el-icon-upload"}),e._v(" "),o("div",{staticClass:"el-upload__text"},[e._v("\n                                将文件拖到此处，或"),o("em",[e._v("点击上传")])])])],1)],1)],1),e._v(" "),o("div",{staticClass:"buttonList"},[o("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.batchUpload}},[e._v("确定")]),e._v(" "),o("el-button",{attrs:{type:"info",size:"small"},on:{click:e.cancelUpload}},[e._v("取消")])],1)]),e._v(" "),o("el-dialog",{attrs:{title:e.columnTitle,visible:e.mergeTableVisible,width:"80%"},on:{"update:visible":function(t){e.mergeTableVisible=t}}},[o("vxe-table",{ref:"multipleTable",attrs:{resizable:"",border:"",height:"95%","highlight-hover-row":"","show-overflow":"","show-header-overflow":"","highlight-current-row":"","show-footer":"","footer-method":e.footerMethod,"header-align":"center",data:e.mergeInfo,"keep-source":"","auto-resize":!0,"cell-class-name":e.cellClassName,"scroll-y":{vSize:1e4}}},[o("vxe-table-column",{attrs:{title:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return t.rowIndex,[o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑文件",placement:"top-start"}},[o("el-button",{staticClass:"editFileBtnCol",staticStyle:{"margin-left":"40%"},attrs:{size:"small",type:"text",icon:"el-icon-document-copy",disabled:"0"===i.isCompleteNow},on:{click:function(t){return e.editFile(i)}}})],1)]}}])}),e._v(" "),o("vxe-table-column",{attrs:{field:"shortName",title:"项目简称","min-width":"100","edit-render":{name:"input"},align:"center","header-align":"center"}}),e._v(" "),o("vxe-table-column",{attrs:{field:"auditedAmount",title:"审定数","min-width":"200","edit-render":{name:"input"},formatter:e.commafyFn,align:e.allAlign,"header-align":"center"}}),e._v(" "),o("vxe-table-column",{attrs:{field:"auditedAmountRate",title:"本期占比","min-width":"200","edit-render":{name:"input"},formatter:e.fmtEquity,align:e.allAlign,"header-align":"center"}}),e._v(" "),o("vxe-table-column",{attrs:{field:"preAuditAmount",title:"年初数","min-width":"200","edit-render":{name:"input"},formatter:e.commafyFn,align:e.allAlign,"header-align":"center"}}),e._v(" "),o("vxe-table-column",{attrs:{field:"preAuditAmountRate",title:"上期占比","min-width":"200","edit-render":{name:"input"},formatter:e.fmtEquity,align:e.allAlign,"header-align":"center"}}),e._v(" "),o("vxe-table-column",{attrs:{field:"curCheck",title:"本期校验","min-width":"200","edit-render":{name:"input"},formatter:e.commafyFn,align:e.allAlign,"header-align":"center",sortable:""},scopedSlots:e._u([{key:"header",fn:function(t){var i=t.column;return[o("span",[e._v(e._s(i.title))]),e._v(" "),o("span",{staticClass:"custom-sort",class:{"is-order":e.isShort}})]}}])}),e._v(" "),o("vxe-table-column",{attrs:{field:"preCheck",title:"上期校验","min-width":"200","edit-render":{name:"input"},formatter:e.commafyFn,align:e.allAlign,"header-align":"center",sortable:""},scopedSlots:e._u([{key:"header",fn:function(t){var i=t.column;return[o("span",[e._v(e._s(i.title))]),e._v(" "),o("span",{staticClass:"custom-sort",class:{"is-order":e.isPreCheckSort}})]}}])})],1)],1)],1)])},staticRenderFns:[]};var m=i("VU/8")(u,d,!1,function(e){i("3BhD"),i("qER7")},"data-v-3269f72a",null);t.default=m.exports},qER7:function(e,t){}});