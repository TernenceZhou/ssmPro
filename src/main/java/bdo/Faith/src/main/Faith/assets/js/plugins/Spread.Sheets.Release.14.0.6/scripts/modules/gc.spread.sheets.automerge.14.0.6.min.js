/*!
 * 
 * SpreadJS Library 14.0.6
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.AutoMerge=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/autoMerge/autoMerge.js")}({"./dist/plugins/autoMerge/autoMerge.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/autoMerge/autoMerge.res.en.js"),b.SR={en:f},g=new e.Common.ResourceManager(b.SR),h=g.getResource.bind(g),function(a){a[a.free=0]="free",a[a.restricted=1]="restricted"}(i=b.AutoMergeMode||(b.AutoMergeMode={})),function(a){a[a.none=0]="none",a[a.column=1]="column",a[a.row=2]="row",a[a.columnRow=3]="columnRow",a[a.rowColumn=4]="rowColumn"}(j=b.AutoMergeDirection||(b.AutoMergeDirection={})),function(a){a[a.source=0]="source",a[a.merged=1]="merged"}(k=b.SelectionMode||(b.SelectionMode={})),l=function(a){q(b,a);function b(b,c){var d=a.call(this,b.row,b.col,b.rowCount,b.colCount)||this;return d.sheetArea=c,d.isAutoMerge=!0,d}return b}(d.Range),m=void 0,n=null;function r(a,b,c){return c+"_"+a+"_"+b}function s(a,b,c){return b===a||(b===d.SheetArea.viewport?c&&a===d.SheetArea.rowHeader||!c&&a===d.SheetArea.colHeader:b===d.SheetArea.rowHeader?c&&a===d.SheetArea.viewport:b===d.SheetArea.colHeader&&(!c&&a===d.SheetArea.viewport))}function t(a,b,c){a.clearSpan(b.row,b.col,b.rowCount,b.colCount,c)}function u(a,b,c){var e,f,g,h,i,j,k,l,m,n;return c===d.SheetArea.viewport&&!a.options.allowCellOverflow&&(e=b.row,f=b.col,g=b.rowCount,h=b.colCount,i=a.frozenRowCount(),j=a.frozenColumnCount(),k=a.frozenTrailingRowCount(),l=a.frozenTrailingColumnCount(),m=a.getRowCount(),n=a.getColumnCount(),(0===i||e!==-1&&i<=e)&&(0===j||f!==-1&&j<=f)&&(0===k||e!==-1&&e+g<=m-k)&&(0===l||f!==-1&&f+h<=n-l))?(f===-1&&(f=a.getViewportLeftColumn(1),h=a.getViewportRightColumn(1)-f+1),e===-1&&(e=a.getViewportTopRow(1),g=a.getViewportBottomRow(1)-e+1),d.kf(e,f,g,h)):a.Tq(b,c)}o=function(){function a(a){this.kj=a,this.qJb=[],this.xn={},this.Ny=[]}return a.prototype.no=function(){this.kj=n},a.prototype.add=function(a,b,c,e,f){var g,i,j,l;for(void 0===e&&(e=d.SheetArea.viewport),void 0===f&&(f=k.source),g=this.all(),i=0,j=g;i<j.length;i++)if(l=j[i],l.sheetArea===e&&l.range.intersect(a.row,a.col,a.rowCount,a.colCount))throw Error(h().Exp_RangeIsIntersected);this.qJb.push({range:a,direction:b,mode:c,sheetArea:e,selectionMode:f})},a.prototype.remove=function(a,b){var c,e,f,g;for(void 0===b&&(b=d.SheetArea.viewport),c=this.qJb,e=this.kj.ITa,f=0;f<c.length;f++)if(g=c[f],g.sheetArea===b&&g.range.equals(a)){t(e,a,b),c.splice(f,1);break}},a.prototype.clear=function(){var a,b,c=this.qJb,d=this.kj.ITa;for(a=0;a<c.length;a++)b=c[a],t(d,b.range,b.sheetArea);this.qJb=[],this.xn={},this.Ny=[]},a.prototype.all=function(){return this.qJb},a.prototype.mgc=function(a){return this.qJb.some(function(b){return b.range.containsRange(a)})},a.prototype.RUa=function(a){this.qJb=a,this.rJb()},a.prototype.oJb=function(a,b,c){void 0===c&&(c=d.SheetArea.viewport);var e=this.xn[r(a,b,c)];return e?d.kf(e.row,e.col,e.rowCount,e.colCount):n},a.prototype.nJb=function(a){return void 0===a&&(a=d.SheetArea.viewport),this.Ny.filter(function(b){return b.sheetArea===a})},a.prototype.rJb=function(){var a,b,c,e,f,g,h,i;for(this.xn={},this.Ny=[],a=this.qJb,b=this.kj,c=b.ITa,e=function(a){var e,g=a.direction,h=a.mode,i=a.sheetArea,l=u(b,a.range,i),m=a.selectionMode===k.merged;m&&t(c,l,i),e=void 0,g===j.column?e=v(b,h,l,i):g===j.row?e=x(b,h,l,i):g===j.columnRow?e=A(b,h,l,i):g===j.rowColumn&&(e=D(b,h,l,i)),e&&(d.GC$.extend(f.xn,e.cache),f.Ny=f.Ny.concat(e.spans),m&&e.spans.forEach(function(a){c.addSpan(a,i)}))},f=this,g=0,h=a;g<h.length;g++)i=h[g],e(i)},a.prototype.rI=function(a,b,c){var e,f,g,h,i,j;if(void 0===c&&(c=d.SheetArea.viewport),!(a<0||b<=0))for(e=this.qJb,f=0,g=e;f<g.length;f++)h=g[f],s(h.sheetArea,c,!0)&&(i=h.range,j=i.row,a<=j?i.row+=b:j<a&&a<j+i.rowCount&&(i.rowCount+=b))},a.prototype.tI=function(a,b,c){var e,f,g,h,i,j;if(void 0===c&&(c=d.SheetArea.viewport),!(a<0||b<=0))for(e=this.qJb,f=0,g=e;f<g.length;f++)h=g[f],s(h.sheetArea,c,!1)&&(i=h.range,j=i.col,a<=j?i.col+=b:j<a&&a<j+i.colCount&&(i.colCount+=b))},a.prototype.GR=function(a,b,c){var e,f,g,h,i,j,k,l,m;if(void 0===c&&(c=d.SheetArea.viewport),!(a<0||b<=0)){for(e=this.qJb,f=[],g=0;g<e.length;g++)h=e[g],s(h.sheetArea,c,!0)&&(i=h.range,j=i.row,k=i.rowCount,a<j?(l=a+b-j,l<=0?j-=b:(j-=l,i.rowCount-=l),j<0&&(i.rowCount+=j,j=0),i.row=j):j<=a&&a<j+k&&(i.rowCount-=Math.min(b,j+k-a)),0===i.rowCount&&f.push(g));for(m=f.length-1;m>=0;m--)e.splice(f[m],1)}},a.prototype.HR=function(a,b,c){var e,f,g,h,i,j,k,l,m;if(void 0===c&&(c=d.SheetArea.viewport),!(a<0||b<=0)){for(e=this.qJb,f=[],g=0;g<e.length;g++)h=e[g],s(h.sheetArea,c,!1)&&(i=h.range,j=i.col,k=i.colCount,a<j?(l=a+b-j,l<=0?j-=b:(j-=l,i.colCount-=l),j<0&&(i.colCount+=j,j=0),i.col=j):j<=a&&a<j+k&&(i.colCount-=Math.min(b,j+k-a)),0===i.colCount&&f.push(g));for(m=f.length-1;m>=0;m--)e.splice(f[m],1)}},a.prototype.sJb=function(a,b){var c,e,f;for(void 0===b&&(b=d.SheetArea.viewport),c=this.qJb,e=c.length-1;e>=0;e--)f=c[e].range,f.row!==-1&&s(c[e].sheetArea,b,!0)&&(f.row>a-1?c.splice(e,1):f.row+f.rowCount-1>a-1&&(f.rowCount=a-1-f.row+1))},a.prototype.tJb=function(a,b){var c,e,f;for(void 0===b&&(b=d.SheetArea.viewport),c=this.qJb,e=c.length-1;e>=0;e--)f=c[e].range,f.col!==-1&&s(c[e].sheetArea,b,!1)&&(f.col>a-1?c.splice(e,1):f.col+f.colCount-1>a-1&&(f.colCount=a-1-f.col+1))},a.prototype.toJSON=function(){return this.qJb.map(function(a){var b=a.range;return{range:{row:b.row,col:b.col,rowCount:b.rowCount,colCount:b.colCount},direction:a.direction,mode:a.mode,sheetArea:a.sheetArea,selectionMode:a.selectionMode}})},a.prototype.fromJSON=function(a){var b,c,e,f,g,h;if(a)for(b=this.qJb,c=0,e=a;c<e.length;c++)f=e[c],g=f.range,h=f.selectionMode,h===m&&(h=k.source),b.push({range:d.kf(g.row,g.col,g.rowCount,g.colCount),direction:f.direction,mode:f.mode,sheetArea:f.sheetArea,selectionMode:h})},a}(),d.GC$.extend(d.lUa.prototype,{uJb:function(){var a=this,b=a.zTa;b&&!b.vJb&&(b.vJb=this.mJb.all().map(function(a){var b=a.range;return{range:d.kf(b.row,b.col,b.rowCount,b.colCount),direction:a.direction,mode:a.mode,sheetArea:a.sheetArea,selectionMode:a.selectionMode}}))},wJb:function(a){a&&this.mJb.RUa(a)},xJb:function(a,b){this.uJb(),this.mJb.rI(a,b)},yJb:function(a,b){this.uJb(),this.mJb.GR(a,b)},zJb:function(a,b){this.uJb(),this.mJb.tI(a,b)},AJb:function(a,b){this.uJb(),this.mJb.HR(a,b)},BJb:function(a,b){this.uJb(),this.mJb.sJb(a,b)},CJb:function(a,b){this.uJb(),this.mJb.tJb(a,b)}}),p="autoMerge",d.lUa.$n(p,{init:function(){this.mJb=new o(this.kj)},undo:function(a){var b=a.vJb;b&&this.wJb(b)},dispose:function(a){var b=this,c=a&&a.clearCache;c!==!1&&b.mJb&&(b.mJb.no(),b.mJb=n)}}),d.Worksheet.$n(p,{init:function(){var a=this,b=a.mJb=a.ITa.mJb;a.unbind(d.Events.TopRowChanged+"."+p),a.unbind(d.Events.LeftColumnChanged+"."+p),a.bind(d.Events.TopRowChanged+"."+p,function(){var c,e,f,g,h,i,j,k,l=b.all();if(l.length>0)for(c=a.frozenColumnCount(),e=a.getColumnCount()-a.frozenTrailingColumnCount()-1,f=0,g=l;f<g.length;f++)h=g[f],i=h.sheetArea,j=h.range,i===d.SheetArea.viewport?((j.col===-1||j.col<c)&&a.repaint(a.getRangeRect(1,0,j)),(j.col===-1||j.col<=e&&j.col+j.colCount>=c)&&a.repaint(a.getRangeRect(1,1,j)),(j.col===-1||j.col+j.colCount>e)&&a.repaint(a.getRangeRect(1,2,j))):i===d.SheetArea.rowHeader&&(k=a.am(),a.repaint(k.fm(1)))}),a.bind(d.Events.LeftColumnChanged+"."+p,function(){var c,e,f,g,h,i,j,k,l=b.all();if(l.length>0)for(c=a.frozenRowCount(),e=a.getRowCount()-a.frozenTrailingRowCount()-1,f=0,g=l;f<g.length;f++)h=g[f],i=h.sheetArea,j=h.range,i===d.SheetArea.viewport?((j.row===-1||j.row<c)&&a.repaint(a.getRangeRect(0,1,j)),(j.row===-1||j.row<=e&&j.row+j.rowCount>=c)&&a.repaint(a.getRangeRect(1,1,j)),(j.row===-1||j.row+j.rowCount>e)&&a.repaint(a.getRangeRect(2,1,j))):i===d.SheetArea.colHeader&&(k=a.am(),a.repaint(k.gm(1)))})},dispose:function(a){a.clearCache!==!1&&(this.mJb=n,this.unbind(d.Events.TopRowChanged+"."+p),this.unbind(d.Events.LeftColumnChanged+"."+p))},onLayoutChanged:function(a){var b=a.changeType,c=a.row,d=a.rowCount,e=a.col,f=a.colCount,g=a.sheetArea,h=this.ITa;"addRows"===b?h.xJb(c,d):"deleteRows"===b?h.yJb(c,d):"addColumns"===b?h.zJb(e,f):"deleteColumns"===b?h.AJb(e,f):"setRowCount"===b?h.BJb(d,g):"setColumnCount"===b&&h.CJb(f,g),"invalidateLayout"===b&&this.Xq<=0&&this.mJb.rJb()},toJson:function(a,b){var c,e,f,g=b&&b.ignoreStyle;g||(a.autoMergeRangeInfos=this.mJb.toJSON(),b&&b.includeAutoMergedCells&&(c=this.mJb.nJb(d.SheetArea.viewport),c.length>0&&(a.spans?a.spans=a.spans.concat(c):a.spans=c),e=this.mJb.nJb(d.SheetArea.rowHeader),e.length>0&&(a.rowHeaderSpan?a.rowHeaderSpan=a.rowHeaderSpan.concat(e):a.rowHeaderSpan=e),f=this.mJb.nJb(d.SheetArea.colHeader),f.length>0&&(a.colHeaderSpan?a.colHeaderSpan=a.colHeaderSpan.concat(f):a.colHeaderSpan=f)))},fromJson:function(a,b,c){var d=c&&c.ignoreStyle;d||this.mJb.fromJSON(a.autoMergeRangeInfos)}}),d.GC$.extend(d.Worksheet.prototype,{autoMerge:function(a,b,c,e,f){void 0===b&&(b=j.column),void 0===c&&(c=i.free),void 0===e&&(e=d.SheetArea.viewport),void 0===f&&(f=k.source);var g=this.mJb;return 0===arguments.length?g.all():void(a&&(this.ITa.uJb(),b===j.none?g.remove(a,e):g.add(a,b,c,e,f),this.$p()))}});function v(a,b,c,e){var f,g,h,j,k,o,p,q,r={},s=[],t=c.row,u=c.row+c.rowCount-1,v=c.col,x=c.col+c.colCount-1;for(f=v;f<=x;f++)if(a.getColumnVisible(f,e)&&!(a.getColumnWidth(f,e)<=0)){for(g=b===i.restricted,h=g&&f>v,j=void 0,k=t;k<=u;)if(!a.getRowVisible(k,e)||a.getRowHeight(k,e)<=0)k++;else{if(o=a._q(k,e,!0),o===n||o>u)break;if(z(a,k,f,o,f,e)){if(h&&!w(a,r,k,f,o,f,e)){j&&(p=new l(j,e),s.push(p),C(r,j,p),j=m),k=o;continue}q=o-k+1,j?j.rowCount+=q-1:j=d.kf(k,f,q,1)}else j&&(p=new l(j,e),s.push(p),C(r,j,p),j=m);k=o}j&&(p=new l(j,e),s.push(p),C(r,j,p),j=m)}return{cache:r,spans:s}}function w(a,b,c,d,e,f,g){var h=a.br(d,g),i=b[r(c,h,g)];return i&&i.sheetArea===g&&i.row<=c&&e<=i.row+i.rowCount-1}function x(a,b,c,e){var f,g,h,j,k,o,p,q,r={},s=[],t=c.row,u=c.row+c.rowCount-1,v=c.col,w=c.col+c.colCount-1;for(f=t;f<=u;f++)if(a.getRowVisible(f,e)&&!(a.getRowHeight(f,e)<=0)){for(g=b===i.restricted,h=g&&f>t,j=void 0,k=v;k<=w;)if(!a.getColumnVisible(k,e)||a.getColumnWidth(k,e)<=0)k++;else{if(o=a.Zq(k,e,!0),o===n||o>w)break;if(z(a,f,k,f,o,e)){if(h&&!y(a,r,f,k,f,o,e)){j&&(p=new l(j,e),s.push(p),C(r,j,p),j=m),k=o;continue}q=o-k+1,j?j.colCount+=q-1:j=d.kf(f,k,1,q)}else j&&(p=new l(j,e),s.push(p),C(r,j,p),j=m);k=o}j&&(p=new l(j,e),s.push(p),C(r,j,p),j=m)}return{cache:r,spans:s}}function y(a,b,c,d,e,f,g){var h=a.gr(c,g),i=b[r(h,d,g)];return i&&i.sheetArea===g&&i.col<=d&&f<=i.col+i.colCount-1}function z(a,b,c,d,e,f){var g=a.ITa,h=a.getText(b,c,f),i=a.getText(d,e,f);return""!==h&&""!==i&&(h===i&&(!g.findSpan(b,c,f)&&!g.findSpan(d,e,f)))}function A(a,b,c,e){var f,g,h,i,j,k,m,o=v(a,b,c,e),p=o.cache,q=o.spans,s=c.row,t=c.row+c.rowCount-1,u=c.col,w=c.col+c.colCount-1;for(f=s;f<=t;f++)if(a.getRowVisible(f,e)&&!(a.getRowHeight(f,e)<=0))for(g=u;g<=w;g++)if(a.getColumnVisible(g,e)&&!(a.getColumnWidth(g,e)<=0)){if(h=a.Zq(g,e,!0),h===n||h>w)break;z(a,f,g,f,h,e)&&(i=p[r(f,g,e)],j=p[r(f,h,e)],i&&j?i.row===f&&j.row===f&&i.rowCount===j.rowCount&&(i.colCount+=h-g,B(q,j),C(p,j,i)):i?1===i.rowCount&&(i.colCount+=h-g,C(p,new d.Range(f,h,1,1),i)):j?1===j.rowCount&&(j.col=g,j.colCount+=h-g,C(p,new d.Range(f,g,1,1),j)):(k=new d.Range(f,g,1,h-g+1),m=new l(k,e),q.push(m),C(p,k,m)))}return{cache:p,spans:q}}function B(a,b){var c,d;for(c=0;c<a.length;c++)if(d=a[c],d.sheetArea===b.sheetArea&&d.equals(b)){a.splice(c,1);break}}function C(a,b,c){var d,e,f=c.sheetArea;for(d=0;d<b.rowCount;d++)for(e=0;e<b.colCount;e++)a[r(b.row+d,b.col+e,f)]=c}function D(a,b,c,e){var f,g,h,i,j,k,m,o=x(a,b,c,e),p=o.cache,q=o.spans,s=c.row,t=c.row+c.rowCount-1,u=c.col,v=c.col+c.colCount-1;for(f=u;f<=v;f++)if(a.getColumnVisible(f,e)&&!(a.getColumnWidth(f,e)<=0))for(g=s;g<=t;g++)if(a.getRowVisible(g,e)&&!(a.getRowHeight(g,e)<=0)){if(h=a._q(g,e,!0),h===n||h>t)break;z(a,g,f,h,f,e)&&(i=p[r(g,f,e)],j=p[r(h,f,e)],i&&j?i.col===f&&j.col===f&&i.colCount===j.colCount&&(i.rowCount+=h-g,B(q,j),C(p,j,i)):i?1===i.colCount&&(i.rowCount+=h-g,C(p,new d.Range(h,f,1,1),i)):j?1===j.colCount&&(j.row=g,j.rowCount+=h-g,C(p,new d.Range(g,f,1,1),j)):(k=new d.Range(g,f,h-g+1,1),m=new l(k,e),q.push(m),C(p,k,m)))}return{cache:p,spans:q}}},"./dist/plugins/autoMerge/autoMerge.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_RangeIsIntersected="The range should not intersect with exsit ranges."},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets}});