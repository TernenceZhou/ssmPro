/*!
 * 
 * Spread.Sheets Library 11.2.2
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.FloatingObjects=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){!function(){"use strict";var b=c(1);c(5),c(4),c(6),b.SR={},b.SR.en=c(8),a.exports=b}()},function(a,b,c){!function(){"use strict";var b,d,e,f,g,h,i,j,k,l=c(2),m=c(3),n=m.j.Fa,o=c(4),p=l.Rect,q=l.Point,r=l.Events,s=l.Rm,t=m.j.Ma,u=l.Ul,v=u.Pl,w=u.Ol,x=u.Nl,y=u.Rl,z=o.yR,A=document,B=m.D,C=function(){return m.C(a.exports.SR)()},D=l.GC$,E=null,F=void 0,G=Math.ceil,H=Math.floor,I=Math.max,J=Math.min,K=Math.abs,L="div",M="on",N="z-index",O="move",P="unselectable",Q=1,R="border",S=9007199254740992,T="floatingObjects",U=".gcFloatingObject",V="name",W="x",X="y",Y="width",Z="height",$="start",_=$+"Row",aa=$+"RowOffset",ba=$+"Column",ca=$+"ColumnOffset",da="end",ea=da+"Row",fa=da+"RowOffset",ga=da+"Column",ha=da+"ColumnOffset",ia="isSelected",ja="isLocked",ka="isVisible",la="canPrint",ma="dynamicSize",na="dynamicMove",oa="fixedPosition",pa="allowResize",qa="allowMove",ra=700,sa=701,ta="position",ua="absolute",va="background",wa="gc-no-user-select",xa="gc-floatingobject-selected",ya="gc-floatingobject-unselected",za="gc-floatingobject-resize-indicator-select",Aa="gc-floatingobject-resize-indicator-unSelect",Ba="gc-floatingobject-content-container",Ca="gc-floatingobject-container",Da="gc-floatingobject-moving-container",Ea="gc-floatingobject-moving-div",Fa=".gc-floatingobject-resize-indicator",Ga="gc-floatingobject-resize-indicator",Ha="gc-floatingobject-absolute",Ia="gc-floatingobject-top",Ja="gc-floatingobject-middle",Ka="gcfloatingobject-bottom",La="gc-floatingobject-left",Ma="gc-floatingobject-center",Na="gc-floatingobject-right",Oa="div."+Ga,Pa=Oa+"."+Ia+"."+La,Qa=Oa+"."+Ja+"."+La,Ra=Oa+"."+Ka+"."+La,Sa=Oa+"."+Ia+"."+Ma,Ta=Oa+"."+Ka+"."+Ma,Ua=Oa+"."+Ia+"."+Na,Va=Oa+"."+Ja+"."+Na,Wa=Oa+"."+Ka+"."+Na,Xa="content",Ya="gc-no-user-select",Za="100%",$a="gc-floatingobject-background-cover",_a=".fos",ab=function(){var a=this;a.uQ=function(){var a=this.wr;a&&a.zR().forEach(function(a){a.isSelected(!1)})},a.AR=function(){var a=this,b=a.wr;b&&(b.isNeedToUpdateLayout=!0)},a.BR=function(){var a=this,b=a.parent,c=a.tv,d=b&&b.tv;return c||(c=a.tv=d?d:{fromSheet:E,isCutting:!1}),c},a.ex=function(){var a=this,b=a.BR(),c=b&&b.fromSheet;c&&(c.CR=E),b.fromSheet=E,b.isCutting=!1},a.DR=function(a){var b=this.options;return!b.isProtected||!a.isLocked()||b.protectionOptions.allowEditObjects},a.ER=function(a){var b=this.options;return!b.isProtected||!a.isLocked()||b.protectionOptions.allowEditObjects},a.isPasteFloatingObject=function(){var a=this,b=a.BR().fromSheet,c=this.CR;return!c&&b&&(c=b.CR),c&&!c.isEmpty()}};ab.call(l.Worksheet.prototype);function bb(a){var b,c,d,e,f,g,h,i=a.FR;if(i){for(b=0,d=i.length;b<d;b++)if(f=i[b]){for(c=0,e=f.length;c<e;c++)g=f[c],g&&g.no();f.length=0}i.length=0,a.FR=E}h=a.wr,h&&h.no()}function cb(a,b,c){a.zR().forEach(function(a){a.rI(b,c)})}function db(a,b,c){var d,e,f=[];for(a.zR().forEach(function(d){gb(b,-1,b+c-1,a.sheet().getColumnCount(),d)&&(d.dynamicMove()||d.dynamicSize())?f.push(d):d.GR(b,c)}),d=0,e=f.length;d<e;d++)a.Fb(f[d].name())}function eb(a,b,c){a.zR().forEach(function(a){a.tI(b,c)})}function fb(a,b,c){var d,e,f=[];for(a.zR().forEach(function(d){gb(-1,b,a.sheet().getRowCount(),b+c-1,d)&&(d.dynamicMove()||d.dynamicSize())?f.push(d):d.HR(b,c)}),d=0,e=f.length;d<e;d++)a.Fb(f[d].name())}function gb(a,b,c,d,e){var f=e[_](),g=e[ba](),h=e[ea](),i=e[ga]();return a<=f&&b<=g&&c>=h&&d>=i}function hb(a,b){var c=this;return b||(b={}),D.each(a,function(a,d){var e=c[d],f=e.call(c);e.isDefault(f)||(b[d]=f)}),b}function ib(a,b){if(b){var c=this;D.each(a,function(a,d){b[d]!==F&&c[d].call(c,b[d],!1)})}}function jb(a){var b=a;return function(a,c){var d=this,e=d.sheet();b===Xa&&(d.KR=!0),e&&e.$p(),d.onPropertyChanged(b,a,c)}}function kb(a){var b=a;return function(a,c){var d=this,e=d.sheet();e&&(mb(d),e.$p()),d.onPropertyChanged(b,a,c)}}function lb(a){var b=a;return function(a,c){var d=this,e=d.sheet();e&&(zb(d),e.$p()),d.onPropertyChanged(b,a,c)}}function mb(a){var b,c,d,e,f=a.sheet();function g(b,c,d,e,g){var h=0,i=b.call(a);return h=c.call(a,f,0,i),nb.call(a,b,d,e,!0,g),h+=d.call(a)}f&&(b=g(a[_],ob,a[aa],f.getRowHeight,aa),c=g(a[ba],pb,a[ca],f.getColumnWidth,ca),d=a.x(),e=a.y(),d===c&&e===b||(a.x(c,!1),a.y(b,!1),a.onPropertyChanged("position",new q(c,b),new q(d,e))))}function nb(a,b,c,d,e){var f=this,g=b.call(f),h=c.call(f.sheet(),a.call(f),3),i=f.LR;h>0&&h--,g>h?(i[e]||(i[e]=g),b.call(f,h,!1)):i[e]&&(i[e]<h?(b.call(f,i[e],!1),i[e]=F):(d&&h<i[e]||!d&&g<i[e])&&b.call(f,h,!1))}function ob(a,b,c,d){var e,f=0;for(e=b;e<c&&(f+=a.getRowHeight(e,3),!(f>d));e++);return f}function pb(a,b,c,d){var e,f=0;for(e=b;e<c&&(f+=a.getColumnWidth(e,3),!(f>d));e++);return f}function qb(a){var b=a.sheet();function c(b,c,d,e,f){var g=sb(a,b,c),h=g.index;e.call(a,g.offset,!1),g.offset===-1&&(h+=1,e.call(a,0),h===f&&(h=f-1)),d.call(a,h,!1)}b&&(c(!0,a.y(),a[_],a[aa],b.getRowCount()),c(!1,a.x(),a[ba],a[ca],b.getColumnCount()))}function rb(a){var b=a.sheet();function c(b,c,d,e){var f=sb(a,b,c);d.call(a,f.index,!1),e.call(a,f.offset,!1)}b&&(c(!0,a.y()+a[Z](),a[ea],a[fa]),c(!1,a.x()+a[Y](),a[ga],a[ha]))}function sb(a,b,c){var d,e=0,f=0,g=a.sheet(),h=b?g.getRowCount():g.getColumnCount(),i=0;for(i=0;i<h;i++){if(d=b?g.getRowHeight(i,3):g.getColumnWidth(i,3),e+=d,f=e-c,f>0){f=f>0?d-f:-1;break}if(0===f){f=0,i+=1;break}}return i>=h&&(i=h-1,f=0),{offset:f,index:i}}function tb(a,b){ub(b,vb(a))}function ub(a,b){a&&(a.style.zIndex=b+"")}function vb(a){var b=a.PR;return n(b)&&(b=a.Cka),b}function wb(a,b){a.PR=b,a.qo.forEach(function(a){for(var c=a.parentElement;c.className.indexOf(Ca)===-1;)c=c.parentElement;ub(c,b)})}function xb(a,b){n(a.PR)&&(a.Cka+=b)}function yb(a,b){this.kj=a,this.g3=b}D.extend(yb.prototype,{add:function(a,b,c,d,e,f){var g=this,i;return"1"===g.g3?i=new h.Picture(a,b,c,d,e,f):"0"===g.g3&&(i=a),g.kj.wr.Sb(i),i},get:function(a){return this.kj.wr.NR(a)},remove:function(a){this.kj.wr.Fb(a)},clear:function(){return this.kj.wr.$b(this.g3)},all:function(){return this.kj.wr.zR(this.g3)},zIndex:function(a,b){return this.kj.wr.PR(a,b)},tTa:function(a,b,c){this.kj.wr.zR().forEach(function(d){var e=c?d.startRow():d.startColumn(),f=c?d.endRow():d.endColumn();b<e||a>f||zb(d)})}}),b=function(){function a(a){var c=this;c.sheet(a),b(c),c.QR={}}function b(a){var b=a.sheet();b&&(D(A.body).bind("scroll"+U,function(){var a=b.parent.getActiveSheet();a.wr&&b.QP(a.Dr())}),b.Fu(r.ColumnChanged+U,function(b,d){var e=d.propertyName;e!==Y&&e!==ka||c(a)}),b.Fu(r.RowChanged+U,function(b,d){var e=d.propertyName;e!==Z&&e!==ka||c(a)}),b.Fu(r.ColumnWidthChanged+U,function(){c(a)}),b.Fu(r.RowHeightChanged+U,function(){c(a)}))}function c(a){var b=a.sheet();a.isNeedToUpdateLayout=!0,b.QP&&b.QP(b.Dr())}function d(a,b){if(a.QR[b])throw Error(C().Exp_FloatingObjectHasSameNameError)}function f(a,b,c){return c&&c.width>0&&c.height>0&&(c.x===a||c.y===b||c.contains(a,b))}var g={sheet:v("sheet",F),Dka:function(a){this.zR().forEach(function(b){xb(b,a)})},Sb:function(a){var b,c=this,e=c.sheet();if(e.suspendPaint(),b=a.name(),!b)throw Error(C().Exp_FloatingObjectNameEmptyError);d(c,b),e.ITa.AUa(),c.Dka(-1),a.sheet(e),c.QR[b]=a,e.Zoa(a),e.resumePaint()},NR:function(a){return this.QR[a]},Fb:function(a,b){var c,d,e,f=this;return!!a&&(c=f.sheet(),d=f.NR(a),c.ITa.AUa(),c.suspendPaint(),b?(e={sheet:c,sheetName:c.name(),floatingObject:d,cancel:!1},c.Wq(r.FloatingObjectRemoving,e),e.cancel===!1&&(delete f.QR[a],c.Wq(r.FloatingObjectRemoved,{sheet:c,sheetName:c.name(),floatingObject:d}))):delete f.QR[a],c.resumePaint(),!0)},U3:function(a,b){var c,e=this,f=e.sheet();if(f.suspendPaint(),!b)throw Error(C().Exp_FloatingObjectNameEmptyError);d(e,b),c=e.QR[a],delete e.QR[a],e.QR[b]=c,c.onNameChanged&&c.onNameChanged(a,b),f.resumePaint()},$b:function(a){var b=this,c=b.sheet();c.suspendPaint(),D.each(this.QR,function(c,d){a&&a!==d.g3||b.Fb(d.name())}),c.resumePaint()},zR:function(a){var b=[];return D.each(this.QR,function(c,d){a&&a!==d.g3||b.push(d)}),b},PR:function(a,b){var c=isNaN(b),d=this.NR(a);if(d){if(c)return vb(d);wb(d,b)}if(c)return-1},toJSON:function(){var a=[];return this.zR().forEach(function(b){var c,d;b instanceof e&&b.hga()&&(c=b.toJSON(),d=b.PR,isNaN(d)||(c.zIndex=d),a.push(c))}),a},fromJSON:function(a,b){var c,d,f,g,i,j,k,m=this;if(a&&0!==a.length)for(c=0;c<a.length;c++)d=a[c],d&&(i=d.floatingObjectType,j=u.Ol(i)?i+"":d.typeName,g="0"===j?e:"1"===j?h.Picture:l.getTypeFromString(j),g&&(f=new g,f.fromJSON(d,b),m.Sb(f),k=d.zIndex,n(k)||(f.PR=k)))},no:function(){D(A.body).unbind("scroll"+U);var a=this.sheet();a&&(a.Gu(r.ColumnChanged+U),a.Gu(r.RowChanged+U),a.Gu(r.ColumnWidthChanged+U),a.Gu(r.RowHeightChanged+U))},hitTest:function(a,b){var c,d,e,g,h=this.sheet(),i=h.am(),j=E;if(i)for(c=0;c<=2;c++)for(d=0;d<=2;d++)if(e=i.Ft(c,d),e&&e.contains(a,b)&&(g=h.IR&&h.IR(c,d),g&&g.jS.each(function(c){var d=c.YR;d&&d.isVisible()&&h.DR(d)&&f(a,b,c.Tka)&&(j?vb(j.floatingObject)<vb(d)&&(j.floatingobject=d):j={x:a,y:b,floatingObject:d})}),j))return j;return j},FS:function(){for(var a="FloatingObject",b=1,c=a+(""+b);this.NR(c);)b++,c=a+(""+b);return c}};return D.extend(a.prototype,g),a}();function zb(a){var b,c,d,e,f=a.sheet();function g(b,c,d,e,g,h,i){var j,k=0,l=b.call(a),m=c.call(a);return k=d.call(a,f,l,m),l===m?(nb.call(a,c,h,e,!1,i),k=h.call(a)-g.call(a)):(j=e.call(f,l,3),j>0&&(k-=g.call(a)),nb.call(a,c,h,e,!1,i),k+=h.call(a)),k}f&&(b=g(a[_],a[ea],ob,f.getRowHeight,a[aa],a[fa],fa),c=g(a[ba],a[ga],pb,f.getColumnWidth,a[ca],a[ha],ha),c<0&&(c=0),b<0&&(b=0),d=a[Y](),d!==c&&(a[Y](c,!1),a.onPropertyChanged(Y,c,d)),e=a[Z](),e!==b&&(a[Z](b,!1),a.onPropertyChanged(Z,b,e)))}d=["dotted","dashed","solid","double","groove","ridge","inset","outset"];function Ab(a){return d.indexOf(a)>=0}function Bb(a){var b,c,d;if(w(a)&&("string"!=typeof a||""===a))throw Error(C().Exp_FloatingObjectNameEmptyError);return b=this,a!==b.name()&&(c=b.sheet(),!c||(d=c.wr.NR(a),!d))}e=function(){var a,b=[V,W,X,Y,Z,_,aa,ba,ca,ea,fa,ga,ha,la,ia,ja,ka,na,ma,oa,pa,qa],c=[["sheet",E,function(){k(this)}],[V,F,function(a,b){var c,d,e=this,f=e.sheet();f&&(c=f.wr,d=c.NR(b),d===e&&c.U3(b,a)),e.onPropertyChanged("name",a,b)},Bb],[W,0,f(W,!1)],[X,0,f(X,!1)],[Z,0,f(Z,!0)],[Y,0,f(Y,!0)],[_,F,kb(_)],[aa,0,kb(aa)],[ba,F,kb(ba)],[ca,0,kb(ca)],[ea,F,lb(ea)],[fa,0,lb(fa)],[ga,F,lb(ga)],[ha,0,lb(ha)],[ia,!1,jb(ia)],[ja,!0,e(ja)],[la,!0,e(la)],[ka,!0,jb(ka)],[na,!0,function(a,b){e(na).call(this,a,b)},function(a){return"boolean"==typeof a&&(a||this.dynamicSize(!1,!1),!this.fixedPosition())}],[ma,!0,function(a,b){e(ma).call(this,a,b)},function(a){return"boolean"==typeof a&&this.dynamicMove()&&!this.fixedPosition()}],[oa,!1,function(a,b){var c=this;a&&(c.dynamicMove(!1,!1),c.dynamicSize(!1,!1)),c.onPropertyChanged(oa,a,b)}],[pa,!0,jb(pa)],[qa,!0,jb(qa)]];function d(a,b,c,d,e){var f=this;f.LR={startRowOffset:F,startColumnOffset:F,endRowOffset:F,endColumnOffset:F},f.typeName="0",f.g3="0",f.name(a),f.x(b?b:0,!1),f.y(c?c:0,!1),f[Y](d?d:0,!1),f[Z](e?e:0,!1),f.qo=[],f.KR=!1,f.Cka=ra}function e(a){return function(b,c){this.onPropertyChanged(a,b,c)}}function f(a,b){return function(c,d){var e=this,f=e.sheet();f&&(b&&i(e),j(e),p(e),f.$p()),e.onPropertyChanged(a,c,d)}}function g(a,b,c,d){var e=this,f=a.call(e),g=b.call(e);c<=f?e.dynamicMove()&&(a.call(e,f+d),b.call(e,g+d)):c<g&&e.dynamicSize()&&b.call(e,g+d)}function h(a,b,c,d,e,f,g){var h,i,j=this,k=a.call(j),l=c.call(j);e<=k?g<k?j.dynamicMove()&&(a.call(j,k-f),c.call(j,l-f)):g<l&&(h=g-k+1,i=l-k+1-h,j.dynamicMove()&&(a.call(j,e),b.call(j,0)),j.dynamicSize()&&c.call(j,e+i-1)):e<=l&&(g<l?j.dynamicSize()&&c.call(j,l-f):j.dynamicSize()&&(c.call(j,e),d.call(j,0)))}function i(a){var b=m(a,a[Z]()),c=o(a,a[Y]());a[Y]()>c&&a[Y](c,!1),a[Z]()>b&&a[Z](b,!1)}function j(a){var b,c,d=a.x()+a[Y](),e=o(a,d);d>e&&a.x(I(0,e-a[Y]()),!1),a.x()<0&&a.x(0,!1),b=a.y()+a[Z](),c=m(a,b),b>c&&a.y(I(0,c-a[Z]()),!1),a.y()<0&&a.y(0,!1)}function k(a){var b,c,d,e;i(a),j(a),b=a[_](),c=a[ba](),n(b)||n(c)?qb(a):mb(a),d=a[ea](),e=a[ga](),n(d)||n(e)?rb(a):zb(a)}function m(a,b){var c,d=a.sheet();return d?(c=d.getRowCount(),ob(d,0,c,b)):S}function o(a,b){var c,d=a.sheet();return d?(c=d.getColumnCount(),pb(d,0,c,b)):S}function p(a){qb(a),rb(a)}return a={constructor:d,position:function(a){var b,c,d=this,e=d.sheet();return 0===arguments.length?new q(d.x(),d.y()):(b=d.x(),c=d.y(),!t(a,q)||b===a.x&&c===a.y||(d.x(a.x,!1),d.y(a.y,!1),j(d),p(d),e&&e.$p(),d.onPropertyChanged("position",a,new q(b,c))),d)},content:v(Xa,E,jb(Xa)),cloneContent:function(){var a,b,c=this.content();return c?(c.cloneNode?a=c.cloneNode(!0):(b=x(L),b.innerHTML=c.outerHTML,a=b.firstChild),D(a).removeAttr("id")[0]):E},refreshContent:function(a){var b,c,d,e,f,g,h=this;h.KR&&a&&(b=D(a),b.empty(),c=h.cloneContent(),d=Za,e=Za,f="",g="",c&&c.style&&(f=c.style.width,g=c.style.height),""!==f&&(d=f),""!==g&&(e=g),c!==E?(D(c).css({width:d,height:e}).addClass($a).addClass(wa).attr(P,M).appendTo(a),b.css(va,"")):b.css(va,""),h.KR=!1)},toJSON:function(){var a,c=this,d=hb.call(c,b),e=c.LR;for(a in e)n(e[a])||(d[a]=e[a]);return d.typeName=c.typeName,d[Xa]=D(x(L)).append(c.cloneContent()).html(),d},fromJSON:function(a,c){var d,e;a&&(d=this,d.TR=!0,ib.call(this,b,a,c),n(a[_])&&p(d),a.content&&(e=x(L),e.innerHTML=a.content,d.content(D(e.firstChild)[0])),d.TR=F)},clone:function(){var a=this,b=l.getTypeFromString(a.typeName),c=b?new b:new d,e=JSON.stringify(a.toJSON());return c.fromJSON(JSON.parse(e)),c.content(a.cloneContent()),c},onPropertyChanged:function(a,b,c){var d,e=this;e.TR||(d=e.sheet(),d&&(d.ITa.BUa(e,a,c),e.Wq({sheet:d,sheetName:d.name(),floatingObject:e,propertyName:a})))},Wq:function(a){var b,c=this.sheet();c&&(c.Wq(r.FloatingObjectChanged,a),a.propertyName===ia&&(b={sheet:a.sheet,sheetName:a.sheetName,floatingObject:a.floatingObject},c.Wq(r.FloatingObjectSelectionChanged,b)))},rI:function(a,b){var c=this;a=G(a),b=G(b),g.call(c,c[_],c[ea],a,b)},GR:function(a,b){var c=this,d=a+b-1;h.call(c,c[_],c[aa],c[ea],c[fa],a,b,d)},tI:function(a,b){var c=this;a=G(a),b=G(b),g.call(c,c[ba],c[ga],a,b)},HR:function(a,b){var c,d=this;a=G(a),b=G(b),c=a+b-1,h.call(d,d[ba],d[ca],d[ga],d[ha],a,b,c)},getHost:function(a,b){var c,d,e=this.qo.concat();if(!n(a)&&!n(b)){for(c=0;c<e.length;c++)if(d=e[c],d.rowViewportIndex===a&&d.columnViewportIndex===b)return d;return E}return e},UR:function(a,b,c){var d=this.qo;a&&d.indexOf(a)<0&&(a.rowViewportIndex=b,a.columnViewportIndex=c,d.push(a))},VR:function(a){var b=this.qo,c=b.indexOf(a);c>=0&&b.splice(c,1)},WR:function(a,b){var c,d,e,f,g,h,i=x(L);return D(i).addClass(Ya).addClass(Ba).attr(P,M).css(ta,ua),c=this.cloneContent(),d=Za,e=Za,f="",g="",h=c&&c.style,h&&(f=h.width,g=h.height),""!==f&&(d=f),""!==g&&(e=g),c!==E&&D(c).css({width:d,height:e}).addClass($a).addClass(Ya).attr(P,M).appendTo(i),this.UR(i,a,b),i},hga:function(){return!0},no:function(a){},Toa:function(){mb(this),zb(this)}},D.each(c,function(b,c){a[c[0]]=v(c[0],c[1],c[2],c[3])}),d.prototype=a,d}(),f=function(){var a=$+"X",b=$+"Y",c=$+"Width",d=$+"Height",e=da+"X",f=da+"Y",g=$+"TopRow",h=$+"LeftColumn",i="left",j="center",k="right",m="top",n=m+i,o=m+j,t=m+k,v="middle",w=v+i,z=v+k,C="bottom",G=C+i,S=C+j,T=C+k,V="-resize",W="cursor",X="mousemove",aa="mouseup";function ca(a,b){this.XR="";var c=this;c.YR=a,c.name=a?a.name():"",c.kj=b,c.RB=!1,c.ZR=!1}l.Zn(ca);function fa(e,f,g){var h=e.$R,i,j,k,l;switch(f){case n:i=J(h[a]+h[c],g.x),j=J(h[b]+h[d],g.y),k=K(g.x-h[a]-h[c]),l=K(g.y-h[b]-h[d]);break;case o:i=h[a],j=J(h[b]+h[d],g.y),k=h[c],l=K(g.y-h[b]-h[d]);break;case t:i=J(h[a],g.x),j=J(h[b]+h[d],g.y),k=K(g.x-h[a]),l=K(g.y-h[b]-h[d]);break;case w:i=J(h[a]+h[c],g.x),j=h[b],k=K(g.x-h[a]-h[c]),l=h[d];break;case z:i=J(h[a],g.x),j=h[b],k=K(g.x-h[a]),l=h[d];break;case G:i=J(h[a]+h[c],g.x),j=J(h[b],g.y),k=K(g.x-h[a]-h[c]),l=K(g.y-h[b]);break;case S:i=h[a],j=J(h[b],g.y),k=h[c],l=K(g.y-h[b]);break;case T:i=J(h[a],g.x),j=J(h[b],g.y),k=K(g.x-h[a]),l=K(g.y-h[b])}return new p(i,j,k,l)}function ha(a){var b=D(a),c=b.position();return new p(c.left,c.top,b[Y](),b[Z]())}function ia(a,b,c,d,e,f){D(a).css([m,i,Y,Z],[[d-1],[c-1],e,f]).addClass(Ea).appendTo(b)}function ja(a,b){if(!a._R)return E;var c={inMoving:!1};return D(b.target).attr("resizeDirection")||(c.inMoving=!0),c}function ka(a){var b,c,d,e,f,g=a,h=g.kj,i=g.WE,j=g.aS,k=h.frozenTrailingRowCount(),l=h.frozenTrailingColumnCount(),m=h.am(),n=m.Ft(i,j),o=g.YR,p=o[_](),q=o[ba](),r=o[ea](),s=o[ga](),t=h.frozenRowCount(),u=h.frozenColumnCount(),v=h.getRowCount(3)-k-1,w=h.getColumnCount(3)-l-1;return i===Q?(t>0&&(b=h.getViewportTopRow(i),(p<t||b===t)&&(n.y-=m.fs,n[Z]+=m.fs)),k>0&&(c=h.getViewportBottomRow(i),r>v&&c===v&&(n[Z]+=m.gs))):i===Q-1?(b=h.getViewportTopRow(i+1),(r>=b||b===t)&&(f=m.Ft(i+1,j),n[Z]+=f[Z])):i===Q+1&&(c=h.getViewportBottomRow(i-1),(p<=c||c===v)&&(f=m.Ft(i-1,j),n.y=f.y,n[Z]+=f[Z])),j===Q?(u>0&&(d=h.getViewportLeftColumn(j),(q<u||d===u)&&(n.x-=m.hs,n[Y]+=m.hs)),h.frozenTrailingColumnCount()>0&&(e=h.getViewportRightColumn(j),(s>w||e===w)&&(n[Y]+=m.js))):j===Q-1?(d=h.getViewportLeftColumn(j+1),(s>=d||d===u)&&(f=m.Ft(i,j+1),n[Y]+=f[Y])):j===Q+1&&(e=h.getViewportRightColumn(j-1),(q<=e||e===w)&&(f=m.Ft(i,j-1),n.x=f.x,n[Y]+=f[Y])),n}function la(a,b,c,d,e){var f=ha(a);D(a).css([m,i,Y,Z],[f.y+c,f.x+b,f[Y]+d,f[Z]+e])}function ma(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=a;if(p.bS){b=p.$F,c=ka(p),d=p.cS,e=p.$R,f=e.direction,b=new q(b.x-c.x,b.y-c.y),g=fa(p,f,b),e.endX=g.x,e.endY=g.y,e.endWidth=g[Y],e.endHeight=g[Z],h=ha(d),i=g.y-h.y,j=g.x-h.x,k=g[Y]-h[Y],l=g[Z]-h[Z],la(d,j,i,k,l),m=p.dS;for(n in m)B(m,n)&&(o=m[n],la(o.moveResizeDiv,j,i,k,l))}}function na(a,b){var c,d=a.kj;d&&(c=d.RF(b),c===!1&&u.nl(b))}function oa(c){var d,i,j,k,l,m,n,o=c,p=o.kj,q=o.eS;if(q){if(d=y(p,q[g],p.getViewportTopRow(o.WE),!0),i=y(p,q[h],p.getViewportLeftColumn(o.aS),!1),j=q[e]-q[a]+(q[e]>q[a]?i:-1*i),k=q[f]-q[b]+(q[f]>q[b]?d:-1*d),0===j&&0===k)return;l=[],l.push(o.YR.name()),m=o.dS;for(n in m)B(m,n)&&l.push(n);p.wu().execute({cmd:"dragCopyFloatingObjects",sheetName:p.name(),floatingObjects:l,offsetX:j,offsetY:k})}}function pa(c){var d,i,j,k,l,m,n,o=c,p=o.kj,q=o.eS,r=p.zoom();if(q){d=y(p,q[g],p.getViewportTopRow(o.WE),!0),i=y(p,q[h],p.getViewportLeftColumn(o.aS),!1),j=q[e]-q[a]+(q[e]>q[a]?i:-1*i),k=q[f]-q[b]+(q[f]>q[b]?d:-1*d),j/=r,k/=r,l=[],l.push(o.YR.name()),m=o.dS;for(n in m)B(m,n)&&l.push(n);p.wu().execute({cmd:"moveFloatingObjects",sheetName:p.name(),floatingObjects:l,offsetX:j,offsetY:k})}}function qa(c){var d,i,j,k,l,m,n,o,p,q=c,r=q.kj,s=r.zoom(),t=q.YR,u=q.$R;if(u){d=y(r,u[g],r.getViewportTopRow(q.WE),!0),i=y(r,u[h],r.getViewportLeftColumn(q.aS),!1),j=u[e]-u[a]+(u[e]>u[a]?i:-1*i),j/=s,k=u[f]-u[b]+(u[f]>u[b]?d:-1*d),k/=s,l=(u.endWidth+i)/s-t[Y](),m=(u.endHeight+d)/s-t[Z](),n=[],n.push(t.name()),o=q.dS;for(p in o)B(o,p)&&n.push(p);r.wu().execute({cmd:"resizeFloatingObjects",sheetName:r.name(),floatingObjects:n,offsetX:j,offsetY:k,offsetWidth:l,offsetHeight:m})}}function Oa(a,b,c){var d,e,f,g,h,i=a,j=i.cS;if(j){d=c.x-b.x,e=c.y-b.y,Xa(j,d,e),f=i.dS;for(g in f)B(f,g)&&(h=f[g],Xa(h.moveResizeDiv,d,e))}}function Xa(a,b,c){var d=D(a),e=D(a).position();d.css([m,i],[e[m]+c,e[i]+b])}function Ya(a){var b,c,d,e,f,g,h,i,j,k,l,m=a,n=m.eS;n&&(b=m.YR,c=m.kj,d=c.am(),e=d[Y]-d.Br-d.zr,f=d[Z]-d.Cr-d.Ar,g=n.startX,h=n.startY,i=b.position().x,j=b.position().y,k=b[Y](),l=b[Z](),i+n.endX-g<0&&(n.endX=g-i),j+n.endY-h<0&&(n.endY=h-j),i+k+n.endX-g>e&&(n.endX=e+g-i-k),j+l+n.endY-h>f&&(n.endY=f+h-j-l),n.startTopRow=c.getViewportTopRow(m.WE),n.startLeftColumn=c.getViewportLeftColumn(m.aS))}function Za(a){var b,c,d,e,f,g=a,h=g.$R;h&&(b=g.kj,c=b.am(),d=c[Y]-c.Br-c.zr,e=c[Z]-c.Cr-c.Ar,f=new p(h.endX,h.endY,h.endWidth,h.endHeight),f=f.getIntersect(0,0,d,e),h.endX=f.x,h.endY=f.y,h.endWidth=f[Y],h.endHeight=f[Z],h.startTopRow=b.getViewportTopRow(g.WE),h.startLeftColumn=b.getViewportLeftColumn(g.aS))}function $a(a){var b,c,d,e,f,g,h,i,j=x(L),k=D(j),l=a;return k.addClass(Ca).addClass(wa).attr(P,M).css(N,ra).bind("mousedown",function(a){l.AD(a)}).bind(X,function(a){l.BD(a)}).bind(aa,function(a){l.CD(a)}),j.addEventListener("mousewheel",function(a){na(l,a)},!1),j.addEventListener("DOMMouseScroll",function(a){na(l,a)},!1),b=D(x(L)).addClass(Ga+" "+Ia+" "+La+" "+Ha),c=D(x(L)).addClass(Ga+" "+Ia+" "+Ma+" "+Ha),d=D(x(L)).addClass(Ga+" "+Ia+" "+Na+" "+Ha),e=D(x(L)).addClass(Ga+" "+Ja+" "+La+" "+Ha),f=D(x(L)).addClass(Ga+" "+Ja+" "+Na+" "+Ha),g=D(x(L)).addClass(Ga+" "+Ka+" "+La+" "+Ha),h=D(x(L)).addClass(Ga+" "+Ka+" "+Ma+" "+Ha),i=D(x(L)).addClass(Ga+" "+Ka+" "+Na+" "+Ha),k.append(b).append(c).append(d).append(e).append(f).append(g).append(h).append(i),ca.ao(l,"init",j),j}function _a(a){var b,c,d,e,f,g,h,j,k=a,l=k.hS&&k._R;if(l&&!k.cS){b=k.iS=x(L),k.cS=x(L),k.dS={},k.gS.jS.each(function(a){var b,c=a.YR;c&&c.name()!==k.YR.name()&&c.isSelected()&&!k.dS[c.name()]&&(b=a._R,k.dS[c.name()]={offsetX:b.x-l.x,offsetY:b.y-l.y,height:b[Z],width:b[Y],moveResizeDiv:x(L)})}),c=ka(k),d=D(b),d.css([N,m,i,Y,Z,va],[sa,c.y,c.x,c[Y],c[Z],"rgba(255,255,255,0.01)"]).addClass(Da).bind(X,function(a){k.BD(a)}).bind(aa,function(a){k.CD(a)}),e=l.y-c.y,f=l.x-c.x,ia(k.cS,b,f,e,l[Y],l[Z]),g=k.dS;for(h in g)B(g,h)&&(j=g[h],ia(j.moveResizeDiv,k.iS,f+j.offsetX,e+j.offsetY,j[Y],j[Z]));k.Ks&&D(k.Ks).append(k.iS)}}function ab(a){var b=a;b.RB||(D(A).bind(X+U,function(a){b.BD(a)}).bind(aa+U,function(a){b.CD(a)}),b.RB=!0)}function bb(a){var b=a;b.RB&&(b.RB=!1,D(A).unbind(X+U).unbind(aa+U))}function cb(a,b){var c,d,e,f,g,h,i,j,k,l,m,p,q,r,s,u=D(Fa,b);u.removeClass(Aa),c=a,d=ha(c.hS),e=c.kS,f=c.YR,c.lS&&(e=c.lS),g=ca.mS,h=ha(e),i=h.x,j=h.y,k=d[Z]-h.y-h[Z],l=d[Y]-h.x-h[Y],m=0,p=g+2,q=H(g/2+1),"1"===f.typeName&&(r=f.borderWidth(),s=f.borderStyle(),Ab(s)||(r=0),r>=q&&(m=r-q),k=d[Z]-j-h[Z]-r,l=d[Y]-i-h[Y]-r,i+=r,j+=r),i>0?(db(c,j>0,Pa,m,m,F,F,"nw"+V,n),db(c,d[Z]>0,Qa,m,(h[Z]-p)/2+j,F,F,"w"+V,w),db(c,k>0,Ra,m,F,F,m,"ne"+V,G)):(eb(c,Pa),eb(c,Qa),eb(c,Ra)),db(c,j>0,Sa,(h[Y]-p)/2+i,m,F,F,"n"+V,o),db(c,k>0,Ta,(h[Y]-p)/2+i,F,F,m,"n"+V,S),l>0?(db(c,j>0,Ua,F,m,m,F,"sw"+V,t),db(c,d[Z]>0,Va,F,(h[Z]-p)/2+j,m,F,"w"+V,z),db(c,k>0,Wa,F,F,m,m,"se"+V,T)):(eb(c,Ua),eb(c,Va),eb(c,Wa)),c.ZR=!0}function db(a,b,c,d,e,f,g,h,j){var l,n=a,o=D(c,n.hS);b?(l=ca.mS,o.css([i,m,k,C,Y,Z,W],[d,e,f,g,l,l,h]).addClass(za).attr("resizeDirection",j)):eb(n,c)}function eb(a,b){D(b,a.hS).removeClass(za).addClass(Aa)}function fb(a,b){D(Fa,b).removeClass(za).addClass(Aa),a.ZR=!1}function gb(a){var b,c,d,e,f,g=a,h=g.YR,i=h.src(),j=h.pictureStretch(),k=s.Om(h.sheet(),h.backColor()),l=g.kS;i&&l&&(b=D(l),g.XR!==i&&(g.XR=i,b.css([va+"-image",va+"-repeat"],["url('"+i+"')","no-repeat"])),b.css(va+"-color",k),j!==E&&j!==F&&h.oS&&(c=h.getOriginalWidth(),d=h.getOriginalHeight(),e=b[Y](),f=b[Z](),u.ql(l,e,f,c,d,j)))}function hb(a,b,c){var d,e,f,g,h=a.lS,j=a.YR,l=j.borderWidth(),n=j.borderStyle(),o=s.Om(j.sheet(),j.borderColor()),p=j.borderRadius(),q=0,r=H(ca.mS/2+1);Ab(n)||(l=0),l<r&&(q=r-l),d=q,e=q,f=q,g=q,r=I(l,r),b.x<0?d+=b.x-r:(d+=b.x<r?b.x-r:0,g=c[Y]-d-b[Y]-2-2*l),b.y<0?e+=b.y-r:(e+=b.y<r?b.y-r:0,f=c[Z]-e-b[Z]-2-2*l),D(h).css([ta,i,m,C,k,R+"-width",R+"-style",R+"-color",R+"-radius"],[ua,d,e,f,g,l,n,o,p])}return ca.prototype={AD:function(a){var b,c,d,e,f,g,h,i,j,k,m=this,n=m.kj,o=m.YR,p=n.ITa.Ky,r=m.WE,s=m.aS;if(n.ER(o)&&n.endEdit()&&(n.zt(!0),b={e:a,r:E},ca.ao(m,"preProcessMouseDown",b),!b.r)){if(0===a.button||2===a.button){if(c=o.isSelected(),a.ctrlKey||a.shiftKey?o.isSelected(!c):c||(n.uQ(),o.isSelected(!0)),c||l.Vl.Zl(n),p&&p.vQ(),n.EJ(),2===a.button)return;if(d=n.mm,e=n.Vs(),f=new q(a.pageX-e.left,a.pageY-e.top),g=ja(m,a),!o.allowMove()&&(!o.allowResize()||g.inMoving))return;m.$F=f,m.pS=!0,m.bS=g,g.inMoving?(h={},h.startTopRow=n.getViewportTopRow(r),h.startLeftColumn=n.getViewportLeftColumn(s),h.startX=f.x,h.startY=f.y,m.eS=h):(_a(m),i={},j=ha(m.cS),i.startX=j.x,i.startY=j.y,i.startWidth=j[Y],i.startHeight=j[Z],i.startTopRow=n.getViewportTopRow(r),i.startLeftColumn=n.getViewportLeftColumn(s),i.cursor=a.target.style.cursor,i.direction=D(a.target).attr("resizeDirection"),m.$R=i),ab(m),k=n.hitTest(f.x,f.y),d.rG={KG:k.rowViewportIndex,MG:k.colViewportIndex,sG:k.hitTestType},d.$F=f,d.qG(),d.O3=!0}return!1}},BD:function(a){var b,c,d,e,f=this,g=f.kj,h=f.hS,i=f.iS;if(g.ER(f.YR)&&(b={e:a,r:E},ca.ao(f,"preProcessMouseMove",b),!b.r))return g.dG?(h&&D(h).css(W,"default"),!0):(c=g.mm,d=g.Vs(),e=new q(a.pageX-d.left,a.pageY-d.top),f.pS&&(f.bS.inMoving?(f.qS=!0,_a(f),Oa(f,f.$F,e),D(i).css(W,O)):f.YR.allowResize()&&(f.kv=!0,ma(f),D(i).css(W,f.$R[W])),(f.qS||f.kv)&&(f.$F=e,c.$F=e,c.NG(),D(A.body).addClass(wa).attr(P,M))),!1)},CD:function(a){var b,c,d,e,f,g=this,h=g.kj,i=h.mm,j=g.YR,k=g.hS,l=g.bS;if(h.ER(j)&&(b={e:a,r:E},ca.ao(g,"preProcessMouseUp",b),!b.r))return h.dG?(D(k).css(W,O),!0):(i.O3=!1,i.RG(),c=h.Vs(),d=new q(a.pageX-c.left,a.pageY-c.top),e=g.eS,e&&(e.endX=d.x,e.endY=d.y),l&&(f=j.fixedPosition(),l.inMoving&&g.qS?(f&&Ya(g),a.ctrlKey?oa(g):pa(g)):g.kv&&(f&&Za(g),qa(g)),D(A.body).removeClass(wa)),g.rS(),!1)},rS:function(){var a=this;a.$R=E,a.eS=E,a.dS=E,D(a.iS).remove(),a.cS=E,a.pS=!1,bb(a),a.qS=!1,a.kv=!1},YR:function(){return this.YR},yl:function(a,b){var c,d,e,f,g,h,j,k,l=this,n=l.YR,o=l.kj;if(n){if(c=!1,l.sS=a,d=l.hS,!d){if(a.width<=0||a.height<=0)return;d=l.hS=$a(l),tb(n,d),e=o.parent,e&&(f=l.Ks=e.xv(),f&&D(f).append(d))}g=l.kS,g||(g=l.kS=n.WR(l.WE,l.aS),"1"===n.typeName?(l.lS=x(L),D(l.lS).addClass(wa+" "+Ba).attr(P,M),d.appendChild(l.lS),l.lS.appendChild(g)):(d.appendChild(g),c=!0)),l.lS&&(hb(l,b,a),b.x=0,b.y=0),h=D(g),j=n.isLocked()&&o.options.isProtected,D(d).css([m,i,Y,Z],[a.y,a.x,a[Y],a[Z]]),h.css([m,i,Y,Z,W],[b.y,b.x,b[Y],b[Z],j?"default":O]),l.Tka=a,n.refreshContent&&n.refreshContent(g),l.lS&&gb(l),n.isSelected()?(h.removeClass(ya).addClass(xa),n.allowResize()?cb(l,d):l.ZR&&fb(l,d)):(h.removeClass(xa).addClass(ya),fb(l,d)),c&&(k=g.firstChild,o.Wq(r.FloatingObjectLoaded,{sheet:o,sheetName:o.name(),floatingObject:n,element:k}))}},no:function(){var a=this,b=a.YR,c=a.hS,d=a.iS,e=a.kS;ca.ao(a,"dispose"),e&&b.VR&&(b.VR(e),b.no(!1)),c&&(D(c).remove(),a.hS=E),d&&(D(d).remove(),a.iS=E)}},ca.mS=7,ca}(),g=function(){function a(a){this.kj=a,this.jS=new z}function b(a){a.zR().forEach(function(a){a.dynamicMove()?mb(a):qb(a),a.dynamicSize()?zb(a):rb(a)})}function c(a,b,c){var d,e,f,g,h,i,j,k=a.kj,l=k.it(c),m=0,n=0,o=0,q=0;return l&&l.length>0&&(d=l[0],e=l[l.length-1],m=d.x,o=e.x+e[Y]-m),f=k.jt(b),f&&f.length>0&&(g=f[0],h=f[f.length-1],n=g.y,q=h.y+h[Z]-n),i=k.am(),j=i.Ft(b,c),j.getIntersect(m,n,o,q)||new p(0,0,0,0)}function d(a,c,d,e){var f,g,h,i,j,k,l,m,n=a,o=n.kj,p=new z,q=o.wr;return q.isNeedToUpdateLayout&&(b(q),q.isNeedToUpdateLayout=!1),f=o.am(),g=o.ss,h=o.it(d),i=o.jt(c),h.length<=0||i.length<=0?p:(j=h[0],k=h[h.length-1],l=i[0],m=i[i.length-1],q.zR().forEach(function(a){var b,c,d,n,o,q,r,s,t,u,v,w,x;if(a&&a.isVisible()){if(a.fixedPosition())d=a.position(),b=d.x*e+f.kt,c=d.y*e+f.nt;else{if(n=a[ba](),o=h.findCol(n))b=o.x;else if(n<j.col)for(b=j.x,q=j.col-1;q>=n;q--)b-=g._m(q);else for(b=k.x+k[Y],r=k.col+1;r<=n;r++)b+=g._m(r);if(b+=a[ca]()*e,s=a[_](),t=i.findRow(s),t)c=t.y;else if(s<l.row)for(c=l.y,u=l.row-1;u>=s;u--)c-=g.Sl(u);else for(c=m.y+m[Z],v=m.row+1;v<=s;v++)c+=g.Sl(v);c+=a[aa]()*e}w=H(a[Y]()*e),x=H(a[Z]()*e),p.push({name:a.name(),x:b,y:c,width:w,height:x})}}),p)}return a.prototype={no:function(){var a=this.jS;a.each(function(a){a.no()}),a.empty()},yl:function(a,b,e){var g,h,i,j,k,l,m,n,o,q;if(!(a<0||b<0)){for(g=this,h=g.kj,i=g.jS,j=h.wr,k=d(g,a,b,e),l=[],i.each(function(a){k.find(a.name)||l.push(a)}),m=0,n=l.length;m<n;m++)o=l[m],o.gS=E,i.remove(o.name),o.no();q=h.parent&&h.parent.options.useTouchLayout,f.mS=q?11:7,k.each(function(d){var e,k,l,m,n,o,q,r,s,t,u,v,w,x,y,z,A,B=j.NR(d.name),C=H(f.mS/2+1);B&&"1"===B.typeName&&(e=B.borderWidth(),k=B.borderStyle(),Ab(k)||(e=0),e>C&&(C=e)),l=c(g,a,b),m=1,n=d.x-C-m,o=d.y-C-m,q=d[Y]+2*C+2*m,r=d[Z]+2*C+2*m,s=I(l.y,o),t=I(l.x,n),u=r,v=q,w=C,x=C,y=-1*C-m,w=o-s+w,x=n-t+x,w<=0?(u+=w,u+=y):w<C&&w>0&&(u-=C-w),x<=0?(v+=x,v+=y):x<C&&x>0&&(v-=C-x),z=i.find(d.name),z||(z=new f(j.NR(d.name),h),z.gS=g,i.push(z)),z._R=d,z.WE=a,z.aS=b,A=new p(l.x,l.y,l[Y],l[Z]),z.yl(new p(t,s,v,u).getIntersectRect(A)||new p(t,s,0,0),new p(x,w,d[Y],d[Z]))})}}},a}(),h={FloatingObject:e,FloatingObjectCollection:yb,tS:f,uS:jb,vS:ib,wS:hb},D.extend(h,o),i={init:function(){var a=this,b=a.$oa=[];a.Zoa=function(a){b.forEach(function(b){b.Wva&&b.Wva(a)})},a.wr=a.ITa.wr,a.pictures=new yb(a,"1"),a.floatingObjects=new yb(a,"0")},dispose:function(a){var b=this;bb(b),D.each(b.wr.zR(),function(b,c){c.no(a)}),D(b.Ws()).unbind("mousedown.fos"),b.unbind(r.TableFiltered+_a),b.unbind(r.RangeFiltered+_a)},setHost:function(a){if(a){var b=this;a.bind("mousedown"+_a,function(){b.uQ()}),b.bind(r.TableFiltered+_a,function(){b.AR()}),b.bind(r.RangeFiltered+_a,function(){b.AR()})}},onLayoutChanged:function(a){var b=a.changeType,c=a.row,d=a.rowCount,e=a.col,f=a.colCount,g=this.wr;"addRows"===b?cb(g,c,d):"deleteRows"===b?db(g,c,d):"addColumns"===b?eb(g,e,f):"deleteColumns"===b&&fb(g,e,f)},paint:function(a){var b=this,c=a.clipRect;b.QP||(b.IR=function(a,c){var d,e;return b.FR||(b.FR=[]),d=b.FR[a],d||(b.FR[a]=[]),e=b.FR[a][c],e||(b.FR[a][c]=new g(b)),e=b.FR[a][c]},b.QP=function(a,b){var c,d,e,f,g,h=this;if(!h.fI&&h.wr)for(c=h.am(),b!==E&&void 0!==b||(b=h.zoom()),e=0;e<=2;e++)for(f=0;f<=2;f++)d=c.Ft(e,f),d&&(g=h.IR(e,f),g&&g.yl(e,f,b))}),b.QP(c)},lastNonNullRowAndCol:function(){var a=0,b=0,c=this.wr;return c&&c.zR().forEach(function(c){c&&(c[ea]()>a&&(a=c[ea]()),c[ga]()>b&&(b=c[ga]()))}),{lastNonNullRow:a,lastNonNullCol:b}},toJson:function(a,b){var c,d=b&&b.ignoreStyle;d||(c=this.wr.toJSON(),c.length>0&&(a.floatingObjects=c))},fromJson:function(a,c,d){var e,f,g,h=d&&d.ignoreStyle;h||(e=this,e.wr=new b(e),e.ITa.wr=e.wr,f=a&&a.floatingObjectArray,g=c?f&&f.floatingObjects:a.floatingObjects,g&&e.wr.fromJSON(g,c))},preProcessMouseDown:function(){this.uQ()},processKeyDown:function(a){var b,c,d,e,f=this.wr;if(f)for(b=f.zR(),d=b.length,c=0;c<d;c++)if(e=b[c],e.isSelected())return void(a.r=!0)}},l.Worksheet.$n(T,i),j={init:function(){l.Commands.JR(this.commandManager())}},l.Workbook.$n(T,j),k=l.lUa,D.extend(k.prototype,{BUa:function(a,b,c){var d,e=this.zTa;e&&(d=e.CUa,d||(d=e.CUa=[]),d.push({type:"property",floatingObject:a,name:b,value:c}))},AUa:function(){var a,b,c,d=this.zTa;d&&(a=d.CUa,a||(a=d.CUa=[]),b={},c=this.wr,D.each(c.QR,function(a,c){b[a]=c}),a.push({type:"collection",floatingObjects:b}))},DUa:function(a){var b,c,d,e,f,g;if(a)for(b=this.wr,c=a.length-1;c>=0;c--)d=a[c],"collection"===d.type?b.QR=d.floatingObjects:"property"===d.type&&(e=d.floatingObject,f=d.name,g=d.value,e[f](g))}}),k.$n(T,{init:function(){this.wr=new b(this.kj)},undo:function(a){var b=a.CUa;b&&this.DUa(b)}}),a.exports=h}()},function(a,b){a.exports=GC.Spread.Sheets},function(a,b){a.exports=GC.Spread.Common},function(a,b,c){!function(){"use strict";var b,d,e,f,g,h,i,j=c(2),k=c(3),l=j.GC$,m=l.isArray,n=j.Commands,o=k.k.ac,p=n.ActionBase,q=null,r=Math.min,s=k.j.Fa,t="unSelectAllFloatingObjects",u="deleteFloatingObjects",v="navigationNextFloatingObject",w="navigationPreviousFloatingObject",x="cutFloatingObjects",y="copyFloatingObjects",z="pasteFloatingObjects",A="dragCopyFloatingObjects",B="selectAllFloatingObjects",C="moveFloatingObjects",D="moveFloatingObjectsUp",E="moveFloatingObjectsDown",F="moveFloatingObjectsLeft",G="moveFloatingObjectsRight",H="resizeFloatingObjects",I="isSelected",J="name",K=n.h4,L=function(){function a(a){return"string"==typeof a[J]?a[J]:a[J]()}function b(){this.rM={}}return b.prototype={push:function(b){this.rM[a(b)]=b},remove:function(a){delete this.rM[a]},find:function(a){return this.rM[a]},empty:function(){delete this.rM,this.rM={}},each:function(a){var b,c=this.rM;for(b in c)c.hasOwnProperty(b)&&a(c[b])},isEmpty:function(){
var a,b=this.rM;for(a in b)if(b.hasOwnProperty(a))return!1;return!0}},b}();function M(a){var b=a.wr,c=!1;return b&&b.zR().forEach(function(a){a&&a[I]()&&(c=!0)}),c}function N(a,b){var c=o(b),d,e;if(o(b)>0)for(d=0;d<c;d++)e=a.wr.NR(b[d]),e&&e.isSelected(!0)}b=function(a){l.inherit(b,a);function b(){a.call(this)}var c={init:function(a,b){var c=this;c.kj=a,c.VQ=b},canExecute:function(){return!!M(this.kj)},canUndo:function(){var a=n.bWa(this.kj.name()),b=this.VQ[a],c=b&&b.CUa;return!!(c&&o(c)>0)||(c=b&&b.EUa,!!(c&&o(c)>0))}};return l.extend(b.prototype,c),b}(p),d=function(a){l.inherit(b,a);function b(b,c){a.call(this),this.init(b,c)}var c={constructor:b,execute:function(){var a,b,c,d,e,f,g=this,h=!1,i=g.kj,j=g.VQ,k=j.floatingObjects;if(g.canExecute()&&m(k)){for(i.ITa.startTransaction(),g.Lz(i,!0),a=i.wr,b=0,c=o(k);b<c;b++)d=a.NR(k[b]),d&&(e=i.slicers,g.zS(d)&&e&&e.vV(d[J]()),a.Fb(k[b],!0),d[I](!1));i.GJ(),g.Mz(i,!0),f=n.bWa(i.name()),j[f]=i.ITa.endTransaction(),h=o(k)>0}return h},undo:function(){var a,b=this,c=b.VQ,d=b.kj;return!!b.canUndo()&&(b.Lz(d,!0),a=n.bWa(d.name()),d.ITa.undo(c[a]),d.EJ(),b.Mz(d,!0),!0)},zS:function(a){return a&&"Slicer"===a.typeName}};return l.extend(b.prototype,c),b}(b),e=function(a){l.inherit(b,a);function b(b,c){var d=this;a.call(d),d.init(b,c)}var c={constructor:b,canExecute:function(){return!0},execute:function(){var a,b,c,d,e,f,g=this,h=!1,i=g.VQ,k=i.floatingObjects,l=g.kj;if(g.canExecute()&&m(k)){for(l.ITa.startTransaction(),g.Lz(l,!0),a=l.wr,b=0,c=o(k);b<c;b++)d=a.NR(k[b]),e=d.position(),d.position(new j.Point(e.x+i.offsetX,e.y+i.offsetY));g.Mz(l,!0),f=n.bWa(l.name()),i[f]=l.ITa.endTransaction(),h=o(k)>0}return h},undo:function(){var a,b=this,c=b.kj;return!!b.canUndo()&&(b.Lz(c,!0),a=n.bWa(c.name()),c.ITa.undo(b.VQ[a]),b.Mz(c,!0),!0)}};return l.extend(b.prototype,c),b}(b),f=function(a){l.inherit(b,a);function b(b,c){var d=this;a.call(d),d.init(b,c)}var c={execute:function(){var a,b,c,d,e,f,g=this,h=!1,i=g.VQ,k=i.floatingObjects,l=g.kj;if(N(l,k),g.canExecute()&&m(k)){for(l.ITa.startTransaction(),g.Lz(l,!0),a=l.wr,b=0,c=o(k);b<c;b++)d=a.NR(k[b]),e=d.position(),d.width(d.width()+i.offsetWidth),d.height(d.height()+i.offsetHeight),d.position(new j.Point(e.x+i.offsetX,e.y+i.offsetY));g.Mz(l,!0),f=n.bWa(l.name()),i[f]=l.ITa.endTransaction(),h=o(k)>0}return h},undo:function(){var a,b=this,c=b.kj;return!!b.canUndo()&&(b.Lz(c,!0),a=n.bWa(c.name()),c.ITa.undo(b.VQ[a]),b.Mz(c,!0),!0)}};return l.extend(b.prototype,c),b}(b),g=function(a){l.inherit(b,a);function b(){var b=this;a.call(b),b.kj=q}var c={canExecute:function(){var a=this,b=a.VQ.floatingObjects;return!!(o(b)>0&&a.ES(b))},canUndo:function(){var a=n.bWa(this.kj.name()),b=this.VQ[a],c=b&&b.CUa;return!!(c&&o(c)>0)},ES:function(a){var b,c,d,e=this,f=e.kj,g=f.wr;for(b=0,c=o(a);b<c;b++)if(d=g.NR(a[b]),d&&!f.ER(d))return!1;return!0},zS:function(a){return a&&"Slicer"===a.typeName}};return l.extend(b.prototype,c),b}(p),h=function(a){l.inherit(b,a);function b(b,c){var d=this;a.call(d),d.OFFSET=15,d.kj=b,d.VQ=c,s(c.clipboardFloatingObjectData)&&(c.clipboardFloatingObjectData=c.fromSheet.CR)}var c={execute:function(){var a,b,c,d,e,f,g,h,i,k,l,m,p,q,s,t,u,v,w,x,y,z,A,B,C,D,E=this,F=E.VQ,G=F.floatingObjects;if(E.canExecute()){for(a=E.kj,b=F.fromSheet,a.ITa.startTransaction(),E.Lz(a,!0),c=[],d=a.wr,e=F.clipboardFloatingObjectData,void 0===F.Jl&&(M(a)&&d.zR().forEach(function(a){a&&a[I]()&&c.push(a)}),F.Jl=E.kj.getActiveRowIndex(),F.GS=E.kj.getActiveColumnIndex()),M(a)&&d.zR().forEach(function(a){a&&a[I]()&&a[I](!1)}),f=[],i=Number.MAX_VALUE,k=i,l=i,m=[],g=0,h=o(G);g<h;g++)p=e.find(G[g]).position(),k=r(k,p.x),l=r(l,p.y),m.push(new j.Point(p.x-k,p.y-l));if(q=0,s=0,c.length)t=i,u=i,c.forEach(function(a){if(a){var b=a.position();t=r(t,b.x),u=r(u,b.y)}}),q=t<i?t+E.OFFSET:0,s=u<i?u+E.OFFSET:0;else{for(v=0;v<F.Jl;v++)s+=a.Yr(v,3);for(w=0;w<F.GS;w++)q+=a.$r(w,3)}for(g=0,h=o(G);g<h;g++)x=m[g],f.push(new j.Point(q+x.x,s+x.y));for(y=F.isCutting,z=b.wr,g=0,h=o(G);g<h;g++)C=e.find(G[g]),A=C.clone(a),A.sheet(a),B=!y||z.NR(G[g])||d.NR(G[g])?E.zS(A)?a.slicers.HS(A[J]()):d.FS():C.name(),A[J](B),E.zS(A)&&(a.slicers.Cz(A),A.width(C.width()),A.height(C.height())),A.isVisible(!0),A.position(f[g]),A[I](!0),d.Sb(A);return E.Mz(a,!0),D=n.bWa(a.name()),F[D]=a.ITa.endTransaction(),!0}return!1},undo:function(){var a,b,c=this;return!!c.canUndo()&&(a=c.kj,c.Lz(a,!0),b=n.bWa(a.name()),a.ITa.undo(c.VQ[b]),c.Mz(a,!0),!0)}};return l.extend(b.prototype,c),b}(g),i=function(a){l.inherit(b,a);function b(a,b){var c=this;c.kj=a,c.VQ=b}var c={constructor:b,execute:function(){var a,b,c,d,e,f,g,h,i,k=this,l=!1,m=k.VQ,p=m.floatingObjects,q=k.kj;if(k.canExecute()){for(q.ITa.startTransaction(),k.Lz(q,!0),a=q.wr,b=0,c=o(p);b<c;b++)d=a.NR(p[b]),d&&(e=d.clone(q),e.sheet(q),f=d.position(),e.position(new j.Point(f.x+m.offsetX,f.y+m.offsetY)),e[J](a.FS()),e[I](!0),d[I](!1),k.zS(e)&&q.slicers&&(g=e,h=q.slicers.HS(g.columnName()),g[J](h),q.slicers.Cz(g)),a.Sb(e));k.Mz(q,!0),i=n.bWa(q.name()),m[i]=q.ITa.endTransaction(),l=!0}return l},undo:function(){var a,b=this,c=b.kj;return!!b.canUndo()&&(b.Lz(c,!0),a=n.bWa(c.name()),c.ITa.undo(b.VQ[a]),b.Mz(c,!0),!0)}};return l.extend(b.prototype,c),b}(g);function O(a){var b=[];return a.wr.zR().forEach(function(a){a[I]()&&b.push(a[J]())}),b}function P(a,b,c){var d,e,f,g,h=a.BR(),i=h.fromSheet;for(h.fromSheet=a,h.isCutting=c,d=new L,e=0,f=0;f<o(b);f++)g=a.wr.NR(b[f]),g&&(d.push(g),e++);return i&&(i.CR=q),a.CR=d,e>0}n[t]={canUndo:!1,execute:function(a,b){var c=n.bT(a,b);return!!M(c)&&(c.suspendPaint(),c.uQ(),c.GJ(),c.resumePaint(),!0)}},n[B]={canUndo:!1,execute:function(a,b){var c=n.bT(a,b);c.suspendPaint(),c.wr.zR().forEach(function(a){a[I](!0)}),c.resumePaint()}},n[u]={canUndo:!0,execute:function(a,b,c){var e,f=n.bT(a,b);return c||(b.cmd||(b.cmd=u),b.floatingObjects||(e=O(f),b.floatingObjects=e)),o(b.floatingObjects)>0&&K(a,d,b,c)}},n[v]={canUndo:!1,execute:function(a,b){var c,d,e,f,g,h,i,j=n.bT(a,b);if(M(j)){for(j.suspendPaint(),g=j.wr.zR(),h=g.length,f=0;f<h;f++){if(i=g[f],d||(d=i),c){e=i;break}i&&i[I]()&&(c=i)}return j.uQ(),e||(e=d),e&&e[I](!0),j.resumePaint(),!0}return!1}},n[w]={canUndo:!1,execute:function(a,b){var c,d,e,f,g,h,i=n.bT(a,b);if(M(i)){for(i.suspendPaint(),f=i.wr.zR(),g=f.length,e=0;e<g;e++)if(h=f[e],c||(c=h),c[I]())d=h;else if(h[I]()||(d=h),h[I]())break;return d&&(i.uQ(),d[I](!0)),i.resumePaint(),!0}return!1}},n[x]={canUndo:!1,execute:function(a,b){var c,d=n.bT(a,b),e=[];return d.wr.zR().forEach(function(a){a[I]()&&e.push(a[J]())}),o(e)>0&&(P(d,e,!0),c={cmd:u,sheetName:d.name(),floatingObjects:e},d.wu().execute(c))}},n[y]={canUndo:!1,execute:function(a,b){var c=n.bT(a,b),d=[];return c.wr.zR().forEach(function(a){a[I]()&&d.push(a[J]())}),P(c,d,!1)}},n[z]={canUndo:!0,execute:function(a,b,c){var d,e,f,g,i=n.bT(a,b);return!i.isEditing()&&(d=i.BR(),e=d.fromSheet,!!(f=e&&e.CR)&&(g=[],f.each(function(a){g.push(a[J]())}),0!==o(g)&&(!i.Js&&(c||(b.cmd||(b.cmd=z),b.floatingObjects||(b.floatingObjects=g,b.fromSheet=e,b.isCutting=d.isCutting)),o(b.floatingObjects)>0&&K(a,h,b,c)))))}},n[A]={canUndo:!0,execute:function(a,b,c){return K(a,i,b,c)}};function Q(a){return function(b,c){var d,e,f=n.bT(b,c),g=0;return 0===a?g=-1:2===a&&(g=1),d=0,1===a?d=-1:3===a&&(d=1),e=O(f),o(e)>0&&f.wu().execute({cmd:C,sheetName:f.name(),floatingObjects:e,offsetX:g,offsetY:d})}}n[F]=Q(0),n[D]=Q(1),n[G]=Q(2),n[E]=Q(3),n[C]={canUndo:!0,execute:function(a,b,c){return(0!==b.offsetX||0!==b.offsetY)&&K(a,e,b,c)}},n[H]={canUndo:!0,execute:function(a,b,c){return K(a,f,b,c)}},n.JR=function(a){var b=j.Ul.sl(),c=!b,d=b;a.register(t,n[t],27,!1,!1,!1,!1),a.register(B,n[B],65,c,!1,!1,d),a.register(u,n[u],b?8:46,!1,!1,!1,!1),a.register(v,n[v],9,!1,!1,!1,!1),a.register(w,n[w],9,!1,!0,!1,!1),a.register(x,n[x],88,c,!1,!1,d),a.register(y,n[y],67,c,!1,!1,d),a.register(A,n[A]),a.register(z,n[z],86,c,!1,!1,d),a.register(C,n[C]),a.register(D,n[D],38,!1,!1,!1,!1),a.register(E,n[E],40,!1,!1,!1,!1),a.register(F,n[F],37,!1,!1,!1,!1),a.register(G,n[G],39,!1,!1,!1,!1),a.register(H,n[H])},a.exports={yR:L,FloatingObjectUndoActionBase:b,DeleteFloatingObjectUndoAction:d,MovingFloatingObjectUndoAction:e,ResizingFloatingObjectUndoAction:f,FloatingObjectCopyPasteUndoAction:g,ClipboardPasteFloatingObjectUndoAction:h,DragCopyFloatingObjectUndoAction:i}}()},function(a,b,c){!function(){"use strict";var b=c(2),d=c(1),e=b.Ul.Nl,f=b.Ul.Pl,g=d.FloatingObject,h=d.vS,i=d.wS,j=d.uS,k=b.GC$,l=null,m=void 0,n=function(a){var c,d,g,n,o,p,q,r,s,t;k.inherit(v,a);function u(a){return"number"==typeof a&&!isNaN(a)}c="src",d="backColor",g="pictureStretch",n="borderRadius",o="borderWidth",p="borderStyle",q="borderColor",r=[c,d,n,o,p,q,g],s=[[c,m,function(a,b){var d=this;d.oS=!1,w(d),d.srccallback||(d.srccallback=j(c)),d.srccallback.call(d,a,b)}],[d,l,j(d)],[n,-1,j(n),u],[o,1,j(o),u],[p,"none",function(a,b){var c=this;c.nS(a)||c.borderWidth(0),c.bscallback||(c.bscallback=j(p)),c.bscallback.call(c,a,b)}],[q,l,j(q)],[g,0,j(g)]];function v(b,c,d,e,f,g){var h=this;a.call(h,b,d,e,f,g),h.typeName="1",h.g3="1",h.bt=l,h.oS=!1,h.JS=!1,"string"==typeof c&&(h.JS=!f||!g,h.src(c))}function w(a){var c,d,e=a,f=e.src(),g=e.sheet();e.bt||(e.bt=new b.oo(function(){w(e)})),c=e.bt;try{c.ko(f)?(e.oS=!0,d=c.lo(f),e.KS=d.width,e.LS=d.height,e.JS&&(e.width(d.width,!0),e.height(d.height,!0),e.JS=!1),g&&g.repaint()):c.fo(f)}catch(a){}}return t={onPropertyChanged:function(a,b,c){var d,e=this;e.TR||(d=e.sheet(),d&&(d.ITa.BUa(e,a,c),this.Wq({sheet:d,sheetName:d.name(),picture:e,propertyName:a})))},toJSON:function(){var b=this,c=a.prototype.toJSON.call(this);return i.call(b,r,c),delete c.content,c},fromJSON:function(b,c){if(b){var d=this;d.TR=!0,a.prototype.fromJSON.call(d,b,c),h.call(d,r,b,c),d.oS=!1,w(d),d.TR=m}},clone:function(){var a=new v,b=JSON.stringify(this.toJSON());return a.fromJSON(JSON.parse(b)),a},getOriginalWidth:function(){return this.KS},getOriginalHeight:function(){return this.LS},nS:function(a){var b=["dotted","dashed","solid","double","groove","ridge","inset","outset"];return b.indexOf(a)>=0},WR:function(a,b){var c=e("div");return k(c).addClass("gc-floatingobject-content-container").addClass("gc-no-user-select").attr("unselectable","on").css("position","absolute"),this.UR(c,a,b),c},Wq:function(a){var c,d=this.sheet();d&&(d.Wq(b.Events.PictureChanged,a),"isSelected"===a.propertyName&&(c={sheet:a.sheet,sheetName:a.sheetName,picture:a.picture},d.Wq(b.Events.PictureSelectionChanged,c)))},no:function(a){self.bt&&a!==!1&&(self.bt.no(),self.bt=l)}},k.each(s,function(a,b){t[b[0]]=f(b[0],b[1],b[2],b[3])}),k.extend(v.prototype,t),v}(g);d.Picture=n,a.exports=d}()},function(a,b,c){!function(){"use strict";var a=c(7);a&&!function(){var b=c(2),d=b.GC$,e=d.extend,f=b.Ul.nl,g=a.jR,h=a.kR;function i(a,b,c){var d,e,f=this;f.yM=new g(f),f.DQ=new h(a,"FL_"+b.name,f.yM,2,200),f.BQ=c,f.CQ=new j(a,b),d=f.CQ,e=f.DQ,e._M=function(){return b.YR.isSelected()},e.bN=function(){return!0},e.dN=function(a){return d.jQ(a)},e.eN=function(a){return d.lQ(a)},e.fN=function(a){return d.pQ(a)},e.hN=function(a){return d.qQ(a)},e.iN=function(a){return d.sQ(a)}}e(i.prototype,{EQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!0)},FQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!1)},GQ:function(a){return this.yM.GQ(a)},HQ:function(a){return this.yM.HQ(a)},IQ:function(a){return this.yM.IQ(a)}});function j(b,c){var d=this;d.MS=c,d.YR=c.YR,d.NS=b,d.hQ=new a.TP(c.kj)}e(j.prototype,{OS:function(b){var c,e=new a.oP(b.X,b.Y),f=d(this.NS).offset();return f&&(c=document.body,e.X+=f.left+c.clientLeft||0,e.Y+=f.top+c.clientTop||0),e},jQ:function(a){a.DO=3},lQ:function(a){var b=this,c=b.OS(a.rN);b.MS.AD({target:a.GP,isTouch:!0,button:0,pageX:c.X,pageY:c.Y,stopPropagation:function(){}}),b.hQ.OP()},pQ:function(a){var b,c=this,d=a.dP.rO,e=c.MS.kj,f=e.parent;1!==d&&f&&f.options.allowUserZoom?(e.mm.O3=!1,c.MS.rS(),c.hQ.PP(d)):(b=c.OS(a.rN),c.MS.BD({isTouch:!0,button:0,pageX:b.X,pageY:b.Y,stopPropagation:function(){}}))},qQ:function(a){var b,c=this,d=a.dP.rO,e=c.MS.kj,f=e.parent;1!==d&&f&&f.options.allowUserZoom?c.hQ.SP(d):(b=c.OS(a.rN),this.MS.CD({isTouch:!0,button:0,pageX:b.X,pageY:b.Y,stopPropagation:function(){}}))},sQ:function(){var a,c;try{a=this,c=a.MS.kj,c.suspendPaint(),a.YR.isSelected()||(c.uQ(),a.YR.isSelected(!0),b.Vl.Zl(c)),c.clearSelection()}finally{c.resumePaint()}}}),c(1).tS.$n("touch",{init:function(a){var b=this,c=b.wR=new i(a,b,b.kj.parent.BQ);c.EQ()},dispose:function(){var a=this.wR;a&&a.FQ()},preProcessMouseDown:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.GQ(b)&&(f(b),a.r=!0)},preProcessMouseMove:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.IQ(b)&&(f(b),a.r=!0)},preProcessMouseUp:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.HQ(b)&&(f(b),a.r=!0)}})}()}()},function(a,b){a.exports=GC.Spread.Sheets.Touch},function(a,b){!function(){"use strict";a.exports={Exp_FloatingObjectHasSameNameError:"The current worksheet already has a floating object with the same name.",Exp_FloatingObjectNameEmptyError:"Floating object must have name"}}()}]);