webpackJsonp([11],{mnHe:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("gRE1"),r=a.n(s),i=a("Dd8w"),l=a.n(i),n=a("mvHQ"),o=a.n(n),c=a("wT04"),d=(a("0RKR"),a("PJh5")),u=a.n(d),p={mixins:[a("BdlB").a],data:function(){return{defaultAll:!1,moment:u.a,tableData:[],influenceTable:[],tableDataFormat:[],editCell:[],code:[],treeData:{},editTypeObj:{},userinfo:{},routerQuery:{},publicParam:{},tableAllData:[],sideTreeData:[],state:!0}},components:{GridMockTable:c.b},watch:{$route:{handler:function(e,t){console.log(e),this.userinfo=JSON.parse(e.query.userinfo),this.publicParam=JSON.parse(e.query.publicParam),this.routerQuery=e.query},immediate:!0}},computed:{table:function(){return JSON.parse(o()(this.$store.state.table))}},methods:{queryMerchantInsideRelatedClassify:function(){var e=this,t=this.routerQuery,a=t.mergeCustomerId,s=t.mergeProjectId;this.treeData=JSON.parse(sessionStorage.getItem("selectTreeData"));var r={param1:a,param2:s};this.$sacpApis.queryMerchantInsideRelatedClassify(r).then(function(t){t.success?(t.data.length&&e.tableCategory(t.data),e.queryMerchantInsideRelatedList(r)):e.$message.error(t.resultInfo.statusText)}).catch(function(t){e.$message.error(t)})},queryMerchantInsideRelatedList:function(e){var t=this;this.$sacpApis.queryMerchantInsideRelatedList(l()({},e,this.publicParam)).then(function(e){e.success?e.data&&(t.tableAllData=e.data,t.tableDataFormat.forEach(function(a){a.data=e.data[0][a.columns[0].code],a.editCell=t.editTypeObj[a.columns[0].code]}),t.tableData=t.tableDataFormat.map(function(e){return[e]}),t.influenceTable=t.influenceTable.map(function(e){return[e]})):t.$message.error(e.resultInfo.statusText)}).catch(function(e){t.$message.error(e)})},tableCategory:function(e){var t=this,a=[],s=[],r=[],i=[],n=[],o=[],c=[];if(Array.isArray(e)){e.forEach(function(e,t){-1==s.indexOf(e.classifyCode)&&(s.push(e.classifyCode),a.push({title:e.classifyName,prop:e.classifyCode,code:e.classifyCode,isCur:e.isCur,children:[],data:[]}),n.push(l()({},e)),"A0"!=e.classifyCode&&"E0"!=e.classifyCode&&"G0"!=e.classifyCode&&i.push({title:e.classifyName,idx:t}))}),a.forEach(function(t){e.forEach(function(e,a){t.prop==e.classifyCode&&(t.children.push({title:e.fieldName,prop:e.fieldCode,dataField:e.dataField,classifyCode:e.classifyCode,isEdit:e.isEdit,pageFieldType:e.pageFieldType}),1==e.isEdit&&"1"!=e.pageFieldType&&r.push({title:e.fieldName,prop:e.fieldCode,isEdit:e.isEdit,pageFieldType:e.pageFieldType,classifyCode:e.classifyCode,insideType:e.insideType}))})}),this.classifyCode="",a.forEach(function(e){"G0"==e.prop||"A0"==e.prop||"E0"==e.prop?(t.classifyCode=e.prop,o.push({columns:[e],data:[]}),delete e.data):(c.push({columns:[e],data:[]}),delete e.data)}),n.unshift({mergeCustomerName:""}),this.tableDataFormat=c,this.influenceTable=o,this.editCell=r;var d={};s.forEach(function(e){r.forEach(function(t){Array.isArray(d[e])||e in d?e===t.classifyCode&&d[e].push(t):d[e]=[t]})}),this.editTypeObj=d}},onChangeTime:function(e,t){},handleChange:function(e,t,a,s,r){},handleBlur:function(){console.log("blur")},handleFocus:function(){console.log("focus")},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0},selected:function(e,t,a){this.$emit("change",{subjectName:t[0],subjectId:e}),this.$forceUpdate()},fillterFUN:function(e,t){return t.data.props.title.includes(e)},selectTreeData:function(e){for(var t=0;t<this.editCell.length;t++){var a=this.editCell[t];if("6"===a.pageFieldType&&e===a.prop)return this.treeData.purpose}},selectData:function(e){switch(e.dicCode){case"固定资产购入方式":return this.treeData.purchaseMethod;case"固定资产折旧方法":return this.treeData.depreciation}},headerMessage:function(e){var t=this.routerQuery,a=t.mergeCustomerName,s=t.mergeProjectName;return"object"===e?s:a},hideMenu:function(){this.state?this.state=!1:this.state=!0},onSelect:function(e,t){var a=this,s=(t.selected,t.selectedNodes),r=(t.node,t.event,s[0].dataRef),i=r.classifyCode;r.insideType,r.classifyName;if(console.log(i),"all"!=i&&isNaN(1*i))for(var l=function(e){var t=a.tableDataFormat[e],s=t.columns[0].children;s&&s.length&&s.forEach(function(e){e.classifyCode===i&&(a.tableData=[[t]])})},n=0;n<this.tableDataFormat.length;n++)l(n);else this.tableData=this.tableDataFormat.map(function(e){return[e]})},onExpand:function(){},queryTradeTree:function(e){var t=this,a=this.routerQuery,s=a.mergeCustomerId,i=a.mergeProjectId,n=this.userinfo,o=n.curCustomerId,c=n.curProjectId;this.$sacpApis.queryTradeTree(l()({param1:s,param2:i,param3:o,param4:c},this.publicParam)).then(function(e){if(!e.success)return t.$message.error(e.resultInfo.statusText);e.data&&e.data.length?(e.data[0].children=r()(e.data[0].children),t.sideTreeData=e.data,t.sideTreeData.map(function(e){e.children.map(function(e){var a=e.classifyName.match(/\((.+?)\)/g)[0];a.substring(1,a.length-1)>0&&(t.defaultAll=!0)})}),console.log(t.sideTreeData,"1111")):(t.sideTreeData=[],console.log(t.sideTreeData,"2222"))}).catch(function(e){return t.$message.error(e)}).finally(function(){return t.spinning=!1})}},mounted:function(){this.queryTradeTree(),this.queryMerchantInsideRelatedClassify()}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-layout-header",[a("a-row",[a("a-col",{attrs:{span:1}},[a("div",{staticClass:"logo"})]),e._v(" "),a("a-col",{attrs:{span:7}},[a("div",{staticClass:"customerInformation"},[a("p",{staticClass:"pageHead",attrs:{title:e.headerMessage("object")}},[e._v("\n                        客户:"+e._s(e.headerMessage("customer"))+"\n                    ")]),e._v(" "),a("p",{staticClass:"pageHead",attrs:{title:e.headerMessage("customer")}},[e._v("\n                        项目:"+e._s(e.headerMessage("object"))+"\n                    ")])])]),e._v(" "),a("a-col",{attrs:{span:7}}),e._v(" "),a("a-col",{attrs:{span:9}},[a("div",{staticStyle:{height:"60px","line-height":"60px"}},[e._v("\n                    关联方名称:"+e._s(e.routerQuery.mergeCustomerName)+"\n                ")])])],1)],1),e._v(" "),a("a-layout",[a("a-layout-sider",{style:{backgroundColor:"white",flex:e.state?" 0 0 230px":" 0 0 0px",maxWidth:"300px",minWidth:e.state?"200px":"0px",padding:"20px"}},[a("div",{staticClass:"asider-container"},[a("a-button",{staticClass:"shrink-button",attrs:{type:"primary"},on:{click:e.hideMenu}},[e.state?a("a-icon",{attrs:{type:"caret-left"}}):e._e(),e._v(" "),e.state?e._e():a("a-icon",{attrs:{type:"caret-right"}})],1),e._v(" "),e.state&&e.sideTreeData.length?a("a-directory-tree",{style:{fontSize:"16px",padding:"20px 0"},attrs:{multiple:"",defaultExpandAll:e.defaultAll,"default-selected-keys":["all"],showIcon:!1,"tree-data":e.sideTreeData,replaceFields:{children:"children",title:"classifyName",key:"key"}},on:{select:e.onSelect,expand:e.onExpand}}):e._e()],1)]),e._v(" "),a("a-layout-content",{style:{height:"calc(100vh - 100px)",margin:"10px 16px 30px",overflow:"auto",backgroundColor:"white",marginLeft:"15px!important",paddingTop:"30px !important"}},e._l(e.tableData,function(t,s){return a("div",{key:s},[a("grid-mock-table",{attrs:{border:"",rowDragable:!1,colDragable:!1,rowDragableState:!1,editIcon:!0},scopedSlots:e._u([e._l(t.editCell,function(t,s){return{key:"col-"+t.prop,fn:function(r){var i=r.row,l=r.col,n=r.curCol,o=(r.colIndex,r.rowIndex),c=(r.record,r.recordCol,r.cellIndex),d=r.columns;return[a("div",{key:s,staticClass:"slot-div"},["3"===t.pageFieldType&&i.uscc?a("a-select",{staticStyle:{width:"200px"},attrs:{"show-search":"","default-value":l,placeholder:"请选择","option-filter-prop":"children","filter-option":e.filterOption,disabled:!0},on:{focus:e.handleFocus,blur:e.handleBlur,change:function(t){return e.handleChange(t,i,n,c,o)}},model:{value:i[n],callback:function(t){e.$set(i,n,t)},expression:"row[curCol]"}},e._l(e.selectData(d),function(t,s){return a("a-select-option",{key:s,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1):"4"===t.pageFieldType&&i.uscc?a("a-date-picker",{staticStyle:{width:"130px"},attrs:{"value-format":"YYYY-MM-DD",disabled:!0,"default-value":l?e.moment(l,"YYYY-MM-DD"):""},on:{change:e.onChangeTime},model:{value:i[n],callback:function(t){e.$set(i,n,t)},expression:"row[curCol]"}}):"5"===t.pageFieldType&&i.uscc?a("a-month-picker",{staticStyle:{width:"130px"},attrs:{"value-format":"YYYY-MM-01",disabled:!0,"default-value":l?e.moment(l,"YYYY-MM-DD"):""},on:{change:e.onChangeTime},model:{value:i[n],callback:function(t){e.$set(i,n,t)},expression:"row[curCol]"}}):"6"===t.pageFieldType&&i.uscc?a("a-tree-select",{key:"key",staticStyle:{width:"100%"},attrs:{"show-search":"",disabled:!0,"dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择","allow-clear":"","tree-default-expand-all":"","tree-data":e.selectTreeData(n),replaceFields:{value:"subjectId"},filterTreeNode:e.fillterFUN},on:{change:e.selected},model:{value:i[n],callback:function(t){e.$set(i,n,t)},expression:"row[curCol]"}}):e._e()],1)]}}})],null,!0),model:{value:e.tableData[s],callback:function(t){e.$set(e.tableData,s,t)},expression:"tableData[tableIdx]"}})],1)}),0)],1)],1)},staticRenderFns:[]};var h=a("VU/8")(p,f,!1,function(e){a("vXZ4")},"data-v-0b36db6d",null);t.default=h.exports},vXZ4:function(e,t){}});
//# sourceMappingURL=11.146620d8312ea72a3861.js.map