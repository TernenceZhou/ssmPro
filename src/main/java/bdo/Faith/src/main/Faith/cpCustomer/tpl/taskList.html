<div>
<table class="table  table-borderless">
	<!-- <tbody> -->
	<transition-group name="task-list-trans" tag="tbody">
	<tr v-if="pageModel.previou >= 0" :key="'task_page_previou'">
		<td colspan="2">
			<div class="text-center push">
				<small>
					<a href="javascript:void(0)" @click="$emit('task-list-loadmore', 'pre')">加载更多...</a>
				</small>
			</div>
		</td>
	</tr>
	<template v-for="(task, index) in taskList">
		<tr :key="'task_list_'+task.taskId">
			<td class="text-center hidden-xs" style="width: 40px;">
				<a>
					<img class="img-avatar" src="assets/img/avatars/avatar2.jpg" alt="" style="width: 40px;height: 40px;">
				</a>
			</td>
			<td>
				<div class="bg-white" style="padding: 10px;">
					<div class="arrow" style="top: 20%;"></div>
					<div>
						<a>{{ task.__uuserId.userName }}</a>
						<span style="margin-left:15px;">{{ formatDate(task.creationDate) }}</span>
						<a href="javascript:void(0)"><i v-if="task.isOwner == 'true'" class="fa fa-close text-primary pull-right" @click="$emit('del-task', task)"> 删除</i></a>
						<a href="javascript:void(0)"><i v-if="task.isOwner == 'true'" class="fa fa-edit text-primary pull-right" @click="$emit('edit-task', task)"> 编辑</i></a>
					</div>
					<h5 >{{ task.taskName }}</h5>
					<p v-html="task.intro"></p>
					<template v-if="task.files">
						<div class="form-material" style="margin-top: 30px;">
							<div id="tasklist-files-wrapp" name="tasklist-files-wrapp">
								<a v-for="(file, findex) in task.files" class="" href="javascript:void(0)">
									<div class="">
										<i class="fa fa-file text-primary "> </i> 
										<span class="text-muted" @click="$emit('download-file', file)">
											{{ file.fileName }} 
										</span> 
										<a  href="javascript:void(0)" v-if="task.isOwner == 'true'"><i class="fa fa-close text-primary pull-right" @click="$emit('del-file', file)" style="margin-top: .3em;"></i></a>
										<a href="javascript:void(0)"><i class="fa fa-download text-primary pull-right" @click="$emit('download-file', file)" style="margin-top: .3em;"></i></a>
									</div>
								</a>
							</div>
							<label for="tasklist-files-wrapp"><i class="glyphicon glyphicon-link"> </i>附件:</label>
						</div>
					</template>
					<div style="border-bottom: 1px solid #e9e9e9; padding-bottom: 20px;">
						<a  href="javascript:void(0)"><i class="fa fa-edit text-primary pull-right" @click="$emit('comment-task', task)"> 评论</i></a>
					</div>
				</div>
				<template v-if="task.comments">
					<div class="bg-white" v-for="comment in task.comments" style="border-bottom: 1px solid #e9e9e9; padding: 10px; ">
						<div>
							<a>{{ comment.__uuserId.userName }}</a>
							<span v-if="comment.parentId">回复<a>{{ comment.__uparentUserId.userName}}</a></span>
							<!-- <a>:</a> -->
							<span style="margin-left:15px;">{{ formatDate(comment.creationDate) }}</span>
							<a href="javascript:void(0)" v-if="comment.isOwner == 'true'"><i class="fa fa-close text-primary pull-right" @click="$emit('del-comment', comment)"> 删除</i></a>
						</div>
						<p v-html="comment.comment"><!-- {{ comment.comment }} --></p>
						<template v-if="comment.files">
							<div class="form-material" style="margin-top: 30px;">
								<div id="tasklist-files-wrapp" name="tasklist-files-wrapp">
									<a v-for="(cfile, cfindex) in comment.files" class="" href="javascript:void(0)">
										<div class="">
											<i class="fa fa-file text-primary "> </i> 
											<span class="text-muted" @click="$emit('download-file', cfile)">
												{{ cfile.fileName }} 
											</span> 
											<a  href="javascript:void(0)" v-if="comment.isOwner == 'true'"><i class="fa fa-close text-primary pull-right" @click="$emit('del-file', cfile)" style="margin-top: .3em;"></i></a>
											<a href="javascript:void(0)"><i class="fa fa-download text-primary pull-right" @click="$emit('download-file', cfile)" style="margin-top: .3em;"></i></a>
										</div>
									</a>
								</div>
								<label for="tasklist-files-wrapp"><i class="glyphicon glyphicon-link"> </i>附件:</label>
							</div>
						</template>
						<div style="height:15px;" v-if="comment.isOwner != 'true'">
							<a href="javascript:void(0)" ><i class="fa fa-edit text-primary pull-right" @click="$emit('reply-comment', [task, comment])"> 回复</i></a>
						</div>
					</div>
				</template>
			</td>
		</tr>
		<tr v-show="task.commentFormShow" :key="'task_comment_form_'+task.taskId">
			<td class="text-center hidden-xs" style="width: 40px;"></td>
			<td>
				<keep-alive>
					<component :is="task.commentForm"
					:jsonData="commentFormModel"
					:task="task"
					></component>
				</keep-alive>
			</td>
		</tr>
	</template>
	<tr v-if="pageModel.next >= 0" :key="'task_page_next'">
		<td colspan="2">
			<div class="text-center push">
				<small>
					<a href="javascript:void(0)" @click="$emit('task-list-loadmore', 'next')">加载更多...</a>
				</small>
			</div>
		</td>
	</tr>
	</transition-group>
	<!-- </tbody> -->
</table>
</div>