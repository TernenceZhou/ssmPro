/*!
 * 
 * Spread.Sheets Library 12.1.0
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Bindings=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){!function(){"use strict";var b,d,e,f={};c(1),b=c(3),g(f,b),d=c(5),g(f,d),e=c(6),g(f,e),f.SR={},f.SR.en=c(7),a.exports=f;function g(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}}()},function(a,b,c){!function(){"use strict";var a,b,d,e,f,g,h,i,j,k,l,m,n,o;function p(a,b,c){"string"==typeof c&&(c={name:c}),a.ITa.do("setItem",!1,3,b,c);var d=c&&c.formatter,e=c&&c.cellType;d&&a.setFormatter&&a.setFormatter(-1,b,d),e&&a.setCellType(-1,b,e),c&&c.width&&a.setColumnWidth(b,c.width)}a=c(2),b=c(3).qL,d=a.j.Fa,e=c(4),f=e.Worksheet,g=e.GC$,h=g.isEmptyObject,i=g.extend,j=f.prototype,k=null,l="bindingPath",m=a.l,n={getDataSource:function(){var a=this.wq;return a?a.getSource():k},setDataSource:function(a,c){var d,f,g,h,i,j=this,k=j.wq;if(k&&k.getSource()!==a){if(c&&j.vs(),a){if(k=j.wq,d=k.bind(a,j.ITa.zTa),!d&&(j.setRowCountCore(k.getRowCount()),j.autoGenerateColumns&&(j.setColumnCount(k.getColumnCount()),f=k.rL())))for(g=0,h=f.length;g<h;g++)j.ITa.do("setItem",!1,3,g,{name:f[g]})}else j.wq=new b(j);j.clearPendingChanges(),e.X3&&j.recalcAll(),i=j.tu(),i&&i.PA===j&&i.hZ(),j.$p()}},bindColumn:function(a,b){var c=this;c.suspendPaint();try{p(c,a,b)}finally{c.resumePaint()}},bindColumns:function(a){var b,c,d=this;d.suspendPaint();try{if(a)for(b=a.length,isNaN(b)||d.setColumnCount(b),c=0;c<b;c++)p(d,c,a[c])}finally{d.resumePaint()}},getDataItem:function(a){var b,c,e,f,g,h,i=this,j=i.wq;if(!j||0===j.getRowCount())return k;if(b=i.getColumnCount(),c={},e=j.ru(a))for(f in e)e.hasOwnProperty(f)&&"function"!=typeof f&&(c[f]=e[f]);for(g=0;g<b;g++)h=i.ITa.Jp(!1,3,g),h&&h.name&&h.name.length>0&&d(c[h.name])&&(c[h.name]=i.getValue(a,g));return c},getDataColumnName:function(a){var b,c=this;return 0<=a&&a<c.getColumnCount()&&c.getDataSource()?(b=c.ITa.Jp(!1,3,a),b&&(b.displayName||b.name)):k},getBindingPath:function(a,b){return this.ITa.getValueForKey(a,b,l)},setBindingPath:function(a,b,c){var d=this;return d.ITa.do("setValueForKey",a,b,l,c),d.$p(),d}},i(j,n),o=e.CellRange,o.prototype.bindingPath=o.Pl(j.getBindingPath,j.setBindingPath);function q(a,b,c,e){var f,g,h,i,j=a.wq;for(f=0;f<c;f++)for(g=0;g<e;g++)h=j.getValue(f,g).value,d(h)||(i=h,m.Ska(h)&&(i=m.Daa(h)),a.qI(b,f,g,i))}function r(a,b,c,e){var f,g,h,i,j,k=a.options.colHeaderAutoTextIndex;for(f=0;f<c;f++)if(k>=0&&f===k||k===-1&&f===c-1)for(g=0;g<e;g++)h=b[f]&&b[f][g]&&b[f][g].value,i=a.ITa.Jp(!1,3,g),d(h)&&i&&(j=i.displayName||i.name,j&&a.qI(b,f,g,j))}f.$n("binding",{init:function(){var a=this;a.autoGenerateColumns=!0,a.wq=new b(a)},dispose:function(a){var b=this;a!==!1&&(b.wq=k)},onLayoutChanged:function(a){var b,c,d,e,f,g=this,h=a.changeType,i=a.row,j=a.rowCount,l=a.sheetArea,m=g.wq;if("addingRows"===h)m&&m.sL()===!1?a.canAdd=!1:m&&m.tL()===!1&&(a.newRow=g.getRowCount());else if("addRows"===h)m&&m.uL(i,j,g.ITa.zTa);else if("deletingRows"===h){if(m)if(m.vL()===!1)a.canDelete=!1;else for(g.Ts||(g.Ts=[]),b=g.Ts,c=g.ITa,d=m.getRowCount(),e=0;e<j&&i+e<c.getRowCount();e++)f=k,i+e<d&&(f=m.ru(i+e)),b.push({row:i+e,data:f})}else"deleteRows"===h?m&&m.wL(i,j,g.ITa.zTa):"settingRowCount"===h&&(!m.getSource()||m.xL()||3!==l&&2!==l||(a.canSet=!1))},toJson:function(a,b){var c,d,e,f=this,g=f.getColumnCount(),i=f.getDataSource();b&&b.includeBindingSource&&i&&(c=a.data.dataTable||{},q(f,c,f.getRowCount(),g),h(c)||(a.data.dataTable=c),d=a.colHeaderData.dataTable||{},r(f,d,f.getRowCount(1),g),h(d)||(a.colHeaderData.dataTable=d)),e=f.autoGenerateColumns,e!==!0&&(a.autoGenerateColumns=f.autoGenerateColumns)},fromJson:function(a,c){var e,f,g,h,i=this;i.wq=new b(i),c&&(e=i.wq,f=a.dataSource,g=a.dataBinding,f&&e.bind(f),g&&e.fromJSON(g,c)),h=a.autoGenerateColumns,d(h)||(i.autoGenerateColumns=h)},preFromJson:function(){this.wq=new b(this)}}),e.lUa.$n("binding",{priority:6e3,getValue:function(a){var b,c=a.row,d=a.col,e=a.sheetArea,f=this.kj.wq;3===e&&f&&f.Ou&&(b=f.getValue(c,d),a.isValueGet=b.hasBinding,a.value=b.value)},setValue:function(a){var b,c,d,e=a.row,f=a.col,g=a.value,h=a.sheetArea,i=this.kj,j=i.wq;3===h&&j&&j.Ou&&(b=j.getValue(e,f),b.hasBinding&&(c=b.value,g!==c&&(i.isDirtySuspended()||(d=i.getDataItem(e),this.Cp(e,f,{Dp:d,Ep:c},h)),j.setValue(e,f,g,i.ITa.zTa)),a.isValueSet=!0))},undo:function(a){var b,c,d=a.rUa;if(d)for(b=d.length-1;b>=0;b--)c=d[b],c.bindingManager.sUa(c)}})}()},function(a,b){a.exports=GC.Spread.Common},function(a,b,c){!function(){"use strict";var b=c(4),d=c(2),e=b.GC$,f=e.isNumeric,g=d.j.Fa,h=b.Events,i={},j=null,k=void 0,l="string",m=i.yL={},n="cellBinding",o=function(){return d.C(i.SR)()};function p(a){this.xf=a}p.prototype={setValue:function(a,b){z(this.xf,a,b)},getValue:function(a){return A(this.xf,a)},getSource:function(){return this.xf}},i.CellBindingSource=p;function q(a){this.ad(a)}q.prototype={bind:function(a,b){var c,d,f,g,h=this,i=h.kj,j=h.Ou;if(b&&h.tUa(b,{type:"bind",oldDataSource:j}),j&&(j.lka&&(j.subscribe=j.lka,delete j.mka,delete j.lka),y(j.dispose)&&j.dispose()),h.zL(h.AL),h.zL(h.BL),h.ad(i),h.Ou=a,a){if(c=h.CL=v(a),!c)throw Error(o().Exp_NotSupportedDataSource);h.DL=h.EL(),i&&e[e.sd]({tc:i.parent}),i&&(d=h.AL,f=a.currentPosition,a.subscribe&&d.push(a.subscribe(h.FL,h)),f&&f.subscribe&&d.push(f.subscribe(h.GL,h)),y(a.subscribe)&&!a.lka&&(g=a.lka=a.subscribe,a.mka=!1,a.subscribe=function(b,c){var d=[].concat.apply([],arguments),e=function(){if(!a.mka&&y(b))return b.apply(c,arguments)};return d[0]=e,g.apply(a,d)}),h.Lx()),h.HL=w(a,c)}return s(i,a)},Lx:function(){var a,b,c,d,e,f=this,g=f.kj,h=f.Ou;if(g&&h&&(a=f.CL,f.zL(f.BL),b=j,a!==n&&(c=g.getActiveRowIndex(),h.currentPosition?(-1<=c&&c<h.count()&&h.currentPosition(c),b=h.currentItem()):b=f.ru(c)),b)){d=function(){g&&g.repaint()};for(e in b)b[e]&&y(b[e].subscribe)&&f.BL.push(b[e].subscribe(d,j,j))}},zL:function(a){var b,c;if(a)for(b=0;b<a.length;b++)c=a[b],c&&y(c.dispose)&&c.dispose()},getRowCount:function(){var a=this,b=a.Ou,c=a.CL,d=0;return b&&c&&c!==n&&(d=m[c].getDataLength(b)),d},getColumnCount:function(){var a,b,c,d=this.HL;return d?d.length:(a=this.Ou,a&&(b=a[0],c=e.getType(b),"null"===c||c===l||"number"===c)?1:0)},getSource:function(){return this.Ou},rL:function(){return this.HL},Nka:function(a){this.HL=a},ru:function(a){var b=this.Ou,c=this.CL,d=j;return b&&c&&c!==n&&(d=m[c].getDataItem(b,a)),d},EL:function(){var a,b,c,d=this;if(!d.DL)for(a=d.getRowCount(),b=0;b<a;b++)if(c=d.ru(b)){d.DL=c.entityAspect&&c.entityType||c.constructor;break}return d.DL},getValue:function(a,b){return t(this,a,b)},setValue:function(a,b,c,d){var e,f=this;return d&&(e=t(f,a,b).value,f.tUa(d,{type:"setValue",row:a,col:b,oldValue:e})),u(f,a,b,c)},sL:function(){var a=m[this.CL];return a&&a.canAdd&&a.canAdd()},tL:function(){var a=m[this.CL];return a&&a.canInsert&&a.canInsert()},vL:function(){var a=m[this.CL];return a&&a.canRemove&&a.canRemove()},uL:function(a,b,c){var d,e,f=this,g=f.Ou;!g||a>f.getRowCount()||(d=f.CL,e=f.EL(),d&&d!==n&&!f.IL&&(f.JL=!0,c&&f.tUa(c,{type:"addItems",row:a,rowCount:b}),m[d].addItems(g,a,b,e),f.JL=!1))},wL:function(a,b,c){var d,e=this,f=e.CL,g=e.getRowCount(),h=e.Ou;!h||a>=g||f&&f!==n&&!e.IL&&(e.JL=!0,d=m[f].removeItems(h,a,b),c&&d&&d.length>0&&e.tUa(c,{type:"removeItems",row:a,removedItems:d}),e.JL=!1)},uUa:function(a,b){var c=this,d=c.Ou,e=c.CL;m[e].undoRemoveItems(d,a,b)},xL:function(a){return x(a||this.Ou)},ad:function(a){var b=this;b.Ou=j,b.CL="",b.DL=j,b.HL=j,b.AL=[],b.BL=[],b.qia=j,b.kj=a,r(a)},FL:function(a){var b,c,d,e,f=this,h=f.kj;if(h&&!f.JL){if(a){if(f.IL=!0,!isNaN(a.length)&&(h.setRowCountCore(a.length),b=h.ITa,g(f.HL)&&0===b.VTa(!1,3)&&(f.HL=w(f.Ou),h.setColumnCount(f.getColumnCount()),c=f.rL())))for(d=0,e=c.length;d<e;d++)b.do("setItem",!1,3,d,{name:c[d]});f.IL=!1}h.$p()}},GL:function(){var a,b=this,c=b.kj,d=b.Ou;c&&d&&d.currentPosition&&(a=d.currentPosition(),c.Jl!==a&&(c.Sr(a,c.Kl,k,k,2),c.$p()))},tUa:function(a,b){if(!(this.kj&&this.kj.ITa&&!g(this.kj.ITa.WTa)&&this.kj.ITa.WTa<=0)){var c=a.rUa;c||(c=a.rUa=[]),b.bindingManager=this,c.push(b)}},sUa:function(a){var b=this,c=a.type,d=a.row;"bind"===c?b.bind(a.oldDataSource):"setValue"===c?b.setValue(d,a.col,a.oldValue):"addItems"===c?b.wL(d,a.rowCount):"removeItems"===c&&b.uUa(d,a.removedItems)},toJSON:function(){var a,b=this.Ou;return b?(a=this.CL,b=a===n?b.getSource():m[a].toJSON(b),{type:a,source:b}):j},fromJSON:function(a){var b,c,d=a&&a.source;d&&(b=a.type,c=b===n?new p(d):m[b].fromJSON(d),c&&this.bind(c))}},i.qL=q;function r(a){var b=a&&a.wq;b&&b.xL()&&a.Wq(h.ResetBinding,{sheet:a})}function s(a,b){var c=a&&a.wq;return!(!c||!c.xL(b))&&(a.clearPendingChanges(),a.Wq(h.InitBinding,{sheet:a,data:b}),!0)}function t(a,b,c){var d,e,f,g,h,i,k,l,o,p=a,q=p.Ou,r={value:j,hasBinding:!1};if(!q)return r;if(d=p.kj,e=p.CL,e===n){if(h=d?d.getBindingPath(b,c):j)return{value:q.getValue(h),hasBinding:!0}}else{if(b<0||a.getRowCount()<=b)return r;if(i=d?d.getColumnCount():a.getColumnCount(),c<0||i<=c)return r;if(d?(p.qia||(p.qia=d.ITa.Hp(!1,3)),f=p.qia[c],f&&(g=f.name)):a.HL&&(g=a.HL[c]),e)return k=m[e],l=f&&f.value,o=y(l)?l:j,k.getValue(q,o,g,b,c)}return r}function u(a,b,c,d){var e,f,g,h,i,k,l,o,p,q=a,r=q.Ou,s=!1;if(!r)return s;if(e=q.kj,f=q.CL,f===n)i=e?e.getBindingPath(b,c):j,i&&(r.setValue(i,d),s=!0);else{if(b<0||a.getRowCount()<=b)return s;if(k=e?e.getColumnCount():a.getColumnCount(),c<0||k<=c)return s;e?(q.qia||(q.qia=e.ITa.Hp(!1,3)),g=q.qia[c],g&&(h=g.name)):a.HL&&(h=a.HL[c]),f&&(l=m[f],o=g&&g.value,p=y(o)?o:j,s=l.setValue(r,p,h,b,c,d))}return s}function v(a){var b=j;return a&&(x(a)?b=n:e.each(m,function(c,d){if(d.isDataSource(a))return b=c,!1})),b}function w(a,b){return a&&b&&b!==n?m[b].getProperties(a):j}function x(a){return p&&a instanceof p}function y(a){return a instanceof Function}function z(a,b,c){var d,e,f,h;if(a&&b)for(d=b.split("."),e=d.length,f=0;f<e&&(h=d[f],a);f++)f===e-1?y(a[h])?a[h](c):a[h]=c:y(a[h])?(g(a[h]())&&a[h]({}),a=a[h]()):(g(a[h])&&(a[h]={}),a=a[h])}i.KL=z;function A(a,b,c){var d,e,f,h;if(!a||!b)return j;d=null,c?(d=c[b],d||(d=b.split("."),c[b]=d)):d=b.split("."),e=d.length,f=0;do if(h=d[f],a=y(a[h])?a[h]():a[h],g(a))return j;while(++f<e);return a}i.LL=A;function B(){this.pathCache={}}B.prototype={isDataSource:function(a){return e.isArray(a)},getDataLength:function(a){return a.length},getDataItem:function(a,b){return a[b]},addItems:function(a,b,c,d){var e,f;for(e=0;e<c;e++)f={},d&&(f=d.createEntity?d.createEntity():new d),a.splice(b,0,f)},removeItems:function(a,b,c){var d=this.getDataLength(a);if(b<d)return a.splice(b,Math.min(c,d-b))},undoRemoveItems:function(a,b,c){for(var d=0,e=c.length;d<e;d++)a.splice(b+d,0,c[d])},getProperties:function(a){var b,c,d=a.length,e=j;if(d>0){e=[],b=a[0];for(c in b)y(b[c])||e.push(c)}return e},getValue:function(a,b,c,d,e){var h=j,i=!1,k=this.getDataItem(a,d);return g(k)||(b?(h=b(k),i=!0):c?(h=A(k,c,this.pathCache),i=!0):(typeof k===l||f(k))&&0===e&&(h=k,i=!0)),{value:h,hasBinding:i}},setValue:function(a,b,c,d,e,h){var i=!1,j=this.getDataItem(a,d);return g(j)||(b?(b(j,h),i=!0):c?(z(j,c,h),i=!0):(typeof j===l||f(j))&&0===e&&(a[d]=h,i=!0)),i},fromJSON:function(a){return a},toJSON:function(a){return a}},m.defaultBindingSource=new B,a.exports=i}()},function(a,b){a.exports=GC.Spread.Sheets},function(a,b,c){!function(){"use strict";var b=c(2),d=c(3),e=b.j.Fa,f=null;function g(){}g.prototype={isDataSource:function(a){var b=window.wijmo;return b&&b.data&&b.data.isDataView&&b.data.isDataView(a)},getDataLength:function(a){return a.count()},getDataItem:function(a,b){return a.item(b)},addItems:function(a,b,c,d){if(d)for(var e=0;e<c;e++)a.mka=!0,a.add(d.createEntity?d.createEntity():new d),a.mka=!1,a.commitEdit()},removeItems:function(a,b,c){var d,e,f,g,h=this.getDataLength(a);if(b<h){for(d=[],e=Math.min(c,h-b),f=0;f<e;f++)g=a.item(b),a.remove(g),d.push(g);return d}},undoRemoveItems:function(a,b,c){var d,e,f=a.getSource();for(d=0,e=c.length;d<e;d++)f.splice(b+d,0,c[d]);a.refresh()},getProperties:function(a){var b,c=0,d=f,e=a.getProperties();if(e&&e.length>0)for(c=e.length,d=[],b=0;b<c;b++)d.push(e[b].name);return d},canInsert:function(){return!1},getValue:function(a,b,c,d,g){var h=f,i=!1,j=this.getDataItem(a,d);return e(j)||(b?(h=b(j),i=!0):c&&(h=a.getProperty(j,c),i=!0)),{value:h,hasBinding:i}},setValue:function(a,b,c,d,f,g){var h=!1,i=this.getDataItem(a,d);return e(i)||(b?(b(i,g),h=!0):c&&(a.setProperty(i,c,g),h=!0)),h},fromJSON:function(a){return a},toJSON:function(a){return a.local}},d.yL.dataViewBinding=new g,a.exports=d}()},function(a,b,c){!function(){"use strict";var b,d=c(4),e=c(2),f=c(3),g=e.j.Fa,h=d.GC$,i=h.isFunction,j=h.getType,k=h.isNumeric,l=null,m="string",n=window.ko;function o(){}o.prototype={isDataSource:function(a){return n&&n.isObservable(a)},getDataLength:function(a){return a().length},getDataItem:function(a,b){return a()[b]},addItems:function(a,b,c,d){var e,f;for(e=0;e<c;e++)f={},d&&(f=d.createEntity?d.createEntity():new d),a.splice(b,0,f)},removeItems:function(a,b,c){var d=this.getDataLength(a);if(b<d)return a.splice(b,Math.min(c,d-b))},undoRemoveItems:function(a,b,c){for(var d=0,e=c.length;d<e;d++)a.splice(b+d,0,c[d])},getProperties:function(a){var b,c,d=a(),e=d.length,f=[];if(e>0){b=d[0];for(c in b)i(b[c])?n&&n.isObservable(b[c])&&f.push(c):f.push(c)}return f},getValue:function(a,b,c,d,e){var h=l,i=!1,n=this.getDataItem(a,d);return g(n)||(b?(h=b(n),i=!0):c?(h=f.LL(n,c),i=!0):(j(n)===m||k(n))&&0===e&&(h=n,i=!0)),{value:h,hasBinding:i}},setValue:function(a,b,c,d,e,h){var i=!1,l=this.getDataItem(a,d);return g(l)||(b?(b(l,h),i=!0):c?(f.KL(l,c,h),i=!0):(j(l)===m||k(l))&&0===e&&(a()[d]=h,i=!0)),i},fromJSON:function(a){return n?n.observableArray(a):l},toJSON:function(a){return a()}},f.yL.koBinding=new o,n&&(b=n.bindingHandlers,b["gc-spread-sheets"]=b["gcspread-sheets"]=b.wijspread={init:function(a,b,c,e){var f,g,i,j,k,l,n,o,p,q,r,s;if(!h(a).data("workbook")&&(f=b(),g=f&&f.sheets,i=new d.Workbook(h("#"+a.id)[0],f),g)){for(l=g.length,n=i.getSheetCount();n<l;)j=i.vv(i.wv(n)),i.ow(n,0,j),n=i.getSheetCount();for(o=0;o<l;o++)j=i.getSheet(o),k=g[o],p=k.name,q=k.autoGenerateColumns,r=k.data,s=k.columns,typeof p===m&&p.length>0&&j.cq(p),"boolean"==typeof q&&(j.autoGenerateColumns=q),r&&j.setDataSource(r),s&&s.length>0&&(j.autoGenerateColumns=!1,j.bindColumns(s))}},update:function(a,b,c,d){}}),a.exports=f}()},function(a,b){!function(){"use strict";a.exports={Exp_NotSupportedDataSource:"The data source is not supported!"}}()}]);