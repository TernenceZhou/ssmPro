webpackJsonp([15],{Fn4e:function(e,t){},YA3s:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("woOf"),i=a.n(n),s=a("mvHQ"),r=a.n(s),l=a("pFYg"),o=a.n(l),c=a("ABj6"),d=a("TjpK"),u=a("ZHXk"),f=a.n(u),m=a("ECGi"),h=a("j5fz"),g=a("UHag"),p=a("fH//"),v=a("e6WU"),C=a("XNiZ"),I=a("0RKR"),b={name:"mergeReport",components:{balanceSheet:m.default,profitStatement:h.default,statementOfCashFlow:g.default,statementOfChangeInEquityCur:p.default,statementOfChangeInEquityLast:v.default,BdoTable:c.a},props:{customerData:Array},computed:{getRefreshPagesId:function(){return this.$store.state.addBagdeForm}},watch:{getRefreshPagesId:{handler:function(e){e&&(this.tabPaneList.forEach(function(t){t.isMark="string"==typeof e&&e.indexOf(t.indexId)>-1||"object"===(void 0===e?"undefined":o()(e))&&e.refreshIndexes.indexOf(t.indexId)>-1}),"object"===(void 0===e?"undefined":o()(e))&&window.location.hash.indexOf("/MergeForm")>-1&&(this.singlePageRefresh=!0,this.handleUrl()))},immediate:!0,deep:!0}},data:function(){return{currentTabComponent:"balanceSheet",currentDataList:[],currentColmList:[],activeName:"balanceSheet",tabPaneList:[{label:"合并资产负债表",name:"balanceSheet",isMark:!1,indexId:"HB005-ME001"},{label:"合并利润表",name:"profitStatement",isMark:!1,indexId:"HB005-ME002"},{label:"合并现金流量表",name:"statementOfCashFlow",isMark:!1,indexId:"HB005-ME003"},{label:"合并所有者权益变动表（本期）",name:"statementOfChangeInEquityCur",isMark:!1,indexId:"HB005-ME004"},{label:"合并所有者权益变动表（上期）",name:"statementOfChangeInEquityLast",isMark:!1,indexId:"HB005-ME005"}],validColumns:[{prop:"colDisp",label:"校验项",filterOptions:{disabled:!0}},{prop:"auditAmount",label:"本年审定数",filterOptions:{disabled:!0}},{prop:"preAuditAmount",label:"上年审定数",filterOptions:{disabled:!0}}],validData:[],fullscreenLoading:!1,errorText:"校验不平",isErrorText:!1,validFail:!0,statementOfCashFlowData:[],statementOfCashColumns:[],profitStatementData:[],statementOfChangeInEquityCurData:[],statementOfChangeInEquityLastData:[],statementOfChangeInEquityHeadTitle:[],statementOfChangeInEquityHeadTitlePre:[],balanceSheetData:[],isShowBtn:!0,validDataModel:new C.a,menuId:"",eqCount:[],oldTarget:null,eqCheckList:[],validList:[],singlePageRefresh:!1,fullScreen:!1}},methods:{fullScreenChange:function(){this.fullScreen=!this.fullScreen},refreshIndexes:function(e){var t=window.location.hash.split("="),a=[],n=e.split(",");this.tabPaneList.forEach(function(n){n.isMark=e.indexOf(n.indexId)>-1&&n.name!=t[t.length-1]||n.isMark,a.push(n.indexId)}),n=n.filter(function(e){return-1===a.join().indexOf(e)&&e.split("-").length>2});var i={key:JSON.parse(localStorage.getItem("refreshIndexes"))?JSON.parse(localStorage.getItem("refreshIndexes")).key+=1:0,refreshIndexes:n};localStorage.setItem("refreshIndexes",r()(i)),e.indexOf("HB002")>-1&&this.$eventBus.$emit("page-refresh",e),this.mergeFormInit()},handleClick:function(e){var t=this,a=this.tabPaneList.filter(function(t){return t.name==e.name});switch(this.currentTabComponent=a[0].name,e.name){case"balanceSheet":this.menuId="HB005-ME001",this.validData=this.validList;break;case"profitStatement":this.menuId="HB005-ME002",this.validData=this.validList;break;case"statementOfCashFlow":this.menuId="HB005-ME003",this.validData=this.validList;break;case"statementOfChangeInEquityCur":this.menuId="HB005-ME004",this.validData=this.eqCheckList;break;case"statementOfChangeInEquityLast":this.menuId="HB005-ME005",this.validData=this.eqCheckList}if(this.$store.commit("setClosePostill",!1),this.$store.commit("setMergeFormIndex",this.menuId),this.$store.commit("setMergeFormActiveName",e.name),this.$store.commit("setMergeFormActiveTab",e.label),this.$router.push({name:"MergeForm",query:{tab:e.name}}),this.tabPaneList.forEach(function(e){e.isMark&&t.currentTabComponent===e.name&&(e.isMark=!1,t.singlePageRefresh&&t.mergeFormInit())}),this.tabPaneList.every(function(e){return 0==e.isMark})){this.$store.commit("setRemoveBagdeScope","MergeForm"),this.$store.commit("setAddBagdeForm","");var n=JSON.parse(localStorage.getItem("refreshIndexes"));if(n&&n.refreshIndexes&&n.refreshIndexes.length){var i=n.refreshIndexes.split(",");i=i.filter(function(e){return-1===e.indexOf("HB005")});var s={key:n.key+=1,refreshIndexes:i.join()};localStorage.setItem("refreshIndexes",r()(s))}}},initAgain:function(e){1==e&&this.mergeFormInit()},mergeFormInit:function(){var e=this;this.fullscreenLoading=!0,this.validData=[],this.$sacpApis.mergeFormGetData({refreshFlg:1}).then(function(t){if(t.success){for(var a=t.data,n={data:[],success:!0},s={data:[],success:!0},r=0;r<a.length;r++){if(a[r].qy&&(n.data=a[r].qy),a[r].lqy&&(s.data=a[r].lqy),a[r].zc&&(e.balanceSheetData=a[r].zc),a[r].xj&&(e.statementOfCashFlowData=a[r].xj),a[r].lr&&(e.profitStatementData=a[r].lr),a[r].txj&&(e.statementOfCashColumns=a[r].txj),a[r].eqCount&&(e.eqCount=a[r].eqCount,I.a.saveEqCount(e.eqCount)),a[r].checkList)for(var l in e.validList=[],a[r].checkList){var o={};for(var c in i()(o,e.validDataModel,a[r].checkList[l]),o)0===o[c]?o[c]="平":null===o[c]?o[c]=null:"colDisp"!=c&&(o[c]=f.a.commafy(o[c],{digits:2}));e.validList.push(o)}if(a[r].eqCheckList)for(var u in e.eqCheckList=[],a[r].eqCheckList){var m={};for(var h in i()(m,e.validDataModel,a[r].eqCheckList[u]),m)0===m[h]?m[h]="平":null===m[h]?m[h]=null:"colDisp"!=h&&(m[h]=f.a.commafy(m[h],{digits:2}));e.eqCheckList.push(m)}e.validFail=a[r].checkFlag,e.isErrorText=!e.validFail}var g=d.a.convertReportData(n),p=d.a.convertReportData(s);e.statementOfChangeInEquityHeadTitle=g.titleColumn,e.statementOfChangeInEquityCurData=g.G,e.statementOfChangeInEquityHeadTitlePre=p.titleColumn,e.statementOfChangeInEquityLastData=p.LG}else e.$message.error(t.resultInfo.statusText)}).catch(function(t){return e.$message.error(t)}).finally(function(){e.fullscreenLoading=!1,e.singlePageRefresh=!1,e.handleUrl()})},handleUrl:function(){var e="",t=window.location.hash.split("/");if(-1!=(t=t.pop()).indexOf("?")){var a=t.split("?")[1];t=t.split("?")[0],e=a.split("=")[1]}var n={name:e};this.activeName=e,this.handleClick(n)},commafy:function(e){f.a.commafy(e,{digits:2})},removeClickedMenuId:function(e,t){if(e&&"string"==typeof e){var a=e.split(",").filter(function(e){return e!=t}).join();this.$store.commit("setAddBagdeForm",a)}}},activated:function(){var e=window.location.hash.split("=").pop(),t=this.tabPaneList.filter(function(t){return t.name===e})[0];this.tabPaneList.some(function(e){return e.isMark})&&this.mergeFormInit(),t&&t.isMark&&this.removeClickedMenuId(this.getRefreshPagesId,t.indexId)},created:function(){sessionStorage.setItem("projectItem",r()({projectId:JSON.parse(sessionStorage.getItem("curCustomerData")).curProjectId})),this.mergeFormInit()}},x={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"mergeForm"},[n("div",{staticClass:"validErrorInfo"},[n("span",{style:e.validFail?"color:#000":"color:red"},[e._v(e._s(e.validFail?"校验项":e.errorText))]),e._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"刷新校验列表",placement:"top-start"}},[n("i",{staticClass:"el-icon-refresh",staticStyle:{color:"#409eff"},on:{click:function(t){return e.initAgain(!0)}}})]),e._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.isErrorText?"关闭校验项列表":"打开校验项列表",placement:"right"}},[e.isErrorText?n("i",{staticClass:"el-icon-caret-top",on:{click:function(t){e.isErrorText=!1}}}):n("i",{staticClass:"el-icon-caret-bottom",on:{click:function(t){e.isErrorText=!0}}})])],1),e._v(" "),e.isErrorText?n("div",{staticClass:"validTable"},[n("bdo-table",{staticStyle:{width:"100%"},attrs:{columns:e.validColumns,data:e.validData,"max-height":330,"enable-filter":!1,"enable-toolbox":!1,"enable-view-type":!1,showIndexColumn:!1,showCheckBox:!1,enableHeadConfig:!1,headerListConfig:!1,"show-overflow-tooltip":"",setBorder:!0,headerCellStyleSelf:{"text-align":"center"}},scopedSlots:e._u([{key:"col-auditAmount",fn:function(t){return[n("span",{style:{textAlign:"平"===t.row.auditAmount?"center":"right",color:"平"===t.row.auditAmount?"":"red",display:"block"}},[e._v("\n                    "+e._s(t.row.auditAmount))])]}},{key:"col-preAuditAmount",fn:function(t){return[n("span",{style:{textAlign:"平"===t.row.preAuditAmount?"center":"right",color:"平"===t.row.preAuditAmount?"":"red",display:"block"}},[e._v("\n                    "+e._s(t.row.preAuditAmount))])]}}],null,!1,1073739491)})],1):e._e(),e._v(" "),n("div",{class:{fullScreen:e.fullScreen?"fullScreen":"",fullScreenBox:!0}},[n("el-tooltip",{attrs:{effect:"dark",content:e.fullScreen?"取消全屏":"全屏",placement:"top-start"}},[n("el-button",{class:{fullScreenBtn:!0},attrs:{type:"primary",circle:"",size:"small"},on:{click:e.fullScreenChange}},[e.fullScreen?e._e():n("img",{attrs:{src:a("/Dxn"),alt:""}}),e._v(" "),e.fullScreen?n("img",{attrs:{src:a("W+0t"),alt:""}}):e._e()])],1),e._v(" "),n("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(this.tabPaneList,function(t){return n("el-tab-pane",{key:t.index,attrs:{label:t.label,name:t.name}},[n("span",{attrs:{slot:"label",id:"extendEl"},slot:"label"},[t.isMark?n("el-badge",{staticClass:"item",attrs:{"is-dot":""}}):e._e(),e._v("\n                    "+e._s(t.label)+"\n                ")],1)])}),1),e._v(" "),n("keep-alive",[n(e.currentTabComponent,{ref:"tbContent",tag:"component",attrs:{balanceSheetData:e.balanceSheetData,isShowBtn:e.isShowBtn,statementOfChangeInEquityCurData:e.statementOfChangeInEquityCurData,statementOfCashFlowData:e.statementOfCashFlowData,profitStatementData:e.profitStatementData,statementOfCashColumns:e.statementOfCashColumns,statementOfChangeInEquityHeadTitle:e.statementOfChangeInEquityHeadTitle,statementOfChangeInEquityLastData:e.statementOfChangeInEquityLastData},on:{isInit:e.initAgain,refreshIndexes:e.refreshIndexes}})],1)],1)])},staticRenderFns:[]};var k=a("VU/8")(b,x,!1,function(e){a("Fn4e")},null,null);t.default=k.exports}});