webpackJsonp([10],{H41h:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=t("mvHQ"),i=t.n(n),s=t("fZjL"),r=t.n(s),c=t("Gu7T"),l=t.n(c),o=t("Dd8w"),u=t.n(o),h=t("+6Bu"),d=t.n(h),m=t("ZHXk"),f=t.n(m),p=t("K/T8"),g=t("0RKR"),b=t("7+uW"),y=t("vn6w"),v=t.n(y);b.a.component("vue-draggable-resizable",v.a);var I={name:"merchantList",computed:{relateSampling:function(){return this.$store.state.relateSampling}},watch:{relateSampling:{handler:function(e){e&&this.handleRelateSampling()},immediate:!0}},data:function(){var e=this;return this.components={header:{cell:function(a,t,n){var i=t.key,s=d()(t,["key"]),r=e.columns.find(function(e){return(e.dataIndex||e.key)===i});if(!r||!r.width)return a("th",u()({},s),[].concat(l()(n)));var c={key:r.dataIndex||r.key,class:"table-draggable-handle",attrs:{w:10,x:r.width,z:1,axis:"x",draggable:!0,resizable:!1},on:{dragging:function(e,a){r.width=Math.max(e,1)}}},o=a("vue-draggable-resizable",u()({},c));return a("th",u()({},s,{class:"resize-table-th"}),[].concat(l()(n),[o]))}}},{columns:[{title:"操作",dataIndex:"autoMatch",width:80,scopedSlots:{customRender:"autoMatch"},fixed:"left"},{title:"客商编号",dataIndex:"merchantId",ellipsis:!0,width:150},{title:"客商名称",dataIndex:"merchantName",ellipsis:!0,width:220},{title:"含抽凭数据",dataIndex:"isSampling",width:100,scopedSlots:{customRender:"isSampling"}},{title:"科目编号",dataIndex:"subjectId",ellipsis:!0,width:140,scopedSlots:{customRender:"subjectId"}},{title:"期初余额",dataIndex:"remain",align:"right",width:170,customRender:p.b.commafy},{title:"借方发生额",dataIndex:"debitOcc",align:"right",width:170,customRender:p.b.commafy},{title:"贷方发生额",dataIndex:"creditOcc",align:"right",width:170,customRender:p.b.commafy},{title:"期末余额",dataIndex:"balance",align:"right",width:170,customRender:p.b.commafy}],dataCollection:[],spinning:!1,isSamplingList:[{label:"全部",key:0,value:""},{label:"是",key:1,value:"1"},{label:"否",key:2,value:"0"}],searchForm:{merchantName:null,isSampling:null,checkedKeys:""},searchDialogVisible:!1,labelCol:{span:7},wrapperCol:{span:14},queryParams:{sqlId:"DG40003",start:0,limit:10},balanceDialogVisible:!1,balanceColumns:[{title:"科目编号",dataIndex:"subjectId",ellipsis:!0},{title:"科目名称",dataIndex:"subjectName",ellipsis:!0},{title:"期初余额",dataIndex:"remain",align:"right",customRender:p.b.commafy},{title:"借方发生额",dataIndex:"debitOcc",align:"right",customRender:p.b.commafy},{title:"贷方发生额",dataIndex:"creditOcc",align:"right",customRender:p.b.commafy},{title:"期末余额",dataIndex:"balance",align:"right",customRender:p.b.commafy}],balanceDataCollection:[],pagination:{current:1,pageSize:10,showSizeChanger:!0,pageSizeOptions:["10","20","30","40","50"],onShowSizeChange:function(a,t){e.queryParams.start=a-1,e.queryParams.limit=t,e.queryParams.isChange=!0,e.pagination.pageSize=t,e.queryMerchantListData()},showQuickJumper:!1,size:"small",total:0,showTotal:function(){return"共"+e.pagination.total+"条"},change:!0,onChange:function(a,t){e.queryParams.start=(a-1)*t,e.queryParams.limit=e.pagination.pageSize,e.queryParams.isChange=!1,e.pagination.current=a,e.queryMerchantListData()}},addDataDialogVisible:!1,subjectTree:g.a.findMerchantRangeTree(),footerTotalData:[],checked:!1}},methods:{openSearchDialog:function(){this.searchDialogVisible=!0},handleClickRow:function(e,a){var t=this;if((e||e.merchantName)&&e.merchantId){var n={param1:e.merchantType,param2:e.merchantId};this.spinning=!0,this.$sacpApis.queryMerchantBalance(n).then(function(e){e.success?(e.data&&e.data.length&&e.data.forEach(function(e,a){f.a.set(e,"key",a)}),t.balanceDataCollection=e.data,t.balanceDialogVisible=!0):t.$message.error(e.resultInfo.statusText)}).catch(function(e){return t.$message.error(e)}).finally(function(){return t.spinning=!1})}},onSubmitSeachItem:function(){this.queryParams.start=0,this.queryParams.limit=10,this.queryParams.isChange=!0,f.a.set(this.queryParams,"param3",this.searchForm.merchantName),f.a.set(this.queryParams,"param4",this.searchForm.isSampling),f.a.set(this.queryParams,"param7",this.searchForm.checkedKeys),this.queryMerchantListData()},cancelSearch:function(){var e=this;this.searchDialogVisible=!1,r()(this.searchForm).forEach(function(a){return e.searchForm[a]=null})},handleRelateSampling:function(){var e=this;this.spinning=!0,this.$sacpApis.relateSampling().then(function(a){a.success?(e.$message.success("关联抽凭成功!"),e.queryMerchantListData()):e.$message.error(a.resultInfo.statusText)}).catch(function(a){e.$message.error(a)}).finally(function(){e.spinning=!1})},queryMerchantListData:function(){var e=this;this.spinning=!0,this.queryParams.lockCustomerId=g.a.findUserInfo().curCustomerId,this.queryParams.lockProjectId=g.a.findUserInfo().curProjectId,this.queryParams.lockYyyy=g.a.findUserInfo().curAccYear,this.queryParams.param10=this.checked?"":1,this.$sacpApis.findMerchantList(this.queryParams).then(function(a){a.success?(a.data&&a.data.length&&a.data.forEach(function(e,a){f.a.set(e,"key",a)}),e.dataCollection=a.data,e.pagination.total=a.totalCount,e.queryMerchantListTotalData(),e.queryParams.isChange&&(e.pagination.current=1)):e.$message.error(a.resultInfo.statusText)}).catch(function(a){e.$message.error(a)}).finally(function(){e.searchDialogVisible&&e.cancelSearch(),e.spinning=!1,e.isChange=!1})},uploadGetMatchtList:function(){var e=this;this.spinning=!0,this.prohibitRowActive=!1,this.$sacpApis.updateMerchantList().then(function(a){a.success?e.queryMerchantListData():e.$message.error(a.resultInfo.statusText)}).catch(function(a){e.$message.error(a)}).finally(function(){e.searchDialogVisible&&e.cancelSearch(),e.spinning=!1})},deleteMatch:function(e){var a=this,t={param3:e.autoId};this.$sacpApis.deleteMerchantById(t).then(function(e){e.success?(a.$message.success("删除成功!"),a.queryMerchantListData()):a.$message.error(e.resultInfo.statusText)}).catch(function(e){return a.$message.error(e)}).finally(function(){a.spinning=!1})},fillterFUN:function(e,a){return a.data.props.title.includes(e)},queryMerchantListTotalData:function(){var e=this;this.spinning=!0;var a=g.a.findUserInfo(),t=a.curCustomerId,n=a.curProjectId,s=a.curAccYear,r=JSON.parse(i()(this.queryParams));r.lockCustomerId=t,r.lockYyyy=s,r.lockProjectId=n,r.sqlId="DG40056",r.refreshFlg=1,r.limit=1,delete r.start,this.$sacpApis.findMerchantList(r).then(function(a){if(a.success)if(a.data&&a.data.length){var t=a.data[0],n=t.balance,i=t.creditOcc,s=t.debitOcc,r=t.remain;e.footerTotalData=[{id:1,balance:n,creditOcc:i,debitOcc:s,remain:r,autoMatch:"合计",merchantId:"",merchantName:"",isSampling:"",subjectId:""}]}else e.footerTotalData=[{id:1,balance:"",creditOcc:"",debitOcc:"",remain:"",autoMatch:"合计",merchantId:"",merchantName:"",isSampling:"",subjectId:""}];else e.$message.error(a.resultInfo.statusText)}).catch(function(a){e.$message.error(a)}).finally(function(){})},onScroll:function(e){var a=this.$refs.totalTable.$el.querySelectorAll(".ant-table-body"),t=this.$refs.tableList.$el.querySelectorAll(".ant-table-body");a[0].addEventListener("scroll",function(){t[0].scrollLeft=a[0].scrollLeft},!0)},manualRefesh:function(){this.queryMerchantListData()},onChange:function(){this.queryMerchantListData()}},mounted:function(){this.onScroll()},created:function(){this.queryMerchantListData()}},x={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"merchantList"},[t("a-spin",{attrs:{tip:"加载中...",spinning:e.spinning,size:"large"}},[t("div",{staticStyle:{"text-align":"center","margin-bottom":"8px"}},[t("a-icon",{staticStyle:{"margin-right":"8px"},attrs:{type:"tag"}}),e._v("\n            "+e._s("共查询到"+(e.pagination.total||0)+"条数据")+"\n            "),t("span",{staticStyle:{color:"#409eff","margin-left":"10px",cursor:"pointer"},on:{click:e.manualRefesh}},[t("a-icon",{staticStyle:{"margin-right":"5px"},attrs:{type:"sync"}}),e._v("刷新\n            ")],1),e._v(" "),t("a-checkbox",{staticStyle:{"margin-left":"10px"},on:{change:e.onChange},model:{value:e.checked,callback:function(a){e.checked=a},expression:"checked"}},[e._v("显示")])],1),e._v(" "),t("a-table",{ref:"tableList",attrs:{id:"tableList",bordered:"",columns:e.columns,"data-source":e.dataCollection,scroll:{y:"calc(100vh - 360px)",x:"scollXWidth"},pagination:e.pagination,components:e.components},scopedSlots:e._u([{key:"subjectId",fn:function(a,n){return t("span",{attrs:{title:n.subjectId+"-"+n.subjectName}},[e._v(e._s(n.subjectId+"-"+n.subjectName))])}},{key:"autoMatch",fn:function(a,n){return[t("a-popconfirm",{attrs:{title:"确定要删除该条数据吗？","ok-text":"确 定","cancel-text":"取 消"},on:{confirm:function(a){return e.deleteMatch(n)}}},[t("a-button",{staticClass:"del-match-btn",attrs:{type:"primary",shape:"circle",icon:"delete",size:"small",title:"删除"}})],1)]}}])},[e._v(" "),e._v(" "),t("template",{slot:"footer"},[t("a-table",{ref:"totalTable",attrs:{id:"totalTable",bordered:!1,pagination:!1,columns:e.columns,dataSource:e.footerTotalData,showHeader:!1,scroll:{y:"calc(100vh - 360px)",x:"scollXWidth"},"row-key":"id"}})],1)],2)],1),e._v(" "),t("a-modal",{attrs:{title:"查询","ok-text":"确认","cancel-text":"取消"},on:{ok:e.onSubmitSeachItem,cancel:e.cancelSearch},model:{value:e.searchDialogVisible,callback:function(a){e.searchDialogVisible=a},expression:"searchDialogVisible"}},[t("a-form-model",{attrs:{model:e.searchForm,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[t("a-form-model-item",{attrs:{label:"客商名称"}},[t("a-input",{attrs:{placeholder:"请输入"},model:{value:e.searchForm.merchantName,callback:function(a){e.$set(e.searchForm,"merchantName",a)},expression:"searchForm.merchantName"}})],1),e._v(" "),t("a-form-model-item",{attrs:{label:"含抽凭数据"}},[t("a-select",{attrs:{placeholder:"请选择"},model:{value:e.searchForm.isSampling,callback:function(a){e.$set(e.searchForm,"isSampling",a)},expression:"searchForm.isSampling"}},e._l(e.isSamplingList,function(a){return t("a-select-option",{key:a.key,attrs:{value:a.value}},[e._v("\n                        "+e._s(a.label)+"\n                    ")])}),1)],1),e._v(" "),t("a-form-model-item",{attrs:{label:"科目"}},[t("a-tree-select",{key:"key",attrs:{"tree-data":e.subjectTree,placeholder:"请选择科目","allow-clear":"","show-search":"",replaceFields:{value:"subjectFullId"},filterTreeNode:e.fillterFUN},model:{value:e.searchForm.checkedKeys,callback:function(a){e.$set(e.searchForm,"checkedKeys",a)},expression:"searchForm.checkedKeys"}})],1)],1)],1),e._v(" "),t("a-modal",{staticClass:"show-content-dialog",attrs:{title:"客商余额表","ok-text":"确认","cancel-text":"取消",width:"70%"},on:{ok:function(a){e.balanceDialogVisible=!1},cancel:function(a){e.balanceDialogVisible=!1}},model:{value:e.balanceDialogVisible,callback:function(a){e.balanceDialogVisible=a},expression:"balanceDialogVisible"}},[t("a-table",{attrs:{columns:e.balanceColumns,"data-source":e.balanceDataCollection,pagination:!1,bordered:""}})],1)],1)},staticRenderFns:[]};var k=t("VU/8")(I,x,!1,function(e){t("Jhqf")},"data-v-2a9b0e1e",null);a.default=k.exports},Jhqf:function(e,a){}});
//# sourceMappingURL=10.7f811e4d78080a94e651.js.map