/*!
 * 
 * Spread.Sheets Library 12.1.0
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Comments=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){!function(){"use strict";var b=c(1);c(4),c(5),a.exports=b}()},function(a,b,c){!function(){"use strict";var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q=c(2),r=q.Commands,s=q.Worksheet,t=null,u=void 0,v=Math.max,w=Math.min,x=Math.floor,y=Math.atan2,z=Math.abs,A="default",B=q.GC$,C=B.extend,D=q.Ul.Nl,E=c(3),F=E.k,G="comment",H=q.Vl,I=q.En,J=q.Ul,K=q.Events,L=J.nl,M=J.Rl,N=J.Voa,O=parseFloat,P=E.u,Q=q.Bn,R=document,S="mouse",T="move",U=S+"down",V=S+T,W=S+"up",X=S+"wheel",Y="DOMMouseScroll",Z="left",$="top",_="right",aa="bottom",ba="width",ca="height",da="position",ea="absolute",fa="overflow",ga="visible",ha="z-index",ia="hidden",ja="box-sizing",ka="content-box",la="padding",ma="px",na="div",oa=".comment",pa=".floatBlockCanvas",qa=".hostContainer",ra=".lineCanvasContainer",sa=".host",ta=".editor",ua="gc-spread-",va="className",wa="cursor",xa="text",ya=701,za=898,Aa="gc-no-user-select",Ba=" ",Ca="unselectable",Da="on",Ea="comment_editor",Fa="comment_indicator",Ga="font-family",Ha="font-style",Ia="font-size",Ja="font-weight",Ka="color",La="background-"+Ka,Ma=xa+"-align",Na=xa+"-decoration",Oa="textArea",Pa=".lineCanvas",Qa=".commentDocument",Ra="-resize",Sa="line-height";function Ta(a,b){return new q.Point(a,b)}function Ua(a,b,c,d){return new q.Rect(a,b,c,d)}function Va(a){return a.height}function Wa(a){return a.width}function Xa(a,b){var c=a.options;return!c.isProtected||c.protectionOptions.allowEditObjects||b&&!b.locked()}C(s.prototype,{RP:function(a){var b,c,d,e,f,g=this,h=g.nQ();if(!g.fI)for(b=g.am(),d=0;d<=2;d++)for(e=0;e<=2;e++)c=b.Ft(d,e),c&&0!==Wa(c)&&0!==Va(c)&&(a&&!c.intersectRect(a)||(f=g.ITa.Ky,h&&f&&h.fT(f)))}}),b=q.CellRange,b.prototype.comment=function(a){var b=this,c=b.sheet,d=b.row,e=b.col;return 0===arguments.length?c.ITa.Ky.get(d,e):(a instanceof j&&c.ITa.Ky.Cz(d,e,a),b)},d=function(a,b){var c=a.Vs(),d=a.hitTest(b.pageX-c.left,b.pageY-c.top);d&&_a(a,d)},e=function(a,b){var c=b.ITa.Ky;b.bind(K.TopRowChanged+oa,function(){c.cQ()}),b.bind(K.LeftColumnChanged+oa,function(){c.cQ()}),b.bind(K.FloatingElementSelected+oa,function(a,b){"comments"!==b.type&&c.vQ()}),a.bind(U+oa,function(){c.vQ()}).bind(X+oa,function(a){d(b,a)}).bind(V+oa,function(a){d(b,a)})},f=function(a,b){b.unbind(oa),a.unbind(oa)};function Ya(a,b,c,d,e){var f,g,h,i,j,k,l=this,m=l.ITa.Ky;if(a&&m)for(g=m.all(),h=0;h<g.length;h++)f=g[h],i=f.nT,j=f.oT,i===b&&j===c||i>=b&&i<b+d&&j>=c&&j<c+e&&m.remove(i,j);f=m.get(b,c),f&&(k=m.pT(f),k&&k.qT())}function Za(){var a=this,b=a.nQ();b&&b.rT(a)}function $a(a,b,c){var d=this,e=d.nQ();e&&e.sT(a,b,c)}function _a(a,b){var c,d=-1,e=-1;if(b&&b.rowViewportIndex>=0&&b.colViewportIndex>=0&&(d=b.row,e=b.col),a.parent){if(d<0||e<0)return;c=a.ITa.Ky.get(d,e),a.ITa.Ky.tT(c)}}function ab(a,b){return a&&a.getRowHeight(b)}function bb(a,b){return a&&a.getColumnWidth(b)}function cb(a,b){return a&&a.getViewportLeftColumn(b)}function db(a,b){return a&&a.getViewportTopRow(b)}K.CommentChanged="CommentChanged",g={active:1,edit:2,normal:3},h={alwaysShown:1,hoverShown:2},i=function(){function a(a,b,c,d){var e=this;arguments.length<=1?e[$]=e[_]=e[aa]=e[Z]=a||0:(e[$]=a,e[_]=b,e[aa]=c,e[Z]=d)}return a.prototype={constructor:a,clone:function(){var b=this;return new a(b[$],b[_],b[aa],b[Z])},toString:function(){var a=this,b="",c=[$,_,aa,Z];return c.forEach(function(c){b+=a[c]+ma+Ba}),b.trim()}},a}(),j=function(){var a,b,c,d;function e(a){var b=this;b.nT=-1,b.oT=-1,b.text(a||""),b.zIndex(za)}a=[];function f(b,c,d){return a.push(b),q.Ul.Pl(b,c,g(b),d)}function g(a){var b=a;return function(a,c){var d=this,e=d.kj;e&&(e.ITa.UUa({type:"property",comment:d,name:b,value:c}),e.Xq<=0&&e.RP(),e.Wq(K.CommentChanged,{sheet:e,sheetName:e.name(),comment:d,propertyName:b}))}}return b=[[xa,""],["location",Ta(9,-18)],[ba,160,function(a){return a>0}],[ca,100,function(a){return a>0}],["fontFamily","Arial"],["fontStyle","normal"],["fontSize","9pt",function(a){return/^\d+pt$/.test(a)&&parseInt(a)>0}],["fontWeight","normal"],["textDecoration",0],["foreColor","black"],["locked",!0],["lockText",!0],["horizontalAlign",0],["autoSize",!1],["dynamicSize",!0,function(a){return"boolean"==typeof a&&this.dynamicMove()}],["dynamicMove",!0,function(a){return a||this.dynamicSize(!1),!0}],["backColor","#FFFFE1"],["opacity",1,function(a){return a>=0&&a<=1}],["borderWidth",1,function(a){return a>=1}],["borderStyle","solid"],["borderColor","black"],["padding"],["showShadow",!1],["displayMode",2],["commentState",3],["zIndex",-1],["ignoreDefaultLocation",!1]],c={clone:function(){var b=this,c=new e;return a.forEach(function(a){var d=b[a]();b[a].isDefault&&b[a].isDefault(d)||c[a](d&&d.clone?d.clone():d)}),c.kj=b.kj,c.nT=b.nT,c.oT=b.oT,c},toJSON:function(){var b=this,c={rowIndex:b.nT,colIndex:b.oT};return a.forEach(function(a){var d=b[a]();b[a].isDefault&&b[a].isDefault(d)||(c[a]=d&&d.clone?d.clone():d)}),c},fromJSON:function(b){if(b){var c=this;a.forEach(function(a){var d=b[a];d!==u&&("location"===a?c.location(new q.Point(d.x,d.y),!1):"padding"===a?c.padding(new i(d.top,d.right,d.bottom,d.left),!1):c[a](d,!1))}),b.rowIndex!==u&&(c.nT=b.rowIndex),b.colIndex!==u&&(c.oT=b.colIndex)}}},b.forEach(function(a){c[a[0]]=f(a[0],a[1],a[2])}),d=c.zIndex,c.zIndex=function(){var a,b,c=d.apply(this,arguments);return 0===arguments.length&&c===za&&(a=this.kj.comments.wTa,b=this.mi,c=za-(a-1-b)),c},C(e.prototype,c),e}(),k=function(){function a(a,b){var c,d=this,e=a&&a.kj;d.WE=1,d.aS=1,d.kT=a,d.vT(),d._zoomFactor=e.zoom(),d.wT=b,d.BF=b.xT,d.ad(),c=d.yT(d.zT(),a.width(),a.height()),d.AT=Ta(c.x,c.y),d.BT(),d.CT()}q.Zn(a);function b(a,b,c,d,e){var f=Ua(b,c,d,d);f.cursor=e,a.push(f)}function c(a,b,c,d){B(a.DT).css(b,c),B(a.ET).css(b,d)}function d(a,b){var c,d=a.length,e=0;for(c=0;c<d;c++)e+=N(a[c],b);return e}return a.prototype={constructor:a,ad:function(){var b=this,c=b.kT.kj;b.FT=ua+"floatBlockCanvas",b.GT=ua+"host-container",b.HT=ua+"host",b.IT=ua+"lineCanvas",b.JT=D(na),B(b.JT).addClass(ua+"floatBlockCanvas-container").css([da,fa,ja],[ea,ia,ka]),b.DT=D("canvas"),I.Kn(b.DT,null,c),B(b.DT).addClass(b.FT).css([Z,$,da],[0,0,ea]),b.ET=D(na),B(b.ET).addClass(b.GT).css([da,ja,fa],[ea,ka,ia]),b.qo=D(na),B(b.qo).addClass(b.HT+Ba+Aa).css([Z,$,ba,ca,da,"word-wrap","word-break","white-space",fa,ja,Ca,Sa],[0,0,"100%","100%",ea,"break-word","normal","pre-wrap",ia,ka,Da,"normal"]),B(b.ET).append(b.qo),B(b.JT).append(b.DT).append(b.ET),b.KT=D(na),B(b.KT).addClass(ua+"lineCanvas-container").css([da,fa,"pointer-events"],[ea,ia,"none"]),b.LT=D("canvas"),I.Kn(b.LT,t,c),B(b.LT).addClass(b.IT).css([Z,_,da],[0,0,ea]),B(b.KT).append(b.LT),b.MT=[],b.NT=7,b.qS=!1,b.kv=!1,a.ao(b,"init",[b.DT,b.qo])},OT:function(){var a=this,b=a.kT.kj;!a.PT&&b&&(a.PT=b.nQ().PT),a.PT&&(a.PT.appendChild(a.KT),a.QT(),a.PT.appendChild(a.JT),a.RT(a.DT,pa),a.RT(a.ET,qa),a.ST()?a.TT():a.UT(),a.AT=a.zT(),a.VT())},WT:function(){var a=this;a.JT&&a.KT&&a.PT&&(a.XT(a.DT,pa),a.XT(a.ET,qa),a.YT(),a.ZT(),a.$T(),B(a.JT).remove(),B(a.KT).remove())},_T:function(){return this.kT.width()*this._zoomFactor},aU:function(){return this.kT.height()*this._zoomFactor},zT:function(){var a=this,b=a.kT;return b!==a.wT.bU||3!==b.commentState()||b.ignoreDefaultLocation()?a.cU(b.location()):(b._3=a.cU(Ta(9,-18)),b._3)},cU:function(a){var b,c,d=this,e=d.kT,f=e&&e.kj,g=d._zoomFactor,h=Ta(0,0);return f&&(b=d.dU(f,e.nT,e.oT,d.WE,d.aS),b.x!==t&&void 0!==b.x&&b.y!==t&&void 0!==b.y&&Wa(b)&&Va(b)&&(c=f.am(),h.x=b.x+Wa(b)+a.x*g-c.Br,h.y=b.y+a.y*g-c.Cr)),h},dU:function(a,b,c,d,e){var f,g,h,i=this,j=Ua(0,0,0,0),k=a.am(),l=db(a,d),m=cb(a,e),n=i._zoomFactor,o=M(a,m,c,!1),p=M(a,l,b,!0);return b>=l?j.y=p:j.y=-p,c>=m?j.x=o:j.x=-o,f=a.getSpan(b,c),f!==u&&f!==t?(j.height=M(a,b,b+f.rowCount,!0),j.width=M(a,c,c+f.colCount,!1)):(j[ca]=ab(a,b)*n,j[ba]=bb(a,c)*n),j.x+=k.Br,j.y+=k.Cr,g=k.hs,h=k.fs,1===d?j.y+=h:2===d&&(j.y+=h+k.jr),1===e?j.x+=g:2===e&&(j.x+=g+k.er),j},eU:function(a){var b,c,d=this,e=d.kT,f=e&&e.kj,g=d._zoomFactor,h=Ta(0,0);return f&&(b=d.dU(f,e.nT,e.oT,d.WE,d.aS),b.x!==t&&b.x!==u&&b.y!==t&&b.y!==u&&Wa(b)&&Va(b)&&(c=f.am(),h.x=(a.x-(b.x+Wa(b)-c.Br))/g,h.y=(a.y-(b.y-c.Cr))/g)),h},fU:function(){var a=this;a.AT=a.zT(),a.BT(),a.CT(),a.VT()},gU:function(){var a=this;a.AT=a.zT(),a.CT()},hU:function(){var a,b=this,c=b.kT;c.dynamicMove()?c.dynamicSize()?b.iU():(b.jU(),b.CT()):(b.BT(),b.CT(),a=b.eU(b.AT===c._3?b.zT():b.AT),c.location(a))},qT:function(){var a=this;a.AT=a.zT(),a.VT()},jU:function(){var a=this,b=a.kT,c=a.kU();a.AT=c,b.location(a.eU(c),!1),a.VT()},kU:function(){var a,b,c,d,e,f,g,h=this,i=h.kT,j=i&&i.kj,k=h._zoomFactor,l=cb(j,h.aS),m=db(j,h.WE),n=0;for(a=0;a<h.aS;a++)n+=j.getViewportWidth(a);for(b=M(j,l,h.lU,!1),l<h.lU?n+=b:n-=b,c=bb(j,h.lU),c<h.mU&&(h.mU=c),n+=h.mU*k,d=0,e=0;e<h.aS;e++)d+=j.getViewportHeight(e);return f=M(j,m,h.nU,!0),m<h.nU?d+=f:d-=f,g=ab(j,h.nU),g<h.oU&&(h.oU=g),d+=h.oU*k,Ta(n,d)},pU:function(){var a,b,c,d,e=this,f=e.kT,g=f&&f.kj,h=M(g,e.lU,e.mT,!1),i=bb(g,e.lU);i<e.mU&&(e.mU=i),a=bb(g,e.mT),a<e.qU&&(e.qU=a),h=h-e.mU+e.qU,b=M(g,e.nU,e.lT,!0),c=ab(g,e.nU),c<e.oU&&(e.oU=c),d=ab(g,e.lT),d<e.rU&&(e.rU=d),b=b-e.oU+e.rU,f.width(h),f.height(b)},iU:function(){var a=this;a.pU(),a.jU()},BT:function(){var a,b,c,d,e,f,g,h,i,j,k,l=this,m=l.kT,n=m&&m.kj,o=l._zoomFactor;if(l.AT){for(a=cb(n,l.aS),b=db(n,l.WE),0===l.aS?c=l.AT.x:1===l.aS?c=l.AT.x-n.getViewportWidth(0):2===l.aS&&(c=l.AT.x-(n.getViewportWidth(0)+n.getViewportWidth(1))),0===l.WE?d=l.AT.y:1===l.WE?d=l.AT.y-n.getViewportHeight(0):2===l.WE&&(d=l.AT.y-(n.getViewportHeight(0)+n.getViewportHeight(1))),e=Ta(c,d),f=0,g=0,h=a;h<n.getColumnCount();h++){if(i=bb(n,h)*o,!(f+i<e.x)){l.lU=h,l.mU=(e.x-f)/o;break}f+=i}for(j=b;j<n.getRowCount();j++){if(k=ab(n,j)*o,!(g+k<e.y)){l.nU=j,l.oU=(e.y-g)/o;break}g+=k}}},CT:function(){var a,b,c,d,e,f,g,h,i,j,k,l=this,m=l.kT,n=m&&m.kj,o=l._zoomFactor;if(l.AT){for(a=cb(n,l.aS),b=db(n,l.WE),0===l.aS?c=l.AT.x+l._T():1===l.aS?c=l.AT.x+l._T()-n.getViewportWidth(0):2===l.aS&&(c=l.AT.x+l._T()-(n.getViewportWidth(0)+n.getViewportWidth(1))),0===l.WE?d=l.AT.y+l.aU():1===l.WE?d=l.AT.y+l.aU()-n.getViewportHeight(0):2===l.WE&&(d=l.AT.y+l.aU()-(n.getViewportHeight(0)+n.getViewportHeight(1))),e=Ta(c,d),f=0,g=0,h=a;h<n.getColumnCount();h++){if(i=bb(n,h)*o,!(f+i<e.x)){l.mT=h,l.qU=(e.x-f)/o;break}f+=i}for(j=b;j<n.getRowCount();j++){if(k=ab(n,j)*o,!(g+k<e.y)){l.lT=j,l.rU=(e.y-g)/o;break}g+=k}}},rI:function(a,b){var c=this,d=c.kT;a<=c.nU?d.dynamicMove()&&(c.nU+=b,c.lT+=b):a>c.nU&&a<=c.lT&&d.dynamicSize()&&(c.lT+=b),c.iU()},tI:function(a,b){var c=this,d=c.kT;a<=c.lU?d.dynamicMove()&&(c.lU+=b,c.mT+=b):a>c.lU&&a<=c.mT&&d.dynamicSize()&&(c.mT+=b),c.iU()},GR:function(a,b){var c=this,d=c.kT,e=a+b-1;a<c.nU?e<c.nU?d.dynamicMove()&&(c.nU-=b,c.lT-=b):e<c.lT&&d.dynamicMove()&&(d.dynamicSize()?c.lT-=b:c.lT-=c.nU-a+1,c.nU=a,c.oU=0):a<=c.lT&&(e<c.lT?d.dynamicSize()&&(c.lT-=b):d.dynamicSize()&&(c.lT=a,c.rU=0)),c.iU()},HR:function(a,b){var c=this,d=c.kT,e=a+b-1;a<c.lU?e<c.lU?d.dynamicMove()&&(c.lU-=b,c.mT-=b):e<c.mT&&d.dynamicMove()&&(d.dynamicSize()?c.mT-=b:c.mT-=c.lU-a+1,c.lU=a,c.mU=0):a<=c.mT&&(e<c.mT?d.dynamicSize()&&(c.mT-=b):d.dynamicSize()&&(c.mT=a,c.qU=0)),c.iU()},VT:function(){var a,b=this,c=b.kT,d=c.kj;b.sU()&&(a=d.zoom(),b._zoomFactor!==a?(b._zoomFactor=a,b.AT=b.kU()):(b._zoomFactor=a,b.AT!==c._3||1!==c.displayMode()&&2!==c.commentState()||(b.AT=b.zT())),b.vT(),b.tU(),b.uU(),b.vU(),b.wU(),J.Ml.chrome&&b.xU())},tU:function(){var a=this,b=a.kT.kj,c=b.parent&&b.parent.options.useTouchLayout;c?a.NT=11:a.NT=7},vT:function(){var a=this,b=a.kT,c=b.kj;a.WE=c.Er(b.nT),a.aS=c.Fr(b.oT)},uU:function(){var a=this,b=a.kT,c=2===b.commentState()?a.BF:a.qo;a.yU(),a.zU(c),a.AU(c),a.BU(c),a.CU()},AU:function(a){var b=this,c=b.kT;a===b.qo&&(a.innerHTML=P.Ob(c.text()))},BU:function(a){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=this,t=s.kT,u=2===t.commentState()||1===t.displayMode()?s.zT():s.AT,x=s._zoomFactor;u&&(b=s.kv?s.yT(u,t.width(),t.height()):s.yT(u),s.DU(b),d=Wa(b)*x,e=Va(b)*x,f=b.x,g=b.y,h=f+d,i=g+e,j=s.NT,k=s.EU(s.WE,s.aS),f<k.x?(c(s,Z,f-k.x,f+j-k.x),d+=f-k.x,f=k.x):(c(s,Z,0,j),h>k.x+Wa(k)&&(d+=k.x+Wa(k)-1-h)),d=w(Wa(k)-1,d),g<k.y?(c(s,$,g-k.y,g+j-k.y),e+=g-k.y,g=k.y):(c(s,$,0,j),i>k.y+Va(k)&&(e+=k.y+Va(k)-1-i)),e=w(Va(k)-1,e),B(s.JT).css({left:f,top:g,width:d,height:e}),l=d,m=e,I.Pn(s.DT,l,m),n=v(0,l-2*(j+t.borderWidth())),o=v(0,m-2*(j+t.borderWidth())),B(s.ET).css({width:n,height:o}),p=n,q=o,r=t.padding(),r&&(p-=Math.ceil(O(r.left)+O(r.right)),q-=Math.ceil(O(r.top)+O(r.bottom))),B(a).css({width:v(0,p),height:v(0,q)}))},DU:function(a){var b,c,d,e,f=this,g=f.kT,h=f.AT;a.x===h.x&&a.y===h.y&&Wa(a)===g.width()&&Va(a)===g.height()||(b=f.eU(Ta(a.x,a.y)),c=Wa(a),d=Va(a),e=g.location(),b.x===e.x&&b.y===e.y||g.location(b,!1),c!==g.width()&&g.width(c,!1),d!==g.height()&&g.height(d,!1),g.dynamicMove()&&(f.AT=Ta(a.x,a.y)))},CU:function(){var a=this,b=a.kT,c=b&&b.kj;Xa(c)?(a.RT(a.DT,pa),a.RT(a.ET,qa),a.QT(),a.UT(),a.TT()):(b.locked()?(a.XT(a.DT,pa),a.FU(a.DT),a.XT(a.ET,qa),a.FU(a.ET),a.DT.style.cursor=A,a.ET.style.cursor=A):(a.RT(a.DT,pa),a.RT(a.ET,qa)),b.lockText()?(a.YT(),a.FU(a.qo),a.$T(),a.FU(a.BF),(b.locked()||1!==b.commentState())&&b.commentState(3),a.qo.style.cursor=b.locked()?A:T):(a.UT(),a.TT()),a.QT())},yU:function(){var a=this,b=a.kT,c=a.wT,d=b&&b.kj;switch(b.commentState()){case 1:c.GU(b),a.ST()&&a.HU(),d.getSelections().length>0&&d.EJ(),H.Zl(d);break;case 2:c.GU(b),a.ST()||a.IU(),d.getSelections().length>0&&d.EJ(),H.Zl(t);break;case 3:b===c.JU()&&(c.vQ(),0===d.getSelections().length&&d.GJ())}},zU:function(a){var b,c,d,e,f;function g(a,b,c){var d,e;return c?(d=E.pc,e=d.ec(a),e.a=b,d.bc(e)):a}b=this,c=b.kT,d=B(a),d.css("font-family",c.fontFamily()).css("font-style",c.fontStyle()).css("font-size",parseInt(c.fontSize())*b._zoomFactor+"pt").css("font-weight",c.fontWeight()),d.css("text-decoration",q.To.So(c.textDecoration())),e={0:"left",1:"center",2:"right",3:"general"},d.css("text-align",e[c.horizontalAlign()]),c.padding()?d.css(la,""+c.padding()):d.css(la,"0px"),d.css("background-color",g(c.backColor(),c.opacity(),a===b.qo)).css("color",c.foreColor()),B(b.ET).css("border-width",c.borderWidth()).css("border-style",c.borderStyle()).css("border-color",c.borderColor()),f=b.wT.KU(c),B(b.KT).css(ha,f),B(b.JT).css(ha,f)},xU:function(){var a,b,c,d=this,e=this.kT.kj,f=B(d.ET);e&&f&&(a=e.Vs(),b=a.left-Math.floor(a.left)>=.5?.5:0,c=a.top-Math.floor(a.top)>=.5?.5:0,f.css(Z,O(f.css(Z))+b),f.css($,O(f.css($))+c))},vU:function(){var a,b,c,d,e,f,g,h,i,j=this,k=j.kT,l=k.kj,m=j.dU(l,k.nT,k.oT,j.WE,j.aS),n=l.am(),o=m.x+Wa(m)-n.Br,p=m.y-n.Cr,q=Ta(o,p),r=B(j.JT).position(),s=B(j.ET).position(),t=B(j.ET);a=r.left+s.left>q.x?Ta(r.left+s.left,r.top+s.top):r.top+s.top+t.height()<q.y?Ta(r.left+s.left+t.width(),r.top+s.top+t.height()):Ta(r.left+s.left+t.width(),r.top+s.top),b=j.NT,c=z(q.x-a.x)+2*b,d=z(q.y-a.y)+2*b,e=w(q.x,a.x)-b,f=w(q.y,a.y)-b,g=e+c,h=f+d,i=j.EU(j.WE,j.aS),e<i.x&&(c-=i.x-e,e=i.x),g>i.x+Wa(i)&&(c-=g-(i.x+Wa(i))),c=w(Wa(i),c),f<i.y&&(d-=i.y-f,f=i.y),h>i.y+Va(i)&&(d-=h-(i.y+Va(i))),d=w(Va(i),d),B(j.KT).css(Z,e).css($,f).css(ba,c).css(ca,d),I.Pn(j.LT,c,d),q.x=q.x-e,q.y=q.y-f,a.x=a.x-e,a.y=a.y-f,j.LU(q,a)},LU:function(a,b){var c,d,e,f=this;f.MU||(f.MU=f.LT.getContext("2d")),c=f.MU,d=f.kT.borderColor(),c.strokeStyle=d,c.clearRect(0,0,I.Nn(f.LT),I.On(f.LT)),c.beginPath(),c.moveTo(a.x,a.y),c.lineTo(b.x,b.y),c.stroke(),c.save(),Q.Dn(c,a.x,a.y),c.fillStyle=d,c.beginPath(),e=y(b.y-a.y,b.x-a.x),c.rotate(e),c.moveTo(0,0),c.lineTo(7,-4),c.lineTo(7,4),c.lineTo(0,0),c.fill(),Q.Dn(c,-a.x,-a.y),c.closePath(),c.restore()},wU:function(){var a,b,c,d,e,f,g,h=this,i=h.kT,j=i.kj;h.NU=h.kT.commentState(),h.OU||(h.OU=h.DT.getContext("2d")),a=h.OU,b=I.Nn(h.DT),c=I.On(h.DT),d=B(h.ET).outerWidth(),e=B(h.ET).outerHeight(),f=h.NT,a.clearRect(0,0,b,c),h.kT.showShadow()&&(h.QU(a,b,c),g=2*(f+2),a.clearRect(f,f,b-g,c-g),h.PU(a,f,d,e)),Xa(j,i)&&h.RU(a,f,b,c,d,e),a.restore()},PU:function(a,b,c,d){a.fillRect(b+2,d+b,c,2),a.fillRect(c+b,b+2,2,d)},QU:function(a,b,c){var d,e,f;switch(this.NU){case 1:for(a.beginPath(),e=0;e<c;e++)for(d=e%2===0?1:3;d<b;)a.moveTo(d,e),a.lineTo(d+1,e+1),d+=4;a.stroke(),a.closePath();break;case 2:for(a.beginPath(),d=0,e=0,f=4;d<b+c;)a.moveTo(d+f,0),a.lineTo(0,e+f),d+=f,e+=f;a.stroke(),a.closePath()}},RU:function(a,c,d,e,f,g){var h=this,i=h.MT;1!==h.NU&&2!==h.NU||(i.splice(0,i.length),b(i,0,0,c,"nw"+Ra),b(i,d-c,0,c,"ne"+Ra),b(i,0,e-c,c,"sw"+Ra),b(i,d-c,e-c,c,"se"+Ra),g>=3*c?(b(i,0,x(e/2-c/2),c,"w"+Ra),b(i,d-c,x(e/2-c/2),c,"e"+Ra)):(i.push(t),i.push(t)),f>=3*c?(b(i,x(d/2-c/2),0,c,"n"+Ra),b(i,x(d/2-c/2),e-c,c,"s"+Ra)):(i.push(t),i.push(t)),a.restore(),a.fillStyle="white",a.strokeStyle="#939393",a.linewidth=1,Q.Dn(a,.5,.5),B.each(i,function(b,c){if(c){var d=c.x,e=c.y,f=Wa(c),g=Va(c);a.beginPath(),a.fillRect(d,e,f-1,g-1),a.strokeRect(d,e,f-1,g-1),a.stroke(),a.closePath()}}),Q.Dn(a,-.5,-.5))},SU:function(){var a,b,c,d=this,e=d.EU(d.WE,d.aS);d.TU?B(d.TU).remove():d.TU=D(na),a=B(d.TU),b=B(d.ET),a.addClass("gc-spread-moveResizeContainer").css([da,Z,$,ba,ca,"border"],[ea,d.AT.x+d.NT-e.x,d.AT.y+d.NT-e.y,b.outerWidth()-2,b.outerHeight()-2,"gray solid thin"]),d.UU?B(d.UU).remove():d.UU=D(na),c=B(d.UU),c.bind("mousemove",function(a){d.BD(a)}).bind(W,function(a){d.CD(a)}).css([da,fa,$,Z,ba,ca,"background",ha],[ea,ia,e.y,e.x,Wa(e),Va(e),"rgba(255,255,255,0.01)",901]),c.append(d.TU),d.PT&&d.PT.appendChild(d.UU)},VU:function(a){var b,c,d,e,f,g,h,i,j,k=this,l=k.NT,m=k._zoomFactor,n=k.wT,o=n.WU;if(o.XU){if(b=k.YU(),c=a.pageX/m-o.x+b.x,d=a.pageY/m-o.y+b.y,0===c&&0===d)return;e=k.EU(k.WE,k.aS),g=B(k.TU),o.ZU<0?(h=o.$U.x+c,i=o.$U.y+d,f=k.cU(Ta(h,i)),g.css([Z,$],[f.x+l-e.x,f.y+l-e.y])):(j=k._U(c,d,o.ZU),f=k.cU(Ta(j.x,j.y)),g.css([Z,$,ba,ca],[f.x+l-e.x,f.y+l-e.y,Wa(j)*m-2*l-2,Va(j)*m-2*l-2]))}},IU:function(){var a,b=this,c=b.kT;b.ST()||(a=b.wT.xT,B(b.qo).remove(),b.YT(),B(a).remove(),B(b.ET).append(a),b.aV(a),b.BU(a),B(a).focus(),a.selectionStart=a.value.length,b.TT(),2!==c.commentState()&&c.commentState(2))},HU:function(){var b,c=this,d=c.kT,e=d.kj;c.ST()&&(b=c.wT.xT,c.$T(),B(b).remove(),B(c.ET).append(c.qo),c.aV(c.qo),c.UT(),a.ao(c,"detachEditor",c.qo),2===d.commentState()&&d.commentState(3),B(b).val()!==d.text()&&e.wu().execute({cmd:"changeComment",sheetName:e.name(),row:d.nT,col:d.oT,oldValue:d.text(),newValue:B(b).val(),propertyName:xa}))},bV:function(a){var b=this,c=b.kT.kj,d=-1;return 0===a||2===a?d=c.getViewportHeight(a):1===a&&(d=M(c,c.getViewportBottomRow(0)+1,db(c,2)+1,!0)),d},cV:function(a){var b=this,c=b.kT.kj,d=-1;return 0===a||2===a?d=c.getViewportWidth(a):1===a&&(d=M(c,c.getViewportRightColumn(0)+1,cb(c,2)+1,!1)),d},EU:function(a,b){var c=this,d=c.kT.kj,e=d.am(),f=e.Ft(a,b);return 0===a&&0===b||0===a&&2===b||2===a&&0===b||2===a&&2===b?f=Ua(0,0,e.hs+e.er+e.js,e.fs+e.jr+e.gs):0===a&&1===b||2===a&&1===b?f=Ua(e.hs,0,e.er,e.fs+e.jr+e.gs):1===a&&0===b||1===a&&2===b?f=Ua(0,e.fs,e.hs+e.er+e.js,e.jr):1===a&&1===b&&(f=Ua(e.hs,e.fs,e.er,e.jr)),f},aV:function(a){var b=this,c=b.kT,d=B(a);a!==b.BF&&a!==b.qo||(a===b.BF?a.value=c.text():a.innerHTML=P.Ob(c.text()),d.css([Ga,Ha,Ia,Ja,Ka,La,Ma,Na],[c.fontFamily(),c.fontStyle(),c.fontSize(),c.fontWeight(),c.foreColor(),c.backColor(),c.horizontalAlign(),c.textDecoration()]),c.padding()?d.css(la,""+c.padding()):d.css(la,"0px"))},sU:function(){return this.JT&&this.JT.parentNode},ST:function(){var a=this;return a.sU()&&a.kT===a.wT.JU()&&B(a.ET).find(Oa).length>0},dV:function(){var a,b=this,c=b.kT.kj,d=t;return b.sU()&&(a=c.am(),d=Ua(b.AT.x+a.zr+a.Br,b.AT.y+a.Ar+a.Cr,b._T(),b.aU())),d},eV:function(){var a,b,c,d,e,f,g,h=this,i=h.kT,j=h._zoomFactor;return h.sU()&&(a=h.dV())?(f=(h.NT+i.borderWidth())*j,g=f,b=a.x+f,c=a.y+g,d=Wa(a)-2*f,e=Va(a)-2*g,Ua(b,c,d,e)):t},fV:function(a){var b,c=this,d=c.kT,e=d.kj,f=a.target,g=c.wT.WU,h=f.style,i=A;g.XU?f[va]!==c.HT&&f[va]!==c.FT&&f[va]!==c.IT&&f[va]!==ua+"floatPanel"||(i=g.ZU>=0?"crosshair":T):f[va]===c.HT?!Xa(e)&&d.lockText()?d.locked()||(i=T):i=xa:f[va]!==c.FT&&f[va]!==c.GT||Xa(e,d)&&(b=c.gV(a),i=b>=0&&b<c.MT.length?c.MT[b].cursor:T),h[wa]=i},hV:function(b){var c,d=this,e=d.kT,f=e&&e.kj;if(f.endEdit()&&(c={e:b,r:t},a.ao(d,"preProcessMouseDownEdit",c),!c.r))return f.Wq(K.FloatingElementSelected,{type:"comments"}),d.wT.GU(e),e.commentState(2),d.CD(b),L(b)},iV:function(b){var c,d,e,f,g,h=this,i=h.kT,j=i&&i.kj,k=h._zoomFactor,l=h.wT,m=l.WU;j.endEdit()&&(c={e:b,r:t},a.ao(h,"preProcessMouseDownDragResize",c),c.r||(j.Wq(K.FloatingElementSelected,{type:"comments"}),m.x=b.pageX/k,m.y=b.pageY/k,m.$U=Ua(i.location().x,i.location().y,i.width(),i.height()),m.ZU=h.gV(b),h.tC(),m.XU=!0,h.fV(b),l.GU(i),i.commentState(1),Xa(j,i)&&(h.eS={},h.eS.jV=db(j,h.WE),h.eS.kV=cb(j,h.aS),h.SU(),m.ZU<0?h.qS=!0:h.kv=!0),d=j.mm,e=j.Vs(),f=Ta(b.pageX-e.left,b.pageY-e.top),g=j.hitTest(f.x,f.y),d.rG={KG:g.rowViewportIndex,MG:g.colViewportIndex,sG:g.hitTestType},d.$F=f,d.qG(),d.lV=!0,b.stopPropagation()))},yT:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this,o=n.kT,p=o&&o.kj,q=n.NT,r=n._zoomFactor,s=n.aS,t=n.WE,u=n.EU(t,s),v=void 0!==b?b*r:n._T(),w=void 0!==c?c*r:n.aU(),x=a.x,y=a.y,A=p.am(),B=n.dU(p,0,0,t,s),C=a.x+(0-(B.x-A.Br))+v-q,D=a.y+(0-(B.y-A.Cr))+w-q,E=0,F=0,G=0,H=0;return 0===s?(E=0-q,G=Wa(A)-A.Br):1===s?(d=M(p,p.getViewportRightColumn(0)+1,cb(p,1),!1),E=u.x-q-d,e=n.cV(2),G=e):2===s&&(E=0-q,G=0),x<E&&(n.kv?v-=E-x:C+=E-x,x=E),1!==s&&2!==s||(G+=M(p,0,p.getColumnCount(),!1,C)),C>G&&(n.kv?v-=C-G:n.qS?x-=C-G:(f=n.wT.bU&&!o.ignoreDefaultLocation()?9:o.location().x,g=2*z(f)+bb(p,o.oT)+o.width(),h=x-g,h>E?x=h:x<G?v-=C-G:(h=x-g,i=C-g,i>E?h<E?(v-=E-h,x=E):x=h:(h=x-(C-G),h<E?(v-=E-h,x=E):x=h)))),0===t?(F=0-q,H=Va(A)-A.Cr):1===t?(j=M(p,p.getViewportBottomRow(0)+1,db(p,1),!0),F=u.y-q-j,k=n.bV(2),H=k):(F=0-q,H=0),y<F&&(n.kv?w-=F-y:D+=F-y,y=F),1!==t&&2!==t||(H+=M(p,0,p.getRowCount(),!0,D)),D>H&&(n.kv?w-=D-H:n.qS?y-=D-H:D>H&&(l=D-H,m=y-l,m<F?(w-=F-m,y=F):y=m)),Ua(x,y,v/r,w/r)},YU:function(){var a=this,b=a.kT.kj,c=a.eS,d=c.jV,e=c.kV,f=db(b,a.WE),g=cb(b,a.aS),h=M(b,d,f,!0),i=M(b,e,g,!1),j=e<g?i:-i,k=d<f?h:-h;return Ta(j,k)},mV:function(a){var b,c,d,e,f,g,h,i,j,k,l=this,m=l.kT,n=m&&m.kj,o=l._zoomFactor,p=l.wT,q=p.WU,s=r.ChangeComment;if(q.XU){if(b=l.YU(),c=a.pageX/o-q.x+b.x,d=a.pageY/o-q.y+b.y,0===c&&0===d)return;q.ZU<0?(h=q.$U.x+c,i=q.$U.y+d,e=l.cU(Ta(h,i)),f=l.yT(e),g=l.eU(Ta(f.x,f.y)),g.x===m.location().x&&g.x===m.location().y||n.wu().execute({cmd:"changeComment",sheetName:n.name(),row:m.nT,col:m.oT,oldValue:m.location().clone(),newValue:g,propertyName:"location"})):(m.autoSize(!1),j=l._U(c,d,q.ZU),e=l.cU(Ta(j.x,j.y)),f=l.yT(e,Wa(j),Va(j)),g=l.eU(Ta(f.x,f.y)),k=[],g.x===m.location().x&&g.y===m.location().y||k.push(new s(n,{cmd:"changeComment",sheetName:n.name(),row:m.nT,col:m.oT,oldValue:m.location().clone(),newValue:g,propertyName:"location"})),Wa(f)!==m.width()&&k.push(new s(n,{cmd:"changeComment",sheetName:n.name(),row:m.nT,col:m.oT,oldValue:m.width(),newValue:f.width,propertyName:ba})),Va(f)!==m.height()&&k.push(new s(n,{cmd:"changeComment",sheetName:n.name(),row:m.nT,col:m.oT,oldValue:m.height(),newValue:f.height,propertyName:ca})),k.length>0&&n.wu().execute({cmd:"changeCommentTransaction",sheetName:n.name(),commands:k}))}},BD:function(b){var c,d,e,f,g,h=this,i=h.kT.kj,j={e:b,r:t};if(a.ao(h,"preProcessMouseMove",j),!(j.r||(this.fV(b),i.getSelections()&&i.getSelections().length>0)))return c=h.wT,d=b.target,e=i.mm,f=i.Vs(),g=Ta(b.pageX-f.left,b.pageY-f.top),d&&c.WU.XU&&(h.TU&&h.VU(b),1===h.WE&&(e.$F.y=g.y),1===h.aS&&(e.$F.x=g.x),e.NG()),L(b)},CD:function(b){var c,d,e,f=this,g=f.kT.kj,h={e:b,r:t};if(a.ao(f,"preProcessMouseUp",h),!(h.r||g.getSelections()&&g.getSelections().length>0))return c=b.target,d=f.wT,e=g.mm,e.lV=!1,e.RG(),c&&(f.mV(b),f.UU&&(B(f.UU).remove(),f.UU=null,f.qS=!1,f.kv=!1),f.uC(),d.WU.XU=!1,f.fV(b)),L(b)},gV:function(a){var b,c,d,e,f,g=this,h=g.MT;if(h.length>0&&(1===g.NU||2===g.NU))for(b=g.DT,c=a.pageX-B(b).offset().left,d=a.pageY-B(b).offset().top,e=0;e<h.length;e++)if(f=h[e],f&&f.contains(c,d))return e;return-1},_U:function(a,b,c){var d,e,f=this,g=-1,h=-1;switch(c){case 0:g=0,h=0;break;case 1:g=2,h=0;break;case 2:g=0,h=2;break;case 3:g=2,h=2;break;case 4:g=0,h=1;break;case 5:g=2,h=1;break;case 6:g=1,h=0;break;case 7:g=1,h=2}return d=f.nV(a,g),e=f.oV(b,h),Ua(d.x,e.y,d.w,e.h)},nV:function(a,b){var c,d,e=this,f=2*e.NT,g=e.wT.WU,h=Wa(g.$U)-f;return 0===b?h-=a:2===b&&(h+=a),c=g.$U.x,h>=0?0===b&&(c+=a):0===b?c+=Wa(g.$U)-f:2===b&&(c+=h),d=Wa(g.$U),1!==b&&(d=z(h)+f),{x:c,w:d}},oV:function(a,b){var c,d,e=this,f=2*e.NT,g=e.wT.WU,h=Va(g.$U)-f;return 0===b?h-=a:2===b&&(h+=a),c=g.$U.y,h>=0?0===b&&(c+=a):0===b?c=Va(g.$U)-f:2===b&&(c+=h),d=Va(g.$U),1!==b&&(d=z(h)+f),{y:c,h:d}},FU:function(a){var b,c,d=this,e=d.kT.kj;if(a){switch(b=u,a){case d.DT:b=pa;break;case d.ET:b=qa;break;case d.KT:b=ra;break;case d.qo:b=sa;break;case d.BF:b=ta}b&&(B(a).unbind(X+b).unbind(Y+b),c=function(a){e.RF(a),L(a)},B(a).bind(X+b,c).bind(Y+b,c))}},RT:function(a,b){var c,d=this,e=d.kT,f=e&&e.kj;d.XT(a,b),c=function(a){f&&f.RF(a)},B(a).bind(U+b,function(a){d.iV(a)}).bind(V+b,function(a){d.BD(a)}).bind(W+b,function(a){d.CD(a)}).bind(X+b,c).bind(Y+b,c)},XT:function(a,b){B(a).unbind(b)},QT:function(){var a,b,c=this,d=c.kT,e=d&&d.kj,f=c.wT;c.ZT(),e&&(a=e.Vs(),b=function(a){e.RF(a)},B(c.LT).bind(U+Pa,function(b){var d,g,h=e.ITa.Ky.hitTest(b.pageX-a.left,b.pageY-a.top);h?(d=h.comment,g=f.pT(d),h.area===Ea?g.hV(b):h.area===Fa&&g.iV(b),B(g.JT).css(ha,parseInt(B(c.KT).css(ha)+1))):e.OF(b)}).bind(V+Pa,function(b){var d,g,h,i=e.ITa.Ky.hitTest(b.pageX-a.left,b.pageY-a.top),j=c.LT.style;i?(d=i.comment,g=f.pT(d),g.BD(b),i.area===Ea?j.cursor=xa:i.area===Fa&&(j.cursor=T)):(e.PF(b),c.wT.tT(t),h=e.Ws(),h&&(j.cursor=h.style.cursor))}).bind(W+Pa,function(b){var c,d,g=e.ITa.Ky.hitTest(b.pageX-a.left,b.pageY-a.top);g?(c=g.comment,d=f.pT(c),d.CD(b)):e.QF(b)}).bind("dblclick"+Pa,function(a){e.TF(a)}).bind(X+Pa,b).bind(Y+Pa,b))},ZT:function(){var a=this;B(a.LT).unbind(Pa)},UT:function(){var a,b=this,c=b.kT,d=c&&c.kj;2!==c.commentState()&&b.qo&&(b.YT(),a=function(a){d&&d.RF(a)},B(b.qo).bind(U+sa,function(a){b.hV(a)}).bind(V+sa,function(a){b.BD(a)}).bind(W+sa,function(a){b.CD(a)}).bind(X+sa,a).bind(Y+sa,a))},YT:function(){var a=this,b=a.kT;2!==b.commentState()&&a.qo&&B(a.qo).unbind(sa)},TT:function(){var a,b=this,c=b.kT,d=c&&c.kj,e=b.BF;2===c.commentState()&&e&&(this.$T(),a=function(a){d&&(d.RF(a),J.nl(a))},B(e).bind(U+ta,function(a){a.stopPropagation()}).bind(V+ta,function(a){a.stopPropagation()}).bind(W+ta,function(a){a.stopPropagation()}).bind(X+ta,a).bind(Y+ta,a).bind("input"+ta,function(){c.autoSize()&&b.pV()}).bind("keydown"+ta,function(a){27!==a.keyCode&&9!==a.keyCode||(c.commentState(1),L(a),H.Zl(d))}).bind("focusout"+ta,function(){B(e).val()!==c.text()&&d.wu().execute({cmd:"changeComment",sheetName:d.name(),row:c.nT,col:c.oT,oldValue:c.text(),newValue:B(e).val(),propertyName:xa})}))},pV:function(){var a,b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=r.kT,t=s&&s.kj;if(2===s.commentState()?(a=r.BF,b=a.value.split("\n")):(a=r.qo,b=P.Pb(a.innerHTML).split("\n")),c=B(a).height(),e=B(a).width(),h=0,i=a.style,j="",i.font?(h=d(b,j),j+=i.font):(s.fontStyle()&&(j+=Ba+s.fontStyle()),s.fontWeight()&&(j+=Ba+s.fontWeight()),s.fontSize()&&(j+=Ba+s.fontSize()),s.fontFamily()&&(j+=Ba+s.fontFamily()),h=d(b,j)),k=h,l=5,b&&b.length>0){for(f=k,m=0,n=0;n<b.length;n++)o=t.rt(b[n],j),m<o&&(m=o);g=v(m,l)}else f=k,g=l;B(a).css(ca,f).css(ba,g),2===s.commentState()&&s.text(a.value),r.qV=!0,p=f-c,0!==p&&s.height(s.height()+p),q=g-e,0!==q&&s.width(s.width()+q),r.qV=!1},$T:function(){var a=this,b=a.BF;b&&B(b).unbind(ta)},tC:function(){var a=this,b=a.wT.WU;b.XU||(B(R).bind(V+Qa,function(b){a.BD(b)}).bind(W+Qa,function(b){a.CD(b)}),b.XU=!0)},uC:function(){var a=this.wT.WU;a.XU&&(a.XU=!1,B(R).unbind(Qa))}},a}(),l=function(){function a(a){var b=this;b.kj=a,b.WU={XU:!1,x:0,y:0,$U:t,ZU:-1},b.xT=t,b.bU=t,b.rV=t,b.sV=[],b.wTa=0,b.jT=[],b.tV(),b.uV(),b.xn={}}return a.prototype={constructor:a,dispose:function(){var a=this,b=a.all();b.forEach(function(b){a.hT(b)}),a.Uka()},add:function(a,b,c){var d,e,f=this,g=f.kj,h=g.getSpan(a,b);return!h||h.row===a&&h.col===b?(d=f.get(a,b),e="string"==typeof c?new j(c):c,f.Cz(a,b,e),g.Bq("comment",a,b,3,d,e),e):t},Cz:function(a,b,c){var d=this,e=d.kj,f=d.sV;d.vV(a,b),c&&(e.ITa.UUa({type:"add",row:a,col:b}),c.nT=a,c.oT=b,c.kj=e,f.push(c),c.mi=d.wTa,d.wTa++,d.JUa(a,b,c),e.$p())},get:function(a,b){return this.xn[a+"_"+b]||t},JUa:function(a,b,c){this.xn[a+"_"+b]=c},VUa:function(a,b,c){var d=a.nT,e=a.oT;this.get(d,e)===a&&this.JUa(d,e,u),this.kj.ITa.UUa({type:"rowcol",comment:a,row:d,col:e}),a.nT=b,a.oT=c,this.JUa(b,c,a)},remove:function(a,b){var c=this,d=c.vV(a,b),e=c.kj;d&&(e.Bq(G,a,b,3,d,u),e.$p())},vV:function(a,b){var c=this,d=c.kj,e=c.get(a,b);return e&&(d.ITa.UUa({type:"remove",row:a,col:b,comment:e}),c.hT(e),F.Fb(c.sV,e),F.Fb(c.jT,c.pT(e)),c.JUa(a,b,u)),e},clear:function(a){var b,c,d,e,f=this,g=f.kj,h=f.sV;for(g.suspendPaint(),b=h.length-1;b>=0;b--)c=h[b],d=c.nT,e=c.oT,(!a||d>=a.row&&d<a.row+a.rowCount&&e>=a.col&&e<a.col+a.colCount)&&f.remove(d,e);g.resumePaint()},all:function(){return this.sV.concat()},qUa:function(a,b,c,d,e,f){(a||d)&&(a&&this.VUa(a,e,f),d&&this.VUa(d,b,c))},getOuterContainer:function(a){var b=this.pT(a);return b?b.JT:t},tV:function(){var a=D(Oa);B(a).addClass("gc-comment-editor").css(Z,0).css($,0).css(da,ea).css("margin",0).css(la,0).css("word-wrap","break-word").css("word-break","normal").css(fa,ia).css("resize","none").css("outline","none").css("border","0px").css(ja,ka).css(Sa,"normal").attr("autocomplete","off").attr("gcUIElement","gcEditingInput"),this.xT=a},uV:function(){var a=this,b=a.kj;b&&(b.Fu(K.ColumnChanged+oa,function(b,c){var d=c.propertyName;d!==ba&&"isVisible"!==d||a.wV()}),b.Fu(K.RowChanged+oa,function(b,c){var d=c.propertyName;d!==ca&&"isVisible"!==d||a.wV()}),b.Fu(K.ColumnWidthChanged+oa,function(){a.wV()}),b.Fu(K.RowHeightChanged+oa,function(){a.wV()}),b.Fu(K.CommentChanged+oa,function(b,c){var d,e,f,g;c&&(d=c.propertyName,e=c.comment,f=a.pT(e),f&&(g=["autoSize","text","fontFamily","fontStyle","fontSize","fontWeight","padding"],"location"===d?f.fU():d===ba||d===ca?f.gU():g.indexOf(d)>=0&&e.autoSize()&&!f.qV&&f.pV()))}))},Uka:function(){var a=this,b=a.kj;b&&b.Gu(oa)},pT:function(a){var b,c,d=this,e=d.jT;if(a)for(b=0;b<e.length;b++)if(c=e[b],c.kT===a)return c;return t},iT:function(){return 0===this.sV.length},xV:function(){var a,b,c,d=this,e=d.sV;if(e.length>0){for(a=e[0].zIndex(),b=1;b<e.length;b++)c=e[b],a<c.zIndex()&&(a=c.zIndex());return a}return 0},rI:function(a,b){var c,d,e,f,g=this,h=g.sV,i=g.jT;for(c=0;c<h.length;c++)d=h[c],a<=d.nT&&g.VUa(d,d.nT+b,d.oT);for(e=0;e<i.length;e++)f=i[e],f.sU()&&f.rI(a,b)},tI:function(a,b){var c,d,e,f,g=this,h=g.sV,i=g.jT;for(c=0;c<h.length;c++)d=h[c],a<=d.oT&&g.VUa(d,d.nT,d.oT+b);for(e=0;e<i.length;e++)f=i[e],f.sU()&&f.tI(a,b)},GR:function(a,b){var c,d,e,f,g,h=this,i=h.sV,j=h.jT;for(c=i.length-1;c>=0;c--)d=i[c],e=d.nT,f=d.oT,e>=a&&e<a+b&&h.remove(e,f);for(c=0;c<i.length;c++)d=i[c],a<d.nT&&h.VUa(d,d.nT-b,d.oT);for(c=0;c<j.length;c++)g=j[c],g.sU()&&g.GR(a,b)},HR:function(a,b){var c,d,e,f,g,h=this,i=h.sV,j=h.jT;for(c=i.length-1;c>=0;c--)d=i[c],e=d.nT,f=d.oT,f>=a&&f<a+b&&h.remove(e,f);for(c=0;c<i.length;c++)d=i[c],a<d.oT&&h.VUa(d,d.nT,d.oT-b);for(c=0;c<j.length;c++)g=j[c],g.sU()&&g.HR(a,b)},JU:function(){return this.rV},GU:function(a){var b=this;a&&a!==b.rV&&(b.vQ(),b.rV=a)},vQ:function(){var a,b=this,c=b.rV;c&&(a=b.pT(c),!a||a.qS||a.kv||(a.ST()&&a.HU(),c.commentState(3),b.rV=t))},Ao:function(a){var b=this,c=b.pT(a),d=!1;c||(d=!0,c=new k(a,b),b.jT.push(c)),c.OT(),d&&a.autoSize()&&!c.qV&&c.pV()},tT:function(a){var b=this,c=b.rV;if(c)if(1===c.displayMode()){if(2===c.commentState())return}else if(2===c.commentState()||1===c.commentState())return;a!==b.bU&&(b.bU&&b.hT(b.bU),a&&2===a.displayMode()?b.WU.XU||a.yV||(b.bU=a,
a.yV=setTimeout(function(){b.Ao(a)},200)):b.bU=t)},hT:function(a){var b=this,c=b.pT(a);c&&c.sU()&&(c.WT(),a===b.rV&&b.kj.GJ()),clearTimeout(a.yV),delete a.yV},zV:function(){B(this.kj.nQ().PT).show()},AV:function(){B(this.kj.nQ().PT).hide()},BV:function(a,b,c){var d,e=this.pT(a);return!(!e||!(d=e.dV()))&&d.contains(b,c)},CV:function(a,b,c){var d,e=this.pT(a);return!(!e||!(d=e.eV()))&&d.contains(b,c)},hitTest:function(a,b){var c,d,e=this,f=t;for(c=0;c<e.sV.length;c++)d=e.sV[c],Xa(e.kj,d)&&e.BV(d,a,b)&&(f?d.zIndex()>f.zIndex()&&(f=d):f=d);return f?{x:a,y:b,comment:f,area:e.CV(f,a,b)?Ea:Fa}:t},KU:function(a){var b=this,c=b.xV();return a===b.bU?c+2:a===b.rV?c+1:a.zIndex()},wV:function(){this.jT.forEach(function(a){a.hU()})},cQ:function(){this.jT.forEach(function(a){a.qT()})},fromJSON:function(a,b){var c,d,e,f=this;if(a&&0!==a.length)for(f.wTa=0,c=0;c<a.length;c++)d=a[c],e=new j,e.fromJSON(d,b),3!==e.commentState()&&(f.rV=e),f.kj.ITa.Ky.Cz(e.nT,e.oT,e)},toJSON:function(){var a,b,c=this.sV;if(!c||0===c.length)return u;for(a=[],b=0;b<c.length;b++)a.push(c[b].toJSON());return 0===a.length?u:a}},a}(),m=function(){function a(a){var b=this;b.kj=t,b.oQ=!0,b.PT=b.DV(),a.appendChild(b.PT)}return a.prototype={constructor:a,DV:function(){var a=D(na);return B(a).addClass("gc-comment-layoutPanel"+Ba+Aa).css([da,Z,$,ca,ba,fa,ha,Ca],[ea,0,0,0,0,ga,ya,Da]),a},rT:function(a){var b,c,d,e=this;a.ITa.Ky.iT()||(b=a.am(),B(e.PT).css(Z,b.x+b.Br).css($,b.y+b.Cr),e.kj!==a&&(e.kj&&(c=e.kj.ITa,d=c.Ky.JU(),d&&2===d.commentState()&&d.commentState(1)),e.kj=a))},sT:function(a,b,c){var d,e,f=c.row,g=c.col,h=c.x,i=c.y,j=Wa(c),k=Va(c),l=this;3===b&&l.kj&&(d=l.kj.ITa.Ky.get(f,g),d&&(e=6,a&&j>0&&k>0&&(a.save(),a.rect(h,i,j,k),a.clip(),a.fillStyle="red",a.beginPath(),a.moveTo(h+j-e,i),a.lineTo(h+j,i),a.lineTo(h+j,i+e),a.lineTo(h+j-e,i),a.fill(),a.restore())))},fT:function(a){var b,c,d,e,f,g,h;if(!this.oQ)return void a.AV();for(a.zV(),b=this.kj,c=a.all(),d=0;d<c.length;d++)e=c[d],f=a.pT(e),this.EV(a,e)?(1===e.displayMode()&&e===a.bU&&(a.bU=t),f&&f.sU()?f.VT():a.Ao(e)):f&&f.sU()&&a.hT(e);g=a.JU(),g&&(h=a.pT(g),h&&h.sU()&&b.getSelections().length>0&&b.ITa.do("clearSelection"))},EV:function(a,b){var c=a.kj;if(c&&bb(c,b.oT)&&ab(c,b.nT))switch(b.displayMode()){case 1:return!0;case 2:if(3!==b.commentState())return a&&b!==a.bU&&(a.bU=b),!0;if(b===a.bU)return!0}return!1}},a}(),n=q.lUa,B.extend(n.prototype,{UUa:function(a){var b,c=this.zTa;c&&(b=c.WUa,b||(b=c.WUa=[]),b.push(a))},XUa:function(a){var b,c,d,e,f,g,h;if(a)for(b=this,c=b.Ky,d=a.length-1;d>=0;d--)e=a[d],f=e.comment,"add"===e.type?c.vV(e.row,e.col):"remove"===e.type?c.Cz(e.row,e.col,e.comment):"property"===e.type?(g=e.name,h=e.value,f[g](h)):"rowcol"===e.type&&c.VUa(f,e.row,e.col)}}),n.$n("comments",{init:function(){this.Ky=new l(this.kj)},undo:function(a){var b=a.WUa;b&&this.XUa(b)}}),o={init:function(){var a=this;a.comments=a.ITa.Ky,a.nQ=function(){var b=a.parent;if(b)return b.gT||(b.gT=new m(b.xv())),b.gT.kj=a,a.parent.gT}},dispose:function(){var a=this.ITa.Ky;a&&a.dispose(),f(this,B(this.Ws()))},setHost:function(a){a&&e(a,this)},onLayoutChanged:function(a){var b=this,c=b.ITa.Ky,d=a.changeType,e=a.row,f=a.rowCount,g=a.col,h=a.colCount;"addRows"===d?c.rI(e,f):"deletingRows"===d?c.GR(e,f):"addColumns"===d?c.tI(g,h):"deletingColumns"===d?c.HR(g,h):3===a.sheetArea&&("clear"===d?4===(4&a.type)&&c.clear(new q.Range(e,g,f,h)):"addSpan"===d?Ya.call(b,!0,e,g,f,h):"removeSpan"===d&&Ya.call(b,!1,e,g))},paint:function(a){this.ITa.Ky.iT()||(Za.call(this),this.RP(a.clipRect))},paintCell:function(a){a.isPrinting||3!==a.sheetArea||$a.call(this,a.ctx,a.sheetArea,a.cell)},toJson:function(a,b){var c=b&&b.ignoreStyle;c||(a.comments=this.ITa.Ky.toJSON())},fromJson:function(a,b,c){var d,e=c&&c.ignoreStyle;e||a&&(d=b?a.commentManager:a.comments,d&&this.ITa.Ky.fromJSON(d,b))},lastNonNullRowAndCol:function(){var a,b,c,d,e=0,f=0,g=this.ITa.Ky;if(g&&(a=g.jT,a&&a.length>0))for(b=0,c=a.length;b<c;b++)d=a[b],d&&d.kT&&(d.lT>e&&(e=d.lT),d.mT>f&&(f=d.mT));return{lastNonNullRow:e,lastNonNullCol:f}},clearSelection:function(){this.ITa.Ky.vQ()},processKeyDown:function(a){var b=this,c=b.ITa.Ky.JU();c&&b.mm.LH(a.e)&&(c.commentState(2),a.r=!0)}},s.$n("comments",o),p={init:function(){r.uT(this.commandManager())}},q.Workbook.$n("comments",p),a.exports={CommentState:g,DisplayMode:h,Padding:i,Comment:j,GV:k}}()},function(a,b){a.exports=GC.Spread.Sheets},function(a,b){a.exports=GC.Spread.Common},function(a,b,c){!function(){"use strict";var b,d,e,f,g,h=c(2),i=h.Commands,j=h.GC$,k=h.Events,l=c(3).j.Fa,m=c(1),n=i.ActionBase,o="deleteComment",p="deleteCommentByKey",q="deactivateComment",r="moveCommentUp",s="moveCommentDown",t="moveCommentLeft",u="moveCommentRight",v="changeComment",w="changeCommentTransaction",x=null,y=i.h4;function z(a,b,c){var d,e=!1,f=a.ITa.Ky.JU();return f?(d=f.location(),a.wu().execute({cmd:v,sheetName:a.name(),row:f.nT,col:f.oT,oldValue:d.clone(),newValue:new h.Point(d.x+b,d.y+c),propertyName:"location"})):e}function A(a){var b=a.comment;b&&(l(a.row)||l(a.col))&&(a.row=b.nT,a.col=b.oT)}b=function(a){j.inherit(b,a);function b(b,c){a.call(this),A(c),this.kj=b,this.VQ=c}var c={execute:function(){var a,b,c,d,e,f,g=this;return!!g.canExecute()&&(a=g.kj,g.Lz(a,!0),b=a.comments.get(g.VQ.row,g.VQ.col),c=a.ITa,d=c.Ky,e={sheet:a,sheetName:a.name(),comment:b,cancel:!1},a.Wq(k.CommentRemoving,e),e.cancel||(c.startTransaction(),d.remove(b.nT,b.oT),d.rV=x,a.GJ(),a.Wq(k.CommentRemoved,{sheet:a,sheetName:a.name(),comment:b}),f=i.bWa(a.name()),g.VQ[f]=c.endTransaction()),g.Mz(a,!0),!0)},undo:function(){var a,b=this,c=b.kj;return b.Lz(c,!0),a=i.bWa(c.name()),c.ITa.undo(b.VQ[a]),c.EJ(),b.Mz(c,!0),!0}};return j.extend(b.prototype,c),b}(n),d=function(a){j.inherit(b,a);function b(b,c){a.call(this),A(c),this.kj=b,this.VQ=c}var c={execute:function(){var a,b=this,c=b.VQ,d=b.kj,e=d.comments.get(c.row,c.col);return!(!b.canExecute()||!e)&&(b.Lz(d,!0),a=c.propertyName,e[a](c.newValue),"location"===a&&(c.displayMode?e.displayMode(c.displayMode):c.displayMode=e.displayMode()),b.Mz(d,!0),!0)},undo:function(){var a,b=this,c=b.VQ,d=b.kj;return b.Lz(d,!0),a=d.comments.get(c.row,c.col),!!a&&(a[c.propertyName](c.oldValue),b.Mz(d,!0),!0)}};return j.extend(b.prototype,c),b}(n),i.ChangeComment=d;function B(a,b){var c,d,e;if((b?a.canUndo():a.canExecute())&&(c=a.KV)){for(d=0;d<c.length;d++)e=c[d],e&&(b?e.undo():e.execute());return!0}return!1}e=function(a){j.inherit(b,a);function b(b,c){var d,e,f=this;if(a.call(f),f.KV=[],f.kj=b,f.VQ=c,d=c.commands)for(e=0;e<d.length;e++)f.add(d[e])}var c={execute:function(){return B(this,!1)},undo:function(){return B(this,!0)},add:function(a){this.KV.push(a)}};return j.extend(b.prototype,c),b}(n),i[p]={canUndo:!1,execute:function(a,b){var c=i.bT(a,b),d=c.ITa.Ky.JU();return!!d&&c.wu().execute({cmd:o,sheetName:c.name(),row:d.nT,col:d.oT})}},i[q]={canUndo:!1,execute:function(a,b){var c=i.bT(a,b),d=c.ITa.Ky;return!!d.JU()&&(d.vQ(),c.GJ(),c.repaint(),!0)}},i[r]={canUndo:!1,execute:function(a,b){var c=i.bT(a,b);return z(c,0,-1)}},i[s]={canUndo:!1,execute:function(a,b){var c=i.bT(a,b);return z(c,0,1)}},i[t]={canUndo:!1,execute:function(a,b){var c=i.bT(a,b);return z(c,-1,0)}},i[u]={canUndo:!1,execute:function(a,b){var c=i.bT(a,b);return z(c,1,0)}},i[o]={canUndo:!0,execute:function(a,c,d){return y(a,b,c,d)}},i[v]={canUndo:!0,execute:function(a,b,c){return y(a,d,b,c)}},i[w]={canUndo:!0,execute:function(a,b,c){return y(a,e,b,c)}},f=function(a){var b=h.Ul.sl();a.register(p,i[p],b?8:46,!1,!1,!1,!1),a.register(q,i[q],27,!1,!1,!1,!1),a.register(r,i[r],38,!1,!1,!1,!1),a.register(s,i[s],40,!1,!1,!1,!1),a.register(t,i[t],37,!1,!1,!1,!1),a.register(u,i[u],39,!1,!1,!1,!1),a.register(o,i[o]),a.register(v,i[v]),a.register(w,i[w])},i.uT=f,g={CommentDeleteUndoAction:b,CommentPropertyUndoAction:d},j.extend(m,g),a.exports=m}()},function(a,b,c){!function(){"use strict";var a=c(6);a&&!function(){var b=c(2),d=b.GC$,e=d.extend,f=b.Ul.nl,g=a.jR,h=a.kR;function i(a,b,c){var d,e,f=this,i=f.kT=b.kT;f.yM=new g(f),f.DQ=new h(a,"Comment"+i.nT+i.oT,f.yM,2,200),f.BQ=c,f.CQ=new j(a,b),d=f.CQ,e=f.DQ,e._M=function(){return 3!==f.kT.commentState()},e.bN=function(){return!0},e.dN=function(a){return d.jQ(a)},e.eN=function(a){return d.lQ(a)},e.fN=function(a){return d.pQ(a)},e.hN=function(a){return d.qQ(a)},e.iN=function(a){return d.sQ(a)}}e(i.prototype,{EQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!0)},FQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!1)},GQ:function(a){return this.yM.GQ(a)},HQ:function(a){return this.yM.HQ(a)},IQ:function(a){return this.yM.IQ(a)}});function j(b,c){var d=this;d.NS=b,d.LV=c,d.kT=c.kT,d.kj=d.kT.kj,d.hQ=new a.TP(d.kj)}e(j.prototype,{OS:function(b){var c,e=new a.oP(b.X,b.Y),f=d(this.NS).offset();return f&&(c=document.body,e.X+=f.left+c.clientLeft||0,e.Y+=f.top+c.clientTop||0),e},jQ:function(a){a.DO=35},lQ:function(a){var b=this,c=b.OS(a.rN);b.LV.iV({target:a.GP,isTouch:!0,button:0,pageX:c.X,pageY:c.Y,stopPropagation:function(){}}),b.hQ.OP()},pQ:function(a){var b,c,e=this,f=a.dP.rO,g=e.kj,h=g.parent;1!==f&&h&&h.options.allowUserZoom?(g.mm.lV=!1,b=e.LV,d(b.TU).remove(),e.hQ.PP(f)):(c=e.OS(a.rN),e.LV.BD({target:a.GP,isTouch:!0,button:0,pageX:c.X,pageY:c.Y,stopPropagation:function(){}}))},qQ:function(a){var b,c=this,d=a.dP.rO,e=c.kj,f=e.parent;1!==d&&f&&f.options.allowuserZoom?c.hQ.SP(d):(b=c.OS(a.rN),c.LV.CD({target:a.GP,isTouch:!0,button:0,pageX:b.X,pageY:b.Y,stopPropagation:function(){}}))},sQ:function(){var a=this,b=a.kT,c=a.kj;try{c.suspendPaint(),3===b.commentState()?b.commentState(1):1===b.commentState()&&b.commentState(2)}finally{c.resumePaint()}}});function k(a,b,c){var d,e,f=this,i=f.kT=b.kT;f.yM=new g(f),f.DQ=new h(a,"Comment"+i.nT+i.oT,f.yM,2,200),f.BQ=c,f.CQ=new l(a,b),d=f.CQ,e=f.DQ,e._M=function(){return 3!==f.kT.commentState()},e.bN=function(){return!0},e.dN=function(a){return d.jQ(a)},e.eN=function(a){return d.lQ(a)},e.fN=function(a){return d.pQ(a)},e.hN=function(a){return d.qQ(a)},e.iN=function(a){return d.sQ(a)}}e(k.prototype,{EQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!0)},FQ:function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!1)},GQ:function(a){return this.yM.GQ(a)},HQ:function(a){return this.yM.HQ(a)},IQ:function(a){return this.yM.IQ(a)}}),d.inherit(l,j);function l(a,b){j.call(this,a,b)}l.prototype.lQ=function(a){var b=this,c=b.OS(a.rN);b.LV.hV({target:a.GP,isTouch:!0,button:0,pageX:c.X,pageY:c.Y,stopPropagation:function(){}}),b.hQ.OP()},c(1).GV.$n("touch",{init:function(a){var b=this,c=b.kT.kj,d=c.parent.BQ;b.wR=new i(a[0],b,d),b.wR.EQ(),b.MV=new k(a[1],b,d),b.MV.EQ()},detachEditor:function(a){var b=this,c=b.kT.kj;b.MV=new k(a,b,c.parent.BQ),b.MV.EQ()},preProcessMouseDownEdit:function(a){var b=a.e,c=this.MV;c&&!b.isTouch&&c.GQ(b)&&(f(b),a.r=!0)},preProcessMouseDownDragResize:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.GQ(b)&&(f(b),a.r=!0)},preProcessMouseMove:function(a){var b=a.e,c=b.isTouch,d=this.wR,e=this.MV;d&&!c&&d.IQ(b)&&(f(b),a.r=!0),e&&!c&&e.IQ(b)&&(f(b),a.r=!0)},preProcessMouseUp:function(a){var b=a.e,c=b.isTouch,d=this.wR,e=this.MV;d&&!c&&d.HQ(b)&&(f(b),a.r=!0),e&&!c&&e.HQ(b)&&(f(b),a.r=!0)}})}()}()},function(a,b){a.exports=GC.Spread.Sheets.Touch}]);