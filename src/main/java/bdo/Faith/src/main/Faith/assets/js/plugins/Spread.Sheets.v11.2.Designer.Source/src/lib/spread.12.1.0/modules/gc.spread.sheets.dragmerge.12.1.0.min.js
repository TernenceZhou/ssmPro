/*!
 * 
 * Spread.Sheets Library 12.1.0
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC=GC||{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.DragMerge=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="/assets/",c(0)}([function(a,b,c){!function(){"use strict";c(1),c(3),c(5)}()},function(a,b,c){!function(){"use strict";var b=c(2),d=b.GC$,e=b.Commands,f=e.ActionBase,g=e.h4,h="dragMerge",i=Math.max;function j(a,b){return a.Tq(b)}d.inherit(k,f);function k(a,b){var c=this;f.call(c),c.VQ=b,c.kj=a}d.extend(k.prototype,{canExecute:function(){var a,b=this.kj,c=this.VQ,d=j(b,c.oldSelection),e=j(b,c.newSelection);if(d.equals(e)){if(a=b.getSpan(d.row,d.col),a&&d.equals(a))return!1;if(1===d.rowCount&&1===d.colCount)return!1}return!0},canUndo:function(){var a=e.bWa(this.kj.name()),b=this.VQ[a];return e.cWa(b)},undo:function(){var a,b,c=this;return!!c.canUndo()&&(a=c.kj,c.Lz(a,!0),b=e.bWa(a.name()),a.ITa.undo(c.VQ[b]),c.Mz(a,!0),void 0)},execute:function(){var a,b,c,d,f,g=this,h=g.kj,j=g.VQ,k=j.oldSelection,l=j.newSelection;return!!g.canExecute()&&(h.ITa.startTransaction(),g.Lz(h,!0),h.ITa.do("clearSpan",k.row,k.col,k.rowCount,k.colCount),a=l.row,b=l.col,c=l.rowCount,d=l.colCount,h.addSpan(a,b,c,d),h.setSelection(a,b,i(c,1),i(d,1)),g.Mz(h,!0),f=e.bWa(h.name()),j[f]=h.ITa.endTransaction(),void 0)}}),e[h]={canUndo:!0,execute:function(a,b,c){return g(a,k,b,c)}},e.dja=function(a){a.register(h,e[h])},a.exports=e}()},function(a,b){a.exports=GC.Spread.Sheets},function(a,b,c){!function(){"use strict";var a,b,d=c(2),e=d.GC$,f=c(1),g="white",h=d.Rm,i=c(4),j=i.pc;function k(a){var b=a.parent;return b&&b.options.backColor||g}e.extend(d.oJ.prototype,{cja:function(a){var b=this,c=b.kj,d=c.mm,e=c.Ix(),f=c.cm(d.gka(e));b.Wja(a,f)},Wja:function(a,b){var c,d,e,f,g,i,j,k,l=this,m=l.kj;a.save(),c=4,d=8,e=c/2,f=d/2,g=b.x,i=b.y,j=b.width,k=b.height,l.Xja=b,a.fillStyle=h.Om(m,m.getSelectionBorderColor()),a.beginPath(),a.rect(g+j-e,i+k/2-f,c,d),a.fill(),a.beginPath(),a.rect(g+j/2-f,i+k-e,d,c),a.fill(),a.restore()},hka:function(a,b){var c,d,e,f,g,i,l,m,n,o,p,q,r=a,s=r.kj,t=s.parent,u=s.mm,v=a.bm(),w=2,x=w/2;t&&t.options.allowUserDragMerge&&u.$ia&&(c=s.getActiveRowIndex(),d=s.getActiveColumnIndex(),e=s.getActualStyle(c,d),f=e&&e.backColor,g=k(s),i=j.ec(h.Om(s,f||g)),i.a*=.6/255,v.fillStyle=j.bc(i),v.strokeStyle=h.Om(s,s.getSelectionBorderColor()),v.lineWidth=2,v.beginPath(),l=t.Vv,m=s.cm(b),n=m.x,o=m.y,p=m.width,q=m.height,l>2007?(v.rect(n,o,p-x,q-x),v.strokeRect(n-1,o-1,p+1,q+1)):(v.rect(n+1,o+1,p-w-.5,q-w-.5),v.strokeRect(n-.5,o-.5,p,q)),v.fill(),v.restore(),r.Wja(v,m))}}),a={init:function(){f.dja(this.commandManager())}},d.Workbook.$n("dragMerge",a),b={paintAdornment:function(a){var b=a.ctx,c=this,d=c.yl,e=c.ITa.getSelections();c.parent&&c.parent.options.allowUserDragMerge&&1===e.length&&!c.CH&&d.cja(b)}},d.Worksheet.$n("dragMerge",b)}()},function(a,b){a.exports=GC.Spread.Common},function(a,b,c){!function(){"use strict";var a=c(2),b=a.GC$,d=null,e=void 0,f=Math.abs,g=a.Events,h=a.kf;function i(a,b){a.Wq(g.DragMerging,b)}function j(a,b){a.Wq(g.DragMerged,b)}b.extend(a.iI.prototype,{gka:function(a){var b=this,c=b.kj,d=a,e=c.ITa.findSpan(a.row,a.col);return e&&e.containsRange(a)&&(d=e),d},Yia:function(a,b,c){var e,g,h,i,j,k=this.kj,l=k.parent,m=k.Ix(),n=k.yl,o=4,p=8,q=o/2,r=p/2;if(l&&l.options.allowUserDragMerge&&m&&!k.CH&&n.Xja){if(e=n.Xja,g=e.x,h=e.y,i=e.width,j=e.height,f(g+i-b)<=q&&f(h+j/2-c)<=r)return{right:!0};if(f(g+i/2-b)<=r&&f(h+j-c)<=q)return{bottom:!0}}return d},Zia:function(a){var b,c,d,e,f,g,h,i,j=this;return j.eG=!0,j.OG=!0,j.$ia=!0,j.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},j.fja=a.dragMergeInfo,b=j.kj,c=b.ITa,d=b.Ix(),j.ika=j.gka(d),e=b.Tq(j.ika),f=e.row,g=e.col,h=e.rowCount,i=e.colCount,c.qu(f,g,h,i)?(j.OG=!1,void(j.$ia=!1)):(j._ja=b.getSpans(e),b.suspendPaint(),c.do("clearSpan",f,g,h,i),b.resumePaint(),j.aka=e,j.bka(),j.jka(e),void j.qG())},_ia:function(){var a,b,c,d,e,f,g,h,i=this,j=i.kj,k=j.parent;return k&&!k.options.allowUserDragMerge?void i.aja():(a=i.fH(),b=i.gH(),c=i.aka||i.ika,d=j.Tq(c),void(a>=0&&b>=0&&(e=i.fja,f=i.qja(d,a,b,e),i.kka=f,g=f.rowCount,h=f.colCount,g>0&&h>0&&(i.bka(),i.jka(f),i.aka=f,i.NG()))))},bka:function(){var a,b=this.kj,c=this.aka;c&&(a=b.cm(c),a.x-=2,a.y-=2,a.width+=4,a.height+=4,b.yl.dm(a))},qja:function(a,b,c,d){var e,f,g,i,j,k,l,m,n=this,o=n.kj,p=a.row,q=a.col,r=a.rowCount,s=a.colCount;return d.right?(e=p,f=q,g=r,i=c-q+1,j=e,k=q+s,l=g,m=c-q-s+1):d.bottom&&(e=p,f=q,g=b-p+1,i=s,j=p+r,k=f,l=b-p-r+1,m=i),o.ITa.MTa(j,k,l,m)&&(e=p,f=q,g=r,i=s),h(e,f,g,i)},aja:function(){var a,b,c,d=this,f=d.kj,g=f.parent,h=d._ja,k=d.ika,l=d.kka||k;d.eG=!1,d.OG=!1,d.$ia=!1,d.kka=e,d._ja=e,d.aka=e,d.ika=e,d.RG(),g&&g.options.allowUserDragMerge&&(a=f.ITa,f.suspendPaint(),h.length>0&&h.forEach(function(b){a.do("addSpan",b)}),f.resumePaint(),b={sheetName:f.name(),sheet:f,mergeRange:l,cancel:!1},i(f,b),b.cancel||(c={cmd:"dragMerge",sheetName:f.name(),oldSelection:k,newSelection:l},f.wu().execute(c),j(f,{sheetName:f.name(),sheet:f,mergeRange:l})))},jka:function(a){var b=this,c=b.kj,d=c.yl,e=d.hka;e(d,a)}})}()}]);