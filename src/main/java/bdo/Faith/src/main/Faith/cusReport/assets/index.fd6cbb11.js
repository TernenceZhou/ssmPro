var DR=Object.defineProperty,PR=Object.defineProperties;var NR=Object.getOwnPropertyDescriptors;var Vb=Object.getOwnPropertySymbols;var LR=Object.prototype.hasOwnProperty,OR=Object.prototype.propertyIsEnumerable;var Wb=(r,e,t)=>e in r?DR(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Qi=(r,e)=>{for(var t in e||(e={}))LR.call(e,t)&&Wb(r,t,e[t]);if(Vb)for(var t of Vb(e))OR.call(e,t)&&Wb(r,t,e[t]);return r},Ji=(r,e)=>PR(r,NR(e));import{_ as jb}from"./itemTitle.c6356fca.js";import{f as Wp}from"./format.6d05965c.js";import{i as Xb}from"./index.9441d5d2.js";import{d as pa,s as xu,u as _u,o as Dr,b as Pr,i as mt,D as yo,h as Qt,q as ah,j as is,r as Gr,v as as,F as os,P as xr,Q as Xr,S as ss,T as jp,_ as Bt,V as wt,W as bt,X as us,Y as oh,Z as Ce,$ as En,G as RR,l as ga,t as ya,x as BR,y as GR,O as Hb,z as Yb,p as FR}from"./vendor.7005e464.js";import{_ as UR}from"./abnormalList.7547092a.js";import{e as zR}from"./eventbus.38817e84.js";var Xp=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",get Base(){return ra},get Circle(){return qU},get Ellipse(){return ZU},get Image(){return JU},get Line(){return tz},get Marker(){return iz},get Path(){return By},get Polygon(){return mz},get Polyline(){return xz},get Rect(){return Ez},get Text(){return Az}}),Hp=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",get Base(){return zi},get Circle(){return Pz},get Dom(){return Lz},get Ellipse(){return Rz},get Image(){return Gz},get Line(){return Uz},get Marker(){return $z},get Path(){return Wz},get Polygon(){return Xz},get Polyline(){return Yz},get Rect(){return Zz},get Text(){return r6}}),Yp=pa({components:{},props:["id","data"],data(){return{height:300,width:200}},watch:{data:{handler(r){r&&this.randerChart(r.data,r.footer,null,r.width,r.height,r.title,r.chartDisp)},immediate:!0}},methods:{randerChart(r,e,t,n,i,a,o){this.tooltip=o,this.width=n,this.height=i,this.$nextTick(()=>{Xb(document.getElementById(this.id+"chart")).setOption({title:{text:a,textStyle:{fontSize:14}},tooltip:{trigger:"axis",formatter(u){var l=`${u[0].name} <br/>`;for(let f of u)f.value&&(l+=`<span style="background: ${f.color}; height:10px; width: 10px; border-radius: 50%;display: inline-block;margin-right:10px;"></span> ${f.seriesName} \uFF1A${f.value}%<br/>`);return l}},legend:{data:t,top:20},grid:{left:"5%",right:"10%",bottom:"10%",containLabel:!0},toolbox:{feature:{saveAsImage:{title:"\u4FDD\u5B58"}}},xAxis:{type:"category",data:e,nameTextStyle:{fontSize:14,lineHeight:20,fontWeight:"bold",verticalAlign:"top",width:50,align:"middle"},name:"",nameLocation:"middle",axisLabel:{interVal:0,rotate:-40}},yAxis:{type:"value",axisLabel:{formatter:"{value} %"}},series:r},!0)})}},created(){},mounted(){},activated(){this.randerChart()}});const $R=yo();xu("data-v-e08d789c");const VR={class:"broken"},WR={class:"main1"};_u();const jR=$R((r,e,t,n,i,a)=>(Dr(),Pr("div",VR,[mt("div",WR,[mt("div",null,[mt("div",{id:r.id+"chart",style:{height:r.height+"px",width:r.width+"px"}},null,12,["id"]),mt("p",{class:"tool",innerHTML:r.tooltip},null,8,["innerHTML"])])])])));Yp.render=jR;Yp.__scopeId="data-v-e08d789c";var qp=pa({emits:["helloEmit"],components:{brokenLine:Yp},props:{showWait:Boolean},mixins:[Wp],setup(r,{attrs:e,slots:t,emit:n}){const{ctx:i,proxy:a}=is(),o=Qt([]),s=Qt([]),u=Qt(""),l=Qt(""),f=Qt("");return{data:o,titleList:s,type1:u,getCusQuotaInfo:(h,d,v,p)=>{u.value=h,l.value=d,f.value=v,a.$faithApi.getCusQuotaInfo({param1:u.value,param2:l.value,param3:f.value.toString(),jsonData:p}).then(g=>{let y=[];g.success&&Array.isArray(g.data)?g.data.map(m=>{let b=[],x=[],_=m.chartName,S=m.chartDisp;m.chartList.map((E,C)=>{let M=[],w=E.chartName;E.chartList.map(T=>{C===0&&x.push(T.label),M.push(T.value)}),b.push({name:w,data:M,type:"line"})}),y.push({data:b,footer:x,title:_,chartDisp:S,width:(window.innerWidth-100)/4,height:300})}):a.$toast.error(g.resultInfo.statusText),o.value=y,r.showWait==!0&&a.$emit("helloEmit")})},selectValue:l,searchCompany:f,simpleImage:ah.PRESENTED_IMAGE_SIMPLE}}});const XR=yo(),HR=XR((r,e)=>{const t=Gr("bdo-a-empty"),n=Gr("brokenLine");return r.data.length==0?(Dr(),Pr(t,{key:0,image:r.simpleImage},null,8,["image"])):(Dr(!0),Pr(os,{key:1},as(r.data,(i,a)=>(Dr(),Pr(n,{class:"item",id:r.type1+"brokenLine"+a,data:i,key:r.type1+""+a},null,8,["id","data"]))),128))});qp.render=HR;qp.__scopeId="data-v-1909dbfa";/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Kp=function(r,e){return Kp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},Kp(r,e)};function $t(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Kp(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var L=function(){return L=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},L.apply(this,arguments)};function ti(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t}function YR(r,e,t,n){var i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,e,t,n);else for(var s=r.length-1;s>=0;s--)(o=r[s])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function qR(r,e){return function(t,n){e(t,n,r)}}function KR(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function ma(r,e,t,n){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function s(f){try{l(n.next(f))}catch(c){o(c)}}function u(f){try{l(n.throw(f))}catch(c){o(c)}}function l(f){f.done?a(f.value):i(f.value).then(s,u)}l((n=n.apply(r,e||[])).next())})}function ba(r,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(f){return u([l,f])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}var Zp=Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]};function ZR(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Zp(e,r,t)}function Qp(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function qb(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return a}function QR(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(qb(arguments[e]));return r}function Jp(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)n[i]=a[o];return n}function xa(r,e){for(var t=0,n=e.length,i=r.length;t<n;t++,i++)r[i]=e[t];return r}function Ll(r){return this instanceof Ll?(this.v=r,this):new Ll(r)}function JR(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,a=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(h){n[h]&&(i[h]=function(d){return new Promise(function(v,p){a.push([h,d,v,p])>1||s(h,d)})})}function s(h,d){try{u(n[h](d))}catch(v){c(a[0][3],v)}}function u(h){h.value instanceof Ll?Promise.resolve(h.value.v).then(l,f):c(a[0][2],h)}function l(h){s("next",h)}function f(h){s("throw",h)}function c(h,d){h(d),a.shift(),a.length&&s(a[0][0],a[0][1])}}function e3(r){var e,t;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,a){e[i]=r[i]?function(o){return(t=!t)?{value:Ll(r[i](o)),done:i==="return"}:a?a(o):o}:a}}function t3(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Qp=="function"?Qp(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(a){t[a]=r[a]&&function(o){return new Promise(function(s,u){o=r[a](o),i(s,u,o.done,o.value)})}}function i(a,o,s,u){Promise.resolve(u).then(function(l){a({value:l,done:s})},o)}}function r3(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}var n3=Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e};function i3(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Zp(e,r,t);return n3(e,r),e}function a3(r){return r&&r.__esModule?r:{default:r}}function o3(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function s3(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}var sh=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",__extends:$t,get __assign(){return L},__rest:ti,__decorate:YR,__param:qR,__metadata:KR,__awaiter:ma,__generator:ba,__createBinding:Zp,__exportStar:ZR,__values:Qp,__read:qb,__spread:QR,__spreadArrays:Jp,__spreadArray:xa,__await:Ll,__asyncGenerator:JR,__asyncDelegator:e3,__asyncValues:t3,__makeTemplateObject:r3,__importStar:i3,__importDefault:a3,__classPrivateFieldGet:o3,__classPrivateFieldSet:s3}),mi=function(r){return r!==null&&typeof r!="function"&&isFinite(r.length)},uh=function(r,e){return mi(r)?r.indexOf(e)>-1:!1},Ol=function(r,e){if(!mi(r))return r;for(var t=[],n=0;n<r.length;n++){var i=r[n];e(i,n)&&t.push(i)}return t},u3=function(r,e){return e===void 0&&(e=[]),Ol(r,function(t){return!uh(e,t)})},l3={}.toString,ea=function(r,e){return l3.call(r)==="[object "+e+"]"},Kr=function(r){return ea(r,"Function")},yt=function(r){return r==null},At=function(r){return Array.isArray?Array.isArray(r):ea(r,"Array")},ri=function(r){var e=typeof r;return r!==null&&e==="object"||e==="function"};function xe(r,e){if(!!r){var t;if(At(r))for(var n=0,i=r.length;n<i&&(t=e(r[n],n),t!==!1);n++);else if(ri(r)){for(var a in r)if(r.hasOwnProperty(a)&&(t=e(r[a],a),t===!1))break}}}var Kb=Object.keys?function(r){return Object.keys(r)}:function(r){var e=[];return xe(r,function(t,n){Kr(r)&&n==="prototype"||e.push(n)}),e};function Zb(r,e){var t=Kb(e),n=t.length;if(yt(r))return!n;for(var i=0;i<n;i+=1){var a=t[i];if(e[a]!==r[a]||!(a in r))return!1}return!0}var lh=function(r){return typeof r=="object"&&r!==null},Un=function(r){if(!lh(r)||!ea(r,"Object"))return!1;if(Object.getPrototypeOf(r)===null)return!0;for(var e=r;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(r)===e};function f3(r,e){if(!At(r))return null;var t;if(Kr(e)&&(t=e),Un(e)&&(t=function(i){return Zb(i,e)}),t){for(var n=0;n<r.length;n+=1)if(t(r[n]))return r[n]}return null}function c3(r,e,t){t===void 0&&(t=0);for(var n=t;n<r.length;n++)if(e(r[n],n))return n;return-1}var h3=function(r,e){for(var t=null,n=0;n<r.length;n++){var i=r[n],a=i[e];if(!yt(a)){At(a)?t=a[0]:t=a;break}}return t},d3=function(r){if(!At(r))return[];for(var e=[],t=0;t<r.length;t++)e=e.concat(r[t]);return e},Qb=function(r,e){if(e===void 0&&(e=[]),!At(r))e.push(r);else for(var t=0;t<r.length;t+=1)Qb(r[t],e);return e},Ri=function(r){if(!!At(r))return r.reduce(function(e,t){return Math.max(e,t)},r[0])},Bi=function(r){if(!!At(r))return r.reduce(function(e,t){return Math.min(e,t)},r[0])},Jb=function(r){var e=r.filter(function(o){return!isNaN(o)});if(!e.length)return{min:0,max:0};if(At(r[0])){for(var t=[],n=0;n<r.length;n++)t=t.concat(r[n]);e=t}var i=Ri(e),a=Bi(e);return{min:a,max:i}},ex=Array.prototype,v3=ex.splice,p3=ex.indexOf,g3=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var n=0;n<e.length;n++)for(var i=e[n],a=-1;(a=p3.call(r,i))>-1;)v3.call(r,a,1);return r},y3=Array.prototype.splice,tx=function(e,t){if(!mi(e))return[];for(var n=e?t.length:0,i=n-1;n--;){var a=void 0,o=t[n];(n===i||o!==a)&&(a=o,y3.call(e,o,1))}return e},rx=function(r,e,t){if(!At(r)&&!Un(r))return r;var n=t;return xe(r,function(i,a){n=e(n,i,a)}),n},m3=function(r,e){var t=[];if(!mi(r))return t;for(var n=-1,i=[],a=r.length;++n<a;){var o=r[n];e(o,n,r)&&(t.push(o),i.push(n))}return tx(r,i),t},Xe=function(r){return ea(r,"String")};function b3(r,e){var t;if(Kr(e))t=function(i,a){return e(i)-e(a)};else{var n=[];Xe(e)?n.push(e):At(e)&&(n=e),t=function(i,a){for(var o=0;o<n.length;o+=1){var s=n[o];if(i[s]>a[s])return 1;if(i[s]<a[s])return-1}return 0}}return r.sort(t),r}function nx(r,e){e===void 0&&(e=new Map);var t=[];if(Array.isArray(r))for(var n=0,i=r.length;n<i;n++){var a=r[n];e.has(a)||(t.push(a),e.set(a,!0))}return t}var x3=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return nx([].concat.apply([],r))},_3=function(r,e){for(var t=[],n={},i=0;i<r.length;i++){var a=r[i],o=a[e];if(!yt(o)){At(o)||(o=[o]);for(var s=0;s<o.length;s++){var u=o[s];n[u]||(t.push(u),n[u]=!0)}}}return t};function _a(r){if(mi(r))return r[0]}function Gi(r){if(mi(r)){var e=r;return e[e.length-1]}}function w3(r,e){return At(r)||Xe(r)?r[0]===e:!1}function S3(r,e){return At(r)||Xe(r)?r[r.length-1]===e:!1}var E3=function(r,e){for(var t=0;t<r.length;t++)if(!e(r[t],t))return!1;return!0},C3=function(r,e){for(var t=0;t<r.length;t++)if(e(r[t],t))return!0;return!1},A3=Object.prototype.hasOwnProperty;function fh(r,e){if(!e||!At(r))return{};for(var t={},n=Kr(e)?e:function(s){return s[e]},i,a=0;a<r.length;a++){var o=r[a];i=n(o),A3.call(t,i)?t[i].push(o):t[i]=[o]}return t}function ix(r,e){if(!e)return{0:r};if(!Kr(e)){var t=At(e)?e:e.replace(/\s+/g,"").split("*");e=function(n){for(var i="_",a=0,o=t.length;a<o;a++)i+=n[t[a]]&&n[t[a]].toString();return i}}return fh(r,e)}var T3=function(r,e){if(!e)return[r];var t=ix(r,e),n=[];for(var i in t)n.push(t[i]);return n};function M3(r,e){return r["_wrap_"+e]}function wu(r,e){if(r["_wrap_"+e])return r["_wrap_"+e];var t=function(n){r[e](n)};return r["_wrap_"+e]=t,t}var ax={};function I3(r){var e=ax[r];if(!e){for(var t=r.toString(16),n=t.length;n<6;n++)t="0"+t;e="#"+t,ax[r]=e}return e}function k3(r){var e=0,t=0,n=0,i=0;return At(r)?r.length===1?e=t=n=i=r[0]:r.length===2?(e=n=r[0],t=i=r[1]):r.length===3?(e=r[0],t=i=r[1],n=r[2]):(e=r[0],t=r[1],n=r[2],i=r[3]):e=t=n=i=r,{r1:e,r2:t,r3:n,r4:i}}var D3=function(r,e,t){return r<e?e:r>t?t:r},ch=function(r,e){var t=e.toString(),n=t.indexOf(".");if(n===-1)return Math.round(r);var i=t.substr(n+1).length;return i>20&&(i=20),parseFloat(r.toFixed(i))},Lt=function(r){return ea(r,"Number")},P3=function(r){return Lt(r)&&r%1!=0},N3=function(r){return Lt(r)&&r%2==0},L3=Number.isInteger?Number.isInteger:function(r){return Lt(r)&&r%1==0},O3=function(r){return Lt(r)&&r<0},R3=1e-5;function ox(r,e,t){return t===void 0&&(t=R3),Math.abs(r-e)<t}var B3=function(r){return Lt(r)&&r%2!=0},G3=function(r){return Lt(r)&&r>0},F3=function(r,e){if(!!At(r)){for(var t,n=-1/0,i=0;i<r.length;i++){var a=r[i],o=Kr(e)?e(a):a[e];o>n&&(t=a,n=o)}return t}},U3=function(r,e){if(!!At(r)){for(var t,n=1/0,i=0;i<r.length;i++){var a=r[i],o=Kr(e)?e(a):a[e];o<n&&(t=a,n=o)}return t}},hh=function(r,e){return(r%e+e)%e},z3=180/Math.PI,$3=function(r){return z3*r},V3=parseInt,W3=Math.PI/180,dh=function(r){return W3*r},sx=function(r,e){return r.hasOwnProperty(e)},eg=Object.values?function(r){return Object.values(r)}:function(r){var e=[];return xe(r,function(t,n){Kr(r)&&n==="prototype"||e.push(t)}),e},j3=function(r,e){return uh(eg(r),e)},Su=function(r){return yt(r)?"":r.toString()},X3=function(r){return Su(r).toLowerCase()},H3=function(r){var e=Su(r);return e.charAt(0).toLowerCase()+e.substring(1)};function Y3(r,e){return!r||!e?r:r.replace(/\\?\{([^{}]+)\}/g,function(t,n){return t.charAt(0)==="\\"?t.slice(1):e[n]===void 0?"":e[n]})}var q3=function(r){return Su(r).toUpperCase()},Eu=function(r){var e=Su(r);return e.charAt(0).toUpperCase()+e.substring(1)},K3={}.toString,ux=function(r){return K3.call(r).replace(/^\[object /,"").replace(/]$/,"")},Z3=function(r){return ea(r,"Arguments")},tg=function(r){return ea(r,"Boolean")},rg=function(r){return ea(r,"Date")},Q3=function(r){return ea(r,"Error")};function J3(r){return Lt(r)&&isFinite(r)}var eB=function(r){return r===null},tB=Object.prototype,lx=function(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||tB;return r===t},rB=function(r){return ea(r,"RegExp")},nB=function(r){return r===void 0},iB=function(r){return r instanceof Element||r instanceof HTMLDocument};function fx(r){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,16)};return e(r)}function cx(r){var e=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout;e(r)}function ng(r,e){for(var t in e)e.hasOwnProperty(t)&&t!=="constructor"&&e[t]!==void 0&&(r[t]=e[t])}function St(r,e,t,n){return e&&ng(r,e),t&&ng(r,t),n&&ng(r,n),r}var aB=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];for(var t=r[0],n=1;n<r.length;n++){var i=r[n];Kr(i)&&(i=i.prototype),St(t.prototype,i)}},Cr=function(r){if(typeof r!="object"||r===null)return r;var e;if(At(r)){e=[];for(var t=0,n=r.length;t<n;t++)typeof r[t]=="object"&&r[t]!=null?e[t]=Cr(r[t]):e[t]=r[t]}else{e={};for(var i in r)typeof r[i]=="object"&&r[i]!=null?e[i]=Cr(r[i]):e[i]=r[i]}return e};function ig(r,e,t){var n;return function(){var i=this,a=arguments,o=function(){n=null,t||r.apply(i,a)},s=t&&!n;clearTimeout(n),n=setTimeout(o,e),s&&r.apply(i,a)}}var hx=function(r,e){if(!Kr(r))throw new TypeError("Expected a function");var t=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=e?e.apply(this,n):n[0],o=t.cache;if(o.has(a))return o.get(a);var s=r.apply(this,n);return o.set(a,s),s};return t.cache=new Map,t},oB=5;function dx(r,e,t,n){t=t||0,n=n||oB;for(var i in e)if(e.hasOwnProperty(i)){var a=e[i];a!==null&&Un(a)?(Un(r[i])||(r[i]={}),t<n?dx(r[i],a,t+1,n):r[i]=e[i]):At(a)?(r[i]=[],r[i]=r[i].concat(a)):a!==void 0&&(r[i]=a)}}var Hr=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var n=0;n<e.length;n+=1)dx(r,e[n]);return r},sB=function(r,e,t,n){Kr(e)||(t=e,e=r,r=function(){});var i=Object.create?function(o,s){return Object.create(o,{constructor:{value:s}})}:function(o,s){function u(){}u.prototype=o;var l=new u;return l.constructor=s,l},a=i(e.prototype,r);return r.prototype=St(a,r.prototype),r.superclass=i(e.prototype,e),St(a,t),St(r,n),r},ag=function(r,e){if(!mi(r))return-1;var t=Array.prototype.indexOf;if(t)return t.call(r,e);for(var n=-1,i=0;i<r.length;i++)if(r[i]===e){n=i;break}return n},uB=Object.prototype.hasOwnProperty;function vx(r){if(yt(r))return!0;if(mi(r))return!r.length;var e=ux(r);if(e==="Map"||e==="Set")return!r.size;if(lx(r))return!Object.keys(r).length;for(var t in r)if(uB.call(r,t))return!1;return!0}var ls=function(r,e){if(r===e)return!0;if(!r||!e||Xe(r)||Xe(e))return!1;if(mi(r)||mi(e)){if(r.length!==e.length)return!1;for(var t=!0,n=0;n<r.length&&(t=ls(r[n],e[n]),!!t);n++);return t}if(lh(r)||lh(e)){var i=Object.keys(r),a=Object.keys(e);if(i.length!==a.length)return!1;for(var t=!0,n=0;n<i.length&&(t=ls(r[i[n]],e[i[n]]),!!t);n++);return t}return!1},lB=function(r,e,t){return Kr(t)?!!t(r,e):ls(r,e)},fs=function(r,e){if(!mi(r))return r;for(var t=[],n=0;n<r.length;n++){var i=r[n];t.push(e(i,n))}return t},fB=function(r){return r},cB=function(r,e){e===void 0&&(e=fB);var t={};return ri(r)&&!yt(r)&&Object.keys(r).forEach(function(n){t[n]=e(r[n],n)}),t},$a=function(r,e,t){for(var n=0,i=Xe(e)?e.split("."):e;r&&n<i.length;)r=r[i[n++]];return r===void 0||n<i.length?t:r},hB=function(r,e,t){var n=r,i=Xe(e)?e.split("."):e;return i.forEach(function(a,o){o<i.length-1?(ri(n[a])||(n[a]=Lt(i[o+1])?[]:{}),n=n[a]):n[a]=t}),r},dB=Object.prototype.hasOwnProperty,vB=function(r,e){if(r===null||!Un(r))return{};var t={};return xe(e,function(n){dB.call(r,n)&&(t[n]=r[n])}),t},pB=function(r,e){return rx(r,function(t,n,i){return e.includes(i)||(t[i]=n),t},{})},og=function(r,e,t){var n,i,a,o,s=0;t||(t={});var u=function(){s=t.leading===!1?0:Date.now(),n=null,o=r.apply(i,a),n||(i=a=null)},l=function(){var f=Date.now();!s&&t.leading===!1&&(s=f);var c=e-(f-s);return i=this,a=arguments,c<=0||c>e?(n&&(clearTimeout(n),n=null),s=f,o=r.apply(i,a),n||(i=a=null)):!n&&t.trailing!==!1&&(n=setTimeout(u,c)),o};return l.cancel=function(){clearTimeout(n),s=0,n=i=a=null},l},px=function(r){return mi(r)?Array.prototype.slice.call(r):[]},vh={},wa=function(r){return r=r||"g",vh[r]?vh[r]+=1:vh[r]=1,r+vh[r]},Rl=function(){},gB=function(r){return r};function ph(r){return yt(r)?0:mi(r)?r.length:Object.keys(r).length}var gh,Bl=hx(function(r,e){e===void 0&&(e={});var t=e.fontSize,n=e.fontFamily,i=e.fontWeight,a=e.fontStyle,o=e.fontVariant;return gh||(gh=document.createElement("canvas").getContext("2d")),gh.font=[a,o,i,t+"px",n].join(" "),gh.measureText(Xe(r)?r:"").width},function(r,e){return e===void 0&&(e={}),Jp([r],eg(e)).join("")}),yB=function(r,e,t,n){n===void 0&&(n="...");var i=16,a=Bl(n,t),o=Xe(r)?r:Su(r),s=e,u=[],l,f;if(Bl(r,t)<=e)return r;for(;l=o.substr(0,i),f=Bl(l,t),!(f+a>s&&f>s);)if(u.push(l),s-=f,o=o.substr(i),!o)return u.join("");for(;l=o.substr(0,1),f=Bl(l,t),!(f+a>s);)if(u.push(l),s-=f,o=o.substr(1),!o)return u.join("");return""+u.join("")+n},mB=function(){function r(){this.map={}}return r.prototype.has=function(e){return this.map[e]!==void 0},r.prototype.get=function(e,t){var n=this.map[e];return n===void 0?t:n},r.prototype.set=function(e,t){this.map[e]=t},r.prototype.clear=function(){this.map={}},r.prototype.delete=function(e){delete this.map[e]},r.prototype.size=function(){return Object.keys(this.map).length},r}(),sg=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",contains:uh,includes:uh,difference:u3,find:f3,findIndex:c3,firstValue:h3,flatten:d3,flattenDeep:Qb,getRange:Jb,pull:g3,pullAt:tx,reduce:rx,remove:m3,sortBy:b3,union:x3,uniq:nx,valuesOfKey:_3,head:_a,last:Gi,startsWith:w3,endsWith:S3,filter:Ol,every:E3,some:C3,group:T3,groupBy:fh,groupToMap:ix,getWrapBehavior:M3,wrapBehavior:wu,number2color:I3,parseRadius:k3,clamp:D3,fixedBase:ch,isDecimal:P3,isEven:N3,isInteger:L3,isNegative:O3,isNumberEqual:ox,isOdd:B3,isPositive:G3,max:Ri,maxBy:F3,min:Bi,minBy:U3,mod:hh,toDegree:$3,toInteger:V3,toRadian:dh,forIn:xe,has:sx,hasKey:sx,hasValue:j3,keys:Kb,isMatch:Zb,values:eg,lowerCase:X3,lowerFirst:H3,substitute:Y3,upperCase:q3,upperFirst:Eu,getType:ux,isArguments:Z3,isArray:At,isArrayLike:mi,isBoolean:tg,isDate:rg,isError:Q3,isFunction:Kr,isFinite:J3,isNil:yt,isNull:eB,isNumber:Lt,isObject:ri,isObjectLike:lh,isPlainObject:Un,isPrototype:lx,isRegExp:rB,isString:Xe,isType:ea,isUndefined:nB,isElement:iB,requestAnimationFrame:fx,clearAnimationFrame:cx,augment:aB,clone:Cr,debounce:ig,memoize:hx,deepMix:Hr,each:xe,extend:sB,indexOf:ag,isEmpty:vx,isEqual:ls,isEqualWith:lB,map:fs,mapValues:cB,mix:St,assign:St,get:$a,set:hB,pick:vB,omit:pB,throttle:og,toArray:px,toString:Su,uniqueId:wa,noop:Rl,identity:gB,size:ph,measureTextWidth:Bl,getEllipsisText:yB,Cache:mB}),bB={getDefaultCfg:function(){return{}},getEvents:function(){return{}},updateCfg:function(e){return Object.assign(this,e),!0},shouldBegin:function(){return!0},shouldUpdate:function(){return!0},shouldEnd:function(){return!0},bind:function(e){var t=this,n=this.events;this.graph=e,(this.type==="drag-canvas"||this.type==="brush-select"||this.type==="lasso-select")&&e.get("canvas").set("draggable",!0),xe(n,function(i,a){e.on(a,i)}),document.addEventListener("visibilitychange",function(){t.keydown=!1})},unbind:function(e){var t=this.events,n=e.get("canvas").get("draggable");(this.type==="drag-canvas"||this.type==="brush-select"||this.type==="lasso-select")&&e.get("canvas").set("draggable",!1),xe(t,function(i,a){e.off(a,i)}),e.get("canvas").set("draggable",n)},get:function(e){return this[e]},set:function(e,t){return this[e]=t,this}},gx=function(){function r(){}return r.registerBehavior=function(e,t){if(!t)throw new Error("please specify handler for this behavior: "+e);var n=Cr(bB);Object.assign(n,t);var i=function(o){var s=this;Object.assign(this,this.getDefaultCfg(),o);var u=this.getEvents();this.events=null;var l={};u&&(xe(u,function(f,c){l[c]=wu(s,f)}),this.events=l)};i.prototype=n,r.types[e]=i},r.hasBehavior=function(e){return!!r.types[e]},r.getBehavior=function(e){return r.types[e]},r.types={},r}(),xB="*",yx=function(){function r(){this._events={}}return r.prototype.on=function(e,t,n){return this._events[e]||(this._events[e]=[]),this._events[e].push({callback:t,once:!!n}),this},r.prototype.once=function(e,t){return this.on(e,t,!0),this},r.prototype.emit=function(e){for(var t=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var a=this._events[e]||[],o=this._events[xB]||[],s=function(u){for(var l=u.length,f=0;f<l;f++)if(!!u[f]){var c=u[f],h=c.callback,d=c.once;d&&(u.splice(f,1),u.length===0&&delete t._events[e],l--,f--),h.apply(t,n)}};s(a),s(o)},r.prototype.off=function(e,t){if(!e)this._events={};else if(!t)delete this._events[e];else{for(var n=this._events[e]||[],i=n.length,a=0;a<i;a++)n[a].callback===t&&(n.splice(a,1),i--,a--);n.length===0&&delete this._events[e]}return this},r.prototype.getEvents=function(){return this._events},r}(),Ai=1e-6,kn=typeof Float32Array!="undefined"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});function Cu(){var r=new kn(9);return kn!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function mx(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[4],r[4]=e[5],r[5]=e[6],r[6]=e[8],r[7]=e[9],r[8]=e[10],r}function _B(r){var e=new kn(9);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e}function wB(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function SB(r,e,t,n,i,a,o,s,u){var l=new kn(9);return l[0]=r,l[1]=e,l[2]=t,l[3]=n,l[4]=i,l[5]=a,l[6]=o,l[7]=s,l[8]=u,l}function EB(r,e,t,n,i,a,o,s,u,l){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r[4]=a,r[5]=o,r[6]=s,r[7]=u,r[8]=l,r}function CB(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function AB(r,e){if(r===e){var t=e[1],n=e[2],i=e[5];r[1]=e[3],r[2]=e[6],r[3]=t,r[5]=e[7],r[6]=n,r[7]=i}else r[0]=e[0],r[1]=e[3],r[2]=e[6],r[3]=e[1],r[4]=e[4],r[5]=e[7],r[6]=e[2],r[7]=e[5],r[8]=e[8];return r}function ug(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7],f=e[8],c=f*o-s*l,h=-f*a+s*u,d=l*a-o*u,v=t*c+n*h+i*d;return v?(v=1/v,r[0]=c*v,r[1]=(-f*n+i*l)*v,r[2]=(s*n-i*o)*v,r[3]=h*v,r[4]=(f*t-i*u)*v,r[5]=(-s*t+i*a)*v,r[6]=d*v,r[7]=(-l*t+n*u)*v,r[8]=(o*t-n*a)*v,r):null}function TB(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7],f=e[8];return r[0]=o*f-s*l,r[1]=i*l-n*f,r[2]=n*s-i*o,r[3]=s*u-a*f,r[4]=t*f-i*u,r[5]=i*a-t*s,r[6]=a*l-o*u,r[7]=n*u-t*l,r[8]=t*o-n*a,r}function MB(r){var e=r[0],t=r[1],n=r[2],i=r[3],a=r[4],o=r[5],s=r[6],u=r[7],l=r[8];return e*(l*a-o*u)+t*(-l*i+o*s)+n*(u*i-a*s)}function zn(r,e,t){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],f=e[7],c=e[8],h=t[0],d=t[1],v=t[2],p=t[3],g=t[4],y=t[5],m=t[6],b=t[7],x=t[8];return r[0]=h*n+d*o+v*l,r[1]=h*i+d*s+v*f,r[2]=h*a+d*u+v*c,r[3]=p*n+g*o+y*l,r[4]=p*i+g*s+y*f,r[5]=p*a+g*u+y*c,r[6]=m*n+b*o+x*l,r[7]=m*i+b*s+x*f,r[8]=m*a+b*u+x*c,r}function IB(r,e,t){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],f=e[7],c=e[8],h=t[0],d=t[1];return r[0]=n,r[1]=i,r[2]=a,r[3]=o,r[4]=s,r[5]=u,r[6]=h*n+d*o+l,r[7]=h*i+d*s+f,r[8]=h*a+d*u+c,r}function kB(r,e,t){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],f=e[7],c=e[8],h=Math.sin(t),d=Math.cos(t);return r[0]=d*n+h*o,r[1]=d*i+h*s,r[2]=d*a+h*u,r[3]=d*o-h*n,r[4]=d*s-h*i,r[5]=d*u-h*a,r[6]=l,r[7]=f,r[8]=c,r}function DB(r,e,t){var n=t[0],i=t[1];return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=i*e[3],r[4]=i*e[4],r[5]=i*e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function Gl(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=e[0],r[7]=e[1],r[8]=1,r}function Fl(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=n,r[1]=t,r[2]=0,r[3]=-t,r[4]=n,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function Ul(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=e[1],r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function PB(r,e){return r[0]=e[0],r[1]=e[1],r[2]=0,r[3]=e[2],r[4]=e[3],r[5]=0,r[6]=e[4],r[7]=e[5],r[8]=1,r}function NB(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],o=t+t,s=n+n,u=i+i,l=t*o,f=n*o,c=n*s,h=i*o,d=i*s,v=i*u,p=a*o,g=a*s,y=a*u;return r[0]=1-c-v,r[3]=f-y,r[6]=h+g,r[1]=f+y,r[4]=1-l-v,r[7]=d-p,r[2]=h-g,r[5]=d+p,r[8]=1-l-c,r}function bx(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7],f=e[8],c=e[9],h=e[10],d=e[11],v=e[12],p=e[13],g=e[14],y=e[15],m=t*s-n*o,b=t*u-i*o,x=t*l-a*o,_=n*u-i*s,S=n*l-a*s,E=i*l-a*u,C=f*p-c*v,M=f*g-h*v,w=f*y-d*v,T=c*g-h*p,I=c*y-d*p,k=h*y-d*g,O=m*k-b*I+x*T+_*w-S*M+E*C;return O?(O=1/O,r[0]=(s*k-u*I+l*T)*O,r[1]=(u*w-o*k-l*M)*O,r[2]=(o*I-s*w+l*C)*O,r[3]=(i*I-n*k-a*T)*O,r[4]=(t*k-i*w+a*M)*O,r[5]=(n*w-t*I-a*C)*O,r[6]=(p*E-g*S+y*_)*O,r[7]=(g*x-v*E-y*b)*O,r[8]=(v*S-p*x+y*m)*O,r):null}function LB(r,e,t){return r[0]=2/e,r[1]=0,r[2]=0,r[3]=0,r[4]=-2/t,r[5]=0,r[6]=-1,r[7]=1,r[8]=1,r}function OB(r){return"mat3("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+")"}function RB(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])}function BB(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r[6]=e[6]+t[6],r[7]=e[7]+t[7],r[8]=e[8]+t[8],r}function xx(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r[4]=e[4]-t[4],r[5]=e[5]-t[5],r[6]=e[6]-t[6],r[7]=e[7]-t[7],r[8]=e[8]-t[8],r}function GB(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r[8]=e[8]*t,r}function FB(r,e,t,n){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r[3]=e[3]+t[3]*n,r[4]=e[4]+t[4]*n,r[5]=e[5]+t[5]*n,r[6]=e[6]+t[6]*n,r[7]=e[7]+t[7]*n,r[8]=e[8]+t[8]*n,r}function UB(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]}function zB(r,e){var t=r[0],n=r[1],i=r[2],a=r[3],o=r[4],s=r[5],u=r[6],l=r[7],f=r[8],c=e[0],h=e[1],d=e[2],v=e[3],p=e[4],g=e[5],y=e[6],m=e[7],b=e[8];return Math.abs(t-c)<=Ai*Math.max(1,Math.abs(t),Math.abs(c))&&Math.abs(n-h)<=Ai*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-d)<=Ai*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(a-v)<=Ai*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(o-p)<=Ai*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-g)<=Ai*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(u-y)<=Ai*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(l-m)<=Ai*Math.max(1,Math.abs(l),Math.abs(m))&&Math.abs(f-b)<=Ai*Math.max(1,Math.abs(f),Math.abs(b))}var $B=zn,VB=xx,WB=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:Cu,fromMat4:mx,clone:_B,copy:wB,fromValues:SB,set:EB,identity:CB,transpose:AB,invert:ug,adjoint:TB,determinant:MB,multiply:zn,translate:IB,rotate:kB,scale:DB,fromTranslation:Gl,fromRotation:Fl,fromScaling:Ul,fromMat2d:PB,fromQuat:NB,normalFromMat4:bx,projection:LB,str:OB,frob:RB,add:BB,subtract:xx,multiplyScalar:GB,multiplyScalarAndAdd:FB,exactEquals:UB,equals:zB,mul:$B,sub:VB});function bi(){var r=new kn(16);return kn!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function jB(r){var e=new kn(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function lg(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function _x(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function yh(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7],f=e[8],c=e[9],h=e[10],d=e[11],v=e[12],p=e[13],g=e[14],y=e[15],m=t*s-n*o,b=t*u-i*o,x=t*l-a*o,_=n*u-i*s,S=n*l-a*s,E=i*l-a*u,C=f*p-c*v,M=f*g-h*v,w=f*y-d*v,T=c*g-h*p,I=c*y-d*p,k=h*y-d*g,O=m*k-b*I+x*T+_*w-S*M+E*C;return O?(O=1/O,r[0]=(s*k-u*I+l*T)*O,r[1]=(i*I-n*k-a*T)*O,r[2]=(p*E-g*S+y*_)*O,r[3]=(h*S-c*E-d*_)*O,r[4]=(u*w-o*k-l*M)*O,r[5]=(t*k-i*w+a*M)*O,r[6]=(g*x-v*E-y*b)*O,r[7]=(f*E-h*x+d*b)*O,r[8]=(o*I-s*w+l*C)*O,r[9]=(n*w-t*I-a*C)*O,r[10]=(v*S-p*x+y*m)*O,r[11]=(c*x-f*S-d*m)*O,r[12]=(s*M-o*T-u*C)*O,r[13]=(t*T-n*M+i*C)*O,r[14]=(p*b-v*_-g*m)*O,r[15]=(f*_-c*b+h*m)*O,r):null}function cs(r,e,t){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],f=e[7],c=e[8],h=e[9],d=e[10],v=e[11],p=e[12],g=e[13],y=e[14],m=e[15],b=t[0],x=t[1],_=t[2],S=t[3];return r[0]=b*n+x*s+_*c+S*p,r[1]=b*i+x*u+_*h+S*g,r[2]=b*a+x*l+_*d+S*y,r[3]=b*o+x*f+_*v+S*m,b=t[4],x=t[5],_=t[6],S=t[7],r[4]=b*n+x*s+_*c+S*p,r[5]=b*i+x*u+_*h+S*g,r[6]=b*a+x*l+_*d+S*y,r[7]=b*o+x*f+_*v+S*m,b=t[8],x=t[9],_=t[10],S=t[11],r[8]=b*n+x*s+_*c+S*p,r[9]=b*i+x*u+_*h+S*g,r[10]=b*a+x*l+_*d+S*y,r[11]=b*o+x*f+_*v+S*m,b=t[12],x=t[13],_=t[14],S=t[15],r[12]=b*n+x*s+_*c+S*p,r[13]=b*i+x*u+_*h+S*g,r[14]=b*a+x*l+_*d+S*y,r[15]=b*o+x*f+_*v+S*m,r}function zl(r,e,t){var n=t[0],i=t[1],a=t[2],o,s,u,l,f,c,h,d,v,p,g,y;return e===r?(r[12]=e[0]*n+e[4]*i+e[8]*a+e[12],r[13]=e[1]*n+e[5]*i+e[9]*a+e[13],r[14]=e[2]*n+e[6]*i+e[10]*a+e[14],r[15]=e[3]*n+e[7]*i+e[11]*a+e[15]):(o=e[0],s=e[1],u=e[2],l=e[3],f=e[4],c=e[5],h=e[6],d=e[7],v=e[8],p=e[9],g=e[10],y=e[11],r[0]=o,r[1]=s,r[2]=u,r[3]=l,r[4]=f,r[5]=c,r[6]=h,r[7]=d,r[8]=v,r[9]=p,r[10]=g,r[11]=y,r[12]=o*n+f*i+v*a+e[12],r[13]=s*n+c*i+p*a+e[13],r[14]=u*n+h*i+g*a+e[14],r[15]=l*n+d*i+y*a+e[15]),r}function XB(r,e,t){var n=Math.sin(t),i=Math.cos(t),a=e[4],o=e[5],s=e[6],u=e[7],l=e[8],f=e[9],c=e[10],h=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=a*i+l*n,r[5]=o*i+f*n,r[6]=s*i+c*n,r[7]=u*i+h*n,r[8]=l*i-a*n,r[9]=f*i-o*n,r[10]=c*i-s*n,r[11]=h*i-u*n,r}function HB(r,e,t){var n=Math.sin(t),i=Math.cos(t),a=e[0],o=e[1],s=e[2],u=e[3],l=e[8],f=e[9],c=e[10],h=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=a*i-l*n,r[1]=o*i-f*n,r[2]=s*i-c*n,r[3]=u*i-h*n,r[8]=a*n+l*i,r[9]=o*n+f*i,r[10]=s*n+c*i,r[11]=u*n+h*i,r}function $l(r,e){return r[0]=e[12],r[1]=e[13],r[2]=e[14],r}function Au(r,e){var t=e[0],n=e[1],i=e[2],a=e[4],o=e[5],s=e[6],u=e[8],l=e[9],f=e[10];return r[0]=Math.hypot(t,n,i),r[1]=Math.hypot(a,o,s),r[2]=Math.hypot(u,l,f),r}function Vl(r,e){var t=new kn(3);Au(t,e);var n=1/t[0],i=1/t[1],a=1/t[2],o=e[0]*n,s=e[1]*i,u=e[2]*a,l=e[4]*n,f=e[5]*i,c=e[6]*a,h=e[8]*n,d=e[9]*i,v=e[10]*a,p=o+f+v,g=0;return p>0?(g=Math.sqrt(p+1)*2,r[3]=.25*g,r[0]=(c-d)/g,r[1]=(h-u)/g,r[2]=(s-l)/g):o>f&&o>v?(g=Math.sqrt(1+o-f-v)*2,r[3]=(c-d)/g,r[0]=.25*g,r[1]=(s+l)/g,r[2]=(h+u)/g):f>v?(g=Math.sqrt(1+f-o-v)*2,r[3]=(h-u)/g,r[0]=(s+l)/g,r[1]=.25*g,r[2]=(c+d)/g):(g=Math.sqrt(1+v-o-f)*2,r[3]=(s-l)/g,r[0]=(h+u)/g,r[1]=(c+d)/g,r[2]=.25*g),r}function YB(r,e,t,n){var i=e[0],a=e[1],o=e[2],s=e[3],u=i+i,l=a+a,f=o+o,c=i*u,h=i*l,d=i*f,v=a*l,p=a*f,g=o*f,y=s*u,m=s*l,b=s*f,x=n[0],_=n[1],S=n[2];return r[0]=(1-(v+g))*x,r[1]=(h+b)*x,r[2]=(d-m)*x,r[3]=0,r[4]=(h-b)*_,r[5]=(1-(c+g))*_,r[6]=(p+y)*_,r[7]=0,r[8]=(d+m)*S,r[9]=(p-y)*S,r[10]=(1-(c+v))*S,r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function wx(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],o=t+t,s=n+n,u=i+i,l=t*o,f=n*o,c=n*s,h=i*o,d=i*s,v=i*u,p=a*o,g=a*s,y=a*u;return r[0]=1-c-v,r[1]=f+y,r[2]=h-g,r[3]=0,r[4]=f-y,r[5]=1-l-v,r[6]=d+p,r[7]=0,r[8]=h+g,r[9]=d-p,r[10]=1-l-c,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function qB(r,e,t,n,i){var a=1/Math.tan(e/2),o;return r[0]=a/t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0?(o=1/(n-i),r[10]=(i+n)*o,r[14]=2*i*n*o):(r[10]=-1,r[14]=-2*n),r}var KB=qB;function ZB(r,e,t,n,i,a,o){var s=1/(e-t),u=1/(n-i),l=1/(a-o);return r[0]=-2*s,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*u,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*l,r[11]=0,r[12]=(e+t)*s,r[13]=(i+n)*u,r[14]=(o+a)*l,r[15]=1,r}var QB=ZB;function JB(r,e,t,n){var i,a,o,s,u,l,f,c,h,d,v=e[0],p=e[1],g=e[2],y=n[0],m=n[1],b=n[2],x=t[0],_=t[1],S=t[2];return Math.abs(v-x)<Ai&&Math.abs(p-_)<Ai&&Math.abs(g-S)<Ai?_x(r):(f=v-x,c=p-_,h=g-S,d=1/Math.hypot(f,c,h),f*=d,c*=d,h*=d,i=m*h-b*c,a=b*f-y*h,o=y*c-m*f,d=Math.hypot(i,a,o),d?(d=1/d,i*=d,a*=d,o*=d):(i=0,a=0,o=0),s=c*o-h*a,u=h*i-f*o,l=f*a-c*i,d=Math.hypot(s,u,l),d?(d=1/d,s*=d,u*=d,l*=d):(s=0,u=0,l=0),r[0]=i,r[1]=s,r[2]=f,r[3]=0,r[4]=a,r[5]=u,r[6]=c,r[7]=0,r[8]=o,r[9]=l,r[10]=h,r[11]=0,r[12]=-(i*v+a*p+o*g),r[13]=-(s*v+u*p+l*g),r[14]=-(f*v+c*p+h*g),r[15]=1,r)}function Nr(){var r=new kn(3);return kn!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function Va(r){var e=new kn(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function mh(r){var e=r[0],t=r[1],n=r[2];return Math.hypot(e,t,n)}function nr(r,e,t){var n=new kn(3);return n[0]=r,n[1]=e,n[2]=t,n}function Xn(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function Tu(r,e,t,n){return r[0]=e,r[1]=t,r[2]=n,r}function Wa(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r}function fg(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r}function e5(r,e,t){return r[0]=e[0]*t[0],r[1]=e[1]*t[1],r[2]=e[2]*t[2],r}function Wl(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r}function t5(r,e){var t=e[0]-r[0],n=e[1]-r[1],i=e[2]-r[2];return Math.hypot(t,n,i)}function jl(r,e){var t=e[0],n=e[1],i=e[2],a=t*t+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),r[0]=e[0]*a,r[1]=e[1]*a,r[2]=e[2]*a,r}function bh(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function cg(r,e,t){var n=e[0],i=e[1],a=e[2],o=t[0],s=t[1],u=t[2];return r[0]=i*u-a*s,r[1]=a*o-n*u,r[2]=n*s-i*o,r}function hs(r,e,t,n){var i=e[0],a=e[1],o=e[2];return r[0]=i+n*(t[0]-i),r[1]=a+n*(t[1]-a),r[2]=o+n*(t[2]-o),r}function hg(r,e,t){var n=e[0],i=e[1],a=e[2],o=t[3]*n+t[7]*i+t[11]*a+t[15];return o=o||1,r[0]=(t[0]*n+t[4]*i+t[8]*a+t[12])/o,r[1]=(t[1]*n+t[5]*i+t[9]*a+t[13])/o,r[2]=(t[2]*n+t[6]*i+t[10]*a+t[14])/o,r}function Mu(r,e,t){var n=e[0],i=e[1],a=e[2];return r[0]=n*t[0]+i*t[3]+a*t[6],r[1]=n*t[1]+i*t[4]+a*t[7],r[2]=n*t[2]+i*t[5]+a*t[8],r}function r5(r,e,t){var n=t[0],i=t[1],a=t[2],o=t[3],s=e[0],u=e[1],l=e[2],f=i*l-a*u,c=a*s-n*l,h=n*u-i*s,d=i*h-a*c,v=a*f-n*h,p=n*c-i*f,g=o*2;return f*=g,c*=g,h*=g,d*=2,v*=2,p*=2,r[0]=s+f+d,r[1]=u+c+v,r[2]=l+h+p,r}var dg=fg,Sx=t5,Ex=mh;(function(){var r=Nr();return function(e,t,n,i,a,o){var s,u;for(t||(t=3),n||(n=0),i?u=Math.min(i*t+n,e.length):u=e.length,s=n;s<u;s+=t)r[0]=e[s],r[1]=e[s+1],r[2]=e[s+2],a(r,r,o),e[s]=r[0],e[s+1]=r[1],e[s+2]=r[2];return e}})();function Xl(){var r=new kn(4);return kn!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function Cx(r,e,t,n){var i=new kn(4);return i[0]=r,i[1]=e,i[2]=t,i[3]=n,i}function n5(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function i5(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],o=t*t+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),r[0]=t*o,r[1]=n*o,r[2]=i*o,r[3]=a*o,r}function Hl(r,e,t){var n=e[0],i=e[1],a=e[2],o=e[3];return r[0]=t[0]*n+t[4]*i+t[8]*a+t[12]*o,r[1]=t[1]*n+t[5]*i+t[9]*a+t[13]*o,r[2]=t[2]*n+t[6]*i+t[10]*a+t[14]*o,r[3]=t[3]*n+t[7]*i+t[11]*a+t[15]*o,r}(function(){var r=Xl();return function(e,t,n,i,a,o){var s,u;for(t||(t=4),n||(n=0),i?u=Math.min(i*t+n,e.length):u=e.length,s=n;s<u;s+=t)r[0]=e[s],r[1]=e[s+1],r[2]=e[s+2],r[3]=e[s+3],a(r,r,o),e[s]=r[0],e[s+1]=r[1],e[s+2]=r[2],e[s+3]=r[3];return e}})();function Dn(){var r=new kn(4);return kn!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function ds(r,e,t){t=t*.5;var n=Math.sin(t);return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=Math.cos(t),r}function Fi(r,e,t){var n=e[0],i=e[1],a=e[2],o=e[3],s=t[0],u=t[1],l=t[2],f=t[3];return r[0]=n*f+o*s+i*l-a*u,r[1]=i*f+o*u+a*s-n*l,r[2]=a*f+o*l+n*u-i*s,r[3]=o*f-n*s-i*u-a*l,r}function xh(r,e,t,n){var i=e[0],a=e[1],o=e[2],s=e[3],u=t[0],l=t[1],f=t[2],c=t[3],h,d,v,p,g;return d=i*u+a*l+o*f+s*c,d<0&&(d=-d,u=-u,l=-l,f=-f,c=-c),1-d>Ai?(h=Math.acos(d),v=Math.sin(h),p=Math.sin((1-n)*h)/v,g=Math.sin(n*h)/v):(p=1-n,g=n),r[0]=p*i+g*u,r[1]=p*a+g*l,r[2]=p*o+g*f,r[3]=p*s+g*c,r}function Ax(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],o=t*t+n*n+i*i+a*a,s=o?1/o:0;return r[0]=-t*s,r[1]=-n*s,r[2]=-i*s,r[3]=a*s,r}function a5(r,e){var t=e[0]+e[4]+e[8],n;if(t>0)n=Math.sqrt(t+1),r[3]=.5*n,n=.5/n,r[0]=(e[5]-e[7])*n,r[1]=(e[6]-e[2])*n,r[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(e[i*3+i]-e[a*3+a]-e[o*3+o]+1),r[i]=.5*n,n=.5/n,r[3]=(e[a*3+o]-e[o*3+a])*n,r[a]=(e[a*3+i]+e[i*3+a])*n,r[o]=(e[o*3+i]+e[i*3+o])*n}return r}function vg(r,e,t,n){var i=.5*Math.PI/180;e*=i,t*=i,n*=i;var a=Math.sin(e),o=Math.cos(e),s=Math.sin(t),u=Math.cos(t),l=Math.sin(n),f=Math.cos(n);return r[0]=a*u*f-o*s*l,r[1]=o*s*f+a*u*l,r[2]=o*u*l-a*s*f,r[3]=o*u*f+a*s*l,r}var pg=Cx,Yl=n5,o5=Fi,Iu=i5;(function(){var r=Nr(),e=nr(1,0,0),t=nr(0,1,0);return function(n,i,a){var o=bh(i,a);return o<-.999999?(cg(r,e,i),Ex(r)<1e-6&&cg(r,t,i),jl(r,r),ds(n,r,Math.PI),n):o>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(cg(r,i,a),n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=1+o,Iu(n,n))}})();(function(){var r=Dn(),e=Dn();return function(t,n,i,a,o,s){return xh(r,n,o,s),xh(e,i,a,s),xh(t,r,e,2*s*(1-s)),t}})();(function(){var r=Cu();return function(e,t,n,i){return r[0]=n[0],r[3]=n[1],r[6]=n[2],r[1]=i[0],r[4]=i[1],r[7]=i[2],r[2]=-t[0],r[5]=-t[1],r[8]=-t[2],Iu(e,a5(e,r))}})();function s5(){var r=new kn(2);return kn!=Float32Array&&(r[0]=0,r[1]=0),r}function Hn(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r}function u5(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r}function vs(r,e,t){return r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r}function ps(r,e,t){return r[0]=Math.max(e[0],t[0]),r[1]=Math.max(e[1],t[1]),r}function ci(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r}function Tx(r,e){var t=e[0]-r[0],n=e[1]-r[1];return Math.hypot(t,n)}function gs(r,e){var t=e[0],n=e[1],i=t*t+n*n;return i>0&&(i=1/Math.sqrt(i)),r[0]=e[0]*i,r[1]=e[1]*i,r}function Mx(r,e){return r[0]*e[0]+r[1]*e[1]}function Ix(r,e){return r[0]===e[0]&&r[1]===e[1]}var gg=u5;(function(){var r=s5();return function(e,t,n,i,a,o){var s,u;for(t||(t=2),n||(n=0),i?u=Math.min(i*t+n,e.length):u=e.length,s=n;s<u;s+=t)r[0]=e[s],r[1]=e[s+1],a(r,r,o),e[s]=r[0],e[s+1]=r[1];return e}})();function l5(r,e,t){var n=[0,0,0,0,0,0,0,0,0];return Gl(n,t),zn(r,n,e)}function f5(r,e,t){var n=[0,0,0,0,0,0,0,0,0];return Fl(n,t),zn(r,n,e)}function c5(r,e,t){var n=[0,0,0,0,0,0,0,0,0];return Ul(n,t),zn(r,n,e)}function h5(r,e,t){return zn(r,t,e)}function _h(r,e){for(var t=r?[].concat(r):[1,0,0,0,1,0,0,0,1],n=0,i=e.length;n<i;n++){var a=e[n];switch(a[0]){case"t":l5(t,t,[a[1],a[2]]);break;case"s":c5(t,t,[a[1],a[2]]);break;case"r":f5(t,t,a[1]);break;case"m":h5(t,t,a[1]);break}}return t}var ys=function(e,t){var n=e.nodes,i=e.edges,a=[],o={};if(!n)throw new Error("invalid nodes data!");return n&&n.forEach(function(s,u){o[s.id]=u;var l=[];a.push(l)}),i&&i.forEach(function(s){var u=s.source,l=s.target,f=o[u],c=o[l];!f&&f!==0||!c&&c!==0||(a[f][c]=1,t||(a[c][f]=1))}),a},d5=function(e,t){return e===t},kx=function(){function r(e,t){t===void 0&&(t=null),this.value=e,this.next=t}return r.prototype.toString=function(e){return e?e(this.value):""+this.value},r}(),Dx=function(){function r(e){e===void 0&&(e=d5),this.head=null,this.tail=null,this.compare=e}return r.prototype.prepend=function(e){var t=new kx(e,this.head);return this.head=t,this.tail||(this.tail=t),this},r.prototype.append=function(e){var t=new kx(e);return this.head?(this.tail.next=t,this.tail=t,this):(this.head=t,this.tail=t,this)},r.prototype.delete=function(e){if(!this.head)return null;for(var t=null;this.head&&this.compare(this.head.value,e);)t=this.head,this.head=this.head.next;var n=this.head;if(n!==null)for(;n.next;)this.compare(n.next.value,e)?(t=n.next,n.next=n.next.next):n=n.next;return this.compare(this.tail.value,e)&&(this.tail=n),t},r.prototype.find=function(e){var t=e.value,n=t===void 0?void 0:t,i=e.callback,a=i===void 0?void 0:i;if(!this.head)return null;for(var o=this.head;o;){if(a&&a(o.value)||n!==void 0&&this.compare(o.value,n))return o;o=o.next}return null},r.prototype.deleteTail=function(){var e=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,e;for(var t=this.head;t.next;)t.next.next?t=t.next:t.next=null;return this.tail=t,e},r.prototype.deleteHead=function(){if(!this.head)return null;var e=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),e},r.prototype.fromArray=function(e){var t=this;return e.forEach(function(n){return t.append(n)}),this},r.prototype.toArray=function(){for(var e=[],t=this.head;t;)e.push(t),t=t.next;return e},r.prototype.reverse=function(){for(var e=this.head,t=null,n=null;e;)n=e.next,e.next=t,t=e,e=n;this.tail=this.head,this.head=t},r.prototype.toString=function(e){return e===void 0&&(e=void 0),this.toArray().map(function(t){return t.toString(e)}).toString()},r}(),v5=function(){function r(){this.linkedList=new Dx}return r.prototype.isEmpty=function(){return!this.linkedList.head},r.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},r.prototype.enqueue=function(e){this.linkedList.append(e)},r.prototype.dequeue=function(){var e=this.linkedList.deleteHead();return e?e.value:null},r.prototype.toString=function(e){return this.linkedList.toString(e)},r}(),Ti=function(e,t,n){t===void 0&&(t=[]);var i=t.filter(function(u){return u.source===e||u.target===e});if(n==="target"){var a=function(l){return l.source===e};return i.filter(a).map(function(u){return u.target})}if(n==="source"){var o=function(l){return l.target===e};return i.filter(o).map(function(u){return u.source})}var s=function(l){return l.source===e?l.target:l.source};return i.map(s)},p5=function(e,t){return t.filter(function(n){return n.source===e})},wh=function(e,t){return t.filter(function(n){return n.source===e||n.target===e})},Px=function(e){e===void 0&&(e=0);var t=(""+Math.random()).split(".")[1].substr(0,5),n=(""+Math.random()).split(".")[1].substr(0,5);return e+"-"+t+n};function g5(r){r===void 0&&(r={});var e=r,t=function(){},n=function(){var i={};return function(a){var o=a.next,s=o;return i[s]?!1:(i[s]=!0,!0)}}();return e.allowTraversal=r.allowTraversal||n,e.enter=r.enter||t,e.leave=r.leave||t,e}var Nx=function(e,t,n){var i=g5(n),a=new v5,o=e.edges,s=o===void 0?[]:o;a.enqueue(t);for(var u="",l=function(){var c=a.dequeue();i.enter({current:c,previous:u}),Ti(c,s,"target").forEach(function(h){i.allowTraversal({previous:u,current:c,next:h})&&a.enqueue(h)}),i.leave({current:c,previous:u}),u=c};!a.isEmpty();)l()},y5=function(e){for(var t=e.nodes,n=t===void 0?[]:t,i=e.edges,a=i===void 0?[]:i,o=[],s={},u=[],l=function d(v){u.push(v),s[v.id]=!0;for(var p=Ti(v.id,a),g=function(b){var x=p[b];if(!s[x]){var _=n.filter(function(S){return S.id===x});_.length>0&&d(_[0])}},y=0;y<p.length;++y)g(y)},f=0;f<n.length;f++){var c=n[f];if(!s[c.id]){l(c);for(var h=[];u.length>0;)h.push(u.pop());o.push(h)}}return o},Lx=function(e){for(var t=e.nodes,n=t===void 0?[]:t,i=e.edges,a=i===void 0?[]:i,o=[],s={},u={},l={},f=[],c=0,h=function g(y){u[y.id]=c,l[y.id]=c,c+=1,o.push(y),s[y.id]=!0;for(var m=Ti(y.id,a,"target").filter(function(E){return n.map(function(C){return C.id}).indexOf(E)>-1}),b=function(C){var M=m[C];if(!u[M]&&u[M]!==0){var w=n.filter(function(T){return T.id===M});w.length>0&&g(w[0]),l[y.id]=Math.min(l[y.id],l[M])}else s[M]&&(l[y.id]=Math.min(l[y.id],u[M]))},x=0;x<m.length;x++)b(x);if(l[y.id]===u[y.id]){for(var _=[];o.length>0;){var S=o.pop();if(s[S.id]=!1,_.push(S),S===y)break}_.length>0&&f.push(_)}},d=0,v=n;d<v.length;d++){var p=v[d];!u[p.id]&&u[p.id]!==0&&h(p)}return f};function yg(r,e){return e?Lx(r):y5(r)}var mo=function(e){var t={},n=e.nodes,i=n===void 0?[]:n,a=e.edges,o=a===void 0?[]:a;return i.forEach(function(s){t[s.id]={degree:0,inDegree:0,outDegree:0}}),o.forEach(function(s){t[s.source].degree++,t[s.source].outDegree++,t[s.target].degree++,t[s.target].inDegree++}),t},Ox=function(e,t){var n=mo(e);return n[t]?mo(e)[t].inDegree:0},Rx=function(e,t){var n=mo(e);return n[t]?mo(e)[t].outDegree:0};function m5(r){r===void 0&&(r={});var e=r,t=function(){},n=function(){var i={};return function(a){var o=a.next;return i[o]?!1:(i[o]=!0,!0)}}();return e.allowTraversal=r.allowTraversal||n,e.enter=r.enter||t,e.leave=r.leave||t,e}function Bx(r,e,t,n){n.enter({current:e,previous:t});var i=r.edges,a=i===void 0?[]:i;Ti(e,a,"target").forEach(function(o){n.allowTraversal({previous:t,current:e,next:o})&&Bx(r,o,e,n)}),n.leave({current:e,previous:t})}function mg(r,e,t){Bx(r,e,"",m5(t))}var bg=function(e){var t=null,n=e.nodes,i=n===void 0?[]:n,a={},o={},s={},u={};i.forEach(function(c){o[c.id]=c});for(var l={enter:function(h){var d=h.current,v=h.previous;if(s[d]){t={};for(var p=d,g=v;g!==d;)t[p]=g,p=g,g=a[g];t[p]=g}else s[d]=d,delete o[d],a[d]=v},leave:function(h){var d=h.current;u[d]=d,delete s[d]},allowTraversal:function(h){var d=h.next;return t?!1:!u[d]}};Object.keys(o).length;){var f=Object.keys(o)[0];mg(e,f,l)}return t},xg=function(e,t,n){var i,a;n===void 0&&(n=!0);for(var o=[],s=yg(e,!1),u=0,l=s;u<l.length;u++){var f=l[u];if(!!f.length)for(var c=f[0],h=c.id,d=[c],v=(i={},i[h]=c,i),p=(a={},a[h]=new Set,a);d.length>0;)for(var g=d.pop(),y=g.id,m=Ti(y,e.edges),b=function(S){var E,C=m[S],M=e.nodes.find(function(U){return U.id===C});if(C===y)o.push((E={},E[C]=g,E));else if(!(C in p))v[C]=g,d.push(M),p[C]=new Set([g]);else if(!p[y].has(M)){for(var w=!0,T=[M,g],I=v[y];p[C].size&&!p[C].has(I)&&(T.push(I),I!==v[I.id]);)I=v[I.id];if(T.push(I),t&&n?(w=!1,T.findIndex(function(U){return t.indexOf(U.id)>-1})>-1&&(w=!0)):t&&!n&&T.findIndex(function(U){return t.indexOf(U.id)>-1})>-1&&(w=!1),w){for(var k={},O=1;O<T.length;O+=1)k[T[O-1].id]=T[O];T.length&&(k[T[T.length-1].id]=T[0]),o.push(k)}p[C].add(g)}},x=0;x<m.length;x+=1)b(x)}return o},_g=function(e,t,n){n===void 0&&(n=!0);for(var i=[],a=new Set,o=[],s=[],u={},l={},f=function(I){for(var k=[I];k.length>0;){var O=k.pop();a.has(O)&&(a.delete(O),o[O.id].forEach(function(U){k.push(U)}),o[O.id].clear())}},c=function T(I,k,O){var U=!1;if(t&&n===!1&&t.indexOf(I.id)>-1)return U;i.push(I),a.add(I);for(var q=O[I.id],K=0;K<q.length;K+=1){var le=u[q[K]];if(le===k){for(var he={},te=1;te<i.length;te+=1)he[i[te-1].id]=i[te];i.length&&(he[i[i.length-1].id]=i[0]),s.push(he),U=!0}else a.has(le)||T(le,k,O)&&(U=!0)}if(U)f(I);else for(var K=0;K<q.length;K+=1){var le=u[q[K]];o[le.id].has(I)||o[le.id].add(I)}return i.pop(),U},h=e.nodes,d=h===void 0?[]:h,v=0;v<d.length;v+=1){var p=d[v],g=p.id;l[g]=v,u[v]=p}if(t&&n)for(var y=function(I){var k=t[I];l[d[I].id]=l[k],l[k]=0,u[0]=d.find(function(O){return O.id===k}),u[l[d[I].id]]=d[I]},v=0;v<t.length;v++)y(v);for(var m=function(I){for(var k,O,U=1/0,q=0;q<I.length;q+=1)for(var K=I[q],le=0;le<K.length;le++){var he=l[K[le].id];he<U&&(U=he,O=q)}for(var te=I[O],se=[],q=0;q<te.length;q+=1){var ge=te[q];se[ge.id]=[];for(var Se=0,ne=Ti(ge.id,e.edges,"target").filter(function(ke){return te.map(function(rt){return rt.id}).indexOf(ke)>-1});Se<ne.length;Se++){var pe=ne[Se];pe===ge.id&&!(n===!1&&t.indexOf(ge.id)>-1)?s.push((k={},k[ge.id]=ge,k)):se[ge.id].push(l[pe])}}return{component:te,adjList:se,minIdx:U}},b=0;b<d.length;){var x=d.filter(function(T){return l[T.id]>=b}),_=Lx({nodes:x,edges:e.edges}).filter(function(T){return T.length>1});if(_.length===0)break;var S=m(_),E=S.minIdx,C=S.adjList,M=S.component;if(M.length>1){M.forEach(function(T){o[T.id]=new Set});var w=u[E];if(t&&n&&t.indexOf(w.id)===-1)return s;c(w,w,C),b=E+1}else break}return s},Gx=function(e,t,n,i){return i===void 0&&(i=!0),t?_g(e,n,i):xg(e,n,i)},b5=function(e,t,n){for(var i=1/0,a,o=0;o<t.length;o++){var s=t[o].id;!n[s]&&e[s]<=i&&(i=e[s],a=t[o])}return a},ql=function(e,t,n,i){var a=e.nodes,o=a===void 0?[]:a,s=e.edges,u=s===void 0?[]:s,l={},f={},c={};o.forEach(function(m,b){var x=m.id;f[x]=1/0,x===t&&(f[x]=0)});for(var h=o.length,d=function(b){var x=b5(f,o,l),_=x.id;if(l[_]=!0,f[_]===1/0)return"continue";var S=[];n?S=p5(_,u):S=wh(_,u),S.forEach(function(E){var C=E.target,M=E.source,w=C===_?M:C,T=i&&E[i]?E[i]:1;f[w]>f[x.id]+T?(f[w]=f[x.id]+T,c[w]=[x.id]):f[w]===f[x.id]+T&&c[w].push(x.id)})},v=0;v<h;v++)d();c[t]=[t];var p={};for(var g in f)f[g]!==1/0&&Fx(t,g,c,p);var y={};for(var g in p)y[g]=p[g][0];return{length:f,path:y,allPath:p}};function Fx(r,e,t,n){if(r===e)return[r];if(n[e])return n[e];for(var i=[],a=0,o=t[e];a<o.length;a++){var s=o[a],u=Fx(r,s,t,n);if(!u)return;for(var l=0,f=u;l<f.length;l++){var c=f[l];At(c)?i.push(xa(xa([],c),[e])):i.push([c,e])}}return n[e]=i,n[e]}var Ux=function(e,t,n,i,a){var o=ql(e,t,i,a),s=o.length,u=o.path,l=o.allPath;return{length:s[n],path:u[n],allPath:l[n]}},zx=function(e,t,n,i){var a;if(t===n)return[[t]];var o=e.edges,s=o===void 0?[]:o,u=[t],l=(a={},a[t]=!0,a),f=[],c=[],h=i?Ti(t,s,"target"):Ti(t,s);for(f.push(h);u.length>0&&f.length>0;){var d=f[f.length-1];if(d.length){var v=d.shift();v&&(u.push(v),l[v]=!0,h=i?Ti(v,s,"target"):Ti(v,s),f.push(h.filter(function(y){return!l[y]})))}else{var p=u.pop();l[p]=!1,f.pop();continue}if(u[u.length-1]===n){var g=u.map(function(m){return m});c.push(g);var p=u.pop();l[p]=!1,f.pop()}}return c},Kl=function(e,t){for(var n=ys(e,t),i=[],a=n.length,o=0;o<a;o+=1){i[o]=[];for(var s=0;s<a;s+=1)o===s?i[o][s]=0:n[o][s]===0||!n[o][s]?i[o][s]=1/0:i[o][s]=n[o][s]}for(var u=0;u<a;u+=1)for(var o=0;o<a;o+=1)for(var s=0;s<a;s+=1)i[o][s]>i[o][u]+i[u][s]&&(i[o][s]=i[o][u]+i[u][s]);return i},$x=function(e,t,n,i){t===void 0&&(t=!1),n===void 0&&(n="weight"),i===void 0&&(i=1e3);var a=e.nodes,o=a===void 0?[]:a,s=e.edges,u=s===void 0?[]:s,l={},f={};o.forEach(function(b,x){var _=Px();b.clusterId=_,l[_]={id:_,nodes:[b]},f[b.id]={node:b,idx:x}});var c=ys(e,t),h={};c.forEach(function(b,x){var _=o[x].id;h[_]={},b.forEach(function(S,E){if(!!S){var C=o[E].id;h[_][C]=S}})});for(var d=0,v=function(){var x=!1;if(o.forEach(function(_){var S={};Object.keys(h[_.id]).forEach(function(O){var U=h[_.id][O],q=f[O].node,K=q.clusterId;S[K]||(S[K]=0),S[K]+=U});var E=-1/0,C=[];if(Object.keys(S).forEach(function(O){E<S[O]?(E=S[O],C=[O]):E===S[O]&&C.push(O)}),!(C.length===1&&C[0]===_.clusterId)){var M=C.indexOf(_.clusterId);if(M>=0&&C.splice(M,1),C&&C.length){x=!0;var w=l[_.clusterId],T=w.nodes.indexOf(_);w.nodes.splice(T,1);var I=Math.floor(Math.random()*C.length),k=l[C[I]];k.nodes.push(_),_.clusterId=k.id}}}),!x)return"break";d++};d<i;){var p=v();if(p==="break")break}Object.keys(l).forEach(function(b){var x=l[b];(!x.nodes||!x.nodes.length)&&delete l[b]});var g=[],y={};u.forEach(function(b){var x=b.source,_=b.target,S=b[n]||1,E=f[x].node.clusterId,C=f[_].node.clusterId,M=E+"---"+C;if(y[M])y[M].weight+=S,y[M].count++;else{var w={source:E,target:C,weight:S,count:1};y[M]=w,g.push(w)}});var m=[];return Object.keys(l).forEach(function(b){m.push(l[b])}),{clusters:m,clusterEdges:g}},x5=function(e,t,n,i){for(var a=t.length,o=2*i,s=0,u=0;u<a;u++)for(var l=e[u].clusterId,f=0;f<a;f++){var c=e[f].clusterId;if(l===c){var h=t[u][f]||0,d=n[u]||0,v=n[f]||0;s+=h-d*v/o}}return s*=1/o,s},Vx=function(e,t,n,i){t===void 0&&(t=!1),n===void 0&&(n="weight"),i===void 0&&(i=1e-4);var a=e.nodes,o=a===void 0?[]:a,s=e.edges,u=s===void 0?[]:s,l=1,f={},c={};o.forEach(function(C,M){var w=String(l++);C.clusterId=w,f[w]={id:w,nodes:[C]},c[C.id]={node:C,idx:M}});var h=ys(e,t),d=[],v={},p=0;h.forEach(function(C,M){var w=0,T=o[M].id;v[T]={},C.forEach(function(I,k){if(!!I){w+=I;var O=o[k].id;v[T][O]=I,p+=I}}),d.push(w)}),p/=2;for(var g=1/0,y=1/0,m=0;g=x5(o,h,d,p),!(Math.abs(g-y)<i||m>100);)y=g,m++,Object.keys(f).forEach(function(C){var M=0;u.forEach(function(w){var T=w.source,I=w.target,k=c[T].node.clusterId,O=c[I].node.clusterId;(k===C&&O!==C||O===C&&k!==C)&&(M=M+(w[n]||1))}),f[C].sumTot=M}),o.forEach(function(C,M){var w=f[C.clusterId],T=0,I,k=d[M]/(2*p),O=0,U=w.nodes;U.forEach(function(ge){var Se=c[ge.id].idx;O+=h[M][Se]||0});var q=O-w.sumTot*k,K=v[C.id];if(Object.keys(K).forEach(function(ge){var Se=c[ge].node,ne=Se.clusterId;if(ne!==C.clusterId){var pe=f[ne],Ge=pe.nodes;if(!(!Ge||!Ge.length)){var ke=0;Ge.forEach(function(ut){var pt=c[ut.id].idx;ke+=h[M][pt]||0});var rt=ke-pe.sumTot*k,$e=rt-q;$e>T&&(T=$e,I=pe)}}}),T>0){I.nodes.push(C);var le=C.clusterId;C.clusterId=I.id;var he=w.nodes.indexOf(C);w.nodes.splice(he,1);var te=0,se=0;u.forEach(function(ge){var Se=ge.source,ne=ge.target,pe=c[Se].node.clusterId,Ge=c[ne].node.clusterId;(pe===I.id&&Ge!==I.id||Ge===I.id&&pe!==I.id)&&(te=te+(ge[n]||1)),(pe===le&&Ge!==le||Ge===le&&pe!==le)&&(se=se+(ge[n]||1))}),I.sumTot=te,w.sumTot=se}});var b={},x=0;Object.keys(f).forEach(function(C){var M=f[C];if(!M.nodes||!M.nodes.length){delete f[C];return}var w=String(x+1);w!==C&&(M.id=w,M.nodes=M.nodes.map(function(T){return{id:T.id,clusterId:w}}),f[w]=M,b[C]=w,delete f[C],x++)}),o.forEach(function(C){C.clusterId&&b[C.clusterId]&&(C.clusterId=b[C.clusterId])});var _=[],S={};u.forEach(function(C){var M=C.source,w=C.target,T=C[n]||1,I=c[M].node.clusterId,k=c[w].node.clusterId,O=I+"---"+k;if(S[O])S[O].weight+=T,S[O].count++;else{var U={source:I,target:k,weight:T,count:1};S[O]=U,_.push(U)}});var E=[];return Object.keys(f).forEach(function(C){E.push(f[C])}),{clusters:E,clusterEdges:_}},_5=function(){function r(e){this.count=e.length,this.parent={};for(var t=0,n=e;t<n.length;t++){var i=n[t];this.parent[i]=i}}return r.prototype.find=function(e){for(;this.parent[e]!==e;)e=this.parent[e];return e},r.prototype.union=function(e,t){var n=this.find(e),i=this.find(t);n!==i&&(n<i?(this.parent[t]!==t&&this.union(this.parent[t],e),this.parent[t]=this.parent[e]):(this.parent[e]!==e&&this.union(this.parent[e],t),this.parent[e]=this.parent[t]))},r.prototype.connected=function(e,t){return this.find(e)===this.find(t)},r}(),w5=function(e,t){return e-t},S5=function(){function r(e){e===void 0&&(e=w5),this.compareFn=e,this.list=[]}return r.prototype.getLeft=function(e){return 2*e+1},r.prototype.getRight=function(e){return 2*e+2},r.prototype.getParent=function(e){return e===0?null:Math.floor((e-1)/2)},r.prototype.isEmpty=function(){return this.list.length<=0},r.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},r.prototype.delMin=function(){var e=this.top(),t=this.list.pop();return this.list.length>0&&(this.list[0]=t,this.moveDown(0)),e},r.prototype.insert=function(e){if(e!==null){this.list.push(e);var t=this.list.length-1;return this.moveUp(t),!0}return!1},r.prototype.moveUp=function(e){for(var t=this.getParent(e);e&&e>0&&this.compareFn(this.list[t],this.list[e])>0;){var n=this.list[t];this.list[t]=this.list[e],this.list[e]=n,e=t,t=this.getParent(e)}},r.prototype.moveDown=function(e){var t,n=e,i=this.getLeft(e),a=this.getRight(e),o=this.list.length;i!==null&&i<o&&this.compareFn(this.list[n],this.list[i])>0?n=i:a!==null&&a<o&&this.compareFn(this.list[n],this.list[a])>0&&(n=a),e!==n&&(t=[this.list[n],this.list[e]],this.list[e]=t[0],this.list[n]=t[1],this.moveDown(n))},r}(),E5=function(e,t){var n=[],i=e.nodes,a=i===void 0?[]:i,o=e.edges,s=o===void 0?[]:o;if(a.length===0)return n;var u=a[0],l=new Set;l.add(u);var f=function(g,y){return t?g.weight-y.weight:0},c=new S5(f);for(wh(u.id,s).forEach(function(p){c.insert(p)});!c.isEmpty();){var h=c.delMin(),d=h.source,v=h.target;l.has(d)&&l.has(v)||(n.push(h),l.has(d)||(l.add(d),wh(d,s).forEach(function(p){c.insert(p)})),l.has(v)||(l.add(v),wh(v,s).forEach(function(p){c.insert(p)})))}return n},Wx=function(e,t){var n=[],i=e.nodes,a=i===void 0?[]:i,o=e.edges,s=o===void 0?[]:o;if(a.length===0)return n;var u=s.map(function(d){return d});t&&u.sort(function(d,v){return d.weight-v.weight});for(var l=new _5(a.map(function(d){return d.id}));u.length>0;){var f=u.shift(),c=f.source,h=f.target;l.connected(c,h)||(n.push(f),l.union(c,h))}return n},jx=function(e,t,n){var i={prim:E5,kruskal:Wx};return n?i[n](e,t):Wx(e,t)},Xx=function(e,t,n){typeof t!="number"&&(t=1e-6),typeof n!="number"&&(n=.85);for(var i=1,a=0,o=1e3,s=e.nodes,u=s===void 0?[]:s,l=e.edges,f=l===void 0?[]:l,c=u.length,h,d={},v={},p=0;p<c;++p){var g=u[p],y=g.id;d[y]=1/c,v[y]=1/c}for(var m=mo(e);o>0&&i>t;){a=0;for(var p=0;p<c;++p){var g=u[p],y=g.id;if(h=0,m[g.id].inDegree===0)d[y]=0;else{for(var b=Ti(y,f,"source"),x=0;x<b.length;++x){var _=b[x],S=m[_].outDegree;S>0&&(h+=v[_]/S)}d[y]=n*h,a+=d[y]}}a=(1-a)/c,i=0;for(var p=0;p<c;++p){var g=u[p],y=g.id;h=d[y]+a,i+=Math.abs(h-v[y]),v[y]=h}o-=1}return v},C5=-1,Sh=-1,Hx="-1",ja="-1",Yx=-1,qx=function(){function r(e,t,n,i){e===void 0&&(e=C5),t===void 0&&(t=Sh),n===void 0&&(n=Sh),i===void 0&&(i=Hx),this.id=e,this.from=t,this.to=n,this.label=i}return r}(),A5=function(){function r(e,t){e===void 0&&(e=Sh),t===void 0&&(t=ja),this.id=e,this.label=t,this.edges=[],this.edgeMap={}}return r.prototype.addEdge=function(e){this.edges.push(e),this.edgeMap[e.id]=e},r}(),Kx=function(){function r(e,t,n){e===void 0&&(e=Sh),t===void 0&&(t=!0),n===void 0&&(n=!1),this.id=e,this.edgeIdAutoIncrease=t,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=n}return r.prototype.getNodeNum=function(){return this.nodes.length},r.prototype.addNode=function(e,t){if(!this.nodeMap[e]){var n=new A5(e,t);this.nodes.push(n),this.nodeMap[e]=n,this.nodeLabelMap[t]||(this.nodeLabelMap[t]=[]),this.nodeLabelMap[t].push(e)}},r.prototype.addEdge=function(e,t,n,i){if((this.edgeIdAutoIncrease||e===void 0)&&(e=this.counter++),!(this.nodeMap[t]&&this.nodeMap[n]&&this.nodeMap[n].edgeMap[e])){var a=new qx(e,t,n,i);if(this.edges.push(a),this.edgeMap[e]=a,this.nodeMap[t].addEdge(a),this.edgeLabelMap[i]||(this.edgeLabelMap[i]=[]),this.edgeLabelMap[i].push(a),!this.directed){var o=new qx(e,n,t,i);this.nodeMap[n].addEdge(o),this.edgeLabelMap[i].push(o)}}},r}(),ms=function(){function r(e,t,n,i,a){this.fromNode=e,this.toNode=t,this.nodeEdgeNodeLabel={nodeLabel1:n||ja,edgeLabel:i||Hx,nodeLabel2:a||ja}}return r.prototype.equalTo=function(e){return this.fromNode===e.formNode&&this.toNode===e.toNode&&this.nodeEdgeNodeLabel===e.nodeEdgeNodeLabel},r.prototype.notEqualTo=function(e){return!this.equalTo(e)},r}(),Zx=function(){function r(){this.rmpath=[],this.dfsEdgeList=[]}return r.prototype.equalTo=function(e){var t=this.dfsEdgeList.length,n=e.length;if(t!==n)return!1;for(var i=0;i<t;i++)if(this.dfsEdgeList[i]!==e[i])return!1;return!0},r.prototype.notEqualTo=function(e){return!this.equalTo(e)},r.prototype.pushBack=function(e,t,n,i,a){return this.dfsEdgeList.push(new ms(e,t,n,i,a)),this.dfsEdgeList},r.prototype.toGraph=function(e,t){e===void 0&&(e=Yx),t===void 0&&(t=!1);var n=new Kx(e,!0,t);return this.dfsEdgeList.forEach(function(i){var a=i.fromNode,o=i.toNode,s=i.nodeEdgeNodeLabel,u=s.nodeLabel1,l=s.edgeLabel,f=s.nodeLabel2;u!==ja&&n.addNode(a,u),f!==ja&&n.addNode(o,f),n.addEdge(void 0,a,o,l)}),n},r.prototype.buildRmpath=function(){this.rmpath=[];for(var e=void 0,t=this.dfsEdgeList.length,n=t-1;n>=0;n--){var i=this.dfsEdgeList[n],a=i.fromNode,o=i.toNode;a<o&&(e===void 0||o===e)&&(this.rmpath.push(n),e=a)}return this.rmpath},r.prototype.getNodeNum=function(){var e={};return this.dfsEdgeList.forEach(function(t){e[t.fromNode]||(e[t.fromNode]=!0),e[t.toNode]||(e[t.toNode]=!0)}),Object.keys(e).length},r}(),Eh=function(){function r(e){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],!!e){for(;e;){var t=e.edge;this.edges.push(t),this.nodesUsed[t.from]=1,this.nodesUsed[t.to]=1,this.edgesUsed[t.id]=1,e=e.preNode}this.edges=this.edges.reverse()}}return r.prototype.hasNode=function(e){return this.nodesUsed[e.id]===1},r.prototype.hasEdge=function(e){return this.edgesUsed[e.id]===1},r}(),T5=function(){function r(e){var t=e.graphs,n=e.minSupport,i=n===void 0?2:n,a=e.minNodeNum,o=a===void 0?1:a,s=e.maxNodeNum,u=s===void 0?4:s,l=e.top,f=l===void 0?10:l,c=e.directed,h=c===void 0?!1:c,d=e.verbose,v=d===void 0?!1:d;this.graphs=t,this.dfsCode=new Zx,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=i,this.top=f,this.directed=h,this.counter=0,this.maxNodeNum=u,this.minNodeNum=o,this.verbose=v,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}return r.prototype.findForwardRootEdges=function(e,t){var n=this,i=[],a=e.nodeMap;return t.edges.forEach(function(o){(n.directed||t.label<=a[o.to].label)&&i.push(o)}),i},r.prototype.findBackwardEdge=function(e,t,n,i){if(!this.directed&&t===n)return null;for(var a=e.nodeMap,o=a[n.to],s=o.edges,u=s.length,l=0;l<u;l++){var f=s[l];if(!(i.hasEdge(f)||f.to!==t.from)){if(this.directed){if(a[t.from].label<a[n.to].label||a[t.from].label===a[n.to].label&&t.label<=f.label)return f}else if(t.label<f.label||t.label===f.label&&a[t.to].label<=a[n.to].label)return f}}return null},r.prototype.findForwardPureEdges=function(e,t,n,i){for(var a=[],o=t.to,s=e.nodeMap[o].edges,u=s.length,l=0;l<u;l++){var f=s[l],c=e.nodeMap[f.to];n<=c.label&&!i.hasNode(c)&&a.push(f)}return a},r.prototype.findForwardRmpathEdges=function(e,t,n,i){for(var a=[],o=e.nodeMap,s=o[t.to].label,u=o[t.from],l=u.edges,f=l.length,c=0;c<f;c++){var h=l[c],d=o[h.to].label;t.to===h.to||n>d||i.hasNode(o[h.to])||(t.label<h.label||t.label===h.label&&s<=d)&&a.push(h)}return a},r.prototype.getSupport=function(e){var t={};return e.forEach(function(n){t[n.graphId]||(t[n.graphId]=!0)}),Object.keys(t).length},r.prototype.findMinLabel=function(e){var t=void 0;return Object.keys(e).forEach(function(n){var i=e[n],a=i.nodeLabel1,o=i.edgeLabel,s=i.nodeLabel2;if(!t){t={nodeLabel1:a,edgeLabel:o,nodeLabel2:s};return}(a<t.nodeLabel1||a===t.nodeLabel1&&o<t.edgeLabel||a===t.nodeLabel1&&o===t.edgeLabel&&s<t.nodeLabel2)&&(t={nodeLabel1:a,edgeLabel:o,nodeLabel2:s})}),t},r.prototype.isMin=function(){var e=this,t=this.dfsCode;if(this.verbose&&console.log("isMin checking",t),t.dfsEdgeList.length===1)return!0;var n=this.directed,i=t.toGraph(Yx,n),a=i.nodeMap,o=new Zx,s={};i.nodes.forEach(function(c){var h=e.findForwardRootEdges(i,c);h.forEach(function(d){var v=a[d.to],p=c.label+"-"+d.label+"-"+v.label;s[p]||(s[p]={projected:[],nodeLabel1:c.label,edgeLabel:d.label,nodeLabel2:v.label});var g={graphId:i.id,edge:d,preNode:null};s[p].projected.push(g)})});var u=this.findMinLabel(s);o.dfsEdgeList.push(new ms(0,1,u.nodeLabel1,u.edgeLabel,u.nodeLabel2));var l=function c(h){for(var d=o.buildRmpath(),v=o.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,p=o.dfsEdgeList[d[0]].toNode,g={},y=!1,m=0,b=n?-1:0,x=function(K){if(y)return"break";h.forEach(function(le){var he=new Eh(le),te=e.findBackwardEdge(i,he.edges[d[K]],he.edges[d[0]],he);te&&(g[te.label]||(g[te.label]={projected:[],edgeLabel:te.label}),g[te.label].projected.push({graphId:i.id,edge:g,preNode:le}),m=o.dfsEdgeList[d[K]].fromNode,y=!0)})},_=d.length-1;_>b;_--){var S=x(_);if(S==="break")break}if(y){var E=e.findMinLabel(g);o.dfsEdgeList.push(new ms(p,m,ja,E.edgeLabel,ja));var C=o.dfsEdgeList.length-1;return e.dfsCode.dfsEdgeList[C]!==o.dfsEdgeList[C]?!1:c(g[E.edgeLabel].projected)}var M={};y=!1;var w=0;h.forEach(function(q){var K=new Eh(q),le=e.findForwardPureEdges(i,K.edges[d[0]],v,K);le.length>0&&(y=!0,w=p,le.forEach(function(he){var te=he.label+"-"+a[he.to].label;M[te]||(M[te]={projected:[],edgeLabel:he.label,nodeLabel2:a[he.to].label}),M[te].projected.push({graphId:i.id,edge:he,preNode:q})}))});for(var T=d.length,I=function(K){if(y)return"break";var le=d[K];h.forEach(function(he){var te=new Eh(he),se=e.findForwardRmpathEdges(i,te.edges[le],v,te);se.length>0&&(y=!0,w=o.dfsEdgeList[le].fromNode,se.forEach(function(ge){var Se=ge.label+"-"+a[ge.to].label;M[Se]||(M[Se]={projected:[],edgeLabel:ge.label,nodeLabel2:a[ge.to].label}),M[Se].projected.push({graphId:i.id,edge:ge,preNode:he})}))})},_=0;_<T;_++){var k=I(_);if(k==="break")break}if(!y)return!0;var O=e.findMinLabel(M);o.dfsEdgeList.push(new ms(w,p+1,ja,O.edgeLabel,O.nodeLabel2));var U=o.dfsEdgeList.length-1;return t.dfsEdgeList[U]!==o.dfsEdgeList[U]?!1:c(M[O.edgeLabel+"-"+O.nodeLabel2].projected)},f=u.nodeLabel1+"-"+u.edgeLabel+"-"+u.nodeLabel2;return l(s[f].projected)},r.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var e=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push(Cr(e))}},r.prototype.subGraphMining=function(e){var t=this,n=this.getSupport(e);if(!(n<this.minSupport)&&!!this.isMin()){this.report();var i=this.dfsCode.getNodeNum(),a=this.dfsCode.buildRmpath(),o=this.dfsCode.dfsEdgeList[a[0]].toNode,s=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,u={},l={};e.forEach(function(f){for(var c=t.graphs[f.graphId],h=c.nodeMap,d=new Eh(f),v=a.length-1;v>=0;v--){var p=t.findBackwardEdge(c,d.edges[a[v]],d.edges[a[0]],d);if(p){var g=t.dfsCode.dfsEdgeList[a[v]].fromNode+"-"+p.label;l[g]||(l[g]={projected:[],toNodeId:t.dfsCode.dfsEdgeList[a[v]].fromNode,edgeLabel:p.label}),l[g].projected.push({graphId:f.graphId,edge:p,preNode:f})}}if(!(i>=t.maxNodeNum)){var y=t.findForwardPureEdges(c,d.edges[a[0]],s,d);y.forEach(function(b){var x=o+"-"+b.label+"-"+h[b.to].label;u[x]||(u[x]={projected:[],fromNodeId:o,edgeLabel:b.label,nodeLabel2:h[b.to].label}),u[x].projected.push({graphId:f.graphId,edge:b,preNode:f})});for(var m=function(x){var _=t.findForwardRmpathEdges(c,d.edges[a[x]],s,d);_.forEach(function(S){var E=t.dfsCode.dfsEdgeList[a[x]].fromNode+"-"+S.label+"-"+h[S.to].label;u[E]||(u[E]={projected:[],fromNodeId:t.dfsCode.dfsEdgeList[a[x]].fromNode,edgeLabel:S.label,nodeLabel2:h[S.to].label}),u[E].projected.push({graphId:f.graphId,edge:S,preNode:f})})},v=0;v<a.length;v++)m(v)}}),Object.keys(l).forEach(function(f){var c=l[f],h=c.toNodeId,d=c.edgeLabel;t.dfsCode.dfsEdgeList.push(new ms(o,h,"-1",d,"-1")),t.subGraphMining(l[f].projected),t.dfsCode.dfsEdgeList.pop()}),Object.keys(u).forEach(function(f){var c=u[f],h=c.fromNodeId,d=c.edgeLabel,v=c.nodeLabel2;t.dfsCode.dfsEdgeList.push(new ms(h,o+1,ja,d,v)),t.subGraphMining(u[f].projected),t.dfsCode.dfsEdgeList.pop()})}},r.prototype.generate1EdgeFrequentSubGraphs=function(){var e=this.graphs,t=this.directed,n=this.minSupport,i=this.frequentSize1Subgraphs,a={},o={},s={},u={};return Object.keys(e).forEach(function(l){var f=e[l],c=f.nodeMap;f.nodes.forEach(function(h,d){var v=h.label,p=l+"-"+v;if(!s[p]){var g=a[v]||0;g++,a[v]=g}s[p]={graphKey:l,label:v},h.edges.forEach(function(y){var m=v,b=c[y.to].label;if(!t&&m>b){var x=b;b=m,m=x}var _=y.label,S=l+"-"+m+"-"+_+"-"+b,E=m+"-"+_+"-"+b;if(!o[E]){var C=o[E]||0;C++,o[E]=C}u[S]={graphId:l,nodeLabel1:m,edgeLabel:_,nodeLabel2:b}})})}),Object.keys(a).forEach(function(l){var f=a[l];if(!(f<n)){var c={nodes:[],edges:[]};c.nodes.push({id:"0",label:l}),i.push(c)}}),i},r.prototype.run=function(){var e=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var t=this.graphs;this.directed;var n={};Object.keys(t).forEach(function(i){var a=t[i],o=a.nodeMap;a.nodes.forEach(function(s){var u=e.findForwardRootEdges(a,s);u.forEach(function(l){var f=o[l.to],c=s.label+"-"+l.label+"-"+f.label;n[c]||(n[c]={projected:[],nodeLabel1:s.label,edgeLabel:l.label,nodeLabel2:f.label});var h={graphId:i,edge:l,preNode:null};n[c].projected.push(h)})})}),Object.keys(n).forEach(function(i){var a=n[i],o=a.projected,s=a.nodeLabel1,u=a.edgeLabel,l=a.nodeLabel2;e.dfsCode.dfsEdgeList.push(new ms(0,1,s,u,l)),e.subGraphMining(o),e.dfsCode.dfsEdgeList.pop()})}},r}(),M5=function(e,t,n,i){var a={};return Object.keys(e).forEach(function(o,s){var u=e[o],l=new Kx(s,!0,t),f={};u.nodes.forEach(function(c,h){l.addNode(h,c[n]),f[c.id]=h}),u.edges.forEach(function(c,h){var d=f[c.source],v=f[c.target];l.addEdge(-1,d,v,c[i])}),l&&l.getNodeNum()&&(a[l.id]=l)}),a},I5=function(e,t,n){var i=[];return e.forEach(function(a){var o={nodes:[],edges:[]};a.nodes.forEach(function(s){var u;o.nodes.push((u={id:""+s.id},u[t]=s.label,u))}),a.edges.forEach(function(s){var u;o.edges.push((u={source:""+s.from,target:""+s.to},u[n]=s.label,u))}),i.push(o)}),i},Qx="cluster",k5=function(e){var t=e.graphs,n=e.directed,i=n===void 0?!1:n,a=e.nodeLabelProp,o=a===void 0?Qx:a,s=e.edgeLabelProp,u=s===void 0?Qx:s,l=M5(t,i,o,u),f=e.minSupport,c=e.maxNodeNum,h=e.minNodeNum,d=e.verbose,v=e.top,p={graphs:l,minSupport:f,maxNodeNum:c,minNodeNum:h,top:v,verbose:d,directed:i},g=new T5(p);g.run();var y=I5(g.frequentSubgraphs,o,u);return y},Jx=function(e,t,n,i){n===void 0&&(n="cluster"),i===void 0&&(i=2);var a=[],o=e.nodes;return t.forEach(function(s,u){a.push(e_(o,s,u,n,i))}),a},e_=function(e,t,n,i,a){var o=[n],s=[],u={};return t.forEach(function(l,f){if(l<=a&&n!==f){o.push(f),s.push(e[f]);var c=e[f][i];u[c]?(u[c].count++,u[c].dists.push(l)):u[c]={count:1,dists:[l]}}}),Object.keys(u).forEach(function(l){u[l].dists=u[l].dists.sort(function(f,c){return f-c})}),{nodeIdx:n,nodeId:e[n].id,nodeIdxs:o,neighbors:s,neighborNum:o.length-1,nodeLabelCountMap:u}},D5=function(e,t,n,i,a){var o=Math.ceil(n/t),s={},u=0;return i.forEach(function(l,f){for(var c=0,h=0,d=l.nodeIdxs,v=l.neighborNum-1;c<o;){for(var p=d[1+Math.floor(Math.random()*v)],g=0;(s[f+"-"+p]||s[p+"-"+f])&&(p=Math.floor(Math.random()*t),g++,!(g>2*t)););if(g<2*t&&(s[f+"-"+p]={start:f,end:p,distance:a[f][p]},c++,u++,u>=n))return s;if(h++,h>2*t)break}if(c<o){var y=o-c;o=(o+y)/(t-f-1)}}),s},Ch=function(e,t,n,i){var a=n.nodes;return i||(i={}),Object.keys(e).forEach(function(o){var s,u;if(!(i&&i[o])){i[o]={nodes:[],edges:[]};var l=e[o],f=(s=t[l.start])===null||s===void 0?void 0:s.nodeIdxs,c=(u=t[l.end])===null||u===void 0?void 0:u.nodeIdxs;if(!(!f||!c)){var h=new Set(c),d=f.filter(function(m){return h.has(m)});if(!(!d||!d.length)){for(var v={},p=d.length,g=0;g<p;g++){var y=a[d[g]];i[o].nodes.push(y),v[y.id]=!0}n.edges.forEach(function(m){v[m.source]&&v[m.target]&&i[o].edges.push(m)})}}}}),i},Ah=function(e,t,n,i){var a={};e.nodes.forEach(function(s){a[s.id]=s});var o=0;return e.edges.forEach(function(s){var u=a[s.source][n],l=a[s.target][n],f=t==null?void 0:t.nodes[0][n],c=t==null?void 0:t.nodes[1][n],h=t==null?void 0:t.edges[0][i];s[i]===h&&(u===f&&l===c||u===c&&l===f)&&o++}),o},P5=function(e,t,n){for(var i=1/0,a=0,o=function(l){var f=e[l],c=Object.keys(f).sort(function(m,b){return f[m]-f[b]}),h=10,d=[];c.forEach(function(m,b){d[b%h]||(d[b%h]={graphs:[],totalCount:0,aveCount:0}),d[b%h].graphs.push(m),d[b%h].totalCount+=f[m]});var v=0,p=[];d.forEach(function(m){var b=m.totalCount/m.graphs.length;m.aveCount=b,p.push(b);var x=0,_=m.length;m.graphs.forEach(function(S,E){var C=f[S];m.graphs.forEach(function(M,w){E!==w&&(x+=Math.abs(C-f[M]))})}),x/=_*(_-1)/2,v+=x}),v/=d.length;var g=0;p.forEach(function(m,b){p.forEach(function(x,_){b!==_&&(g+=Math.abs(m-x))}),g/=p.length*(p.length-1)/2});var y=g-v;i<y&&(i=y,a=l)},s=0;s<t;s++)o(s);return{structure:n[a],structureCountMap:e[a]}},t_=function(e,t){var n={},i={};return e.forEach(function(a,o){n[a.id]={idx:o,node:a,degree:0,inDegree:0,outDegree:0};var s=a[t];i[s]||(i[s]=[]),i[s].push(a)}),{nodeMap:n,nodeLabelMap:i}},r_=function(e,t,n){var i={},a={};return e.forEach(function(o,s){i[""+Px]={idx:s,edge:o};var u=o[t];a[u]||(a[u]=[]),a[u].push(o);var l=n[o.source];l&&(l.degree++,l.outDegree++);var f=n[o.target];f&&(f.degree++,f.inDegree++)}),{edgeMap:i,edgeLabelMap:a}},n_=function(e,t,n){var i=t.length,a={};return t.forEach(function(o,s){for(var u=n?0:s+1,l=e[s].id,f=u;f<i;f++)if(s!==f){var c=e[f].id,h=o[f];a[l+"-"+c]=h,n||(a[c+"-"+l]=h)}}),a},N5=function(e,t,n,i,a,o,s,u,l,f,c){var h,d=t.id+"-"+n.id;if(f&&f[d])return f[d];var v=c?c[d]:void 0;if(!v){var p=(h={},h[d]={start:i[t.id].idx,end:i[n.id].idx,distance:a},h);c=Ch(p,o,e,c),v=c[d]}return Ah(v,s,u,l)},i_=function(e,t,n,i){var a,o,s,u=(a=e[t])===null||a===void 0?void 0:a.degree,l=(o=e[t])===null||o===void 0?void 0:o.inDegree,f=(s=e[t])===null||s===void 0?void 0:s.outDegree;return e[t]===void 0&&(u=1/0,l=1/0,f=1/0,i[t].forEach(function(c){var h=n[c.id].degree;u>h&&(u=h);var d=n[c.id].inDegree;l>d&&(l=d);var v=n[c.id].outDegree;f>v&&(f=v)}),e[t]={degree:u,inDegree:l,outDegree:f}),{minPatternNodeLabelDegree:u,minPatternNodeLabelInDegree:l,minPatternNodeLabelOutDegree:f}},a_=function(e,t,n,i,a,o,s){if(n===void 0&&(n=!1),o===void 0&&(o="cluster"),s===void 0&&(s="cluster"),!(!e||!e.nodes)){var u=e.nodes.length;if(!!u){var l=Kl(e,n),f=Kl(t,n),c=n_(e.nodes,l,n),h=n_(t.nodes,f,n),d=t_(e.nodes,o),v=d.nodeMap,p=d.nodeLabelMap,g=t_(t.nodes,o),y=g.nodeMap,m=g.nodeLabelMap;r_(e.edges,s,v);var b=r_(t.edges,s,y).edgeLabelMap;a||(a=Math.max.apply(Math,xa(xa([],f[0]),[2]))),i||(i=a);var x=Jx(e,l,o,i),_=Jx(t,f,o,i),S=Math.min(100,u*(u-1)/2),E=D5(i,u,S,_,l),C=Ch(E,x,e),M=10,w=1,T=1,I=4,k={graphs:C,nodeLabelProp:o,edgeLabelProp:s,minSupport:w,minNodeNum:T,maxNodeNum:I,directed:n},O=k5(k).slice(0,M),U=O.length,q=[];O.forEach(function(Me,ct){q[ct]={},Object.keys(C).forEach(function(Ye){var nt=C[Ye],Et=Ah(nt,Me,o,s);q[ct][Ye]=Et})});var K=P5(q,U,O),le=K.structure,he=K.structureCountMap,te=t.nodes[0],se=te[o],ge=p[se],Se={},ne={},pe={},Ge={},ke={},rt={};Object.keys(m).forEach(function(Me,ct){ke[Me]=[],n&&(rt[Me]=[]);var Ye=m[Me],nt={};Ye.forEach(function(we){var Oe=h[te.id+"-"+we.id];if(Oe&&ke[Me].push(Oe),nt[te.id+"-"+we.id]={start:0,end:y[we.id].idx,distance:Oe},n){var qe=h[we.id+"-"+te.id];qe&&rt[Me].push(qe)}}),ke[Me]=ke[Me].sort(function(we,Oe){return we-Oe}),n&&(rt[Me]=rt[Me].sort(function(we,Oe){return we-Oe})),ne=Ch(nt,_,t,ne);var Et=[];if(Object.keys(nt).forEach(function(we){if(pe[we]){Et.push(pe[we]);return}var Oe=ne[we];pe[we]=Ah(Oe,le,o,s),Et.push(pe[we])}),Et=Et.sort(function(we,Oe){return Oe-we}),Ge[te.id+"-"+Me]=Et,Me!==se)for(var D=ge.length,ee=function(Oe){var qe=ge[Oe],Jt=x[v[qe.id].idx],gt=Jt.nodeLabelCountMap[Me],Ct=m[Me].length;if(!gt||gt.count<Ct)return ge.splice(Oe,1),"continue";for(var kt=!1,Gt=0;Gt<Ct;Gt++)if(gt.dists[Gt]>ke[Me][Gt]){kt=!0;break}if(kt)return ge.splice(Oe,1),"continue";var Zt={};Jt.neighbors.forEach(function(jt){var Sr=c[qe.id+"-"+jt.id];Zt[qe.id+"-"+jt.id]={start:v[qe.id].idx,end:v[jt.id].idx,distance:Sr}}),C=Ch(Zt,x,e,C);var ar=[];Object.keys(Zt).forEach(function(jt){if(he[jt]){ar.push(he[jt]);return}var Sr=C[jt];he[jt]=Ah(Sr,le,o,s),ar.push(he[jt])}),ar=ar.sort(function(jt,Sr){return Sr-jt});for(var ei=!1,Gt=0;Gt<Ct;Gt++)if(ar[Gt]<Et[Gt]){ei=!0;break}if(ei)return ge.splice(Oe,1),"continue"},be=D-1;be>=0;be--)ee(be)});var $e=[];ge.forEach(function(Me){for(var ct=v[Me.id].idx,Ye=e_(e.nodes,l[ct],ct,o,a),nt=Ye.neighbors,Et=nt.length,D=!1,ee=Et-1;ee>=0;ee--){if(nt.length+1<t.nodes.length){D=!0;return}var be=nt[ee],we=be[o];if(!m[we]||!m[we].length){nt.splice(ee,1);continue}if(!ke[we]||!ke[we].length){nt.splice(ee,1);continue}var Oe=Me.id+"-"+be.id,qe=c[Oe],Jt=ke[we].length-1,gt=ke[we][Jt];if(qe>gt){nt.splice(ee,1);continue}if(n){var Ct=be.id+"-"+Me.id,kt=c[Ct];Jt=rt[we].length-1;var Gt=rt[we][Jt];if(kt>Gt){nt.splice(ee,1);continue}}var Zt=he[Oe]?he[Oe]:N5(e,Me,be,v,qe,x,le,o,s,he,C),ar=te.id+"-"+we,ei=Ge[ar][Ge[ar].length-1];if(Zt<ei){nt.splice(ee,1);continue}var jt=i_(Se,we,y,m),Sr=jt.minPatternNodeLabelDegree;if(jt.minPatternNodeLabelInDegree,jt.minPatternNodeLabelOutDegree,v[be.id].degree<Sr){nt.splice(ee,1);continue}}D||$e.push({nodes:[Me].concat(nt)})});var ut=ql(t,te.id,!1).length,pt={};n?(Object.keys(ut).forEach(function(Me){var ct=y[Me].node[o];pt[ct]?pt[ct].push(ut[Me]):pt[ct]=[ut[Me]]}),Object.keys(pt).forEach(function(Me){pt[Me].sort(function(ct,Ye){return ct-Ye})})):pt=ke;for(var qt=$e.length,F=function(ct){var Ye=$e[ct],nt=Ye.nodes[0],Et={},D={};Ye.nodes.forEach(function(cr,Rr){D[cr.id]={idx:Rr,node:cr,degree:0,inDegree:0,outDegree:0};var Ur=cr[o];Et[Ur]?Et[Ur]++:Et[Ur]=1});var ee=[],be={};e.edges.forEach(function(cr){D[cr.source]&&D[cr.target]&&(ee.push(cr),be[cr[s]]?be[cr[s]]++:be[cr[s]]=1,D[cr.source].degree++,D[cr.target].degree++,D[cr.source].outDegree++,D[cr.target].inDegree++)});for(var we=Object.keys(b).length,Oe=!1,qe=0;qe<we;qe++){var Jt=Object.keys(b)[qe];if(!be[Jt]||be[Jt]<b[Jt].length){Oe=!0;break}}if(Oe)return $e.splice(ct,1),"continue";var gt=ee.length;if(gt<t.edges.length)return $e.splice(ct,1),"break";for(var Ct=!1,kt=function(Rr){var Ur=ee[Rr],Or=Ur[s],An=b[Or];if(!An||!An.length)return be[Or]--,An&&be[Or]<An.length?(Ct=!0,"break"):(ee.splice(Rr,1),D[Ur.source].degree--,D[Ur.target].degree--,D[Ur.source].outDegree--,D[Ur.target].inDegree--,"continue");var Br=D[Ur.source].node[o],Ei=D[Ur.target].node[o],fo=!1;if(An.forEach(function(Js){var eu=y[Js.source].node,tu=y[Js.target].node;eu[o]===Br&&tu[o]===Ei&&(fo=!0),!n&&eu[o]===Ei&&tu[o]===Br&&(fo=!0)}),!fo)return be[Or]--,An&&be[Or]<An.length?(Ct=!0,"break"):(ee.splice(Rr,1),D[Ur.source].degree--,D[Ur.target].degree--,D[Ur.source].outDegree--,D[Ur.target].inDegree--,"continue")},qe=gt-1;qe>=0;qe--){var Gt=kt(qe);if(Gt==="break")break}if(Ct)return $e.splice(ct,1),"continue";Ye.edges=ee;var Zt=ql(Ye,Ye.nodes[0].id,!1).length;if(Object.keys(Zt).reverse().forEach(function(cr){if(!(cr===Ye.nodes[0].id||Ct)){if(Zt[cr]===1/0){var Rr=D[cr].node[o];if(Et[Rr]--,Et[Rr]<m[Rr].length){Ct=!0;return}var Ur=Ye.nodes.indexOf(D[cr].node);Ye.nodes.splice(Ur,1),D[cr]=void 0;return}var Or=v[cr].node[o];if(!pt[Or]||!pt[Or].length||Zt[cr]>pt[Or][pt[Or].length-1]){var Rr=D[cr].node[o];if(Et[Rr]--,Et[Rr]<m[Rr].length){Ct=!0;return}var Ur=Ye.nodes.indexOf(D[cr].node);Ye.nodes.splice(Ur,1),D[cr]=void 0}}}),Ct)return $e.splice(ct,1),"continue";for(var ar=!0,ei=0;ar&&!Ct;){ar=!1;var jt=n?D[nt.id].degree<y[te.id].degree||D[nt.id].inDegree<y[te.id].inDegree||D[nt.id].outDegree<y[te.id].outDegree:D[nt.id].degree<y[te.id].degree;if(jt){Ct=!0;break}if(Et[nt[o]]<m[nt[o]].length){Ct=!0;break}for(var Sr=Ye.nodes.length,Ir=Sr-1;Ir>=0;Ir--){var or=Ye.nodes[Ir],$r=D[or.id].degree,Vt=D[or.id].inDegree,kr=D[or.id].outDegree,Mr=or[o],fr=i_(Se,Mr,y,m),Er=fr.minPatternNodeLabelDegree,ur=fr.minPatternNodeLabelInDegree,bn=fr.minPatternNodeLabelOutDegree,On=n?$r<Er||Vt<ur||kr<bn:$r<Er;if(On){if(Et[or[o]]--,Et[or[o]]<m[or[o]].length){Ct=!0;break}Ye.nodes.splice(Ir,1),D[or.id]=void 0,ar=!0}}if(Ct||!ar&&ei!==0)break;gt=ee.length;for(var Vr=gt-1;Vr>=0;Vr--){var Rn=ee[Vr];if(!D[Rn.source]||!D[Rn.target]){ee.splice(Vr,1);var Cn=Rn[s];if(be[Cn]--,D[Rn.source]&&(D[Rn.source].degree--,D[Rn.source].outDegree--),D[Rn.target]&&(D[Rn.target].degree--,D[Rn.target].inDegree--),b[Cn]&&be[Cn]<b[Cn].length){Ct=!0;break}ar=!0}}ei++}if(Ct||Ct||Ye.nodes.length<t.nodes.length||ee.length<t.edges.length)return $e.splice(ct,1),"continue"},Z=qt-1;Z>=0;Z--){var V=F(Z);if(V==="break")break}for(var Fe=$e.length,at=function(ct){var Ye=$e[ct],nt={};Ye.edges.forEach(function(ee){var be=ee.source+"-"+ee.target+"-"+ee.label;nt[be]?nt[be]++:nt[be]=1});for(var Et=function(be){var we=$e[be],Oe={};we.edges.forEach(function(Jt){var gt=Jt.source+"-"+Jt.target+"-"+Jt.label;Oe[gt]?Oe[gt]++:Oe[gt]=1});var qe=!0;Object.keys(Oe).length!==Object.keys(nt).length?qe=!1:Object.keys(nt).forEach(function(Jt){Oe[Jt]!==nt[Jt]&&(qe=!1)}),qe&&$e.splice(be,1)},D=Fe-1;D>ct;D--)Et(D);Fe=$e.length},Z=0;Z<=Fe-1;Z++)at(Z);return $e}}},Th=function(){function r(e){e===void 0&&(e=10),this.linkedList=new Dx,this.maxStep=e}return Object.defineProperty(r.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),r.prototype.isEmpty=function(){return!this.linkedList.head},r.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},r.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},r.prototype.push=function(e){this.linkedList.prepend(e),this.length>this.maxStep&&this.linkedList.deleteTail()},r.prototype.pop=function(){var e=this.linkedList.deleteHead();return e?e.value:null},r.prototype.toArray=function(){return this.linkedList.toArray().map(function(e){return e.value})},r.prototype.clear=function(){for(;!this.isEmpty();)this.pop()},r}(),o_=bg,L5={getAdjMatrix:ys,breadthFirstSearch:Nx,connectedComponent:yg,getDegree:mo,getInDegree:Ox,getOutDegree:Rx,detectCycle:bg,detectDirectedCycle:o_,detectAllCycles:Gx,detectAllDirectedCycle:_g,detectAllUndirectedCycle:xg,depthFirstSearch:mg,dijkstra:ql,findAllPath:zx,findShortestPath:Ux,floydWarshall:Kl,labelPropagation:$x,louvain:Vx,minimumSpanningTree:jx,pageRank:Xx,getNeighbors:Ti,Stack:Th,GADDI:a_},O5=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",getAdjMatrix:ys,breadthFirstSearch:Nx,connectedComponent:yg,getDegree:mo,getInDegree:Ox,getOutDegree:Rx,detectCycle:bg,detectDirectedCycle:o_,detectAllCycles:Gx,detectAllDirectedCycle:_g,detectAllUndirectedCycle:xg,depthFirstSearch:mg,dijkstra:ql,findAllPath:zx,findShortestPath:Ux,floydWarshall:Kl,labelPropagation:$x,louvain:Vx,minimumSpanningTree:jx,pageRank:Xx,getNeighbors:Ti,Stack:Th,GADDI:a_,default:L5}),Mh=_h,R5=function(e){return function(t,n){return t[e]-n[e]}},s_=function(e,t,n){return e>=t&&e<=n},Ih=function(e,t,n,i){var a=1e-4,o={x:n.x-e.x,y:n.y-e.y},s={x:t.x-e.x,y:t.y-e.y},u={x:i.x-n.x,y:i.y-n.y},l=s.x*u.y-s.y*u.x,f=l*l,c=1/l,h=s.x*s.x+s.y*s.y,d=u.x*u.x+u.y*u.y;if(f>a*h*d){var v=(o.x*u.y-o.y*u.x)*c,p=(o.x*s.y-o.y*s.x)*c;return!s_(v,0,1)||!s_(p,0,1)?null:{x:e.x+v*s.x,y:e.y+v*s.y}}return null},u_=function(e,t){var n=e.x,i=e.y,a=e.width,o=e.height,s=n+a/2,u=i+o/2,l=[],f={x:s,y:u};l.push({x:n,y:i}),l.push({x:n+a,y:i}),l.push({x:n+a,y:i+o}),l.push({x:n,y:i+o}),l.push({x:n,y:i});for(var c=null,h=1;h<l.length&&(c=Ih(l[h-1],l[h],f,t),!c);h++);return c},l_=function(e,t){var n=e.x,i=e.y,a=e.r,o=t.x,s=t.y,u=o-n,l=s-i,f=Math.sqrt(u*u+l*l);if(f<a)return null;var c=Math.sign(u),h=Math.sign(l),d=Math.atan(l/u);return{x:n+Math.abs(a*Math.cos(d))*c,y:i+Math.abs(a*Math.sin(d))*h}},f_=function(e,t){var n=e.rx,i=e.ry,a=e.x,o=e.y,s=t.x-a,u=t.y-o,l=Math.atan2(u/i,s/n);return l<0&&(l+=2*Math.PI),{x:a+n*Math.cos(l),y:o+i*Math.sin(l)}},kh=function(e,t,n){n===void 0&&(n=1);var i=[e.x,e.y,n];return(!t||isNaN(t[0]))&&(t=[1,0,0,0,1,0,0,0,1]),Mu(i,i,t),{x:i[0],y:i[1]}},c_=function(e,t,n){n===void 0&&(n=1),(!t||isNaN(t[0]))&&(t=[1,0,0,0,1,0,0,0,1]);var i=ug([1,0,0,0,1,0,0,0,1],t);i||(i=[1,0,0,0,1,0,0,0,1]);var a=[e.x,e.y,n];return Mu(a,a,i),{x:a[0],y:a[1]}},wg=function(e,t,n){var i=e.x-t.x,a=e.y-t.y,o=e.x-n.x,s=e.y-n.y,u=(e.x*e.x-t.x*t.x-t.y*t.y+e.y*e.y)/2,l=(e.x*e.x-n.x*n.x-n.y*n.y+e.y*e.y)/2,f=a*o-i*s;return{x:-(s*u-a*l)/f,y:-(i*l-o*u)/f}},Dh=function(e,t){var n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)},B5=function(e,t){var n=[];return e.forEach(function(i){var a=[];i.forEach(function(o){a.push(o*t)}),n.push(a)}),n},G5=function(e){for(var t=[],n=e.length,i=0;i<n;i+=1){t[i]=[];for(var a=0;a<n;a+=1)i===a?t[i][a]=0:e[i][a]===0||!e[i][a]?t[i][a]=1/0:t[i][a]=e[i][a]}for(var o=0;o<n;o+=1)for(var i=0;i<n;i+=1)for(var a=0;a<n;a+=1)t[i][a]>t[i][o]+t[o][a]&&(t[i][a]=t[i][o]+t[o][a]);return t},F5=function(e,t){var n=e.nodes,i=e.edges,a=[],o={};if(!n)throw new Error("invalid nodes data!");return n&&n.forEach(function(s,u){o[s.id]=u;var l=[];a.push(l)}),i&&i.forEach(function(s){var u=s.source,l=s.target,f=o[u],c=o[l];a[f][c]=1,t||(a[c][f]=1)}),a},h_=function(e,t){e.translate(t.x,t.y)},d_=function(e,t,n,i){i===void 0&&(i={duration:500});var a=e.getMatrix();a||(a=[1,0,0,0,1,0,0,0,1]);var o=e.getCanvasBBox(),s=t.x-o.minX,u=t.y-o.minY;if(n){var l=s*a[0],f=u*a[4],c=0,h=0,d=0,v=0;e.animate(function(g){return d=l*g,v=f*g,a=Mh(a,[["t",d-c,v-h]]),c=d,h=v,{matrix:a}},i)}else{var p=Mh(a,[["t",s,u]]);e.setMatrix(p)}},U5=function(e,t){var n=e.getMatrix();n||(n=[1,0,0,0,1,0,0,0,1]);var i=t;At(t)||(i=[t,t]),At(t)&&t.length===1&&(i=[t[0],t[0]]),n=Mh(n,[["s",i[0],i[1]]]),e.setMatrix(n)},z5=function(e,t){var n=e.getMatrix();n||(n=[1,0,0,0,1,0,0,0,1]),n=Mh(n,[["r",t]]),e.setMatrix(n)},$5=function(e,t,n){for(var i=[],a=0;a<e;a++)i[a]=0;return n.forEach(function(o){o.source&&(i[t[o.source]]+=1),o.target&&(i[t[o.target]]+=1)}),i};function V5(r,e,t){return(t[0]-r[0])*(e[1]-r[1])==(e[0]-r[0])*(t[1]-r[1])&&Math.min(r[0],e[0])<=t[0]&&t[0]<=Math.max(r[0],e[0])&&Math.min(r[1],e[1])<=t[1]&&t[1]<=Math.max(r[1],e[1])}var Zl=function(e,t,n){var i=!1,a=e.length,o=1e-6;function s(c){return Math.abs(c)<o?0:c<0?-1:1}if(a<=2)return!1;for(var u=0;u<a;u++){var l=e[u],f=e[(u+1)%a];if(V5(l,f,[t,n]))return!0;s(l[1]-n)>0!=s(f[1]-n)>0&&s(t-(n-l[1])*(l[0]-f[0])/(l[1]-f[1])-l[0])<0&&(i=!i)}return i},v_=function(e,t){return!(t.minX>e.maxX||t.maxX<e.minX||t.minY>e.maxY||t.maxY<e.minY)},W5=function(e,t){var n=!1;return xe(e,function(i){if(Ih(i.from,i.to,t.from,t.to))return n=!0,!1}),n},p_=function(e,t){var n=function(h){var d=h.map(function(p){return p[0]}),v=h.map(function(p){return p[1]});return{minX:Math.min.apply(null,d),maxX:Math.max.apply(null,d),minY:Math.min.apply(null,v),maxY:Math.max.apply(null,v)}},i=function(h){for(var d=[],v=h.length,p=0;p<v-1;p++){var g=h[p],y=h[p+1];d.push({from:{x:g[0],y:g[1]},to:{x:y[0],y:y[1]}})}if(d.length>1){var m=h[0],b=h[v-1];d.push({from:{x:b[0],y:b[1]},to:{x:m[0],y:m[1]}})}return d};if(e.length<2||t.length<2)return!1;var a=n(e),o=n(t);if(!v_(a,o))return!1;var s=!1;if(xe(t,function(c){if(Zl(e,c[0],c[1]))return s=!0,!1}),s||(xe(e,function(c){if(Zl(t,c[0],c[1]))return s=!0,!1}),s))return!0;var u=i(e),l=i(t),f=!1;return xe(l,function(c){if(W5(u,c))return f=!0,!1}),f},bs=function(){function r(e,t,n,i){this.x1=e,this.y1=t,this.x2=n,this.y2=i}return r.prototype.getBBox=function(){var e=Math.min(this.x1,this.x2),t=Math.min(this.y1,this.y2),n=Math.max(this.x1,this.x2),i=Math.max(this.y1,this.y2),a={x:e,y:t,minX:e,minY:t,maxX:n,maxY:i,width:n-e,height:i-t};return a},r}(),Sg=function(e,t){var n={top:[e.minX,e.minY,e.maxX,e.minY],left:[e.minX,e.minY,e.minX,e.maxY],bottom:[e.minX,e.maxY,e.maxX,e.maxY],right:[e.maxX,e.minY,e.maxX,e.maxY]};return n[t]},j5=function(e,t){var n=(t.x2-t.x1)*(e.y1-t.y1)-(t.y2-t.y1)*(e.x1-t.x1),i=(e.x2-e.x1)*(e.y1-t.y1)-(e.y2-e.y1)*(e.x1-t.x1),a=(t.y2-t.y1)*(e.x2-e.x1)-(t.x2-t.x1)*(e.y2-e.y1);if(a){var o=n/a,s=i/a;if(o>=0&&o<=1&&s>=0&&s<=1)return o}return Number.POSITIVE_INFINITY},g_=function(e,t){for(var n=["top","left","bottom","right"],i=e.getBBox(),a=0,o=[],s=0;s<4;s++){var u=Sg(i,n[s]),l=u[0],f=u[1],c=u[2],h=u[3];o[s]=Ih({x:t.x1,y:t.y1},{x:t.x2,y:t.y2},{x:l,y:f},{x:c,y:h}),o[s]&&(a+=1)}return[o,a]},Eg=function(e,t){for(var n=["top","left","bottom","right"],i=e.getBBox(),a=Number.POSITIVE_INFINITY,o=0,s=0;s<4;s++){var u=Sg(i,n[s]),l=u[0],f=u[1],c=u[2],h=u[3],d=j5(t,new bs(l,f,c,h));d=Math.abs(d-.5),d>=0&&d<=1&&(o+=1,a=d<a?d:a)}return o===0?-1:a},y_=function(e){var t=0,n=0;if(e.length>0){for(var i=0,a=e;i<a.length;i++){var o=a[i];t+=o.x,n+=o.y}t/=e.length,n/=e.length}return{x:t,y:n}},Ph=function(e,t){return Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)},m_=function(e,t){var n=t.x1,i=t.y1,a=t.x2-n,o=t.y2-i,s=e.x-n,u=e.y-i,l=s*a+u*o,f;l<=0?f=0:(s=a-s,u=o-u,l=s*a+u*o,l<=0?f=0:f=l*l/(a*a+o*o));var c=s*s+u*u-f;return c<0&&(c=0),c},Cg=function(e,t,n){return n===void 0&&(n=.001),Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)<Math.pow(n,2)},b_=function(e,t){var n=e.x<t.x,i=e.x>t.x+t.width,a=e.y>t.y+t.height,o=e.y<t.y,s=n||i||a||o;if(!s)return 0;if(a&&!n&&!i)return Math.pow(t.y+t.height-e.y,2);if(o&&!n&&!i)return Math.pow(e.y-t.y,2);if(n&&!a&&!o)return Math.pow(t.x-e.x,2);if(i&&!a&&!o)return Math.pow(t.x+t.width-e.x,2);var u=Math.min(Math.abs(t.x-e.x),Math.abs(t.x+t.width-e.x)),l=Math.min(Math.abs(t.y-e.y),Math.abs(t.y+t.height-e.y));return u*u+l*l},X5=function(e,t){var n=e[0],i=e[1],a=e[2],o=e[3],s=t.x,u=t.y,l=[a-n,o-i];if(Ix(l,[0,0]))return NaN;var f=[-l[1],l[0]];gs(f,f);var c=[s-n,u-i];return Math.abs(Mx(c,f))},H5=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",compare:R5,getLineIntersect:Ih,getRectIntersectByPoint:u_,getCircleIntersectByPoint:l_,getEllipseIntersectByPoint:f_,applyMatrix:kh,invertMatrix:c_,getCircleCenterByPoints:wg,distance:Dh,scaleMatrix:B5,floydWarshall:G5,getAdjMatrix:F5,translate:h_,move:d_,scale:U5,rotate:z5,getDegree:$5,isPointInPolygon:Zl,intersectBBox:v_,isPolygonsIntersect:p_,Line:bs,getBBoxBoundLine:Sg,itemIntersectByLine:g_,fractionToLine:Eg,getPointsCenter:y_,squareDist:Ph,pointLineSquareDist:m_,isPointsOverlap:Cg,pointRectSquareDist:b_,pointLineDistance:X5}),bo="rgb(95, 149, 255)",Y5="rgb(255, 255, 255)",x_="rgb(0, 0, 0)",Ag="rgb(247, 250, 255)",__="rgb(239, 244, 255)",Nh="rgb(253, 253, 253)",w_="rgb(250, 250, 250)",Lh="rgb(224, 224, 224)",S_="rgb(234, 234, 234)",q5="rgb(245, 245, 245)",K5="rgb(191, 213, 255)",E_="#4572d9",Z5="rgb(223, 234, 255)",vr={mainStroke:bo,mainFill:__,activeStroke:bo,activeFill:Ag,inactiveStroke:K5,inactiveFill:Ag,selectedStroke:bo,selectedFill:Y5,highlightStroke:E_,highlightFill:Z5,disableStroke:Lh,disableFill:w_,edgeMainStroke:Lh,edgeActiveStroke:bo,edgeInactiveStroke:S_,edgeSelectedStroke:bo,edgeHighlightStroke:bo,edgeDisableStroke:q5,comboMainStroke:Lh,comboMainFill:Nh,comboActiveStroke:bo,comboActiveFill:Ag,comboInactiveStroke:Lh,comboInactiveFill:Nh,comboSelectedStroke:bo,comboSelectedFill:Nh,comboHighlightStroke:E_,comboHighlightFill:Nh,comboDisableStroke:S_,comboDisableFill:w_},Tt={version:"0.3.11",rootContainerClassName:"root-container",nodeContainerClassName:"node-container",edgeContainerClassName:"edge-container",comboContainerClassName:"combo-container",delegateContainerClassName:"delegate-container",defaultLoopPosition:"top",nodeLabel:{style:{fill:"#000",fontSize:12,textAlign:"center",textBaseline:"middle"},offset:4},defaultNode:{type:"circle",style:{lineWidth:1,stroke:vr.mainStroke,fill:__},size:20,color:vr.mainStroke,linkPoints:{size:8,lineWidth:1,fill:vr.activeFill,stroke:vr.activeStroke}},nodeStateStyles:{active:{fill:vr.activeFill,stroke:vr.activeStroke,lineWidth:2,shadowColor:vr.mainStroke,shadowBlur:10},selected:{fill:vr.selectedFill,stroke:vr.selectedStroke,lineWidth:4,shadowColor:vr.selectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{fill:vr.highlightFill,stroke:vr.highlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{fill:vr.inactiveFill,stroke:vr.inactiveStroke,lineWidth:1},disable:{fill:vr.disableFill,stroke:vr.disableStroke,lineWidth:1}},edgeLabel:{style:{fill:x_,textAlign:"center",textBaseline:"middle",fontSize:12}},defaultEdge:{type:"line",size:1,style:{stroke:vr.edgeMainStroke,lineAppendWidth:2},color:vr.edgeMainStroke},edgeStateStyles:{active:{stroke:vr.edgeActiveStroke,lineWidth:1},selected:{stroke:vr.edgeSelectedStroke,lineWidth:2,shadowColor:vr.edgeSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:vr.edgeHighlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{stroke:vr.edgeInactiveStroke,lineWidth:1},disable:{stroke:vr.edgeDisableStroke,lineWidth:1}},comboLabel:{style:{fill:x_,textBaseline:"middle",fontSize:12},refY:10,refX:10},defaultCombo:{type:"circle",style:{fill:vr.comboMainFill,lineWidth:1,stroke:vr.comboMainStroke,r:5,width:20,height:10},size:[20,5],color:vr.comboMainStroke,padding:[25,20,15,20]},comboStateStyles:{active:{stroke:vr.comboActiveStroke,lineWidth:1,fill:vr.comboActiveFill},selected:{stroke:vr.comboSelectedStroke,lineWidth:2,fill:vr.comboSelectedFill,shadowColor:vr.comboSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:vr.comboHighlightStroke,lineWidth:2,fill:vr.comboHighlightFill,"text-shape":{fontWeight:500}},inactive:{stroke:vr.comboInactiveStroke,fill:vr.comboInactiveFill,lineWidth:1},disable:{stroke:vr.comboDisableStroke,fill:vr.comboDisableFill,lineWidth:1}},delegateStyle:{fill:"#F3F9FF",fillOpacity:.5,stroke:"#1890FF",strokeOpacity:.9,lineDash:[5,5]}},Q5={" ":.3329986572265625,a:.5589996337890625,A:.6569992065429687,b:.58599853515625,B:.6769989013671875,c:.5469985961914062,C:.7279998779296875,d:.58599853515625,D:.705999755859375,e:.554998779296875,E:.63699951171875,f:.37299957275390627,F:.5769989013671875,g:.5909988403320312,G:.7479995727539063,h:.555999755859375,H:.7199996948242188,i:.255999755859375,I:.23699951171875,j:.26699981689453123,J:.5169998168945312,k:.5289993286132812,K:.6899993896484375,l:.23499908447265624,L:.5879989624023437,m:.854998779296875,M:.8819992065429687,n:.5589996337890625,N:.7189987182617188,o:.58599853515625,O:.7669998168945312,p:.58599853515625,P:.6419998168945312,q:.58599853515625,Q:.7669998168945312,r:.3649993896484375,R:.6759994506835938,s:.504998779296875,S:.6319992065429687,t:.354998779296875,T:.6189987182617187,u:.5599990844726562,U:.7139999389648437,v:.48199920654296874,V:.6389999389648438,w:.754998779296875,W:.929998779296875,x:.5089996337890625,X:.63699951171875,y:.4959991455078125,Y:.66199951171875,z:.48699951171875,Z:.6239990234375,"0":.6,"1":.40099945068359377,"2":.6,"3":.6,"4":.6,"5":.6,"6":.6,"7":.5469985961914062,"8":.6,"9":.6,"[":.3329986572265625,"]":.3329986572265625,",":.26399993896484375,".":.26399993896484375,";":.26399993896484375,":":.26399993896484375,"{":.3329986572265625,"}":.3329986572265625,"\\":.5,"|":.19499969482421875,"=":.604998779296875,"+":.604998779296875,"-":.604998779296875,_:.5,"`":.3329986572265625," ~":.8329986572265625,"!":.3329986572265625,"@":.8579986572265625,"#":.6,$:.6,"%":.9699996948242188,"^":.517999267578125,"&":.7259994506835937,"*":.505999755859375,"(":.3329986572265625,")":.3329986572265625,"<":.604998779296875,">":.604998779296875,"/":.5,"?":.53699951171875},Sa=Math.PI,Tg=Math.sin,Mg=Math.cos,$n=Tg(Sa/8),Vn=Mg(Sa/8),Oh=function(e,t){var n=e.getBBox(),i={x:n.minX,y:n.minY},a={x:n.maxX,y:n.maxY};if(t){var o=t.getMatrix();o||(o=[1,0,0,0,1,0,0,0,1]),i=kh(i,o),a=kh(a,o)}var s=i.x,u=i.y,l=a.x,f=a.y;return{x:s,y:u,minX:s,minY:u,maxX:l,maxY:f,width:l-s,height:f-u}},C_=function(e){var t=e.sourceNode||e.targetNode,n=t.get("group"),i=n.getMatrix();i||(i=[1,0,0,0,1,0,0,0,1]);var a=t.getKeyShape(),o=a.getBBox(),s=e.loopCfg||{},u=s.dist||Math.max(o.width,o.height)*2,l=s.position||Tt.defaultLoopPosition,f=[i[6],i[7]],c=[e.startPoint.x,e.startPoint.y],h=[e.endPoint.x,e.endPoint.y],d=o.height/2,v=o.height/2,p=d*$n,g=d*Vn,y=v*$n,m=v*Vn;if(c[0]===h[0]&&c[1]===h[1]){switch(l){case"top":c=[f[0]-p,f[1]-g],h=[f[0]+y,f[1]-m];break;case"top-right":d=o.height/2,v=o.width/2,p=d*$n,g=d*Vn,y=v*$n,m=v*Vn,c=[f[0]+p,f[1]-g],h=[f[0]+m,f[1]-y];break;case"right":d=o.width/2,v=o.width/2,p=d*$n,g=d*Vn,y=v*$n,m=v*Vn,c=[f[0]+g,f[1]-p],h=[f[0]+m,f[1]+y];break;case"bottom-right":d=o.width/2,v=o.height/2,p=d*$n,g=d*Vn,y=v*$n,m=v*Vn,c=[f[0]+g,f[1]+p],h=[f[0]+y,f[1]+m];break;case"bottom":d=o.height/2,v=o.height/2,p=d*$n,g=d*Vn,y=v*$n,m=v*Vn,c=[f[0]+p,f[1]+g],h=[f[0]-y,f[1]+m];break;case"bottom-left":d=o.height/2,v=o.width/2,p=d*$n,g=d*Vn,y=v*$n,m=v*Vn,c=[f[0]-p,f[1]+g],h=[f[0]-m,f[1]+y];break;case"left":d=o.width/2,v=o.width/2,p=d*$n,g=d*Vn,y=v*$n,m=v*Vn,c=[f[0]-g,f[1]+p],h=[f[0]-m,f[1]-y];break;case"top-left":d=o.width/2,v=o.height/2,p=d*$n,g=d*Vn,y=v*$n,m=v*Vn,c=[f[0]-g,f[1]-p],h=[f[0]-y,f[1]-m];break;default:d=o.width/2,v=o.width/2,p=d*$n,g=d*Vn,y=v*$n,m=v*Vn,c=[f[0]-p,f[1]-g],h=[f[0]+y,f[1]-m]}if(s.clockwise===!1){var b=[c[0],c[1]];c=[h[0],h[1]],h=[b[0],b[1]]}}var x=[c[0]-f[0],c[1]-f[1]],_=(d+u)/d,S=(v+u)/v;s.clockwise===!1&&(_=(v+u)/v,S=(d+u)/d);var E=ci([0,0],x,_),C=[f[0]+E[0],f[1]+E[1]],M=[h[0]-f[0],h[1]-f[1]],w=ci([0,0],M,S),T=[f[0]+w[0],f[1]+w[1]];return e.startPoint={x:c[0],y:c[1]},e.endPoint={x:h[0],y:h[1]},e.controlPoints=[{x:C[0],y:C[1]},{x:T[0],y:T[1]}],e},Ig=function(e,t,n,i,a){var o=1e-4,s=[],u=e==null?void 0:e.getPoint(t);if(!u)return{x:0,y:0,angle:0};if(t<o)s=e.getStartTangent().reverse();else if(t>1-o)s=e.getEndTangent();else{var l=e==null?void 0:e.getPoint(t+o);s.push([u.x,u.y]),s.push([l.x,l.y])}var f=Math.atan2(s[1][1]-s[0][1],s[1][0]-s[0][0]);if(f<0&&(f+=Sa*2),n&&(u.x+=Mg(f)*n,u.y+=Tg(f)*n),i){var c=f-Sa/2;f>1/2*Sa&&f<3*1/2*Sa&&(c-=Sa),u.x+=Mg(c)*i,u.y+=Tg(c)*i}var h={x:u.x,y:u.y,angle:f};return a?(f>.5*Sa&&f<1.5*Sa&&(f-=Sa),L({rotate:f},h)):h},A_=function r(e,t){if(t(e)===!1)return!1;if(e&&e.children){for(var n=e.children.length-1;n>=0;n--)if(!r(e.children[n],t))return!1}return!0},J5=function r(e,t){if(e&&e.children){for(var n=e.children.length-1;n>=0;n--)if(!r(e.children[n],t))return}return t(e)!==!1},Mi=function(e,t){typeof t=="function"&&A_(e,t)},xo=function(e,t){typeof t=="function"&&J5(e,t)},T_=function(e,t){return t*(Q5[e]||1)},M_=function(e,t){var n=0,i=new RegExp("[\u4E00-\u9FA5]+");return e.split("").forEach(function(a){i.test(a)?n+=t:n+=T_(a,t)}),[n,t]},kg=function(e,t){var n=[],i={},a={};e.forEach(function(u){a[u.id]=u}),e.forEach(function(u,l){var f=Cr(u);f.itemType="combo",f.children=void 0,f.parentId===f.id?(console.warn("The parentId for combo "+f.id+" can not be the same as the combo's id"),delete f.parentId):f.parentId&&!a[f.parentId]&&(console.warn("The parent combo for combo "+f.id+" does not exist!"),delete f.parentId);var c=i[f.id];if(c){if(f.children=c.children,i[f.id]=f,c=f,!c.parentId){n.push(c);return}var h=i[c.parentId];if(h)h.children?h.children.push(f):h.children=[f];else{var d={id:c.parentId,children:[c]};i[c.parentId]=d,i[f.id]=f}return}if(Xe(u.parentId)){var v=i[u.parentId];if(v)v.children?v.children.push(f):v.children=[f],i[f.id]=f;else{var p={id:u.parentId,children:[f]};i[p.id]=p,i[f.id]=f}}else n.push(f),i[f.id]=f});var o={};(t||[]).forEach(function(u){o[u.id]=u;var l=i[u.comboId];if(l){var f={id:u.id,comboId:u.comboId};l.children?l.children.push(f):l.children=[f],f.itemType="node",i[u.id]=f}});var s=0;return n.forEach(function(u){u.depth=s+10,A_(u,function(l){var f,c=i[l.id].itemType;c==="node"?f=i[l.comboId]:f=i[l.parentId],f&&c==="node"?l.depth=s+1:l.depth=s+10,s<l.depth&&(s=l.depth);var h=o[l.id];return h&&(h.depth=l.depth),!0})}),n},Dg=function(e,t,n){var i=e,a,o={root:{children:e}},s=!1,u="root";(e||[]).forEach(function(d){if(!s){if(d.id===t){a=d,d.itemType==="combo"?a.parentId=n:a.comboId=n,s=!0;return}Mi(d,function(v){return o[v.id]={children:v.children},i=o[v.parentId||v.comboId||"root"].children,v&&(v.removed||t===v.id)&&i?(u=v.parentId||v.comboId||"root",a=v,v.itemType==="combo"?a.parentId=n:a.comboId=n,s=!0,!1):!0})}}),i=o[u].children;var l=i?i.indexOf(a):-1;if(l>-1&&i.splice(l,1),s||(a={id:t,itemType:"node",comboId:n},o[t]={children:void 0}),t){var f=!1;if(n){var c=0;(e||[]).forEach(function(d){f||Mi(d,function(v){return n===v.id?(f=!0,v.children?v.children.push(a):v.children=[a],c=v.depth,a.itemType==="node"?a.depth=c+2:a.depth=c+1,!1):!0})})}else(!n||!f)&&a.itemType!=="node"&&e.push(a);var h=a.depth;Mi(a,function(d){return d.itemType==="node"?h+=2:h+=1,d.depth=h,!0})}return e},Ql=function(e,t){var n={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,x:void 0,y:void 0,width:void 0,height:void 0,centerX:void 0,centerY:void 0};return!e||e.length===0||(e.forEach(function(i){var a=t.findById(i.id);if(!(!a||!a.isVisible())){a.set("bboxCanvasCache",void 0);var o=a.getCanvasBBox();o.x&&n.minX>o.minX&&(n.minX=o.minX),o.y&&n.minY>o.minY&&(n.minY=o.minY),o.x&&n.maxX<o.maxX&&(n.maxX=o.maxX),o.y&&n.maxY<o.maxY&&(n.maxY=o.maxY)}}),n.x=(n.minX+n.maxX)/2,n.y=(n.minY+n.maxY)/2,n.width=n.maxX-n.minX,n.height=n.maxY-n.minY,n.centerX=(n.minX+n.maxX)/2,n.centerY=(n.minY+n.maxY)/2,Object.keys(n).forEach(function(i){(n[i]===1/0||n[i]===-1/0)&&(n[i]=void 0)})),n},eG=function(e){var t=Lt(e.x)||Lt(e.y)||e.type||e.anchorPoints||e.size;return e.style&&(t=t||Lt(e.style.r)||Lt(e.style.width)||Lt(e.style.height)||Lt(e.style.rx)||Lt(e.style.ry)),t},Rh=function(e){var t={};return Object.keys(e).forEach(function(n){var i=e[n];if(ri(i)){var a={};Object.keys(i).forEach(function(o){var s=i[o];o==="img"&&!Xe(s)||(a[o]=Cr(s))}),t[n]=a}else t[n]=Cr(i)}),t},tG=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",getBBox:Oh,getLoopCfgs:C_,getLabelPosition:Ig,traverseTree:Mi,traverseTreeUp:xo,getLetterWidth:T_,getTextSize:M_,plainCombosToTrees:kg,reconstructTree:Dg,getComboBBox:Ql,shouldRefreshEdge:eG,cloneBesidesImg:Rh}),I_=function(e){if(!e)return console.error("G6 Error Tips: the data must be defined"),!1;var t=e.nodes,n=e.edges,i=e.combos,a=i===void 0?[]:i;if(!t&&!n){var o=!0;return Mi(e,function(h){return Xe(h.id)?!0:(o=!1,!1)}),o}var s=(t||[]).find(function(h){return!Xe(h.id)});if(s)return console.warn("G6 Warning Tips: missing 'id' property, or %c"+s.id+"%c is not a string.","font-size: 20px; color: red;",""),!1;var u=(t||[]).map(function(h){return h.id}),l=a.map(function(h){return h.id}),f=xa(xa([],u),l),c=(n||[]).find(function(h){return!f.includes(h.source)||!f.includes(h.target)});return c?(console.warn("G6 Warning Tips: The source %c"+c.source+"%c or the target %c"+c.target+"%c of the edge do not exist in the nodes or combos.","font-size: 20px; color: red;","","font-size: 20px; color: red;",""),!1):!0},rG=function(e,t){if(e==="node"||e==="combo"){if(t.id&&!Xe(t.id))return console.warn("G6 Warning Tips: missing 'id' property, or the 'id' %c"+t.id+"%c is not a string.","font-size: 20px; color: red;",""),!1}else if(e==="edge"&&(!t.source||!t.target))return console.warn("G6 Warning Tips: missing 'source' or 'target' for the edge."),!1;return!0},nG=function(){function r(e){this.graph=e,this.destroyed=!1,this.modes=e.get("modes")||{default:[]},this.formatModes(),this.mode=e.get("defaultMode")||"default",this.currentBehaves=[],this.setMode(this.mode)}return r.prototype.formatModes=function(){var e=this.modes;xe(e,function(t){xe(t,function(n,i){Xe(n)&&(t[i]={type:n})})})},r.prototype.setBehaviors=function(e){var t=this.graph,n=this.modes[e],i=[],a;xe(n||[],function(o){var s=gx.getBehavior(o.type||o);!s||(a=new s(o),a&&(a.bind(t),i.push(a)))}),this.currentBehaves=i},r.mergeBehaviors=function(e,t){return xe(t,function(n){e.indexOf(n)<0&&(Xe(n)&&(n={type:n}),e.push(n))}),e},r.filterBehaviors=function(e,t){var n=[];return e.forEach(function(i){var a="";Xe(i)?a=i:a=i.type,t.indexOf(a)<0&&n.push(i)}),n},r.prototype.setMode=function(e){var t=this,n=t.modes,i=t.graph,a=e,o=n[a];!o||(i.emit("beforemodechange",{mode:e}),xe(this.currentBehaves,function(s){s.delegate&&s.delegate.remove(),s.unbind(i)}),this.setBehaviors(a),i.emit("aftermodechange",{mode:e}),this.mode=e)},r.prototype.getMode=function(){return this.mode},r.prototype.manipulateBehaviors=function(e,t,n){var i=this,a;if(At(e)?a=e:a=[e],At(t))return xe(t,function(s){i.modes[s]?n?i.modes[s]=r.mergeBehaviors(i.modes[s]||[],a):i.modes[s]=r.filterBehaviors(i.modes[s]||[],a):n&&(i.modes[s]=a)}),this;var o=t;return t||(o=this.mode),this.modes[o]||n&&(this.modes[o]=a),n?this.modes[o]=r.mergeBehaviors(this.modes[o]||[],a):this.modes[o]=r.filterBehaviors(this.modes[o]||[],a),this.formatModes(),this.setMode(this.mode),this},r.prototype.updateBehavior=function(e,t,n){Xe(e)&&(e={type:e});var i=[];if(!n||n===this.mode||n==="default"){if(i=this.currentBehaves,!i||!i.length)return console.warn("Update behavior failed! There is no behaviors in this mode on the graph."),this;for(var a=i.length,o=0;o<a;o++){var s=i[o];if(s.type===e.type)return s.updateCfg(t),this;o===a-1&&console.warn("Update behavior failed! There is no such behavior in the mode")}}else{if(i=this.modes[n],!i||!i.length)return console.warn("Update behavior failed! There is no behaviors in this mode on the graph."),this;for(var u=i.length,o=0;o<u;o++){var s=i[o];if(s.type===e.type||s===e.type)return s===e.type&&(s={type:s}),Object.assign(s,t),i[o]=s,this;o===u-1&&console.warn("Update behavior failed! There is no such behavior in the mode")}}return this},r.prototype.destroy=function(){this.graph=null,this.modes=null,this.currentBehaves=null,this.destroyed=!0},r}(),Jl=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,iG=new RegExp("([a-z])["+Jl+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+Jl+"]*,?["+Jl+"]*)+)","ig"),aG=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+Jl+"]*,?["+Jl+"]*","ig"),ku=function(r){if(!r)return null;if(At(r))return r;var e={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},t=[];return String(r).replace(iG,function(n,i,a){var o=[],s=i.toLowerCase();if(a.replace(aG,function(u,l){l&&o.push(+l)}),s==="m"&&o.length>2&&(t.push([i].concat(o.splice(0,2))),s="l",i=i==="m"?"l":"L"),s==="o"&&o.length===1&&t.push([i,o[0]]),s==="r")t.push([i].concat(o));else for(;o.length>=e[s]&&(t.push([i].concat(o.splice(0,e[s]))),!!e[s]););return r}),t},Pg=function(r,e){for(var t=[],n=0,i=r.length;i-2*!e>n;n+=2){var a=[{x:+r[n-2],y:+r[n-1]},{x:+r[n],y:+r[n+1]},{x:+r[n+2],y:+r[n+3]},{x:+r[n+4],y:+r[n+5]}];e?n?i-4===n?a[3]={x:+r[0],y:+r[1]}:i-2===n&&(a[2]={x:+r[0],y:+r[1]},a[3]={x:+r[2],y:+r[3]}):a[0]={x:+r[i-2],y:+r[i-1]}:i-4===n?a[3]=a[2]:n||(a[0]={x:+r[n],y:+r[n+1]}),t.push(["C",(-a[0].x+6*a[1].x+a[2].x)/6,(-a[0].y+6*a[1].y+a[2].y)/6,(a[1].x+6*a[2].x-a[3].x)/6,(a[1].y+6*a[2].y-a[3].y)/6,a[2].x,a[2].y])}return t},Bh=function(r,e,t,n,i){var a=[];if(i===null&&n===null&&(n=t),r=+r,e=+e,t=+t,n=+n,i!==null){var o=Math.PI/180,s=r+t*Math.cos(-n*o),u=r+t*Math.cos(-i*o),l=e+t*Math.sin(-n*o),f=e+t*Math.sin(-i*o);a=[["M",s,l],["A",t,t,0,+(i-n>180),0,u,f]]}else a=[["M",r,e],["m",0,-n],["a",t,n,0,1,1,0,2*n],["a",t,n,0,1,1,0,-2*n],["z"]];return a},Ng=function(r){if(r=ku(r),!r||!r.length)return[["M",0,0]];var e=[],t=0,n=0,i=0,a=0,o=0,s,u;r[0][0]==="M"&&(t=+r[0][1],n=+r[0][2],i=t,a=n,o++,e[0]=["M",t,n]);for(var l=r.length===3&&r[0][0]==="M"&&r[1][0].toUpperCase()==="R"&&r[2][0].toUpperCase()==="Z",f=void 0,c=void 0,h=o,d=r.length;h<d;h++){if(e.push(f=[]),c=r[h],s=c[0],s!==s.toUpperCase())switch(f[0]=s.toUpperCase(),f[0]){case"A":f[1]=c[1],f[2]=c[2],f[3]=c[3],f[4]=c[4],f[5]=c[5],f[6]=+c[6]+t,f[7]=+c[7]+n;break;case"V":f[1]=+c[1]+n;break;case"H":f[1]=+c[1]+t;break;case"R":u=[t,n].concat(c.slice(1));for(var v=2,p=u.length;v<p;v++)u[v]=+u[v]+t,u[++v]=+u[v]+n;e.pop(),e=e.concat(Pg(u,l));break;case"O":e.pop(),u=Bh(t,n,c[1],c[2]),u.push(u[0]),e=e.concat(u);break;case"U":e.pop(),e=e.concat(Bh(t,n,c[1],c[2],c[3])),f=["U"].concat(e[e.length-1].slice(-2));break;case"M":i=+c[1]+t,a=+c[2]+n;break;default:for(var v=1,p=c.length;v<p;v++)f[v]=+c[v]+(v%2?t:n)}else if(s==="R")u=[t,n].concat(c.slice(1)),e.pop(),e=e.concat(Pg(u,l)),f=["R"].concat(c.slice(-2));else if(s==="O")e.pop(),u=Bh(t,n,c[1],c[2]),u.push(u[0]),e=e.concat(u);else if(s==="U")e.pop(),e=e.concat(Bh(t,n,c[1],c[2],c[3])),f=["U"].concat(e[e.length-1].slice(-2));else for(var g=0,y=c.length;g<y;g++)f[g]=c[g];if(s=s.toUpperCase(),s!=="O")switch(f[0]){case"Z":t=+i,n=+a;break;case"H":t=f[1];break;case"V":n=f[1];break;case"M":i=f[f.length-2],a=f[f.length-1];break;default:t=f[f.length-2],n=f[f.length-1]}}return e},Gh=function(r,e,t,n){return[r,e,t,n,t,n]},k_=function(r,e,t,n,i,a){var o=1/3,s=2/3;return[o*r+s*t,o*e+s*n,o*i+s*t,o*a+s*n,i,a]},D_=function(r,e,t,n,i,a,o,s,u,l){t===n&&(t+=1);var f=Math.PI*120/180,c=Math.PI/180*(+i||0),h=[],d,v,p,g,y,m=function(ke,rt,$e){var ut=ke*Math.cos($e)-rt*Math.sin($e),pt=ke*Math.sin($e)+rt*Math.cos($e);return{x:ut,y:pt}};if(l)v=l[0],p=l[1],g=l[2],y=l[3];else{d=m(r,e,-c),r=d.x,e=d.y,d=m(s,u,-c),s=d.x,u=d.y,r===s&&e===u&&(s+=1,u+=1);var b=(r-s)/2,x=(e-u)/2,_=b*b/(t*t)+x*x/(n*n);_>1&&(_=Math.sqrt(_),t=_*t,n=_*n);var S=t*t,E=n*n,C=(a===o?-1:1)*Math.sqrt(Math.abs((S*E-S*x*x-E*b*b)/(S*x*x+E*b*b)));g=C*t*x/n+(r+s)/2,y=C*-n*b/t+(e+u)/2,v=Math.asin(((e-y)/n).toFixed(9)),p=Math.asin(((u-y)/n).toFixed(9)),v=r<g?Math.PI-v:v,p=s<g?Math.PI-p:p,v<0&&(v=Math.PI*2+v),p<0&&(p=Math.PI*2+p),o&&v>p&&(v=v-Math.PI*2),!o&&p>v&&(p=p-Math.PI*2)}var M=p-v;if(Math.abs(M)>f){var w=p,T=s,I=u;p=v+f*(o&&p>v?1:-1),s=g+t*Math.cos(p),u=y+n*Math.sin(p),h=D_(s,u,t,n,i,0,o,T,I,[p,w,g,y])}M=p-v;var k=Math.cos(v),O=Math.sin(v),U=Math.cos(p),q=Math.sin(p),K=Math.tan(M/4),le=4/3*t*K,he=4/3*n*K,te=[r,e],se=[r+le*O,e-he*k],ge=[s+le*q,u-he*U],Se=[s,u];if(se[0]=2*te[0]-se[0],se[1]=2*te[1]-se[1],l)return[se,ge,Se].concat(h);h=[se,ge,Se].concat(h).join().split(",");for(var ne=[],pe=0,Ge=h.length;pe<Ge;pe++)ne[pe]=pe%2?m(h[pe-1],h[pe],c).y:m(h[pe],h[pe+1],c).x;return ne},Lg=function(r,e){var t=Ng(r),n=e&&Ng(e),i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o=[],s=[],u="",l="",f,c=function(b,x,_){var S,E;if(!b)return["C",x.x,x.y,x.x,x.y,x.x,x.y];switch(!(b[0]in{T:1,Q:1})&&(x.qx=x.qy=null),b[0]){case"M":x.X=b[1],x.Y=b[2];break;case"A":b=["C"].concat(D_.apply(0,[x.x,x.y].concat(b.slice(1))));break;case"S":_==="C"||_==="S"?(S=x.x*2-x.bx,E=x.y*2-x.by):(S=x.x,E=x.y),b=["C",S,E].concat(b.slice(1));break;case"T":_==="Q"||_==="T"?(x.qx=x.x*2-x.qx,x.qy=x.y*2-x.qy):(x.qx=x.x,x.qy=x.y),b=["C"].concat(k_(x.x,x.y,x.qx,x.qy,b[1],b[2]));break;case"Q":x.qx=b[1],x.qy=b[2],b=["C"].concat(k_(x.x,x.y,b[1],b[2],b[3],b[4]));break;case"L":b=["C"].concat(Gh(x.x,x.y,b[1],b[2]));break;case"H":b=["C"].concat(Gh(x.x,x.y,b[1],x.y));break;case"V":b=["C"].concat(Gh(x.x,x.y,x.x,b[1]));break;case"Z":b=["C"].concat(Gh(x.x,x.y,x.X,x.Y));break}return b},h=function(b,x){if(b[x].length>7){b[x].shift();for(var _=b[x];_.length;)o[x]="A",n&&(s[x]="A"),b.splice(x++,0,["C"].concat(_.splice(0,6)));b.splice(x,1),f=Math.max(t.length,n&&n.length||0)}},d=function(b,x,_,S,E){b&&x&&b[E][0]==="M"&&x[E][0]!=="M"&&(x.splice(E,0,["M",S.x,S.y]),_.bx=0,_.by=0,_.x=b[E][1],_.y=b[E][2],f=Math.max(t.length,n&&n.length||0))};f=Math.max(t.length,n&&n.length||0);for(var v=0;v<f;v++){t[v]&&(u=t[v][0]),u!=="C"&&(o[v]=u,v&&(l=o[v-1])),t[v]=c(t[v],i,l),o[v]!=="A"&&u==="C"&&(o[v]="C"),h(t,v),n&&(n[v]&&(u=n[v][0]),u!=="C"&&(s[v]=u,v&&(l=s[v-1])),n[v]=c(n[v],a,l),s[v]!=="A"&&u==="C"&&(s[v]="C"),h(n,v)),d(t,n,i,a,v),d(n,t,a,i,v);var p=t[v],g=n&&n[v],y=p.length,m=n&&g.length;i.x=p[y-2],i.y=p[y-1],i.bx=parseFloat(p[y-4])||i.x,i.by=parseFloat(p[y-3])||i.y,a.bx=n&&(parseFloat(g[m-4])||a.x),a.by=n&&(parseFloat(g[m-3])||a.y),a.x=n&&g[m-2],a.y=n&&g[m-1]}return n?[t,n]:t},oG=/,?([a-z]),?/gi,P_=function(r){return r.join(",").replace(oG,"$1")},N_=function(r,e,t,n,i){var a=-3*e+9*t-9*n+3*i,o=r*a+6*e-12*t+6*n;return r*o-3*e+3*t},L_=function(r,e,t,n,i,a,o,s,u){u===null&&(u=1),u=u>1?1:u<0?0:u;for(var l=u/2,f=12,c=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],h=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],d=0,v=0;v<f;v++){var p=l*c[v]+l,g=N_(p,r,t,i,o),y=N_(p,e,n,a,s),m=g*g+y*y;d+=h[v]*Math.sqrt(m)}return l*d},sG=function(r,e,t,n,i,a,o,s){for(var u=[],l=[[],[]],f,c,h,d,v=0;v<2;++v){if(v===0?(c=6*r-12*t+6*i,f=-3*r+9*t-9*i+3*o,h=3*t-3*r):(c=6*e-12*n+6*a,f=-3*e+9*n-9*a+3*s,h=3*n-3*e),Math.abs(f)<1e-12){if(Math.abs(c)<1e-12)continue;d=-h/c,d>0&&d<1&&u.push(d);continue}var p=c*c-4*h*f,g=Math.sqrt(p);if(!(p<0)){var y=(-c+g)/(2*f);y>0&&y<1&&u.push(y);var m=(-c-g)/(2*f);m>0&&m<1&&u.push(m)}}for(var b=u.length,x=b,_;b--;)d=u[b],_=1-d,l[0][b]=_*_*_*r+3*_*_*d*t+3*_*d*d*i+d*d*d*o,l[1][b]=_*_*_*e+3*_*_*d*n+3*_*d*d*a+d*d*d*s;return l[0][x]=r,l[1][x]=e,l[0][x+1]=o,l[1][x+1]=s,l[0].length=l[1].length=x+2,{min:{x:Math.min.apply(0,l[0]),y:Math.min.apply(0,l[1])},max:{x:Math.max.apply(0,l[0]),y:Math.max.apply(0,l[1])}}},uG=function(r,e,t,n,i,a,o,s){if(!(Math.max(r,t)<Math.min(i,o)||Math.min(r,t)>Math.max(i,o)||Math.max(e,n)<Math.min(a,s)||Math.min(e,n)>Math.max(a,s))){var u=(r*n-e*t)*(i-o)-(r-t)*(i*s-a*o),l=(r*n-e*t)*(a-s)-(e-n)*(i*s-a*o),f=(r-t)*(a-s)-(e-n)*(i-o);if(!!f){var c=u/f,h=l/f,d=+c.toFixed(2),v=+h.toFixed(2);if(!(d<+Math.min(r,t).toFixed(2)||d>+Math.max(r,t).toFixed(2)||d<+Math.min(i,o).toFixed(2)||d>+Math.max(i,o).toFixed(2)||v<+Math.min(e,n).toFixed(2)||v>+Math.max(e,n).toFixed(2)||v<+Math.min(a,s).toFixed(2)||v>+Math.max(a,s).toFixed(2)))return{x:c,y:h}}}},_o=function(r,e,t){return e>=r.x&&e<=r.x+r.width&&t>=r.y&&t<=r.y+r.height},O_=function(r,e,t,n,i){if(i)return[["M",+r+ +i,e],["l",t-i*2,0],["a",i,i,0,0,1,i,i],["l",0,n-i*2],["a",i,i,0,0,1,-i,i],["l",i*2-t,0],["a",i,i,0,0,1,-i,-i],["l",0,i*2-n],["a",i,i,0,0,1,i,-i],["z"]];var a=[["M",r,e],["l",t,0],["l",0,n],["l",-t,0],["z"]];return a.parsePathArray=P_,a},Og=function(r,e,t,n){return r===null&&(r=e=t=n=0),e===null&&(e=r.y,t=r.width,n=r.height,r=r.x),{x:r,y:e,width:t,w:t,height:n,h:n,x2:r+t,y2:e+n,cx:r+t/2,cy:e+n/2,r1:Math.min(t,n)/2,r2:Math.max(t,n)/2,r0:Math.sqrt(t*t+n*n)/2,path:O_(r,e,t,n),vb:[r,e,t,n].join(" ")}},lG=function(r,e){return r=Og(r),e=Og(e),_o(e,r.x,r.y)||_o(e,r.x2,r.y)||_o(e,r.x,r.y2)||_o(e,r.x2,r.y2)||_o(r,e.x,e.y)||_o(r,e.x2,e.y)||_o(r,e.x,e.y2)||_o(r,e.x2,e.y2)||(r.x<e.x2&&r.x>e.x||e.x<r.x2&&e.x>r.x)&&(r.y<e.y2&&r.y>e.y||e.y<r.y2&&e.y>r.y)},R_=function(r,e,t,n,i,a,o,s){At(r)||(r=[r,e,t,n,i,a,o,s]);var u=sG.apply(null,r);return Og(u.min.x,u.min.y,u.max.x-u.min.x,u.max.y-u.min.y)},B_=function(r,e,t,n,i,a,o,s,u){var l=1-u,f=Math.pow(l,3),c=Math.pow(l,2),h=u*u,d=h*u,v=f*r+c*3*u*t+l*3*u*u*i+d*o,p=f*e+c*3*u*n+l*3*u*u*a+d*s,g=r+2*u*(t-r)+h*(i-2*t+r),y=e+2*u*(n-e)+h*(a-2*n+e),m=t+2*u*(i-t)+h*(o-2*i+t),b=n+2*u*(a-n)+h*(s-2*a+n),x=l*r+u*t,_=l*e+u*n,S=l*i+u*o,E=l*a+u*s,C=90-Math.atan2(g-m,y-b)*180/Math.PI;return{x:v,y:p,m:{x:g,y},n:{x:m,y:b},start:{x,y:_},end:{x:S,y:E},alpha:C}},fG=function(r,e,t){var n=R_(r),i=R_(e);if(!lG(n,i))return t?0:[];for(var a=L_.apply(0,r),o=L_.apply(0,e),s=~~(a/8),u=~~(o/8),l=[],f=[],c={},h=t?0:[],d=0;d<s+1;d++){var v=B_.apply(0,r.concat(d/s));l.push({x:v.x,y:v.y,t:d/s})}for(var d=0;d<u+1;d++){var v=B_.apply(0,e.concat(d/u));f.push({x:v.x,y:v.y,t:d/u})}for(var d=0;d<s;d++)for(var p=0;p<u;p++){var g=l[d],y=l[d+1],m=f[p],b=f[p+1],x=Math.abs(y.x-g.x)<.001?"y":"x",_=Math.abs(b.x-m.x)<.001?"y":"x",S=uG(g.x,g.y,y.x,y.y,m.x,m.y,b.x,b.y);if(S){if(c[S.x.toFixed(4)]===S.y.toFixed(4))continue;c[S.x.toFixed(4)]=S.y.toFixed(4);var E=g.t+Math.abs((S[x]-g[x])/(y[x]-g[x]))*(y.t-g.t),C=m.t+Math.abs((S[_]-m[_])/(b[_]-m[_]))*(b.t-m.t);E>=0&&E<=1&&C>=0&&C<=1&&(t?h+=1:h.push({x:S.x,y:S.y,t1:E,t2:C}))}}return h},cG=function(r,e,t){r=Lg(r),e=Lg(e);for(var n,i,a,o,s,u,l,f,c,h,d=t?0:[],v=0,p=r.length;v<p;v++){var g=r[v];if(g[0]==="M")n=s=g[1],i=u=g[2];else{g[0]==="C"?(c=[n,i].concat(g.slice(1)),n=c[6],i=c[7]):(c=[n,i,n,i,s,u,s,u],n=s,i=u);for(var y=0,m=e.length;y<m;y++){var b=e[y];if(b[0]==="M")a=l=b[1],o=f=b[2];else{b[0]==="C"?(h=[a,o].concat(b.slice(1)),a=h[6],o=h[7]):(h=[a,o,a,o,l,f,l,f],a=l,o=f);var x=fG(c,h,t);if(t)d+=x;else{for(var _=0,S=x.length;_<S;_++)x[_].segment1=v,x[_].segment2=y,x[_].bez1=c,x[_].bez2=h;d=d.concat(x)}}}}}return d},hG=function(r,e){return cG(r,e)};function dG(r,e){var t=[],n=[];function i(a,o){if(a.length===1)t.push(a[0]),n.push(a[0]);else{for(var s=[],u=0;u<a.length-1;u++)u===0&&t.push(a[0]),u===a.length-2&&n.push(a[u+1]),s[u]=[(1-o)*a[u][0]+o*a[u+1][0],(1-o)*a[u][1]+o*a[u+1][1]];i(s,o)}}return r.length&&i(r,e),{left:t,right:n.reverse()}}function vG(r,e,t){var n=[[r[1],r[2]]];t=t||2;var i=[];e[0]==="A"?(n.push(e[6]),n.push(e[7])):e[0]==="C"?(n.push([e[1],e[2]]),n.push([e[3],e[4]]),n.push([e[5],e[6]])):e[0]==="S"||e[0]==="Q"?(n.push([e[1],e[2]]),n.push([e[3],e[4]])):n.push([e[1],e[2]]);for(var a=n,o=1/t,s=0;s<t-1;s++){var u=o/(1-o*s),l=dG(a,u);i.push(l.left),a=l.right}i.push(a);var f=i.map(function(c){var h=[];return c.length===4&&(h.push("C"),h=h.concat(c[2])),c.length>=3&&(c.length===3&&h.push("Q"),h=h.concat(c[1])),c.length===2&&h.push("L"),h=h.concat(c[c.length-1]),h});return f}var pG=function(r,e,t){if(t===1)return[[].concat(r)];var n=[];if(e[0]==="L"||e[0]==="C"||e[0]==="Q")n=n.concat(vG(r,e,t));else{var i=[].concat(r);i[0]==="M"&&(i[0]="L");for(var a=0;a<=t-1;a++)n.push(i)}return n},gG=function(r,e){if(r.length===1)return r;var t=r.length-1,n=e.length-1,i=t/n,a=[];if(r.length===1&&r[0][0]==="M"){for(var o=0;o<n-t;o++)r.push(r[0]);return r}for(var o=0;o<n;o++){var s=Math.floor(i*o);a[s]=(a[s]||0)+1}var u=a.reduce(function(l,f,c){return c===t?l.concat(r[t]):l.concat(pG(r[c],r[c+1],f))},[]);return u.unshift(r[0]),(e[n]==="Z"||e[n]==="z")&&u.push("Z"),u},yG=function(r,e){if(r.length!==e.length)return!1;var t=!0;return xe(r,function(n,i){if(n!==e[i])return t=!1,!1}),t};function mG(r,e,t){var n=null,i=t;return e<i&&(i=e,n="add"),r<i&&(i=r,n="del"),{type:n,min:i}}var bG=function(r,e){var t=r.length,n=e.length,i,a,o=0;if(t===0||n===0)return null;for(var s=[],u=0;u<=t;u++)s[u]=[],s[u][0]={min:u};for(var l=0;l<=n;l++)s[0][l]={min:l};for(var u=1;u<=t;u++){i=r[u-1];for(var l=1;l<=n;l++){a=e[l-1],yG(i,a)?o=0:o=1;var f=s[u-1][l].min+1,c=s[u][l-1].min+1,h=s[u-1][l-1].min+o;s[u][l]=mG(f,c,h)}}return s},G_=function(r,e){var t=bG(r,e),n=r.length,i=e.length,a=[],o=1,s=1;if(t[n][i].min!==n){for(var u=1;u<=n;u++){var l=t[u][u].min;s=u;for(var f=o;f<=i;f++)t[u][f].min<l&&(l=t[u][f].min,s=f);o=s,t[u][o].type&&a.push({index:u-1,type:t[u][o].type})}for(var u=a.length-1;u>=0;u--)o=a[u].index,a[u].type==="add"?r.splice(o,0,[].concat(r[o])):r.splice(o,1)}n=r.length;var c=i-n;if(n<i)for(var u=0;u<c;u++)r[n-1][0]==="z"||r[n-1][0]==="Z"?r.splice(n-2,0,r[n-2]):r.push(r[n-1]),n+=1;return r};function Rg(r,e,t){for(var n=[].concat(r),i,a=1/(t+1),o=F_(e)[0],s=1;s<=t;s++)a*=s,i=Math.floor(r.length*a),i===0?n.unshift([o[0]*a+r[i][0]*(1-a),o[1]*a+r[i][1]*(1-a)]):n.splice(i,0,[o[0]*a+r[i][0]*(1-a),o[1]*a+r[i][1]*(1-a)]);return n}function F_(r){var e=[];switch(r[0]){case"M":e.push([r[1],r[2]]);break;case"L":e.push([r[1],r[2]]);break;case"A":e.push([r[6],r[7]]);break;case"Q":e.push([r[3],r[4]]),e.push([r[1],r[2]]);break;case"T":e.push([r[1],r[2]]);break;case"C":e.push([r[5],r[6]]),e.push([r[1],r[2]]),e.push([r[3],r[4]]);break;case"S":e.push([r[3],r[4]]),e.push([r[1],r[2]]);break;case"H":e.push([r[1],r[1]]);break;case"V":e.push([r[1],r[1]]);break}return e}var Bg=function(r,e){if(r.length<=1)return r;for(var t,n=0;n<e.length;n++)if(r[n][0]!==e[n][0])switch(t=F_(r[n]),e[n][0]){case"M":r[n]=["M"].concat(t[0]);break;case"L":r[n]=["L"].concat(t[0]);break;case"A":r[n]=[].concat(e[n]),r[n][6]=t[0][0],r[n][7]=t[0][1];break;case"Q":if(t.length<2)if(n>0)t=Rg(t,r[n-1],1);else{r[n]=e[n];break}r[n]=["Q"].concat(t.reduce(function(i,a){return i.concat(a)},[]));break;case"T":r[n]=["T"].concat(t[0]);break;case"C":if(t.length<3)if(n>0)t=Rg(t,r[n-1],2);else{r[n]=e[n];break}r[n]=["C"].concat(t.reduce(function(i,a){return i.concat(a)},[]));break;case"S":if(t.length<2)if(n>0)t=Rg(t,r[n-1],1);else{r[n]=e[n];break}r[n]=["S"].concat(t.reduce(function(i,a){return i.concat(a)},[]));break;default:r[n]=e[n]}return r},xG=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",catmullRomToBezier:Pg,fillPath:gG,fillPathByDiff:G_,formatPath:Bg,intersection:hG,parsePathArray:P_,parsePathString:ku,pathToAbsolute:Ng,pathToCurve:Lg,rectPath:O_}),U_=function(){function r(e,t){this.bubbles=!0,this.target=null,this.currentTarget=null,this.delegateTarget=null,this.delegateObject=null,this.defaultPrevented=!1,this.propagationStopped=!1,this.shape=null,this.fromShape=null,this.toShape=null,this.propagationPath=[],this.type=e,this.name=e,this.originalEvent=t,this.timeStamp=t.timeStamp}return r.prototype.preventDefault=function(){this.defaultPrevented=!0,this.originalEvent.preventDefault&&this.originalEvent.preventDefault()},r.prototype.stopPropagation=function(){this.propagationStopped=!0},r.prototype.toString=function(){var e=this.type;return"[Event (type="+e+")]"},r.prototype.save=function(){},r.prototype.restore=function(){},r}();function z_(r,e){var t=r.indexOf(e);t!==-1&&r.splice(t,1)}var $_=typeof window!="undefined"&&typeof window.document!="undefined";function V_(r,e){if(r.isCanvas())return!0;for(var t=e.getParent(),n=!1;t;){if(t===r){n=!0;break}t=t.getParent()}return n}function Gg(r){return r.cfg.visible&&r.cfg.capture}var _G=function(r){$t(e,r);function e(t){var n=r.call(this)||this;n.destroyed=!1;var i=n.getDefaultCfg();return n.cfg=St(i,t),n}return e.prototype.getDefaultCfg=function(){return{}},e.prototype.get=function(t){return this.cfg[t]},e.prototype.set=function(t,n){this.cfg[t]=n},e.prototype.destroy=function(){this.cfg={destroyed:!0},this.off(),this.destroyed=!0},e}(yx),W_=function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,a;n<i;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return r.concat(a||Array.prototype.slice.call(e))},wG=function(){function r(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"}return r}(),SG=function(){function r(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return r}(),EG=function(){function r(e,t,n,i){this.name=e,this.version=t,this.os=n,this.bot=i,this.type="bot-device"}return r}(),CG=function(){function r(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return r}(),AG=function(){function r(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return r}(),TG=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,MG=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,j_=3,IG=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",TG]],X_=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function H_(r){return r?Y_(r):typeof document=="undefined"&&typeof navigator!="undefined"&&navigator.product==="ReactNative"?new AG:typeof navigator!="undefined"?Y_(navigator.userAgent):PG()}function kG(r){return r!==""&&IG.reduce(function(e,t){var n=t[0],i=t[1];if(e)return e;var a=i.exec(r);return!!a&&[n,a]},!1)}function Y_(r){var e=kG(r);if(!e)return null;var t=e[0],n=e[1];if(t==="searchbot")return new CG;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<j_&&(i=W_(W_([],i,!0),NG(j_-i.length),!0)):i=[];var a=i.join("."),o=DG(r),s=MG.exec(r);return s&&s[1]?new EG(t,a,o,s[1]):new wG(t,a,o)}function DG(r){for(var e=0,t=X_.length;e<t;e++){var n=X_[e],i=n[0],a=n[1],o=a.exec(r);if(o)return i}return null}function PG(){var r=typeof process!="undefined"&&process.version;return r?new SG(process.version.slice(1)):null}function NG(r){for(var e=[],t=0;t<r;t++)e.push("0");return e}function LG(r,e,t){var n=[0,0,0,0,0,0,0,0,0];return Gl(n,t),zn(r,n,e)}function OG(r,e,t){var n=[0,0,0,0,0,0,0,0,0];return Fl(n,t),zn(r,n,e)}function RG(r,e,t){var n=[0,0,0,0,0,0,0,0,0];return Ul(n,t),zn(r,n,e)}function BG(r,e,t){return zn(r,t,e)}function GG(r,e){for(var t=r?[].concat(r):[1,0,0,0,1,0,0,0,1],n=0,i=e.length;n<i;n++){var a=e[n];switch(a[0]){case"t":LG(t,t,[a[1],a[2]]);break;case"s":RG(t,t,[a[1],a[2]]);break;case"r":OG(t,t,a[1]);break;case"m":BG(t,t,a[1]);break}}return t}function q_(r,e){var t=[],n=r[0],i=r[1],a=r[2],o=r[3],s=r[4],u=r[5],l=r[6],f=r[7],c=r[8],h=e[0],d=e[1],v=e[2],p=e[3],g=e[4],y=e[5],m=e[6],b=e[7],x=e[8];return t[0]=h*n+d*o+v*l,t[1]=h*i+d*s+v*f,t[2]=h*a+d*u+v*c,t[3]=p*n+g*o+y*l,t[4]=p*i+g*s+y*f,t[5]=p*a+g*u+y*c,t[6]=m*n+b*o+x*l,t[7]=m*i+b*s+x*f,t[8]=m*a+b*u+x*c,t}function xs(r,e){var t=[],n=e[0],i=e[1];return t[0]=r[0]*n+r[3]*i+r[6],t[1]=r[1]*n+r[4]*i+r[7],t}function K_(r){var e=[],t=r[0],n=r[1],i=r[2],a=r[3],o=r[4],s=r[5],u=r[6],l=r[7],f=r[8],c=f*o-s*l,h=-f*a+s*u,d=l*a-o*u,v=t*c+n*h+i*d;return v?(v=1/v,e[0]=c*v,e[1]=(-f*n+i*l)*v,e[2]=(s*n-i*o)*v,e[3]=h*v,e[4]=(f*t-i*u)*v,e[5]=(-s*t+i*a)*v,e[6]=d*v,e[7]=(-l*t+n*u)*v,e[8]=(o*t-n*a)*v,e):null}var ef=GG,Fg="matrix",FG=["zIndex","capture","visible","type"],UG=["repeat"],zG=":",$G="*";function VG(r){for(var e=[],t=0;t<r.length;t++)At(r[t])?e.push([].concat(r[t])):e.push(r[t]);return e}function WG(r,e){var t={},n=e.attrs;for(var i in r)t[i]=n[i];return t}function jG(r,e){var t={},n=e.attr();return xe(r,function(i,a){UG.indexOf(a)===-1&&!ls(n[a],i)&&(t[a]=i)}),t}function XG(r,e){if(e.onFrame)return r;var t=e.startTime,n=e.delay,i=e.duration,a=Object.prototype.hasOwnProperty;return xe(r,function(o){t+n<o.startTime+o.delay+o.duration&&i>o.delay&&xe(e.toAttrs,function(s,u){a.call(o.toAttrs,u)&&(delete o.toAttrs[u],delete o.fromAttrs[u])})}),r}var Z_=function(r){$t(e,r);function e(t){var n=r.call(this,t)||this;n.attrs={};var i=n.getDefaultAttrs();return St(i,t.attrs),n.attrs=i,n.initAttrs(i),n.initAnimate(),n}return e.prototype.getDefaultCfg=function(){return{visible:!0,capture:!0,zIndex:0}},e.prototype.getDefaultAttrs=function(){return{matrix:this.getDefaultMatrix(),opacity:1}},e.prototype.onCanvasChange=function(t){},e.prototype.initAttrs=function(t){},e.prototype.initAnimate=function(){this.set("animable",!0),this.set("animating",!1)},e.prototype.isGroup=function(){return!1},e.prototype.getParent=function(){return this.get("parent")},e.prototype.getCanvas=function(){return this.get("canvas")},e.prototype.attr=function(){for(var t,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=n[0],o=n[1];if(!a)return this.attrs;if(ri(a)){for(var s in a)this.setAttr(s,a[s]);return this.afterAttrsChange(a),this}return n.length===2?(this.setAttr(a,o),this.afterAttrsChange((t={},t[a]=o,t)),this):this.attrs[a]},e.prototype.isClipped=function(t,n){var i=this.getClip();return i&&!i.isHit(t,n)},e.prototype.setAttr=function(t,n){var i=this.attrs[t];i!==n&&(this.attrs[t]=n,this.onAttrChange(t,n,i))},e.prototype.onAttrChange=function(t,n,i){t==="matrix"&&this.set("totalMatrix",null)},e.prototype.afterAttrsChange=function(t){if(this.cfg.isClipShape){var n=this.cfg.applyTo;n&&n.onCanvasChange("clip")}else this.onCanvasChange("attr")},e.prototype.show=function(){return this.set("visible",!0),this.onCanvasChange("show"),this},e.prototype.hide=function(){return this.set("visible",!1),this.onCanvasChange("hide"),this},e.prototype.setZIndex=function(t){this.set("zIndex",t);var n=this.getParent();return n&&n.sort(),this},e.prototype.toFront=function(){var t=this.getParent();if(!!t){var n=t.getChildren();this.get("el");var i=n.indexOf(this);n.splice(i,1),n.push(this),this.onCanvasChange("zIndex")}},e.prototype.toBack=function(){var t=this.getParent();if(!!t){var n=t.getChildren();this.get("el");var i=n.indexOf(this);n.splice(i,1),n.unshift(this),this.onCanvasChange("zIndex")}},e.prototype.remove=function(t){t===void 0&&(t=!0);var n=this.getParent();n?(z_(n.getChildren(),this),n.get("clearing")||this.onCanvasChange("remove")):this.onCanvasChange("remove"),t&&this.destroy()},e.prototype.resetMatrix=function(){this.attr(Fg,this.getDefaultMatrix()),this.onCanvasChange("matrix")},e.prototype.getMatrix=function(){return this.attr(Fg)},e.prototype.setMatrix=function(t){this.attr(Fg,t),this.onCanvasChange("matrix")},e.prototype.getTotalMatrix=function(){var t=this.cfg.totalMatrix;if(!t){var n=this.attr("matrix"),i=this.cfg.parentMatrix;i&&n?t=q_(i,n):t=n||i,this.set("totalMatrix",t)}return t},e.prototype.applyMatrix=function(t){var n=this.attr("matrix"),i=null;t&&n?i=q_(t,n):i=n||t,this.set("totalMatrix",i),this.set("parentMatrix",t)},e.prototype.getDefaultMatrix=function(){return null},e.prototype.applyToMatrix=function(t){var n=this.attr("matrix");return n?xs(n,t):t},e.prototype.invertFromMatrix=function(t){var n=this.attr("matrix");if(n){var i=K_(n);if(i)return xs(i,t)}return t},e.prototype.setClip=function(t){var n=this.getCanvas(),i=null;if(t){var a=this.getShapeBase(),o=Eu(t.type),s=a[o];s&&(i=new s({type:t.type,isClipShape:!0,applyTo:this,attrs:t.attrs,canvas:n}))}return this.set("clipShape",i),this.onCanvasChange("clip"),i},e.prototype.getClip=function(){var t=this.cfg.clipShape;return t||null},e.prototype.clone=function(){var t=this,n=this.attrs,i={};xe(n,function(s,u){At(n[u])?i[u]=VG(n[u]):i[u]=n[u]});var a=this.constructor,o=new a({attrs:i});return xe(FG,function(s){o.set(s,t.get(s))}),o},e.prototype.destroy=function(){var t=this.destroyed;t||(this.attrs={},r.prototype.destroy.call(this))},e.prototype.isAnimatePaused=function(){return this.get("_pause").isPaused},e.prototype.animate=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(!(!this.get("timeline")&&!this.get("canvas"))){this.set("animating",!0);var i=this.get("timeline");i||(i=this.get("canvas").get("timeline"),this.set("timeline",i));var a=this.get("animations")||[];i.timer||i.initTimer();var o=t[0],s=t[1],u=t[2],l=u===void 0?"easeLinear":u,f=t[3],c=f===void 0?Rl:f,h=t[4],d=h===void 0?0:h,v,p,g,y,m;Kr(o)?(v=o,o={}):ri(o)&&o.onFrame&&(v=o.onFrame,p=o.repeat),ri(s)?(m=s,s=m.duration,l=m.easing||"easeLinear",d=m.delay||0,p=m.repeat||p||!1,c=m.callback||Rl,g=m.pauseCallback||Rl,y=m.resumeCallback||Rl):(Lt(c)&&(d=c,c=null),Kr(l)?(c=l,l="easeLinear"):l=l||"easeLinear");var b=jG(o,this),x={fromAttrs:WG(b,this),toAttrs:b,duration:s,easing:l,repeat:p,callback:c,pauseCallback:g,resumeCallback:y,delay:d,startTime:i.getTime(),id:wa(),onFrame:v,pathFormatted:!1};a.length>0?a=XG(a,x):i.addAnimator(this),a.push(x),this.set("animations",a),this.set("_pause",{isPaused:!1})}},e.prototype.stopAnimate=function(t){var n=this;t===void 0&&(t=!0);var i=this.get("animations");xe(i,function(a){t&&(a.onFrame?n.attr(a.onFrame(1)):n.attr(a.toAttrs)),a.callback&&a.callback()}),this.set("animating",!1),this.set("animations",[])},e.prototype.pauseAnimate=function(){var t=this.get("timeline"),n=this.get("animations"),i=t.getTime();return xe(n,function(a){a._paused=!0,a._pauseTime=i,a.pauseCallback&&a.pauseCallback()}),this.set("_pause",{isPaused:!0,pauseTime:i}),this},e.prototype.resumeAnimate=function(){var t=this.get("timeline"),n=t.getTime(),i=this.get("animations"),a=this.get("_pause").pauseTime;return xe(i,function(o){o.startTime=o.startTime+(n-a),o._paused=!1,o._pauseTime=null,o.resumeCallback&&o.resumeCallback()}),this.set("_pause",{isPaused:!1}),this.set("animations",i),this},e.prototype.emitDelegation=function(t,n){var i=this,a=n.propagationPath;this.getEvents();var o;t==="mouseenter"?o=n.fromShape:t==="mouseleave"&&(o=n.toShape);for(var s=function(c){var h=a[c],d=h.get("name");if(d){if((h.isGroup()||h.isCanvas&&h.isCanvas())&&o&&V_(h,o))return"break";At(d)?xe(d,function(v){i.emitDelegateEvent(h,v,n)}):u.emitDelegateEvent(h,d,n)}},u=this,l=0;l<a.length;l++){var f=s(l);if(f==="break")break}},e.prototype.emitDelegateEvent=function(t,n,i){var a=this.getEvents(),o=n+zG+i.type;(a[o]||a[$G])&&(i.name=o,i.currentTarget=t,i.delegateTarget=this,i.delegateObject=t.get("delegateObject"),this.emit(o,i))},e.prototype.translate=function(t,n){t===void 0&&(t=0),n===void 0&&(n=0);var i=this.getMatrix(),a=ef(i,[["t",t,n]]);return this.setMatrix(a),this},e.prototype.move=function(t,n){var i=this.attr("x")||0,a=this.attr("y")||0;return this.translate(t-i,n-a),this},e.prototype.moveTo=function(t,n){return this.move(t,n)},e.prototype.scale=function(t,n){var i=this.getMatrix(),a=ef(i,[["s",t,n||t]]);return this.setMatrix(a),this},e.prototype.rotate=function(t){var n=this.getMatrix(),i=ef(n,[["r",t]]);return this.setMatrix(i),this},e.prototype.rotateAtStart=function(t){var n=this.attr(),i=n.x,a=n.y,o=this.getMatrix(),s=ef(o,[["t",-i,-a],["r",t],["t",i,a]]);return this.setMatrix(s),this},e.prototype.rotateAtPoint=function(t,n,i){var a=this.getMatrix(),o=ef(a,[["t",-t,-n],["r",i],["t",t,n]]);return this.setMatrix(o),this},e}(_G),Q_={},Ug="_INDEX";function J_(r,e){if(r.set("canvas",e),r.isGroup()){var t=r.get("children");t.length&&t.forEach(function(n){J_(n,e)})}}function ew(r,e){if(r.set("timeline",e),r.isGroup()){var t=r.get("children");t.length&&t.forEach(function(n){ew(n,e)})}}function HG(r,e,t){t===void 0&&(t=!0),t?e.destroy():(e.set("parent",null),e.set("canvas",null)),z_(r.getChildren(),e)}function YG(r){return function(e,t){var n=r(e,t);return n===0?e[Ug]-t[Ug]:n}}var tw=function(r){$t(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.isCanvas=function(){return!1},e.prototype.getBBox=function(){var t=1/0,n=-1/0,i=1/0,a=-1/0,o=[],s=[],u=this.getChildren().filter(function(f){return f.get("visible")&&(!f.isGroup()||f.isGroup()&&f.getChildren().length>0)});u.length>0?(xe(u,function(f){var c=f.getBBox();o.push(c.minX,c.maxX),s.push(c.minY,c.maxY)}),t=Bi(o),n=Ri(o),i=Bi(s),a=Ri(s)):(t=0,n=0,i=0,a=0);var l={x:t,y:i,minX:t,minY:i,maxX:n,maxY:a,width:n-t,height:a-i};return l},e.prototype.getCanvasBBox=function(){var t=1/0,n=-1/0,i=1/0,a=-1/0,o=[],s=[],u=this.getChildren().filter(function(f){return f.get("visible")&&(!f.isGroup()||f.isGroup()&&f.getChildren().length>0)});u.length>0?(xe(u,function(f){var c=f.getCanvasBBox();o.push(c.minX,c.maxX),s.push(c.minY,c.maxY)}),t=Bi(o),n=Ri(o),i=Bi(s),a=Ri(s)):(t=0,n=0,i=0,a=0);var l={x:t,y:i,minX:t,minY:i,maxX:n,maxY:a,width:n-t,height:a-i};return l},e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return t.children=[],t},e.prototype.onAttrChange=function(t,n,i){if(r.prototype.onAttrChange.call(this,t,n,i),t==="matrix"){var a=this.getTotalMatrix();this._applyChildrenMarix(a)}},e.prototype.applyMatrix=function(t){var n=this.getTotalMatrix();r.prototype.applyMatrix.call(this,t);var i=this.getTotalMatrix();i!==n&&this._applyChildrenMarix(i)},e.prototype._applyChildrenMarix=function(t){var n=this.getChildren();xe(n,function(i){i.applyMatrix(t)})},e.prototype.addShape=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=t[0],a=t[1];ri(i)?a=i:a.type=i;var o=Q_[a.type];o||(o=Eu(a.type),Q_[a.type]=o);var s=this.getShapeBase(),u=new s[o](a);return this.add(u),u},e.prototype.addGroup=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=t[0],a=t[1],o;if(Kr(i))a?o=new i(a):o=new i({parent:this});else{var s=i||{},u=this.getGroupBase();o=new u(s)}return this.add(o),o},e.prototype.getCanvas=function(){var t;return this.isCanvas()?t=this:t=this.get("canvas"),t},e.prototype.getShape=function(t,n,i){if(!Gg(this))return null;var a=this.getChildren(),o;if(this.isCanvas())o=this._findShape(a,t,n,i);else{var s=[t,n,1];s=this.invertFromMatrix(s),this.isClipped(s[0],s[1])||(o=this._findShape(a,s[0],s[1],i))}return o},e.prototype._findShape=function(t,n,i,a){for(var o=null,s=t.length-1;s>=0;s--){var u=t[s];if(Gg(u)&&(u.isGroup()?o=u.getShape(n,i,a):u.isHit(n,i)&&(o=u)),o)break}return o},e.prototype.add=function(t){var n=this.getCanvas(),i=this.getChildren(),a=this.get("timeline"),o=t.getParent();o&&HG(o,t,!1),t.set("parent",this),n&&J_(t,n),a&&ew(t,a),i.push(t),t.onCanvasChange("add"),this._applyElementMatrix(t)},e.prototype._applyElementMatrix=function(t){var n=this.getTotalMatrix();n&&t.applyMatrix(n)},e.prototype.getChildren=function(){return this.get("children")},e.prototype.sort=function(){var t=this.getChildren();xe(t,function(n,i){return n[Ug]=i,n}),t.sort(YG(function(n,i){return n.get("zIndex")-i.get("zIndex")})),this.onCanvasChange("sort")},e.prototype.clear=function(){if(this.set("clearing",!0),!this.destroyed){for(var t=this.getChildren(),n=t.length-1;n>=0;n--)t[n].destroy();this.set("children",[]),this.onCanvasChange("clear"),this.set("clearing",!1)}},e.prototype.destroy=function(){this.get("destroyed")||(this.clear(),r.prototype.destroy.call(this))},e.prototype.getFirst=function(){return this.getChildByIndex(0)},e.prototype.getLast=function(){var t=this.getChildren();return this.getChildByIndex(t.length-1)},e.prototype.getChildByIndex=function(t){var n=this.getChildren();return n[t]},e.prototype.getCount=function(){var t=this.getChildren();return t.length},e.prototype.contain=function(t){var n=this.getChildren();return n.indexOf(t)>-1},e.prototype.removeChild=function(t,n){n===void 0&&(n=!0),this.contain(t)&&t.remove(n)},e.prototype.findAll=function(t){var n=[],i=this.getChildren();return xe(i,function(a){t(a)&&n.push(a),a.isGroup()&&(n=n.concat(a.findAll(t)))}),n},e.prototype.find=function(t){var n=null,i=this.getChildren();return xe(i,function(a){if(t(a)?n=a:a.isGroup()&&(n=a.find(t)),n)return!1}),n},e.prototype.findById=function(t){return this.find(function(n){return n.get("id")===t})},e.prototype.findByClassName=function(t){return this.find(function(n){return n.get("className")===t})},e.prototype.findAllByName=function(t){return this.findAll(function(n){return n.get("name")===t})},e}(Z_),Du=0,tf=0,rf=0,rw=1e3,Fh,nf,Uh=0,_s=0,zh=0,af=typeof performance=="object"&&performance.now?performance:Date,nw=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function iw(){return _s||(nw(qG),_s=af.now()+zh)}function qG(){_s=0}function zg(){this._call=this._time=this._next=null}zg.prototype=$g.prototype={constructor:zg,restart:function(r,e,t){if(typeof r!="function")throw new TypeError("callback is not a function");t=(t==null?iw():+t)+(e==null?0:+e),!this._next&&nf!==this&&(nf?nf._next=this:Fh=this,nf=this),this._call=r,this._time=t,Vg()},stop:function(){this._call&&(this._call=null,this._time=1/0,Vg())}};function $g(r,e,t){var n=new zg;return n.restart(r,e,t),n}function KG(){iw(),++Du;for(var r=Fh,e;r;)(e=_s-r._time)>=0&&r._call.call(null,e),r=r._next;--Du}function aw(){_s=(Uh=af.now())+zh,Du=tf=0;try{KG()}finally{Du=0,QG(),_s=0}}function ZG(){var r=af.now(),e=r-Uh;e>rw&&(zh-=e,Uh=r)}function QG(){for(var r,e=Fh,t,n=1/0;e;)e._call?(n>e._time&&(n=e._time),r=e,e=e._next):(t=e._next,e._next=null,e=r?r._next=t:Fh=t);nf=r,Vg(n)}function Vg(r){if(!Du){tf&&(tf=clearTimeout(tf));var e=r-_s;e>24?(r<1/0&&(tf=setTimeout(aw,r-af.now()-zh)),rf&&(rf=clearInterval(rf))):(rf||(Uh=af.now(),rf=setInterval(ZG,rw)),Du=1,nw(aw))}}function JG(r){return+r}function eF(r){return r*r}function tF(r){return r*(2-r)}function ow(r){return((r*=2)<=1?r*r:--r*(2-r)+1)/2}function rF(r){return r*r*r}function nF(r){return--r*r*r+1}function sw(r){return((r*=2)<=1?r*r*r:(r-=2)*r*r+2)/2}var Wg=3,iF=function r(e){e=+e;function t(n){return Math.pow(n,e)}return t.exponent=r,t}(Wg),aF=function r(e){e=+e;function t(n){return 1-Math.pow(1-n,e)}return t.exponent=r,t}(Wg),uw=function r(e){e=+e;function t(n){return((n*=2)<=1?Math.pow(n,e):2-Math.pow(2-n,e))/2}return t.exponent=r,t}(Wg),lw=Math.PI,fw=lw/2;function oF(r){return+r==1?1:1-Math.cos(r*fw)}function sF(r){return Math.sin(r*fw)}function cw(r){return(1-Math.cos(lw*r))/2}function wo(r){return(Math.pow(2,-10*r)-.0009765625)*1.0009775171065494}function uF(r){return wo(1-+r)}function lF(r){return 1-wo(r)}function hw(r){return((r*=2)<=1?wo(1-r):2-wo(r-1))/2}function fF(r){return 1-Math.sqrt(1-r*r)}function cF(r){return Math.sqrt(1- --r*r)}function dw(r){return((r*=2)<=1?1-Math.sqrt(1-r*r):Math.sqrt(1-(r-=2)*r)+1)/2}var jg=4/11,hF=6/11,dF=8/11,vF=3/4,pF=9/11,gF=10/11,yF=15/16,mF=21/22,bF=63/64,$h=1/jg/jg;function xF(r){return 1-of(1-r)}function of(r){return(r=+r)<jg?$h*r*r:r<dF?$h*(r-=hF)*r+vF:r<gF?$h*(r-=pF)*r+yF:$h*(r-=mF)*r+bF}function _F(r){return((r*=2)<=1?1-of(1-r):of(r-1)+1)/2}var Xg=1.70158,wF=function r(e){e=+e;function t(n){return(n=+n)*n*(e*(n-1)+n)}return t.overshoot=r,t}(Xg),SF=function r(e){e=+e;function t(n){return--n*n*((n+1)*e+n)+1}return t.overshoot=r,t}(Xg),vw=function r(e){e=+e;function t(n){return((n*=2)<1?n*n*((e+1)*n-e):(n-=2)*n*((e+1)*n+e)+2)/2}return t.overshoot=r,t}(Xg),Pu=2*Math.PI,Hg=1,Yg=.3,EF=function r(e,t){var n=Math.asin(1/(e=Math.max(1,e)))*(t/=Pu);function i(a){return e*wo(- --a)*Math.sin((n-a)/t)}return i.amplitude=function(a){return r(a,t*Pu)},i.period=function(a){return r(e,a)},i}(Hg,Yg),pw=function r(e,t){var n=Math.asin(1/(e=Math.max(1,e)))*(t/=Pu);function i(a){return 1-e*wo(a=+a)*Math.sin((a+n)/t)}return i.amplitude=function(a){return r(a,t*Pu)},i.period=function(a){return r(e,a)},i}(Hg,Yg),CF=function r(e,t){var n=Math.asin(1/(e=Math.max(1,e)))*(t/=Pu);function i(a){return((a=a*2-1)<0?e*wo(-a)*Math.sin((n-a)/t):2-e*wo(a)*Math.sin((n+a)/t))/2}return i.amplitude=function(a){return r(a,t*Pu)},i.period=function(a){return r(e,a)},i}(Hg,Yg),gw=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",easeLinear:JG,easeQuad:ow,easeQuadIn:eF,easeQuadOut:tF,easeQuadInOut:ow,easeCubic:sw,easeCubicIn:rF,easeCubicOut:nF,easeCubicInOut:sw,easePoly:uw,easePolyIn:iF,easePolyOut:aF,easePolyInOut:uw,easeSin:cw,easeSinIn:oF,easeSinOut:sF,easeSinInOut:cw,easeExp:hw,easeExpIn:uF,easeExpOut:lF,easeExpInOut:hw,easeCircle:dw,easeCircleIn:fF,easeCircleOut:cF,easeCircleInOut:dw,easeBounce:of,easeBounceIn:xF,easeBounceOut:of,easeBounceInOut:_F,easeBack:vw,easeBackIn:wF,easeBackOut:SF,easeBackInOut:vw,easeElastic:pw,easeElasticIn:EF,easeElasticOut:pw,easeElasticInOut:CF});function qg(r,e,t){r.prototype=e.prototype=t,t.constructor=r}function yw(r,e){var t=Object.create(r.prototype);for(var n in e)t[n]=e[n];return t}function sf(){}var uf=.7,Vh=1/uf,Nu="\\s*([+-]?\\d+)\\s*",lf="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ea="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",AF=/^#([0-9a-f]{3,8})$/,TF=new RegExp("^rgb\\("+[Nu,Nu,Nu]+"\\)$"),MF=new RegExp("^rgb\\("+[Ea,Ea,Ea]+"\\)$"),IF=new RegExp("^rgba\\("+[Nu,Nu,Nu,lf]+"\\)$"),kF=new RegExp("^rgba\\("+[Ea,Ea,Ea,lf]+"\\)$"),DF=new RegExp("^hsl\\("+[lf,Ea,Ea]+"\\)$"),PF=new RegExp("^hsla\\("+[lf,Ea,Ea,lf]+"\\)$"),mw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};qg(sf,ff,{copy:function(r){return Object.assign(new this.constructor,this,r)},displayable:function(){return this.rgb().displayable()},hex:bw,formatHex:bw,formatHsl:NF,formatRgb:xw,toString:xw});function bw(){return this.rgb().formatHex()}function NF(){return Cw(this).formatHsl()}function xw(){return this.rgb().formatRgb()}function ff(r){var e,t;return r=(r+"").trim().toLowerCase(),(e=AF.exec(r))?(t=e[1].length,e=parseInt(e[1],16),t===6?_w(e):t===3?new Ii(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?Wh(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?Wh(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=TF.exec(r))?new Ii(e[1],e[2],e[3],1):(e=MF.exec(r))?new Ii(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=IF.exec(r))?Wh(e[1],e[2],e[3],e[4]):(e=kF.exec(r))?Wh(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=DF.exec(r))?Ew(e[1],e[2]/100,e[3]/100,1):(e=PF.exec(r))?Ew(e[1],e[2]/100,e[3]/100,e[4]):mw.hasOwnProperty(r)?_w(mw[r]):r==="transparent"?new Ii(NaN,NaN,NaN,0):null}function _w(r){return new Ii(r>>16&255,r>>8&255,r&255,1)}function Wh(r,e,t,n){return n<=0&&(r=e=t=NaN),new Ii(r,e,t,n)}function LF(r){return r instanceof sf||(r=ff(r)),r?(r=r.rgb(),new Ii(r.r,r.g,r.b,r.opacity)):new Ii}function Kg(r,e,t,n){return arguments.length===1?LF(r):new Ii(r,e,t,n==null?1:n)}function Ii(r,e,t,n){this.r=+r,this.g=+e,this.b=+t,this.opacity=+n}qg(Ii,Kg,yw(sf,{brighter:function(r){return r=r==null?Vh:Math.pow(Vh,r),new Ii(this.r*r,this.g*r,this.b*r,this.opacity)},darker:function(r){return r=r==null?uf:Math.pow(uf,r),new Ii(this.r*r,this.g*r,this.b*r,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ww,formatHex:ww,formatRgb:Sw,toString:Sw}));function ww(){return"#"+Zg(this.r)+Zg(this.g)+Zg(this.b)}function Sw(){var r=this.opacity;return r=isNaN(r)?1:Math.max(0,Math.min(1,r)),(r===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(r===1?")":", "+r+")")}function Zg(r){return r=Math.max(0,Math.min(255,Math.round(r)||0)),(r<16?"0":"")+r.toString(16)}function Ew(r,e,t,n){return n<=0?r=e=t=NaN:t<=0||t>=1?r=e=NaN:e<=0&&(r=NaN),new Ca(r,e,t,n)}function Cw(r){if(r instanceof Ca)return new Ca(r.h,r.s,r.l,r.opacity);if(r instanceof sf||(r=ff(r)),!r)return new Ca;if(r instanceof Ca)return r;r=r.rgb();var e=r.r/255,t=r.g/255,n=r.b/255,i=Math.min(e,t,n),a=Math.max(e,t,n),o=NaN,s=a-i,u=(a+i)/2;return s?(e===a?o=(t-n)/s+(t<n)*6:t===a?o=(n-e)/s+2:o=(e-t)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new Ca(o,s,u,r.opacity)}function OF(r,e,t,n){return arguments.length===1?Cw(r):new Ca(r,e,t,n==null?1:n)}function Ca(r,e,t,n){this.h=+r,this.s=+e,this.l=+t,this.opacity=+n}qg(Ca,OF,yw(sf,{brighter:function(r){return r=r==null?Vh:Math.pow(Vh,r),new Ca(this.h,this.s,this.l*r,this.opacity)},darker:function(r){return r=r==null?uf:Math.pow(uf,r),new Ca(this.h,this.s,this.l*r,this.opacity)},rgb:function(){var r=this.h%360+(this.h<0)*360,e=isNaN(r)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*e,i=2*t-n;return new Ii(Qg(r>=240?r-240:r+120,i,n),Qg(r,i,n),Qg(r<120?r+240:r-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var r=this.opacity;return r=isNaN(r)?1:Math.max(0,Math.min(1,r)),(r===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(r===1?")":", "+r+")")}}));function Qg(r,e,t){return(r<60?e+(t-e)*r/60:r<180?t:r<240?e+(t-e)*(240-r)/60:e)*255}function Jg(r){return function(){return r}}function RF(r,e){return function(t){return r+t*e}}function BF(r,e,t){return r=Math.pow(r,t),e=Math.pow(e,t)-r,t=1/t,function(n){return Math.pow(r+n*e,t)}}function GF(r){return(r=+r)==1?Aw:function(e,t){return t-e?BF(e,t,r):Jg(isNaN(e)?t:e)}}function Aw(r,e){var t=e-r;return t?RF(r,t):Jg(isNaN(r)?e:r)}var Tw=function r(e){var t=GF(e);function n(i,a){var o=t((i=Kg(i)).r,(a=Kg(a)).r),s=t(i.g,a.g),u=t(i.b,a.b),l=Aw(i.opacity,a.opacity);return function(f){return i.r=o(f),i.g=s(f),i.b=u(f),i.opacity=l(f),i+""}}return n.gamma=r,n}(1);function Mw(r,e){e||(e=[]);var t=r?Math.min(e.length,r.length):0,n=e.slice(),i;return function(a){for(i=0;i<t;++i)n[i]=r[i]*(1-a)+e[i]*a;return n}}function Iw(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function FF(r,e){return(Iw(e)?Mw:kw)(r,e)}function kw(r,e){var t=e?e.length:0,n=r?Math.min(t,r.length):0,i=new Array(n),a=new Array(t),o;for(o=0;o<n;++o)i[o]=jh(r[o],e[o]);for(;o<t;++o)a[o]=e[o];return function(s){for(o=0;o<n;++o)a[o]=i[o](s);return a}}function UF(r,e){var t=new Date;return r=+r,e=+e,function(n){return t.setTime(r*(1-n)+e*n),t}}function ey(r,e){return r=+r,e=+e,function(t){return r*(1-t)+e*t}}function zF(r,e){var t={},n={},i;(r===null||typeof r!="object")&&(r={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in r?t[i]=jh(r[i],e[i]):n[i]=e[i];return function(a){for(i in t)n[i]=t[i](a);return n}}var ty=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ry=new RegExp(ty.source,"g");function $F(r){return function(){return r}}function VF(r){return function(e){return r(e)+""}}function WF(r,e){var t=ty.lastIndex=ry.lastIndex=0,n,i,a,o=-1,s=[],u=[];for(r=r+"",e=e+"";(n=ty.exec(r))&&(i=ry.exec(e));)(a=i.index)>t&&(a=e.slice(t,a),s[o]?s[o]+=a:s[++o]=a),(n=n[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,u.push({i:o,x:ey(n,i)})),t=ry.lastIndex;return t<e.length&&(a=e.slice(t),s[o]?s[o]+=a:s[++o]=a),s.length<2?u[0]?VF(u[0].x):$F(e):(e=u.length,function(l){for(var f=0,c;f<e;++f)s[(c=u[f]).i]=c.x(l);return s.join("")})}function jh(r,e){var t=typeof e,n;return e==null||t==="boolean"?Jg(e):(t==="number"?ey:t==="string"?(n=ff(e))?(e=n,Tw):WF:e instanceof ff?Tw:e instanceof Date?UF:Iw(e)?Mw:Array.isArray(e)?kw:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?zF:ey)(r,e)}var jF=function(r){return["fill","stroke","fillStyle","strokeStyle"].includes(r)},XF=function(r){return/^[r,R,L,l]{1}[\s]*\(/.test(r)},Dw=[1,0,0,0,1,0,0,0,1];function HF(r,e,t){var n={},i=e.fromAttrs,a=e.toAttrs;if(!r.destroyed){var o;for(var s in a)if(!ls(i[s],a[s]))if(s==="path"){var u=a[s],l=i[s];u.length>l.length?(u=ku(a[s]),l=ku(i[s]),l=G_(l,u),l=Bg(l,u),e.fromAttrs.path=l,e.toAttrs.path=u):e.pathFormatted||(u=ku(a[s]),l=ku(i[s]),l=Bg(l,u),e.fromAttrs.path=l,e.toAttrs.path=u,e.pathFormatted=!0),n[s]=[];for(var f=0;f<u.length;f++){for(var c=u[f],h=l[f],d=[],v=0;v<c.length;v++)Lt(c[v])&&h&&Lt(h[v])?(o=jh(h[v],c[v]),d.push(o(t))):d.push(c[v]);n[s].push(d)}}else if(s==="matrix"){var p=FF(i[s]||Dw,a[s]||Dw),g=p(t);n[s]=g}else jF(s)&&XF(a[s])?n[s]=a[s]:Kr(a[s])||(o=jh(i[s],a[s]),n[s]=o(t));r.attr(n)}}function YF(r,e,t){var n=e.startTime,i=e.delay;if(t<n+i||e._paused)return!1;var a,o=e.duration,s=e.easing;if(t=t-n-e.delay,e.repeat)a=t%o/o,a=gw[s](a);else if(a=t/o,a<1)a=gw[s](a);else return e.onFrame?r.attr(e.onFrame(1)):r.attr(e.toAttrs),!0;if(e.onFrame){var u=e.onFrame(a);r.attr(u)}else HF(r,e,a);return!1}var qF=function(){function r(e){this.animators=[],this.current=0,this.timer=null,this.canvas=e}return r.prototype.initTimer=function(){var e=this,t=!1,n,i,a;this.timer=$g(function(o){if(e.current=o,e.animators.length>0){for(var s=e.animators.length-1;s>=0;s--){if(n=e.animators[s],n.destroyed){e.removeAnimator(s);continue}if(!n.isAnimatePaused()){i=n.get("animations");for(var u=i.length-1;u>=0;u--)a=i[u],t=YF(n,a,o),t&&(i.splice(u,1),t=!1,a.callback&&a.callback())}i.length===0&&e.removeAnimator(s)}var l=e.canvas.get("autoDraw");l||e.canvas.draw()}})},r.prototype.addAnimator=function(e){this.animators.push(e)},r.prototype.removeAnimator=function(e){this.animators.splice(e,1)},r.prototype.isAnimating=function(){return!!this.animators.length},r.prototype.stop=function(){this.timer&&this.timer.stop()},r.prototype.stopAllAnimations=function(e){e===void 0&&(e=!0),this.animators.forEach(function(t){t.stopAnimate(e)}),this.animators=[],this.canvas.draw()},r.prototype.getTime=function(){return this.current},r}(),KF=40,Pw=0,Nw=["mousedown","mouseup","dblclick","mouseout","mouseover","mousemove","mouseleave","mouseenter","touchstart","touchmove","touchend","dragenter","dragover","dragleave","drop","contextmenu","mousewheel"];function Lw(r,e,t){t.name=e,t.target=r,t.currentTarget=r,t.delegateTarget=r,r.emit(e,t)}function ZF(r,e,t){if(t.bubbles){var n=void 0,i=!1;if(e==="mouseenter"?(n=t.fromShape,i=!0):e==="mouseleave"&&(i=!0,n=t.toShape),r.isCanvas()&&i)return;if(n&&V_(r,n)){t.bubbles=!1;return}t.name=e,t.currentTarget=r,t.delegateTarget=r,r.emit(e,t)}}var QF=function(){function r(e){var t=this;this.draggingShape=null,this.dragging=!1,this.currentShape=null,this.mousedownShape=null,this.mousedownPoint=null,this._eventCallback=function(n){var i=n.type;t._triggerEvent(i,n)},this._onDocumentMove=function(n){var i=t.canvas,a=i.get("el");if(a!==n.target&&(t.dragging||t.currentShape)){var o=t._getPointInfo(n);t.dragging&&t._emitEvent("drag",n,o,t.draggingShape)}},this._onDocumentMouseUp=function(n){var i=t.canvas,a=i.get("el");if(a!==n.target&&t.dragging){var o=t._getPointInfo(n);t.draggingShape&&t._emitEvent("drop",n,o,null),t._emitEvent("dragend",n,o,t.draggingShape),t._afterDrag(t.draggingShape,o,n)}},this.canvas=e.canvas}return r.prototype.init=function(){this._bindEvents()},r.prototype._bindEvents=function(){var e=this,t=this.canvas.get("el");xe(Nw,function(n){t.addEventListener(n,e._eventCallback)}),document&&(document.addEventListener("mousemove",this._onDocumentMove),document.addEventListener("mouseup",this._onDocumentMouseUp))},r.prototype._clearEvents=function(){var e=this,t=this.canvas.get("el");xe(Nw,function(n){t.removeEventListener(n,e._eventCallback)}),document&&(document.removeEventListener("mousemove",this._onDocumentMove),document.removeEventListener("mouseup",this._onDocumentMouseUp))},r.prototype._getEventObj=function(e,t,n,i,a,o){var s=new U_(e,t);return s.fromShape=a,s.toShape=o,s.x=n.x,s.y=n.y,s.clientX=n.clientX,s.clientY=n.clientY,s.propagationPath.push(i),s},r.prototype._getShape=function(e,t){return this.canvas.getShape(e.x,e.y,t)},r.prototype._getPointInfo=function(e){var t=this.canvas,n=t.getClientByEvent(e),i=t.getPointByEvent(e);return{x:i.x,y:i.y,clientX:n.x,clientY:n.y}},r.prototype._triggerEvent=function(e,t){var n=this._getPointInfo(t),i=this._getShape(n,t),a=this["_on"+e],o=!1;if(a)a.call(this,n,i,t);else{var s=this.currentShape;e==="mouseenter"||e==="dragenter"||e==="mouseover"?(this._emitEvent(e,t,n,null,null,i),i&&this._emitEvent(e,t,n,i,null,i),e==="mouseenter"&&this.draggingShape&&this._emitEvent("dragenter",t,n,null)):e==="mouseleave"||e==="dragleave"||e==="mouseout"?(o=!0,s&&this._emitEvent(e,t,n,s,s,null),this._emitEvent(e,t,n,null,s,null),e==="mouseleave"&&this.draggingShape&&this._emitEvent("dragleave",t,n,null)):this._emitEvent(e,t,n,i,null,null)}if(o||(this.currentShape=i),i&&!i.get("destroyed")){var u=this.canvas,l=u.get("el");l.style.cursor=i.attr("cursor")||u.get("cursor")}},r.prototype._onmousedown=function(e,t,n){n.button===Pw&&(this.mousedownShape=t,this.mousedownPoint=e,this.mousedownTimeStamp=n.timeStamp),this._emitEvent("mousedown",n,e,t,null,null)},r.prototype._emitMouseoverEvents=function(e,t,n,i){var a=this.canvas.get("el");n!==i&&(n&&(this._emitEvent("mouseout",e,t,n,n,i),this._emitEvent("mouseleave",e,t,n,n,i),(!i||i.get("destroyed"))&&(a.style.cursor=this.canvas.get("cursor"))),i&&(this._emitEvent("mouseover",e,t,i,n,i),this._emitEvent("mouseenter",e,t,i,n,i)))},r.prototype._emitDragoverEvents=function(e,t,n,i,a){i?(i!==n&&(n&&this._emitEvent("dragleave",e,t,n,n,i),this._emitEvent("dragenter",e,t,i,n,i)),a||this._emitEvent("dragover",e,t,i)):n&&this._emitEvent("dragleave",e,t,n,n,i),a&&this._emitEvent("dragover",e,t,i)},r.prototype._afterDrag=function(e,t,n){e&&(e.set("capture",!0),this.draggingShape=null),this.dragging=!1;var i=this._getShape(t,n);i!==e&&this._emitMouseoverEvents(n,t,e,i),this.currentShape=i},r.prototype._onmouseup=function(e,t,n){if(n.button===Pw){var i=this.draggingShape;this.dragging?(i&&this._emitEvent("drop",n,e,t),this._emitEvent("dragend",n,e,i),this._afterDrag(i,e,n)):(this._emitEvent("mouseup",n,e,t),t===this.mousedownShape&&this._emitEvent("click",n,e,t),this.mousedownShape=null,this.mousedownPoint=null)}},r.prototype._ondragover=function(e,t,n){n.preventDefault();var i=this.currentShape;this._emitDragoverEvents(n,e,i,t,!0)},r.prototype._onmousemove=function(e,t,n){var i=this.canvas,a=this.currentShape,o=this.draggingShape;if(this.dragging)o&&this._emitDragoverEvents(n,e,a,t,!1),this._emitEvent("drag",n,e,o);else{var s=this.mousedownPoint;if(s){var u=this.mousedownShape,l=n.timeStamp,f=l-this.mousedownTimeStamp,c=s.clientX-e.clientX,h=s.clientY-e.clientY,d=c*c+h*h;f>120||d>KF?u&&u.get("draggable")?(o=this.mousedownShape,o.set("capture",!1),this.draggingShape=o,this.dragging=!0,this._emitEvent("dragstart",n,e,o),this.mousedownShape=null,this.mousedownPoint=null):!u&&i.get("draggable")?(this.dragging=!0,this._emitEvent("dragstart",n,e,null),this.mousedownShape=null,this.mousedownPoint=null):(this._emitMouseoverEvents(n,e,a,t),this._emitEvent("mousemove",n,e,t)):(this._emitMouseoverEvents(n,e,a,t),this._emitEvent("mousemove",n,e,t))}else this._emitMouseoverEvents(n,e,a,t),this._emitEvent("mousemove",n,e,t)}},r.prototype._emitEvent=function(e,t,n,i,a,o){var s=this._getEventObj(e,t,n,i,a,o);if(i){s.shape=i,Lw(i,e,s);for(var u=i.getParent();u;)u.emitDelegation(e,s),s.propagationStopped||ZF(u,e,s),s.propagationPath.push(u),u=u.getParent()}else{var l=this.canvas;Lw(l,e,s)}},r.prototype.destroy=function(){this._clearEvents(),this.canvas=null,this.currentShape=null,this.draggingShape=null,this.mousedownPoint=null,this.mousedownShape=null,this.mousedownTimeStamp=null},r}(),Ow="px",Rw=H_(),JF=Rw&&Rw.name==="firefox",Bw=function(r){$t(e,r);function e(t){var n=r.call(this,t)||this;return n.initContainer(),n.initDom(),n.initEvents(),n.initTimeline(),n}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return t.cursor="default",t.supportCSSTransform=!1,t},e.prototype.initContainer=function(){var t=this.get("container");Xe(t)&&(t=document.getElementById(t),this.set("container",t))},e.prototype.initDom=function(){var t=this.createDom();this.set("el",t);var n=this.get("container");n.appendChild(t),this.setDOMSize(this.get("width"),this.get("height"))},e.prototype.initEvents=function(){var t=new QF({canvas:this});t.init(),this.set("eventController",t)},e.prototype.initTimeline=function(){var t=new qF(this);this.set("timeline",t)},e.prototype.setDOMSize=function(t,n){var i=this.get("el");$_&&(i.style.width=t+Ow,i.style.height=n+Ow)},e.prototype.changeSize=function(t,n){this.setDOMSize(t,n),this.set("width",t),this.set("height",n),this.onCanvasChange("changeSize")},e.prototype.getRenderer=function(){return this.get("renderer")},e.prototype.getCursor=function(){return this.get("cursor")},e.prototype.setCursor=function(t){this.set("cursor",t);var n=this.get("el");$_&&n&&(n.style.cursor=t)},e.prototype.getPointByEvent=function(t){var n=this.get("supportCSSTransform");if(n){if(JF&&!yt(t.layerX)&&t.layerX!==t.offsetX)return{x:t.layerX,y:t.layerY};if(!yt(t.offsetX))return{x:t.offsetX,y:t.offsetY}}var i=this.getClientByEvent(t),a=i.x,o=i.y;return this.getPointByClient(a,o)},e.prototype.getClientByEvent=function(t){var n=t;return t.touches&&(t.type==="touchend"?n=t.changedTouches[0]:n=t.touches[0]),{x:n.clientX,y:n.clientY}},e.prototype.getPointByClient=function(t,n){var i=this.get("el"),a=i.getBoundingClientRect();return{x:t-a.left,y:n-a.top}},e.prototype.getClientByPoint=function(t,n){var i=this.get("el"),a=i.getBoundingClientRect();return{x:t+a.left,y:n+a.top}},e.prototype.draw=function(){},e.prototype.removeDom=function(){var t=this.get("el");t.parentNode.removeChild(t)},e.prototype.clearEvents=function(){var t=this.get("eventController");t.destroy()},e.prototype.isCanvas=function(){return!0},e.prototype.getParent=function(){return null},e.prototype.destroy=function(){var t=this.get("timeline");this.get("destroyed")||(this.clear(),t&&t.stop(),this.clearEvents(),this.removeDom(),r.prototype.destroy.call(this))},e}(tw),Gw=function(r){$t(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.isGroup=function(){return!0},e.prototype.isEntityGroup=function(){return!1},e.prototype.clone=function(){for(var t=r.prototype.clone.call(this),n=this.getChildren(),i=0;i<n.length;i++){var a=n[i];t.add(a.clone())}return t},e}(tw),Fw=function(r){$t(e,r);function e(t){return r.call(this,t)||this}return e.prototype._isInBBox=function(t,n){var i=this.getBBox();return i.minX<=t&&i.maxX>=t&&i.minY<=n&&i.maxY>=n},e.prototype.afterAttrsChange=function(t){r.prototype.afterAttrsChange.call(this,t),this.clearCacheBBox()},e.prototype.getBBox=function(){var t=this.cfg.bbox;return t||(t=this.calculateBBox(),this.set("bbox",t)),t},e.prototype.getCanvasBBox=function(){var t=this.cfg.canvasBBox;return t||(t=this.calculateCanvasBBox(),this.set("canvasBBox",t)),t},e.prototype.applyMatrix=function(t){r.prototype.applyMatrix.call(this,t),this.set("canvasBBox",null)},e.prototype.calculateCanvasBBox=function(){var t=this.getBBox(),n=this.getTotalMatrix(),i=t.minX,a=t.minY,o=t.maxX,s=t.maxY;if(n){var u=xs(n,[t.minX,t.minY]),l=xs(n,[t.maxX,t.minY]),f=xs(n,[t.minX,t.maxY]),c=xs(n,[t.maxX,t.maxY]);i=Math.min(u[0],l[0],f[0],c[0]),o=Math.max(u[0],l[0],f[0],c[0]),a=Math.min(u[1],l[1],f[1],c[1]),s=Math.max(u[1],l[1],f[1],c[1])}var h=this.attrs;if(h.shadowColor){var d=h.shadowBlur,v=d===void 0?0:d,p=h.shadowOffsetX,g=p===void 0?0:p,y=h.shadowOffsetY,m=y===void 0?0:y,b=i-v+g,x=o+v+g,_=a-v+m,S=s+v+m;i=Math.min(i,b),o=Math.max(o,x),a=Math.min(a,_),s=Math.max(s,S)}return{x:i,y:a,minX:i,minY:a,maxX:o,maxY:s,width:o-i,height:s-a}},e.prototype.clearCacheBBox=function(){this.set("bbox",null),this.set("canvasBBox",null)},e.prototype.isClipShape=function(){return this.get("isClipShape")},e.prototype.isInShape=function(t,n){return!1},e.prototype.isOnlyHitBox=function(){return!1},e.prototype.isHit=function(t,n){var i=this.get("startArrowShape"),a=this.get("endArrowShape"),o=[t,n,1];o=this.invertFromMatrix(o);var s=o[0],u=o[1],l=this._isInBBox(s,u);return this.isOnlyHitBox()?l:!!(l&&!this.isClipped(s,u)&&(this.isInShape(s,u)||i&&i.isHit(s,u)||a&&a.isHit(s,u)))},e}(Z_),Uw=new Map;function Aa(r,e){Uw.set(r,e)}function zw(r){return Uw.get(r)}function $w(r){var e=r.attr(),t=e.x,n=e.y,i=e.width,a=e.height;return{x:t,y:n,width:i,height:a}}function Vw(r){var e=r.attr(),t=e.x,n=e.y,i=e.r;return{x:t-i,y:n-i,width:i*2,height:i*2}}function Ww(r){return Math.min.apply(null,r)}function jw(r){return Math.max.apply(null,r)}function ni(r,e,t,n){var i=r-t,a=e-n;return Math.sqrt(i*i+a*a)}function Xh(r,e){return Math.abs(r-e)<.001}function Lu(r,e){var t=Ww(r),n=Ww(e),i=jw(r),a=jw(e);return{x:t,y:n,width:i-t,height:a-n}}function Hh(r){return(r+Math.PI*2)%(Math.PI*2)}var Wn={box:function(r,e,t,n){return Lu([r,t],[e,n])},length:function(r,e,t,n){return ni(r,e,t,n)},pointAt:function(r,e,t,n,i){return{x:(1-i)*r+i*t,y:(1-i)*e+i*n}},pointDistance:function(r,e,t,n,i,a){var o=(t-r)*(i-r)+(n-e)*(a-e);if(o<0)return ni(r,e,i,a);var s=(t-r)*(t-r)+(n-e)*(n-e);return o>s?ni(t,n,i,a):this.pointToLine(r,e,t,n,i,a)},pointToLine:function(r,e,t,n,i,a){var o=[t-r,n-e];if(Ix(o,[0,0]))return Math.sqrt((i-r)*(i-r)+(a-e)*(a-e));var s=[-o[1],o[0]];gs(s,s);var u=[i-r,a-e];return Math.abs(Mx(u,s))},tangentAngle:function(r,e,t,n){return Math.atan2(n-e,t-r)}},e4=1e-4;function Xw(r,e,t,n,i,a){var o,s=1/0,u=[t,n],l=20;a&&a>200&&(l=a/10);for(var f=1/l,c=f/10,h=0;h<=l;h++){var d=h*f,v=[i.apply(null,r.concat([d])),i.apply(null,e.concat([d]))],p=ni(u[0],u[1],v[0],v[1]);p<s&&(o=d,s=p)}if(o===0)return{x:r[0],y:e[0]};if(o===1){var g=r.length;return{x:r[g-1],y:e[g-1]}}s=1/0;for(var h=0;h<32&&!(c<e4);h++){var y=o-c,m=o+c,v=[i.apply(null,r.concat([y])),i.apply(null,e.concat([y]))],p=ni(u[0],u[1],v[0],v[1]);if(y>=0&&p<s)o=y,s=p;else{var b=[i.apply(null,r.concat([m])),i.apply(null,e.concat([m]))],x=ni(u[0],u[1],b[0],b[1]);m<=1&&x<s?(o=m,s=x):c*=.5}}return{x:i.apply(null,r.concat([o])),y:i.apply(null,e.concat([o]))}}function t4(r,e){for(var t=0,n=r.length,i=0;i<n;i++){var a=r[i],o=e[i],s=r[(i+1)%n],u=e[(i+1)%n];t+=ni(a,o,s,u)}return t/2}function So(r,e,t,n){var i=1-n;return i*i*r+2*n*i*e+n*n*t}function Hw(r,e,t){var n=r+t-2*e;if(Xh(n,0))return[.5];var i=(r-e)/n;return i<=1&&i>=0?[i]:[]}function Yw(r,e,t,n){return 2*(1-n)*(e-r)+2*n*(t-e)}function qw(r,e,t,n,i,a,o){var s=So(r,t,i,o),u=So(e,n,a,o),l=Wn.pointAt(r,e,t,n,o),f=Wn.pointAt(t,n,i,a,o);return[[r,e,l.x,l.y,s,u],[s,u,f.x,f.y,i,a]]}function ny(r,e,t,n,i,a,o){if(o===0)return(ni(r,e,t,n)+ni(t,n,i,a)+ni(r,e,i,a))/2;var s=qw(r,e,t,n,i,a,.5),u=s[0],l=s[1];return u.push(o-1),l.push(o-1),ny.apply(null,u)+ny.apply(null,l)}var Kw={box:function(r,e,t,n,i,a){var o=Hw(r,t,i)[0],s=Hw(e,n,a)[0],u=[r,i],l=[e,a];return o!==void 0&&u.push(So(r,t,i,o)),s!==void 0&&l.push(So(e,n,a,s)),Lu(u,l)},length:function(r,e,t,n,i,a){return ny(r,e,t,n,i,a,3)},nearestPoint:function(r,e,t,n,i,a,o,s){return Xw([r,t,i],[e,n,a],o,s,So)},pointDistance:function(r,e,t,n,i,a,o,s){var u=this.nearestPoint(r,e,t,n,i,a,o,s);return ni(u.x,u.y,o,s)},interpolationAt:So,pointAt:function(r,e,t,n,i,a,o){return{x:So(r,t,i,o),y:So(e,n,a,o)}},divide:function(r,e,t,n,i,a,o){return qw(r,e,t,n,i,a,o)},tangentAngle:function(r,e,t,n,i,a,o){var s=Yw(r,t,i,o),u=Yw(e,n,a,o),l=Math.atan2(u,s);return Hh(l)}};function Eo(r,e,t,n,i){var a=1-i;return a*a*a*r+3*e*i*a*a+3*t*i*i*a+n*i*i*i}function Zw(r,e,t,n,i){var a=1-i;return 3*(a*a*(e-r)+2*a*i*(t-e)+i*i*(n-t))}function iy(r,e,t,n){var i=-3*r+9*e-9*t+3*n,a=6*r-12*e+6*t,o=3*e-3*r,s=[],u,l,f;if(Xh(i,0))Xh(a,0)||(u=-o/a,u>=0&&u<=1&&s.push(u));else{var c=a*a-4*i*o;Xh(c,0)?s.push(-a/(2*i)):c>0&&(f=Math.sqrt(c),u=(-a+f)/(2*i),l=(-a-f)/(2*i),u>=0&&u<=1&&s.push(u),l>=0&&l<=1&&s.push(l))}return s}function Qw(r,e,t,n,i,a,o,s,u){var l=Eo(r,t,i,o,u),f=Eo(e,n,a,s,u),c=Wn.pointAt(r,e,t,n,u),h=Wn.pointAt(t,n,i,a,u),d=Wn.pointAt(i,a,o,s,u),v=Wn.pointAt(c.x,c.y,h.x,h.y,u),p=Wn.pointAt(h.x,h.y,d.x,d.y,u);return[[r,e,c.x,c.y,v.x,v.y,l,f],[l,f,p.x,p.y,d.x,d.y,o,s]]}function ay(r,e,t,n,i,a,o,s,u){if(u===0)return t4([r,t,i,o],[e,n,a,s]);var l=Qw(r,e,t,n,i,a,o,s,.5),f=l[0],c=l[1];return f.push(u-1),c.push(u-1),ay.apply(null,f)+ay.apply(null,c)}var cf={extrema:iy,box:function(r,e,t,n,i,a,o,s){for(var u=[r,o],l=[e,s],f=iy(r,t,i,o),c=iy(e,n,a,s),h=0;h<f.length;h++)u.push(Eo(r,t,i,o,f[h]));for(var h=0;h<c.length;h++)l.push(Eo(e,n,a,s,c[h]));return Lu(u,l)},length:function(r,e,t,n,i,a,o,s){return ay(r,e,t,n,i,a,o,s,3)},nearestPoint:function(r,e,t,n,i,a,o,s,u,l,f){return Xw([r,t,i,o],[e,n,a,s],u,l,Eo,f)},pointDistance:function(r,e,t,n,i,a,o,s,u,l,f){var c=this.nearestPoint(r,e,t,n,i,a,o,s,u,l,f);return ni(c.x,c.y,u,l)},interpolationAt:Eo,pointAt:function(r,e,t,n,i,a,o,s,u){return{x:Eo(r,t,i,o,u),y:Eo(e,n,a,s,u)}},divide:function(r,e,t,n,i,a,o,s,u){return Qw(r,e,t,n,i,a,o,s,u)},tangentAngle:function(r,e,t,n,i,a,o,s,u){var l=Zw(r,t,i,o,u),f=Zw(e,n,a,s,u);return Hh(Math.atan2(f,l))}};function Jw(r,e){var t=Math.abs(r);return e>0?t:t*-1}var r4={box:function(r,e,t,n){return{x:r-t,y:e-n,width:t*2,height:n*2}},length:function(r,e,t,n){return Math.PI*(3*(t+n)-Math.sqrt((3*t+n)*(t+3*n)))},nearestPoint:function(r,e,t,n,i,a){var o=t,s=n;if(o===0||s===0)return{x:r,y:e};for(var u=i-r,l=a-e,f=Math.abs(u),c=Math.abs(l),h=o*o,d=s*s,v=Math.PI/4,p,g,y=0;y<4;y++){p=o*Math.cos(v),g=s*Math.sin(v);var m=(h-d)*Math.pow(Math.cos(v),3)/o,b=(d-h)*Math.pow(Math.sin(v),3)/s,x=p-m,_=g-b,S=f-m,E=c-b,C=Math.hypot(_,x),M=Math.hypot(E,S),w=C*Math.asin((x*E-_*S)/(C*M)),T=w/Math.sqrt(h+d-p*p-g*g);v+=T,v=Math.min(Math.PI/2,Math.max(0,v))}return{x:r+Jw(p,u),y:e+Jw(g,l)}},pointDistance:function(r,e,t,n,i,a){var o=this.nearestPoint(r,e,t,n,i,a);return ni(o.x,o.y,i,a)},pointAt:function(r,e,t,n,i){var a=2*Math.PI*i;return{x:r+t*Math.cos(a),y:e+n*Math.sin(a)}},tangentAngle:function(r,e,t,n,i){var a=2*Math.PI*i,o=Math.atan2(n*Math.cos(a),-t*Math.sin(a));return Hh(o)}};function n4(r,e,t,n,i,a,o,s){return-1*t*Math.cos(i)*Math.sin(s)-n*Math.sin(i)*Math.cos(s)}function i4(r,e,t,n,i,a,o,s){return-1*t*Math.sin(i)*Math.sin(s)+n*Math.cos(i)*Math.cos(s)}function a4(r,e,t){return Math.atan(-e/r*Math.tan(t))}function o4(r,e,t){return Math.atan(e/(r*Math.tan(t)))}function eS(r,e,t,n,i,a){return t*Math.cos(i)*Math.cos(a)-n*Math.sin(i)*Math.sin(a)+r}function tS(r,e,t,n,i,a){return t*Math.sin(i)*Math.cos(a)+n*Math.cos(i)*Math.sin(a)+e}function s4(r,e,t,n){var i=Math.atan2(n*r,t*e);return(i+Math.PI*2)%(Math.PI*2)}function rS(r,e,t){return{x:r*Math.cos(t),y:e*Math.sin(t)}}function nS(r,e,t){var n=Math.cos(t),i=Math.sin(t);return[r*n-e*i,r*i+e*n]}var u4={box:function(r,e,t,n,i,a,o){for(var s=a4(t,n,i),u=1/0,l=-1/0,f=[a,o],c=-Math.PI*2;c<=Math.PI*2;c+=Math.PI){var h=s+c;a<o?a<h&&h<o&&f.push(h):o<h&&h<a&&f.push(h)}for(var c=0;c<f.length;c++){var d=eS(r,e,t,n,i,f[c]);d<u&&(u=d),d>l&&(l=d)}for(var v=o4(t,n,i),p=1/0,g=-1/0,y=[a,o],c=-Math.PI*2;c<=Math.PI*2;c+=Math.PI){var m=v+c;a<o?a<m&&m<o&&y.push(m):o<m&&m<a&&y.push(m)}for(var c=0;c<y.length;c++){var b=tS(r,e,t,n,i,y[c]);b<p&&(p=b),b>g&&(g=b)}return{x:u,y:p,width:l-u,height:g-p}},length:function(r,e,t,n,i,a,o){},nearestPoint:function(r,e,t,n,i,a,o,s,u){var l=nS(s-r,u-e,-i),f=l[0],c=l[1],h=r4.nearestPoint(0,0,t,n,f,c),d=s4(t,n,h.x,h.y);d<a?h=rS(t,n,a):d>o&&(h=rS(t,n,o));var v=nS(h.x,h.y,i);return{x:v[0]+r,y:v[1]+e}},pointDistance:function(r,e,t,n,i,a,o,s,u){var l=this.nearestPoint(r,e,t,n,s,u);return ni(l.x,l.y,s,u)},pointAt:function(r,e,t,n,i,a,o,s){var u=(o-a)*s+a;return{x:eS(r,e,t,n,i,u),y:tS(r,e,t,n,i,u)}},tangentAngle:function(r,e,t,n,i,a,o,s){var u=(o-a)*s+a,l=n4(r,e,t,n,i,a,o,u),f=i4(r,e,t,n,i,a,o,u);return Hh(Math.atan2(f,l))}};function iS(r){for(var e=0,t=[],n=0;n<r.length-1;n++){var i=r[n],a=r[n+1],o=ni(i[0],i[1],a[0],a[1]),s={from:i,to:a,length:o};t.push(s),e+=o}return{segments:t,totalLength:e}}function l4(r){if(r.length<2)return 0;for(var e=0,t=0;t<r.length-1;t++){var n=r[t],i=r[t+1];e+=ni(n[0],n[1],i[0],i[1])}return e}function f4(r,e){if(e>1||e<0||r.length<2)return null;var t=iS(r),n=t.segments,i=t.totalLength;if(i===0)return{x:r[0][0],y:r[0][1]};for(var a=0,o=null,s=0;s<n.length;s++){var u=n[s],l=u.from,f=u.to,c=u.length/i;if(e>=a&&e<=a+c){var h=(e-a)/c;o=Wn.pointAt(l[0],l[1],f[0],f[1],h);break}a+=c}return o}function c4(r,e){if(e>1||e<0||r.length<2)return 0;for(var t=iS(r),n=t.segments,i=t.totalLength,a=0,o=0,s=0;s<n.length;s++){var u=n[s],l=u.from,f=u.to,c=u.length/i;if(e>=a&&e<=a+c){o=Math.atan2(f[1]-l[1],f[0]-l[0]);break}a+=c}return o}function h4(r,e,t){for(var n=1/0,i=0;i<r.length-1;i++){var a=r[i],o=r[i+1],s=Wn.pointDistance(a[0],a[1],o[0],o[1],e,t);s<n&&(n=s)}return n}var aS={box:function(r){for(var e=[],t=[],n=0;n<r.length;n++){var i=r[n];e.push(i[0]),t.push(i[1])}return Lu(e,t)},length:function(r){return l4(r)},pointAt:function(r,e){return f4(r,e)},pointDistance:function(r,e,t){return h4(r,e,t)},tangentAngle:function(r,e){return c4(r,e)}};function oS(r,e){return!r||!e?r||e:{minX:Math.min(r.minX,e.minX),minY:Math.min(r.minY,e.minY),maxX:Math.max(r.maxX,e.maxX),maxY:Math.max(r.maxY,e.maxY)}}function oy(r,e){var t=r.get("startArrowShape"),n=r.get("endArrowShape"),i=null,a=null;return t&&(i=t.getCanvasBBox(),e=oS(e,i)),n&&(a=n.getCanvasBBox(),e=oS(e,a)),e}function d4(r){for(var e=r.attr(),t=e.points,n=[],i=[],a=0;a<t.length;a++){var o=t[a];n.push(o[0]),i.push(o[1])}var s=Lu(n,i),u=s.x,l=s.y,f=s.width,c=s.height,h={minX:u,minY:l,maxX:u+f,maxY:l+c};return h=oy(r,h),{x:h.minX,y:h.minY,width:h.maxX-h.minX,height:h.maxY-h.minY}}function v4(r){for(var e=r.attr(),t=e.points,n=[],i=[],a=0;a<t.length;a++){var o=t[a];n.push(o[0]),i.push(o[1])}return Lu(n,i)}var sy=null;function sS(){if(!sy){var r=document.createElement("canvas");r.width=1,r.height=1,sy=r.getContext("2d")}return sy}function uS(r,e,t){var n=1;if(Xe(r)&&(n=r.split(`
`).length),n>1){var i=p4(e,t);return e*n+i*(n-1)}return e}function p4(r,e){return e?e-r:r*.14}function g4(r,e){var t=sS(),n=0;if(yt(r)||r==="")return n;if(t.save(),t.font=e,Xe(r)&&r.includes(`
`)){var i=r.split(`
`);xe(i,function(a){var o=t.measureText(a).width;n<o&&(n=o)})}else n=t.measureText(r).width;return t.restore(),n}function lS(r){var e=r.fontSize,t=r.fontFamily,n=r.fontWeight,i=r.fontStyle,a=r.fontVariant;return[i,a,n,e+"px",t].join(" ").trim()}function y4(r){var e=r.attr(),t=e.x,n=e.y,i=e.text,a=e.fontSize,o=e.lineHeight,s=e.font;s||(s=lS(e));var u=g4(i,s),l;if(!u)l={x:t,y:n,width:0,height:0};else{var f=e.textAlign,c=e.textBaseline,h=uS(i,a,o),d={x:t,y:n-h};f&&(f==="end"||f==="right"?d.x-=u:f==="center"&&(d.x-=u/2)),c&&(c==="top"?d.y+=h:c==="middle"&&(d.y+=h/2)),l={x:d.x,y:d.y,width:u,height:h}}return l}var m4=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/ig,b4=/[^\s\,]+/ig;function x4(r){var e=r||[];if(At(e))return e;if(Xe(e))return e=e.match(m4),xe(e,function(t,n){if(t=t.match(b4),t[0].length>1){var i=t[0].charAt(0);t.splice(1,0,t[0].substr(1)),t[0]=i}xe(t,function(a,o){isNaN(a)||(t[o]=+a)}),e[n]=t}),e}function _4(r,e,t){var n=[0,0,0,0,0,0,0,0,0];return Gl(n,t),zn(r,n,e)}function w4(r,e,t){var n=[0,0,0,0,0,0,0,0,0];return Fl(n,t),zn(r,n,e)}function S4(r,e,t){var n=[0,0,0,0,0,0,0,0,0];return Ul(n,t),zn(r,n,e)}function E4(r,e,t){return zn(r,t,e)}function Yh(r,e){for(var t=r?[].concat(r):[1,0,0,0,1,0,0,0,1],n=0,i=e.length;n<i;n++){var a=e[n];switch(a[0]){case"t":_4(t,t,[a[1],a[2]]);break;case"s":S4(t,t,[a[1],a[2]]);break;case"r":w4(t,t,a[1]);break;case"m":E4(t,t,a[1]);break}}return t}function C4(r,e,t,n){var i=[],a=!!n,o,s,u,l,f,c,h;if(a){u=n[0],l=n[1];for(var d=0,v=r.length;d<v;d+=1){var p=r[d];u=vs([0,0],u,p),l=ps([0,0],l,p)}}for(var d=0,g=r.length;d<g;d+=1){var p=r[d];if(d===0&&!t)h=p;else if(d===g-1&&!t)c=p,i.push(h),i.push(c);else{var y=[d?d-1:g-1,d-1][t?0:1];o=r[y],s=r[t?(d+1)%g:d+1];var m=[0,0];m=gg(m,s,o),m=ci(m,m,e);var b=Tx(p,o),x=Tx(p,s),_=b+x;_!==0&&(b/=_,x/=_);var S=ci([0,0],m,-b),E=ci([0,0],m,x);c=Hn([0,0],p,S),f=Hn([0,0],p,E),f=vs([0,0],f,ps([0,0],s,p)),f=ps([0,0],f,vs([0,0],s,p)),S=gg([0,0],f,p),S=ci([0,0],S,-b/x),c=Hn([0,0],p,S),c=vs([0,0],c,ps([0,0],o,p)),c=ps([0,0],c,vs([0,0],o,p)),E=gg([0,0],p,c),E=ci([0,0],E,x/b),f=Hn([0,0],p,E),a&&(c=ps([0,0],c,u),c=vs([0,0],c,l),f=ps([0,0],f,u),f=vs([0,0],f,l)),i.push(h),i.push(c),h=f}}return t&&i.push(i.shift()),i}function fS(r,e,t){e===void 0&&(e=!1),t===void 0&&(t=[[0,0],[1,1]]);for(var n=!!e,i=[],a=0,o=r.length;a<o;a+=2)i.push([r[a],r[a+1]]);for(var s=C4(i,.4,n,t),u=i.length,l=[],f,c,h,a=0;a<u-1;a+=1)f=s[a*2],c=s[a*2+1],h=i[a+1],l.push(["C",f[0],f[1],c[0],c[1],h[0],h[1]]);return n&&(f=s[u],c=s[u+1],h=i[0],l.push(["C",f[0],f[1],c[0],c[1],h[0],h[1]])),l}var hf=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,A4=new RegExp("([a-z])["+hf+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+hf+"]*,?["+hf+"]*)+)","ig"),T4=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+hf+"]*,?["+hf+"]*","ig");function uy(r){if(!r)return null;if(At(r))return r;var e={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},t=[];return String(r).replace(A4,function(n,i,a){var o=[],s=i.toLowerCase();if(a.replace(T4,function(u,l){l&&o.push(+l)}),s==="m"&&o.length>2&&(t.push([i].concat(o.splice(0,2))),s="l",i=i==="m"?"l":"L"),s==="o"&&o.length===1&&t.push([i,o[0]]),s==="r")t.push([i].concat(o));else for(;o.length>=e[s]&&(t.push([i].concat(o.splice(0,e[s]))),!!e[s]););return""}),t}var M4=/[a-z]/;function cS(r,e){return[e[0]+(e[0]-r[0]),e[1]+(e[1]-r[1])]}function hS(r){var e=uy(r);if(!e||!e.length)return[["M",0,0]];for(var t=!1,n=0;n<e.length;n++){var i=e[n][0];if(M4.test(i)||["V","H","T","S"].indexOf(i)>=0){t=!0;break}}if(!t)return e;var a=[],o=0,s=0,u=0,l=0,f=0,c=e[0];(c[0]==="M"||c[0]==="m")&&(o=+c[1],s=+c[2],u=o,l=s,f++,a[0]=["M",o,s]);for(var n=f,h=e.length;n<h;n++){var d=e[n],v=a[n-1],p=[],i=d[0],g=i.toUpperCase();if(i!==g)switch(p[0]=g,g){case"A":p[1]=d[1],p[2]=d[2],p[3]=d[3],p[4]=d[4],p[5]=d[5],p[6]=+d[6]+o,p[7]=+d[7]+s;break;case"V":p[1]=+d[1]+s;break;case"H":p[1]=+d[1]+o;break;case"M":u=+d[1]+o,l=+d[2]+s,p[1]=u,p[2]=l;break;default:for(var y=1,m=d.length;y<m;y++)p[y]=+d[y]+(y%2?o:s)}else p=e[n];switch(g){case"Z":o=+u,s=+l;break;case"H":o=p[1],p=["L",o,s];break;case"V":s=p[1],p=["L",o,s];break;case"T":o=p[1],s=p[2];var b=cS([v[1],v[2]],[v[3],v[4]]);p=["Q",b[0],b[1],o,s];break;case"S":o=p[p.length-2],s=p[p.length-1];var x=v.length,_=cS([v[x-4],v[x-3]],[v[x-2],v[x-1]]);p=["C",_[0],_[1],p[1],p[2],o,s];break;case"M":u=p[p.length-2],l=p[p.length-1];break;default:o=p[p.length-2],s=p[p.length-1]}a.push(p)}return a}function qh(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function ly(r,e){return qh(r)*qh(e)?(r[0]*e[0]+r[1]*e[1])/(qh(r)*qh(e)):1}function dS(r,e){return(r[0]*e[1]<r[1]*e[0]?-1:1)*Math.acos(ly(r,e))}function fy(r,e){return r[0]===e[0]&&r[1]===e[1]}function I4(r,e){var t=e[1],n=e[2],i=hh(dh(e[3]),Math.PI*2),a=e[4],o=e[5],s=r[0],u=r[1],l=e[6],f=e[7],c=Math.cos(i)*(s-l)/2+Math.sin(i)*(u-f)/2,h=-1*Math.sin(i)*(s-l)/2+Math.cos(i)*(u-f)/2,d=c*c/(t*t)+h*h/(n*n);d>1&&(t*=Math.sqrt(d),n*=Math.sqrt(d));var v=t*t*(h*h)+n*n*(c*c),p=v?Math.sqrt((t*t*(n*n)-v)/v):1;a===o&&(p*=-1),isNaN(p)&&(p=0);var g=n?p*t*h/n:0,y=t?p*-n*c/t:0,m=(s+l)/2+Math.cos(i)*g-Math.sin(i)*y,b=(u+f)/2+Math.sin(i)*g+Math.cos(i)*y,x=[(c-g)/t,(h-y)/n],_=[(-1*c-g)/t,(-1*h-y)/n],S=dS([1,0],x),E=dS(x,_);return ly(x,_)<=-1&&(E=Math.PI),ly(x,_)>=1&&(E=0),o===0&&E>0&&(E=E-2*Math.PI),o===1&&E<0&&(E=E+2*Math.PI),{cx:m,cy:b,rx:fy(r,[l,f])?0:t,ry:fy(r,[l,f])?0:n,startAngle:S,endAngle:S+E,xRotation:i,arcFlag:a,sweepFlag:o}}function vS(r,e){return[e[0]+(e[0]-r[0]),e[1]+(e[1]-r[1])]}function pS(r){r=x4(r);for(var e=[],t=null,n=null,i=null,a=0,o=r.length,s=0;s<o;s++){var u=r[s];n=r[s+1];var l=u[0],f={command:l,prePoint:t,params:u,startTangent:null,endTangent:null};switch(l){case"M":i=[u[1],u[2]],a=s;break;case"A":var c=I4(t,u);f.arcParams=c;break}if(l==="Z")t=i,n=r[a+1];else{var h=u.length;t=[u[h-2],u[h-1]]}n&&n[0]==="Z"&&(n=r[a],e[a]&&(e[a].prePoint=t)),f.currentPoint=t,e[a]&&fy(t,e[a].currentPoint)&&(e[a].prePoint=f.prePoint);var d=n?[n[n.length-2],n[n.length-1]]:null;f.nextPoint=d;var v=f.prePoint;if(["L","H","V"].includes(l))f.startTangent=[v[0]-t[0],v[1]-t[1]],f.endTangent=[t[0]-v[0],t[1]-v[1]];else if(l==="Q"){var p=[u[1],u[2]];f.startTangent=[v[0]-p[0],v[1]-p[1]],f.endTangent=[t[0]-p[0],t[1]-p[1]]}else if(l==="T"){var g=e[s-1],p=vS(g.currentPoint,v);g.command==="Q"?(f.command="Q",f.startTangent=[v[0]-p[0],v[1]-p[1]],f.endTangent=[t[0]-p[0],t[1]-p[1]]):(f.command="TL",f.startTangent=[v[0]-t[0],v[1]-t[1]],f.endTangent=[t[0]-v[0],t[1]-v[1]])}else if(l==="C"){var y=[u[1],u[2]],m=[u[3],u[4]];f.startTangent=[v[0]-y[0],v[1]-y[1]],f.endTangent=[t[0]-m[0],t[1]-m[1]],f.startTangent[0]===0&&f.startTangent[1]===0&&(f.startTangent=[y[0]-m[0],y[1]-m[1]]),f.endTangent[0]===0&&f.endTangent[1]===0&&(f.endTangent=[m[0]-y[0],m[1]-y[1]])}else if(l==="S"){var g=e[s-1],y=vS(g.currentPoint,v),m=[u[1],u[2]];g.command==="C"?(f.command="C",f.startTangent=[v[0]-y[0],v[1]-y[1]],f.endTangent=[t[0]-m[0],t[1]-m[1]]):(f.command="SQ",f.startTangent=[v[0]-m[0],v[1]-m[1]],f.endTangent=[t[0]-m[0],t[1]-m[1]])}else if(l==="A"){var b=.001,x=f.arcParams||{},_=x.cx,S=_===void 0?0:_,E=x.cy,C=E===void 0?0:E,M=x.rx,w=M===void 0?0:M,T=x.ry,I=T===void 0?0:T,k=x.sweepFlag,O=k===void 0?0:k,U=x.startAngle,q=U===void 0?0:U,K=x.endAngle,le=K===void 0?0:K;O===0&&(b*=-1);var he=w*Math.cos(q-b)+S,te=I*Math.sin(q-b)+C;f.startTangent=[he-i[0],te-i[1]];var se=w*Math.cos(q+le+b)+S,ge=I*Math.sin(q+le-b)+C;f.endTangent=[v[0]-se,v[1]-ge]}e.push(f)}return e}function k4(r,e){for(var t=[],n=[],i=[],a=0;a<r.length;a++){var o=r[a],s=o.currentPoint,u=o.params,l=o.prePoint,f=void 0;switch(o.command){case"Q":f=Kw.box(l[0],l[1],u[1],u[2],u[3],u[4]);break;case"C":f=cf.box(l[0],l[1],u[1],u[2],u[3],u[4],u[5],u[6]);break;case"A":var c=o.arcParams;f=u4.box(c.cx,c.cy,c.rx,c.ry,c.xRotation,c.startAngle,c.endAngle);break;default:t.push(s[0]),n.push(s[1]);break}f&&(o.box=f,t.push(f.x,f.x+f.width),n.push(f.y,f.y+f.height)),e&&(o.command==="L"||o.command==="M")&&o.prePoint&&o.nextPoint&&i.push(o)}t=t.filter(function(y){return!Number.isNaN(y)}),n=n.filter(function(y){return!Number.isNaN(y)});var h=Bi(t),d=Bi(n),v=Ri(t),p=Ri(n);if(i.length===0)return{x:h,y:d,width:v-h,height:p-d};for(var a=0;a<i.length;a++){var o=i[a],s=o.currentPoint,g=void 0;s[0]===h?(g=Kh(o,e),h=h-g.xExtra):s[0]===v&&(g=Kh(o,e),v=v+g.xExtra),s[1]===d?(g=Kh(o,e),d=d-g.yExtra):s[1]===p&&(g=Kh(o,e),p=p+g.yExtra)}return{x:h,y:d,width:v-h,height:p-d}}function Kh(r,e){var t=r.prePoint,n=r.currentPoint,i=r.nextPoint,a=Math.pow(n[0]-t[0],2)+Math.pow(n[1]-t[1],2),o=Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2),s=Math.pow(t[0]-i[0],2)+Math.pow(t[1]-i[1],2),u=Math.acos((a+o-s)/(2*Math.sqrt(a)*Math.sqrt(o)));if(!u||Math.sin(u)===0||ox(u,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(i[1]-n[1],i[0]-n[0])),f=Math.abs(Math.atan2(i[0]-n[0],i[1]-n[1]));l=l>Math.PI/2?Math.PI-l:l,f=f>Math.PI/2?Math.PI-f:f;var c={xExtra:Math.cos(u/2-l)*(e/2*(1/Math.sin(u/2)))-e/2||0,yExtra:Math.cos(f-u/2)*(e/2*(1/Math.sin(u/2)))-e/2||0};return c}function D4(r){var e=r.attr(),t=e.path,n=e.stroke,i=n?e.lineWidth:0,a=r.get("segments")||pS(t),o=k4(a,i),s=o.x,u=o.y,l=o.width,f=o.height,c={minX:s,minY:u,maxX:s+l,maxY:u+f};return c=oy(r,c),{x:c.minX,y:c.minY,width:c.maxX-c.minX,height:c.maxY-c.minY}}function P4(r){var e=r.attr(),t=e.x1,n=e.y1,i=e.x2,a=e.y2,o=Math.min(t,i),s=Math.max(t,i),u=Math.min(n,a),l=Math.max(n,a),f={minX:o,maxX:s,minY:u,maxY:l};return f=oy(r,f),{x:f.minX,y:f.minY,width:f.maxX-f.minX,height:f.maxY-f.minY}}function N4(r){var e=r.attr(),t=e.x,n=e.y,i=e.rx,a=e.ry;return{x:t-i,y:n-a,width:i*2,height:a*2}}Aa("rect",$w);Aa("image",$w);Aa("circle",Vw);Aa("marker",Vw);Aa("polyline",d4);Aa("polygon",v4);Aa("text",y4);Aa("path",D4);Aa("line",P4);Aa("ellipse",N4);var L4=function(r){$t(e,r);function e(t,n){var i=r.call(this,t,n)||this;return i.item=n.item,i.canvasX=n.canvasX,i.canvasY=n.canvasY,i.wheelDelta=n.wheelDelta,i.detail=n.detail,i}return e}(U_),cy=function(e){return e+"-"+Math.random()+Date.now()},hy=function(e){var t=0,n=0,i=0,a=0;if(Lt(e))t=n=i=a=e;else if(Xe(e)){var o=parseInt(e,10);t=n=i=a=o}else At(e)&&(t=e[0],i=yt(e[1])?e[0]:e[1],a=yt(e[2])?e[0]:e[2],n=yt(e[3])?i:e[3]);return[t,i,a,n]},O4=function(e){var t=new L4(e.type,e);return t.clientX=e.clientX,t.clientY=e.clientY,t.x=e.x,t.y=e.y,t.target=e.target,t.currentTarget=e.currentTarget,t.bubbles=!0,t.item=e.item,t},R4=function(e){if(!e)return!1;for(var t=9,n=[1,0,0,0,1,0,0,0,1],i=0;i<t;i++)if(e[i]!==n[i])return!0;return!1},Zh=function(e){return Number.isNaN(Number(e))},gS=function(e){for(var t=1/0,n=-1/0,i=1/0,a=-1/0,o=0;o<e.length;o++){var s=e[o],u=s.getBBox(),l=u.minX,f=u.minY,c=u.maxX,h=u.maxY;l<t&&(t=l),f<i&&(i=f),c>n&&(n=c),h>a&&(a=h)}var d=Math.floor(t),v=Math.floor(i),p=Math.ceil(n)-Math.floor(t),g=Math.ceil(a)-Math.floor(i);return{x:d,y:v,width:p,height:g,minX:t,minY:i,maxX:n,maxY:a}},B4=function(e,t,n,i,a){t===void 0&&(t=15),n===void 0&&(n="quadratic"),i===void 0&&(i=void 0),a===void 0&&(a=void 0);for(var o=e.length,s=t*2,u=["top","top-right","right","bottom-right","bottom","bottom-left","left","top-left"],l={},f=[],c={},h=0;h<o;h++){var d=e[h],v=d.source,p=d.target,g=v+"-"+p;if(!f[h]){l[g]||(l[g]=[]),f[h]=!0,l[g].push(d);for(var y=0;y<o;y++)if(h!==y){var m=e[y],b=m.source,x=m.target;f[y]||(v===x&&p===b?(l[g].push(m),f[y]=!0,c[b+"|"+x+"|"+(l[g].length-1)]=!0):v===b&&p===x&&(l[g].push(m),f[y]=!0))}}}for(var _ in l)for(var S=l[_],E=S.length,C=0;C<E;C++){var M=S[C];if(M.source===M.target){a&&(M.type=a),M.loopCfg={position:u[C%8],dist:Math.floor(C/8)*20+50};continue}if(E===1&&i&&M.source!==M.target){M.type=i;continue}M.type=n;var w=(C%2==0?1:-1)*(c[M.source+"|"+M.target+"|"+C]?-1:1);E%2==1?M.curveOffset=w*Math.ceil(C/2)*s:M.curveOffset=w*(Math.floor(C/2)*s+t)}return e},G4=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uniqueId:cy,formatPadding:hy,cloneEvent:O4,isViewportChanged:R4,isNaN:Zh,calculationItemsBBox:gS,processParallelEdges:B4}),F4=function(){function r(e){this.destroyed=!1,this.graph=e,this.destroyed=!1}return r.prototype.getViewCenter=function(){var e=this.getFormatPadding(),t=this.graph,n=this.graph.get("width"),i=t.get("height");return{x:(n-e[1]-e[3])/2+e[3],y:(i-e[0]-e[2])/2+e[0]}},r.prototype.fitCenter=function(){var e=this.graph,t=e.get("group");t.resetMatrix();var n=t.getCanvasBBox();if(!(n.width===0||n.height===0)){var i=this.getViewCenter(),a={x:n.x+n.width/2,y:n.y+n.height/2};e.translate(i.x-a.x,i.y-a.y)}},r.prototype.fitView=function(){var e=this.graph,t=this.getFormatPadding(),n=e.get("width"),i=e.get("height"),a=e.get("group");a.resetMatrix();var o=a.getCanvasBBox();if(!(o.width===0||o.height===0)){var s=this.getViewCenter(),u={x:o.x+o.width/2,y:o.y+o.height/2};e.translate(s.x-u.x,s.y-u.y);var l=(n-t[1]-t[3])/o.width,f=(i-t[0]-t[2])/o.height,c=l;l>f&&(c=f),e.zoom(c,s)||console.warn("zoom failed, ratio out of range, ratio: %f",c)}},r.prototype.getFormatPadding=function(){var e=this.graph.get("fitViewPadding");return hy(e)},r.prototype.focusPoint=function(e,t,n){var i=this,a=this.getViewCenter(),o=this.getPointByCanvas(a.x,a.y),s=this.graph.get("group").getMatrix();if(s||(s=[1,0,0,0,1,0,0,0,1]),t){var u=(o.x-e.x)*s[0],l=(o.y-e.y)*s[4],f=0,c=0,h=0,d=0;this.graph.get("canvas").animate(function(v){h=u*v,d=l*v,i.graph.translate(h-f,d-c),f=h,c=d},L({},n))}else this.graph.translate((o.x-e.x)*s[0],(o.y-e.y)*s[4])},r.prototype.getPointByCanvas=function(e,t){var n=this.graph.get("group").getMatrix();n||(n=[1,0,0,0,1,0,0,0,1]);var i=c_({x:e,y:t},n);return i},r.prototype.getPointByClient=function(e,t){var n=this.graph.get("canvas"),i=n.getPointByClient(e,t);return this.getPointByCanvas(i.x,i.y)},r.prototype.getClientByPoint=function(e,t){var n=this.graph.get("canvas"),i=this.getCanvasByPoint(e,t),a=n.getClientByPoint(i.x,i.y);return{x:a.x,y:a.y}},r.prototype.getCanvasByPoint=function(e,t){var n=this.graph.get("group").getMatrix();return n||(n=[1,0,0,0,1,0,0,0,1]),kh({x:e,y:t},n)},r.prototype.focus=function(e,t,n){if(Xe(e)&&(e=this.graph.findById(e)),e){var i=0,a=0;if(e.getType&&e.getType()==="edge"){var o=e.getSource().get("group").getMatrix(),s=e.getTarget().get("group").getMatrix();o&&s?(i=(o[6]+s[6])/2,a=(o[7]+s[7])/2):(o||s)&&(i=o?o[6]:s[6],a=o?o[7]:s[7])}else{var u=e.get("group"),l=u.getMatrix();l||(l=[1,0,0,0,1,0,0,0,1]),i=l[6],a=l[7]}this.focusPoint({x:i,y:a},t,n)}},r.prototype.changeSize=function(e,t){var n=this.graph;if(!Lt(e)||!Lt(t))throw Error("invalid canvas width & height, please make sure width & height type is number");n.set({width:e,height:t});var i=n.get("canvas");i.changeSize(e,t);var a=n.get("plugins");a.forEach(function(o){o.get("gridContainer")&&o.positionInit()})},r.prototype.destroy=function(){this.graph=null,this.destroyed=!1},r}();function Qh(r){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Qh=function(t){return typeof t}:Qh=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qh(r)}function yS(r){if(typeof r!="string")return r;var e=function(E){if(typeof E!="string")return E;try{return JSON.parse(E.trim())}catch(C){return E.trim()}},t=e(r);if(typeof t!="string")return t;for(var n=function(E){return E[E.length-1]},i=r.trim(),a=[],o=[],s=function(){for(var E=[],C=0;C<arguments.length;C++)E[C]=arguments[C];return E.some(function(M){return n(o)===M})},u=function(){return n(a)},l=null,f=0,c="";f<i.length;){var h=i[f],d=s('"',"'");if(!d&&!h.trim()){f+=1;continue}var v=i[f-1]==="\\",p=s("}"),g=s("]"),y=s(","),m=u();if(d)if(n(o)===h&&!v){o.pop();var b=e(c);m.push(b),l=b,c=""}else c+=h;else if(g&&h===",")c&&(m.push(e(c)),c="");else if(p&&h===":")o.push(","),c&&(m.push(c),c="");else if(y&&h===",")c&&(m.push(e(c)),c=""),o.pop();else if(h==="}"&&(p||y)){c&&(m.push(e(c)),c=""),y&&o.pop();for(var x={},_=1;_<m.length;_+=2)x[m[_-1]]=m[_];a.pop(),a.length&&n(a).push(x),o.pop(),l=x}else h==="]"&&g?(c&&(m.push(e(c)),c=""),a.pop(),a.length&&n(a).push(m),o.pop(),l=m):h==="{"?(a.push([]),o.push("}")):h==="["?(a.push([]),o.push("]")):h==='"'?o.push('"'):h==="'"?o.push("'"):c+=h;f+=1}return l||c}var U4=function(e){return e.split("-").reduce(function(t,n){return t+n.charAt(0).toUpperCase()+n.slice(1)})},z4=function(e){return function(t){for(var n=e.length,i=[],a=0,o="";a<n;)if(e[a]==="{"&&e[a+1]==="{")i.push(o),o="",a+=2;else if(e[a]==="}"&&e[a+1]==="}"){if(i.length){var s=i.pop();o=$a(t,o,s.endsWith("=")?'"{'+o+'}"':o),i.push(s+o)}a+=2,o=""}else o+=e[a],a+=1;return i.push(o),i.map(function(u,l){return i[l-1]&&i[l-1].endsWith("=")?'"{'+u+'}"':u}).join("")}};function mS(r,e){var t={},n=r.getAttributeNames&&r.getAttributeNames()||[],i=r.children&&Array.from(r.children).map(function(s){return mS(s,e)}),a={},o=r.tagName?r.tagName.toLowerCase():"group";return o==="text"&&(t.text=r.innerText),a.type=o,o==="img"&&(a.type="image"),Array.from(n).forEach(function(s){var u=U4(s),l=r.getAttribute(s);try{if(u==="style"||u==="attrs"){var f=yS(l);t=L(L({},t),f)}else a[u]=yS(l)}catch(c){if(u==="style")throw c;a[u]=l}}),a.attrs=t,e&&e.style&&a.name&&Qh(e.style[a.name])==="object"&&(a.attrs=L(L({},a.attrs),e.style[a.name])),e&&e.style&&a.keyshape&&(a.attrs=L(L({},a.attrs),e.style)),i.length&&(a.children=i),a}function $4(r,e,t){var n=r.attrs,i=n===void 0?{}:n,a={x:e.x||0,y:e.y||0,width:t.width||0,height:t.height||0},o,s;switch(r.type){case"maker":case"circle":i.r&&(s=2*i.r,o=2*i.r);break;case"text":i.text&&(s=M_(i.text,i.fontSize||12)[0],o=16,a.y+=o,a.height=o,a.width=s,r.attrs=L({fontSize:12,fill:"#000"},i));break;default:i.width&&(s=i.width),i.height&&(o=i.height)}return o>=0&&(a.height=o),s>=0&&(a.width=s),i.marginTop&&(a.y+=i.marginTop),i.marginLeft&&(a.x+=i.marginLeft),a}function bS(r,e){var t;e===void 0&&(e={x:0,y:0});var n=L({x:0,y:0,width:0,height:0},e);if((t=r.children)===null||t===void 0?void 0:t.length){var i=r.attrs,a=i===void 0?{}:i,o=a.marginTop,s=L({},e);o&&(s.y+=o);for(var u=0;u<r.children.length;u++){r.children[u].attrs.key=(a.key||"root")+" -"+u+" ";var l=bS(r.children[u],s);if(l.bbox){var f=l.bbox;l.attrs.next==="inline"?s.x+=l.bbox.width:s.y+=l.bbox.height,f.width+f.x>n.width&&(n.width=f.width+f.x),f.height+f.y>n.height&&(n.height=f.height+f.y)}}}return r.bbox=$4(r,e,n),r.attrs=L(L({},r.attrs),r.bbox),r}function xS(r,e){var t,n,i,a,o=(r||{}).type,s=((e==null?void 0:e.attrs)||{}).key;if(s&&r&&(r.attrs.key=s),!r&&e)return{action:"delete",val:e,type:o,key:s};if(r&&!e)return{action:"add",val:r,type:o};if(!r&&!e)return{action:"same",type:o};var u=[];if(((t=r.children)===null||t===void 0?void 0:t.length)>0||((n=e.children)===null||n===void 0?void 0:n.length)>0)for(var l=Math.max((i=r.children)===null||i===void 0?void 0:i.length,(a=e.children)===null||a===void 0?void 0:a.length),f=e.children||[],c=r.children||[],h=0;h<l;h+=1)u.push(xS(c[h],f[h]));var d=Object.keys(e.attrs),v=Object.keys(r.attrs);return e.type!==r.type?{action:"restructure",nowTarget:r,formerTarget:e,key:s,children:u}:d.filter(function(p){return p!=="children"}).some(function(p){return r.attrs[p]!==e.attrs[p]||!v.includes(p)})?{action:"change",val:r,children:u,type:o,key:s}:{action:"same",children:u,type:o,key:s}}function _S(r){var e={},t=function(i){var a=typeof r=="function"?r(i):r,o=z4(a)(i),s=document.createElement("div");s.innerHTML=o;var u=s.children[0],l=bS(mS(u,i));return s.remove(),l};return{draw:function(i,a){var o=t(i),s=a,u=function l(f){var c=f.attrs,h=c===void 0?{}:c,d=f.bbox,v=f.type,p=f.children,g=ti(f,["attrs","bbox","type","children"]);if(f.type!=="group"){var y=a.addShape(f.type,L({attrs:h,origin:{bbox:d,type:v,children:p}},g));f.keyshape&&(s=y)}f.children&&f.children.forEach(function(m){return l(m)})};return u(o),e[i.id]=[o],s},update:function(i,a){e[i.id]||(e[i.id]=[]);var o=a.getContainer(),s=o.get("children"),u=t(i),l=e[i.id].pop(),f=xS(u,l),c=function v(p){var g;p.type!=="group"&&o.addShape(p.type,{attrs:p.attrs}),((g=p.children)===null||g===void 0?void 0:g.length)&&p.children.map(function(y){return v(y)})},h=function v(p){var g,y=s.find(function(m){return m.attrs.key===p.attrs.key});y&&o.removeChild(y),((g=p.children)===null||g===void 0?void 0:g.length)&&p.children.map(function(m){return v(m)})},d=function v(p){var g=p.key;if(p.type!=="group"){var y=s.find(function(b){return b.attrs.key===g});switch(p.action){case"change":if(y){var m=p.val.keyshape?a.getOriginStyle():{};y.attr(L(L({},m),p.val.attrs))}break;case"add":c(p.val);break;case"delete":h(p.val);break;case"restructure":h(p.formerTarget),c(p.nowTarget);break}}p.children&&p.children.forEach(function(b){return v(b)})};d(f),e[i.id].push(u)},getAnchorPoints:function(){return[[0,.5],[1,.5],[.5,1],[.5,0]]}}}var dy={};function wS(r){return dy[r]||(dy[r]=Eu(r)),dy[r]}var V4={defaultShapeType:"defaultType",className:null,getShape:function(e){var t=this,n=t[e]||t[t.defaultShapeType]||t["simple-circle"];return n},draw:function(e,t,n){var i=this.getShape(e),a=i.draw(t,n);return i.afterDraw&&i.afterDraw(t,n,a),a},baseUpdate:function(e,t,n,i){var a=this.getShape(e);a.update&&a.update(t,n,i),a.afterUpdate&&a.afterUpdate(t,n)},setState:function(e,t,n,i){var a=this.getShape(e);a.setState(t,n,i)},shouldUpdate:function(e){var t=this.getShape(e);return!!t.update},getControlPoints:function(e,t){var n=this.getShape(e);return n.getControlPoints(t)},getAnchorPoints:function(e,t){var n=this.getShape(e);return n.getAnchorPoints(t)}},vy={options:{},draw:function(e,t){return this.drawShape(e,t)},drawShape:function(){},afterDraw:function(){},afterUpdate:function(){},setState:function(){},getControlPoints:function(e){return e.controlPoints},getAnchorPoints:function(e){var t=this.options.anchorPoints,n=e.anchorPoints||t;return n}},nn=function(){function r(){}return r.registerFactory=function(e,t){var n=wS(e),i=V4,a=L(L({},i),t);return r[n]=a,a.className=n,a},r.getFactory=function(e){var t=wS(e);return r[t]},r.registerNode=function(e,t,n){var i=r.Node,a;if(typeof t=="string"||typeof t=="function"){var o=_S(t);a=L(L({},i.getShape("single-node")),o)}else if(t.jsx){var s=t.jsx,o=_S(s);a=L(L(L({},i.getShape("single-node")),o),t)}else{i.getShape(n);var u=n?i.getShape(n):vy;a=L(L({},u),t)}return a.type=e,a.itemType="node",i[e]=a,a},r.registerEdge=function(e,t,n){var i=r.Edge,a=n?i.getShape(n):vy,o=L(L({},a),t);return o.type=e,o.itemType="edge",i[e]=o,o},r.registerCombo=function(e,t,n){var i=r.Combo,a=n?i.getShape(n):vy,o=L(L({},a),t);return o.type=e,o.itemType="combo",i[e]=o,o},r}();nn.registerFactory("node",{defaultShapeType:"circle"});nn.registerFactory("edge",{defaultShapeType:"line"});nn.registerFactory("combo",{defaultShapeType:"circle"});var py="bboxCache",gy="bboxCanvasCache",SS=function(){function r(e){this._cfg={},this.destroyed=!1;var t={id:void 0,type:"item",model:{},group:void 0,animate:!1,visible:!0,locked:!1,event:!0,keyShape:void 0,states:[]};this._cfg=Object.assign(t,this.getDefaultCfg(),e);var n=this.get("model"),i=n.id,a=this.get("type");i||(i=cy(a),this.get("model").id=i),this.set("id",i);var o=e.group;o&&(o.set("item",this),o.set("id",i)),this.init(),this.draw();var s=n.shape||n.type||(a==="edge"?"line":"circle"),u=this.get("shapeFactory");if(u&&u[s]){var l=u[s].options;if(l&&l.stateStyles){var f=this.get("styles")||n.stateStyles;f=Hr({},l.stateStyles,f),this.set("styles",f)}}}return r.prototype.calculateBBox=function(){var e=this.get("keyShape"),t=this.get("group"),n=Oh(e,t);return n.x=n.minX,n.y=n.minY,n.width=n.maxX-n.minX,n.height=n.maxY-n.minY,n.centerX=(n.minX+n.maxX)/2,n.centerY=(n.minY+n.maxY)/2,n},r.prototype.calculateCanvasBBox=function(){var e=this.get("keyShape"),t=this.get("group"),n=Oh(e,t);return n.x=n.minX,n.y=n.minY,n.width=n.maxX-n.minX,n.height=n.maxY-n.minY,n.centerX=(n.minX+n.maxX)/2,n.centerY=(n.minY+n.maxY)/2,n},r.prototype.drawInner=function(){var e=this,t=e.get("shapeFactory"),n=e.get("group"),i=e.get("model");n.clear();var a=i.visible;if(a!==void 0&&!a&&e.changeVisibility(a),!!t){e.updatePosition(i);var o=e.getShapeCfg(i),s=o.type,u=t.draw(s,o,n);u&&(e.set("keyShape",u),u.set("isKeyShape",!0),u.set("draggable",!0)),this.setOriginStyle(),this.set("currentShape",s),this.restoreStates(t,s)}},r.prototype.setOriginStyle=function(){var e=this.get("group"),t=e.get("children"),n=this.getKeyShape(),i=this,a=n.get("name");if(this.get("originStyle")){var s=this.getOriginStyle();a&&!s[a]&&(s[a]={});var u=this.getCurrentStatesStyle();xe(t,function(l){var f=l.get("name"),c=l.attr();if(f&&f!==a){var h=u[f];s[f]||(s[f]={}),h?Object.keys(c).forEach(function(p){var g=c[p];g!==h[p]&&(s[f][p]=g)}):s[f]=l.get("type")!=="image"?Cr(c):i.getShapeStyleByName(f)}else{var d=l.attr(),v={};Object.keys(u).forEach(function(p){var g=u[p];(!Un(g)||p===a)&&(v[p]=g)}),Object.keys(d).forEach(function(p){var g=d[p];v[p]!==g&&(a?s[a][p]=g:s[p]=g)})}}),s.path&&delete s.path,s.matrix&&delete s.matrix,s.x&&delete s.x,s.y&&delete s.y,s[a]&&(delete s[a].x,delete s[a].y,delete s[a].matrix,delete s[a].path),i.set("originStyle",s)}else{var o={};xe(t,function(l){var f=l.get("type"),c=l.get("name");if(c&&c!==a)o[c]=f!=="image"?Cr(l.attr()):i.getShapeStyleByName(c),o[c]&&f==="text"&&(delete o[c].x,delete o[c].y,delete o[c].matrix);else{var h=i.getShapeStyleByName();if(delete h.path,delete h.matrix,!a)Object.assign(o,h);else if(c)o[a]=h;else{var d=cy("shape");l.set("name",d),o[d]=f!=="image"?Cr(l.attr()):i.getShapeStyleByName(c)}}}),i.set("originStyle",o)}},r.prototype.restoreStates=function(e,t){var n=this,i=n.get("states");xe(i,function(a){e.setState(t,a,!0,n)})},r.prototype.init=function(){var e=nn.getFactory(this.get("type"));this.set("shapeFactory",e)},r.prototype.get=function(e){return this._cfg[e]},r.prototype.set=function(e,t){Un(e)?this._cfg=L(L({},this._cfg),e):this._cfg[e]=t},r.prototype.getDefaultCfg=function(){return{}},r.prototype.clearCache=function(){this.set(py,null),this.set(gy,null)},r.prototype.beforeDraw=function(){},r.prototype.afterDraw=function(){},r.prototype.afterUpdate=function(){},r.prototype.draw=function(){this.beforeDraw(),this.drawInner(),this.afterDraw()},r.prototype.getShapeStyleByName=function(e){var t=this.get("group"),n;if(e?n=t.find(function(a){return a.get("name")===e}):n=this.getKeyShape(),n){var i={};return xe(n.attr(),function(a,o){(o!=="img"||Xe(a))&&(i[o]=a)}),i}return{}},r.prototype.getShapeCfg=function(e,t){var n=this.get("styles");if(n){var i=e;return i.style=L(L({},n),e.style),i}return e},r.prototype.getStateStyle=function(e){var t=this.get("styles"),n=t&&t[e];return n},r.prototype.getOriginStyle=function(){return this.get("originStyle")},r.prototype.getCurrentStatesStyle=function(){var e=this,t={},n=e.getStates();return!n||!n.length?this.getOriginStyle():(xe(e.getStates(),function(i){t=Object.assign(t,e.getStateStyle(i))}),t)},r.prototype.setState=function(e,t){var n=this.get("states"),i=this.get("shapeFactory"),a=e,o=e;Xe(t)&&(a=e+":"+t,o=e+":");var s=n;if(tg(t)){var u=n.indexOf(o);if(t){if(u>-1)return;n.push(a)}else u>-1&&n.splice(u,1)}else if(Xe(t)){var l=n.filter(function(h){return h.includes(o)});l.length>0&&this.clearStates(l),s=s.filter(function(h){return!h.includes(o)}),s.push(a),this.set("states",s)}if(i){var f=this.get("model"),c=f.type;i.setState(c,e,t,this)}},r.prototype.clearStates=function(e){var t=this,n=t.getStates(),i=t.get("shapeFactory"),a=t.get("model"),o=a.type;e||(e=n),Xe(e)&&(e=[e]);var s=n.filter(function(u){return e.indexOf(u)===-1});t.set("states",s),e.forEach(function(u){i.setState(o,u,!1,t)})},r.prototype.getContainer=function(){return this.get("group")},r.prototype.getKeyShape=function(){return this.get("keyShape")},r.prototype.getModel=function(){return this.get("model")},r.prototype.getType=function(){return this.get("type")},r.prototype.getID=function(){return this.get("id")},r.prototype.isItem=function(){return!0},r.prototype.getStates=function(){return this.get("states")},r.prototype.hasState=function(e){var t=this.getStates();return t.indexOf(e)>=0},r.prototype.refresh=function(e){var t=this.get("model");this.updatePosition(t),this.updateShape(e),this.afterUpdate(),this.clearCache()},r.prototype.getUpdateType=function(e){},r.prototype.update=function(e,t){t===void 0&&(t=void 0);var n=this.get("model");if(t==="move")this.updatePosition(e);else{var i=n.visible,a=e.visible;i!==a&&a!==void 0&&this.changeVisibility(a);var o={x:n.x,y:n.y};e.x=isNaN(+e.x)?n.x:+e.x,e.y=isNaN(+e.y)?n.y:+e.y;var s=this.get("styles");if(e.stateStyles){var u=e.stateStyles;St(s,u),delete e.stateStyles}Object.assign(n,e),(o.x!==e.x||o.y!==e.y)&&this.updatePosition(e),this.updateShape()}this.afterUpdate(),this.clearCache()},r.prototype.updateShape=function(e){var t=this.get("shapeFactory"),n=this.get("model"),i=n.type;if(t.shouldUpdate(i)&&i===this.get("currentShape")){var a=this.getShapeCfg(n,e);t.baseUpdate(i,a,this,e),e!=="move"&&this.setOriginStyle()}else this.draw();this.restoreStates(t,i)},r.prototype.updatePosition=function(e){var t=this.get("model"),n=isNaN(+e.x)?+t.x:+e.x,i=isNaN(+e.y)?+t.y:+e.y,a=this.get("group");if(isNaN(n)||isNaN(i))return!1;t.x=n,t.y=i;var o=a.getMatrix();return o&&o[6]===n&&o[7]===i?!1:(a.resetMatrix(),h_(a,{x:n,y:i}),this.clearCache(),!0)},r.prototype.getBBox=function(){var e=this.get(py);return e||(e=this.calculateBBox(),this.set(py,e)),e},r.prototype.getCanvasBBox=function(){var e=this.get(gy);return e||(e=this.calculateCanvasBBox(),this.set(gy,e)),e},r.prototype.toFront=function(){var e=this.get("group");e.toFront()},r.prototype.toBack=function(){var e=this.get("group");e.toBack()},r.prototype.show=function(){this.changeVisibility(!0)},r.prototype.hide=function(){this.changeVisibility(!1)},r.prototype.changeVisibility=function(e){var t=this.get("group");e?t.show():t.hide(),this.set("visible",e)},r.prototype.isVisible=function(){return this.get("visible")},r.prototype.enableCapture=function(e){var t=this.get("group");t&&t.set("capture",e)},r.prototype.destroy=function(){if(!this.destroyed){var e=this.get("animate"),t=this.get("group");e&&t.stopAnimate(),this.clearCache(),t.remove(),this._cfg=null,this.destroyed=!0}},r}(),Jh={source:"start",target:"end"},Ta="Node",Ou="Point",W4="Anchor",j4=function(r){$t(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){return{type:"edge",sourceNode:null,targetNode:null,startPoint:null,endPoint:null,linkCenter:!1}},e.prototype.setEnd=function(t,n){var i=Jh[t]+Ou,a=t+Ta,o=this.get(a);o&&!o.destroyed&&o.removeEdge(this),Un(n)?(this.set(i,n),this.set(a,null)):n&&(n.addEdge(this),this.set(a,n),this.set(i,null))},e.prototype.getLinkPoint=function(t,n,i){var a=Jh[t]+Ou,o=t+Ta,s=this.get(a);if(!s){var u=this.get(o),l=t+W4,f=this.getPrePoint(t,i),c=n[l];yt(c)||(s=u.getLinkPointByAnchor(c)),s=s||u.getLinkPoint(f),yt(s.index)||this.set(t+"AnchorIndex",s.index)}return s},e.prototype.getPrePoint=function(t,n){if(n&&n.length){var i=t==="source"?0:n.length-1;return n[i]}var a=t==="source"?"target":"source";return this.getEndPoint(a)},e.prototype.getEndPoint=function(t){var n=t+Ta,i=Jh[t]+Ou,a=this.get(n);return a?a.get("model"):this.get(i)},e.prototype.getControlPointsByCenter=function(t){var n=this.getEndPoint("source"),i=this.getEndPoint("target"),a=this.get("shapeFactory"),o=t.type;return a.getControlPoints(o,{startPoint:n,endPoint:i})},e.prototype.getEndCenter=function(t){var n=t+Ta,i=Jh[t]+Ou,a=this.get(n);if(a){var o=a.getBBox();return{x:o.centerX,y:o.centerY}}return this.get(i)},e.prototype.init=function(){r.prototype.init.call(this),this.setSource(this.get("source")),this.setTarget(this.get("target"))},e.prototype.getShapeCfg=function(t,n){var i=this,a=i.get("linkCenter"),o=n==="move"?t:r.prototype.getShapeCfg.call(this,t);if(a)o.startPoint=i.getEndCenter("source"),o.endPoint=i.getEndCenter("target");else{var s=o.controlPoints||i.getControlPointsByCenter(o);o.startPoint=i.getLinkPoint("source",t,s),o.endPoint=i.getLinkPoint("target",t,s)}return o.sourceNode=i.get("sourceNode"),o.targetNode=i.get("targetNode"),o},e.prototype.getModel=function(){var t=this.get("model"),n=this.get("source"+Ta),i=this.get("target"+Ta);return n?delete t["source"+Ta]:t.source=this.get("start"+Ou),i?delete t["target"+Ta]:t.target=this.get("end"+Ou),!Xe(t.source)&&!Un(t.source)&&(t.source=t.source.getID()),!Xe(t.target)&&!Un(t.target)&&(t.target=t.target.getID()),t},e.prototype.setSource=function(t){this.setEnd("source",t),this.set("source",t)},e.prototype.setTarget=function(t){this.setEnd("target",t),this.set("target",t)},e.prototype.getSource=function(){return this.get("source")},e.prototype.getTarget=function(){return this.get("target")},e.prototype.updatePosition=function(){return!1},e.prototype.update=function(t,n){n===void 0&&(n=void 0);var i=this.get("model"),a=i.visible,o=t.visible;a!==o&&o!==void 0&&this.changeVisibility(o);var s=this.get("styles");if(t.stateStyles){var u=t.stateStyles;St(s,u),delete t.stateStyles}Object.assign(i,t),this.updateShape(n),this.afterUpdate(),this.clearCache()},e.prototype.destroy=function(){var t=this.get("source"+Ta),n=this.get("target"+Ta);t&&!t.destroyed&&t.removeEdge(this),n&&!n.destroyed&&n.removeEdge(this),r.prototype.destroy.call(this)},e}(SS),yy="anchorPointsCache",X4="bboxCache",ES=function(r){$t(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getNearestPoint=function(t,n){for(var i=0,a=t[0],o=Dh(t[0],n),s=0;s<t.length;s++){var u=t[s],l=Dh(u,n);l<o&&(a=u,o=l,i=s)}return a.anchorIndex=i,a},e.prototype.getDefaultCfg=function(){return{type:"node",edges:[]}},e.prototype.getEdges=function(){return this.get("edges")},e.prototype.getInEdges=function(){var t=this;return this.get("edges").filter(function(n){return n.get("target")===t})},e.prototype.getOutEdges=function(){var t=this;return this.get("edges").filter(function(n){return n.get("source")===t})},e.prototype.getNeighbors=function(t){var n=this,i=this.get("edges");if(t==="target"){var a=function(l){return l.getSource()===n};return i.filter(a).map(function(u){return u.getTarget()})}if(t==="source"){var o=function(l){return l.getTarget()===n};return i.filter(o).map(function(u){return u.getSource()})}var s=function(l){return l.getSource()===n?l.getTarget():l.getSource()};return i.map(s)},e.prototype.getLinkPointByAnchor=function(t){var n=this.getAnchorPoints();return n[t]},e.prototype.getLinkPoint=function(t){var n=this.get("keyShape"),i=n.get("type"),a=this.get("type"),o,s,u=this.getBBox();a==="combo"?(o=u.centerX||(u.maxX+u.minX)/2,s=u.centerY||(u.maxY+u.minY)/2):(o=u.centerX,s=u.centerY);var l=this.getAnchorPoints(),f;switch(i){case"circle":f=l_({x:o,y:s,r:u.width/2},t);break;case"ellipse":f=f_({x:o,y:s,rx:u.width/2,ry:u.height/2},t);break;default:f=u_(u,t)}var c=f;return l.length&&(c||(c=t),c=this.getNearestPoint(l,c)),c||(c={x:o,y:s}),c},e.prototype.getAnchorPoints=function(){var t=this.get(yy);if(!t){t=[];var n=this.get("shapeFactory"),i=this.getBBox(),a=this.get("model"),o=this.getShapeCfg(a),s=a.type,u=n.getAnchorPoints(s,o)||[];xe(u,function(l,f){var c={x:i.minX+l[0]*i.width,y:i.minY+l[1]*i.height,anchorIndex:f};t.push(c)}),this.set(yy,t)}return t},e.prototype.addEdge=function(t){this.get("edges").push(t)},e.prototype.lock=function(){this.set("locked",!0)},e.prototype.unlock=function(){this.set("locked",!1)},e.prototype.hasLocked=function(){return this.get("locked")},e.prototype.removeEdge=function(t){var n=this.getEdges(),i=n.indexOf(t);i>-1&&n.splice(i,1)},e.prototype.clearCache=function(){this.set(X4,null),this.set(yy,null)},e.prototype.getUpdateType=function(t){var n,i,a,o,s;if(!!t){var u=!yt(t.x),l=!yt(t.y),f=Object.keys(t);return f.length===1&&(u||l)||f.length===2&&u&&l?"move":Lt(t.x)||Lt(t.y)||t.type||t.anchorPoints||t.size||(t==null?void 0:t.style)&&(((n=t==null?void 0:t.style)===null||n===void 0?void 0:n.r)||((i=t==null?void 0:t.style)===null||i===void 0?void 0:i.width)||((a=t==null?void 0:t.style)===null||a===void 0?void 0:a.height)||((o=t==null?void 0:t.style)===null||o===void 0?void 0:o.rx)||((s=t==null?void 0:t.style)===null||s===void 0?void 0:s.ry))?"bbox":"style"}},e}(SS),CS="bboxCache",AS="bboxCanvasCache",my="sizeCache",TS="anchorPointsCache",H4=function(r){$t(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){return{type:"combo",nodes:[],edges:[],combos:[]}},e.prototype.getShapeCfg=function(t){var n=this.get("styles"),i=this.get("bbox");if(n&&i){var a=t,o={r:Math.hypot(i.height,i.width)/2||Tt.defaultCombo.size[0]/2,width:i.width||Tt.defaultCombo.size[0],height:i.height||Tt.defaultCombo.size[1]};a.style=L(L(L({},n),t.style),o);var s=t.padding||Tt.defaultCombo.padding;return Lt(s)?(o.r+=s,o.width+=s*2,o.height+=s*2):(o.r+=s[0],o.width+=s[1]+s[3]||s[1]*2,o.height+=s[0]+s[2]||s[0]*2),this.set(my,o),a}return t},e.prototype.calculateCanvasBBox=function(){if(!this.destroyed){var t=this.get("keyShape"),n=this.get("group"),i=Oh(t,n);i.centerX=(i.minX+i.maxX)/2,i.centerY=(i.minY+i.maxY)/2;var a=this.get(my),o=this.get(CS)||{},s=o.x,u=o.x;if(a){a.width=Math.max(a.width,i.width),a.height=Math.max(a.height,i.height);var l=t.get("type");l==="circle"?(i.width=a.r*2,i.height=a.r*2):(i.width=a.width,i.height=a.height),i.minX=i.centerX-i.width/2,i.minY=i.centerY-i.height/2,i.maxX=i.centerX+i.width/2,i.maxY=i.centerY+i.height/2}else i.width=i.maxX-i.minX,i.height=i.maxY-i.minY,i.centerX=(i.minX+i.maxX)/2,i.centerY=(i.minY+i.maxY)/2;return i.x=i.minX,i.y=i.minY,(i.x!==s||i.y!==u)&&this.set(TS,null),i}},e.prototype.getChildren=function(){var t=this;return{nodes:t.getNodes(),combos:t.getCombos()}},e.prototype.getNodes=function(){var t=this;return t.get("nodes")},e.prototype.getCombos=function(){var t=this;return t.get("combos")},e.prototype.addChild=function(t){var n=this,i=t.getType();switch(i){case"node":n.addNode(t);break;case"combo":n.addCombo(t);break;default:return console.warn("Only node or combo items are allowed to be added into a combo"),!1}return!0},e.prototype.addCombo=function(t){var n=this;return n.get("combos").push(t),!0},e.prototype.addNode=function(t){var n=this;return n.get("nodes").push(t),!0},e.prototype.removeChild=function(t){var n=this,i=t.getType();switch(i){case"node":n.removeNode(t);break;case"combo":n.removeCombo(t);break;default:return console.warn("Only node or combo items are allowed to be added into a combo"),!1}return!0},e.prototype.removeCombo=function(t){if(!!t){var n=this.getCombos(),i=n.indexOf(t);return i>-1?(n.splice(i,1),!0):!1}},e.prototype.removeNode=function(t){if(!!t){var n=this.getNodes(),i=n.indexOf(t);return i>-1?(n.splice(i,1),!0):!1}},e.prototype.getUpdateType=function(t){},e.prototype.getBBox=function(){this.set(AS,null);var t=this.calculateCanvasBBox();return t},e.prototype.clearCache=function(){this.set(CS,null),this.set(AS,null),this.set(TS,null)},e.prototype.destroy=function(){if(!this.destroyed){var t=this.get("animate"),n=this.get("group");t&&n.stopAnimate(),this.clearCache(),this.set(my,null),this.set("bbox",null),n.remove(),this._cfg=null,this.destroyed=!0}},e}(ES),df="node",ed="edge",MS="vedge",vf="combo",Y4="default",IS="Mapper",Xa="stateStyles",q4=function(){function r(e){var t=this;this.edgeToBeUpdateMap={},this.throttleRefresh=og(function(n){var i,a=t.graph;if(!(!a||a.get("destroyed"))){var o=t.edgeToBeUpdateMap;!o||!((i=Object.keys(o))===null||i===void 0?void 0:i.length)||(Object.keys(o).forEach(function(s){var u=o[s].edge;!u||u.destroyed||u.refresh(o[s].updateType)}),t.edgeToBeUpdateMap={})}},16,{trailing:!0,leading:!0}),this.graph=e,this.destroyed=!1}return r.prototype.addItem=function(e,t){var n=this.graph,i=e===MS?ed:e,a=n.get(i+"Group")||n.get("group"),o=Eu(i),s=null,u=n.get(i+Eu(Xa))||{},l=n.get(Y4+o);t[Xa]&&(u=t[Xa]),l&&xe(l,function(m,b){ri(m)&&!At(m)?t[b]=Hr({},m,t[b]):At(m)?t[b]=t[b]||Cr(l[b]):t[b]=t[b]||l[b]});var f=n.get(i+IS);if(f){var c=f(t);c[Xa]&&(u=c[Xa],delete c[Xa]),xe(c,function(m,b){ri(m)&&!At(m)?t[b]=Hr({},t[b],m):t[b]=c[b]||t[b]})}if(n.emit("beforeadditem",{type:e,model:t}),e===ed||e===MS){var h=void 0,d=void 0;if(h=t.source,d=t.target,h&&Xe(h)&&(h=n.findById(h)),d&&Xe(d)&&(d=n.findById(d)),!h||!d){console.warn("The source or target node of edge "+t.id+" does not exist!");return}h.getType&&h.getType()==="combo"&&(t.isComboEdge=!0),d.getType&&d.getType()==="combo"&&(t.isComboEdge=!0),s=new j4({model:t,source:h,target:d,styles:u,linkCenter:n.get("linkCenter"),group:a.addGroup()})}else if(e===df)s=new ES({model:t,styles:u,group:a.addGroup()});else if(e===vf){var v=t.children,p=Ql(v,n);isNaN(p.x)?isNaN(t.x)&&(t.x=Math.random()*100):t.x=p.x,isNaN(p.y)?isNaN(t.y)&&(t.y=Math.random()*100):t.y=p.y;var g=a.addGroup();g.setZIndex(t.depth),s=new H4({model:t,styles:u,bbox:t.collapsed?Ql([],n):p,group:g});var y=s.getModel();(v||[]).forEach(function(m){var b=n.findById(m.id);s.addChild(b),m.depth=y.depth+2}),t.collapsed&&setTimeout(function(){s.destroyed||n.collapseCombo(s)},0)}if(s)return n.get(e+"s").push(s),n.get("itemMap")[s.get("id")]=s,n.emit("afteradditem",{item:s,model:t}),s},r.prototype.updateItem=function(e,t){var n=this,i,a,o=this.graph;if(Xe(e)&&(e=o.findById(e)),!(!e||e.destroyed)){var s="";e.getType&&(s=e.getType());var u=o.get(s+IS),l=e.getModel(),f=e.getUpdateType(t);if(u){var c=Hr({},l,t),h=u(c),d=Hr({},l,h,t);h[Xa]&&(e.set("styles",d[Xa]),delete d[Xa]),xe(d,function(_,S){t[S]=_})}else xe(t,function(_,S){l[S]&&ri(_)&&!At(_)&&(t[S]=L(L({},l[S]),t[S]))});if(o.emit("beforeupdateitem",{item:e,cfg:t}),s===ed){if(t.source){var v=t.source;Xe(v)&&(v=o.findById(v)),e.setSource(v)}if(t.target){var p=t.target;Xe(p)&&(p=o.findById(p)),e.setTarget(p)}e.update(t)}if(s===df||s===vf){e.update(t,f);var g=e.getEdges(),y=f==="bbox"||f==="move";if(s===df)f==="move"?xe(g,function(_){n.edgeToBeUpdateMap[_.getID()]={edge:_,updateType:f},n.throttleRefresh()}):y&&xe(g,function(_){_.refresh()});else if(y&&s===vf){var m=e.get("shapeFactory"),b=l.type||"circle",x=l.animate===void 0||t.animate===void 0?(a=(i=m[b])===null||i===void 0?void 0:i.options)===null||a===void 0?void 0:a.animate:l.animate||t.animate;x?setTimeout(function(){if(!(!e||e.destroyed)){var _=e.getKeyShape();!_||_.destroyed||xe(g,function(S){S&&!S.destroyed&&S.refresh()})}},201):xe(g,function(_){_.refresh()})}}o.emit("afterupdateitem",{item:e,cfg:t})}},r.prototype.updateCombo=function(e,t){var n=this,i,a,o=this.graph;if(Xe(e)&&(e=o.findById(e)),!(!e||e.destroyed)){var s=e.getModel(),u=Ql(s.collapsed?[]:t,o),l=s.collapsed?Ql(t,o):u,f=l.x,c=l.y;e.set("bbox",u),e.update({x:f,y:c});var h=e.get("shapeFactory"),d=s.type||"circle",v=s.animate===void 0?(a=(i=h[d])===null||i===void 0?void 0:i.options)===null||a===void 0?void 0:a.animate:s.animate;v?setTimeout(function(){if(!(!e||e.destroyed)){var p=e.getKeyShape();!p||p.destroyed||(e.getShapeCfg(s),n.updateComboEdges(e))}},201):this.updateComboEdges(e)}},r.prototype.updateComboEdges=function(e){for(var t=e.getEdges()||[],n=0;n<t.length;n++){var i=t[n];if(i&&!i.destroyed){var a=i.get("shapeFactory"),o=i.getShapeCfg(i.getModel()),s=i.getContainer();s.clear();var u=a.draw(o.type,o,s);i.set("keyShape",u),u.set("isKeyShape",!0),u.set("draggable",!0),i.setOriginStyle()}}},r.prototype.collapseCombo=function(e){var t=this.graph;Xe(e)&&(e=t.findById(e));var n=e.getChildren();n.nodes.forEach(function(i){t.hideItem(i)}),n.combos.forEach(function(i){t.hideItem(i)})},r.prototype.expandCombo=function(e){var t=this.graph;Xe(e)&&(e=t.findById(e));var n=e.getChildren();n.nodes.forEach(function(i){t.showItem(i)}),n.combos.forEach(function(i){i.getModel().collapsed?i.show():t.showItem(i)})},r.prototype.removeItem=function(e){var t=this,n=this.graph;if(Xe(e)&&(e=n.findById(e)),!(!e||e.destroyed)){var i=Cr(e.getModel());n.emit("beforeremoveitem",{item:i});var a="";e.getType&&(a=e.getType());var o=n.get(a+"s"),s=o.indexOf(e);if(s>-1&&o.splice(s,1),a===ed){var u=n.get("v"+a+"s"),l=u.indexOf(e);l>-1&&u.splice(l,1)}var f=e.get("id"),c=n.get("itemMap");delete c[f];var h=n.get("comboTrees"),d=e.get("id");if(a===df){var v=e.getModel().comboId;if(h&&v){var p=h,g=!1;h.forEach(function(S){g||Mi(S,function(E){if(E.id===d&&p){var C=p.indexOf(E);return p.splice(C,1),g=!0,!1}return p=E.children,!0})})}for(var y=e.getEdges(),m=y.length-1;m>=0;m--)n.removeItem(y[m],!1);v&&n.updateCombo(v)}else if(a===vf){var b=e.getModel().parentId,x,_=!1;(h||[]).forEach(function(E){_||Mi(E,function(C){return C.id===d?(x=C,_=!0,!1):!0})}),x.removed=!0,x&&x.children&&x.children.forEach(function(E){t.removeItem(E.id)});for(var y=e.getEdges(),m=y.length;m>=0;m--)n.removeItem(y[m],!1);b&&n.updateCombo(b)}e.destroy(),n.emit("afterremoveitem",{item:i})}},r.prototype.setItemState=function(e,t,n){var i=this.graph,a=t;Xe(n)&&(a=t+":"+n),!(e.hasState(a)===n&&n||Xe(n)&&e.hasState(a))&&(i.emit("beforeitemstatechange",{item:e,state:a,enabled:n}),e.setState(t,n),i.autoPaint(),i.emit("afteritemstatechange",{item:e,state:a,enabled:n}))},r.prototype.priorityState=function(e,t){var n=this.graph,i=e;Xe(e)&&(i=n.findById(e)),this.setItemState(i,t,!1),this.setItemState(i,t,!0)},r.prototype.clearItemStates=function(e,t){var n=this.graph;Xe(e)&&(e=n.findById(e)),n.emit("beforeitemstatesclear",{item:e,states:t}),e.clearStates(t),n.emit("afteritemstatesclear",{item:e,states:t})},r.prototype.refreshItem=function(e){var t=this.graph;Xe(e)&&(e=t.findById(e)),t.emit("beforeitemrefresh",{item:e}),e.refresh(),t.emit("afteritemrefresh",{item:e})},r.prototype.addCombos=function(e,t){var n=this,i=this.graph;(e||[]).forEach(function(o){xo(o,function(s){var u;return t.forEach(function(l){l.id===s.id&&(l.children=s.children,l.depth=s.depth,u=l)}),u&&n.addItem("combo",u),!0})});var a=i.get("comboGroup");a&&a.sort()},r.prototype.changeItemVisibility=function(e,t){var n=this,i=this.graph;if(Xe(e)&&(e=i.findById(e)),!e){console.warn("The item to be shown or hidden does not exist!");return}if(i.emit("beforeitemvisibilitychange",{item:e,visible:t}),e.changeVisibility(t),e.getType&&e.getType()===df){var a=e.getEdges();xe(a,function(f){t&&!(f.get("source").isVisible()&&f.get("target").isVisible())||n.changeItemVisibility(f,t)})}else if(e.getType&&e.getType()===vf){var o=i.get("comboTrees"),s=e.get("id"),u=[],l=!1;(o||[]).forEach(function(c){l||!c.children||c.children.length===0||Mi(c,function(h){return h.id===s?(u=h.children,l=!0,!1):!0})}),u&&(!t||t&&!e.getModel().collapsed)&&u.forEach(function(c){var h=i.findById(c.id);n.changeItemVisibility(h,t)});var a=e.getEdges();xe(a,function(c){t&&!(c.get("source").isVisible()&&c.get("target").isVisible())||n.changeItemVisibility(c,t)})}return i.emit("afteritemvisibilitychange",{item:e,visible:t}),e},r.prototype.destroy=function(){this.graph=null,this.destroyed=!0},r}(),ws=null,K4=function(){function r(e){this.graph=e,this.cachedStates={enabled:{},disabled:{}},this.destroyed=!1}return r.checkCache=function(e,t,n){if(!!n[t]){var i=n[t].indexOf(e);i>=0&&n[t].splice(i,1)}},r.cacheState=function(e,t,n){n[t]||(n[t]=[]),n[t].push(e)},r.prototype.updateState=function(e,t,n){var i=this,a=r.checkCache,o=r.cacheState;if(!e.destroyed){var s=this.cachedStates,u=s.enabled,l=s.disabled;n?(a(e,t,l),o(e,t,u)):(a(e,t,u),o(e,t,l)),ws&&clearTimeout(ws),ws=setTimeout(function(){ws=null,i.updateGraphStates()},16)}},r.prototype.updateStates=function(e,t,n){var i=this;Xe(t)?this.updateState(e,t,n):t.forEach(function(a){i.updateState(e,a,n)})},r.prototype.updateGraphStates=function(){var e=this.graph.get("states"),t=this.cachedStates;xe(t.disabled,function(n,i){e[i]&&(e[i]=e[i].filter(function(a){return n.indexOf(a)<0&&!n.destroyed}))}),xe(t.enabled,function(n,i){if(!e[i])e[i]=n;else{var a={};e[i].forEach(function(o){o.destroyed||(a[o.get("id")]=!0)}),n.forEach(function(o){if(!o.destroyed){var s=o.get("id");a[s]||(a[s]=!0,e[i].push(o))}})}}),this.graph.emit("graphstatechange",{states:e}),this.cachedStates={enabled:{},disabled:{}}},r.prototype.destroy=function(){this.graph=null,this.cachedStates=null,ws&&clearTimeout(ws),ws=null,this.destroyed=!0},r}(),Z4=function(e,t){return!e||!t?e:e.replace(/\\?\{([^{}]+)\}/g,function(n,i){if(n.charAt(0)==="\\")return n.slice(1);var a=t[i];return a===0&&(a="0"),a||""})},kS=function(e){var t=[];if(e.length<2)throw new Error("point length must largn than 2, now it's "+e.length);for(var n=0,i=e;n<i.length;n++){var a=i[n],o=a.x,s=a.y;t.push(o),t.push(s)}var u=fS(t);return u.unshift(["M",e[0].x,e[0].y]),u},td=function(e,t,n,i){n===void 0&&(n=0),i===void 0&&(i=0);var a={x:(1-n)*e.x+n*t.x,y:(1-n)*e.y+n*t.y},o=[0,0];gs(o,[t.x-e.x,t.y-e.y]),(!o||!o[0]&&!o[1])&&(o=[0,0]);var s=[-o[1]*i,o[0]*i];return a.x+=s[0],a.y+=s[1],a},Q4=function(e,t){var n=e.length;if(!n)return"";for(var i="",a="",o=0;o<n;o++){var s=e[o];o===0?a="M{x} {y}":a="L{x} {y}",i+=Z4(a,s)}return t&&(i+="Z"),i},by=function(e){var t=[];return e.forEach(function(n){var i=n[0];if(i!=="A")for(var a=1;a<n.length;a=a+2)t.push([n[a],n[a+1]]);else{var o=n.length;t.push([n[o-2],n[o-1]])}}),t},xy=function(e){if(e.length<2)throw new Error("point length must largn than 2, now it's "+e.length);var t=e[0],n=e[1],i=e[e.length-1],a=e[e.length-2];e.unshift(i),e.unshift(a),e.push(t),e.push(n);for(var o=[],s=1;s<e.length-2;s+=1){var u=e[s-1].x,l=e[s-1].y,f=e[s].x,c=e[s].y,h=e[s+1].x,d=e[s+1].y,v=s!==e.length-2?e[s+2].x:h,p=s!==e.length-2?e[s+2].y:d,g=f+(h-u)/6,y=c+(d-l)/6,m=h-(v-f)/6,b=d-(p-c)/6;o.push(["C",g,y,m,b,h,d])}return o.unshift(["M",i.x,i.y]),o},DS=function(e,t){return ci([0,0],gs([0,0],e),t)},PS=function(e,t){var n=[e[1]-t[1],t[0]-e[0]],i=Math.sqrt(n[0]*n[0]+n[1]*n[1]);if(i===0)throw new Error("p0 should not be equal to p1");return[n[0]/i,n[1]/i]},NS=function(e,t){return[t[0]-e[0],t[1]-e[1]]};function _y(r,e){var t=function(c){var h=[c[0][0],c[0][1]-e],d=[c[0][0],c[0][1]+e];return"M "+h+" A "+e+","+e+",0,0,0,"+d+" A "+e+","+e+",0,0,0,"+h},n=function(c){var h=ci([0,0],PS(c[0],c[1]),e),d=ci([0,0],h,-1),v=Hn([0,0],c[0],h),p=Hn([0,0],c[1],h),g=Hn([0,0],c[1],d),y=Hn([0,0],c[0],d);return"M "+v+" L "+p+" A "+[e,e,"0,0,0",g].join(",")+" L "+y+" A "+[e,e,"0,0,0",v].join(",")};if(!r||r.length<1)return"";if(r.length===1)return t(r);if(r.length===2)return n(r);for(var i=new Array(r.length),a=0;a<i.length;++a){var o=a===0?r[r.length-1]:r[a-1],s=r[a],u=ci([0,0],PS(o,s),e);i[a]=[Hn([0,0],o,u),Hn([0,0],s,u)]}var l="A "+[e,e,"0,0,0,"].join(",");return i=i.map(function(f,c){var h="";return c===0&&(h="M "+i[i.length-1][1]+" "),h+=l+f[0]+" L "+f[1],h}),i.join(" ")}function LS(r,e){var t=r.length,n=function(f){var c=[f[0][0],f[0][1]-e],h=[f[0][0],f[0][1]+e];return"M "+c+" A "+[e,e,"0,0,0",h].join(",")+" A "+[e,e,"0,0,0",c].join(",")},i=function(f){var c=NS(f[0],f[1]),h=DS(c,e),d=Hn([0,0],f[0],ci([0,0],h,-1)),v=Hn([0,0],f[1],h),p=1.2*e,g=DS(gs([0,0],c),p),y=ci([0,0],g,-1),m=Hn([0,0],d,y),b=Hn([0,0],v,y),x=Hn([0,0],d,g);return"M "+d+" C "+[m,b,v].join(",")+" S "+[x,d].join(",")+" Z"};if(!r||t<1)return"";if(t===1)return n(r);if(t===2)return i(r);for(var a=r.map(function(l,f){var c=r[(f+1)%t];return{p:l,v:gs([0,0],NS(l,c))}}),o=0;o<a.length;++o){var s=o>0?o-1:t-1,u=gs([0,0],Hn([0,0],a[s].v,ci([0,0],a[o].v,-1)));a[o].p=Hn([0,0],a[o].p,ci([0,0],u,e))}return a.map(function(l){var f=l.p;return{x:f[0],y:f[1]}})}var J4=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",getSpline:kS,getControlPoint:td,pointsToPolygon:Q4,pathToPoints:by,getClosedSpline:xy,roundedHull:_y,paddedHull:LS}),OS=function(e,t,n){return(e.y-n.y)*(t.x-n.x)-(e.x-n.x)*(t.y-n.y)},RS=function(e){var t=e.map(function(s){return{x:s.getModel().x,y:s.getModel().y}});if(t.sort(function(s,u){return s.x===u.x?s.y-u.y:s.x-u.x}),t.length===1)return t;for(var n=[],i=0;i<t.length;i++){for(;n.length>=2&&OS(n[n.length-2],n[n.length-1],t[i])<=0;)n.pop();n.push(t[i])}for(var a=[],i=t.length-1;i>=0;i--){for(;a.length>=2&&OS(a[a.length-2],a[a.length-1],t[i])<=0;)a.pop();a.push(t[i])}a.pop(),n.pop();var o=n.concat(a);return o},eU={maxRoutingIterations:100,maxMarchingIterations:100,pixelGroupSize:2,edgeR0:10,edgeR1:10,nodeR0:5,nodeR1:10,morphBuffer:5,threshold:.001,skip:16,nodeInfluenceFactor:1,edgeInfluenceFactor:1,negativeNodeInfluenceFactor:-.5};function tU(r,e,t){var n=!1,i=function(u,l){return e.cells[u+l*e.width]},a=function(u,l){var f=0;return i(u-1,l-1)>=t&&(f+=1),i(u,l-1)>t&&(f+=2),i(u-1,l)>t&&(f+=4),i(u,l)>t&&(f+=8),f},o=function(u,l){for(var f=u,c=l,h,d,v=0;v<e.width*e.height;v++){if(h=f,d=c,r.findIndex(function(g){return g.x===f&&g.y===c})>-1){if(!(r[0].x!==f||r[0].y!==c))return!0}else r.push({x:f,y:c});var p=a(f,c);switch(p){case-1:return console.warn("Marched out of bounds"),!0;case 0:case 3:case 2:case 7:f++;break;case 12:case 14:case 4:f--;break;case 6:h===0&&(d===-1?f-=1:f+=1);break;case 1:case 13:case 5:c--;break;case 9:h===1&&(d===0?c-=1:c+=1);break;case 10:case 8:case 11:c++;break;default:return console.warn("Marching squares invalid state: "+p),!0}}};this.march=function(){for(var s=0;s<e.width&&!n;s+=1)for(var u=0;u<e.height&&!n;u+=1)i(s,u)>t&&a(s,u)!==15&&(n=o(s,u));return n}}var rU=function(e,t,n){var i=Math.ceil(e/n),a=Math.ceil(t/n),o=new Float32Array(Math.max(0,i*a)).fill(0);return{cells:o,width:i,height:a}},nU=function(e,t,n){var i=null,a=Number.POSITIVE_INFINITY;return t.forEach(function(o){var s={x:e.getModel().x,y:e.getModel().y},u={x:o.getModel().x,y:o.getModel().y},l=Ph(s,u),f=new bs(s.x,s.y,u.x,u.y),c=n.reduce(function(h,d){return Eg(d,f)>0?h+1:h},0);l*Math.pow(c+1,2)<a&&(i=o,a=l*Math.pow(c+1,2))}),i},BS=function(e,t){var n=Number.POSITIVE_INFINITY,i=null;return e.forEach(function(a){var o=Eg(a,t);o>=0&&o<n&&(i=a,n=o)}),i},iU=function(e,t,n,i){var a=[],o=[];o.push(e);for(var s=!0,u=0,l=function(d,v){var p=!1;return v.forEach(function(g){p||(Cg(d,{x:g.x1,y:g.y1})||Cg(d,{x:g.x2,y:g.y2}))&&(p=!0)}),p},f=function(d,v){for(var p=0,g=v;p<g.length;p++){var y=g[p],m=y.getBBox(),b=[[m.x,m.y],[m.x+m.width,m.y],[m.x,m.y+m.height],[m.x+m.width,m.y+m.height]];if(Zl(b,d.x,d.y))return!0}return!1};s&&u<n;){s=!1;for(var c=function(){var d=o.pop(),v=BS(t,d);if(v){var p=g_(v,d),g=p[0],y=p[1];if(y===2){var m=function(x){for(var _=i,S=GS(v,_,g,x),E=l(S,o)||l(S,a),C=f(S,t);!E&&C&&_>=1;)_/=1.5,S=GS(v,_,g,x),E=l(S,o)||l(S,a),C=f(S,t);S&&!E&&(!x||!C)&&(o.push(new bs(d.x1,d.y1,S.x,S.y)),o.push(new bs(S.x,S.y,d.x2,d.y2)),s=!0)};m(!0),s||m(!1)}}s||a.push(d),u+=1};!s&&o.length;)c()}for(;o.length;)a.push(o.pop());return a};function aU(r,e,t,n,i){var a=nU(r,t,e);if(a===null)return[];var o=function(c){for(var h=[];c.length>0;){var d=c.pop();if(c.length===0){h.push(d);break}var v=c.pop(),p=new bs(d.x1,d.y1,v.x2,v.y2),g=BS(e,p);g?(h.push(d),c.push(v)):c.push(p)}return h},s=new bs(r.getModel().x,r.getModel().y,a.getModel().x,a.getModel().y),u=iU(s,e,n,i),l=o(u);return l}var oU=function(e,t,n){var i=Object.assign(eU,n),a=y_(e.map(function(m){return{x:m.getModel().x,y:m.getModel().y}}));e=e.sort(function(m,b){return Ph({x:m.getModel().x,y:m.getModel().y},a)-Ph({x:b.getModel().x,y:b.getModel().y},a)});var o=[],s=[];e.forEach(function(m){var b=aU(m,t,o,i.maxRoutingIterations,i.morphBuffer);b.forEach(function(x){s.push(x)}),o.push(m)});for(var u=sU(e,s,i.nodeR0),l=rU(u.width,u.height,i.pixelGroupSize),f=[],c=[],h=0;h<i.maxMarchingIterations;h++)if(uU(e,t,s,u,l,i),f=[],c=[],!!new tU(f,l,i.threshold).march()){var d=f.map(function(m){return{x:Math.round(m.x*i.pixelGroupSize+u.minX),y:Math.round(m.y*i.pixelGroupSize+u.minY)}});if(d){var v=d.length;if(i.skip>1)for(v=Math.floor(d.length/i.skip);v<3&&i.skip>1;)i.skip-=1,v=Math.floor(d.length/i.skip);for(var p=0,g=0;g<v;g+=1,p+=i.skip)c.push({x:d[p].x,y:d[p].y})}var y=function(){for(var b=0,x=e;b<x.length;b++){var _=x[b],S=c.map(function(E){return[E.x,E.y]});if(!Zl(S,_.getBBox().centerX,_.getBBox().centerY))return!1}return!0};if(c&&y())return c;if(i.threshold*=.9,h<=i.maxMarchingIterations*.5)i.memberInfluenceFactor*=1.2,i.edgeInfluenceFactor*=1.2;else if(i.nonMemberInfluenceFactor!==0&&t.length>0)i.nonMemberInfluenceFactor*=.8;else break}return c};function sU(r,e,t){var n={minX:Number.POSITIVE_INFINITY,minY:Number.POSITIVE_INFINITY,maxX:Number.NEGATIVE_INFINITY,maxY:Number.NEGATIVE_INFINITY,width:0,height:0,x:0,y:0},i=[];r.forEach(function(u){i.push(u.getBBox())}),e.forEach(function(u){i.push(u.getBBox())});for(var a=0,o=i;a<o.length;a++){var s=o[a];n.minX=(s.minX<n.minX?s.minX:n.minX)-t,n.minY=(s.minY<n.minY?s.minY:n.minY)-t,n.maxX=(s.maxX>n.maxX?s.maxX:n.maxX)+t,n.maxY=(s.maxY>n.maxY?s.maxY:n.maxY)+t}return n.width=n.maxX-n.minX,n.height=n.maxY-n.minY,n.x=n.minX,n.y=n.minY,n}function uU(r,e,t,n,i,a){function o(d,v){var p=Math.floor((d-v)/a.pixelGroupSize);return p<0?0:p}function s(d,v){return d*a.pixelGroupSize+v}var u=(a.nodeR0-a.nodeR1)*(a.nodeR0-a.nodeR1),l=(a.edgeR0-a.edgeR1)*(a.edgeR0-a.edgeR1),f=function(v,p){var g=Math.min(o(v.minX,p+n.minX),i.width),y=Math.min(o(v.minY,p+n.minY),i.height),m=Math.min(o(v.maxX,-p+n.minX),i.width),b=Math.min(o(v.maxY,-p+n.minY),i.height);return[g,y,m,b]},c=function(v,p){for(var g=v.getBBox(),y=f(g,a.nodeR1),m=y[0],b=y[1],x=y[2],_=y[3],S=b;S<_;S+=1)for(var E=m;E<x;E+=1)if(!(p<0&&i[E+S*i.width]<=0)){var C=s(E,n.minX),M=s(S,n.minY),w=b_({x:C,y:M},{x:g.minX,y:g.minY,width:g.width,height:g.height});if(w<Math.pow(a.nodeR1,2)){var T=Math.sqrt(w)-a.nodeR1;i.cells[E+S*i.width]+=p*T*T}}},h=function(v,p){for(var g=v.getBBox(),y=f(g,a.edgeR1),m=y[0],b=y[1],x=y[2],_=y[3],S=b;S<_;S+=1)for(var E=m;E<x;E+=1)if(!(p<0&&i.cells[E+S*i.width]<=0)){var C=s(E,n.minX),M=s(S,n.minY),w=m_({x:C,y:M},v);if(w<Math.pow(a.edgeR1,2)){var T=Math.sqrt(w)-a.edgeR1;i.cells[E+S*i.width]+=p*T*T}}};a.nodeInfluenceFactor&&r.forEach(function(d){c(d,a.nodeInfluenceFactor/u)}),a.edgeInfluenceFactor&&t.forEach(function(d){h(d,a.edgeInfluenceFactor/l)}),a.negativeNodeInfluenceFactor&&e.forEach(function(d){c(d,a.negativeNodeInfluenceFactor/u)})}function GS(r,e,t,n){var i=r.getBBox(),a=t[0],o=t[1],s=t[2],u=t[3],l={topLeft:{x:i.minX-e,y:i.minY-e},topRight:{x:i.maxX+e,y:i.minY-e},bottomLeft:{x:i.minX-e,y:i.maxY+e},bottomRight:{x:i.maxX+e,y:i.maxY+e}},f=i.height*i.width;function c(v,p){return i.width*((v.y-i.minY+(p.y-i.minY))*.5)}if(o){if(a)return n?l.topLeft:l.bottomRight;if(s)return n?l.bottomLeft:l.topRight;var h=c(o,u);return h<f*.5?o.y>u.y?n?l.topLeft:l.bottomRight:n?l.topRight:l.bottomLeft:o.y<u.y?n?l.bottomLeft:l.topRight:n?l.bottomRight:l.topLeft}if(u){if(a)return n?l.topRight:l.bottomLeft;if(s)return n?l.bottomRight:l.topLeft}var d=c(a,s);return d<f*.5?a.x>s.x?n?l.topLeft:l.bottomRight:n?l.bottomLeft:l.topRight:a.x<s.x?n?l.topRight:l.bottomLeft:n?l.bottomRight:l.topLeft}var lU=function(){function r(e,t){this.cfg=Hr(this.getDefaultCfg(),t),this.graph=e,this.id=this.cfg.id,this.group=this.cfg.group,this.members=this.cfg.members.map(function(n){return Xe(n)?e.findById(n):n}),this.nonMembers=this.cfg.nonMembers.map(function(n){return Xe(n)?e.findById(n):n}),this.setPadding(),this.setType(),this.path=this.calcPath(this.members,this.nonMembers),this.render()}return r.prototype.getDefaultCfg=function(){return{id:"g6-hull",type:"round-convex",members:[],nonMembers:[],style:{fill:"lightblue",stroke:"blue",opacity:.2},padding:10}},r.prototype.setPadding=function(){var e=this.members.length&&this.members[0].getKeyShape().getCanvasBBox().width/2;this.padding=this.cfg.padding>0?this.cfg.padding+e:10+e,this.cfg.bubbleCfg={nodeR0:this.padding-e,nodeR1:this.padding-e,morphBuffer:this.padding-e}},r.prototype.setType=function(){this.type=this.cfg.type,this.members.length<3&&(this.type="round-convex"),this.type!=="round-convex"&&this.type!=="smooth-convex"&&this.type!=="bubble"&&(console.warn("The hull type should be either round-convex, smooth-convex or bubble, round-convex is used by default."),this.type="round-convex")},r.prototype.calcPath=function(e,t){var n,i,a;switch(this.type){case"round-convex":n=RS(e),a=_y(n.map(function(o){return[o.x,o.y]}),this.padding),i=uy(a);break;case"smooth-convex":n=RS(e),n.length===2?(a=_y(n.map(function(o){return[o.x,o.y]}),this.padding),i=uy(a)):n.length>2&&(a=LS(n.map(function(o){return[o.x,o.y]}),this.padding),i=xy(a));break;case"bubble":n=oU(e,t,this.cfg.bubbleCfg),i=n.length>=2&&xy(n);break}return i},r.prototype.render=function(){this.group.addShape("path",{attrs:L({path:this.path},this.cfg.style),id:this.id,name:this.cfg.id}),this.group.toBack()},r.prototype.addMember=function(e){if(!!e){Xe(e)&&(e=this.graph.findById(e)),this.members.push(e);var t=this.nonMembers.indexOf(e);return t>-1&&this.nonMembers.splice(t,1),this.updateData(this.members,this.nonMembers),!0}},r.prototype.addNonMember=function(e){if(!!e){Xe(e)&&(e=this.graph.findById(e)),this.nonMembers.push(e);var t=this.members.indexOf(e);return t>-1&&this.members.splice(t,1),this.updateData(this.members,this.nonMembers),!0}},r.prototype.removeMember=function(e){if(!!e){Xe(e)&&(e=this.graph.findById(e));var t=this.members.indexOf(e);return t>-1?(this.members.splice(t,1),this.updateData(this.members,this.nonMembers),!0):!1}},r.prototype.removeNonMember=function(e){if(!!e){Xe(e)&&(e=this.graph.findById(e));var t=this.nonMembers.indexOf(e);return t>-1?(this.nonMembers.splice(t,1),this.updateData(this.members,this.nonMembers),!0):!1}},r.prototype.updateData=function(e,t){var n=this;this.group.findById(this.id).remove(),e&&(this.members=e.map(function(i){return Xe(i)?n.graph.findById(i):i})),t&&(this.nonMembers=t.map(function(i){return Xe(i)?n.graph.findById(i):i})),this.path=this.calcPath(this.members,this.nonMembers),this.render()},r.prototype.updateStyle=function(e){var t=this.group.findById(this.id);t.attr(L({},e))},r.prototype.updateCfg=function(e){var t=this;this.cfg=Hr(this.cfg,e),this.id=this.cfg.id,this.group=this.cfg.group,e.members&&(this.members=this.cfg.members.map(function(n){return Xe(n)?t.graph.findById(n):n})),e.nonMembers&&(this.nonMembers=this.cfg.nonMembers.map(function(n){return Xe(n)?t.graph.findById(n):n})),this.setPadding(),this.setType(),this.path=this.calcPath(this.members,this.nonMembers),this.render()},r.prototype.contain=function(e){var t=this,n;Xe(e)?n=this.graph.findById(e):n=e;var i,a=n.getKeyShape();if(n.get("type")==="path")i=by(a.attr("path"));else{var o=a.getCanvasBBox();i=[[o.minX,o.minY],[o.maxX,o.minY],[o.maxX,o.maxY],[o.minX,o.maxY]]}return i=i.map(function(s){var u=t.graph.getPointByCanvas(s[0],s[1]);return[u.x,u.y]}),p_(i,by(this.path))},r.prototype.destroy=function(){this.group.remove(),this.cfg=null},r}(),wy=_h,fU="node",cU=function(r){$t(e,r);function e(t){var n=r.call(this)||this;return n.cfg=Hr(n.getDefaultCfg(),t),n.init(),n.animating=!1,n.destroyed=!1,n.cfg.enabledStack&&(n.undoStack=new Th(n.cfg.maxStep),n.redoStack=new Th(n.cfg.maxStep)),n}return e.prototype.init=function(){this.initCanvas();var t=new F4(this),n=new nG(this),i=new q4(this),a=new K4(this);this.set({viewController:t,modeController:n,itemController:i,stateController:a}),this.initLayoutController(),this.initEventController(),this.initGroups(),this.initPlugins()},e.prototype.initGroups=function(){var t=this.get("canvas"),n=t==null?void 0:t.get("el"),i=n.id,a=t.addGroup({id:i+"-root",className:Tt.rootContainerClassName});if(this.get("groupByTypes")){var o=a.addGroup({id:i+"-edge",className:Tt.edgeContainerClassName}),s=a.addGroup({id:i+"-node",className:Tt.nodeContainerClassName}),u=a.addGroup({id:i+"-combo",className:Tt.comboContainerClassName});u.toBack(),this.set({nodeGroup:s,edgeGroup:o,comboGroup:u})}var l=a.addGroup({id:i+"-delegate",className:Tt.delegateContainerClassName});this.set({delegateGroup:l}),this.set("group",a)},e.prototype.getDefaultCfg=function(){return{container:void 0,width:void 0,height:void 0,renderer:"canvas",modes:{},plugins:[],data:{},fitViewPadding:10,minZoom:.2,maxZoom:10,event:!0,groupByTypes:!0,directed:!1,autoPaint:!0,nodes:[],edges:[],combos:[],vedges:[],itemMap:{},linkCenter:!1,defaultNode:{},defaultEdge:{},nodeStateStyles:{},edgeStateStyles:{},states:{},animate:!1,animateCfg:{onFrame:void 0,duration:500,easing:"easeLinear"},callback:void 0,enabledStack:!1,maxStep:10,tooltips:[]}},e.prototype.set=function(t,n){return Un(t)?this.cfg=L(L({},this.cfg),t):this.cfg[t]=n,this},e.prototype.get=function(t){var n;return(n=this.cfg)===null||n===void 0?void 0:n[t]},e.prototype.getGroup=function(){return this.get("group")},e.prototype.getContainer=function(){return this.get("container")},e.prototype.getMinZoom=function(){return this.get("minZoom")},e.prototype.setMinZoom=function(t){return this.set("minZoom",t)},e.prototype.getMaxZoom=function(){return this.get("maxZoom")},e.prototype.setMaxZoom=function(t){return this.set("maxZoom",t)},e.prototype.getWidth=function(){return this.get("width")},e.prototype.getHeight=function(){return this.get("height")},e.prototype.clearItemStates=function(t,n){Xe(t)&&(t=this.findById(t));var i=this.get("itemController");n||(n=t.get("states")),i.clearItemStates(t,n);var a=this.get("stateController");a.updateStates(t,n,!1)},e.prototype.node=function(t){typeof t=="function"&&this.set("nodeMapper",t)},e.prototype.edge=function(t){typeof t=="function"&&this.set("edgeMapper",t)},e.prototype.combo=function(t){typeof t=="function"&&this.set("comboMapper",t)},e.prototype.findById=function(t){return this.get("itemMap")[t]},e.prototype.find=function(t,n){var i,a=this.get(t+"s");return xe(a,function(o,s){if(n(o,s))return i=o,i}),i},e.prototype.findAll=function(t,n){var i=[];return xe(this.get(t+"s"),function(a,o){n(a,o)&&i.push(a)}),i},e.prototype.findAllByState=function(t,n){return this.findAll(t,function(i){return i.hasState(n)})},e.prototype.translate=function(t,n){var i=this.get("group"),a=Cr(i.getMatrix());a||(a=[1,0,0,0,1,0,0,0,1]),a=wy(a,[["t",t,n]]),i.setMatrix(a),this.emit("viewportchange",{action:"translate",matrix:i.getMatrix()}),this.autoPaint()},e.prototype.moveTo=function(t,n,i,a){var o=this.get("group");d_(o,{x:t,y:n},i,a||{duration:500,easing:"easeCubic"}),this.emit("viewportchange",{action:"move",matrix:o.getMatrix()})},e.prototype.fitView=function(t){t&&this.set("fitViewPadding",t);var n=this.get("viewController");n.fitView(),this.autoPaint()},e.prototype.fitCenter=function(){var t=this.get("viewController");t.fitCenter(),this.autoPaint()},e.prototype.addBehaviors=function(t,n){var i=this.get("modeController");return i.manipulateBehaviors(t,n,!0),this},e.prototype.removeBehaviors=function(t,n){var i=this.get("modeController");return i.manipulateBehaviors(t,n,!1),this},e.prototype.updateBehavior=function(t,n,i){var a=this.get("modeController");return a.updateBehavior(t,n,i),this},e.prototype.zoom=function(t,n){var i=this.get("group"),a=Cr(i.getMatrix()),o=this.get("minZoom"),s=this.get("maxZoom");return a||(a=[1,0,0,0,1,0,0,0,1]),n?a=wy(a,[["t",-n.x,-n.y],["s",t,t],["t",n.x,n.y]]):a=wy(a,[["s",t,t]]),o&&a[0]<o||s&&a[0]>s?!1:(i.setMatrix(a),this.emit("viewportchange",{action:"zoom",matrix:a}),this.autoPaint(),!0)},e.prototype.zoomTo=function(t,n){var i=t/this.getZoom();return this.zoom(i,n)},e.prototype.focusItem=function(t,n,i){var a=this.get("viewController"),o=!1;n?o=!0:n===void 0&&(o=this.get("animate"));var s={};i?s=i:i===void 0&&(s=this.get("animateCfg")),a.focus(t,o,s),this.autoPaint()},e.prototype.autoPaint=function(){this.get("autoPaint")&&this.paint()},e.prototype.paint=function(){this.emit("beforepaint"),this.get("canvas").draw(),this.emit("afterpaint")},e.prototype.getPointByClient=function(t,n){var i=this.get("viewController");return i.getPointByClient(t,n)},e.prototype.getClientByPoint=function(t,n){var i=this.get("viewController");return i.getClientByPoint(t,n)},e.prototype.getPointByCanvas=function(t,n){var i=this.get("viewController");return i.getPointByCanvas(t,n)},e.prototype.getCanvasByPoint=function(t,n){var i=this.get("viewController");return i.getCanvasByPoint(t,n)},e.prototype.getGraphCenterPoint=function(){var t=this.get("group").getCanvasBBox();return{x:(t.minX+t.maxX)/2,y:(t.minY+t.maxY)/2}},e.prototype.getViewPortCenterPoint=function(){return this.getPointByCanvas(this.get("width")/2,this.get("height")/2)},e.prototype.showItem=function(t,n){n===void 0&&(n=!0);var i=this.get("itemController"),a=i.changeItemVisibility(t,!0);if(n&&this.get("enabledStack")){var o=a.getID(),s=a.getType(),u={},l={};switch(s){case"node":u.nodes=[{id:o,visible:!1}],l.nodes=[{id:o,visible:!0}];break;case"edge":u.nodes=[{id:o,visible:!1}],l.edges=[{id:o,visible:!0}];break;case"combo":u.nodes=[{id:o,visible:!1}],l.combos=[{id:o,visible:!0}];break}this.pushStack("visible",{before:u,after:l})}},e.prototype.hideItem=function(t,n){n===void 0&&(n=!0);var i=this.get("itemController"),a=i.changeItemVisibility(t,!1);if(n&&this.get("enabledStack")){var o=a.getID(),s=a.getType(),u={},l={};switch(s){case"node":u.nodes=[{id:o,visible:!0}],l.nodes=[{id:o,visible:!1}];break;case"edge":u.nodes=[{id:o,visible:!0}],l.edges=[{id:o,visible:!1}];break;case"combo":u.nodes=[{id:o,visible:!0}],l.combos=[{id:o,visible:!1}];break}this.pushStack("visible",{before:u,after:l})}},e.prototype.refreshItem=function(t){var n=this.get("itemController");n.refreshItem(t)},e.prototype.setAutoPaint=function(t){var n=this;n.set("autoPaint",t);var i=n.get("canvas");i.set("autoDraw",t)},e.prototype.remove=function(t,n){n===void 0&&(n=!0),this.removeItem(t,n)},e.prototype.removeItem=function(t,n){n===void 0&&(n=!0);var i=t;if(Xe(t)&&(i=this.findById(t)),!i&&Xe(t))console.warn("The item to be removed does not exist!");else if(i){var a="";if(i.getType&&(a=i.getType()),n&&this.get("enabledStack")){var o=L(L({},i.getModel()),{itemType:a}),s={};switch(a){case"node":{s.nodes=[o],s.edges=[];for(var u=i.getEdges(),l=u.length-1;l>=0;l--)s.edges.push(L(L({},u[l].getModel()),{itemType:"edge"}));break}case"edge":s.edges=[o];break;case"combo":s.combos=[o];break}this.pushStack("delete",{before:s,after:{}})}if(a==="node"){var f=i.getModel();f.comboId&&this.updateComboTree(i,void 0,!1)}var c=this.get("itemController");if(c.removeItem(i),a==="combo"){var h=Dg(this.get("comboTrees"));this.set("comboTrees",h)}}},e.prototype.addItem=function(t,n,i,a){i===void 0&&(i=!0),a===void 0&&(a=!0);var o=this.get("comboSorted");this.set("comboSorted",o&&!a);var s=this.get("itemController");if(!rG(t,n))return!1;if(n.id&&this.findById(n.id)){console.warn("This item exists already. Be sure the id %c"+n.id+"%c is unique.","font-size: 20px; color: red;","");return}var u,l=this.get("comboTrees");if(l||(l=[]),t==="combo"){var f=this.get("itemMap"),c=!1;if(l.forEach(function(x){c||xo(x,function(_){if(n.parentId===_.id){c=!0;var S=L({id:n.id,depth:_.depth+2},n);_.children?_.children.push(S):_.children=[S],n.depth=S.depth,u=s.addItem(t,n)}var E=f[_.id];return c&&E&&E.getType&&E.getType()==="combo"&&s.updateCombo(E,_.children),!0})}),!c){var h=L({id:n.id,depth:0},n);n.depth=h.depth,l.push(h),u=s.addItem(t,n)}this.set("comboTrees",l)}else if(t==="node"&&Xe(n.comboId)&&l){var d=this.findById(n.comboId);d&&d.getType&&d.getType()!=="combo"&&console.warn("'"+n.comboId+"' is not a id of a combo in the graph, the node will be added without combo."),u=s.addItem(t,n);var v=this.get("itemMap"),p=!1,g=!1;(l||[]).forEach(function(x){g||p||xo(x,function(_){if(_.id===n.id)return g=!0,!1;if(n.comboId===_.id&&!g){p=!0;var S=Cr(n);S.itemType="node",_.children?_.children.push(S):_.children=[S],S.depth=_.depth+1}return p&&v[_.id].getType&&v[_.id].getType()==="combo"&&s.updateCombo(v[_.id],_.children),!0})})}else u=s.addItem(t,n);if(t==="node"&&n.comboId||t==="combo"&&n.parentId){var d=this.findById(n.comboId||n.parentId);d&&d.getType&&d.getType()==="combo"&&d.addChild(u)}var y=this.get("combos");if(y&&y.length>0&&this.sortCombos(),this.autoPaint(),i&&this.get("enabledStack")){var m=L(L({},u.getModel()),{itemType:t}),b={};switch(t){case"node":b.nodes=[m];break;case"edge":b.edges=[m];break;case"combo":b.combos=[m];break}this.pushStack("add",{before:{},after:b})}return u},e.prototype.add=function(t,n,i,a){return i===void 0&&(i=!0),a===void 0&&(a=!0),this.addItem(t,n,i,a)},e.prototype.updateItem=function(t,n,i){var a=this;i===void 0&&(i=!0);var o=this.get("itemController"),s;Xe(t)?s=this.findById(t):s=t;var u=Cr(s.getModel()),l="";s.getType&&(l=s.getType());var f=xa([],s.getStates());if(l==="combo"&&xe(f,function(v){return a.setItemState(s,v,!1)}),o.updateItem(s,n),l==="combo"&&xe(f,function(v){return a.setItemState(s,v,!0)}),i&&this.get("enabledStack")){var c={nodes:[],edges:[],combos:[]},h={nodes:[],edges:[],combos:[]},d=L({id:u.id},n);switch(l){case"node":c.nodes.push(u),h.nodes.push(d);break;case"edge":c.edges.push(u),h.edges.push(d);break;case"combo":c.combos.push(u),h.combos.push(d);break}l==="node"&&c.nodes.push(u),this.pushStack("update",{before:c,after:h})}},e.prototype.update=function(t,n,i){i===void 0&&(i=!0),this.updateItem(t,n,i)},e.prototype.setItemState=function(t,n,i){Xe(t)&&(t=this.findById(t));var a=this.get("itemController");a.setItemState(t,n,i);var o=this.get("stateController");Xe(i)?o.updateState(t,n+":"+i,!0):o.updateState(t,n,i)},e.prototype.priorityState=function(t,n){var i=this.get("itemController");i.priorityState(t,n)},e.prototype.data=function(t){I_(t),this.set("data",t)},e.prototype.render=function(){var t=this;this.set("comboSorted",!1);var n=this.get("data");if(this.get("enabledStack")&&this.clearStack(),!n)throw new Error("data must be defined first");var i=n.nodes,a=i===void 0?[]:i,o=n.edges,s=o===void 0?[]:o,u=n.combos,l=u===void 0?[]:u;if(this.clear(!0),this.emit("beforerender"),xe(a,function(g){t.add("node",g,!1,!1)}),l&&l.length!==0){var f=kg(l,a);this.set("comboTrees",f),t.addCombos(l)}xe(s,function(g){t.add("edge",g,!1,!1)});var c=t.get("animate");(t.get("fitView")||t.get("fitCenter"))&&t.set("animate",!1);var h=t.get("layoutController");if(h){if(h.layout(d),this.destroyed)return}else t.get("fitView")&&t.fitView(),t.get("fitCenter")&&t.fitCenter(),t.emit("afterrender"),t.set("animate",c);function d(){t.get("fitView")?t.fitView():t.get("fitCenter")&&t.fitCenter(),t.autoPaint(),t.emit("afterrender"),(t.get("fitView")||t.get("fitCenter"))&&t.set("animate",c)}if(!this.get("groupByTypes"))if(l&&l.length!==0)this.sortCombos();else if(n.nodes&&n.edges&&n.nodes.length<n.edges.length){var v=this.getNodes();v.forEach(function(g){g.toFront()})}else{var p=this.getEdges();p.forEach(function(g){g.toBack()})}this.get("enabledStack")&&this.pushStack("render")},e.prototype.read=function(t){this.data(t),this.render()},e.prototype.diffItems=function(t,n,i){var a=this,o,s=this.get("itemMap");xe(i,function(u){if(o=s[u.id],o){if(a.get("animate")&&t===fU){var l=o.getContainer().getMatrix();l||(l=[1,0,0,0,1,0,0,0,1]),o.set("originAttrs",{x:l[6],y:l[7]})}a.updateItem(o,u,!1)}else o=a.addItem(t,u,!1);o&&n[t+"s"].push(o)})},e.prototype.changeData=function(t,n){n===void 0&&(n=!0);var i=this;if(!I_(t))return this;n&&this.get("enabledStack")&&this.pushStack("changedata",{before:i.save(),after:t}),this.set("comboSorted",!1),this.removeHulls(),this.getNodes().map(function(p){return i.clearItemStates(p)}),this.getEdges().map(function(p){return i.clearItemStates(p)});var a=this.get("canvas"),o=a.get("localRefresh");a.set("localRefresh",!1),i.get("data")||(i.data(t),i.render());var s=this.get("itemMap"),u={nodes:[],edges:[]},l=t.combos;if(l){var f=kg(l,t.nodes);this.set("comboTrees",f)}else this.set("comboTrees",[]);this.diffItems("node",u,t.nodes),xe(s,function(p,g){s[g].getModel().depth=0,!(p.getType&&p.getType()==="edge")&&(p.getType&&p.getType()==="combo"?(delete s[g],p.destroy()):u.nodes.indexOf(p)<0&&(delete s[g],i.remove(p,!1)))});for(var c=this.getCombos(),h=c.length,d=h-1;d>=0;d--)c[d].destroyed&&c.splice(d,1);l&&(i.addCombos(l),this.get("groupByTypes")||this.sortCombos()),this.diffItems("edge",u,t.edges),xe(s,function(p,g){p.getType&&(p.getType()==="node"||p.getType()==="combo")||u.edges.indexOf(p)<0&&(delete s[g],i.remove(p,!1))}),this.set({nodes:u.nodes,edges:u.edges});var v=this.get("layoutController");return v&&(v.changeData(),i.get("animate")&&!v.getLayoutType()?i.positionsAnimate():i.autoPaint()),setTimeout(function(){a.set("localRefresh",o)},16),this},e.prototype.addCombos=function(t){var n=this,i=n.get("comboTrees"),a=this.get("itemController");a.addCombos(i,t)},e.prototype.createCombo=function(t,n){var i=this;this.set("comboSorted",!1);var a="",o;if(!!t){if(Xe(t))a=t,o={id:t};else{if(a=t.id,!a){console.warn("Create combo failed. Please assign a unique string id for the adding combo.");return}o=t}var s=n.map(function(l){var f=i.findById(l),c=f.getModel(),h="";f.getType&&(h=f.getType());var d={id:f.getID(),itemType:h};return h==="combo"?(d.parentId=a,c.parentId=a):h==="node"&&(d.comboId=a,c.comboId=a),d});o.children=s,this.addItem("combo",o,!1),this.set("comboSorted",!1);var u=this.get("comboTrees");(u||[]).forEach(function(l){xo(l,function(f){return f.id===a?(f.itemType="combo",f.children=s,!1):!0})}),u&&this.sortCombos()}},e.prototype.uncombo=function(t){var n=this,i=this,a=t;if(Xe(t)&&(a=this.findById(t)),!a||a.getType&&a.getType()!=="combo"){console.warn("The item is not a combo!");return}var o=a.getModel().parentId,s=i.get("comboTrees");s||(s=[]);var u=this.get("itemMap"),l=a.get("id"),f,c=[],h=this.get("combos"),d=this.findById(o);if(s.forEach(function(p){f||xo(p,function(g){if(g.id===l){f=g;var y=a.getEdges();y.forEach(function(b){n.removeItem(b,!1)});var m=h.indexOf(a);h.splice(m,1),delete u[l],a.destroy(),n.emit("afterremoveitem",{item:a})}if(o&&f&&g.id===o){d.removeCombo(a),c=g.children;var m=c.indexOf(f);return m!==-1&&c.splice(m,1),f.children.forEach(function(x){var _=n.findById(x.id),S=_.getModel();_.getType&&_.getType()==="combo"?(x.parentId=o,delete x.comboId,S.parentId=o,delete S.comboId):_.getType&&_.getType()==="node"&&(x.comboId=o,S.comboId=o),d.addChild(_),c.push(x)}),!1}return!0})}),!o&&f){var v=s.indexOf(f);s.splice(v,1),f.children.forEach(function(p){p.parentId=void 0;var g=n.findById(p.id).getModel();delete g.parentId,delete g.comboId,p.itemType!=="node"&&s.push(p)})}},e.prototype.updateCombos=function(){var t=this,n=this,i=this.get("comboTrees"),a=n.get("itemController"),o=n.get("itemMap");(i||[]).forEach(function(s){xo(s,function(u){if(!u)return!0;var l=o[u.id];if(l&&l.getType&&l.getType()==="combo"){var f=xa([],l.getStates());xe(f,function(c){return t.setItemState(l,c,!1)}),a.updateCombo(l,u.children),xe(f,function(c){return t.setItemState(l,c,!0)})}return!0})}),n.sortCombos()},e.prototype.updateCombo=function(t){var n=this,i=this,a=t,o;if(Xe(t)&&(a=this.findById(t)),!a||a.getType&&a.getType()!=="combo"){console.warn("The item to be updated is not a combo!");return}o=a.get("id");var s=this.get("comboTrees"),u=i.get("itemController"),l=i.get("itemMap");(s||[]).forEach(function(f){xo(f,function(c){if(!c)return!0;var h=l[c.id];if(o===c.id&&h&&h.getType&&h.getType()==="combo"){var d=xa([],h.getStates());xe(d,function(v){h.getStateStyle(v)&&n.setItemState(h,v,!1)}),u.updateCombo(h,c.children),xe(d,function(v){h.getStateStyle(v)&&n.setItemState(h,v,!0)}),o&&(o=c.parentId)}return!0})})},e.prototype.updateComboTree=function(t,n,i){i===void 0&&(i=!0);var a=this;this.set("comboSorted",!1);var o;Xe(t)?o=a.findById(t):o=t;var s=o.getModel(),u=s.comboId||s.parentId,l="";if(o.getType&&(l=o.getType()),n&&l==="combo"){var f=this.get("comboTrees"),c=!0,h;if((f||[]).forEach(function(m){h||Mi(m,function(b){if(!h)return b.id===o.getID()&&(h=b),!0})}),Mi(h,function(m){return m.id===n?(c=!1,!1):!0}),!c){console.warn("Failed to update the combo tree! The parentId points to a descendant of the combo!");return}}if(i&&this.get("enabledStack")){var d={},v={};l==="combo"?(d.combos=[{id:s.id,parentId:s.parentId}],v.combos=[{id:s.id,parentId:n}]):l==="node"&&(d.nodes=[{id:s.id,parentId:s.comboId}],v.nodes=[{id:s.id,parentId:n}]),this.pushStack("updateComboTree",{before:d,after:v})}if(s.parentId||s.comboId){var p=this.findById(s.parentId||s.comboId);p&&p.removeChild(o)}if(l==="combo"?s.parentId=n:l==="node"&&(s.comboId=n),n){var g=this.findById(n);g&&g.addChild(o)}if(u){var g=this.findById(u);g&&g.removeChild(o)}var y=Dg(this.get("comboTrees"),s.id,n);this.set("comboTrees",y),this.updateCombos()},e.prototype.save=function(){var t=[],n=[],i=[];return xe(this.get("nodes"),function(a){t.push(a.getModel())}),xe(this.get("edges"),function(a){n.push(a.getModel())}),xe(this.get("combos"),function(a){i.push(a.getModel())}),{nodes:t,edges:n,combos:i}},e.prototype.changeSize=function(t,n){var i=this.get("viewController");return i.changeSize(t,n),this},e.prototype.refresh=function(){var t=this;if(t.emit("beforegraphrefresh"),t.get("animate"))t.positionsAnimate();else{var n=t.get("nodes"),i=t.get("edges"),a=t.get("edges");xe(n,function(o){o.refresh()}),xe(i,function(o){o.refresh()}),xe(a,function(o){o.refresh()})}t.emit("aftergraphrefresh"),t.autoPaint()},e.prototype.getNodes=function(){return this.get("nodes")},e.prototype.getEdges=function(){return this.get("edges")},e.prototype.getCombos=function(){return this.get("combos")},e.prototype.getComboChildren=function(t){if(Xe(t)&&(t=this.findById(t)),!t||t.getType&&t.getType()!=="combo"){console.warn("The combo does not exist!");return}return t.getChildren()},e.prototype.positionsAnimate=function(){var t=this;t.emit("beforeanimate");var n=t.get("animateCfg"),i=n.onFrame,a=t.getNodes(),o=a.map(function(u){var l=u.getModel();return{id:l.id,x:l.x,y:l.y}});t.isAnimating()&&t.stopAnimate();var s=t.get("canvas");s.animate(function(u){xe(o,function(l){var f=t.findById(l.id);if(!(!f||f.destroyed)){var c=f.get("originAttrs"),h=f.get("model");if(!c){var d=f.getContainer().getMatrix();d||(d=[1,0,0,0,1,0,0,0,1]),c={x:d[6],y:d[7]},f.set("originAttrs",c)}if(i){var v=i(f,u,l,c);f.set("model",Object.assign(h,v))}else h.x=c.x+(l.x-c.x)*u,h.y=c.y+(l.y-c.y)*u}}),t.refreshPositions()},{duration:n.duration,easing:n.easing,callback:function(){xe(a,function(l){l.set("originAttrs",null)}),n.callback&&n.callback(),t.emit("afteranimate"),t.animating=!1}})},e.prototype.refreshPositions=function(){var t=this;t.emit("beforegraphrefreshposition");var n=t.get("nodes"),i=t.get("edges"),a=t.get("vedges"),o=t.get("combos"),s,u={};xe(n,function(l){s=l.getModel();var f=l.get("originAttrs");if(!(f&&s.x===f.x&&s.y===f.y)){var c=l.updatePosition({x:s.x,y:s.y});u[s.id]=c,s.comboId&&(u[s.comboId]=u[s.comboId]||c)}}),o&&o.length!==0&&t.updateCombos(),xe(i,function(l){var f=l.getSource().getModel(),c=l.getTarget();if(!Un(c)){var h=c.getModel();(u[f.id]||u[h.id]||l.getModel().isComboEdge)&&l.refresh()}}),xe(a,function(l){l.refresh()}),t.emit("aftergraphrefreshposition"),t.autoPaint()},e.prototype.stopAnimate=function(){this.get("canvas").stopAnimate()},e.prototype.isAnimating=function(){return this.animating},e.prototype.getZoom=function(){var t=this.get("group").getMatrix();return t?t[0]:1},e.prototype.getCurrentMode=function(){var t=this.get("modeController");return t.getMode()},e.prototype.setMode=function(t){var n=this.get("modeController");return n.setMode(t),this},e.prototype.clear=function(t){var n;return t===void 0&&(t=!1),(n=this.get("canvas"))===null||n===void 0||n.clear(),this.initGroups(),this.set({itemMap:{},nodes:[],edges:[],groups:[],combos:[],comboTrees:[]}),t||this.emit("afterrender"),this},e.prototype.updateLayout=function(t,n,i){var a=this,o=this.get("layoutController");if(Xe(t)&&(t={type:t}),n){var s=i;s||(n==="begin"?s={x:0,y:0}:s={x:this.getWidth()/2,y:this.getHeight()/2}),s=this.getPointByCanvas(s.x,s.y);var u=["force","gForce","fruchterman"];u.includes(t.type)||!t.type&&u.includes(o==null?void 0:o.layoutType)?t.center=[s.x,s.y]:this.once("afterlayout",function(c){var h=a.getGroup().getMatrix()||[1,0,0,0,1,0,0,0,1];s.x=s.x*h[0]+h[6],s.y=s.y*h[0]+h[7];var d=a.getGroup().getCanvasBBox(),v=d.minX,p=d.maxX,g=d.minY,y=d.maxY,m={x:(v+p)/2,y:(g+y)/2};n==="begin"&&(m.x=v,m.y=g),a.translate(s.x-m.x,s.y-m.y)})}var l=this.get("layout"),f={};Object.assign(f,l,t),this.set("layout",f),o.isLayoutTypeSame(f)&&f.gpuEnabled===l.gpuEnabled?o.updateLayoutCfg(f):o.changeLayout(f)},e.prototype.destroyLayout=function(){var t=this.get("layoutController");t.destroyLayout()},e.prototype.layout=function(){var t=this.get("layoutController"),n=this.get("layout");if(!(!n||!t)){if(n.workerEnabled){t.layout();return}t.layoutMethod?t.relayout(!0):t.layout()}},e.prototype.collapseCombo=function(t){var n=this;if(Xe(t)&&(t=this.findById(t)),!t){console.warn("The combo to be collapsed does not exist!");return}this.emit("beforecollapseexpandcombo",{action:"expand",item:t});var i=t.getModel(),a=this.get("itemController");a.collapseCombo(t),i.collapsed=!0;var o=this.getEdges().concat(this.get("vedges")),s=[],u=[],l=this.get("comboTrees"),f=!1;(l||[]).forEach(function(d){f||Mi(d,function(v){if(f&&v.depth<=i.depth)return!1;if(i.id===v.id&&(f=!0),f){var p=n.findById(v.id);p&&p.getType&&p.getType()==="combo"&&(s=s.concat(p.getNodes()),u=u.concat(p.getCombos()))}return!0})});var c={},h=[];o.forEach(function(d){if(!(d.isVisible()&&!d.getModel().isVEdge)){var v=d.getSource(),p=d.getTarget();if((s.includes(v)||u.includes(v))&&!s.includes(p)&&!u.includes(p)||v.getModel().id===i.id){var g=d.getModel();if(g.isVEdge){n.removeItem(d,!1);return}for(var y=p.getModel();!p.isVisible();){if(p=n.findById(y.parentId||y.comboId),!p||!y.parentId&&!y.comboId)return;y=p.getModel()}var m=y.id;if(c[i.id+"-"+m]){c[i.id+"-"+m]+=g.size||1;return}var b=n.addItem("vedge",{source:i.id,target:m,isVEdge:!0},!1);c[i.id+"-"+m]=g.size||1,h.push(b)}else if(!s.includes(v)&&!u.includes(v)&&(s.includes(p)||u.includes(p))||p.getModel().id===i.id){var g=d.getModel();if(g.isVEdge){n.removeItem(d,!1);return}for(var x=v.getModel();!v.isVisible();){if(v=n.findById(x.parentId||x.comboId),!v||!x.parentId&&!x.comboId)return;x=v.getModel()}var _=x.id;if(c[_+"-"+i.id]){c[_+"-"+i.id]+=g.size||1;return}var b=n.addItem("vedge",{target:i.id,source:_,isVEdge:!0},!1);c[_+"-"+i.id]=g.size||1,h.push(b)}}}),h.forEach(function(d){var v=d.getModel();n.updateItem(d,{size:c[v.source+"-"+v.target]},!1)}),this.emit("aftercollapseexpandcombo",{action:"collapse",item:t})},e.prototype.expandCombo=function(t){var n=this;if(Xe(t)&&(t=this.findById(t)),!t||t.getType&&t.getType()!=="combo"){console.warn("The combo to be collapsed does not exist!");return}this.emit("beforecollapseexpandcombo",{action:"expand",item:t});var i=t.getModel(),a=this.get("itemController");a.expandCombo(t),i.collapsed=!1;var o=this.getEdges().concat(this.get("vedges")),s=[],u=[],l=this.get("comboTrees"),f=!1;(l||[]).forEach(function(d){f||Mi(d,function(v){if(f&&v.depth<=i.depth)return!1;if(i.id===v.id&&(f=!0),f){var p=n.findById(v.id);p&&p.getType&&p.getType()==="combo"&&(s=s.concat(p.getNodes()),u=u.concat(p.getCombos()))}return!0})});var c={},h={};o.forEach(function(d){if(!(d.isVisible()&&!d.getModel().isVEdge)){var v=d.getSource(),p=d.getTarget(),g=v.get("id"),y=p.get("id");if((s.includes(v)||u.includes(v))&&!s.includes(p)&&!u.includes(p)||g===i.id){if(d.getModel().isVEdge){n.removeItem(d,!1);return}for(var m=p.getModel();!p.isVisible();){if(p=n.findById(m.comboId||m.parentId),!p||!m.parentId&&!m.comboId)return;m=p.getModel()}y=m.id;for(var b=v.getModel();!v.isVisible();){if(v=n.findById(b.comboId||b.parentId),!v||!b.parentId&&!b.comboId)return;if(b.comboId===i.id||b.parentId===i.id)break;b=v.getModel()}if(g=b.id,y){var x=g+"-"+y;if(c[x]){c[x]+=d.getModel().size||1,n.updateItem(h[x],{size:c[x]},!1);return}var _=n.addItem("vedge",{source:g,target:y,isVEdge:!0},!1);c[x]=d.getModel().size||1,h[x]=_}}else if(!s.includes(v)&&!u.includes(v)&&(s.includes(p)||u.includes(p))||y===i.id){if(d.getModel().isVEdge){n.removeItem(d,!1);return}for(var b=v.getModel();!v.isVisible();){if(v=n.findById(b.comboId||b.parentId),!v||!b.parentId&&!b.comboId)return;b=v.getModel()}g=b.id;for(var m=p.getModel();!p.isVisible();){if(p=n.findById(m.comboId||m.parentId),!p||!m.parentId&&!m.comboId)return;if(m.comboId===i.id||m.parentId===i.id)break;m=p.getModel()}if(y=m.id,g){var x=g+"-"+y;if(c[x]){c[x]+=d.getModel().size||1,n.updateItem(h[x],{size:c[x]},!1);return}var _=n.addItem("vedge",{target:y,source:g,isVEdge:!0},!1);c[x]=d.getModel().size||1,h[x]=_}}else(s.includes(v)||u.includes(v))&&(s.includes(p)||u.includes(p))&&v.isVisible()&&p.isVisible()&&d.show()}}),this.emit("aftercollapseexpandcombo",{action:"expand",item:t})},e.prototype.collapseExpandCombo=function(t){if(Xe(t)&&(t=this.findById(t)),!(!t||t.getType&&t.getType()!=="combo")){for(var n=t.getModel(),i=this.findById(n.parentId);i;){var a=i.getModel();if(a.collapsed){console.warn("Fail to expand the combo since it's ancestor combo is collapsed."),i=void 0;return}i=this.findById(a.parentId)}var o=n.collapsed;o?this.expandCombo(t):this.collapseCombo(t),this.updateCombo(t)}},e.prototype.sortCombos=function(){var t=this,n=this.get("comboSorted");if(!n){this.set("comboSorted",!0);var i=[],a={},o=this.get("comboTrees");(o||[]).forEach(function(u){Mi(u,function(l){return i[l.depth]?i[l.depth].push(l.id):i[l.depth]=[l.id],a[l.id]=l.depth,!0})});var s=this.getEdges().concat(this.get("vedges"));(s||[]).forEach(function(u){var l=u.getModel(),f=a[l.source]||0,c=a[l.target]||0,h=Math.max(f,c);i[h]?i[h].push(l.id):i[h]=[l.id]}),i.forEach(function(u){if(!(!u||!u.length))for(var l=u.length-1;l>=0;l--){var f=t.findById(u[l]);f&&f.toFront()}})}},e.prototype.getNeighbors=function(t,n){var i=t;return Xe(t)&&(i=this.findById(t)),i.getNeighbors(n)},e.prototype.getNodeDegree=function(t,n,i){n===void 0&&(n=void 0),i===void 0&&(i=!1);var a=t;Xe(t)&&(a=this.findById(t));var o=this.get("degrees");(!o||i)&&(o=mo(this.save()),this.set("degrees",o));var s=o[a.getID()],u=0;if(!s)return 0;switch(n){case"in":u=s.inDegree;break;case"out":u=s.outDegree;break;case"all":u=s;break;default:u=s.degree;break}return u},e.prototype.getUndoStack=function(){return this.undoStack},e.prototype.getRedoStack=function(){return this.redoStack},e.prototype.getStackData=function(){return this.get("enabledStack")?{undoStack:this.undoStack.toArray(),redoStack:this.redoStack.toArray()}:null},e.prototype.clearStack=function(){this.get("enabledStack")&&(this.undoStack.clear(),this.redoStack.clear())},e.prototype.pushStack=function(t,n,i){if(t===void 0&&(t="update"),i===void 0&&(i="undo"),!this.get("enabledStack")){console.warn("\u8BF7\u5148\u542F\u7528 undo & redo \u529F\u80FD\uFF0C\u5728\u5B9E\u4F8B\u5316 Graph \u65F6\u5019\u914D\u7F6E enabledStack: true !");return}var a=n?Cr(n):{before:{},after:Cr(this.save())};i==="redo"?this.redoStack.push({action:t,data:a}):this.undoStack.push({action:t,data:a}),this.emit("stackchange",{undoStack:this.undoStack,redoStack:this.redoStack})},e.prototype.getAdjMatrix=function(t,n){t===void 0&&(t=!0),n===void 0&&(n=this.get("directed"));var i=this.get("adjMatrix");return(!i||!t)&&(i=ys(this.save(),n),this.set("adjMatrix",i)),i},e.prototype.getShortestPathMatrix=function(t,n){t===void 0&&(t=!0),n===void 0&&(n=this.get("directed"));var i=this.get("adjMatrix"),a=this.get("shortestPathMatrix");return(!i||!t)&&(i=ys(this.save(),n),this.set("adjMatrix",i)),(!a||!t)&&(a=Kl(this.save(),n),this.set("shortestPathMatrix",a)),a},e.prototype.on=function(t,n,i){return r.prototype.on.call(this,t,n,i)},e.prototype.destroy=function(){this.clear(),this.clearStack(),this.get("itemController").destroy(),this.get("modeController").destroy(),this.get("viewController").destroy(),this.get("stateController").destroy(),this.get("canvas").destroy(),this.cfg=null,this.destroyed=!0,this.redoStack=null,this.undoStack=null},e.prototype.createHull=function(t){if(!t.members||t.members.length<1){console.warn("Create hull failed! The members is empty.");return}var n=this.get("hullGroup"),i=this.get("hullMap");if(i||(i={},this.set("hullMap",i)),(!n||n.get("destroyed"))&&(n=this.get("group").addGroup({id:"hullGroup"}),n.toBack(),this.set("hullGroup",n)),i[t.id])return console.warn("Existed hull id."),i[t.id];var a=n.addGroup({id:t.id+"-container"}),o=new lU(this,L(L({},t),{group:a})),s=o.id;return i[s]=o,o},e.prototype.getHulls=function(){return this.get("hullMap")},e.prototype.getHullById=function(t){return this.get("hullMap")[t]},e.prototype.removeHull=function(t){var n;Xe(t)?n=this.getHullById(t):n=t;var i=this.get("hullMap");delete i[n.id],n.destroy()},e.prototype.removeHulls=function(){var t=this.getHulls();!t||!Object.keys(t).length||(Object.keys(t).forEach(function(n){var i=t[n];i.destroy()}),this.set("hullMap",{}))},e}(yx);function rd(r){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?rd=function(t){return typeof t}:rd=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rd(r)}var Ss=_h,hU="-shape",FS="-label",nd=["startArrow","endArrow"],US={lineWidth:1,stroke:void 0,fill:void 0,lineAppendWidth:1,opacity:void 0,strokeOpacity:void 0,fillOpacity:void 0,x:0,y:0,r:10,width:20,height:20,shadowColor:void 0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0},dU={lineWidth:1,stroke:"#000",lineDash:void 0,startArrow:!1,endArrow:!1,opacity:void 0,strokeOpacity:void 0,fillOpacity:void 0,shadowColor:void 0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0},id={edge:dU,node:US,combo:US},Sy="-label-bg",Ey={options:{},itemType:"",type:"",getCustomConfig:function(e){return{}},getOptions:function(e,t){return t==="move"||t==="bbox"?{}:Hr({labelCfg:{style:{fontFamily:typeof window!="undefined"&&window.getComputedStyle&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif"}},descriptionCfg:{style:{fontFamily:typeof window!="undefined"&&window.getComputedStyle&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif"}}},this.options,this.getCustomConfig(e)||{},e)},draw:function(e,t){var n=this.drawShape(e,t);if(n.set("className",this.itemType+hU),e.label){var i=this.drawLabel(e,t);i.set("className",this.itemType+FS)}return n},afterDraw:function(e,t,n){},drawShape:function(e,t){return null},drawLabel:function(e,t){var n=this.getOptions(e).labelCfg,i=n||{},a=this.getLabelStyle(e,i,t),o=a.rotate;delete a.rotate;var s=t.addShape("text",{attrs:a,draggable:!0,className:"text-shape",name:"text-shape"});if(!isNaN(o)&&o!==""){var u=s.getBBox(),l=[1,0,0,0,1,0,0,0,1];if(a.rotateCenter)switch(a.rotateCenter){case"center":l=Ss(l,[["t",-u.width/2,-u.height/2],["r",o],["t",u.width/2,u.height/2]]);break;case"lefttop":l=Ss(l,[["t",-a.x,-a.y],["r",o],["t",a.x,a.y]]);break;case"leftcenter":l=Ss(l,[["t",-a.x,-a.y-u.height/2],["r",o],["t",a.x,a.y+u.height/2]]);break;default:l=Ss(l,[["t",-u.width/2,-u.height/2],["r",o],["t",u.width/2,u.height/2]]);break}else l=Ss(l,[["t",-a.x,-a.y-u.height/2],["r",o],["t",a.x,a.y+u.height/2]]);s.setMatrix(l)}if(a.background){var f=this.drawLabelBg(e,t,s),c=this.itemType+Sy;f.set("classname",c),s.toFront()}return s},drawLabelBg:function(e,t,n){var i=this.options.labelCfg,a=St({},i,e.labelCfg),o=this.getLabelBgStyleByPosition(n,e,a,t),s=t.addShape("rect",{name:"text-bg-shape",attrs:o});return s},getLabelStyleByPosition:function(e,t,n){return{text:e.label}},getLabelBgStyleByPosition:function(e,t,n,i){return{}},getLabelStyle:function(e,t,n){var i=this.getLabelStyleByPosition(e,t,n),a=this.itemType+"Label",o=Tt[a]?Tt[a].style:null,s=L(L(L({},o),i),t.style);return s},getShapeStyle:function(e){return e.style},update:function(e,t,n){this.updateShapeStyle(e,t,n),this.updateLabel(e,t,n)},updateShapeStyle:function(e,t,n){var i=t.getContainer(),a=t.getKeyShape(),o=St({},a.attr(),e.style),s=function(f){var c,h=o[f];if(Un(h)){var d=i.find(function(v){return v.get("name")===f});d&&d.attr(h)}else a.attr((c={},c[f]=h,c))};for(var u in o)s(u)},updateLabel:function(e,t,n){var i=t.getContainer(),a=this.getOptions({},n).labelCfg,o=this.itemType+FS,s=i.find(function(S){return S.get("className")===o}),u=this.itemType+Sy,l=i.find(function(S){return S.get("classname")===u});if(e.label||e.label==="")if(s){var c={};t.getModel&&(c=t.getModel().labelCfg);var h=Hr({},a,c,e.labelCfg),d=this.getLabelStyleByPosition(e,h,i),v=e.labelCfg?e.labelCfg.style:void 0,p=h.style&&h.style.background,g=L(L(L({},s.attr()),d),v),y=g.rotate;if(delete g.rotate,!isNaN(y)&&y!==""){var m=[1,0,0,0,1,0,0,0,1];m=Ss(m,[["t",-g.x,-g.y],["r",y],["t",g.x,g.y]]),s.resetMatrix(),s.attr(L(L({},g),{matrix:m}))}else s.resetMatrix(),s.attr(g);if(!l)g.background&&(l=this.drawLabelBg(e,i,s),l.set("classname",u),s.toFront());else if(g.background){var b=this.getLabelBgStyleByPosition(s,e,h,i),x=L(L({},b),p);if(l.resetMatrix(),!isNaN(y)&&y!==""){var _=[1,0,0,0,1,0,0,0,1];_=Ss(_,[["t",-x.x,-x.y],["r",y],["t",x.x,x.y]]),x.matrix=_}l.attr(x)}else i.removeChild(l)}else{var f=this.drawLabel(e,i);f.set("className",o)}},afterUpdate:function(e,t){},setState:function(e,t,n){var i,a,o=n.get("keyShape");if(!(!o||o.destroyed)){var s=n.getType(),u=tg(t)?e:e+":"+t,l=this.getStateStyle(u,n),f=n.getStateStyle(u);if(!(!f&&!l)){var c=St({},f||l),h=n.getContainer(),d={x:1,y:1,cx:1,cy:1};if(s==="combo"&&(d.r=1,d.width=1,d.height=1),t){var v=function(U){var q,K=c[U];if(Un(K)&&!nd.includes(U)){var le=h.find(function(he){return he.get("name")===U});le&&le.attr(K)}else o.attr((q={},q[U]=K,q))};for(var p in c)v(p)}else{var g=Rh(n.getCurrentStatesStyle()),y=n.getModel(),m=St({},y.style,Rh(n.getOriginStyle())),b=o.get("name"),x=o.attr(),_={};Object.keys(x).forEach(function(O){if(O!=="img"){var U=x[O];U&&rd(U)==="object"?_[O]=Cr(U):_[O]=U}});var S={},E=function(U){var q=c[U];if(Un(q)&&!nd.includes(U)){var K=h.find(function(te){return te.get("name")===U});if(K){var le=Rh(K.attr());xe(q,function(te,se){if(U===b&&_[se]&&!d[se]){delete _[se];var ge=m[U][se]||id[s][se];o.attr(se,ge)}else if(le[se]||le[se]===0){delete le[se];var Se=m[U][se]||id[s][se];K.attr(se,Se)}}),S[U]=le}}else if(_[U]&&!d[U]){delete _[U];var he=m[U]||(m[b]?m[b][U]:void 0)||id[s][U];o.attr(U,he)}};for(var C in c)E(C);b?S[b]=_:St(S,_);for(var p in g)if(!d[p]){var M=g[p];(!Un(M)||nd.includes(p))&&(b?(St(m[b],(a={},a[p]=M,a)),delete m[p]):St(m,(i={},i[p]=M,i)),delete g[p])}var w={};Hr(w,m,S,g);var T=!1,I=function(U){var q,K,le=w[U];if(Un(le)&&!nd.includes(U)){var he=h.find(function(se){return se.get("name")===U});he&&(he.get("type")==="text"&&(delete le.x,delete le.y,delete le.matrix),U===b&&(s==="combo"&&(delete le.r,delete le.width,delete le.height),T=!0),he.attr(le))}else if(!T){var te=le||id[s][U];s==="combo"?b||o.attr((q={},q[U]=te,q)):o.attr((K={},K[U]=te,K))}};for(var k in w)I(k)}}}},getStateStyle:function(e,t){var n=t.getModel(),i=t.getType(),a=this.getOptions(n),o=a.stateStyles,s=a.style,u=s===void 0?{}:s,l=n.stateStyles?n.stateStyles[e]:o&&o[e];return i==="combo"?Cr(l):St({},u,l)},getControlPoints:function(e){return e.controlPoints},getAnchorPoints:function(e){var t,n,i=(e==null?void 0:e.anchorPoints)||((t=this.getCustomConfig(e))===null||t===void 0?void 0:t.anchorPoints)||((n=this.options)===null||n===void 0?void 0:n.anchorPoints);return i}},vU={itemType:"node",shapeType:"single-node",labelPosition:"center",offset:Tt.nodeLabel.offset,getSize:function(e){var t=e.size||this.getOptions({}).size||Tt.defaultNode.size;return At(t)&&t.length===1&&(t=[t[0],t[0]]),At(t)||(t=[t,t]),t},getLabelStyleByPosition:function(e,t){var n=t.position||this.labelPosition;if(n==="center")return{x:0,y:0,text:e.label};var i=t.offset;yt(i)&&(i=this.offset);var a=this.getSize(e),o=a[0],s=a[1],u;switch(n){case"top":u={x:0,y:0-s/2-i,textBaseline:"bottom"};break;case"bottom":u={x:0,y:s/2+i,textBaseline:"top"};break;case"left":u={x:0-o/2-i,y:0,textAlign:"right"};break;default:u={x:o/2+i,y:0,textAlign:"left"};break}return u.text=e.label,u},getLabelBgStyleByPosition:function(e,t,n,i){if(!e)return{};var a=e.getBBox(),o=n.style&&n.style.background;if(!o)return{};var s=hy(o.padding),u=a.width+s[1]+s[3],l=a.height+s[0]+s[2];n.offset;var f;return f={x:a.minX-s[3],y:a.minY-s[0]},f=L(L(L({},f),o),{width:u,height:l}),f},drawShape:function(e,t){var n=this.shapeType,i=this.getShapeStyle(e),a=t.addShape(n,{attrs:i,draggable:!0,name:"node-shape"});return a},updateLinkPoints:function(e,t){var n=this.getOptions(e).linkPoints,i=t.find(function(E){return E.get("className")==="link-point-left"}),a=t.find(function(E){return E.get("className")==="link-point-right"}),o=t.find(function(E){return E.get("className")==="link-point-top"}),s=t.find(function(E){return E.get("className")==="link-point-bottom"}),u;i&&(u=i.attr()),a&&!u&&(u=a.attr()),o&&!u&&(u=o.attr()),s&&!u&&(u=s.attr()),u||(u=n);var l=St({},u,e.linkPoints),f=l.fill,c=l.stroke,h=l.lineWidth,d=l.size/2;d||(d=l.r);var v=e.linkPoints?e.linkPoints:{left:void 0,right:void 0,top:void 0,bottom:void 0},p=v.left,g=v.right,y=v.top,m=v.bottom,b=this.getSize(e),x=b[0],_=b[1],S={r:d,fill:f,stroke:c,lineWidth:h};i?!p&&p!==void 0?i.remove():i.attr(L(L({},S),{x:-x/2,y:0})):p&&t.addShape("circle",{attrs:L(L({},S),{x:-x/2,y:0}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0}),a?(!g&&g!==void 0&&a.remove(),a.attr(L(L({},S),{x:x/2,y:0}))):g&&t.addShape("circle",{attrs:L(L({},S),{x:x/2,y:0}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0}),o?(!y&&y!==void 0&&o.remove(),o.attr(L(L({},S),{x:0,y:-_/2}))):y&&t.addShape("circle",{attrs:L(L({},S),{x:0,y:-_/2}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0}),s?!m&&m!==void 0?s.remove():s.attr(L(L({},S),{x:0,y:_/2})):m&&t.addShape("circle",{attrs:L(L({},S),{x:0,y:_/2}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0})},updateShape:function(e,t,n,i){var a=t.get("keyShape");a.attr(L({},n)),this.updateLabel(e,t),i&&this.updateIcon(e,t)},updateIcon:function(e,t){var n=this,i=t.getContainer(),a=this.getOptions(e).icon,o=(e.icon?e.icon:{show:void 0}).show,s=i.find(function(v){return v.get("className")===n.type+"-icon"});if(s)if(o||o===void 0){var u=St({},s.attr(),a),l=u.width,f=l===void 0?20:l,c=u.height,h=c===void 0?20:c;s.attr(L(L({},u),{x:-f/2,y:-h/2}))}else s.remove();else if(o){var f=a.width,h=a.height;i.addShape("image",{attrs:L(L({},a),{x:-f/2,y:-h/2}),className:this.type+"-icon",name:this.type+"-icon"});var d=i.find(function(g){return g.get("className")==="node-label"});d&&d.toFront()}}},pU=L(L({},Ey),vU);nn.registerNode("single-node",pU);var ad="edge-shape";function gU(r){var e=r;return r==="start"?e="end":r==="end"&&(e="start"),e}var yU={itemType:"edge",labelPosition:"center",refX:0,refY:0,labelAutoRotate:!1,options:{size:Tt.defaultEdge.size,style:{x:0,y:0,stroke:Tt.defaultEdge.style.stroke,lineAppendWidth:Tt.defaultEdge.style.lineAppendWidth},labelCfg:{style:{fill:Tt.edgeLabel.style.fill,fontSize:Tt.edgeLabel.style.fontSize}},stateStyles:L({},Tt.edgeStateStyles)},getPath:function(e){var t=[];return xe(e,function(n,i){i===0?t.push(["M",n.x,n.y]):t.push(["L",n.x,n.y])}),t},getShapeStyle:function(e){var t=this.options.style,n={stroke:e.color},i=St({},t,n,e.style),a=e.size||Tt.defaultEdge.size;e=this.getPathPoints(e);var o=e.startPoint,s=e.endPoint,u=this.getControlPoints(e),l=[o];u&&(l=l.concat(u)),l.push(s);var f=this.getPath(l),c=St({},Tt.defaultEdge.style,{stroke:Tt.defaultEdge.color,lineWidth:a,path:f},i);return c},updateShapeStyle:function(e,t,n){var i,a=t.getContainer(),o={stroke:e.color},s=((i=t.getKeyShape)===null||i===void 0?void 0:i.call(t))||a.find(function(x){return x.get("className")==="edge-shape"}),u=e.size;e=this.getPathPoints(e);var l=e.startPoint,f=e.endPoint,c=this.getControlPoints(e),h=[l];c&&(h=h.concat(c)),h.push(f);var d=s.attr(),v=St({},o,d,e.style),p=e.sourceNode,g=e.targetNode,y={radius:v.radius};c||(y={source:p,target:g,offset:v.offset,radius:v.radius});var m=this.getPath(h,y),b={};n==="move"?b={path:m}:(d.endArrow&&v.endArrow===!1&&(e.style.endArrow={path:""}),d.startArrow&&v.startArrow===!1&&(e.style.startArrow={path:""}),b=St(o,d,{lineWidth:u,path:m},e.style)),s&&s.attr(b)},getLabelStyleByPosition:function(e,t,n){var i=t.position||this.labelPosition,a={},o=n&&n.find(function(h){return h.get("className")===ad}),s;i==="start"?s=0:i==="end"?s=1:s=.5;var u=t.refX||this.refX,l=t.refY||this.refY;if(e.startPoint.x===e.endPoint.x&&e.startPoint.y===e.endPoint.y)return a.x=e.startPoint.x+u,a.y=e.startPoint.y+l,a.text=e.label,a;var f;yt(t.autoRotate)?f=this.labelAutoRotate:f=t.autoRotate;var c=Ig(o,s,u,l,f);return a.x=c.x,a.y=c.y,a.rotate=c.rotate,a.textAlign=this._getTextAlign(i,c.angle),a.text=e.label,a},getLabelBgStyleByPosition:function(e,t,n,i){if(!e)return{};var a=e.getBBox(),o=n.style&&n.style.background;if(!o)return{};var s=o.padding,u=a.width+s[1]+s[3],l=a.height+s[0]+s[2],f=n.position||this.labelPosition,c=L(L({},o),{width:u,height:l,x:a.minX-s[2],y:a.minY-s[0],rotate:0}),h;yt(n.autoRotate)?h=this.labelAutoRotate:h=n.autoRotate;var d=i&&i.find(function(b){return b.get("className")===ad}),v;f==="start"?v=0:f==="end"?v=1:v=.5;var p=n.refX||this.refX,g=n.refY||this.refY;if(t.startPoint.x===t.endPoint.x&&t.startPoint.y===t.endPoint.y)return c.x=t.startPoint.x+p-u/2,c.y=t.startPoint.y+g-l/2,c;var y=p-u/2;n.position==="start"?y=p-s[2]:n.position==="end"&&(y=p-u);var m=Ig(d,v,y,g+l/2,h);return h&&(c.x=m.x,c.y=m.y),c.rotate=m.rotate,c},_getTextAlign:function(e,t){var n="center";return t?(t=t%(Math.PI*2),e!=="center"&&(t>=0&&t<=Math.PI/2||t>=3/2*Math.PI&&t<2*Math.PI?n=e:n=gU(e)),n):e},getControlPoints:function(e){return e.controlPoints},getPathPoints:function(e){return e},drawShape:function(e,t){var n=this.getShapeStyle(e),i=t.addShape("path",{className:ad,name:ad,attrs:n});return i},drawLabel:function(e,t){var n=this.options.labelCfg,i;typeof window!="undefined"&&typeof window.getComputedStyle!="undefined"?i=window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif":i="Arial, sans-serif";var a=Hr({fontFamily:i},n,e.labelCfg),o=this.getLabelStyle(e,a,t),s=o.rotate;delete o.rotate;var u=t.addShape("text",{attrs:o,name:"text-shape"});if(!isNaN(s)&&s!==""&&u.rotateAtStart(s),o.background){var l=this.drawLabelBg(e,t,u,o,s),f=this.itemType+Sy;l.set("classname",f),u.toFront()}return u},drawLabelBg:function(e,t,n,i,a){var o=this.options.labelCfg,s=Hr({},o,e.labelCfg),u=this.getLabelBgStyleByPosition(n,e,s,t);delete u.rotate;var l=t.addShape("rect",{name:"text-bg-shape",attrs:u});return isNaN(a)||l.rotateAtStart(a),l}},mU=L(L({},Ey),yU);nn.registerEdge("single-edge",mU);nn.registerEdge("line",{getControlPoints:function(){}},"single-edge");nn.registerEdge("spline",{getPath:function(e){var t=kS(e);return t}},"single-edge");nn.registerEdge("arc",{curveOffset:20,clockwise:1,getControlPoints:function(e){var t=e.startPoint,n=e.endPoint,i={x:(t.x+n.x)/2,y:(t.y+n.y)/2},a,o;if(e.controlPoints!==void 0){if(o=e.controlPoints[0],a=wg(t,o,n),t.x<=n.x&&t.y>n.y?this.clockwise=a.x>o.x?0:1:t.x<=n.x&&t.y<n.y?this.clockwise=a.x>o.x?1:0:t.x>n.x&&t.y<=n.y?this.clockwise=a.y<o.y?0:1:this.clockwise=a.y<o.y?1:0,(o.x-t.x)/(o.y-t.y)==(n.x-t.x)/(n.y-t.y))return[]}else{e.curveOffset===void 0&&(e.curveOffset=this.curveOffset),At(e.curveOffset)&&(e.curveOffset=e.curveOffset[0]),e.curveOffset<0?this.clockwise=0:this.clockwise=1;var s={x:n.x-t.x,y:n.y-t.y},u=Math.atan2(s.y,s.x);o={x:e.curveOffset*Math.cos(-Math.PI/2+u)+i.x,y:e.curveOffset*Math.sin(-Math.PI/2+u)+i.y},a=wg(t,o,n)}var l=Dh(t,a),f=[{x:l,y:l}];return f},getPath:function(e){var t=[];return t.push(["M",e[0].x,e[0].y]),e.length===2?t.push(["L",e[1].x,e[1].y]):t.push(["A",e[1].x,e[1].y,0,0,this.clockwise,e[2].x,e[2].y]),t}},"single-edge");nn.registerEdge("quadratic",{curvePosition:.5,curveOffset:-20,getControlPoints:function(e){var t=e.controlPoints;if(!t||!t.length){var n=e.startPoint,i=e.endPoint;e.curveOffset===void 0&&(e.curveOffset=this.curveOffset),e.curvePosition===void 0&&(e.curvePosition=this.curvePosition),At(this.curveOffset)&&(e.curveOffset=e.curveOffset[0]),At(this.curvePosition)&&(e.curvePosition=e.curveOffset[0]);var a=td(n,i,e.curvePosition,e.curveOffset);t=[a]}return t},getPath:function(e){var t=[];return t.push(["M",e[0].x,e[0].y]),t.push(["Q",e[1].x,e[1].y,e[2].x,e[2].y]),t}},"single-edge");nn.registerEdge("cubic",{curvePosition:[1/2,1/2],curveOffset:[-20,20],getControlPoints:function(e){var t=e.controlPoints;if(e.curveOffset===void 0&&(e.curveOffset=this.curveOffset),e.curvePosition===void 0&&(e.curvePosition=this.curvePosition),Lt(e.curveOffset)&&(e.curveOffset=[e.curveOffset,-e.curveOffset]),Lt(e.curvePosition)&&(e.curvePosition=[e.curvePosition,1-e.curvePosition]),!t||!t.length||t.length<2){var n=e.startPoint,i=e.endPoint,a=td(n,i,e.curvePosition[0],e.curveOffset[0]),o=td(n,i,e.curvePosition[1],e.curveOffset[1]);t=[a,o]}return t},getPath:function(e){var t=[];return t.push(["M",e[0].x,e[0].y]),t.push(["C",e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y]),t}},"single-edge");nn.registerEdge("cubic-vertical",{curvePosition:[1/2,1/2],minCurveOffset:[0,0],curveOffset:void 0,getControlPoints:function(e){var t=e.startPoint,n=e.endPoint;e.curvePosition===void 0&&(e.curvePosition=this.curvePosition),e.curveOffset===void 0&&(e.curveOffset=this.curveOffset),e.minCurveOffset===void 0&&(e.minCurveOffset=this.minCurveOffset),Lt(e.curveOffset)&&(e.curveOffset=[e.curveOffset,-e.curveOffset]),Lt(e.minCurveOffset)&&(e.minCurveOffset=[e.minCurveOffset,-e.minCurveOffset]),Lt(e.curvePosition)&&(e.curvePosition=[e.curvePosition,1-e.curvePosition]);var i=n.y-t.y,a=[0,0];e.curveOffset?a=e.curveOffset:Math.abs(i)<Math.abs(e.minCurveOffset[0])&&(a=e.minCurveOffset);var o={x:t.x,y:t.y+i*this.curvePosition[0]+a[0]},s={x:n.x,y:n.y-i*this.curvePosition[1]+a[1]};return[o,s]}},"cubic");nn.registerEdge("cubic-horizontal",{curvePosition:[1/2,1/2],minCurveOffset:[0,0],curveOffset:void 0,getControlPoints:function(e){var t=e.startPoint,n=e.endPoint;e.curvePosition===void 0&&(e.curvePosition=this.curvePosition),e.curveOffset===void 0&&(e.curveOffset=this.curveOffset),e.minCurveOffset===void 0&&(e.minCurveOffset=this.minCurveOffset),Lt(e.curveOffset)&&(e.curveOffset=[e.curveOffset,-e.curveOffset]),Lt(e.minCurveOffset)&&(e.minCurveOffset=[e.minCurveOffset,-e.minCurveOffset]),Lt(e.curvePosition)&&(e.curvePosition=[e.curvePosition,1-e.curvePosition]);var i=n.x-t.x,a=[0,0];e.curveOffset?a=e.curveOffset:Math.abs(i)<Math.abs(e.minCurveOffset[0])&&(a=e.minCurveOffset);var o={x:t.x+i*this.curvePosition[0]+a[0],y:t.y},s={x:n.x-i*this.curvePosition[1]+a[1],y:n.y},u=[o,s];return u}},"cubic");nn.registerEdge("loop",{getPathPoints:function(e){return C_(e)},getControlPoints:function(e){return e.controlPoints},afterDraw:function(e){e.controlPoints=void 0},afterUpdate:function(e){e.controlPoints=void 0}},"cubic");var bU={itemType:"combo",shapeType:"single-combo",labelPosition:"top",refX:Tt.comboLabel.refX,refY:Tt.comboLabel.refY,options:{style:{stroke:Tt.defaultCombo.style.stroke,fill:Tt.defaultCombo.style.fill,lineWidth:Tt.defaultCombo.style.lineWidth},labelCfg:{style:{fill:Tt.comboLabel.style.fill,fontSize:Tt.comboLabel.style.fontSize}},stateStyles:L({},Tt.comboStateStyles)},getSize:function(e){var t=Cr(e.size||this.options.size||Tt.defaultCombo.size);return At(t)&&t.length===1&&(t=[t[0],t[0]]),At(t)||(t=[t,t]),t},getLabelStyleByPosition:function(e,t){var n=t.position||this.labelPosition,i=e.style,a=e.padding||this.options.padding;At(a)&&(a=a[0]);var o=t.refX,s=t.refY;yt(o)&&(o=this.refX),yt(s)&&(s=this.refY);var u=this.getSize(e),l=Math.max(i.r,u[0]/2)||u[0]/2,f=l+a,c;switch(n){case"top":c={x:0,y:-f-s,textBaseline:"bottom",textAlign:"center"};break;case"bottom":c={x:0,y:f+s,textBaseline:"bottom",textAlign:"center"};break;case"left":c={x:-f+o,y:0,textAlign:"left"};break;case"center":c={x:0,y:0,text:e.label,textAlign:"center"};break;default:c={x:f+o,y:0,textAlign:"right"};break}return c.text=e.label,c},drawShape:function(e,t){var n=this.shapeType,i=this.getShapeStyle(e),a=t.addShape(n,{attrs:i,draggable:!0,name:"combo-shape"});return a},updateShape:function(e,t,n){var i=t.get("keyShape"),a=e.animate===void 0?this.options.animate:e.animate;a&&i.animate?i.animate(n,{duration:200,easing:"easeLinear"}):i.attr(L({},n)),this.updateLabel(e,t)}},xU=L(L({},Ey),bU);nn.registerCombo("single-combo",xU);nn.registerCombo("circle",{options:{size:[Tt.defaultCombo.size[0],Tt.defaultCombo.size[0]],padding:Tt.defaultCombo.padding[0],animate:!0,style:{stroke:Tt.defaultCombo.style.stroke,fill:Tt.defaultCombo.style.fill,lineWidth:Tt.defaultCombo.style.lineWidth},labelCfg:{style:{fill:Tt.comboLabel.style.fill,fontSize:Tt.comboLabel.style.fontSize},refX:0,refY:0},stateStyles:L({},Tt.comboStateStyles)},shapeType:"circle",labelPosition:"top",drawShape:function(e,t){var n=this.getShapeStyle(e);delete n.height,delete n.width;var i=t.addShape("circle",{attrs:n,className:"circle-combo",name:"circle-combo",draggable:!0});return i},getShapeStyle:function(e){var t=this.options.style,n=e.padding||this.options.padding;At(n)&&(n=n[0]);var i={stroke:e.color},a=St({},t,i,e.style),o;if(e.fixSize)o=Lt(e.fixSize)?e.fixSize:e.fixSize[0];else{var s=this.getSize(e);!Lt(a.r)||isNaN(a.r)?o=s[0]/2||Tt.defaultCombo.style.r:o=Math.max(a.r,s[0]/2)||s[0]/2}a.r=o+n;var u=L({x:0,y:0},a);return e.style?e.style.r=o:e.style={r:o},u},update:function(e,t){var n=this.getSize(e),i=e.padding||this.options.padding;At(i)&&(i=i[0]);var a=Cr(e.style),o;e.fixSize?o=Lt(e.fixSize)?e.fixSize:e.fixSize[0]:o=Math.max(a.r,n[0]/2)||n[0]/2,a.r=o+i;var s=t.get("sizeCache");s&&(s.r=a.r);var u={stroke:e.color},l=t.get("keyShape"),f=St({},l.attr(),u,a);e.style?e.style.r=o:e.style={r:o},this.updateShape(e,t,f,!0)}},"single-combo");nn.registerCombo("rect",{options:{size:[40,5],padding:[25,20,15,20],animate:!0,style:{radius:0,stroke:Tt.defaultCombo.style.stroke,fill:Tt.defaultCombo.style.fill,lineWidth:Tt.defaultCombo.style.lineWidth},labelCfg:{style:{fill:Tt.comboLabel.style.fill,fontSize:Tt.comboLabel.style.fontSize}},anchorPoints:[[0,.5],[1,.5]],stateStyles:L({},Tt.comboStateStyles)},shapeType:"rect",labelPosition:"top",drawShape:function(e,t){var n=this.getShapeStyle(e),i=t.addShape("rect",{attrs:n,className:"rect-combo",name:"rect-combo",draggable:!0});return i},getLabelStyleByPosition:function(e,t){var n=t.position||this.labelPosition,i=e.style,a=e.padding||this.options.padding;Lt(a)&&(a=[a,a,a,a]);var o=t.refX,s=t.refY;yt(o)&&(o=this.refX),yt(s)&&(s=this.refY);var u=i.width/2+a[3],l=i.height/2+a[0],f;switch(n){case"top":f={x:0-u+o,y:0-l+s,textBaseline:"top",textAlign:"left"};break;case"bottom":f={x:0,y:l+s,textBaseline:"bottom",textAlign:"center"};break;case"left":f={x:0-u+s,y:0,textAlign:"left"};break;case"center":f={x:0,y:0,text:e.label,textAlign:"center"};break;default:f={x:u+o,y:0,textAlign:"right"};break}return f.text=e.label,f},getShapeStyle:function(e){var t=this.options.style,n=e.padding||this.options.padding;Lt(n)&&(n=[n,n,n,n]);var i={stroke:e.color},a=St({},t,i,e.style),o=this.getSize(e),s,u,l=e.collapsed&&e.fixCollapseSize?e.fixCollapseSize:e.fixSize;l?Lt(l)?(s=l,u=l):(s=l[0],u=l[1]):(!Lt(a.width)||isNaN(a.width)?s=o[0]||Tt.defaultCombo.style.width:s=Math.max(a.width,o[0])||o[0],!Lt(a.height)||isNaN(a.height)?u=o[1]||Tt.defaultCombo.style.height:u=Math.max(a.height,o[1])||o[1]);var f=-s/2-n[3],c=-u/2-n[0];a.width=s+n[1]+n[3],a.height=u+n[0]+n[2];var h=L({x:f,y:c},a);return e.style?(e.style.width=s,e.style.height=u):e.style={width:s,height:u},h},update:function(e,t){var n=this.getSize(e),i=e.padding||this.options.padding;Lt(i)&&(i=[i,i,i,i]);var a=Cr(e.style),o,s,u=e.collapsed&&e.fixCollapseSize?e.fixCollapseSize:e.fixSize;u?Lt(u)?(o=u,s=u):(o=u[0],s=u[1]):(o=Math.max(a.width,n[0])||n[0],s=Math.max(a.height,n[1])||n[1]),a.width=o+i[1]+i[3],a.height=s+i[0]+i[2];var l=t.get("sizeCache");l&&(l.width=a.width,l.height=a.height),a.x=-o/2-i[3],a.y=-s/2-i[0];var f={stroke:e.color},c=t.get("keyShape"),h=St({},c.attr(),f,a);e.style?(e.style.width=o,e.style.height=s):e.style={width:o,height:s},this.updateShape(e,t,h,!1)},updateShape:function(e,t,n){var i=t.get("keyShape"),a=e.animate===void 0?this.options.animate:e.animate;a&&i.animate?i.animate(n,{duration:200,easing:"easeLinear"}):i.attr(L({},n)),this.updateLabel(e,t)}},"single-combo");nn.registerNode("simple-circle",{options:{size:Tt.defaultNode.size,style:{x:0,y:0,stroke:Tt.defaultNode.style.stroke,fill:Tt.defaultNode.style.fill,lineWidth:Tt.defaultNode.style.lineWidth},labelCfg:{style:{fill:Tt.nodeLabel.style.fill,fontSize:Tt.nodeLabel.style.fontSize}},stateStyles:L({},Tt.nodeStateStyles)},shapeType:"simple-circle",labelPosition:"center",drawShape:function(e,t){var n=this.getShapeStyle(e),i=t.addShape("circle",{attrs:n,className:this.type+"-keyShape",draggable:!0});return i},getShapeStyle:function(e){var t=this.getOptions(e).style,n={stroke:e.color},i=Hr({},t,n),a=this.getSize(e),o=a[0]/2,s=L({x:0,y:0,r:o},i);return s},update:function(e,t){var n=this.getSize(e),i={stroke:e.color,r:n[0]/2},a=t.get("keyShape"),o=Hr({},a.attr(),i,e.style);this.updateShape(e,t,o,!0)}},"single-node");nn.registerNode("simple-rect",{options:{size:[100,30],style:{radius:0,stroke:Tt.defaultNode.style.stroke,fill:Tt.defaultNode.style.fill,lineWidth:Tt.defaultNode.style.lineWidth},labelCfg:{style:{fill:Tt.nodeLabel.style.fill,fontSize:Tt.nodeLabel.style.fontSize}},anchorPoints:[[0,.5],[1,.5]],stateStyles:L({},Tt.nodeStateStyles)},shapeType:"simple-rect",labelPosition:"center",drawShape:function(e,t){var n=this.getShapeStyle(e),i=t.addShape("rect",{attrs:n,className:this.type+"-keyShape",name:this.type+"-keyShape",draggable:!0});return i},getShapeStyle:function(e){var t=this.getOptions(e).style,n={stroke:e.color},i=St({},t,n),a=this.getSize(e),o=i.width||a[0],s=i.height||a[1],u=L({x:-o/2,y:-s/2,width:o,height:s},i);return u},update:function(e,t){t.getContainer();var n=this.getOptions({}).style,i=this.getSize(e),a=t.get("keyShape");e.size||(i[0]=a.attr("width")||n.width,i[1]=a.attr("height")||n.height);var o={stroke:e.color,x:-i[0]/2,y:-i[1]/2,width:i[0],height:i[1]},s=St({},n,a.attr(),o);s=St(s,e.style),this.updateShape(e,t,s,!1)}},"single-node");nn.registerNode("image",{options:{img:"https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*eD7nT6tmYgAAAAAAAAAAAABkARQnAQ",size:200,clipCfg:{show:!1,type:"circle",r:50,rx:50,ry:35,width:50,height:35,points:[[30,12],[12,30],[30,48],[48,30]],path:[["M",25,25],["L",50,25],["A",12.5,12.5,0,1,1,50,50],["A",12.5,12.5,0,1,0,50,50],["L",25,75],["Z"]],x:0,y:0}},shapeType:"image",labelPosition:"bottom",drawShape:function(e,t){var n=this.shapeType,i=this.getShapeStyle(e);delete i.fill;var a=t.addShape(n,{attrs:i,className:this.type+"-keyShape",name:this.type+"-keyShape",draggable:!0});return this.drawClip(e,a),a},drawClip:function(e,t){var n=this.getOptions(e).clipCfg;if(!!n.show){var i=n.type,a=n.x,o=n.y,s=n.style;if(i==="circle"){var u=n.r;t.setClip({type:"circle",attrs:L({r:u,x:a,y:o},s)})}else if(i==="rect"){var l=n.width,f=n.height,c=a-l/2,h=o-f/2;t.setClip({type:"rect",attrs:L({x:c,y:h,width:l,height:f},s)})}else if(i==="ellipse"){var d=n.rx,v=n.ry;t.setClip({type:"ellipse",attrs:L({x:a,y:o,rx:d,ry:v},s)})}else if(i==="polygon"){var p=n.points;t.setClip({type:"polygon",attrs:L({points:p},s)})}else if(i==="path"){var g=n.path;t.setClip({type:"path",attrs:L({path:g},s)})}}},getShapeStyle:function(e){var t=this.getOptions(e).style,n=this.getSize(e),i=this.getOptions(e).img,a=n[0],o=n[1];t&&(a=t.width||n[0],o=t.height||n[1]);var s=L({x:-a/2,y:-o/2,width:a,height:o,img:i},t);return s},updateShapeStyle:function(e,t){var n=t.getContainer(),i=this.itemType+"-shape",a=n.find(function(s){return s.get("className")===i})||t.getKeyShape(),o=this.getShapeStyle(e);a&&a.attr(o)}},"single-node");var _U={triangle:function(e,t,n){e===void 0&&(e=10),t===void 0&&(t=15),n===void 0&&(n=0);var i=n*2,a="M "+i+",0 L "+(i+t)+",-"+e/2+" L "+(i+t)+","+e/2+" Z";return a},vee:function(e,t,n){e===void 0&&(e=15),t===void 0&&(t=20),n===void 0&&(n=0);var i=n*2,a="M "+i+",0 L "+(i+t)+",-"+e/2+`
        L `+(i+2*t/3)+",0 L "+(i+t)+","+e/2+" Z";return a},circle:function(e,t){e===void 0&&(e=5),t===void 0&&(t=0);var n=t*2,i="M "+n+`, 0
            a `+e+","+e+" 0 1,0 "+e*2+`,0
            a `+e+","+e+" 0 1,0 "+-e*2+",0";return i},rect:function(e,t,n){e===void 0&&(e=10),t===void 0&&(t=10),n===void 0&&(n=0);var i=n*2,a="M "+i+","+-e/2+` 
        L `+(i+t)+","+-e/2+` 
        L `+(i+t)+","+e/2+` 
        L `+i+","+e/2+" Z";return a},diamond:function(e,t,n){e===void 0&&(e=15),t===void 0&&(t=15),n===void 0&&(n=0);var i=n*2,a="M "+i+`,0 
        L `+(i+t/2)+","+-e/2+` 
        L `+(i+t)+`,0 
        L `+(i+t/2)+","+e/2+" Z";return a},triangleRect:function(e,t,n,i,a,o){e===void 0&&(e=15),t===void 0&&(t=15),n===void 0&&(n=15),i===void 0&&(i=3),a===void 0&&(a=5),o===void 0&&(o=0);var s=o*2,u=s+t+a,l="M "+s+",0 L "+(s+t)+",-"+e/2+" L "+(s+t)+","+e/2+` Z
            M `+u+", -"+n/2+`
            L `+(u+i)+" -"+n/2+`
            L `+(u+i)+" "+n/2+`
            L `+u+" "+n/2+`
            Z`;return l}},wU={collapse:function(e,t,n){return[["M",e-n,t],["a",n,n,0,1,0,n*2,0],["a",n,n,0,1,0,-n*2,0],["M",e-n+4,t],["L",e+n-4,t]]},expand:function(e,t,n){return[["M",e-n,t],["a",n,n,0,1,0,n*2,0],["a",n,n,0,1,0,-n*2,0],["M",e-n+4,t],["L",e-n+2*n-4,t],["M",e-n+n,t-n+4],["L",e,t+n-4]]},upTriangle:function(e,t,n){var i=n*Math.cos(Math.PI/6),a=n*Math.sin(Math.PI/6);return[["M",e-i,t+a],["L",e+i,t+a],["L",e,t-n],["Z"]]},downTriangle:function(e,t,n){var i=n*Math.cos(Math.PI/6),a=n*Math.sin(Math.PI/6);return[["M",e-i,t-a],["L",e+i,t-a],["L",e,t+n],["Z"]]}},SU=["#5F95FF","#61DDAA","#65789B","#F6BD16","#7262FD","#78D3F8","#9661BC","#F6903D","#008685","#F08BB4"],EU=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",defaultSubjectColors:SU}),CU=_h,ta=L(L(L(L(L(L({},G4),tG),J4),H5),EU),{transform:CU,mat3:WB}),AU=function(){function r(e){this.graph=e,this.layoutCfg=e.get("layout")||{},this.layoutType=this.getLayoutType(),this.layoutMethods=[],this.initLayout()}return r.prototype.initLayout=function(){},r.prototype.getLayoutType=function(){return this.getLayoutCfgType(this.layoutCfg)},r.prototype.getLayoutCfgType=function(e){var t=e.type;if(t)return t;var n=e.pipes;return Array.isArray(n)?n.map(function(i){return(i==null?void 0:i.type)||""}):null},r.prototype.isLayoutTypeSame=function(e){var t=this.getLayoutCfgType(e);return Array.isArray(this.layoutType)?this.layoutType.every(function(n,i){return n===t[i]}):(e==null?void 0:e.type)===this.layoutType},r.prototype.refreshLayout=function(){var e=this.graph;!e||(e.get("animate")?e.positionsAnimate():e.refreshPositions())},r.prototype.changeLayout=function(e){this.layoutCfg=e,this.destoryLayoutMethods(),this.layout()},r.prototype.changeData=function(){this.destoryLayoutMethods(),this.layout()},r.prototype.destoryLayoutMethods=function(){var e=this.layoutMethods;e==null||e.forEach(function(t){t.destroy()}),this.layoutMethods=[]},r.prototype.destroyLayout=function(){var e=this.graph;this.destoryLayoutMethods(),e.set("layout",void 0),this.layoutCfg=void 0,this.layoutType=void 0,this.layoutMethods=void 0},r.prototype.setDataFromGraph=function(){for(var e=[],t=[],n=[],i=[],a=[],o=[],s=[],u=this.graph.getNodes(),l=this.graph.getEdges(),f=this.graph.getCombos(),c=u.length,h=0;h<c;h++){var d=u[h];if(!(!d||d.destroyed)){var v=d.getModel();if(!d.isVisible()){t.push(v);continue}e.push(v)}}for(var p=l.length,h=0;h<p;h++){var g=l[h];if(!(!g||g.destroyed)){var v=g.getModel();if(!g.isVisible()){i.push(v);continue}v.isComboEdge?a.push(v):n.push(v)}}for(var y=f.length,h=0;h<y;h++){var m=f[h];if(!m.destroyed){var v=m.getModel();if(!m.isVisible()){i.push(v);continue}o.push(v)}}return{nodes:e,hiddenNodes:t,edges:n,hiddenEdges:i,combos:o,hiddenCombos:s,comboEdges:a}},r.prototype.reLayoutMethod=function(e,t){var n=this;return new Promise(function(i,a){var o=n.graph,s=t==null?void 0:t.type;t.onLayoutEnd=function(){o.emit("aftersublayout",{type:s}),i()},e.init(n.data),s==="force"&&(e.ticking=!1,e.forceSimulation.stop()),o.emit("beforesublayout",{type:s}),e.execute(),e.isCustomLayout&&t.onLayoutEnd&&t.onLayoutEnd()})},r.prototype.relayout=function(e){var t=this,n=this,i=n.graph,a=n.layoutMethods,o=n.layoutCfg;if(e){this.data=this.setDataFromGraph();var s=this.data.nodes;if(!s)return!1;this.initPositions(o.center,s)}i.emit("beforelayout");var u=Promise.resolve();a==null||a.forEach(function(l,f){var c=o[f];u=u.then(function(){return t.reLayoutMethod(l,c)})}),u.then(function(){o.onAllLayoutEnd&&o.onAllLayoutEnd()}).catch(function(l){console.warn("relayout failed",l)})},r.prototype.filterLayoutData=function(e,t){var n=e.nodes,i=e.edges,a=ti(e,["nodes","edges"]);if(!n)return e;var o,s;Kr(t==null?void 0:t.nodesFilter)?o=t.nodesFilter:o=function(){return!0};var u=n.filter(o);if(Kr(t==null?void 0:t.edgesFilter))s=t.edgesFilter;else{var l=u.reduce(function(f,c){return f[c.id]=!0,f},{});s=function(c){return l[c.source]&&l[c.target]}}return L({nodes:u,edges:i.filter(s)},a)},r.prototype.getLayoutBBox=function(e){var t=this.graph,n=fh(t.getNodes(),function(o){return o.getModel().layoutOrder}),i=Object.values(n).map(function(o){var s=gS(o);return s.size=[s.width,s.height],s}),a=Object.values(fh(e,"layoutOrder"));return{groupNodes:a,layoutNodes:i}},r.prototype.layoutAnimate=function(){},r.prototype.moveToZero=function(){var e=this.graph,t=e.get("data"),n=t.nodes;if(!(n[0].x===void 0||n[0].x===null||Zh(n[0].x))){for(var i=[0,0],a=n.length,o=0;o<a;o++){var s=n[o];i[0]+=s.x,i[1]+=s.y}i[0]/=n.length,i[1]/=n.length;for(var o=0;o<a;o++){var s=n[o];s.x-=i[0],s.y-=i[1]}}},r.prototype.initPositions=function(e,t){var n=this.graph;if(!t)return!1;var i=t?t.length:0;if(!!i){var a=n.get("width")*.85,o=n.get("height")*.85,s=Math.ceil(Math.sqrt(i)*(a/o)),u=Math.ceil(i/s),l=a/(s-1),f=o/(u-1);(!isFinite(l)||!l)&&(l=0),(!isFinite(f)||!l)&&(f=0);for(var c=e[0]-a/2,h=e[1]-o/2,d=!0,v=0;v<i;v++){var p=t[v];Zh(+p.x)&&(d=!1,p.x=v%s*l+c),Zh(+p.y)&&(d=!1,p.y=Math.floor(v/s)*f+h)}return d}},r.prototype.destroy=function(){this.graph=null,this.destoryLayoutMethods(),this.destroyed=!0},r}(),TU=function(){function r(e){this.graph=e,this.destroyed=!1,this.initEvents()}return r}(),od;(function(r){r.CLICK="click",r.DBLCLICK="dblclick",r.MOUSEDOWN="mousedown",r.MOUDEUP="mouseup",r.CONTEXTMENU="contextmenu",r.MOUSEENTER="mouseenter",r.MOUSEOUT="mouseout",r.MOUSEOVER="mouseover",r.MOUSEMOVE="mousemove",r.MOUSELEAVE="mouseleave",r.DRAGSTART="dragstart",r.DRAGEND="dragend",r.DRAG="drag",r.DRAGENTER="dragenter",r.DRAGLEAVE="dragleave",r.DRAGOVER="dragover",r.DRAGOUT="dragout",r.DDROP="drop",r.KEYUP="keyup",r.KEYDOWN="keydown",r.WHEEL="wheel",r.FOCUS="focus",r.BLUR="blur",r.TOUCHSTART="touchstart",r.TOUCHMOVE="touchmove",r.TOUCHEND="touchend",r.CANVAS_TOUCHSTART="canvas:touchstart",r.CANVAS_TOUCHMOVE="canvas:touchmove",r.CANVAS_TOUCHEND="canvas:touchend",r.NODE_TOUCHSTART="node:touchstart",r.NODE_TOUCHMOVE="node:touchmove",r.NODE_TOUCHEND="node:touchend",r.COMBO_TOUCHSTART="combo:touchstart",r.COMBO_TOUCHMOVE="combo:touchmove",r.COMBO_TOUCHEND="combo:touchend",r.EDGE_TOUCHSTART="edge:touchstart",r.EDGE_TOUCHMOVE="edge:touchmove",r.EDGE_TOUCHEND="edge:touchend",r.NODE_CONTEXTMENU="node:contextmenu",r.NODE_CLICK="node:click",r.NODE_DBLCLICK="node:dblclick",r.NODE_MOUSEDOWN="node:mousedown",r.NODE_MOUSEUP="node:mouseup",r.NODE_MOUSEENTER="node:mouseenter",r.NODE_MOUSELEAVE="node:mouseleave",r.NODE_MOUSEMOVE="node:mousemove",r.NODE_MOUSEOUT="node:mouseout",r.NODE_MOUSEOVER="node:mouseover",r.NODE_DROP="node:drop",r.NODE_DRAGOVER="node:dragover",r.NODE_DRAGENTER="node:dragenter",r.NODE_DRAGLEAVE="node:dragleave",r.NODE_DRAGSTART="node:dragstart",r.NODE_DRAG="node:drag",r.NODE_DRAGEND="node:dragend",r.NODE_TAP="node:tap",r.NODE_PANSTART="node:panstart",r.NODE_PANMOVE="node:panmove",r.NODE_PANEND="node:panend",r.COMBO_CONTEXTMENU="combo:contextmenu",r.COMBO_CLICK="combo:click",r.COMBO_DBLCLICK="combo:dblclick",r.COMBO_MOUSEDOWN="combo:mousedown",r.COMBO_MOUSEUP="combo:mouseup",r.COMBO_MOUSEENTER="combo:mouseenter",r.COMBO_MOUSELEAVE="combo:mouseleave",r.COMBO_MOUSEMOVE="combo:mousemove",r.COMBO_MOUSEOUT="combo:mouseout",r.COMBO_MOUSEOVER="combo:mouseover",r.COMBO_DROP="combo:drop",r.COMBO_DRAGOVER="combo:dragover",r.COMBO_DRAGENTER="combo:dragenter",r.COMBO_DRAGLEAVE="combo:dragleave",r.COMBO_DRAGSTART="combo:dragstart",r.COMBO_DRAG="combo:drag",r.COMBO_DRAGEND="combo:dragend",r.COMBO_TAP="combo:tap",r.COMBO_PANSTART="combo:panstart",r.COMBO_PANMOVE="combo:panmove",r.COMBO_PANEND="combo:panend",r.EDGE_CONTEXTMENU="edge:contextmenu",r.EDGE_CLICK="edge:click",r.EDGE_DBLCLICK="edge:dblclick",r.EDGE_MOUSEDOWN="edge:mousedown",r.EDGE_MOUSEUP="edge:mouseup",r.EDGE_MOUSEENTER="edge:mouseenter",r.EDGE_MOUSELEAVE="edge:mouseleave",r.EDGE_MOUSEMOVE="edge:mousemove",r.EDGE_MOUSEOUT="edge:mouseout",r.EDGE_MOUSEOVER="edge:mouseover",r.EDGE_DROP="edge:drop",r.EDGE_DRAGOVER="edge:dragover",r.EDGE_DRAGENTER="edge:dragenter",r.EDGE_DRAGLEAVE="edge:dragleave",r.CANVAS_CONTEXTMENU="canvas:contextmenu",r.CANVAS_CLICK="canvas:click",r.CANVAS_DBLCLICK="canvas:dblclick",r.CANVAS_MOUSEDOWN="canvas:mousedown",r.CANVAS_MOUSEUP="canvas:mouseup",r.CANVAS_MOUSEENTER="canvas:mouseenter",r.CANVAS_MOUSELEAVE="canvas:mouseleave",r.CANVAS_MOUSEMOVE="canvas:mousemove",r.CANVAS_MOUSEOUT="canvas:mouseout",r.CANVAS_MOUSEOVER="canvas:mouseover",r.CANVAS_DROP="canvas:drop",r.CANVAS_DRAGENTER="canvas:dragenter",r.CANVAS_DRAGLEAVE="canvas:dragleave",r.CANVAS_DRAGSTART="canvas:dragstart",r.CANVAS_DRAG="canvas:drag",r.CANVAS_DRAGEND="canvas:dragend",r.CANVAS_TAP="canvas:tap",r.CANVAS_PANSTART="canvas:panstart",r.CANVAS_PANMOVE="canvas:panmove",r.CANVAS_PANEND="canvas:panend",r.BEFORERENDER="beforerender",r.AFTERRENDER="afterrender",r.BEFOREADDITEM="beforeadditem",r.AFTERADDITEM="afteradditem",r.BEFOREREMOVEITEM="beforeremoveitem",r.AFTERREMOVEITEM="afterremoveitem",r.BEFOREUPDATEITEM="beforeupdateitem",r.AFTERUPDATEITEM="afterupdateitem",r.BEFOREITEMVISIBILITYCHANGE="beforeitemvisibilitychange",r.AFTERITEMVISIBILITYCHANGE="afteritemvisibilitychange",r.BEFOREITEMSTATECHANGE="beforeitemstatechange",r.AFTERITEMSTATECHANGE="afteritemstatechange",r.BEFOREITEMREFRESH="beforeitemrefresh",r.AFTERITEMREFRESH="afteritemrefresh",r.BEFOREITEMSTATESCLEAR="beforeitemstatesclear",r.AFTERITEMSTATESCLEAR="afteritemstatesclear",r.BEFOREMODECHANGE="beforemodechange",r.AFTERMODECHANGE="aftermodechange",r.BEFORELAYOUT="beforelayout",r.AFTERLAYOUT="afterlayout",r.BEFORECREATEEDGE="beforecreateedge",r.AFTERCREATEEDGE="aftercreateedge",r.BEFOREGRAPHREFRESHPOSITION="beforegraphrefreshposition",r.AFTERGRAPHREFRESHPOSITION="aftergraphrefreshposition",r.BEFOREGRAPHREFRESH="beforegraphrefresh",r.AFTERGRAPHREFRESH="aftergraphrefresh",r.BEFOREANIMATE="beforeanimate",r.AFTERANIMATE="afteranimate",r.BEFOREPAINT="beforepaint",r.AFTERPAINT="afterpaint",r.BEFORECOLLAPSEEXPANDCOMBO="beforecollapseexpandcombo",r.AFTERCOLLAPSEEXPANDCOMBO="aftercollapseexpandcombo",r.GRAPHSTATECHANGE="graphstatechange",r.AFTERACTIVATERELATIONS="afteractivaterelations",r.NODESELECTCHANGE="nodeselectchange",r.TOOLTIPCHANGE="tooltipchange",r.WHEELZOOM="wheelzoom",r.VIEWPORTCHANGE="viewportchange",r.DRAGNODEEND="dragnodeend",r.STACKCHANGE="stackchange",r.TAP="tap",r.PINCHSTART="pinchstart",r.PINCHMOVE="pinchmove",r.PANSTART="panstart",r.PANMOVE="panmove",r.PANEND="panend"})(od||(od={}));var Ha=nn.registerNode,zS=nn.registerEdge,MU=nn.registerCombo,$S=gx.registerBehavior,lt=Tt,Zr=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.MESSAGE=e.ALGORITHM=void 0;var t={pageRank:"pageRank",breadthFirstSearch:"breadthFirstSearch",connectedComponent:"connectedComponent",depthFirstSearch:"depthFirstSearch",detectCycle:"detectCycle",detectDirectedCycle:"detectDirectedCycle",detectAllCycles:"detectAllCycles",detectAllDirectedCycle:"detectAllDirectedCycle",detectAllUndirectedCycle:"detectAllUndirectedCycle",dijkstra:"dijkstra",findAllPath:"findAllPath",findShortestPath:"findShortestPath",floydWarshall:"floydWarshall",getAdjMatrix:"getAdjMatrix",getDegree:"getDegree",getInDegree:"getInDegree",getNeighbors:"getNeighbors",getOutDegree:"getOutDegree",labelPropagation:"labelPropagation",louvain:"louvain",GADDI:"GADDI",minimumSpanningTree:"minimumSpanningTree",SUCCESS:"SUCCESS",FAILURE:"FAILURE"};e.ALGORITHM=t;var n={SUCCESS:"SUCCESS",FAILURE:"FAILURE"};e.MESSAGE=n});Xr(Zr);Zr.MESSAGE;Zr.ALGORITHM;var pf=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=function(a,o){var s=a.nodes,u=a.edges,l=[],f={};if(!s)throw new Error("invalid nodes data!");return s&&s.forEach(function(c,h){f[c.id]=h;var d=[];l.push(d)}),u&&u.forEach(function(c){var h=c.source,d=c.target,v=f[h],p=f[d];!v&&v!==0||!p&&p!==0||(l[v][p]=1,o||(l[p][v]=1))}),l},n=t;e.default=n});Xr(pf);var Cy=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.LinkedListNode=void 0;var t=function(s,u){return s===u},n=function(){function o(s,u){u===void 0&&(u=null),this.value=s,this.next=u}return o.prototype.toString=function(s){return s?s(this.value):""+this.value},o}();e.LinkedListNode=n;var i=function(){function o(s){s===void 0&&(s=t),this.head=null,this.tail=null,this.compare=s}return o.prototype.prepend=function(s){var u=new n(s,this.head);return this.head=u,this.tail||(this.tail=u),this},o.prototype.append=function(s){var u=new n(s);return this.head?(this.tail.next=u,this.tail=u,this):(this.head=u,this.tail=u,this)},o.prototype.delete=function(s){if(!this.head)return null;for(var u=null;this.head&&this.compare(this.head.value,s);)u=this.head,this.head=this.head.next;var l=this.head;if(l!==null)for(;l.next;)this.compare(l.next.value,s)?(u=l.next,l.next=l.next.next):l=l.next;return this.compare(this.tail.value,s)&&(this.tail=l),u},o.prototype.find=function(s){var u=s.value,l=u===void 0?void 0:u,f=s.callback,c=f===void 0?void 0:f;if(!this.head)return null;for(var h=this.head;h;){if(c&&c(h.value)||l!==void 0&&this.compare(h.value,l))return h;h=h.next}return null},o.prototype.deleteTail=function(){var s=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,s;for(var u=this.head;u.next;)u.next.next?u=u.next:u.next=null;return this.tail=u,s},o.prototype.deleteHead=function(){if(!this.head)return null;var s=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),s},o.prototype.fromArray=function(s){var u=this;return s.forEach(function(l){return u.append(l)}),this},o.prototype.toArray=function(){for(var s=[],u=this.head;u;)s.push(u),u=u.next;return s},o.prototype.reverse=function(){for(var s=this.head,u=null,l=null;s;)l=s.next,s.next=u,u=s,s=l;this.tail=this.head,this.head=u},o.prototype.toString=function(s){return s===void 0&&(s=void 0),this.toArray().map(function(u){return u.toString(s)}).toString()},o}(),a=i;e.default=a});Xr(Cy);Cy.LinkedListNode;var VS=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=n(Cy);function n(o){return o&&o.__esModule?o:{default:o}}var i=function(){function o(){this.linkedList=new t.default}return o.prototype.isEmpty=function(){return!this.linkedList.head},o.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},o.prototype.enqueue=function(s){this.linkedList.append(s)},o.prototype.dequeue=function(){var s=this.linkedList.deleteHead();return s?s.value:null},o.prototype.toString=function(s){return this.linkedList.toString(s)},o}(),a=i;e.default=a});Xr(VS);var an=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.uniqueId=e.getEdgesByNodeId=e.getOutEdgesNodeId=e.getNeighbors=void 0;var t=function(s,u,l){u===void 0&&(u=[]);var f=u.filter(function(v){return v.source===s||v.target===s});if(l==="target"){var c=function(p){return p.source===s};return f.filter(c).map(function(v){return v.target})}if(l==="source"){var h=function(p){return p.target===s};return f.filter(h).map(function(v){return v.source})}var d=function(p){return p.source===s?p.target:p.source};return f.map(d)};e.getNeighbors=t;var n=function(s,u){return u.filter(function(l){return l.source===s})};e.getOutEdgesNodeId=n;var i=function(s,u){return u.filter(function(l){return l.source===s||l.target===s})};e.getEdgesByNodeId=i;var a=function(s){s===void 0&&(s=0);var u=(""+Math.random()).split(".")[1].substr(0,5),l=(""+Math.random()).split(".")[1].substr(0,5);return s+"-"+u+l};e.uniqueId=a});Xr(an);an.uniqueId;an.getEdgesByNodeId;an.getOutEdgesNodeId;an.getNeighbors;var WS=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=n(VS);function n(s){return s&&s.__esModule?s:{default:s}}function i(s){s===void 0&&(s={});var u=s,l=function(){},f=function(){var c={};return function(h){var d=h.next,v=d;return c[v]?!1:(c[v]=!0,!0)}}();return u.allowTraversal=s.allowTraversal||f,u.enter=s.enter||l,u.leave=s.leave||l,u}var a=function(u,l,f){var c=i(f),h=new t.default,d=u.edges,v=d===void 0?[]:d;h.enqueue(l);for(var p="",g=function(){var m=h.dequeue();c.enter({current:m,previous:p}),(0,an.getNeighbors)(m,v,"target").forEach(function(b){c.allowTraversal({previous:p,current:m,next:b})&&h.enqueue(b)}),c.leave({current:m,previous:p}),p=m};!h.isEmpty();)g()},o=a;e.default=o});Xr(WS);var gf=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=i,e.detectStrongConnectComponents=e.detectConnectedComponents=void 0;var t=function(o){for(var s=o.nodes,u=s===void 0?[]:s,l=o.edges,f=l===void 0?[]:l,c=[],h={},d=[],v=function m(b){d.push(b),h[b.id]=!0;for(var x=(0,an.getNeighbors)(b.id,f),_=function(C){var M=x[C];if(!h[M]){var w=u.filter(function(T){return T.id===M});w.length>0&&m(w[0])}},S=0;S<x.length;++S)_(S)},p=0;p<u.length;p++){var g=u[p];if(!h[g.id]){v(g);for(var y=[];d.length>0;)y.push(d.pop());c.push(y)}}return c};e.detectConnectedComponents=t;var n=function(o){for(var s=o.nodes,u=s===void 0?[]:s,l=o.edges,f=l===void 0?[]:l,c=[],h={},d={},v={},p=[],g=0,y=function _(S){d[S.id]=g,v[S.id]=g,g+=1,c.push(S),h[S.id]=!0;for(var E=(0,an.getNeighbors)(S.id,f,"target").filter(function(I){return u.map(function(k){return k.id}).indexOf(I)>-1}),C=function(k){var O=E[k];if(!d[O]&&d[O]!==0){var U=u.filter(function(q){return q.id===O});U.length>0&&_(U[0]),v[S.id]=Math.min(v[S.id],v[O])}else h[O]&&(v[S.id]=Math.min(v[S.id],d[O]))},M=0;M<E.length;M++)C(M);if(v[S.id]===d[S.id]){for(var w=[];c.length>0;){var T=c.pop();if(h[T.id]=!1,w.push(T),T===S)break}w.length>0&&p.push(w)}},m=0,b=u;m<b.length;m++){var x=b[m];!d[x.id]&&d[x.id]!==0&&y(x)}return p};e.detectStrongConnectComponents=n;function i(a,o){return o?n(a):t(a)}});Xr(gf);gf.detectStrongConnectComponents;gf.detectConnectedComponents;var yf=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.getOutDegree=e.getInDegree=e.default=void 0;var t=function(s){var u={},l=s.nodes,f=l===void 0?[]:l,c=s.edges,h=c===void 0?[]:c;return f.forEach(function(d){u[d.id]={degree:0,inDegree:0,outDegree:0}}),h.forEach(function(d){u[d.source].degree++,u[d.source].outDegree++,u[d.target].degree++,u[d.target].inDegree++}),u},n=t;e.default=n;var i=function(s,u){var l=t(s);return l[u]?t(s)[u].inDegree:0};e.getInDegree=i;var a=function(s,u){var l=t(s);return l[u]?t(s)[u].outDegree:0};e.getOutDegree=a});Xr(yf);yf.getOutDegree;yf.getInDegree;var Ay=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;function t(a){a===void 0&&(a={});var o=a,s=function(){},u=function(){var l={};return function(f){var c=f.next;return l[c]?!1:(l[c]=!0,!0)}}();return o.allowTraversal=a.allowTraversal||u,o.enter=a.enter||s,o.leave=a.leave||s,o}function n(a,o,s,u){u.enter({current:o,previous:s});var l=a.edges,f=l===void 0?[]:l;(0,an.getNeighbors)(o,f,"target").forEach(function(c){u.allowTraversal({previous:s,current:o,next:c})&&n(a,c,o,u)}),u.leave({current:o,previous:s})}function i(a,o,s){n(a,o,"",t(s))}});Xr(Ay);var mf=xr(function(r,e){function t(d){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t=function(p){return typeof p}:t=function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},t(d)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.detectAllCycles=e.detectAllDirectedCycle=e.detectAllUndirectedCycle=void 0;var n=s(Ay),i=o(gf);function a(d){if(typeof WeakMap!="function")return null;var v=new WeakMap,p=new WeakMap;return(a=function(y){return y?p:v})(d)}function o(d,v){if(!v&&d&&d.__esModule)return d;if(d===null||t(d)!=="object"&&typeof d!="function")return{default:d};var p=a(v);if(p&&p.has(d))return p.get(d);var g={},y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var m in d)if(m!=="default"&&Object.prototype.hasOwnProperty.call(d,m)){var b=y?Object.getOwnPropertyDescriptor(d,m):null;b&&(b.get||b.set)?Object.defineProperty(g,m,b):g[m]=d[m]}return g.default=d,p&&p.set(d,g),g}function s(d){return d&&d.__esModule?d:{default:d}}var u=function(v){var p=null,g=v.nodes,y=g===void 0?[]:g,m={},b={},x={},_={};y.forEach(function(C){b[C.id]=C});for(var S={enter:function(M){var w=M.current,T=M.previous;if(x[w]){p={};for(var I=w,k=T;k!==w;)p[I]=k,I=k,k=m[k];p[I]=k}else x[w]=w,delete b[w],m[w]=T},leave:function(M){var w=M.current;_[w]=w,delete x[w]},allowTraversal:function(M){var w=M.next;return p?!1:!_[w]}};Object.keys(b).length;){var E=Object.keys(b)[0];(0,n.default)(v,E,S)}return p},l=function(v,p,g){var y,m;g===void 0&&(g=!0);for(var b=[],x=(0,i.default)(v,!1),_=0,S=x;_<S.length;_++){var E=S[_];if(!!E.length)for(var C=E[0],M=C.id,w=[C],T=(y={},y[M]=C,y),I=(m={},m[M]=new Set,m);w.length>0;)for(var k=w.pop(),O=k.id,U=(0,an.getNeighbors)(O,v.edges),q=function(he){var te,se=U[he],ge=v.nodes.find(function(rt){return rt.id===se});if(se===O)b.push((te={},te[se]=k,te));else if(!(se in I))T[se]=k,w.push(ge),I[se]=new Set([k]);else if(!I[O].has(ge)){for(var Se=!0,ne=[ge,k],pe=T[O];I[se].size&&!I[se].has(pe)&&(ne.push(pe),pe!==T[pe.id]);)pe=T[pe.id];if(ne.push(pe),p&&g?(Se=!1,ne.findIndex(function(rt){return p.indexOf(rt.id)>-1})>-1&&(Se=!0)):p&&!g&&ne.findIndex(function(rt){return p.indexOf(rt.id)>-1})>-1&&(Se=!1),Se){for(var Ge={},ke=1;ke<ne.length;ke+=1)Ge[ne[ke-1].id]=ne[ke];ne.length&&(Ge[ne[ne.length-1].id]=ne[0]),b.push(Ge)}I[se].add(k)}},K=0;K<U.length;K+=1)q(K)}return b};e.detectAllUndirectedCycle=l;var f=function(v,p,g){g===void 0&&(g=!0);for(var y=[],m=new Set,b=[],x=[],_={},S={},E=function(pe){for(var Ge=[pe];Ge.length>0;){var ke=Ge.pop();m.has(ke)&&(m.delete(ke),b[ke.id].forEach(function(rt){Ge.push(rt)}),b[ke.id].clear())}},C=function ne(pe,Ge,ke){var rt=!1;if(p&&g===!1&&p.indexOf(pe.id)>-1)return rt;y.push(pe),m.add(pe);for(var $e=ke[pe.id],ut=0;ut<$e.length;ut+=1){var pt=_[$e[ut]];if(pt===Ge){for(var qt={},F=1;F<y.length;F+=1)qt[y[F-1].id]=y[F];y.length&&(qt[y[y.length-1].id]=y[0]),x.push(qt),rt=!0}else m.has(pt)||ne(pt,Ge,ke)&&(rt=!0)}if(rt)E(pe);else for(var ut=0;ut<$e.length;ut+=1){var pt=_[$e[ut]];b[pt.id].has(pe)||b[pt.id].add(pe)}return y.pop(),rt},M=v.nodes,w=M===void 0?[]:M,T=0;T<w.length;T+=1){var I=w[T],k=I.id;S[k]=T,_[T]=I}if(p&&g)for(var O=function(pe){var Ge=p[pe];S[w[pe].id]=S[Ge],S[Ge]=0,_[0]=w.find(function(ke){return ke.id===Ge}),_[S[w[pe].id]]=w[pe]},T=0;T<p.length;T++)O(T);for(var U=function(pe){for(var Ge,ke,rt=1/0,$e=0;$e<pe.length;$e+=1)for(var ut=pe[$e],pt=0;pt<ut.length;pt++){var qt=S[ut[pt].id];qt<rt&&(rt=qt,ke=$e)}for(var F=pe[ke],Z=[],$e=0;$e<F.length;$e+=1){var V=F[$e];Z[V.id]=[];for(var Fe=0,at=(0,an.getNeighbors)(V.id,v.edges,"target").filter(function(Ye){return F.map(function(nt){return nt.id}).indexOf(Ye)>-1});Fe<at.length;Fe++){var Me=at[Fe];Me===V.id&&!(g===!1&&p.indexOf(V.id)>-1)?x.push((Ge={},Ge[V.id]=V,Ge)):Z[V.id].push(S[Me])}}return{component:F,adjList:Z,minIdx:rt}},q=0;q<w.length;){var K=w.filter(function(ne){return S[ne.id]>=q}),le=(0,i.detectStrongConnectComponents)({nodes:K,edges:v.edges}).filter(function(ne){return ne.length>1});if(le.length===0)break;var he=U(le),te=he.minIdx,se=he.adjList,ge=he.component;if(ge.length>1){ge.forEach(function(ne){b[ne.id]=new Set});var Se=_[te];if(p&&g&&p.indexOf(Se.id)===-1)return x;C(Se,Se,se),q=te+1}else break}return x};e.detectAllDirectedCycle=f;var c=function(v,p,g,y){return y===void 0&&(y=!0),p?f(v,g,y):l(v,g,y)};e.detectAllCycles=c;var h=u;e.default=h});Xr(mf);mf.detectAllCycles;mf.detectAllDirectedCycle;mf.detectAllUndirectedCycle;var sd=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=function(s,u,l){for(var f=1/0,c,h=0;h<u.length;h++){var d=u[h].id;!l[d]&&s[d]<=f&&(f=s[d],c=u[h])}return c},n=function(s,u,l,f){var c=s.nodes,h=c===void 0?[]:c,d=s.edges,v=d===void 0?[]:d,p={},g={},y={};h.forEach(function(C,M){var w=C.id;g[w]=1/0,w===u&&(g[w]=0)});for(var m=h.length,b=function(M){var w=t(g,h,p),T=w.id;if(p[T]=!0,g[T]===1/0)return"continue";var I=[];l?I=(0,an.getOutEdgesNodeId)(T,v):I=(0,an.getEdgesByNodeId)(T,v),I.forEach(function(k){var O=k.target,U=k.source,q=O===T?U:O,K=f&&k[f]?k[f]:1;g[q]>g[w.id]+K?(g[q]=g[w.id]+K,y[q]=[w.id]):g[q]===g[w.id]+K&&y[q].push(w.id)})},x=0;x<m;x++)b();y[u]=[u];var _={};for(var S in g)g[S]!==1/0&&a(u,S,y,_);var E={};for(var S in _)E[S]=_[S][0];return{length:g,path:E,allPath:_}},i=n;e.default=i;function a(o,s,u,l){if(o===s)return[o];if(l[s])return l[s];for(var f=[],c=0,h=u[s];c<h.length;c++){var d=h[c],v=a(o,d,u,l);if(!v)return;for(var p=0,g=v;p<g.length;p++){var y=g[p];(0,sg.isArray)(y)?f.push((0,sh.__spreadArray)((0,sh.__spreadArray)([],y),[s])):f.push([y,s])}}return l[s]=f,l[s]}});Xr(sd);var bf=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.findAllPath=e.findShortestPath=void 0;var t=n(sd);function n(o){return o&&o.__esModule?o:{default:o}}var i=function(s,u,l,f,c){var h=(0,t.default)(s,u,f,c),d=h.length,v=h.path,p=h.allPath;return{length:d[l],path:v[l],allPath:p[l]}};e.findShortestPath=i;var a=function(s,u,l,f){var c;if(u===l)return[[u]];var h=s.edges,d=h===void 0?[]:h,v=[u],p=(c={},c[u]=!0,c),g=[],y=[],m=f?(0,an.getNeighbors)(u,d,"target"):(0,an.getNeighbors)(u,d);for(g.push(m);v.length>0&&g.length>0;){var b=g[g.length-1];if(b.length){var x=b.shift();x&&(v.push(x),p[x]=!0,m=f?(0,an.getNeighbors)(x,d,"target"):(0,an.getNeighbors)(x,d),g.push(m.filter(function(E){return!p[E]})))}else{var _=v.pop();p[_]=!1,g.pop();continue}if(v[v.length-1]===l){var S=v.map(function(C){return C});y.push(S);var _=v.pop();p[_]=!1,g.pop()}}return y};e.findAllPath=a});Xr(bf);bf.findAllPath;bf.findShortestPath;var Ty=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=n(pf);function n(o){return o&&o.__esModule?o:{default:o}}var i=function(s,u){for(var l=(0,t.default)(s,u),f=[],c=l.length,h=0;h<c;h+=1){f[h]=[];for(var d=0;d<c;d+=1)h===d?f[h][d]=0:l[h][d]===0||!l[h][d]?f[h][d]=1/0:f[h][d]=l[h][d]}for(var v=0;v<c;v+=1)for(var h=0;h<c;h+=1)for(var d=0;d<c;d+=1)f[h][d]>f[h][v]+f[v][d]&&(f[h][d]=f[h][v]+f[v][d]);return f},a=i;e.default=a});Xr(Ty);var jS=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=n(pf);function n(o){return o&&o.__esModule?o:{default:o}}var i=function(s,u,l,f){u===void 0&&(u=!1),l===void 0&&(l="weight"),f===void 0&&(f=1e3);var c=s.nodes,h=c===void 0?[]:c,d=s.edges,v=d===void 0?[]:d,p={},g={};h.forEach(function(M,w){var T=(0,an.uniqueId)();M.clusterId=T,p[T]={id:T,nodes:[M]},g[M.id]={node:M,idx:w}});var y=(0,t.default)(s,u),m={};y.forEach(function(M,w){var T=h[w].id;m[T]={},M.forEach(function(I,k){if(!!I){var O=h[k].id;m[T][O]=I}})});for(var b=0,x=function(){var w=!1;if(h.forEach(function(T){var I={};Object.keys(m[T.id]).forEach(function(te){var se=m[T.id][te],ge=g[te].node,Se=ge.clusterId;I[Se]||(I[Se]=0),I[Se]+=se});var k=-1/0,O=[];if(Object.keys(I).forEach(function(te){k<I[te]?(k=I[te],O=[te]):k===I[te]&&O.push(te)}),!(O.length===1&&O[0]===T.clusterId)){var U=O.indexOf(T.clusterId);if(U>=0&&O.splice(U,1),O&&O.length){w=!0;var q=p[T.clusterId],K=q.nodes.indexOf(T);q.nodes.splice(K,1);var le=Math.floor(Math.random()*O.length),he=p[O[le]];he.nodes.push(T),T.clusterId=he.id}}}),!w)return"break";b++};b<f;){var _=x();if(_==="break")break}Object.keys(p).forEach(function(M){var w=p[M];(!w.nodes||!w.nodes.length)&&delete p[M]});var S=[],E={};v.forEach(function(M){var w=M.source,T=M.target,I=M[l]||1,k=g[w].node.clusterId,O=g[T].node.clusterId,U=k+"---"+O;if(E[U])E[U].weight+=I,E[U].count++;else{var q={source:k,target:O,weight:I,count:1};E[U]=q,S.push(q)}});var C=[];return Object.keys(p).forEach(function(M){C.push(p[M])}),{clusters:C,clusterEdges:S}},a=i;e.default=a});Xr(jS);var XS=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=n(pf);function n(s){return s&&s.__esModule?s:{default:s}}var i=function(u,l,f,c){for(var h=l.length,d=2*c,v=0,p=0;p<h;p++)for(var g=u[p].clusterId,y=0;y<h;y++){var m=u[y].clusterId;if(g===m){var b=l[p][y]||0,x=f[p]||0,_=f[y]||0;v+=b-x*_/d}}return v*=1/d,v},a=function(u,l,f,c){l===void 0&&(l=!1),f===void 0&&(f="weight"),c===void 0&&(c=1e-4);var h=u.nodes,d=h===void 0?[]:h,v=u.edges,p=v===void 0?[]:v,g=1,y={},m={};d.forEach(function(U,q){var K=String(g++);U.clusterId=K,y[K]={id:K,nodes:[U]},m[U.id]={node:U,idx:q}});var b=(0,t.default)(u,l),x=[],_={},S=0;b.forEach(function(U,q){var K=0,le=d[q].id;_[le]={},U.forEach(function(he,te){if(!!he){K+=he;var se=d[te].id;_[le][se]=he,S+=he}}),x.push(K)}),S/=2;for(var E=1/0,C=1/0,M=0;E=i(d,b,x,S),!(Math.abs(E-C)<c||M>100);)C=E,M++,Object.keys(y).forEach(function(U){var q=0;p.forEach(function(K){var le=K.source,he=K.target,te=m[le].node.clusterId,se=m[he].node.clusterId;(te===U&&se!==U||se===U&&te!==U)&&(q=q+(K[f]||1))}),y[U].sumTot=q}),d.forEach(function(U,q){var K=y[U.clusterId],le=0,he,te=x[q]/(2*S),se=0,ge=K.nodes;ge.forEach(function($e){var ut=m[$e.id].idx;se+=b[q][ut]||0});var Se=se-K.sumTot*te,ne=_[U.id];if(Object.keys(ne).forEach(function($e){var ut=m[$e].node,pt=ut.clusterId;if(pt!==U.clusterId){var qt=y[pt],F=qt.nodes;if(!(!F||!F.length)){var Z=0;F.forEach(function(at){var Me=m[at.id].idx;Z+=b[q][Me]||0});var V=Z-qt.sumTot*te,Fe=V-Se;Fe>le&&(le=Fe,he=qt)}}}),le>0){he.nodes.push(U);var pe=U.clusterId;U.clusterId=he.id;var Ge=K.nodes.indexOf(U);K.nodes.splice(Ge,1);var ke=0,rt=0;p.forEach(function($e){var ut=$e.source,pt=$e.target,qt=m[ut].node.clusterId,F=m[pt].node.clusterId;(qt===he.id&&F!==he.id||F===he.id&&qt!==he.id)&&(ke=ke+($e[f]||1)),(qt===pe&&F!==pe||F===pe&&qt!==pe)&&(rt=rt+($e[f]||1))}),he.sumTot=ke,K.sumTot=rt}});var w={},T=0;Object.keys(y).forEach(function(U){var q=y[U];if(!q.nodes||!q.nodes.length){delete y[U];return}var K=String(T+1);K!==U&&(q.id=K,q.nodes=q.nodes.map(function(le){return{id:le.id,clusterId:K}}),y[K]=q,w[U]=K,delete y[U],T++)}),d.forEach(function(U){U.clusterId&&w[U.clusterId]&&(U.clusterId=w[U.clusterId])});var I=[],k={};p.forEach(function(U){var q=U.source,K=U.target,le=U[f]||1,he=m[q].node.clusterId,te=m[K].node.clusterId,se=he+"---"+te;if(k[se])k[se].weight+=le,k[se].count++;else{var ge={source:he,target:te,weight:le,count:1};k[se]=ge,I.push(ge)}});var O=[];return Object.keys(y).forEach(function(U){O.push(y[U])}),{clusters:O,clusterEdges:I}},o=a;e.default=o});Xr(XS);var HS=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=function(){function i(a){this.count=a.length,this.parent={};for(var o=0,s=a;o<s.length;o++){var u=s[o];this.parent[u]=u}}return i.prototype.find=function(a){for(;this.parent[a]!==a;)a=this.parent[a];return a},i.prototype.union=function(a,o){var s=this.find(a),u=this.find(o);s!==u&&(s<u?(this.parent[o]!==o&&this.union(this.parent[o],a),this.parent[o]=this.parent[a]):(this.parent[a]!==a&&this.union(this.parent[a],o),this.parent[a]=this.parent[o]))},i.prototype.connected=function(a,o){return this.find(a)===this.find(o)},i}(),n=t;e.default=n});Xr(HS);var YS=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=function(o,s){return o-s},n=function(){function a(o){o===void 0&&(o=t),this.compareFn=o,this.list=[]}return a.prototype.getLeft=function(o){return 2*o+1},a.prototype.getRight=function(o){return 2*o+2},a.prototype.getParent=function(o){return o===0?null:Math.floor((o-1)/2)},a.prototype.isEmpty=function(){return this.list.length<=0},a.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},a.prototype.delMin=function(){var o=this.top(),s=this.list.pop();return this.list.length>0&&(this.list[0]=s,this.moveDown(0)),o},a.prototype.insert=function(o){if(o!==null){this.list.push(o);var s=this.list.length-1;return this.moveUp(s),!0}return!1},a.prototype.moveUp=function(o){for(var s=this.getParent(o);o&&o>0&&this.compareFn(this.list[s],this.list[o])>0;){var u=this.list[s];this.list[s]=this.list[o],this.list[o]=u,o=s,s=this.getParent(o)}},a.prototype.moveDown=function(o){var s,u=o,l=this.getLeft(o),f=this.getRight(o),c=this.list.length;l!==null&&l<c&&this.compareFn(this.list[u],this.list[l])>0?u=l:f!==null&&f<c&&this.compareFn(this.list[u],this.list[f])>0&&(u=f),o!==u&&(s=[this.list[u],this.list[o]],this.list[o]=s[0],this.list[u]=s[1],this.moveDown(u))},a}(),i=n;e.default=i});Xr(YS);var qS=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=i(HS),n=i(YS);function i(l){return l&&l.__esModule?l:{default:l}}var a=function(f,c){var h=[],d=f.nodes,v=d===void 0?[]:d,p=f.edges,g=p===void 0?[]:p;if(v.length===0)return h;var y=v[0],m=new Set;m.add(y);var b=function(M,w){return c?M.weight-w.weight:0},x=new n.default(b);for((0,an.getEdgesByNodeId)(y.id,g).forEach(function(C){x.insert(C)});!x.isEmpty();){var _=x.delMin(),S=_.source,E=_.target;m.has(S)&&m.has(E)||(h.push(_),m.has(S)||(m.add(S),(0,an.getEdgesByNodeId)(S,g).forEach(function(C){x.insert(C)})),m.has(E)||(m.add(E),(0,an.getEdgesByNodeId)(E,g).forEach(function(C){x.insert(C)})))}return h},o=function(f,c){var h=[],d=f.nodes,v=d===void 0?[]:d,p=f.edges,g=p===void 0?[]:p;if(v.length===0)return h;var y=g.map(function(S){return S});c&&y.sort(function(S,E){return S.weight-E.weight});for(var m=new t.default(v.map(function(S){return S.id}));y.length>0;){var b=y.shift(),x=b.source,_=b.target;m.connected(x,_)||(h.push(b),m.union(x,_))}return h},s=function(f,c,h){var d={prim:a,kruskal:o};return h?d[h](f,c):o(f,c)},u=s;e.default=u});Xr(qS);var KS=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=n(yf);function n(o){return o&&o.__esModule?o:{default:o}}var i=function(s,u,l){typeof u!="number"&&(u=1e-6),typeof l!="number"&&(l=.85);for(var f=1,c=0,h=1e3,d=s.nodes,v=d===void 0?[]:d,p=s.edges,g=p===void 0?[]:p,y=v.length,m,b={},x={},_=0;_<y;++_){var S=v[_],E=S.id;b[E]=1/y,x[E]=1/y}for(var C=(0,t.default)(s);h>0&&f>u;){c=0;for(var _=0;_<y;++_){var S=v[_],E=S.id;if(m=0,C[S.id].inDegree===0)b[E]=0;else{for(var M=(0,an.getNeighbors)(E,g,"source"),w=0;w<M.length;++w){var T=M[w],I=C[T].outDegree;I>0&&(m+=x[T]/I)}b[E]=l*m,c+=b[E]}}c=(1-c)/y,f=0;for(var _=0;_<y;++_){var S=v[_],E=S.id;m=b[E]+c,f+=Math.abs(m-x[E]),x[E]=m}h-=1}return x},a=i;e.default=a});Xr(KS);var fn=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Graph=e.Node=e.Edge=e.AUTO_EDGE_ID=e.VACANT_GRAPH_ID=e.VACANT_NODE_LABEL=e.VACANT_EDGE_LABEL=e.VACANT_NODE_ID=e.VACANT_EDGE_ID=void 0;var t=-1;e.VACANT_EDGE_ID=t;var n=-1;e.VACANT_NODE_ID=n;var i="-1";e.VACANT_EDGE_LABEL=i;var a="-1";e.VACANT_NODE_LABEL=a;var o=-1;e.VACANT_GRAPH_ID=o;var s="-1";e.AUTO_EDGE_ID=s;var u=function(){function c(h,d,v,p){h===void 0&&(h=t),d===void 0&&(d=n),v===void 0&&(v=n),p===void 0&&(p=i),this.id=h,this.from=d,this.to=v,this.label=p}return c}();e.Edge=u;var l=function(){function c(h,d){h===void 0&&(h=n),d===void 0&&(d=a),this.id=h,this.label=d,this.edges=[],this.edgeMap={}}return c.prototype.addEdge=function(h){this.edges.push(h),this.edgeMap[h.id]=h},c}();e.Node=l;var f=function(){function c(h,d,v){h===void 0&&(h=n),d===void 0&&(d=!0),v===void 0&&(v=!1),this.id=h,this.edgeIdAutoIncrease=d,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=v}return c.prototype.getNodeNum=function(){return this.nodes.length},c.prototype.addNode=function(h,d){if(!this.nodeMap[h]){var v=new l(h,d);this.nodes.push(v),this.nodeMap[h]=v,this.nodeLabelMap[d]||(this.nodeLabelMap[d]=[]),this.nodeLabelMap[d].push(h)}},c.prototype.addEdge=function(h,d,v,p){if((this.edgeIdAutoIncrease||h===void 0)&&(h=this.counter++),!(this.nodeMap[d]&&this.nodeMap[v]&&this.nodeMap[v].edgeMap[h])){var g=new u(h,d,v,p);if(this.edges.push(g),this.edgeMap[h]=g,this.nodeMap[d].addEdge(g),this.edgeLabelMap[p]||(this.edgeLabelMap[p]=[]),this.edgeLabelMap[p].push(g),!this.directed){var y=new u(h,v,d,p);this.nodeMap[v].addEdge(y),this.edgeLabelMap[p].push(y)}}},c}();e.Graph=f});Xr(fn);fn.Graph;fn.Node;fn.Edge;fn.AUTO_EDGE_ID;fn.VACANT_GRAPH_ID;fn.VACANT_NODE_LABEL;fn.VACANT_EDGE_LABEL;fn.VACANT_NODE_ID;fn.VACANT_EDGE_ID;var ZS=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=function(){function c(h,d,v,p,g){this.fromNode=h,this.toNode=d,this.nodeEdgeNodeLabel={nodeLabel1:v||fn.VACANT_NODE_LABEL,edgeLabel:p||fn.VACANT_EDGE_LABEL,nodeLabel2:g||fn.VACANT_NODE_LABEL}}return c.prototype.equalTo=function(h){return this.fromNode===h.formNode&&this.toNode===h.toNode&&this.nodeEdgeNodeLabel===h.nodeEdgeNodeLabel},c.prototype.notEqualTo=function(h){return!this.equalTo(h)},c}(),n=function(){function c(){this.rmpath=[],this.dfsEdgeList=[]}return c.prototype.equalTo=function(h){var d=this.dfsEdgeList.length,v=h.length;if(d!==v)return!1;for(var p=0;p<d;p++)if(this.dfsEdgeList[p]!==h[p])return!1;return!0},c.prototype.notEqualTo=function(h){return!this.equalTo(h)},c.prototype.pushBack=function(h,d,v,p,g){return this.dfsEdgeList.push(new t(h,d,v,p,g)),this.dfsEdgeList},c.prototype.toGraph=function(h,d){h===void 0&&(h=fn.VACANT_GRAPH_ID),d===void 0&&(d=!1);var v=new fn.Graph(h,!0,d);return this.dfsEdgeList.forEach(function(p){var g=p.fromNode,y=p.toNode,m=p.nodeEdgeNodeLabel,b=m.nodeLabel1,x=m.edgeLabel,_=m.nodeLabel2;b!==fn.VACANT_NODE_LABEL&&v.addNode(g,b),_!==fn.VACANT_NODE_LABEL&&v.addNode(y,_),v.addEdge(void 0,g,y,x)}),v},c.prototype.buildRmpath=function(){this.rmpath=[];for(var h=void 0,d=this.dfsEdgeList.length,v=d-1;v>=0;v--){var p=this.dfsEdgeList[v],g=p.fromNode,y=p.toNode;g<y&&(h===void 0||y===h)&&(this.rmpath.push(v),h=g)}return this.rmpath},c.prototype.getNodeNum=function(){var h={};return this.dfsEdgeList.forEach(function(d){h[d.fromNode]||(h[d.fromNode]=!0),h[d.toNode]||(h[d.toNode]=!0)}),Object.keys(h).length},c}(),i=function(){function c(h){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],!!h){for(;h;){var d=h.edge;this.edges.push(d),this.nodesUsed[d.from]=1,this.nodesUsed[d.to]=1,this.edgesUsed[d.id]=1,h=h.preNode}this.edges=this.edges.reverse()}}return c.prototype.hasNode=function(h){return this.nodesUsed[h.id]===1},c.prototype.hasEdge=function(h){return this.edgesUsed[h.id]===1},c}(),a=function(){function c(h){var d=h.graphs,v=h.minSupport,p=v===void 0?2:v,g=h.minNodeNum,y=g===void 0?1:g,m=h.maxNodeNum,b=m===void 0?4:m,x=h.top,_=x===void 0?10:x,S=h.directed,E=S===void 0?!1:S,C=h.verbose,M=C===void 0?!1:C;this.graphs=d,this.dfsCode=new n,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=p,this.top=_,this.directed=E,this.counter=0,this.maxNodeNum=b,this.minNodeNum=y,this.verbose=M,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}return c.prototype.findForwardRootEdges=function(h,d){var v=this,p=[],g=h.nodeMap;return d.edges.forEach(function(y){(v.directed||d.label<=g[y.to].label)&&p.push(y)}),p},c.prototype.findBackwardEdge=function(h,d,v,p){if(!this.directed&&d===v)return null;for(var g=h.nodeMap,y=g[v.to],m=y.edges,b=m.length,x=0;x<b;x++){var _=m[x];if(!(p.hasEdge(_)||_.to!==d.from)){if(this.directed){if(g[d.from].label<g[v.to].label||g[d.from].label===g[v.to].label&&d.label<=_.label)return _}else if(d.label<_.label||d.label===_.label&&g[d.to].label<=g[v.to].label)return _}}return null},c.prototype.findForwardPureEdges=function(h,d,v,p){for(var g=[],y=d.to,m=h.nodeMap[y].edges,b=m.length,x=0;x<b;x++){var _=m[x],S=h.nodeMap[_.to];v<=S.label&&!p.hasNode(S)&&g.push(_)}return g},c.prototype.findForwardRmpathEdges=function(h,d,v,p){for(var g=[],y=h.nodeMap,m=y[d.to].label,b=y[d.from],x=b.edges,_=x.length,S=0;S<_;S++){var E=x[S],C=y[E.to].label;d.to===E.to||v>C||p.hasNode(y[E.to])||(d.label<E.label||d.label===E.label&&m<=C)&&g.push(E)}return g},c.prototype.getSupport=function(h){var d={};return h.forEach(function(v){d[v.graphId]||(d[v.graphId]=!0)}),Object.keys(d).length},c.prototype.findMinLabel=function(h){var d=void 0;return Object.keys(h).forEach(function(v){var p=h[v],g=p.nodeLabel1,y=p.edgeLabel,m=p.nodeLabel2;if(!d){d={nodeLabel1:g,edgeLabel:y,nodeLabel2:m};return}(g<d.nodeLabel1||g===d.nodeLabel1&&y<d.edgeLabel||g===d.nodeLabel1&&y===d.edgeLabel&&m<d.nodeLabel2)&&(d={nodeLabel1:g,edgeLabel:y,nodeLabel2:m})}),d},c.prototype.isMin=function(){var h=this,d=this.dfsCode;if(this.verbose&&console.log("isMin checking",d),d.dfsEdgeList.length===1)return!0;var v=this.directed,p=d.toGraph(fn.VACANT_GRAPH_ID,v),g=p.nodeMap,y=new n,m={};p.nodes.forEach(function(S){var E=h.findForwardRootEdges(p,S);E.forEach(function(C){var M=g[C.to],w=S.label+"-"+C.label+"-"+M.label;m[w]||(m[w]={projected:[],nodeLabel1:S.label,edgeLabel:C.label,nodeLabel2:M.label});var T={graphId:p.id,edge:C,preNode:null};m[w].projected.push(T)})});var b=this.findMinLabel(m);y.dfsEdgeList.push(new t(0,1,b.nodeLabel1,b.edgeLabel,b.nodeLabel2));var x=function S(E){for(var C=y.buildRmpath(),M=y.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,w=y.dfsEdgeList[C[0]].toNode,T={},I=!1,k=0,O=v?-1:0,U=function(rt){if(I)return"break";E.forEach(function($e){var ut=new i($e),pt=h.findBackwardEdge(p,ut.edges[C[rt]],ut.edges[C[0]],ut);pt&&(T[pt.label]||(T[pt.label]={projected:[],edgeLabel:pt.label}),T[pt.label].projected.push({graphId:p.id,edge:T,preNode:$e}),k=y.dfsEdgeList[C[rt]].fromNode,I=!0)})},q=C.length-1;q>O;q--){var K=U(q);if(K==="break")break}if(I){var le=h.findMinLabel(T);y.dfsEdgeList.push(new t(w,k,fn.VACANT_NODE_LABEL,le.edgeLabel,fn.VACANT_NODE_LABEL));var he=y.dfsEdgeList.length-1;return h.dfsCode.dfsEdgeList[he]!==y.dfsEdgeList[he]?!1:S(T[le.edgeLabel].projected)}var te={};I=!1;var se=0;E.forEach(function(ke){var rt=new i(ke),$e=h.findForwardPureEdges(p,rt.edges[C[0]],M,rt);$e.length>0&&(I=!0,se=w,$e.forEach(function(ut){var pt=ut.label+"-"+g[ut.to].label;te[pt]||(te[pt]={projected:[],edgeLabel:ut.label,nodeLabel2:g[ut.to].label}),te[pt].projected.push({graphId:p.id,edge:ut,preNode:ke})}))});for(var ge=C.length,Se=function(rt){if(I)return"break";var $e=C[rt];E.forEach(function(ut){var pt=new i(ut),qt=h.findForwardRmpathEdges(p,pt.edges[$e],M,pt);qt.length>0&&(I=!0,se=y.dfsEdgeList[$e].fromNode,qt.forEach(function(F){var Z=F.label+"-"+g[F.to].label;te[Z]||(te[Z]={projected:[],edgeLabel:F.label,nodeLabel2:g[F.to].label}),te[Z].projected.push({graphId:p.id,edge:F,preNode:ut})}))})},q=0;q<ge;q++){var ne=Se(q);if(ne==="break")break}if(!I)return!0;var pe=h.findMinLabel(te);y.dfsEdgeList.push(new t(se,w+1,fn.VACANT_NODE_LABEL,pe.edgeLabel,pe.nodeLabel2));var Ge=y.dfsEdgeList.length-1;return d.dfsEdgeList[Ge]!==y.dfsEdgeList[Ge]?!1:S(te[pe.edgeLabel+"-"+pe.nodeLabel2].projected)},_=b.nodeLabel1+"-"+b.edgeLabel+"-"+b.nodeLabel2;return x(m[_].projected)},c.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var h=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push((0,sg.clone)(h))}},c.prototype.subGraphMining=function(h){var d=this,v=this.getSupport(h);if(!(v<this.minSupport)&&!!this.isMin()){this.report();var p=this.dfsCode.getNodeNum(),g=this.dfsCode.buildRmpath(),y=this.dfsCode.dfsEdgeList[g[0]].toNode,m=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,b={},x={};h.forEach(function(_){for(var S=d.graphs[_.graphId],E=S.nodeMap,C=new i(_),M=g.length-1;M>=0;M--){var w=d.findBackwardEdge(S,C.edges[g[M]],C.edges[g[0]],C);if(w){var T=d.dfsCode.dfsEdgeList[g[M]].fromNode+"-"+w.label;x[T]||(x[T]={projected:[],toNodeId:d.dfsCode.dfsEdgeList[g[M]].fromNode,edgeLabel:w.label}),x[T].projected.push({graphId:_.graphId,edge:w,preNode:_})}}if(!(p>=d.maxNodeNum)){var I=d.findForwardPureEdges(S,C.edges[g[0]],m,C);I.forEach(function(O){var U=y+"-"+O.label+"-"+E[O.to].label;b[U]||(b[U]={projected:[],fromNodeId:y,edgeLabel:O.label,nodeLabel2:E[O.to].label}),b[U].projected.push({graphId:_.graphId,edge:O,preNode:_})});for(var k=function(U){var q=d.findForwardRmpathEdges(S,C.edges[g[U]],m,C);q.forEach(function(K){var le=d.dfsCode.dfsEdgeList[g[U]].fromNode+"-"+K.label+"-"+E[K.to].label;b[le]||(b[le]={projected:[],fromNodeId:d.dfsCode.dfsEdgeList[g[U]].fromNode,edgeLabel:K.label,nodeLabel2:E[K.to].label}),b[le].projected.push({graphId:_.graphId,edge:K,preNode:_})})},M=0;M<g.length;M++)k(M)}}),Object.keys(x).forEach(function(_){var S=x[_],E=S.toNodeId,C=S.edgeLabel;d.dfsCode.dfsEdgeList.push(new t(y,E,"-1",C,"-1")),d.subGraphMining(x[_].projected),d.dfsCode.dfsEdgeList.pop()}),Object.keys(b).forEach(function(_){var S=b[_],E=S.fromNodeId,C=S.edgeLabel,M=S.nodeLabel2;d.dfsCode.dfsEdgeList.push(new t(E,y+1,fn.VACANT_NODE_LABEL,C,M)),d.subGraphMining(b[_].projected),d.dfsCode.dfsEdgeList.pop()})}},c.prototype.generate1EdgeFrequentSubGraphs=function(){var h=this.graphs,d=this.directed,v=this.minSupport,p=this.frequentSize1Subgraphs,g={},y={},m={},b={};return Object.keys(h).forEach(function(x){var _=h[x],S=_.nodeMap;_.nodes.forEach(function(E,C){var M=E.label,w=x+"-"+M;if(!m[w]){var T=g[M]||0;T++,g[M]=T}m[w]={graphKey:x,label:M},E.edges.forEach(function(I){var k=M,O=S[I.to].label;if(!d&&k>O){var U=O;O=k,k=U}var q=I.label,K=x+"-"+k+"-"+q+"-"+O,le=k+"-"+q+"-"+O;if(!y[le]){var he=y[le]||0;he++,y[le]=he}b[K]={graphId:x,nodeLabel1:k,edgeLabel:q,nodeLabel2:O}})})}),Object.keys(g).forEach(function(x){var _=g[x];if(!(_<v)){var S={nodes:[],edges:[]};S.nodes.push({id:"0",label:x}),p.push(S)}}),p},c.prototype.run=function(){var h=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var d=this.graphs;this.directed;var v={};Object.keys(d).forEach(function(p){var g=d[p],y=g.nodeMap;g.nodes.forEach(function(m){var b=h.findForwardRootEdges(g,m);b.forEach(function(x){var _=y[x.to],S=m.label+"-"+x.label+"-"+_.label;v[S]||(v[S]={projected:[],nodeLabel1:m.label,edgeLabel:x.label,nodeLabel2:_.label});var E={graphId:p,edge:x,preNode:null};v[S].projected.push(E)})})}),Object.keys(v).forEach(function(p){var g=v[p],y=g.projected,m=g.nodeLabel1,b=g.edgeLabel,x=g.nodeLabel2;h.dfsCode.dfsEdgeList.push(new t(0,1,m,b,x)),h.subGraphMining(y),h.dfsCode.dfsEdgeList.pop()})}},c}(),o=function(h,d,v,p){var g={};return Object.keys(h).forEach(function(y,m){var b=h[y],x=new fn.Graph(m,!0,d),_={};b.nodes.forEach(function(S,E){x.addNode(E,S[v]),_[S.id]=E}),b.edges.forEach(function(S,E){var C=_[S.source],M=_[S.target];x.addEdge(-1,C,M,S[p])}),x&&x.getNodeNum()&&(g[x.id]=x)}),g},s=function(h,d,v){var p=[];return h.forEach(function(g){var y={nodes:[],edges:[]};g.nodes.forEach(function(m){var b;y.nodes.push((b={id:""+m.id},b[d]=m.label,b))}),g.edges.forEach(function(m){var b;y.edges.push((b={source:""+m.from,target:""+m.to},b[v]=m.label,b))}),p.push(y)}),p},u="cluster",l=function(h){var d=h.graphs,v=h.directed,p=v===void 0?!1:v,g=h.nodeLabelProp,y=g===void 0?u:g,m=h.edgeLabelProp,b=m===void 0?u:m,x=o(d,p,y,b),_=h.minSupport,S=h.maxNodeNum,E=h.minNodeNum,C=h.verbose,M=h.top,w={graphs:x,minSupport:_,maxNodeNum:S,minNodeNum:E,top:M,verbose:C,directed:p},T=new a(w);T.run();var I=s(T.frequentSubgraphs,y,b);return I},f=l;e.default=f});Xr(ZS);var QS=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=a(Ty),n=a(ZS),i=a(sd);function a(b){return b&&b.__esModule?b:{default:b}}var o=function(x,_,S,E){S===void 0&&(S="cluster"),E===void 0&&(E=2);var C=[],M=x.nodes;return _.forEach(function(w,T){C.push(s(M,w,T,S,E))}),C},s=function(x,_,S,E,C){var M=[S],w=[],T={};return _.forEach(function(I,k){if(I<=C&&S!==k){M.push(k),w.push(x[k]);var O=x[k][E];T[O]?(T[O].count++,T[O].dists.push(I)):T[O]={count:1,dists:[I]}}}),Object.keys(T).forEach(function(I){T[I].dists=T[I].dists.sort(function(k,O){return k-O})}),{nodeIdx:S,nodeId:x[S].id,nodeIdxs:M,neighbors:w,neighborNum:M.length-1,nodeLabelCountMap:T}},u=function(x,_,S,E,C){var M=Math.ceil(S/_),w={},T=0;return E.forEach(function(I,k){for(var O=0,U=0,q=I.nodeIdxs,K=I.neighborNum-1;O<M;){for(var le=q[1+Math.floor(Math.random()*K)],he=0;(w[k+"-"+le]||w[le+"-"+k])&&(le=Math.floor(Math.random()*_),he++,!(he>2*_)););if(he<2*_&&(w[k+"-"+le]={start:k,end:le,distance:C[k][le]},O++,T++,T>=S))return w;if(U++,U>2*_)break}if(O<M){var te=M-O;M=(M+te)/(_-k-1)}}),w},l=function(x,_,S,E){var C=S.nodes;return E||(E={}),Object.keys(x).forEach(function(M){var w,T;if(!(E&&E[M])){E[M]={nodes:[],edges:[]};var I=x[M],k=(w=_[I.start])===null||w===void 0?void 0:w.nodeIdxs,O=(T=_[I.end])===null||T===void 0?void 0:T.nodeIdxs;if(!(!k||!O)){var U=new Set(O),q=k.filter(function(se){return U.has(se)});if(!(!q||!q.length)){for(var K={},le=q.length,he=0;he<le;he++){var te=C[q[he]];E[M].nodes.push(te),K[te.id]=!0}S.edges.forEach(function(se){K[se.source]&&K[se.target]&&E[M].edges.push(se)})}}}}),E},f=function(x,_,S,E){var C={};x.nodes.forEach(function(w){C[w.id]=w});var M=0;return x.edges.forEach(function(w){var T=C[w.source][S],I=C[w.target][S],k=_==null?void 0:_.nodes[0][S],O=_==null?void 0:_.nodes[1][S],U=_==null?void 0:_.edges[0][E];w[E]===U&&(T===k&&I===O||T===O&&I===k)&&M++}),M},c=function(x,_,S){for(var E=1/0,C=0,M=function(I){var k=x[I],O=Object.keys(k).sort(function(se,ge){return k[se]-k[ge]}),U=10,q=[];O.forEach(function(se,ge){q[ge%U]||(q[ge%U]={graphs:[],totalCount:0,aveCount:0}),q[ge%U].graphs.push(se),q[ge%U].totalCount+=k[se]});var K=0,le=[];q.forEach(function(se){var ge=se.totalCount/se.graphs.length;se.aveCount=ge,le.push(ge);var Se=0,ne=se.length;se.graphs.forEach(function(pe,Ge){var ke=k[pe];se.graphs.forEach(function(rt,$e){Ge!==$e&&(Se+=Math.abs(ke-k[rt]))})}),Se/=ne*(ne-1)/2,K+=Se}),K/=q.length;var he=0;le.forEach(function(se,ge){le.forEach(function(Se,ne){ge!==ne&&(he+=Math.abs(se-Se))}),he/=le.length*(le.length-1)/2});var te=he-K;E<te&&(E=te,C=I)},w=0;w<_;w++)M(w);return{structure:S[C],structureCountMap:x[C]}},h=function(x,_){var S={},E={};return x.forEach(function(C,M){S[C.id]={idx:M,node:C,degree:0,inDegree:0,outDegree:0};var w=C[_];E[w]||(E[w]=[]),E[w].push(C)}),{nodeMap:S,nodeLabelMap:E}},d=function(x,_,S){var E={},C={};return x.forEach(function(M,w){E[""+an.uniqueId]={idx:w,edge:M};var T=M[_];C[T]||(C[T]=[]),C[T].push(M);var I=S[M.source];I&&(I.degree++,I.outDegree++);var k=S[M.target];k&&(k.degree++,k.inDegree++)}),{edgeMap:E,edgeLabelMap:C}},v=function(x,_,S){var E=_.length,C={};return _.forEach(function(M,w){for(var T=S?0:w+1,I=x[w].id,k=T;k<E;k++)if(w!==k){var O=x[k].id,U=M[k];C[I+"-"+O]=U,S||(C[O+"-"+I]=U)}}),C},p=function(x,_,S,E,C,M,w,T,I,k,O){var U,q=_.id+"-"+S.id;if(k&&k[q])return k[q];var K=O?O[q]:void 0;if(!K){var le=(U={},U[q]={start:E[_.id].idx,end:E[S.id].idx,distance:C},U);O=l(le,M,x,O),K=O[q]}return f(K,w,T,I)},g=function(x,_,S,E){var C,M,w,T=(C=x[_])===null||C===void 0?void 0:C.degree,I=(M=x[_])===null||M===void 0?void 0:M.inDegree,k=(w=x[_])===null||w===void 0?void 0:w.outDegree;return x[_]===void 0&&(T=1/0,I=1/0,k=1/0,E[_].forEach(function(O){var U=S[O.id].degree;T>U&&(T=U);var q=S[O.id].inDegree;I>q&&(I=q);var K=S[O.id].outDegree;k>K&&(k=K)}),x[_]={degree:T,inDegree:I,outDegree:k}),{minPatternNodeLabelDegree:T,minPatternNodeLabelInDegree:I,minPatternNodeLabelOutDegree:k}},y=function(x,_,S,E,C,M,w){if(S===void 0&&(S=!1),M===void 0&&(M="cluster"),w===void 0&&(w="cluster"),!(!x||!x.nodes)){var T=x.nodes.length;if(!!T){var I=(0,t.default)(x,S),k=(0,t.default)(_,S),O=v(x.nodes,I,S),U=v(_.nodes,k,S),q=h(x.nodes,M),K=q.nodeMap,le=q.nodeLabelMap,he=h(_.nodes,M),te=he.nodeMap,se=he.nodeLabelMap;d(x.edges,w,K);var ge=d(_.edges,w,te).edgeLabelMap;C||(C=Math.max.apply(Math,(0,sh.__spreadArray)((0,sh.__spreadArray)([],k[0]),[2]))),E||(E=C);var Se=o(x,I,M,E),ne=o(_,k,M,E),pe=Math.min(100,T*(T-1)/2),Ge=u(E,T,pe,ne,I),ke=l(Ge,Se,x),rt=10,$e=1,ut=1,pt=4,qt={graphs:ke,nodeLabelProp:M,edgeLabelProp:w,minSupport:$e,minNodeNum:ut,maxNodeNum:pt,directed:S},F=(0,n.default)(qt).slice(0,rt),Z=F.length,V=[];F.forEach(function(jt,Sr){V[Sr]={},Object.keys(ke).forEach(function(Ir){var or=ke[Ir],$r=f(or,jt,M,w);V[Sr][Ir]=$r})});var Fe=c(V,Z,F),at=Fe.structure,Me=Fe.structureCountMap,ct=_.nodes[0],Ye=ct[M],nt=le[Ye],Et={},D={},ee={},be={},we={},Oe={};Object.keys(se).forEach(function(jt,Sr){we[jt]=[],S&&(Oe[jt]=[]);var Ir=se[jt],or={};Ir.forEach(function(fr){var Er=U[ct.id+"-"+fr.id];if(Er&&we[jt].push(Er),or[ct.id+"-"+fr.id]={start:0,end:te[fr.id].idx,distance:Er},S){var ur=U[fr.id+"-"+ct.id];ur&&Oe[jt].push(ur)}}),we[jt]=we[jt].sort(function(fr,Er){return fr-Er}),S&&(Oe[jt]=Oe[jt].sort(function(fr,Er){return fr-Er})),D=l(or,ne,_,D);var $r=[];if(Object.keys(or).forEach(function(fr){if(ee[fr]){$r.push(ee[fr]);return}var Er=D[fr];ee[fr]=f(Er,at,M,w),$r.push(ee[fr])}),$r=$r.sort(function(fr,Er){return Er-fr}),be[ct.id+"-"+jt]=$r,jt!==Ye)for(var Vt=nt.length,kr=function(Er){var ur=nt[Er],bn=Se[K[ur.id].idx],On=bn.nodeLabelCountMap[jt],Vr=se[jt].length;if(!On||On.count<Vr)return nt.splice(Er,1),"continue";for(var Rn=!1,Cn=0;Cn<Vr;Cn++)if(On.dists[Cn]>we[jt][Cn]){Rn=!0;break}if(Rn)return nt.splice(Er,1),"continue";var cr={};bn.neighbors.forEach(function(Or){var An=O[ur.id+"-"+Or.id];cr[ur.id+"-"+Or.id]={start:K[ur.id].idx,end:K[Or.id].idx,distance:An}}),ke=l(cr,Se,x,ke);var Rr=[];Object.keys(cr).forEach(function(Or){if(Me[Or]){Rr.push(Me[Or]);return}var An=ke[Or];Me[Or]=f(An,at,M,w),Rr.push(Me[Or])}),Rr=Rr.sort(function(Or,An){return An-Or});for(var Ur=!1,Cn=0;Cn<Vr;Cn++)if(Rr[Cn]<$r[Cn]){Ur=!0;break}if(Ur)return nt.splice(Er,1),"continue"},Mr=Vt-1;Mr>=0;Mr--)kr(Mr)});var qe=[];nt.forEach(function(jt){for(var Sr=K[jt.id].idx,Ir=s(x.nodes,I[Sr],Sr,M,C),or=Ir.neighbors,$r=or.length,Vt=!1,kr=$r-1;kr>=0;kr--){if(or.length+1<_.nodes.length){Vt=!0;return}var Mr=or[kr],fr=Mr[M];if(!se[fr]||!se[fr].length){or.splice(kr,1);continue}if(!we[fr]||!we[fr].length){or.splice(kr,1);continue}var Er=jt.id+"-"+Mr.id,ur=O[Er],bn=we[fr].length-1,On=we[fr][bn];if(ur>On){or.splice(kr,1);continue}if(S){var Vr=Mr.id+"-"+jt.id,Rn=O[Vr];bn=Oe[fr].length-1;var Cn=Oe[fr][bn];if(Rn>Cn){or.splice(kr,1);continue}}var cr=Me[Er]?Me[Er]:p(x,jt,Mr,K,ur,Se,at,M,w,Me,ke),Rr=ct.id+"-"+fr,Ur=be[Rr][be[Rr].length-1];if(cr<Ur){or.splice(kr,1);continue}var Or=g(Et,fr,te,se),An=Or.minPatternNodeLabelDegree;if(Or.minPatternNodeLabelInDegree,Or.minPatternNodeLabelOutDegree,K[Mr.id].degree<An){or.splice(kr,1);continue}}Vt||qe.push({nodes:[jt].concat(or)})});var Jt=(0,i.default)(_,ct.id,!1).length,gt={};S?(Object.keys(Jt).forEach(function(jt){var Sr=te[jt].node[M];gt[Sr]?gt[Sr].push(Jt[jt]):gt[Sr]=[Jt[jt]]}),Object.keys(gt).forEach(function(jt){gt[jt].sort(function(Sr,Ir){return Sr-Ir})})):gt=we;for(var Ct=qe.length,kt=function(Sr){var Ir=qe[Sr],or=Ir.nodes[0],$r={},Vt={};Ir.nodes.forEach(function(Wr,ui){Vt[Wr.id]={idx:ui,node:Wr,degree:0,inDegree:0,outDegree:0};var xn=Wr[M];$r[xn]?$r[xn]++:$r[xn]=1});var kr=[],Mr={};x.edges.forEach(function(Wr){Vt[Wr.source]&&Vt[Wr.target]&&(kr.push(Wr),Mr[Wr[w]]?Mr[Wr[w]]++:Mr[Wr[w]]=1,Vt[Wr.source].degree++,Vt[Wr.target].degree++,Vt[Wr.source].outDegree++,Vt[Wr.target].inDegree++)});for(var fr=Object.keys(ge).length,Er=!1,ur=0;ur<fr;ur++){var bn=Object.keys(ge)[ur];if(!Mr[bn]||Mr[bn]<ge[bn].length){Er=!0;break}}if(Er)return qe.splice(Sr,1),"continue";var On=kr.length;if(On<_.edges.length)return qe.splice(Sr,1),"break";for(var Vr=!1,Rn=function(ui){var xn=kr[ui],Ni=xn[w],Fa=ge[Ni];if(!Fa||!Fa.length)return Mr[Ni]--,Fa&&Mr[Ni]<Fa.length?(Vr=!0,"break"):(kr.splice(ui,1),Vt[xn.source].degree--,Vt[xn.target].degree--,Vt[xn.source].outDegree--,Vt[xn.target].inDegree--,"continue");var Cc=Vt[xn.source].node[M],Ac=Vt[xn.target].node[M],gl=!1;if(Fa.forEach(function(Tc){var Mc=te[Tc.source].node,Ic=te[Tc.target].node;Mc[M]===Cc&&Ic[M]===Ac&&(gl=!0),!S&&Mc[M]===Ac&&Ic[M]===Cc&&(gl=!0)}),!gl)return Mr[Ni]--,Fa&&Mr[Ni]<Fa.length?(Vr=!0,"break"):(kr.splice(ui,1),Vt[xn.source].degree--,Vt[xn.target].degree--,Vt[xn.source].outDegree--,Vt[xn.target].inDegree--,"continue")},ur=On-1;ur>=0;ur--){var Cn=Rn(ur);if(Cn==="break")break}if(Vr)return qe.splice(Sr,1),"continue";Ir.edges=kr;var cr=(0,i.default)(Ir,Ir.nodes[0].id,!1).length;if(Object.keys(cr).reverse().forEach(function(Wr){if(!(Wr===Ir.nodes[0].id||Vr)){if(cr[Wr]===1/0){var ui=Vt[Wr].node[M];if($r[ui]--,$r[ui]<se[ui].length){Vr=!0;return}var xn=Ir.nodes.indexOf(Vt[Wr].node);Ir.nodes.splice(xn,1),Vt[Wr]=void 0;return}var Ni=K[Wr].node[M];if(!gt[Ni]||!gt[Ni].length||cr[Wr]>gt[Ni][gt[Ni].length-1]){var ui=Vt[Wr].node[M];if($r[ui]--,$r[ui]<se[ui].length){Vr=!0;return}var xn=Ir.nodes.indexOf(Vt[Wr].node);Ir.nodes.splice(xn,1),Vt[Wr]=void 0}}}),Vr)return qe.splice(Sr,1),"continue";for(var Rr=!0,Ur=0;Rr&&!Vr;){Rr=!1;var Or=S?Vt[or.id].degree<te[ct.id].degree||Vt[or.id].inDegree<te[ct.id].inDegree||Vt[or.id].outDegree<te[ct.id].outDegree:Vt[or.id].degree<te[ct.id].degree;if(Or){Vr=!0;break}if($r[or[M]]<se[or[M]].length){Vr=!0;break}for(var An=Ir.nodes.length,Br=An-1;Br>=0;Br--){var Ei=Ir.nodes[Br],fo=Vt[Ei.id].degree,Js=Vt[Ei.id].inDegree,eu=Vt[Ei.id].outDegree,tu=Ei[M],pl=g(Et,tu,te,se),Ec=pl.minPatternNodeLabelDegree,Xv=pl.minPatternNodeLabelInDegree,Hv=pl.minPatternNodeLabelOutDegree,Yv=S?fo<Ec||Js<Xv||eu<Hv:fo<Ec;if(Yv){if($r[Ei[M]]--,$r[Ei[M]]<se[Ei[M]].length){Vr=!0;break}Ir.nodes.splice(Br,1),Vt[Ei.id]=void 0,Rr=!0}}if(Vr||!Rr&&Ur!==0)break;On=kr.length;for(var ru=On-1;ru>=0;ru--){var Yi=kr[ru];if(!Vt[Yi.source]||!Vt[Yi.target]){kr.splice(ru,1);var nu=Yi[w];if(Mr[nu]--,Vt[Yi.source]&&(Vt[Yi.source].degree--,Vt[Yi.source].outDegree--),Vt[Yi.target]&&(Vt[Yi.target].degree--,Vt[Yi.target].inDegree--),ge[nu]&&Mr[nu]<ge[nu].length){Vr=!0;break}Rr=!0}}Ur++}if(Vr||Vr||Ir.nodes.length<_.nodes.length||kr.length<_.edges.length)return qe.splice(Sr,1),"continue"},Gt=Ct-1;Gt>=0;Gt--){var Zt=kt(Gt);if(Zt==="break")break}for(var ar=qe.length,ei=function(Sr){var Ir=qe[Sr],or={};Ir.edges.forEach(function(kr){var Mr=kr.source+"-"+kr.target+"-"+kr.label;or[Mr]?or[Mr]++:or[Mr]=1});for(var $r=function(Mr){var fr=qe[Mr],Er={};fr.edges.forEach(function(bn){var On=bn.source+"-"+bn.target+"-"+bn.label;Er[On]?Er[On]++:Er[On]=1});var ur=!0;Object.keys(Er).length!==Object.keys(or).length?ur=!1:Object.keys(or).forEach(function(bn){Er[bn]!==or[bn]&&(ur=!1)}),ur&&qe.splice(Mr,1)},Vt=ar-1;Vt>Sr;Vt--)$r(Vt);ar=qe.length},Gt=0;Gt<=ar-1;Gt++)ei(Gt);return qe}}},m=y;e.default=m});Xr(QS);var JS=xr(function(r,e){function t(b){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t=function(_){return typeof _}:t=function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},t(b)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"getAdjMatrix",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"breadthFirstSearch",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"connectedComponent",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"getDegree",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"getInDegree",{enumerable:!0,get:function(){return o.getInDegree}}),Object.defineProperty(e,"getOutDegree",{enumerable:!0,get:function(){return o.getOutDegree}}),Object.defineProperty(e,"detectCycle",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"depthFirstSearch",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"dijkstra",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"findAllPath",{enumerable:!0,get:function(){return bf.findAllPath}}),Object.defineProperty(e,"findShortestPath",{enumerable:!0,get:function(){return bf.findShortestPath}}),Object.defineProperty(e,"floydWarshall",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(e,"labelPropagation",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"louvain",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(e,"minimumSpanningTree",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(e,"pageRank",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(e,"GADDI",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(e,"getNeighbors",{enumerable:!0,get:function(){return an.getNeighbors}});var n=m(pf),i=m(WS),a=m(gf),o=y(yf),s=m(mf),u=m(Ay),l=m(sd),f=m(Ty),c=m(jS),h=m(XS),d=m(qS),v=m(KS),p=m(QS);function g(b){if(typeof WeakMap!="function")return null;var x=new WeakMap,_=new WeakMap;return(g=function(E){return E?_:x})(b)}function y(b,x){if(!x&&b&&b.__esModule)return b;if(b===null||t(b)!=="object"&&typeof b!="function")return{default:b};var _=g(x);if(_&&_.has(b))return _.get(b);var S={},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var C in b)if(C!=="default"&&Object.prototype.hasOwnProperty.call(b,C)){var M=E?Object.getOwnPropertyDescriptor(b,C):null;M&&(M.get||M.set)?Object.defineProperty(S,C,M):S[C]=b[C]}return S.default=b,_&&_.set(b,S),S}function m(b){return b&&b.__esModule?b:{default:b}}});Xr(JS);var eE=xr(function(r,e){function t(u){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t=function(f){return typeof f}:t=function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},t(u)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(JS);function i(u){if(typeof WeakMap!="function")return null;var l=new WeakMap,f=new WeakMap;return(i=function(h){return h?f:l})(u)}function a(u,l){if(!l&&u&&u.__esModule)return u;if(u===null||t(u)!=="object"&&typeof u!="function")return{default:u};var f=i(l);if(f&&f.has(u))return f.get(u);var c={},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in u)if(d!=="default"&&Object.prototype.hasOwnProperty.call(u,d)){var v=h?Object.getOwnPropertyDescriptor(u,d):null;v&&(v.get||v.set)?Object.defineProperty(c,d,v):c[d]=u[d]}return c.default=u,f&&f.set(u,c),c}var o=typeof self!="undefined"?self:{};o.onmessage=function(u){var l=u.data,f=l._algorithmType,c=l.data;if(!!f){if(typeof n[f]=="function"){var h=n[f].apply(n,c);o.postMessage({_algorithmType:Zr.MESSAGE.SUCCESS,data:h});return}o.postMessage({_algorithmType:Zr.MESSAGE.FAILURE})}};var s=null;e.default=s});Xr(eE);var tE=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=n(eE);function n(o){return o&&o.__esModule?o:{default:o}}var i=function(s){return function(){for(var u=[],l=0;l<arguments.length;l++)u[l]=arguments[l];return new Promise(function(f,c){var h=new t.default;h.postMessage({_algorithmType:s,data:u}),h.onmessage=function(d){var v=d.data,p=v.data,g=v._algorithmType;Zr.MESSAGE.SUCCESS===g?f(p):c(),h.terminate()}})}},a=i;e.default=a});Xr(tE);var Rt=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.GADDIAsync=e.getNeighborsAsync=e.pageRankAsync=e.minimumSpanningTreeAsync=e.louvainAsync=e.labelPropagationAsync=e.floydWarshallAsync=e.findShortestPathAsync=e.findAllPathAsync=e.dijkstraAsync=e.detectAllUndirectedCycleAsync=e.detectAllDirectedCycleAsync=e.detectAllCyclesAsync=e.detectCycleAsync=e.getOutDegreeAsync=e.getInDegreeAsync=e.getDegreeAsync=e.connectedComponentAsync=e.getAdjMatrixAsync=void 0;var t=n(tE);function n(E){return E&&E.__esModule?E:{default:E}}var i=function(C,M){return(0,t.default)(Zr.ALGORITHM.getAdjMatrix).apply(void 0,[C,M])};e.getAdjMatrixAsync=i;var a=function(C,M){return(0,t.default)(Zr.ALGORITHM.connectedComponent).apply(void 0,[C,M])};e.connectedComponentAsync=a;var o=function(C){return(0,t.default)(Zr.ALGORITHM.getDegree)(C)};e.getDegreeAsync=o;var s=function(C,M){return(0,t.default)(Zr.ALGORITHM.getInDegree)(C,M)};e.getInDegreeAsync=s;var u=function(C,M){return(0,t.default)(Zr.ALGORITHM.getOutDegree)(C,M)};e.getOutDegreeAsync=u;var l=function(C){return(0,t.default)(Zr.ALGORITHM.detectCycle)(C)};e.detectCycleAsync=l;var f=function(C){return(0,t.default)(Zr.ALGORITHM.detectAllCycles)(C)};e.detectAllCyclesAsync=f;var c=function(C){return(0,t.default)(Zr.ALGORITHM.detectAllDirectedCycle)(C)};e.detectAllDirectedCycleAsync=c;var h=function(C){return(0,t.default)(Zr.ALGORITHM.detectAllUndirectedCycle)(C)};e.detectAllUndirectedCycleAsync=h;var d=function(C,M,w,T){return(0,t.default)(Zr.ALGORITHM.dijkstra).apply(void 0,[C,M,w,T])};e.dijkstraAsync=d;var v=function(C,M,w,T){return(0,t.default)(Zr.ALGORITHM.findAllPath).apply(void 0,[C,M,w,T])};e.findAllPathAsync=v;var p=function(C,M,w,T,I){return(0,t.default)(Zr.ALGORITHM.findShortestPath).apply(void 0,[C,M,w,T,I])};e.findShortestPathAsync=p;var g=function(C,M){return(0,t.default)(Zr.ALGORITHM.floydWarshall).apply(void 0,[C,M])};e.floydWarshallAsync=g;var y=function(C,M,w,T){return T===void 0&&(T=1e3),(0,t.default)(Zr.ALGORITHM.labelPropagation)(C,M,w,T)};e.labelPropagationAsync=y;var m=function(C,M,w,T){return(0,t.default)(Zr.ALGORITHM.louvain)(C,M,w,T)};e.louvainAsync=m;var b=function(C,M,w){return(0,t.default)(Zr.ALGORITHM.minimumSpanningTree).apply(void 0,[C,M,w])};e.minimumSpanningTreeAsync=b;var x=function(C,M,w){return(0,t.default)(Zr.ALGORITHM.pageRank).apply(void 0,[C,M,w])};e.pageRankAsync=x;var _=function(C,M,w){return(0,t.default)(Zr.ALGORITHM.getNeighbors).apply(void 0,[C,M,w])};e.getNeighborsAsync=_;var S=function(C,M,w,T,I,k,O){return w===void 0&&(w=!1),k===void 0&&(k="cluster"),O===void 0&&(O="cluster"),(0,t.default)(Zr.ALGORITHM.GADDI).apply(void 0,[C,M,w,T,I,k,O])};e.GADDIAsync=S});Xr(Rt);Rt.GADDIAsync;Rt.getNeighborsAsync;Rt.pageRankAsync;Rt.minimumSpanningTreeAsync;Rt.louvainAsync;Rt.labelPropagationAsync;Rt.floydWarshallAsync;Rt.findShortestPathAsync;Rt.findAllPathAsync;Rt.dijkstraAsync;Rt.detectAllUndirectedCycleAsync;Rt.detectAllDirectedCycleAsync;Rt.detectAllCyclesAsync;Rt.detectCycleAsync;Rt.getOutDegreeAsync;Rt.getInDegreeAsync;Rt.getDegreeAsync;Rt.connectedComponentAsync;Rt.getAdjMatrixAsync;var My=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"getAdjMatrixAsync",{enumerable:!0,get:function(){return Rt.getAdjMatrixAsync}}),Object.defineProperty(e,"connectedComponentAsync",{enumerable:!0,get:function(){return Rt.connectedComponentAsync}}),Object.defineProperty(e,"getDegreeAsync",{enumerable:!0,get:function(){return Rt.getDegreeAsync}}),Object.defineProperty(e,"getInDegreeAsync",{enumerable:!0,get:function(){return Rt.getInDegreeAsync}}),Object.defineProperty(e,"getOutDegreeAsync",{enumerable:!0,get:function(){return Rt.getOutDegreeAsync}}),Object.defineProperty(e,"detectCycleAsync",{enumerable:!0,get:function(){return Rt.detectCycleAsync}}),Object.defineProperty(e,"detectAllCyclesAsync",{enumerable:!0,get:function(){return Rt.detectAllCyclesAsync}}),Object.defineProperty(e,"detectAllDirectedCycleAsync",{enumerable:!0,get:function(){return Rt.detectAllDirectedCycleAsync}}),Object.defineProperty(e,"detectAllUndirectedCycleAsync",{enumerable:!0,get:function(){return Rt.detectAllUndirectedCycleAsync}}),Object.defineProperty(e,"dijkstraAsync",{enumerable:!0,get:function(){return Rt.dijkstraAsync}}),Object.defineProperty(e,"findAllPathAsync",{enumerable:!0,get:function(){return Rt.findAllPathAsync}}),Object.defineProperty(e,"findShortestPathAsync",{enumerable:!0,get:function(){return Rt.findShortestPathAsync}}),Object.defineProperty(e,"floydWarshallAsync",{enumerable:!0,get:function(){return Rt.floydWarshallAsync}}),Object.defineProperty(e,"labelPropagationAsync",{enumerable:!0,get:function(){return Rt.labelPropagationAsync}}),Object.defineProperty(e,"louvainAsync",{enumerable:!0,get:function(){return Rt.louvainAsync}}),Object.defineProperty(e,"minimumSpanningTreeAsync",{enumerable:!0,get:function(){return Rt.minimumSpanningTreeAsync}}),Object.defineProperty(e,"pageRankAsync",{enumerable:!0,get:function(){return Rt.pageRankAsync}}),Object.defineProperty(e,"getNeighborsAsync",{enumerable:!0,get:function(){return Rt.getNeighborsAsync}}),Object.defineProperty(e,"GADDIAsync",{enumerable:!0,get:function(){return Rt.GADDIAsync}}),e.default=e.detectDirectedCycleAsync=void 0;var t=Rt.detectCycleAsync;e.detectDirectedCycleAsync=t;var n={getAdjMatrixAsync:Rt.getAdjMatrixAsync,connectedComponentAsync:Rt.connectedComponentAsync,getDegreeAsync:Rt.getDegreeAsync,getInDegreeAsync:Rt.getInDegreeAsync,getOutDegreeAsync:Rt.getOutDegreeAsync,detectCycleAsync:Rt.detectCycleAsync,detectDirectedCycleAsync:t,detectAllCyclesAsync:Rt.detectAllCyclesAsync,detectAllDirectedCycleAsync:Rt.detectAllDirectedCycleAsync,detectAllUndirectedCycleAsync:Rt.detectAllUndirectedCycleAsync,dijkstraAsync:Rt.dijkstraAsync,findAllPathAsync:Rt.findAllPathAsync,findShortestPathAsync:Rt.findShortestPathAsync,floydWarshallAsync:Rt.floydWarshallAsync,labelPropagationAsync:Rt.labelPropagationAsync,louvainAsync:Rt.louvainAsync,minimumSpanningTreeAsync:Rt.minimumSpanningTreeAsync,pageRankAsync:Rt.pageRankAsync,getNeighborsAsync:Rt.getNeighborsAsync,GADDIAsync:Rt.GADDIAsync};e.default=n}),IU=Xr(My),kU=My.detectDirectedCycleAsync,DU=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:IU,__moduleExports:My,detectDirectedCycleAsync:kU});function PU(){return window?window.devicePixelRatio:1}function rE(r,e,t,n){var i=r-t,a=e-n;return Math.sqrt(i*i+a*a)}function Es(r,e,t,n,i,a){return i>=r&&i<=r+t&&a>=e&&a<=e+n}function xf(r,e){return!(e.minX>r.maxX||e.maxX<r.minX||e.minY>r.maxY||e.maxY<r.minY)}function NU(r,e){return!r||!e?r||e:{minX:Math.min(r.minX,e.minX),minY:Math.min(r.minY,e.minY),maxX:Math.max(r.maxX,e.maxX),maxY:Math.max(r.maxY,e.maxY)}}function nE(r,e){return r[0]===e[0]&&r[1]===e[1]}var LU=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,OU=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,RU=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,iE=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function aE(r,e){var t=r.match(iE);xe(t,function(n){var i=n.split(":");e.addColorStop(i[0],i[1])})}function BU(r,e,t){var n=LU.exec(t),i=parseFloat(n[1])%360*(Math.PI/180),a=n[2],o=e.getBBox(),s,u;i>=0&&i<1/2*Math.PI?(s={x:o.minX,y:o.minY},u={x:o.maxX,y:o.maxY}):1/2*Math.PI<=i&&i<Math.PI?(s={x:o.maxX,y:o.minY},u={x:o.minX,y:o.maxY}):Math.PI<=i&&i<3/2*Math.PI?(s={x:o.maxX,y:o.maxY},u={x:o.minX,y:o.minY}):(s={x:o.minX,y:o.maxY},u={x:o.maxX,y:o.minY});var l=Math.tan(i),f=l*l,c=(u.x-s.x+l*(u.y-s.y))/(f+1)+s.x,h=l*(u.x-s.x+l*(u.y-s.y))/(f+1)+s.y,d=r.createLinearGradient(s.x,s.y,c,h);return aE(a,d),d}function GU(r,e,t){var n=OU.exec(t),i=parseFloat(n[1]),a=parseFloat(n[2]),o=parseFloat(n[3]),s=n[4];if(o===0){var u=s.match(iE);return u[u.length-1].split(":")[1]}var l=e.getBBox(),f=l.maxX-l.minX,c=l.maxY-l.minY,h=Math.sqrt(f*f+c*c)/2,d=r.createRadialGradient(l.minX+f*i,l.minY+c*a,0,l.minX+f/2,l.minY+c/2,o*h);return aE(s,d),d}function FU(r,e,t){if(e.get("patternSource")&&e.get("patternSource")===t)return e.get("pattern");var n,i,a=RU.exec(t),o=a[1],s=a[2];function u(){n=r.createPattern(i,o),e.set("pattern",n),e.set("patternSource",t)}switch(o){case"a":o="repeat";break;case"x":o="repeat-x";break;case"y":o="repeat-y";break;case"n":o="no-repeat";break;default:o="no-repeat"}return i=new Image,s.match(/^data:/i)||(i.crossOrigin="Anonymous"),i.src=s,i.complete?u():(i.onload=u,i.src=i.src),n}function UU(r,e,t){var n=e.getBBox();if(isNaN(n.x)||isNaN(n.y)||isNaN(n.width)||isNaN(n.height))return t;if(Xe(t)){if(t[1]==="("||t[2]==="("){if(t[0]==="l")return BU(r,e,t);if(t[0]==="r")return GU(r,e,t);if(t[0]==="p")return FU(r,e,t)}return t}if(t instanceof CanvasPattern)return t}function zU(r){var e=0,t=0,n=0,i=0;return At(r)?r.length===1?e=t=n=i=r[0]:r.length===2?(e=n=r[0],t=i=r[1]):r.length===3?(e=r[0],t=i=r[1],n=r[2]):(e=r[0],t=r[1],n=r[2],i=r[3]):e=t=n=i=r,[e,t,n,i]}function ud(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function Iy(r,e){return ud(r)*ud(e)?(r[0]*e[0]+r[1]*e[1])/(ud(r)*ud(e)):1}function oE(r,e){return(r[0]*e[1]<r[1]*e[0]?-1:1)*Math.acos(Iy(r,e))}function sE(r,e){var t=e[1],n=e[2],i=hh(dh(e[3]),Math.PI*2),a=e[4],o=e[5],s=r[0],u=r[1],l=e[6],f=e[7],c=Math.cos(i)*(s-l)/2+Math.sin(i)*(u-f)/2,h=-1*Math.sin(i)*(s-l)/2+Math.cos(i)*(u-f)/2,d=c*c/(t*t)+h*h/(n*n);d>1&&(t*=Math.sqrt(d),n*=Math.sqrt(d));var v=t*t*(h*h)+n*n*(c*c),p=v?Math.sqrt((t*t*(n*n)-v)/v):1;a===o&&(p*=-1),isNaN(p)&&(p=0);var g=n?p*t*h/n:0,y=t?p*-n*c/t:0,m=(s+l)/2+Math.cos(i)*g-Math.sin(i)*y,b=(u+f)/2+Math.sin(i)*g+Math.cos(i)*y,x=[(c-g)/t,(h-y)/n],_=[(-1*c-g)/t,(-1*h-y)/n],S=oE([1,0],x),E=oE(x,_);return Iy(x,_)<=-1&&(E=Math.PI),Iy(x,_)>=1&&(E=0),o===0&&E>0&&(E=E-2*Math.PI),o===1&&E<0&&(E=E+2*Math.PI),{cx:m,cy:b,rx:nE(r,[l,f])?0:t,ry:nE(r,[l,f])?0:n,startAngle:S,endAngle:S+E,xRotation:i,arcFlag:a,sweepFlag:o}}var ld=Math.sin,fd=Math.cos,ky=Math.atan2,cd=Math.PI;function uE(r,e,t,n,i,a,o){var s=e.stroke,u=e.lineWidth,l=t-i,f=n-a,c=ky(f,l),h=new By({type:"path",canvas:r.get("canvas"),isArrowShape:!0,attrs:{path:"M"+10*fd(cd/6)+","+10*ld(cd/6)+" L0,0 L"+10*fd(cd/6)+",-"+10*ld(cd/6),stroke:s,lineWidth:u}});h.translate(i,a),h.rotateAtPoint(i,a,c),r.set(o?"startArrowShape":"endArrowShape",h)}function lE(r,e,t,n,i,a,o){var s=e.startArrow,u=e.endArrow,l=e.stroke,f=e.lineWidth,c=o?s:u,h=c.d,d=c.fill,v=c.stroke,p=c.lineWidth,g=ti(c,["d","fill","stroke","lineWidth"]),y=t-i,m=n-a,b=ky(m,y);h&&(i=i-fd(b)*h,a=a-ld(b)*h);var x=new By({type:"path",canvas:r.get("canvas"),isArrowShape:!0,attrs:L(L({},g),{stroke:v||l,lineWidth:p||f,fill:d})});x.translate(i,a),x.rotateAtPoint(i,a,b),r.set(o?"startArrowShape":"endArrowShape",x)}function Cs(r,e,t,n,i){var a=ky(n-e,t-r);return{dx:fd(a)*i,dy:ld(a)*i}}function Dy(r,e,t,n,i,a){typeof e.startArrow=="object"?lE(r,e,t,n,i,a,!0):e.startArrow?uE(r,e,t,n,i,a,!0):r.set("startArrowShape",null)}function Py(r,e,t,n,i,a){typeof e.endArrow=="object"?lE(r,e,t,n,i,a,!1):e.endArrow?uE(r,e,t,n,i,a,!1):r.set("startArrowShape",null)}var fE={fill:"fillStyle",stroke:"strokeStyle",opacity:"globalAlpha"};function Ru(r,e){var t=e.attr();for(var n in t){var i=t[n],a=fE[n]?fE[n]:n;a==="matrix"&&i?r.transform(i[0],i[1],i[3],i[4],i[6],i[7]):a==="lineDash"&&r.setLineDash?At(i)&&r.setLineDash(i):(a==="strokeStyle"||a==="fillStyle"?i=UU(r,e,i):a==="globalAlpha"&&(i=i*r.globalAlpha),r[a]=i)}}function Ny(r,e,t){for(var n=0;n<e.length;n++){var i=e[n];i.cfg.visible?i.draw(r,t):i.skipDraw()}}function $U(r,e,t){var n=r.get("refreshElements");xe(n,function(i){if(i!==r)for(var a=i.cfg.parent;a&&a!==r&&!a.cfg.refresh;)a.cfg.refresh=!0,a=a.cfg.parent}),n[0]===r?Oy(e):Ly(e,t)}function Ly(r,e){for(var t=0;t<r.length;t++){var n=r[t];if(n.cfg.visible)if(n.cfg.hasChanged)n.cfg.refresh=!0,n.isGroup()&&Oy(n.cfg.children);else if(n.cfg.refresh)n.isGroup()&&Ly(n.cfg.children,e);else{var i=VU(n,e);n.cfg.refresh=i,i&&n.isGroup()&&Ly(n.cfg.children,e)}}}function cE(r){for(var e=0;e<r.length;e++){var t=r[e];t.cfg.hasChanged=!1,t.isGroup()&&!t.destroyed&&cE(t.cfg.children)}}function Oy(r,e){for(var t=0;t<r.length;t++){var n=r[t];n.cfg.refresh=!0,n.isGroup()&&Oy(n.get("children"))}}function VU(r,e){var t=r.cfg.cacheCanvasBBox,n=r.cfg.isInView&&t&&xf(t,e);return n}function hE(r,e,t,n){var i=t.path,a=t.startArrow,o=t.endArrow;if(!!i){var s=[0,0],u=[0,0],l={dx:0,dy:0};e.beginPath();for(var f=0;f<i.length;f++){var c=i[f],h=c[0];if(f===0&&a&&a.d){var d=r.getStartTangent();l=Cs(d[0][0],d[0][1],d[1][0],d[1][1],a.d)}else if(f===i.length-2&&i[f+1][0]==="Z"&&o&&o.d){var v=i[f+1];if(v[0]==="Z"){var d=r.getEndTangent();l=Cs(d[0][0],d[0][1],d[1][0],d[1][1],o.d)}}else if(f===i.length-1&&o&&o.d&&i[0]!=="Z"){var d=r.getEndTangent();l=Cs(d[0][0],d[0][1],d[1][0],d[1][1],o.d)}var p=l.dx,g=l.dy;switch(h){case"M":e.moveTo(c[1]-p,c[2]-g),u=[c[1],c[2]];break;case"L":e.lineTo(c[1]-p,c[2]-g);break;case"Q":e.quadraticCurveTo(c[1],c[2],c[3]-p,c[4]-g);break;case"C":e.bezierCurveTo(c[1],c[2],c[3],c[4],c[5]-p,c[6]-g);break;case"A":{var y=void 0;n?(y=n[f],y||(y=sE(s,c),n[f]=y)):y=sE(s,c);var m=y.cx,b=y.cy,x=y.rx,_=y.ry,S=y.startAngle,E=y.endAngle,C=y.xRotation,M=y.sweepFlag;if(e.ellipse)e.ellipse(m,b,x,_,C,S,E,1-M);else{var w=x>_?x:_,T=x>_?1:x/_,I=x>_?_/x:1;e.translate(m,b),e.rotate(C),e.scale(T,I),e.arc(0,0,w,S,E,1-M),e.scale(1/T,1/I),e.rotate(-C),e.translate(-m,-b)}break}case"Z":e.closePath();break}if(h==="Z")s=u;else{var k=c.length;s=[c[k-2],c[k-1]]}}}}function dE(r,e){var t=r.get("canvas");t&&(e==="remove"&&(r._cacheCanvasBBox=r.get("cacheCanvasBBox")),r.get("hasChanged")||(r.set("hasChanged",!0),r.cfg.parent&&r.cfg.parent.get("hasChanged")||(t.refreshElement(r,e,t),t.get("autoDraw")&&t.draw())))}function WU(r){var e;if(r.destroyed)e=r._cacheCanvasBBox;else{var t=r.get("cacheCanvasBBox"),n=t&&!!(t.width&&t.height),i=r.getCanvasBBox(),a=i&&!!(i.width&&i.height);n&&a?e=NU(t,i):n?e=t:a&&(e=i)}return e}function jU(r){if(!r.length)return null;var e=[],t=[],n=[],i=[];return xe(r,function(a){var o=WU(a);o&&(e.push(o.minX),t.push(o.minY),n.push(o.maxX),i.push(o.maxY))}),{minX:Bi(e),minY:Bi(t),maxX:Ri(n),maxY:Ri(i)}}function XU(r,e){return!r||!e||!xf(r,e)?null:{minX:Math.max(r.minX,e.minX),minY:Math.max(r.minY,e.minY),maxX:Math.min(r.maxX,e.maxX),maxY:Math.min(r.maxY,e.maxY)}}var vE=function(r){$t(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.onCanvasChange=function(t){dE(this,t)},e.prototype.getShapeBase=function(){return Xp},e.prototype.getGroupBase=function(){return e},e.prototype._applyClip=function(t,n){n&&(t.save(),Ru(t,n),n.createPath(t),t.restore(),t.clip(),n._afterDraw())},e.prototype.cacheCanvasBBox=function(){var t=this.cfg.children,n=[],i=[];xe(t,function(h){var d=h.cfg.cacheCanvasBBox;d&&h.cfg.isInView&&(n.push(d.minX,d.maxX),i.push(d.minY,d.maxY))});var a=null;if(n.length){var o=Bi(n),s=Ri(n),u=Bi(i),l=Ri(i);a={minX:o,minY:u,x:o,y:u,maxX:s,maxY:l,width:s-o,height:l-u};var f=this.cfg.canvas;if(f){var c=f.getViewRange();this.set("isInView",xf(a,c))}}else this.set("isInView",!1);this.set("cacheCanvasBBox",a)},e.prototype.draw=function(t,n){var i=this.cfg.children,a=n?this.cfg.refresh:!0;i.length&&a&&(t.save(),Ru(t,this),this._applyClip(t,this.getClip()),Ny(t,i,n),t.restore(),this.cacheCanvasBBox()),this.cfg.refresh=null,this.set("hasChanged",!1)},e.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("hasChanged",!1)},e}(Gw),HU=function(r){$t(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return L(L({},t),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},e.prototype.getShapeBase=function(){return Xp},e.prototype.getGroupBase=function(){return vE},e.prototype.onCanvasChange=function(t){dE(this,t)},e.prototype.calculateBBox=function(){var t=this.get("type"),n=this.getHitLineWidth(),i=zw(t),a=i(this),o=n/2,s=a.x-o,u=a.y-o,l=a.x+a.width+o,f=a.y+a.height+o;return{x:s,minX:s,y:u,minY:u,width:a.width+n,height:a.height+n,maxX:l,maxY:f}},e.prototype.isFill=function(){return!!this.attrs.fill||this.isClipShape()},e.prototype.isStroke=function(){return!!this.attrs.stroke},e.prototype._applyClip=function(t,n){n&&(t.save(),Ru(t,n),n.createPath(t),t.restore(),t.clip(),n._afterDraw())},e.prototype.draw=function(t,n){var i=this.cfg.clipShape;if(n){if(this.cfg.refresh===!1){this.set("hasChanged",!1);return}var a=this.getCanvasBBox();if(!xf(n,a)){this.set("hasChanged",!1),this.cfg.isInView&&this._afterDraw();return}}t.save(),Ru(t,this),this._applyClip(t,i),this.drawPath(t),t.restore(),this._afterDraw()},e.prototype.getCanvasViewBox=function(){var t=this.cfg.canvas;return t?t.getViewRange():null},e.prototype.cacheCanvasBBox=function(){var t=this.getCanvasViewBox();if(t){var n=this.getCanvasBBox(),i=xf(n,t);this.set("isInView",i),i?this.set("cacheCanvasBBox",n):this.set("cacheCanvasBBox",null)}},e.prototype._afterDraw=function(){this.cacheCanvasBBox(),this.set("hasChanged",!1),this.set("refresh",null)},e.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("isInView",null),this.set("hasChanged",!1)},e.prototype.drawPath=function(t){this.createPath(t),this.strokeAndFill(t),this.afterDrawPath(t)},e.prototype.fill=function(t){t.fill()},e.prototype.stroke=function(t){t.stroke()},e.prototype.strokeAndFill=function(t){var n=this.attrs,i=n.lineWidth,a=n.opacity,o=n.strokeOpacity,s=n.fillOpacity;this.isFill()&&(!yt(s)&&s!==1?(t.globalAlpha=s,this.fill(t),t.globalAlpha=a):this.fill(t)),this.isStroke()&&i>0&&(!yt(o)&&o!==1&&(t.globalAlpha=o),this.stroke(t)),this.afterDrawPath(t)},e.prototype.createPath=function(t){},e.prototype.afterDrawPath=function(t){},e.prototype.isInShape=function(t,n){var i=this.isStroke(),a=this.isFill(),o=this.getHitLineWidth();return this.isInStrokeOrPath(t,n,i,a,o)},e.prototype.isInStrokeOrPath=function(t,n,i,a,o){return!1},e.prototype.getHitLineWidth=function(){if(!this.isStroke())return 0;var t=this.attrs;return t.lineWidth+t.lineAppendWidth},e}(Fw),ra=HU,YU=function(r){$t(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return L(L({},t),{x:0,y:0,r:0})},e.prototype.isInStrokeOrPath=function(t,n,i,a,o){var s=this.attr(),u=s.x,l=s.y,f=s.r,c=o/2,h=rE(u,l,t,n);return a&&i?h<=f+c:a?h<=f:i?h>=f-c&&h<=f+c:!1},e.prototype.createPath=function(t){var n=this.attr(),i=n.x,a=n.y,o=n.r;t.beginPath(),t.arc(i,a,o,0,Math.PI*2,!1),t.closePath()},e}(ra),qU=YU;function hd(r,e,t,n){return r/(t*t)+e/(n*n)}var KU=function(r){$t(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return L(L({},t),{x:0,y:0,rx:0,ry:0})},e.prototype.isInStrokeOrPath=function(t,n,i,a,o){var s=this.attr(),u=o/2,l=s.x,f=s.y,c=s.rx,h=s.ry,d=(t-l)*(t-l),v=(n-f)*(n-f);return a&&i?hd(d,v,c+u,h+u)<=1:a?hd(d,v,c,h)<=1:i?hd(d,v,c-u,h-u)>=1&&hd(d,v,c+u,h+u)<=1:!1},e.prototype.createPath=function(t){var n=this.attr(),i=n.x,a=n.y,o=n.rx,s=n.ry;if(t.beginPath(),t.ellipse)t.ellipse(i,a,o,s,0,0,Math.PI*2,!1);else{var u=o>s?o:s,l=o>s?1:o/s,f=o>s?s/o:1;t.save(),t.translate(i,a),t.scale(l,f),t.arc(0,0,u,0,Math.PI*2),t.restore(),t.closePath()}},e}(ra),ZU=KU;function pE(r){return r instanceof HTMLElement&&Xe(r.nodeName)&&r.nodeName.toUpperCase()==="CANVAS"}var QU=function(r){$t(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return L(L({},t),{x:0,y:0,width:0,height:0})},e.prototype.initAttrs=function(t){this._setImage(t.img)},e.prototype.isStroke=function(){return!1},e.prototype.isOnlyHitBox=function(){return!0},e.prototype._afterLoading=function(){if(this.get("toDraw")===!0){var t=this.get("canvas");t?t.draw():this.createPath(this.get("context"))}},e.prototype._setImage=function(t){var n=this,i=this.attrs;if(Xe(t)){var a=new Image;a.onload=function(){if(n.destroyed)return!1;n.attr("img",a),n.set("loading",!1),n._afterLoading();var o=n.get("callback");o&&o.call(n)},a.crossOrigin="Anonymous",a.src=t,this.set("loading",!0)}else t instanceof Image?(i.width||(i.width=t.width),i.height||(i.height=t.height)):pE(t)&&(i.width||(i.width=Number(t.getAttribute("width"))),i.height||(i.height,Number(t.getAttribute("height"))))},e.prototype.onAttrChange=function(t,n,i){r.prototype.onAttrChange.call(this,t,n,i),t==="img"&&this._setImage(n)},e.prototype.createPath=function(t){if(this.get("loading")){this.set("toDraw",!0),this.set("context",t);return}var n=this.attr(),i=n.x,a=n.y,o=n.width,s=n.height,u=n.sx,l=n.sy,f=n.swidth,c=n.sheight,h=n.img;(h instanceof Image||pE(h))&&(!yt(u)&&!yt(l)&&!yt(f)&&!yt(c)?t.drawImage(h,u,l,f,c,i,a,o,s):t.drawImage(h,i,a,o,s))},e}(ra),JU=QU;function Co(r,e,t,n,i,a,o){var s=Math.min(r,t),u=Math.max(r,t),l=Math.min(e,n),f=Math.max(e,n),c=i/2;return a>=s-c&&a<=u+c&&o>=l-c&&o<=f+c?Wn.pointToLine(r,e,t,n,a,o)<=i/2:!1}var ez=function(r){$t(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return L(L({},t),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},e.prototype.initAttrs=function(t){this.setArrow()},e.prototype.onAttrChange=function(t,n,i){r.prototype.onAttrChange.call(this,t,n,i),this.setArrow()},e.prototype.setArrow=function(){var t=this.attr(),n=t.x1,i=t.y1,a=t.x2,o=t.y2,s=t.startArrow,u=t.endArrow;s&&Dy(this,t,a,o,n,i),u&&Py(this,t,n,i,a,o)},e.prototype.isInStrokeOrPath=function(t,n,i,a,o){if(!i||!o)return!1;var s=this.attr(),u=s.x1,l=s.y1,f=s.x2,c=s.y2;return Co(u,l,f,c,o,t,n)},e.prototype.createPath=function(t){var n=this.attr(),i=n.x1,a=n.y1,o=n.x2,s=n.y2,u=n.startArrow,l=n.endArrow,f={dx:0,dy:0},c={dx:0,dy:0};u&&u.d&&(f=Cs(i,a,o,s,n.startArrow.d)),l&&l.d&&(c=Cs(i,a,o,s,n.endArrow.d)),t.beginPath(),t.moveTo(i+f.dx,a+f.dy),t.lineTo(o-c.dx,s-c.dy)},e.prototype.afterDrawPath=function(t){var n=this.get("startArrowShape"),i=this.get("endArrowShape");n&&n.draw(t),i&&i.draw(t)},e.prototype.getTotalLength=function(){var t=this.attr(),n=t.x1,i=t.y1,a=t.x2,o=t.y2;return Wn.length(n,i,a,o)},e.prototype.getPoint=function(t){var n=this.attr(),i=n.x1,a=n.y1,o=n.x2,s=n.y2;return Wn.pointAt(i,a,o,s,t)},e}(ra),tz=ez,rz={circle:function(r,e,t){return[["M",r-t,e],["A",t,t,0,1,0,r+t,e],["A",t,t,0,1,0,r-t,e]]},square:function(r,e,t){return[["M",r-t,e-t],["L",r+t,e-t],["L",r+t,e+t],["L",r-t,e+t],["Z"]]},diamond:function(r,e,t){return[["M",r-t,e],["L",r,e-t],["L",r+t,e],["L",r,e+t],["Z"]]},triangle:function(r,e,t){var n=t*Math.sin(1/3*Math.PI);return[["M",r-t,e+n],["L",r,e-n],["L",r+t,e+n],["Z"]]},"triangle-down":function(r,e,t){var n=t*Math.sin(1/3*Math.PI);return[["M",r-t,e-n],["L",r+t,e-n],["L",r,e+n],["Z"]]}},nz=function(r){$t(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.initAttrs=function(t){this._resetParamsCache()},e.prototype._resetParamsCache=function(){this.set("paramsCache",{})},e.prototype.onAttrChange=function(t,n,i){r.prototype.onAttrChange.call(this,t,n,i),["symbol","x","y","r","radius"].indexOf(t)!==-1&&this._resetParamsCache()},e.prototype.isOnlyHitBox=function(){return!0},e.prototype._getR=function(t){return yt(t.r)?t.radius:t.r},e.prototype._getPath=function(){var t=this.attr(),n=t.x,i=t.y,a=t.symbol||"circle",o=this._getR(t),s,u;if(Kr(a))s=a,u=s(n,i,o),u=hS(u);else{if(s=e.Symbols[a],!s)return console.warn(a+" marker is not supported."),null;u=s(n,i,o)}return u},e.prototype.createPath=function(t){var n=this._getPath(),i=this.get("paramsCache");hE(this,t,{path:n},i)},e.Symbols=rz,e}(ra),iz=nz;function gE(r,e,t){var n=sS();return r.createPath(n),n.isPointInPath(e,t)}var az=1e-6;function Ry(r){return Math.abs(r)<az?0:r<0?-1:1}function oz(r,e,t){return(t[0]-r[0])*(e[1]-r[1])==(e[0]-r[0])*(t[1]-r[1])&&Math.min(r[0],e[0])<=t[0]&&t[0]<=Math.max(r[0],e[0])&&Math.min(r[1],e[1])<=t[1]&&t[1]<=Math.max(r[1],e[1])}function yE(r,e,t){var n=!1,i=r.length;if(i<=2)return!1;for(var a=0;a<i;a++){var o=r[a],s=r[(a+1)%i];if(oz(o,s,[e,t]))return!0;Ry(o[1]-t)>0!=Ry(s[1]-t)>0&&Ry(e-(t-o[1])*(o[0]-s[0])/(o[1]-s[1])-o[0])<0&&(n=!n)}return n}function sz(r,e,t){var n=[0,0,0,0,0,0,0,0,0];return Gl(n,t),zn(r,n,e)}function uz(r,e,t){var n=[0,0,0,0,0,0,0,0,0];return Fl(n,t),zn(r,n,e)}function lz(r,e,t){var n=[0,0,0,0,0,0,0,0,0];return Ul(n,t),zn(r,n,e)}function fz(r,e,t){return zn(r,t,e)}function cz(r,e){for(var t=r?[].concat(r):[1,0,0,0,1,0,0,0,1],n=0,i=e.length;n<i;n++){var a=e[n];switch(a[0]){case"t":sz(t,t,[a[1],a[2]]);break;case"s":lz(t,t,[a[1],a[2]]);break;case"r":uz(t,t,a[1]);break;case"m":fz(t,t,a[1]);break}}return t}function _f(r,e,t,n,i,a,o,s){var u=(Math.atan2(s-e,o-r)+Math.PI*2)%(Math.PI*2);if(u<n||u>i)return!1;var l={x:r+t*Math.cos(u),y:e+t*Math.sin(u)};return rE(l.x,l.y,o,s)<=a/2}var hz=cz;function dz(r){for(var e=!1,t=r.length,n=0;n<t;n++){var i=r[n],a=i[0];if(a==="C"||a==="A"||a==="Q"){e=!0;break}}return e}function vz(r,e,t,n,i){for(var a=!1,o=e/2,s=0;s<r.length;s++){var u=r[s],l=u.currentPoint,f=u.params,c=u.prePoint,h=u.box;if(!(h&&!Es(h.x-o,h.y-o,h.width+e,h.height+e,t,n))){switch(u.command){case"L":case"Z":a=Co(c[0],c[1],l[0],l[1],e,t,n);break;case"Q":var d=Kw.pointDistance(c[0],c[1],f[1],f[2],f[3],f[4],t,n);a=d<=e/2;break;case"C":var v=cf.pointDistance(c[0],c[1],f[1],f[2],f[3],f[4],f[5],f[6],t,n,i);a=v<=e/2;break;case"A":var p=u.arcParams,g=p.cx,y=p.cy,m=p.rx,b=p.ry,x=p.startAngle,_=p.endAngle,S=p.xRotation,E=[t,n,1],C=m>b?m:b,M=m>b?1:m/b,w=m>b?b/m:1,T=hz(null,[["t",-g,-y],["r",-S],["s",1/M,1/w]]);Mu(E,E,T),a=_f(0,0,C,x,_,e,E[0],E[1]);break}if(a)break}}return a}function pz(r){for(var e=r.length,t=[],n=[],i=[],a=0;a<e;a++){var o=r[a],s=o[0];s==="M"?(i.length&&(n.push(i),i=[]),i.push([o[1],o[2]])):s==="Z"?i.length&&(t.push(i),i=[]):i.push([o[1],o[2]])}return i.length>0&&n.push(i),{polygons:t,polylines:n}}var dd=L({hasArc:dz,extractPolygons:pz,isPointInStroke:vz},xG);function mE(r,e,t){for(var n=!1,i=0;i<r.length;i++){var a=r[i];if(n=yE(a,e,t),n)break}return n}var gz=function(r){$t(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return L(L({},t),{startArrow:!1,endArrow:!1})},e.prototype.initAttrs=function(t){this._setPathArr(t.path),this.setArrow()},e.prototype.onAttrChange=function(t,n,i){r.prototype.onAttrChange.call(this,t,n,i),t==="path"&&this._setPathArr(n),this.setArrow()},e.prototype._setPathArr=function(t){this.attrs.path=hS(t);var n=dd.hasArc(t);this.set("hasArc",n),this.set("paramsCache",{}),this.set("segments",null),this.set("curve",null),this.set("tCache",null),this.set("totalLength",null)},e.prototype.getSegments=function(){var t=this.get("segements");return t||(t=pS(this.attr("path")),this.set("segments",t)),t},e.prototype.setArrow=function(){var t=this.attr(),n=t.startArrow,i=t.endArrow;if(n){var a=this.getStartTangent();Dy(this,t,a[0][0],a[0][1],a[1][0],a[1][1])}if(i){var a=this.getEndTangent();Py(this,t,a[0][0],a[0][1],a[1][0],a[1][1])}},e.prototype.isInStrokeOrPath=function(t,n,i,a,o){var s=this.getSegments(),u=this.get("hasArc"),l=!1;if(i){var f=this.getTotalLength();l=dd.isPointInStroke(s,o,t,n,f)}if(!l&&a)if(u)l=gE(this,t,n);else{var c=this.attr("path"),h=dd.extractPolygons(c);l=mE(h.polygons,t,n)||mE(h.polylines,t,n)}return l},e.prototype.createPath=function(t){var n=this.attr(),i=this.get("paramsCache");hE(this,t,n,i)},e.prototype.afterDrawPath=function(t){var n=this.get("startArrowShape"),i=this.get("endArrowShape");n&&n.draw(t),i&&i.draw(t)},e.prototype.getTotalLength=function(){var t=this.get("totalLength");return yt(t)?(this._calculateCurve(),this._setTcache(),this.get("totalLength")):t},e.prototype.getPoint=function(t){var n=this.get("tCache");n||(this._calculateCurve(),this._setTcache(),n=this.get("tCache"));var i,a,o=this.get("curve");if(!n||n.length===0)return o?{x:o[0][1],y:o[0][2]}:null;xe(n,function(f,c){t>=f[0]&&t<=f[1]&&(i=(t-f[0])/(f[1]-f[0]),a=c)});var s=o[a];if(yt(s)||yt(a))return null;var u=s.length,l=o[a+1];return cf.pointAt(s[u-2],s[u-1],l[1],l[2],l[3],l[4],l[5],l[6],i)},e.prototype._calculateCurve=function(){var t=this.attr().path;this.set("curve",dd.pathToCurve(t))},e.prototype._setTcache=function(){var t=0,n=0,i=[],a,o,s,u,l=this.get("curve");if(!!l){if(xe(l,function(f,c){s=l[c+1],u=f.length,s&&(t+=cf.length(f[u-2],f[u-1],s[1],s[2],s[3],s[4],s[5],s[6])||0)}),this.set("totalLength",t),t===0){this.set("tCache",[]);return}xe(l,function(f,c){s=l[c+1],u=f.length,s&&(a=[],a[0]=n/t,o=cf.length(f[u-2],f[u-1],s[1],s[2],s[3],s[4],s[5],s[6]),n+=o||0,a[1]=n/t,i.push(a))}),this.set("tCache",i)}},e.prototype.getStartTangent=function(){var t=this.getSegments(),n;if(t.length>1){var i=t[0].currentPoint,a=t[1].currentPoint,o=t[1].startTangent;n=[],o?(n.push([i[0]-o[0],i[1]-o[1]]),n.push([i[0],i[1]])):(n.push([a[0],a[1]]),n.push([i[0],i[1]]))}return n},e.prototype.getEndTangent=function(){var t=this.getSegments(),n=t.length,i;if(n>1){var a=t[n-2].currentPoint,o=t[n-1].currentPoint,s=t[n-1].endTangent;i=[],s?(i.push([o[0]-s[0],o[1]-s[1]]),i.push([o[0],o[1]])):(i.push([a[0],a[1]]),i.push([o[0],o[1]]))}return i},e}(ra),By=gz;function bE(r,e,t,n,i){var a=r.length;if(a<2)return!1;for(var o=0;o<a-1;o++){var s=r[o][0],u=r[o][1],l=r[o+1][0],f=r[o+1][1];if(Co(s,u,l,f,e,t,n))return!0}if(i){var c=r[0],h=r[a-1];if(Co(c[0],c[1],h[0],h[1],e,t,n))return!0}return!1}var yz=function(r){$t(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.isInStrokeOrPath=function(t,n,i,a,o){var s=this.attr().points,u=!1;return i&&(u=bE(s,o,t,n,!0)),!u&&a&&(u=yE(s,t,n)),u},e.prototype.createPath=function(t){var n=this.attr(),i=n.points;if(!(i.length<2)){t.beginPath();for(var a=0;a<i.length;a++){var o=i[a];a===0?t.moveTo(o[0],o[1]):t.lineTo(o[0],o[1])}t.closePath()}},e}(ra),mz=yz,bz=function(r){$t(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return L(L({},t),{startArrow:!1,endArrow:!1})},e.prototype.initAttrs=function(t){this.setArrow()},e.prototype.onAttrChange=function(t,n,i){r.prototype.onAttrChange.call(this,t,n,i),this.setArrow(),["points"].indexOf(t)!==-1&&this._resetCache()},e.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},e.prototype.setArrow=function(){var t=this.attr(),n=this.attrs,i=n.points,a=n.startArrow,o=n.endArrow,s=i.length,u=i[0][0],l=i[0][1],f=i[s-1][0],c=i[s-1][1];a&&Dy(this,t,i[1][0],i[1][1],u,l),o&&Py(this,t,i[s-2][0],i[s-2][1],f,c)},e.prototype.isFill=function(){return!1},e.prototype.isInStrokeOrPath=function(t,n,i,a,o){if(!i||!o)return!1;var s=this.attr().points;return bE(s,o,t,n,!1)},e.prototype.isStroke=function(){return!0},e.prototype.createPath=function(t){var n=this.attr(),i=n.points,a=n.startArrow,o=n.endArrow,s=i.length;if(!(i.length<2)){var u=i[0][0],l=i[0][1],f=i[s-1][0],c=i[s-1][1];if(a&&a.d){var h=Cs(u,l,i[1][0],i[1][1],a.d);u+=h.dx,l+=h.dy}if(o&&o.d){var h=Cs(i[s-2][0],i[s-2][1],f,c,o.d);f-=h.dx,c-=h.dy}t.beginPath(),t.moveTo(u,l);for(var d=0;d<s-1;d++){var v=i[d];t.lineTo(v[0],v[1])}t.lineTo(f,c)}},e.prototype.afterDrawPath=function(t){var n=this.get("startArrowShape"),i=this.get("endArrowShape");n&&n.draw(t),i&&i.draw(t)},e.prototype.getTotalLength=function(){var t=this.attr().points,n=this.get("totalLength");return yt(n)?(this.set("totalLength",aS.length(t)),this.get("totalLength")):n},e.prototype.getPoint=function(t){var n=this.attr().points,i=this.get("tCache");i||(this._setTcache(),i=this.get("tCache"));var a,o;return xe(i,function(s,u){t>=s[0]&&t<=s[1]&&(a=(t-s[0])/(s[1]-s[0]),o=u)}),Wn.pointAt(n[o][0],n[o][1],n[o+1][0],n[o+1][1],a)},e.prototype._setTcache=function(){var t=this.attr().points;if(!(!t||t.length===0)){var n=this.getTotalLength();if(!(n<=0)){var i=0,a=[],o,s;xe(t,function(u,l){t[l+1]&&(o=[],o[0]=i/n,s=Wn.length(u[0],u[1],t[l+1][0],t[l+1][1]),i+=s,o[1]=i/n,a.push(o))}),this.set("tCache",a)}}},e.prototype.getStartTangent=function(){var t=this.attr().points,n=[];return n.push([t[1][0],t[1][1]]),n.push([t[0][0],t[0][1]]),n},e.prototype.getEndTangent=function(){var t=this.attr().points,n=t.length-1,i=[];return i.push([t[n-1][0],t[n-1][1]]),i.push([t[n][0],t[n][1]]),i},e}(ra),xz=bz;function _z(r,e,t,n,i,a,o){var s=i/2;return Es(r-s,e-s,t,i,a,o)||Es(r+t-s,e-s,i,n,a,o)||Es(r+s,e+n-s,t,i,a,o)||Es(r-s,e+s,i,n,a,o)}function wz(r,e,t,n,i,a,o,s){return Co(r+i,e,r+t-i,e,a,o,s)||Co(r+t,e+i,r+t,e+n-i,a,o,s)||Co(r+t-i,e+n,r+i,e+n,a,o,s)||Co(r,e+n-i,r,e+i,a,o,s)||_f(r+t-i,e+i,i,1.5*Math.PI,2*Math.PI,a,o,s)||_f(r+t-i,e+n-i,i,0,.5*Math.PI,a,o,s)||_f(r+i,e+n-i,i,.5*Math.PI,Math.PI,a,o,s)||_f(r+i,e+i,i,Math.PI,1.5*Math.PI,a,o,s)}var Sz=function(r){$t(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return L(L({},t),{x:0,y:0,width:0,height:0,radius:0})},e.prototype.isInStrokeOrPath=function(t,n,i,a,o){var s=this.attr(),u=s.x,l=s.y,f=s.width,c=s.height,h=s.radius;if(h){var v=!1;return i&&(v=wz(u,l,f,c,h,o,t,n)),!v&&a&&(v=gE(this,t,n)),v}else{var d=o/2;if(a&&i)return Es(u-d,l-d,f+d,c+d,t,n);if(a)return Es(u,l,f,c,t,n);if(i)return _z(u,l,f,c,o,t,n)}},e.prototype.createPath=function(t){var n=this.attr(),i=n.x,a=n.y,o=n.width,s=n.height,u=n.radius;if(t.beginPath(),u===0)t.rect(i,a,o,s);else{var l=zU(u),f=l[0],c=l[1],h=l[2],d=l[3];t.moveTo(i+f,a),t.lineTo(i+o-c,a),c!==0&&t.arc(i+o-c,a+c,c,-Math.PI/2,0),t.lineTo(i+o,a+s-h),h!==0&&t.arc(i+o-h,a+s-h,h,0,Math.PI/2),t.lineTo(i+d,a+s),d!==0&&t.arc(i+d,a+s-d,d,Math.PI/2,Math.PI),t.lineTo(i,a+f),f!==0&&t.arc(i+f,a+f,f,Math.PI,Math.PI*1.5),t.closePath()}},e}(ra),Ez=Sz,Cz=function(r){$t(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return L(L({},t),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},e.prototype.isOnlyHitBox=function(){return!0},e.prototype.initAttrs=function(t){this._assembleFont(),t.text&&this._setText(t.text)},e.prototype._assembleFont=function(){var t=this.attrs;t.font=lS(t)},e.prototype._setText=function(t){var n=null;Xe(t)&&t.indexOf(`
`)!==-1&&(n=t.split(`
`)),this.set("textArr",n)},e.prototype.onAttrChange=function(t,n,i){r.prototype.onAttrChange.call(this,t,n,i),t.startsWith("font")&&this._assembleFont(),t==="text"&&this._setText(n)},e.prototype._getSpaceingY=function(){var t=this.attrs,n=t.lineHeight,i=t.fontSize*1;return n?n-i:i*.14},e.prototype._drawTextArr=function(t,n,i){var a=this.attrs,o=a.textBaseline,s=a.x,u=a.y,l=a.fontSize*1,f=this._getSpaceingY(),c=uS(a.text,a.fontSize,a.lineHeight),h;xe(n,function(d,v){h=u+v*(f+l)-c+l,o==="middle"&&(h+=c-l-(c-l)/2),o==="top"&&(h+=c-l),yt(d)||(i?t.fillText(d,s,h):t.strokeText(d,s,h))})},e.prototype._drawText=function(t,n){var i=this.attr(),a=i.x,o=i.y,s=this.get("textArr");if(s)this._drawTextArr(t,s,n);else{var u=i.text;yt(u)||(n?t.fillText(u,a,o):t.strokeText(u,a,o))}},e.prototype.strokeAndFill=function(t){var n=this.attrs,i=n.lineWidth,a=n.opacity,o=n.strokeOpacity,s=n.fillOpacity;this.isStroke()&&i>0&&(!yt(o)&&o!==1&&(t.globalAlpha=a),this.stroke(t)),this.isFill()&&(!yt(s)&&s!==1?(t.globalAlpha=s,this.fill(t),t.globalAlpha=a):this.fill(t)),this.afterDrawPath(t)},e.prototype.fill=function(t){this._drawText(t,!0)},e.prototype.stroke=function(t){this._drawText(t,!1)},e}(ra),Az=Cz;function Tz(r,e){if(e){var t=K_(e);return xs(t,r)}return r}function xE(r,e,t){var n=r.getTotalMatrix();if(n){var i=Tz([e,t,1],n),a=i[0],o=i[1];return[a,o]}return[e,t]}function _E(r,e,t){if(r.isCanvas&&r.isCanvas())return!0;if(!Gg(r)||r.cfg.isInView===!1)return!1;if(r.cfg.clipShape){var n=xE(r,e,t),i=n[0],a=n[1];if(r.isClipped(i,a))return!1}var o=r.cfg.cacheCanvasBBox||r.getCanvasBBox();return e>=o.minX&&e<=o.maxX&&t>=o.minY&&t<=o.maxY}function wE(r,e,t){if(!_E(r,e,t))return null;for(var n=null,i=r.getChildren(),a=i.length,o=a-1;o>=0;o--){var s=i[o];if(s.isGroup())n=wE(s,e,t);else if(_E(s,e,t)){var u=s,l=xE(s,e,t),f=l[0],c=l[1];u.isInShape(f,c)&&(n=s)}if(n)break}return n}var Ao=function(r){$t(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return t.renderer="canvas",t.autoDraw=!0,t.localRefresh=!0,t.refreshElements=[],t.clipView=!0,t.quickHit=!1,t},e.prototype.onCanvasChange=function(t){(t==="attr"||t==="sort"||t==="changeSize")&&(this.set("refreshElements",[this]),this.draw())},e.prototype.getShapeBase=function(){return Xp},e.prototype.getGroupBase=function(){return vE},e.prototype.getPixelRatio=function(){var t=this.get("pixelRatio")||PU();return t>=1?Math.ceil(t):1},e.prototype.getViewRange=function(){return{minX:0,minY:0,maxX:this.cfg.width,maxY:this.cfg.height}},e.prototype.createDom=function(){var t=document.createElement("canvas"),n=t.getContext("2d");return this.set("context",n),t},e.prototype.setDOMSize=function(t,n){r.prototype.setDOMSize.call(this,t,n);var i=this.get("context"),a=this.get("el"),o=this.getPixelRatio();a.width=o*t,a.height=o*n,o>1&&i.scale(o,o)},e.prototype.clear=function(){r.prototype.clear.call(this),this._clearFrame();var t=this.get("context"),n=this.get("el");t.clearRect(0,0,n.width,n.height)},e.prototype.getShape=function(t,n){var i;return this.get("quickHit")?i=wE(this,t,n):i=r.prototype.getShape.call(this,t,n,null),i},e.prototype._getRefreshRegion=function(){var t=this.get("refreshElements"),n=this.getViewRange(),i;if(t.length&&t[0]===this)i=n;else if(i=jU(t),i){i.minX=Math.floor(i.minX),i.minY=Math.floor(i.minY),i.maxX=Math.ceil(i.maxX),i.maxY=Math.ceil(i.maxY),i.maxY+=1;var a=this.get("clipView");a&&(i=XU(i,n))}return i},e.prototype.refreshElement=function(t){var n=this.get("refreshElements");n.push(t)},e.prototype._clearFrame=function(){var t=this.get("drawFrame");t&&(cx(t),this.set("drawFrame",null),this.set("refreshElements",[]))},e.prototype.draw=function(){var t=this.get("drawFrame");this.get("autoDraw")&&t||this._startDraw()},e.prototype._drawAll=function(){var t=this.get("context"),n=this.get("el"),i=this.getChildren();t.clearRect(0,0,n.width,n.height),Ru(t,this),Ny(t,i),this.set("refreshElements",[])},e.prototype._drawRegion=function(){var t=this.get("context"),n=this.get("refreshElements"),i=this.getChildren(),a=this._getRefreshRegion();a?(t.clearRect(a.minX,a.minY,a.maxX-a.minX,a.maxY-a.minY),t.save(),t.beginPath(),t.rect(a.minX,a.minY,a.maxX-a.minX,a.maxY-a.minY),t.clip(),Ru(t,this),$U(this,i,a),Ny(t,i,a),t.restore()):n.length&&cE(n),xe(n,function(o){o.get("hasChanged")&&o.set("hasChanged",!1)}),this.set("refreshElements",[])},e.prototype._startDraw=function(){var t=this,n=this.get("drawFrame");n||(n=fx(function(){t.get("localRefresh")?t._drawRegion():t._drawAll(),t.set("drawFrame",null)}),this.set("drawFrame",n))},e.prototype.skipDraw=function(){},e.prototype.removeDom=function(){var t=this.get("el");t.width=0,t.height=0,t.parentNode.removeChild(t)},e}(Bw),Gy={rect:"path",circle:"circle",line:"line",path:"path",marker:"path",text:"text",polyline:"polyline",polygon:"polygon",image:"image",ellipse:"ellipse",dom:"foreignObject"},mr={opacity:"opacity",fillStyle:"fill",fill:"fill",fillOpacity:"fill-opacity",strokeStyle:"stroke",strokeOpacity:"stroke-opacity",stroke:"stroke",x:"x",y:"y",r:"r",rx:"rx",ry:"ry",width:"width",height:"height",x1:"x1",x2:"x2",y1:"y1",y2:"y2",lineCap:"stroke-linecap",lineJoin:"stroke-linejoin",lineWidth:"stroke-width",lineDash:"stroke-dasharray",lineDashOffset:"stroke-dashoffset",miterLimit:"stroke-miterlimit",font:"font",fontSize:"font-size",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",fontFamily:"font-family",startArrow:"marker-start",endArrow:"marker-end",path:"d",class:"class",id:"id",style:"style",preserveAspectRatio:"preserveAspectRatio"};function Ui(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function SE(r){var e=Gy[r.type],t=r.getParent();if(!e)throw new Error("the type "+r.type+" is not supported by svg");var n=Ui(e);if(r.get("id")&&(n.id=r.get("id")),r.set("el",n),r.set("attrs",{}),t){var i=t.get("el");i||(i=t.createDom(),t.set("el",i)),i.appendChild(n)}return n}function EE(r,e){var t=r.get("el"),n=px(t.children).sort(e),i=document.createDocumentFragment();n.forEach(function(a){i.appendChild(a)}),t.appendChild(i)}function Mz(r,e){var t=r.parentNode,n=Array.from(t.childNodes).filter(function(s){return s.nodeType===1&&s.nodeName.toLowerCase()!=="defs"}),i=n[e],a=n.indexOf(r);if(i){if(a>e)t.insertBefore(r,i);else if(a<e){var o=n[e+1];o?t.insertBefore(r,o):t.appendChild(r)}}else t.appendChild(r)}function Iz(r,e){var t=r.cfg.el,n=r.attr(),i={dx:n.shadowOffsetX,dy:n.shadowOffsetY,blur:n.shadowBlur,color:n.shadowColor};if(!i.dx&&!i.dy&&!i.blur&&!i.color)t.removeAttribute("filter");else{var a=e.find("filter",i);a||(a=e.addShadow(i)),t.setAttribute("filter","url(#"+a+")")}}function wf(r){var e=r.attr().matrix;if(e){for(var t=r.cfg.el,n=[],i=0;i<9;i+=3)n.push(e[i]+","+e[i+1]);n=n.join(","),n.indexOf("NaN")===-1?t.setAttribute("transform","matrix("+n+")"):console.warn("invalid matrix:",e)}}function Sf(r,e){var t=r.getClip(),n=r.get("el");if(!t)n.removeAttribute("clip-path");else if(t&&!n.hasAttribute("clip-path")){SE(t),t.createPath(e);var i=e.addClip(t);n.setAttribute("clip-path","url(#"+i+")")}}function CE(r,e){e.forEach(function(t){t.draw(r)})}function AE(r,e){var t=r.get("canvas");if(t&&t.get("autoDraw")){var n=t.get("context"),i=r.getParent(),a=i?i.getChildren():[t],o=r.get("el");if(e==="remove"){var s=r.get("isClipShape");if(s){var u=o&&o.parentNode,l=u&&u.parentNode;u&&l&&l.removeChild(u)}else o&&o.parentNode&&o.parentNode.removeChild(o)}else if(e==="show")o.setAttribute("visibility","visible");else if(e==="hide")o.setAttribute("visibility","hidden");else if(e==="zIndex")Mz(o,a.indexOf(r));else if(e==="sort"){var f=r.get("children");f&&f.length&&EE(r,function(c,h){return f.indexOf(c)-f.indexOf(h)?1:0})}else e==="clear"?o&&(o.innerHTML=""):e==="matrix"?wf(r):e==="clip"?Sf(r,n):e==="attr"||e==="add"&&r.draw(n)}}var TE=function(r){$t(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.isEntityGroup=function(){return!0},e.prototype.createDom=function(){var t=Ui("g");this.set("el",t);var n=this.getParent();if(n){var i=n.get("el");i||(i=n.createDom(),n.set("el",i)),i.appendChild(t)}return t},e.prototype.afterAttrsChange=function(t){r.prototype.afterAttrsChange.call(this,t);var n=this.get("canvas");if(n&&n.get("autoDraw")){var i=n.get("context");this.createPath(i,t)}},e.prototype.onCanvasChange=function(t){AE(this,t)},e.prototype.getShapeBase=function(){return Hp},e.prototype.getGroupBase=function(){return e},e.prototype.draw=function(t){var n=this.getChildren(),i=this.get("el");this.get("destroyed")?i&&i.parentNode.removeChild(i):(i||this.createDom(),Sf(this,t),this.createPath(t),n.length&&CE(t,n))},e.prototype.createPath=function(t,n){var i=this.attr(),a=this.get("el");xe(n||i,function(o,s){mr[s]&&a.setAttribute(mr[s],o)}),wf(this)},e}(Gw),kz=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="svg",t.canFill=!1,t.canStroke=!1,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return L(L({},t),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},e.prototype.afterAttrsChange=function(t){r.prototype.afterAttrsChange.call(this,t);var n=this.get("canvas");if(n&&n.get("autoDraw")){var i=n.get("context");this.draw(i,t)}},e.prototype.getShapeBase=function(){return Hp},e.prototype.getGroupBase=function(){return TE},e.prototype.onCanvasChange=function(t){AE(this,t)},e.prototype.calculateBBox=function(){var t=this.get("el"),n=null;if(t)n=t.getBBox();else{var i=zw(this.get("type"));i&&(n=i(this))}if(n){var a=n.x,o=n.y,s=n.width,u=n.height,l=this.getHitLineWidth(),f=l/2,c=a-f,h=o-f,d=a+s+f,v=o+u+f;return{x:c,y:h,minX:c,minY:h,maxX:d,maxY:v,width:s+l,height:u+l}}return{x:0,y:0,minX:0,minY:0,maxX:0,maxY:0,width:0,height:0}},e.prototype.isFill=function(){var t=this.attr(),n=t.fill,i=t.fillStyle;return(n||i||this.isClipShape())&&this.canFill},e.prototype.isStroke=function(){var t=this.attr(),n=t.stroke,i=t.strokeStyle;return(n||i)&&this.canStroke},e.prototype.draw=function(t,n){var i=this.get("el");this.get("destroyed")?i&&i.parentNode.removeChild(i):(i||SE(this),Sf(this,t),this.createPath(t,n),this.shadow(t,n),this.strokeAndFill(t,n),this.transform(n))},e.prototype.createPath=function(t,n){},e.prototype.strokeAndFill=function(t,n){var i=n||this.attr(),a=i.fill,o=i.fillStyle,s=i.stroke,u=i.strokeStyle,l=i.fillOpacity,f=i.strokeOpacity,c=i.lineWidth,h=this.get("el");this.canFill&&(n?"fill"in i?this._setColor(t,"fill",a):"fillStyle"in i&&this._setColor(t,"fill",o):this._setColor(t,"fill",a||o),l&&h.setAttribute(mr.fillOpacity,l)),this.canStroke&&c>0&&(n?"stroke"in i?this._setColor(t,"stroke",s):"strokeStyle"in i&&this._setColor(t,"stroke",u):this._setColor(t,"stroke",s||u),f&&h.setAttribute(mr.strokeOpacity,f),c&&h.setAttribute(mr.lineWidth,c))},e.prototype._setColor=function(t,n,i){var a=this.get("el");if(!i){a.setAttribute(mr[n],"none");return}if(i=i.trim(),/^[r,R,L,l]{1}[\s]*\(/.test(i)){var o=t.find("gradient",i);o||(o=t.addGradient(i)),a.setAttribute(mr[n],"url(#"+o+")")}else if(/^[p,P]{1}[\s]*\(/.test(i)){var o=t.find("pattern",i);o||(o=t.addPattern(i)),a.setAttribute(mr[n],"url(#"+o+")")}else a.setAttribute(mr[n],i)},e.prototype.shadow=function(t,n){var i=this.attr(),a=n||i,o=a.shadowOffsetX,s=a.shadowOffsetY,u=a.shadowBlur,l=a.shadowColor;(o||s||u||l)&&Iz(this,t)},e.prototype.transform=function(t){var n=this.attr(),i=(t||n).matrix;i&&wf(this)},e.prototype.isInShape=function(t,n){return this.isPointInPath(t,n)},e.prototype.isPointInPath=function(t,n){var i=this.get("el"),a=this.get("canvas"),o=a.get("el").getBoundingClientRect(),s=t+o.left,u=n+o.top,l=document.elementFromPoint(s,u);return!!(l&&l.isEqualNode(i))},e.prototype.getHitLineWidth=function(){var t=this.attrs,n=t.lineWidth,i=t.lineAppendWidth;return this.isStroke()?n+i:0},e}(Fw),zi=kz,Dz=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="circle",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return L(L({},t),{x:0,y:0,r:0})},e.prototype.createPath=function(t,n){var i=this.attr(),a=this.get("el");xe(n||i,function(o,s){s==="x"||s==="y"?a.setAttribute("c"+s,o):mr[s]&&a.setAttribute(mr[s],o)})},e}(zi),Pz=Dz,Nz=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="dom",t.canFill=!1,t.canStroke=!1,t}return e.prototype.createPath=function(t,n){var i=this.attr(),a=this.get("el");if(xe(n||i,function(l,f){mr[f]&&a.setAttribute(mr[f],l)}),typeof i.html=="function"){var o=i.html.call(this,i);if(o instanceof Element||o instanceof HTMLDocument){for(var s=a.childNodes,u=s.length-1;u>=0;u--)a.removeChild(s[u]);a.appendChild(o)}else a.innerHTML=o}else a.innerHTML=i.html},e}(zi),Lz=Nz,Oz=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="ellipse",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return L(L({},t),{x:0,y:0,rx:0,ry:0})},e.prototype.createPath=function(t,n){var i=this.attr(),a=this.get("el");xe(n||i,function(o,s){s==="x"||s==="y"?a.setAttribute("c"+s,o):mr[s]&&a.setAttribute(mr[s],o)})},e}(zi),Rz=Oz,Bz=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="image",t.canFill=!1,t.canStroke=!1,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return L(L({},t),{x:0,y:0,width:0,height:0})},e.prototype.createPath=function(t,n){var i=this,a=this.attr(),o=this.get("el");xe(n||a,function(s,u){u==="img"?i._setImage(a.img):mr[u]&&o.setAttribute(mr[u],s)})},e.prototype.setAttr=function(t,n){this.attrs[t]=n,t==="img"&&this._setImage(n)},e.prototype._setImage=function(t){var n=this.attr(),i=this.get("el");if(Xe(t))i.setAttribute("href",t);else if(t instanceof window.Image)n.width||(i.setAttribute("width",t.width),this.attr("width",t.width)),n.height||(i.setAttribute("height",t.height),this.attr("height",t.height)),i.setAttribute("href",t.src);else if(t instanceof HTMLElement&&Xe(t.nodeName)&&t.nodeName.toUpperCase()==="CANVAS")i.setAttribute("href",t.toDataURL());else if(t instanceof ImageData){var a=document.createElement("canvas");a.setAttribute("width",""+t.width),a.setAttribute("height",""+t.height),a.getContext("2d").putImageData(t,0,0),n.width||(i.setAttribute("width",""+t.width),this.attr("width",t.width)),n.height||(i.setAttribute("height",""+t.height),this.attr("height",t.height)),i.setAttribute("href",a.toDataURL())}},e}(zi),Gz=Bz,Fz=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="line",t.canFill=!1,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return L(L({},t),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},e.prototype.createPath=function(t,n){var i=this.attr(),a=this.get("el");xe(n||i,function(o,s){if(s==="startArrow"||s==="endArrow")if(o){var u=ri(o)?t.addArrow(i,mr[s]):t.getDefaultArrow(i,mr[s]);a.setAttribute(mr[s],"url(#"+u+")")}else a.removeAttribute(mr[s]);else mr[s]&&a.setAttribute(mr[s],o)})},e.prototype.getTotalLength=function(){var t=this.attr(),n=t.x1,i=t.y1,a=t.x2,o=t.y2;return Wn.length(n,i,a,o)},e.prototype.getPoint=function(t){var n=this.attr(),i=n.x1,a=n.y1,o=n.x2,s=n.y2;return Wn.pointAt(i,a,o,s,t)},e}(zi),Uz=Fz,vd={circle:function(r,e,t){return[["M",r,e],["m",-t,0],["a",t,t,0,1,0,t*2,0],["a",t,t,0,1,0,-t*2,0]]},square:function(r,e,t){return[["M",r-t,e-t],["L",r+t,e-t],["L",r+t,e+t],["L",r-t,e+t],["Z"]]},diamond:function(r,e,t){return[["M",r-t,e],["L",r,e-t],["L",r+t,e],["L",r,e+t],["Z"]]},triangle:function(r,e,t){var n=t*Math.sin(1/3*Math.PI);return[["M",r-t,e+n],["L",r,e-n],["L",r+t,e+n],["z"]]},triangleDown:function(r,e,t){var n=t*Math.sin(1/3*Math.PI);return[["M",r-t,e-n],["L",r+t,e-n],["L",r,e+n],["Z"]]}},ME={get:function(r){return vd[r]},register:function(r,e){vd[r]=e},remove:function(r){delete vd[r]},getAll:function(){return vd}},zz=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="marker",t.canFill=!0,t.canStroke=!0,t}return e.prototype.createPath=function(t){var n=this.get("el");n.setAttribute("d",this._assembleMarker())},e.prototype._assembleMarker=function(){var t=this._getPath();return At(t)?t.map(function(n){return n.join(" ")}).join(""):t},e.prototype._getPath=function(){var t=this.attr(),n=t.x,i=t.y,a=t.r||t.radius,o=t.symbol||"circle",s;return Kr(o)?s=o:s=ME.get(o),s?s(n,i,a):(console.warn(s+" symbol is not exist."),null)},e.symbolsFactory=ME,e}(zi),$z=zz,Vz=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="path",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return L(L({},t),{startArrow:!1,endArrow:!1})},e.prototype.createPath=function(t,n){var i=this,a=this.attr(),o=this.get("el");xe(n||a,function(s,u){if(u==="path"&&At(s))o.setAttribute("d",i._formatPath(s));else if(u==="startArrow"||u==="endArrow")if(s){var l=ri(s)?t.addArrow(a,mr[u]):t.getDefaultArrow(a,mr[u]);o.setAttribute(mr[u],"url(#"+l+")")}else o.removeAttribute(mr[u]);else mr[u]&&o.setAttribute(mr[u],s)})},e.prototype._formatPath=function(t){var n=t.map(function(i){return i.join(" ")}).join("");return~n.indexOf("NaN")?"":n},e.prototype.getTotalLength=function(){var t=this.get("el");return t?t.getTotalLength():null},e.prototype.getPoint=function(t){var n=this.get("el"),i=this.getTotalLength();if(i===0)return null;var a=n?n.getPointAtLength(t*i):null;return a?{x:a.x,y:a.y}:null},e}(zi),Wz=Vz,jz=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="polygon",t.canFill=!0,t.canStroke=!0,t}return e.prototype.createPath=function(t,n){var i=this.attr(),a=this.get("el");xe(n||i,function(o,s){s==="points"&&At(o)&&o.length>=2?a.setAttribute("points",o.map(function(u){return u[0]+","+u[1]}).join(" ")):mr[s]&&a.setAttribute(mr[s],o)})},e}(zi),Xz=jz,Hz=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="polyline",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return L(L({},t),{startArrow:!1,endArrow:!1})},e.prototype.onAttrChange=function(t,n,i){r.prototype.onAttrChange.call(this,t,n,i),["points"].indexOf(t)!==-1&&this._resetCache()},e.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},e.prototype.createPath=function(t,n){var i=this.attr(),a=this.get("el");xe(n||i,function(o,s){s==="points"&&At(o)&&o.length>=2?a.setAttribute("points",o.map(function(u){return u[0]+","+u[1]}).join(" ")):mr[s]&&a.setAttribute(mr[s],o)})},e.prototype.getTotalLength=function(){var t=this.attr().points,n=this.get("totalLength");return yt(n)?(this.set("totalLength",aS.length(t)),this.get("totalLength")):n},e.prototype.getPoint=function(t){var n=this.attr().points,i=this.get("tCache");i||(this._setTcache(),i=this.get("tCache"));var a,o;return xe(i,function(s,u){t>=s[0]&&t<=s[1]&&(a=(t-s[0])/(s[1]-s[0]),o=u)}),Wn.pointAt(n[o][0],n[o][1],n[o+1][0],n[o+1][1],a)},e.prototype._setTcache=function(){var t=this.attr().points;if(!(!t||t.length===0)){var n=this.getTotalLength();if(!(n<=0)){var i=0,a=[],o,s;xe(t,function(u,l){t[l+1]&&(o=[],o[0]=i/n,s=Wn.length(u[0],u[1],t[l+1][0],t[l+1][1]),i+=s,o[1]=i/n,a.push(o))}),this.set("tCache",a)}}},e.prototype.getStartTangent=function(){var t=this.attr().points,n=[];return n.push([t[1][0],t[1][1]]),n.push([t[0][0],t[0][1]]),n},e.prototype.getEndTangent=function(){var t=this.attr().points,n=t.length-1,i=[];return i.push([t[n-1][0],t[n-1][1]]),i.push([t[n][0],t[n][1]]),i},e}(zi),Yz=Hz;function qz(r){var e=0,t=0,n=0,i=0;return At(r)?r.length===1?e=t=n=i=r[0]:r.length===2?(e=n=r[0],t=i=r[1]):r.length===3?(e=r[0],t=i=r[1],n=r[2]):(e=r[0],t=r[1],n=r[2],i=r[3]):e=t=n=i=r,{r1:e,r2:t,r3:n,r4:i}}var Kz=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="rect",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return L(L({},t),{x:0,y:0,width:0,height:0,radius:0})},e.prototype.createPath=function(t,n){var i=this,a=this.attr(),o=this.get("el"),s=!1,u=["x","y","width","height","radius"];xe(n||a,function(l,f){u.indexOf(f)!==-1&&!s?(o.setAttribute("d",i._assembleRect(a)),s=!0):u.indexOf(f)===-1&&mr[f]&&o.setAttribute(mr[f],l)})},e.prototype._assembleRect=function(t){var n=t.x,i=t.y,a=t.width,o=t.height,s=t.radius;if(!s)return"M "+n+","+i+" l "+a+",0 l 0,"+o+" l"+-a+" 0 z";var u=qz(s);At(s)?s.length===1?u.r1=u.r2=u.r3=u.r4=s[0]:s.length===2?(u.r1=u.r3=s[0],u.r2=u.r4=s[1]):s.length===3?(u.r1=s[0],u.r2=u.r4=s[1],u.r3=s[2]):(u.r1=s[0],u.r2=s[1],u.r3=s[2],u.r4=s[3]):u.r1=u.r2=u.r3=u.r4=s;var l=[["M "+(n+u.r1)+","+i],["l "+(a-u.r1-u.r2)+",0"],["a "+u.r2+","+u.r2+",0,0,1,"+u.r2+","+u.r2],["l 0,"+(o-u.r2-u.r3)],["a "+u.r3+","+u.r3+",0,0,1,"+-u.r3+","+u.r3],["l "+(u.r3+u.r4-a)+",0"],["a "+u.r4+","+u.r4+",0,0,1,"+-u.r4+","+-u.r4],["l 0,"+(u.r4+u.r1-o)],["a "+u.r1+","+u.r1+",0,0,1,"+u.r1+","+-u.r1],["z"]];return l.join(" ")},e}(zi),Zz=Kz,IE=.3,Qz={top:"before-edge",middle:"central",bottom:"after-edge",alphabetic:"baseline",hanging:"hanging"},Jz={top:"text-before-edge",middle:"central",bottom:"text-after-edge",alphabetic:"alphabetic",hanging:"hanging"},e6={left:"left",start:"left",center:"middle",right:"end",end:"end"},t6=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="text",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return L(L({},t),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},e.prototype.createPath=function(t,n){var i=this,a=this.attr(),o=this.get("el");this._setFont(),xe(n||a,function(s,u){u==="text"?i._setText(""+s):u==="matrix"&&s?wf(i):mr[u]&&o.setAttribute(mr[u],s)}),o.setAttribute("paint-order","stroke"),o.setAttribute("style","stroke-linecap:butt; stroke-linejoin:miter;")},e.prototype._setFont=function(){var t=this.get("el"),n=this.attr(),i=n.textBaseline,a=n.textAlign,o=H_();o&&o.name==="firefox"?t.setAttribute("dominant-baseline",Jz[i]||"alphabetic"):t.setAttribute("alignment-baseline",Qz[i]||"baseline"),t.setAttribute("text-anchor",e6[a]||"left")},e.prototype._setText=function(t){var n=this.get("el"),i=this.attr(),a=i.x,o=i.textBaseline,s=o===void 0?"bottom":o;if(!t)n.innerHTML="";else if(~t.indexOf(`
`)){var u=t.split(`
`),l=u.length-1,f="";xe(u,function(c,h){h===0?s==="alphabetic"?f+='<tspan x="'+a+'" dy="'+-l+'em">'+c+"</tspan>":s==="top"?f+='<tspan x="'+a+'" dy="0.9em">'+c+"</tspan>":s==="middle"?f+='<tspan x="'+a+'" dy="'+-(l-1)/2+'em">'+c+"</tspan>":s==="bottom"?f+='<tspan x="'+a+'" dy="-'+(l+IE)+'em">'+c+"</tspan>":s==="hanging"&&(f+='<tspan x="'+a+'" dy="'+(-(l-1)-IE)+'em">'+c+"</tspan>"):f+='<tspan x="'+a+'" dy="1em">'+c+"</tspan>"}),n.innerHTML=f}else n.innerHTML=t},e}(zi),r6=t6,n6=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,i6=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,a6=/[\d.]+:(#[^\s]+|[^)]+\))/gi;function kE(r){var e=r.match(a6);if(!e)return"";var t="";return e.sort(function(n,i){return n=n.split(":"),i=i.split(":"),Number(n[0])-Number(i[0])}),xe(e,function(n){n=n.split(":"),t+='<stop offset="'+n[0]+'" stop-color="'+n[1]+'"></stop>'}),t}function o6(r,e){var t=n6.exec(r),n=hh(dh(parseFloat(t[1])),Math.PI*2),i=t[2],a,o;n>=0&&n<.5*Math.PI?(a={x:0,y:0},o={x:1,y:1}):.5*Math.PI<=n&&n<Math.PI?(a={x:1,y:0},o={x:0,y:1}):Math.PI<=n&&n<1.5*Math.PI?(a={x:1,y:1},o={x:0,y:0}):(a={x:0,y:1},o={x:1,y:0});var s=Math.tan(n),u=s*s,l=(o.x-a.x+s*(o.y-a.y))/(u+1)+a.x,f=s*(o.x-a.x+s*(o.y-a.y))/(u+1)+a.y;e.setAttribute("x1",a.x),e.setAttribute("y1",a.y),e.setAttribute("x2",l),e.setAttribute("y2",f),e.innerHTML=kE(i)}function s6(r,e){var t=i6.exec(r),n=parseFloat(t[1]),i=parseFloat(t[2]),a=parseFloat(t[3]),o=t[4];e.setAttribute("cx",n),e.setAttribute("cy",i),e.setAttribute("r",a),e.innerHTML=kE(o)}var u6=function(){function r(e){this.cfg={};var t=null,n=wa("gradient_");return e.toLowerCase()[0]==="l"?(t=Ui("linearGradient"),o6(e,t)):(t=Ui("radialGradient"),s6(e,t)),t.setAttribute("id",n),this.el=t,this.id=n,this.cfg=e,this}return r.prototype.match=function(e,t){return this.cfg===t},r}(),l6={shadowColor:"color",shadowOpacity:"opacity",shadowBlur:"blur",shadowOffsetX:"dx",shadowOffsetY:"dy"},f6={x:"-40%",y:"-40%",width:"200%",height:"200%"},c6=function(){function r(e){this.type="filter",this.cfg={},this.type="filter";var t=Ui("filter");return xe(f6,function(n,i){t.setAttribute(i,n)}),this.el=t,this.id=wa("filter_"),this.el.id=this.id,this.cfg=e,this._parseShadow(e,t),this}return r.prototype.match=function(e,t){if(this.type!==e)return!1;var n=!0,i=this.cfg;return xe(Object.keys(i),function(a){if(i[a]!==t[a])return n=!1,!1}),n},r.prototype.update=function(e,t){var n=this.cfg;return n[l6[e]]=t,this._parseShadow(n,this.el),this},r.prototype._parseShadow=function(e,t){var n=`<feDropShadow
      dx="`+(e.dx||0)+`"
      dy="`+(e.dy||0)+`"
      stdDeviation="`+(e.blur?e.blur/10:0)+`"
      flood-color="`+(e.color?e.color:"#000")+`"
      flood-opacity="`+(e.opacity?e.opacity:1)+`"
      />`;t.innerHTML=n},r}(),DE=function(){function r(e,t){this.cfg={};var n=Ui("marker"),i=wa("marker_");n.setAttribute("id",i);var a=Ui("path");a.setAttribute("stroke",e.stroke||"none"),a.setAttribute("fill",e.fill||"none"),n.appendChild(a),n.setAttribute("overflow","visible"),n.setAttribute("orient","auto-start-reverse"),this.el=n,this.child=a,this.id=i;var o=e[t==="marker-start"?"startArrow":"endArrow"];return this.stroke=e.stroke||"#000",o===!0?this._setDefaultPath(t,a):(this.cfg=o,this._setMarker(e.lineWidth,a)),this}return r.prototype.match=function(){return!1},r.prototype._setDefaultPath=function(e,t){var n=this.el;t.setAttribute("d","M0,0 L"+10*Math.cos(Math.PI/6)+",5 L0,10"),n.setAttribute("refX",""+10*Math.cos(Math.PI/6)),n.setAttribute("refY",""+5)},r.prototype._setMarker=function(e,t){var n=this.el,i=this.cfg.path,a=this.cfg.d;At(i)&&(i=i.map(function(o){return o.join(" ")}).join("")),t.setAttribute("d",i),n.appendChild(t),a&&n.setAttribute("refX",""+a/e)},r.prototype.update=function(e){var t=this.child;t.attr?t.attr("fill",e):t.setAttribute("fill",e)},r}(),h6=function(){function r(e){this.type="clip",this.cfg={};var t=Ui("clipPath");this.el=t,this.id=wa("clip_"),t.id=this.id;var n=e.cfg.el;return t.appendChild(n),this.cfg=e,this}return r.prototype.match=function(){return!1},r.prototype.remove=function(){var e=this.el;e.parentNode.removeChild(e)},r}(),d6=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,v6=function(){function r(e){this.cfg={};var t=Ui("pattern");t.setAttribute("patternUnits","userSpaceOnUse");var n=Ui("image");t.appendChild(n);var i=wa("pattern_");t.id=i,this.el=t,this.id=i,this.cfg=e;var a=d6.exec(e),o=a[2];n.setAttribute("href",o);var s=new Image;o.match(/^data:/i)||(s.crossOrigin="Anonymous"),s.src=o;function u(){t.setAttribute("width",""+s.width),t.setAttribute("height",""+s.height)}return s.complete?u():(s.onload=u,s.src=s.src),this}return r.prototype.match=function(e,t){return this.cfg===t},r}(),p6=function(){function r(e){var t=Ui("defs"),n=wa("defs_");t.id=n,e.appendChild(t),this.children=[],this.defaultArrow={},this.el=t,this.canvas=e}return r.prototype.find=function(e,t){for(var n=this.children,i=null,a=0;a<n.length;a++)if(n[a].match(e,t)){i=n[a].id;break}return i},r.prototype.findById=function(e){for(var t=this.children,n=null,i=0;i<t.length;i++)if(t[i].id===e){n=t[i];break}return n},r.prototype.add=function(e){this.children.push(e),e.canvas=this.canvas,e.parent=this},r.prototype.getDefaultArrow=function(e,t){var n=e.stroke||e.strokeStyle;if(this.defaultArrow[n])return this.defaultArrow[n].id;var i=new DE(e,t);return this.defaultArrow[n]=i,this.el.appendChild(i.el),this.add(i),i.id},r.prototype.addGradient=function(e){var t=new u6(e);return this.el.appendChild(t.el),this.add(t),t.id},r.prototype.addArrow=function(e,t){var n=new DE(e,t);return this.el.appendChild(n.el),this.add(n),n.id},r.prototype.addShadow=function(e){var t=new c6(e);return this.el.appendChild(t.el),this.add(t),t.id},r.prototype.addPattern=function(e){var t=new v6(e);return this.el.appendChild(t.el),this.add(t),t.id},r.prototype.addClip=function(e){var t=new h6(e);return this.el.appendChild(t.el),this.add(t),t.id},r}(),Ef=function(r){$t(e,r);function e(t){return r.call(this,L(L({},t),{autoDraw:!0,renderer:"svg"}))||this}return e.prototype.getShapeBase=function(){return Hp},e.prototype.getGroupBase=function(){return TE},e.prototype.getShape=function(t,n,i){var a=i.target||i.srcElement;if(!Gy[a.tagName]){for(var o=a.parentNode;o&&!Gy[o.tagName];)o=o.parentNode;a=o}return this.find(function(s){return s.get("el")===a})},e.prototype.createDom=function(){var t=Ui("svg"),n=new p6(t);return t.setAttribute("width",""+this.get("width")),t.setAttribute("height",""+this.get("height")),this.set("context",n),t},e.prototype.onCanvasChange=function(t){var n=this.get("context"),i=this.get("el");if(t==="sort"){var a=this.get("children");a&&a.length&&EE(this,function(s,u){return a.indexOf(s)-a.indexOf(u)?1:0})}else if(t==="clear"){if(i){i.innerHTML="";var o=n.el;o.innerHTML="",i.appendChild(o)}}else t==="matrix"?wf(this):t==="clip"?Sf(this,n):t==="changeSize"&&(i.setAttribute("width",""+this.get("width")),i.setAttribute("height",""+this.get("height")))},e.prototype.draw=function(){var t=this.get("context"),n=this.getChildren();Sf(this,t),n.length&&CE(t,n)},e}(Bw),na={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},g6=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")},Cf=xr(function(r){var e=Array.prototype.concat,t=Array.prototype.slice,n=r.exports=function(a){for(var o=[],s=0,u=a.length;s<u;s++){var l=a[s];g6(l)?o=e.call(o,t.call(l)):o.push(l)}return o};n.wrap=function(i){return function(){return i(n(arguments))}}}),As=xr(function(r){var e={};for(var t in na)na.hasOwnProperty(t)&&(e[na[t]]=t);var n=r.exports={to:{},get:{}};n.get=function(o){var s=o.substring(0,3).toLowerCase(),u,l;switch(s){case"hsl":u=n.get.hsl(o),l="hsl";break;case"hwb":u=n.get.hwb(o),l="hwb";break;default:u=n.get.rgb(o),l="rgb";break}return u?{model:l,value:u}:null},n.get.rgb=function(o){if(!o)return null;var s=/^#([a-f0-9]{3,4})$/i,u=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,l=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,f=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,c=/(\D+)/,h=[0,0,0,1],d,v,p;if(d=o.match(u)){for(p=d[2],d=d[1],v=0;v<3;v++){var g=v*2;h[v]=parseInt(d.slice(g,g+2),16)}p&&(h[3]=parseInt(p,16)/255)}else if(d=o.match(s)){for(d=d[1],p=d[3],v=0;v<3;v++)h[v]=parseInt(d[v]+d[v],16);p&&(h[3]=parseInt(p+p,16)/255)}else if(d=o.match(l)){for(v=0;v<3;v++)h[v]=parseInt(d[v+1],0);d[4]&&(h[3]=parseFloat(d[4]))}else if(d=o.match(f)){for(v=0;v<3;v++)h[v]=Math.round(parseFloat(d[v+1])*2.55);d[4]&&(h[3]=parseFloat(d[4]))}else return(d=o.match(c))?d[1]==="transparent"?[0,0,0,0]:(h=na[d[1]],h?(h[3]=1,h):null):null;for(v=0;v<3;v++)h[v]=i(h[v],0,255);return h[3]=i(h[3],0,1),h},n.get.hsl=function(o){if(!o)return null;var s=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?[\d\.]+)\s*)?\)$/,u=o.match(s);if(u){var l=parseFloat(u[4]),f=(parseFloat(u[1])+360)%360,c=i(parseFloat(u[2]),0,100),h=i(parseFloat(u[3]),0,100),d=i(isNaN(l)?1:l,0,1);return[f,c,h,d]}return null},n.get.hwb=function(o){if(!o)return null;var s=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,u=o.match(s);if(u){var l=parseFloat(u[4]),f=(parseFloat(u[1])%360+360)%360,c=i(parseFloat(u[2]),0,100),h=i(parseFloat(u[3]),0,100),d=i(isNaN(l)?1:l,0,1);return[f,c,h,d]}return null},n.to.hex=function(){var o=Cf(arguments);return"#"+a(o[0])+a(o[1])+a(o[2])+(o[3]<1?a(Math.round(o[3]*255)):"")},n.to.rgb=function(){var o=Cf(arguments);return o.length<4||o[3]===1?"rgb("+Math.round(o[0])+", "+Math.round(o[1])+", "+Math.round(o[2])+")":"rgba("+Math.round(o[0])+", "+Math.round(o[1])+", "+Math.round(o[2])+", "+o[3]+")"},n.to.rgb.percent=function(){var o=Cf(arguments),s=Math.round(o[0]/255*100),u=Math.round(o[1]/255*100),l=Math.round(o[2]/255*100);return o.length<4||o[3]===1?"rgb("+s+"%, "+u+"%, "+l+"%)":"rgba("+s+"%, "+u+"%, "+l+"%, "+o[3]+")"},n.to.hsl=function(){var o=Cf(arguments);return o.length<4||o[3]===1?"hsl("+o[0]+", "+o[1]+"%, "+o[2]+"%)":"hsla("+o[0]+", "+o[1]+"%, "+o[2]+"%, "+o[3]+")"},n.to.hwb=function(){var o=Cf(arguments),s="";return o.length>=4&&o[3]!==1&&(s=", "+o[3]),"hwb("+o[0]+", "+o[1]+"%, "+o[2]+"%"+s+")"},n.to.keyword=function(o){return e[o.slice(0,3)]};function i(o,s,u){return Math.min(Math.max(s,o),u)}function a(o){var s=o.toString(16).toUpperCase();return s.length<2?"0"+s:s}});As.to;As.get;var pn=xr(function(r){var e={};for(var t in na)na.hasOwnProperty(t)&&(e[na[t]]=t);var n=r.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var i in n)if(n.hasOwnProperty(i)){if(!("channels"in n[i]))throw new Error("missing channels property: "+i);if(!("labels"in n[i]))throw new Error("missing channel labels property: "+i);if(n[i].labels.length!==n[i].channels)throw new Error("channel and label counts mismatch: "+i);var a=n[i].channels,o=n[i].labels;delete n[i].channels,delete n[i].labels,Object.defineProperty(n[i],"channels",{value:a}),Object.defineProperty(n[i],"labels",{value:o})}n.rgb.hsl=function(u){var l=u[0]/255,f=u[1]/255,c=u[2]/255,h=Math.min(l,f,c),d=Math.max(l,f,c),v=d-h,p,g,y;return d===h?p=0:l===d?p=(f-c)/v:f===d?p=2+(c-l)/v:c===d&&(p=4+(l-f)/v),p=Math.min(p*60,360),p<0&&(p+=360),y=(h+d)/2,d===h?g=0:y<=.5?g=v/(d+h):g=v/(2-d-h),[p,g*100,y*100]},n.rgb.hsv=function(u){var l,f,c,h,d,v=u[0]/255,p=u[1]/255,g=u[2]/255,y=Math.max(v,p,g),m=y-Math.min(v,p,g),b=function(x){return(y-x)/6/m+1/2};return m===0?h=d=0:(d=m/y,l=b(v),f=b(p),c=b(g),v===y?h=c-f:p===y?h=1/3+l-c:g===y&&(h=2/3+f-l),h<0?h+=1:h>1&&(h-=1)),[h*360,d*100,y*100]},n.rgb.hwb=function(u){var l=u[0],f=u[1],c=u[2],h=n.rgb.hsl(u)[0],d=1/255*Math.min(l,Math.min(f,c));return c=1-1/255*Math.max(l,Math.max(f,c)),[h,d*100,c*100]},n.rgb.cmyk=function(u){var l=u[0]/255,f=u[1]/255,c=u[2]/255,h,d,v,p;return p=Math.min(1-l,1-f,1-c),h=(1-l-p)/(1-p)||0,d=(1-f-p)/(1-p)||0,v=(1-c-p)/(1-p)||0,[h*100,d*100,v*100,p*100]};function s(u,l){return Math.pow(u[0]-l[0],2)+Math.pow(u[1]-l[1],2)+Math.pow(u[2]-l[2],2)}n.rgb.keyword=function(u){var l=e[u];if(l)return l;var f=1/0,c;for(var h in na)if(na.hasOwnProperty(h)){var d=na[h],v=s(u,d);v<f&&(f=v,c=h)}return c},n.keyword.rgb=function(u){return na[u]},n.rgb.xyz=function(u){var l=u[0]/255,f=u[1]/255,c=u[2]/255;l=l>.04045?Math.pow((l+.055)/1.055,2.4):l/12.92,f=f>.04045?Math.pow((f+.055)/1.055,2.4):f/12.92,c=c>.04045?Math.pow((c+.055)/1.055,2.4):c/12.92;var h=l*.4124+f*.3576+c*.1805,d=l*.2126+f*.7152+c*.0722,v=l*.0193+f*.1192+c*.9505;return[h*100,d*100,v*100]},n.rgb.lab=function(u){var l=n.rgb.xyz(u),f=l[0],c=l[1],h=l[2],d,v,p;return f/=95.047,c/=100,h/=108.883,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,c=c>.008856?Math.pow(c,1/3):7.787*c+16/116,h=h>.008856?Math.pow(h,1/3):7.787*h+16/116,d=116*c-16,v=500*(f-c),p=200*(c-h),[d,v,p]},n.hsl.rgb=function(u){var l=u[0]/360,f=u[1]/100,c=u[2]/100,h,d,v,p,g;if(f===0)return g=c*255,[g,g,g];c<.5?d=c*(1+f):d=c+f-c*f,h=2*c-d,p=[0,0,0];for(var y=0;y<3;y++)v=l+1/3*-(y-1),v<0&&v++,v>1&&v--,6*v<1?g=h+(d-h)*6*v:2*v<1?g=d:3*v<2?g=h+(d-h)*(2/3-v)*6:g=h,p[y]=g*255;return p},n.hsl.hsv=function(u){var l=u[0],f=u[1]/100,c=u[2]/100,h=f,d=Math.max(c,.01),v,p;return c*=2,f*=c<=1?c:2-c,h*=d<=1?d:2-d,p=(c+f)/2,v=c===0?2*h/(d+h):2*f/(c+f),[l,v*100,p*100]},n.hsv.rgb=function(u){var l=u[0]/60,f=u[1]/100,c=u[2]/100,h=Math.floor(l)%6,d=l-Math.floor(l),v=255*c*(1-f),p=255*c*(1-f*d),g=255*c*(1-f*(1-d));switch(c*=255,h){case 0:return[c,g,v];case 1:return[p,c,v];case 2:return[v,c,g];case 3:return[v,p,c];case 4:return[g,v,c];case 5:return[c,v,p]}},n.hsv.hsl=function(u){var l=u[0],f=u[1]/100,c=u[2]/100,h=Math.max(c,.01),d,v,p;return p=(2-f)*c,d=(2-f)*h,v=f*h,v/=d<=1?d:2-d,v=v||0,p/=2,[l,v*100,p*100]},n.hwb.rgb=function(u){var l=u[0]/360,f=u[1]/100,c=u[2]/100,h=f+c,d,v,p,g;h>1&&(f/=h,c/=h),d=Math.floor(6*l),v=1-c,p=6*l-d,(d&1)!=0&&(p=1-p),g=f+p*(v-f);var y,m,b;switch(d){default:case 6:case 0:y=v,m=g,b=f;break;case 1:y=g,m=v,b=f;break;case 2:y=f,m=v,b=g;break;case 3:y=f,m=g,b=v;break;case 4:y=g,m=f,b=v;break;case 5:y=v,m=f,b=g;break}return[y*255,m*255,b*255]},n.cmyk.rgb=function(u){var l=u[0]/100,f=u[1]/100,c=u[2]/100,h=u[3]/100,d,v,p;return d=1-Math.min(1,l*(1-h)+h),v=1-Math.min(1,f*(1-h)+h),p=1-Math.min(1,c*(1-h)+h),[d*255,v*255,p*255]},n.xyz.rgb=function(u){var l=u[0]/100,f=u[1]/100,c=u[2]/100,h,d,v;return h=l*3.2406+f*-1.5372+c*-.4986,d=l*-.9689+f*1.8758+c*.0415,v=l*.0557+f*-.204+c*1.057,h=h>.0031308?1.055*Math.pow(h,1/2.4)-.055:h*12.92,d=d>.0031308?1.055*Math.pow(d,1/2.4)-.055:d*12.92,v=v>.0031308?1.055*Math.pow(v,1/2.4)-.055:v*12.92,h=Math.min(Math.max(0,h),1),d=Math.min(Math.max(0,d),1),v=Math.min(Math.max(0,v),1),[h*255,d*255,v*255]},n.xyz.lab=function(u){var l=u[0],f=u[1],c=u[2],h,d,v;return l/=95.047,f/=100,c/=108.883,l=l>.008856?Math.pow(l,1/3):7.787*l+16/116,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,c=c>.008856?Math.pow(c,1/3):7.787*c+16/116,h=116*f-16,d=500*(l-f),v=200*(f-c),[h,d,v]},n.lab.xyz=function(u){var l=u[0],f=u[1],c=u[2],h,d,v;d=(l+16)/116,h=f/500+d,v=d-c/200;var p=Math.pow(d,3),g=Math.pow(h,3),y=Math.pow(v,3);return d=p>.008856?p:(d-16/116)/7.787,h=g>.008856?g:(h-16/116)/7.787,v=y>.008856?y:(v-16/116)/7.787,h*=95.047,d*=100,v*=108.883,[h,d,v]},n.lab.lch=function(u){var l=u[0],f=u[1],c=u[2],h,d,v;return h=Math.atan2(c,f),d=h*360/2/Math.PI,d<0&&(d+=360),v=Math.sqrt(f*f+c*c),[l,v,d]},n.lch.lab=function(u){var l=u[0],f=u[1],c=u[2],h,d,v;return v=c/360*2*Math.PI,h=f*Math.cos(v),d=f*Math.sin(v),[l,h,d]},n.rgb.ansi16=function(u){var l=u[0],f=u[1],c=u[2],h=1 in arguments?arguments[1]:n.rgb.hsv(u)[2];if(h=Math.round(h/50),h===0)return 30;var d=30+(Math.round(c/255)<<2|Math.round(f/255)<<1|Math.round(l/255));return h===2&&(d+=60),d},n.hsv.ansi16=function(u){return n.rgb.ansi16(n.hsv.rgb(u),u[2])},n.rgb.ansi256=function(u){var l=u[0],f=u[1],c=u[2];if(l===f&&f===c)return l<8?16:l>248?231:Math.round((l-8)/247*24)+232;var h=16+36*Math.round(l/255*5)+6*Math.round(f/255*5)+Math.round(c/255*5);return h},n.ansi16.rgb=function(u){var l=u%10;if(l===0||l===7)return u>50&&(l+=3.5),l=l/10.5*255,[l,l,l];var f=(~~(u>50)+1)*.5,c=(l&1)*f*255,h=(l>>1&1)*f*255,d=(l>>2&1)*f*255;return[c,h,d]},n.ansi256.rgb=function(u){if(u>=232){var l=(u-232)*10+8;return[l,l,l]}u-=16;var f,c=Math.floor(u/36)/5*255,h=Math.floor((f=u%36)/6)/5*255,d=f%6/5*255;return[c,h,d]},n.rgb.hex=function(u){var l=((Math.round(u[0])&255)<<16)+((Math.round(u[1])&255)<<8)+(Math.round(u[2])&255),f=l.toString(16).toUpperCase();return"000000".substring(f.length)+f},n.hex.rgb=function(u){var l=u.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!l)return[0,0,0];var f=l[0];l[0].length===3&&(f=f.split("").map(function(p){return p+p}).join(""));var c=parseInt(f,16),h=c>>16&255,d=c>>8&255,v=c&255;return[h,d,v]},n.rgb.hcg=function(u){var l=u[0]/255,f=u[1]/255,c=u[2]/255,h=Math.max(Math.max(l,f),c),d=Math.min(Math.min(l,f),c),v=h-d,p,g;return v<1?p=d/(1-v):p=0,v<=0?g=0:h===l?g=(f-c)/v%6:h===f?g=2+(c-l)/v:g=4+(l-f)/v+4,g/=6,g%=1,[g*360,v*100,p*100]},n.hsl.hcg=function(u){var l=u[1]/100,f=u[2]/100,c=1,h=0;return f<.5?c=2*l*f:c=2*l*(1-f),c<1&&(h=(f-.5*c)/(1-c)),[u[0],c*100,h*100]},n.hsv.hcg=function(u){var l=u[1]/100,f=u[2]/100,c=l*f,h=0;return c<1&&(h=(f-c)/(1-c)),[u[0],c*100,h*100]},n.hcg.rgb=function(u){var l=u[0]/360,f=u[1]/100,c=u[2]/100;if(f===0)return[c*255,c*255,c*255];var h=[0,0,0],d=l%1*6,v=d%1,p=1-v,g=0;switch(Math.floor(d)){case 0:h[0]=1,h[1]=v,h[2]=0;break;case 1:h[0]=p,h[1]=1,h[2]=0;break;case 2:h[0]=0,h[1]=1,h[2]=v;break;case 3:h[0]=0,h[1]=p,h[2]=1;break;case 4:h[0]=v,h[1]=0,h[2]=1;break;default:h[0]=1,h[1]=0,h[2]=p}return g=(1-f)*c,[(f*h[0]+g)*255,(f*h[1]+g)*255,(f*h[2]+g)*255]},n.hcg.hsv=function(u){var l=u[1]/100,f=u[2]/100,c=l+f*(1-l),h=0;return c>0&&(h=l/c),[u[0],h*100,c*100]},n.hcg.hsl=function(u){var l=u[1]/100,f=u[2]/100,c=f*(1-l)+.5*l,h=0;return c>0&&c<.5?h=l/(2*c):c>=.5&&c<1&&(h=l/(2*(1-c))),[u[0],h*100,c*100]},n.hcg.hwb=function(u){var l=u[1]/100,f=u[2]/100,c=l+f*(1-l);return[u[0],(c-l)*100,(1-c)*100]},n.hwb.hcg=function(u){var l=u[1]/100,f=u[2]/100,c=1-f,h=c-l,d=0;return h<1&&(d=(c-h)/(1-h)),[u[0],h*100,d*100]},n.apple.rgb=function(u){return[u[0]/65535*255,u[1]/65535*255,u[2]/65535*255]},n.rgb.apple=function(u){return[u[0]/255*65535,u[1]/255*65535,u[2]/255*65535]},n.gray.rgb=function(u){return[u[0]/100*255,u[0]/100*255,u[0]/100*255]},n.gray.hsl=n.gray.hsv=function(u){return[0,0,u[0]]},n.gray.hwb=function(u){return[0,100,u[0]]},n.gray.cmyk=function(u){return[0,0,0,u[0]]},n.gray.lab=function(u){return[u[0],0,0]},n.gray.hex=function(u){var l=Math.round(u[0]/100*255)&255,f=(l<<16)+(l<<8)+l,c=f.toString(16).toUpperCase();return"000000".substring(c.length)+c},n.rgb.gray=function(u){var l=(u[0]+u[1]+u[2])/3;return[l/255*100]}});pn.rgb;pn.hsl;pn.hsv;pn.hwb;pn.cmyk;pn.xyz;pn.lab;pn.lch;pn.hex;pn.keyword;pn.ansi16;pn.ansi256;pn.hcg;pn.apple;pn.gray;function y6(){for(var r={},e=Object.keys(pn),t=e.length,n=0;n<t;n++)r[e[n]]={distance:-1,parent:null};return r}function m6(r){var e=y6(),t=[r];for(e[r].distance=0;t.length;)for(var n=t.pop(),i=Object.keys(pn[n]),a=i.length,o=0;o<a;o++){var s=i[o],u=e[s];u.distance===-1&&(u.distance=e[n].distance+1,u.parent=n,t.unshift(s))}return e}function b6(r,e){return function(t){return e(r(t))}}function x6(r,e){for(var t=[e[r].parent,r],n=pn[e[r].parent][r],i=e[r].parent;e[i].parent;)t.unshift(e[i].parent),n=b6(pn[e[i].parent][i],n),i=e[i].parent;return n.conversion=t,n}var _6=function(r){for(var e=m6(r),t={},n=Object.keys(e),i=n.length,a=0;a<i;a++){var o=n[a],s=e[o];s.parent!==null&&(t[o]=x6(o,e))}return t},Bu={},w6=Object.keys(pn);function S6(r){var e=function(t){return t==null?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),r(t))};return"conversion"in r&&(e.conversion=r.conversion),e}function E6(r){var e=function(t){if(t==null)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var n=r(t);if(typeof n=="object")for(var i=n.length,a=0;a<i;a++)n[a]=Math.round(n[a]);return n};return"conversion"in r&&(e.conversion=r.conversion),e}w6.forEach(function(r){Bu[r]={},Object.defineProperty(Bu[r],"channels",{value:pn[r].channels}),Object.defineProperty(Bu[r],"labels",{value:pn[r].labels});var e=_6(r),t=Object.keys(e);t.forEach(function(n){var i=e[n];Bu[r][n]=E6(i),Bu[r][n].raw=S6(i)})});var ki=Bu,Fy=[].slice,PE=["keyword","gray","hex"],Uy={};Object.keys(ki).forEach(function(r){Uy[Fy.call(ki[r].labels).sort().join("")]=r});var pd={};function Yn(r,e){if(!(this instanceof Yn))return new Yn(r,e);if(e&&e in PE&&(e=null),e&&!(e in ki))throw new Error("Unknown model: "+e);var t,n;if(r==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(r instanceof Yn)this.model=r.model,this.color=r.color.slice(),this.valpha=r.valpha;else if(typeof r=="string"){var i=As.get(r);if(i===null)throw new Error("Unable to parse color from string: "+r);this.model=i.model,n=ki[this.model].channels,this.color=i.value.slice(0,n),this.valpha=typeof i.value[n]=="number"?i.value[n]:1}else if(r.length){this.model=e||"rgb",n=ki[this.model].channels;var a=Fy.call(r,0,n);this.color=zy(a,n),this.valpha=typeof r[n]=="number"?r[n]:1}else if(typeof r=="number")r&=16777215,this.model="rgb",this.color=[r>>16&255,r>>8&255,r&255],this.valpha=1;else{this.valpha=1;var o=Object.keys(r);"alpha"in r&&(o.splice(o.indexOf("alpha"),1),this.valpha=typeof r.alpha=="number"?r.alpha:0);var s=o.sort().join("");if(!(s in Uy))throw new Error("Unable to parse color from object: "+JSON.stringify(r));this.model=Uy[s];var u=ki[this.model].labels,l=[];for(t=0;t<u.length;t++)l.push(r[u[t]]);this.color=zy(l)}if(pd[this.model])for(n=ki[this.model].channels,t=0;t<n;t++){var f=pd[this.model][t];f&&(this.color[t]=f(this.color[t]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}Yn.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(r){var e=this.model in As.to?this:this.rgb();e=e.round(typeof r=="number"?r:1);var t=e.valpha===1?e.color:e.color.concat(this.valpha);return As.to[e.model](t)},percentString:function(r){var e=this.rgb().round(typeof r=="number"?r:1),t=e.valpha===1?e.color:e.color.concat(this.valpha);return As.to.rgb.percent(t)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var r={},e=ki[this.model].channels,t=ki[this.model].labels,n=0;n<e;n++)r[t[n]]=this.color[n];return this.valpha!==1&&(r.alpha=this.valpha),r},unitArray:function(){var r=this.rgb().color;return r[0]/=255,r[1]/=255,r[2]/=255,this.valpha!==1&&r.push(this.valpha),r},unitObject:function(){var r=this.rgb().object();return r.r/=255,r.g/=255,r.b/=255,this.valpha!==1&&(r.alpha=this.valpha),r},round:function(r){return r=Math.max(r||0,0),new Yn(this.color.map(A6(r)).concat(this.valpha),this.model)},alpha:function(r){return arguments.length?new Yn(this.color.concat(Math.max(0,Math.min(1,r))),this.model):this.valpha},red:gn("rgb",0,Pn(255)),green:gn("rgb",1,Pn(255)),blue:gn("rgb",2,Pn(255)),hue:gn(["hsl","hsv","hsl","hwb","hcg"],0,function(r){return(r%360+360)%360}),saturationl:gn("hsl",1,Pn(100)),lightness:gn("hsl",2,Pn(100)),saturationv:gn("hsv",1,Pn(100)),value:gn("hsv",2,Pn(100)),chroma:gn("hcg",1,Pn(100)),gray:gn("hcg",2,Pn(100)),white:gn("hwb",1,Pn(100)),wblack:gn("hwb",2,Pn(100)),cyan:gn("cmyk",0,Pn(100)),magenta:gn("cmyk",1,Pn(100)),yellow:gn("cmyk",2,Pn(100)),black:gn("cmyk",3,Pn(100)),x:gn("xyz",0,Pn(100)),y:gn("xyz",1,Pn(100)),z:gn("xyz",2,Pn(100)),l:gn("lab",0,Pn(100)),a:gn("lab",1),b:gn("lab",2),keyword:function(r){return arguments.length?new Yn(r):ki[this.model].keyword(this.color)},hex:function(r){return arguments.length?new Yn(r):As.to.hex(this.rgb().round().color)},rgbNumber:function(){var r=this.rgb().color;return(r[0]&255)<<16|(r[1]&255)<<8|r[2]&255},luminosity:function(){for(var r=this.rgb().color,e=[],t=0;t<r.length;t++){var n=r[t]/255;e[t]=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}return .2126*e[0]+.7152*e[1]+.0722*e[2]},contrast:function(r){var e=this.luminosity(),t=r.luminosity();return e>t?(e+.05)/(t+.05):(t+.05)/(e+.05)},level:function(r){var e=this.contrast(r);return e>=7.1?"AAA":e>=4.5?"AA":""},isDark:function(){var r=this.rgb().color,e=(r[0]*299+r[1]*587+r[2]*114)/1e3;return e<128},isLight:function(){return!this.isDark()},negate:function(){for(var r=this.rgb(),e=0;e<3;e++)r.color[e]=255-r.color[e];return r},lighten:function(r){var e=this.hsl();return e.color[2]+=e.color[2]*r,e},darken:function(r){var e=this.hsl();return e.color[2]-=e.color[2]*r,e},saturate:function(r){var e=this.hsl();return e.color[1]+=e.color[1]*r,e},desaturate:function(r){var e=this.hsl();return e.color[1]-=e.color[1]*r,e},whiten:function(r){var e=this.hwb();return e.color[1]+=e.color[1]*r,e},blacken:function(r){var e=this.hwb();return e.color[2]+=e.color[2]*r,e},grayscale:function(){var r=this.rgb().color,e=r[0]*.3+r[1]*.59+r[2]*.11;return Yn.rgb(e,e,e)},fade:function(r){return this.alpha(this.valpha-this.valpha*r)},opaquer:function(r){return this.alpha(this.valpha+this.valpha*r)},rotate:function(r){var e=this.hsl(),t=e.color[0];return t=(t+r)%360,t=t<0?360+t:t,e.color[0]=t,e},mix:function(r,e){if(!r||!r.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof r);var t=r.rgb(),n=this.rgb(),i=e===void 0?.5:e,a=2*i-1,o=t.alpha()-n.alpha(),s=((a*o==-1?a:(a+o)/(1+a*o))+1)/2,u=1-s;return Yn.rgb(s*t.red()+u*n.red(),s*t.green()+u*n.green(),s*t.blue()+u*n.blue(),t.alpha()*i+n.alpha()*(1-i))}};Object.keys(ki).forEach(function(r){if(PE.indexOf(r)===-1){var e=ki[r].channels;Yn.prototype[r]=function(){if(this.model===r)return new Yn(this);if(arguments.length)return new Yn(arguments,r);var t=typeof arguments[e]=="number"?e:this.valpha;return new Yn(T6(ki[this.model][r].raw(this.color)).concat(t),r)},Yn[r]=function(t){return typeof t=="number"&&(t=zy(Fy.call(arguments),e)),new Yn(t,r)}}});function C6(r,e){return Number(r.toFixed(e))}function A6(r){return function(e){return C6(e,r)}}function gn(r,e,t){return r=Array.isArray(r)?r:[r],r.forEach(function(n){(pd[n]||(pd[n]=[]))[e]=t}),r=r[0],function(n){var i;return arguments.length?(t&&(n=t(n)),i=this[r](),i.color[e]=n,i):(i=this[r]().color[e],t&&(i=t(i)),i)}}function Pn(r){return function(e){return Math.max(0,Math.min(r,e))}}function T6(r){return Array.isArray(r)?r:[r]}function zy(r,e){for(var t=0;t<e;t++)typeof r[t]!="number"&&(r[t]=0);return r}var Af=Yn,gd=xr(function(r){(function(e){var t=/^\s+/,n=/\s+$/,i=0,a=e.round,o=e.min,s=e.max,u=e.random;function l(F,Z){if(F=F||"",Z=Z||{},F instanceof l)return F;if(!(this instanceof l))return new l(F,Z);var V=f(F);this._originalInput=F,this._r=V.r,this._g=V.g,this._b=V.b,this._a=V.a,this._roundA=a(100*this._a)/100,this._format=Z.format||V.format,this._gradientType=Z.gradientType,this._r<1&&(this._r=a(this._r)),this._g<1&&(this._g=a(this._g)),this._b<1&&(this._b=a(this._b)),this._ok=V.ok,this._tc_id=i++}l.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var F=this.toRgb();return(F.r*299+F.g*587+F.b*114)/1e3},getLuminance:function(){var F=this.toRgb(),Z,V,Fe,at,Me,ct;return Z=F.r/255,V=F.g/255,Fe=F.b/255,Z<=.03928?at=Z/12.92:at=e.pow((Z+.055)/1.055,2.4),V<=.03928?Me=V/12.92:Me=e.pow((V+.055)/1.055,2.4),Fe<=.03928?ct=Fe/12.92:ct=e.pow((Fe+.055)/1.055,2.4),.2126*at+.7152*Me+.0722*ct},setAlpha:function(F){return this._a=he(F),this._roundA=a(100*this._a)/100,this},toHsv:function(){var F=v(this._r,this._g,this._b);return{h:F.h*360,s:F.s,v:F.v,a:this._a}},toHsvString:function(){var F=v(this._r,this._g,this._b),Z=a(F.h*360),V=a(F.s*100),Fe=a(F.v*100);return this._a==1?"hsv("+Z+", "+V+"%, "+Fe+"%)":"hsva("+Z+", "+V+"%, "+Fe+"%, "+this._roundA+")"},toHsl:function(){var F=h(this._r,this._g,this._b);return{h:F.h*360,s:F.s,l:F.l,a:this._a}},toHslString:function(){var F=h(this._r,this._g,this._b),Z=a(F.h*360),V=a(F.s*100),Fe=a(F.l*100);return this._a==1?"hsl("+Z+", "+V+"%, "+Fe+"%)":"hsla("+Z+", "+V+"%, "+Fe+"%, "+this._roundA+")"},toHex:function(F){return g(this._r,this._g,this._b,F)},toHexString:function(F){return"#"+this.toHex(F)},toHex8:function(F){return y(this._r,this._g,this._b,this._a,F)},toHex8String:function(F){return"#"+this.toHex8(F)},toRgb:function(){return{r:a(this._r),g:a(this._g),b:a(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+a(this._r)+", "+a(this._g)+", "+a(this._b)+")":"rgba("+a(this._r)+", "+a(this._g)+", "+a(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:a(te(this._r,255)*100)+"%",g:a(te(this._g,255)*100)+"%",b:a(te(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+a(te(this._r,255)*100)+"%, "+a(te(this._g,255)*100)+"%, "+a(te(this._b,255)*100)+"%)":"rgba("+a(te(this._r,255)*100)+"%, "+a(te(this._g,255)*100)+"%, "+a(te(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:K[g(this._r,this._g,this._b,!0)]||!1},toFilter:function(F){var Z="#"+m(this._r,this._g,this._b,this._a),V=Z,Fe=this._gradientType?"GradientType = 1, ":"";if(F){var at=l(F);V="#"+m(at._r,at._g,at._b,at._a)}return"progid:DXImageTransform.Microsoft.gradient("+Fe+"startColorstr="+Z+",endColorstr="+V+")"},toString:function(F){var Z=!!F;F=F||this._format;var V=!1,Fe=this._a<1&&this._a>=0,at=!Z&&Fe&&(F==="hex"||F==="hex6"||F==="hex3"||F==="hex4"||F==="hex8"||F==="name");return at?F==="name"&&this._a===0?this.toName():this.toRgbString():(F==="rgb"&&(V=this.toRgbString()),F==="prgb"&&(V=this.toPercentageRgbString()),(F==="hex"||F==="hex6")&&(V=this.toHexString()),F==="hex3"&&(V=this.toHexString(!0)),F==="hex4"&&(V=this.toHex8String(!0)),F==="hex8"&&(V=this.toHex8String()),F==="name"&&(V=this.toName()),F==="hsl"&&(V=this.toHslString()),F==="hsv"&&(V=this.toHsvString()),V||this.toHexString())},clone:function(){return l(this.toString())},_applyModification:function(F,Z){var V=F.apply(null,[this].concat([].slice.call(Z)));return this._r=V._r,this._g=V._g,this._b=V._b,this.setAlpha(V._a),this},lighten:function(){return this._applyModification(S,arguments)},brighten:function(){return this._applyModification(E,arguments)},darken:function(){return this._applyModification(C,arguments)},desaturate:function(){return this._applyModification(b,arguments)},saturate:function(){return this._applyModification(x,arguments)},greyscale:function(){return this._applyModification(_,arguments)},spin:function(){return this._applyModification(M,arguments)},_applyCombination:function(F,Z){return F.apply(null,[this].concat([].slice.call(Z)))},analogous:function(){return this._applyCombination(O,arguments)},complement:function(){return this._applyCombination(w,arguments)},monochromatic:function(){return this._applyCombination(U,arguments)},splitcomplement:function(){return this._applyCombination(k,arguments)},triad:function(){return this._applyCombination(T,arguments)},tetrad:function(){return this._applyCombination(I,arguments)}},l.fromRatio=function(F,Z){if(typeof F=="object"){var V={};for(var Fe in F)F.hasOwnProperty(Fe)&&(Fe==="a"?V[Fe]=F[Fe]:V[Fe]=Ge(F[Fe]));F=V}return l(F,Z)};function f(F){var Z={r:0,g:0,b:0},V=1,Fe=null,at=null,Me=null,ct=!1,Ye=!1;return typeof F=="string"&&(F=pt(F)),typeof F=="object"&&(ut(F.r)&&ut(F.g)&&ut(F.b)?(Z=c(F.r,F.g,F.b),ct=!0,Ye=String(F.r).substr(-1)==="%"?"prgb":"rgb"):ut(F.h)&&ut(F.s)&&ut(F.v)?(Fe=Ge(F.s),at=Ge(F.v),Z=p(F.h,Fe,at),ct=!0,Ye="hsv"):ut(F.h)&&ut(F.s)&&ut(F.l)&&(Fe=Ge(F.s),Me=Ge(F.l),Z=d(F.h,Fe,Me),ct=!0,Ye="hsl"),F.hasOwnProperty("a")&&(V=F.a)),V=he(V),{ok:ct,format:F.format||Ye,r:o(255,s(Z.r,0)),g:o(255,s(Z.g,0)),b:o(255,s(Z.b,0)),a:V}}function c(F,Z,V){return{r:te(F,255)*255,g:te(Z,255)*255,b:te(V,255)*255}}function h(F,Z,V){F=te(F,255),Z=te(Z,255),V=te(V,255);var Fe=s(F,Z,V),at=o(F,Z,V),Me,ct,Ye=(Fe+at)/2;if(Fe==at)Me=ct=0;else{var nt=Fe-at;switch(ct=Ye>.5?nt/(2-Fe-at):nt/(Fe+at),Fe){case F:Me=(Z-V)/nt+(Z<V?6:0);break;case Z:Me=(V-F)/nt+2;break;case V:Me=(F-Z)/nt+4;break}Me/=6}return{h:Me,s:ct,l:Ye}}function d(F,Z,V){var Fe,at,Me;F=te(F,360),Z=te(Z,100),V=te(V,100);function ct(Et,D,ee){return ee<0&&(ee+=1),ee>1&&(ee-=1),ee<1/6?Et+(D-Et)*6*ee:ee<1/2?D:ee<2/3?Et+(D-Et)*(2/3-ee)*6:Et}if(Z===0)Fe=at=Me=V;else{var Ye=V<.5?V*(1+Z):V+Z-V*Z,nt=2*V-Ye;Fe=ct(nt,Ye,F+1/3),at=ct(nt,Ye,F),Me=ct(nt,Ye,F-1/3)}return{r:Fe*255,g:at*255,b:Me*255}}function v(F,Z,V){F=te(F,255),Z=te(Z,255),V=te(V,255);var Fe=s(F,Z,V),at=o(F,Z,V),Me,ct,Ye=Fe,nt=Fe-at;if(ct=Fe===0?0:nt/Fe,Fe==at)Me=0;else{switch(Fe){case F:Me=(Z-V)/nt+(Z<V?6:0);break;case Z:Me=(V-F)/nt+2;break;case V:Me=(F-Z)/nt+4;break}Me/=6}return{h:Me,s:ct,v:Ye}}function p(F,Z,V){F=te(F,360)*6,Z=te(Z,100),V=te(V,100);var Fe=e.floor(F),at=F-Fe,Me=V*(1-Z),ct=V*(1-at*Z),Ye=V*(1-(1-at)*Z),nt=Fe%6,Et=[V,ct,Me,Me,Ye,V][nt],D=[Ye,V,V,ct,Me,Me][nt],ee=[Me,Me,Ye,V,V,ct][nt];return{r:Et*255,g:D*255,b:ee*255}}function g(F,Z,V,Fe){var at=[pe(a(F).toString(16)),pe(a(Z).toString(16)),pe(a(V).toString(16))];return Fe&&at[0].charAt(0)==at[0].charAt(1)&&at[1].charAt(0)==at[1].charAt(1)&&at[2].charAt(0)==at[2].charAt(1)?at[0].charAt(0)+at[1].charAt(0)+at[2].charAt(0):at.join("")}function y(F,Z,V,Fe,at){var Me=[pe(a(F).toString(16)),pe(a(Z).toString(16)),pe(a(V).toString(16)),pe(ke(Fe))];return at&&Me[0].charAt(0)==Me[0].charAt(1)&&Me[1].charAt(0)==Me[1].charAt(1)&&Me[2].charAt(0)==Me[2].charAt(1)&&Me[3].charAt(0)==Me[3].charAt(1)?Me[0].charAt(0)+Me[1].charAt(0)+Me[2].charAt(0)+Me[3].charAt(0):Me.join("")}function m(F,Z,V,Fe){var at=[pe(ke(Fe)),pe(a(F).toString(16)),pe(a(Z).toString(16)),pe(a(V).toString(16))];return at.join("")}l.equals=function(F,Z){return!F||!Z?!1:l(F).toRgbString()==l(Z).toRgbString()},l.random=function(){return l.fromRatio({r:u(),g:u(),b:u()})};function b(F,Z){Z=Z===0?0:Z||10;var V=l(F).toHsl();return V.s-=Z/100,V.s=se(V.s),l(V)}function x(F,Z){Z=Z===0?0:Z||10;var V=l(F).toHsl();return V.s+=Z/100,V.s=se(V.s),l(V)}function _(F){return l(F).desaturate(100)}function S(F,Z){Z=Z===0?0:Z||10;var V=l(F).toHsl();return V.l+=Z/100,V.l=se(V.l),l(V)}function E(F,Z){Z=Z===0?0:Z||10;var V=l(F).toRgb();return V.r=s(0,o(255,V.r-a(255*-(Z/100)))),V.g=s(0,o(255,V.g-a(255*-(Z/100)))),V.b=s(0,o(255,V.b-a(255*-(Z/100)))),l(V)}function C(F,Z){Z=Z===0?0:Z||10;var V=l(F).toHsl();return V.l-=Z/100,V.l=se(V.l),l(V)}function M(F,Z){var V=l(F).toHsl(),Fe=(V.h+Z)%360;return V.h=Fe<0?360+Fe:Fe,l(V)}function w(F){var Z=l(F).toHsl();return Z.h=(Z.h+180)%360,l(Z)}function T(F){var Z=l(F).toHsl(),V=Z.h;return[l(F),l({h:(V+120)%360,s:Z.s,l:Z.l}),l({h:(V+240)%360,s:Z.s,l:Z.l})]}function I(F){var Z=l(F).toHsl(),V=Z.h;return[l(F),l({h:(V+90)%360,s:Z.s,l:Z.l}),l({h:(V+180)%360,s:Z.s,l:Z.l}),l({h:(V+270)%360,s:Z.s,l:Z.l})]}function k(F){var Z=l(F).toHsl(),V=Z.h;return[l(F),l({h:(V+72)%360,s:Z.s,l:Z.l}),l({h:(V+216)%360,s:Z.s,l:Z.l})]}function O(F,Z,V){Z=Z||6,V=V||30;var Fe=l(F).toHsl(),at=360/V,Me=[l(F)];for(Fe.h=(Fe.h-(at*Z>>1)+720)%360;--Z;)Fe.h=(Fe.h+at)%360,Me.push(l(Fe));return Me}function U(F,Z){Z=Z||6;for(var V=l(F).toHsv(),Fe=V.h,at=V.s,Me=V.v,ct=[],Ye=1/Z;Z--;)ct.push(l({h:Fe,s:at,v:Me})),Me=(Me+Ye)%1;return ct}l.mix=function(F,Z,V){V=V===0?0:V||50;var Fe=l(F).toRgb(),at=l(Z).toRgb(),Me=V/100,ct={r:(at.r-Fe.r)*Me+Fe.r,g:(at.g-Fe.g)*Me+Fe.g,b:(at.b-Fe.b)*Me+Fe.b,a:(at.a-Fe.a)*Me+Fe.a};return l(ct)},l.readability=function(F,Z){var V=l(F),Fe=l(Z);return(e.max(V.getLuminance(),Fe.getLuminance())+.05)/(e.min(V.getLuminance(),Fe.getLuminance())+.05)},l.isReadable=function(F,Z,V){var Fe=l.readability(F,Z),at,Me;switch(Me=!1,at=qt(V),at.level+at.size){case"AAsmall":case"AAAlarge":Me=Fe>=4.5;break;case"AAlarge":Me=Fe>=3;break;case"AAAsmall":Me=Fe>=7;break}return Me},l.mostReadable=function(F,Z,V){var Fe=null,at=0,Me,ct,Ye,nt;V=V||{},ct=V.includeFallbackColors,Ye=V.level,nt=V.size;for(var Et=0;Et<Z.length;Et++)Me=l.readability(F,Z[Et]),Me>at&&(at=Me,Fe=l(Z[Et]));return l.isReadable(F,Fe,{level:Ye,size:nt})||!ct?Fe:(V.includeFallbackColors=!1,l.mostReadable(F,["#fff","#000"],V))};var q=l.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},K=l.hexNames=le(q);function le(F){var Z={};for(var V in F)F.hasOwnProperty(V)&&(Z[F[V]]=V);return Z}function he(F){return F=parseFloat(F),(isNaN(F)||F<0||F>1)&&(F=1),F}function te(F,Z){Se(F)&&(F="100%");var V=ne(F);return F=o(Z,s(0,parseFloat(F))),V&&(F=parseInt(F*Z,10)/100),e.abs(F-Z)<1e-6?1:F%Z/parseFloat(Z)}function se(F){return o(1,s(0,F))}function ge(F){return parseInt(F,16)}function Se(F){return typeof F=="string"&&F.indexOf(".")!=-1&&parseFloat(F)===1}function ne(F){return typeof F=="string"&&F.indexOf("%")!=-1}function pe(F){return F.length==1?"0"+F:""+F}function Ge(F){return F<=1&&(F=F*100+"%"),F}function ke(F){return e.round(parseFloat(F)*255).toString(16)}function rt(F){return ge(F)/255}var $e=function(){var F="[-\\+]?\\d+%?",Z="[-\\+]?\\d*\\.\\d+%?",V="(?:"+Z+")|(?:"+F+")",Fe="[\\s|\\(]+("+V+")[,|\\s]+("+V+")[,|\\s]+("+V+")\\s*\\)?",at="[\\s|\\(]+("+V+")[,|\\s]+("+V+")[,|\\s]+("+V+")[,|\\s]+("+V+")\\s*\\)?";return{CSS_UNIT:new RegExp(V),rgb:new RegExp("rgb"+Fe),rgba:new RegExp("rgba"+at),hsl:new RegExp("hsl"+Fe),hsla:new RegExp("hsla"+at),hsv:new RegExp("hsv"+Fe),hsva:new RegExp("hsva"+at),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function ut(F){return!!$e.CSS_UNIT.exec(F)}function pt(F){F=F.replace(t,"").replace(n,"").toLowerCase();var Z=!1;if(q[F])F=q[F],Z=!0;else if(F=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var V;return(V=$e.rgb.exec(F))?{r:V[1],g:V[2],b:V[3]}:(V=$e.rgba.exec(F))?{r:V[1],g:V[2],b:V[3],a:V[4]}:(V=$e.hsl.exec(F))?{h:V[1],s:V[2],l:V[3]}:(V=$e.hsla.exec(F))?{h:V[1],s:V[2],l:V[3],a:V[4]}:(V=$e.hsv.exec(F))?{h:V[1],s:V[2],v:V[3]}:(V=$e.hsva.exec(F))?{h:V[1],s:V[2],v:V[3],a:V[4]}:(V=$e.hex8.exec(F))?{r:ge(V[1]),g:ge(V[2]),b:ge(V[3]),a:rt(V[4]),format:Z?"name":"hex8"}:(V=$e.hex6.exec(F))?{r:ge(V[1]),g:ge(V[2]),b:ge(V[3]),format:Z?"name":"hex"}:(V=$e.hex4.exec(F))?{r:ge(V[1]+""+V[1]),g:ge(V[2]+""+V[2]),b:ge(V[3]+""+V[3]),a:rt(V[4]+""+V[4]),format:Z?"name":"hex8"}:(V=$e.hex3.exec(F))?{r:ge(V[1]+""+V[1]),g:ge(V[2]+""+V[2]),b:ge(V[3]+""+V[3]),format:Z?"name":"hex"}:!1}function qt(F){var Z,V;return F=F||{level:"AA",size:"small"},Z=(F.level||"AA").toUpperCase(),V=(F.size||"small").toLowerCase(),Z!=="AA"&&Z!=="AAA"&&(Z="AA"),V!=="small"&&V!=="large"&&(V="small"),{level:Z,size:V}}r.exports?r.exports=l:window.tinycolor=l})(Math)}),yd=2,NE=.16,M6=.05,I6=.05,k6=.15,LE=5,OE=4,D6=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function RE(r,e,t){var n;return Math.round(r.h)>=60&&Math.round(r.h)<=240?n=t?Math.round(r.h)-yd*e:Math.round(r.h)+yd*e:n=t?Math.round(r.h)+yd*e:Math.round(r.h)-yd*e,n<0?n+=360:n>=360&&(n-=360),n}function BE(r,e,t){if(r.h===0&&r.s===0)return r.s;var n;return t?n=r.s-NE*e:e===OE?n=r.s+NE:n=r.s+M6*e,n>1&&(n=1),t&&e===LE&&n>.1&&(n=.1),n<.06&&(n=.06),Number(n.toFixed(2))}function GE(r,e,t){var n;return t?n=r.v+I6*e:n=r.v-k6*e,n>1&&(n=1),Number(n.toFixed(2))}function md(r){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=[],n=gd(r),i=LE;i>0;i-=1){var a=n.toHsv(),o=gd({h:RE(a,i,!0),s:BE(a,i,!0),v:GE(a,i,!0)}).toHexString();t.push(o)}t.push(n.toHexString());for(var s=1;s<=OE;s+=1){var u=n.toHsv(),l=gd({h:RE(u,s),s:BE(u,s),v:GE(u,s)}).toHexString();t.push(l)}return e.theme==="dark"?D6.map(function(f){var c=f.index,h=f.opacity,d=gd.mix(e.backgroundColor||"#141414",t[c],h*100).toHexString();return d}):t}var $y={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1890FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},ii={},Vy={};Object.keys($y).forEach(function(r){ii[r]=md($y[r]),ii[r].primary=ii[r][5],Vy[r]=md($y[r],{theme:"dark",backgroundColor:"#141414"}),Vy[r].primary=Vy[r][5]});ii.red;ii.volcano;ii.gold;ii.orange;ii.yellow;ii.lime;ii.green;ii.cyan;ii.blue;ii.geekblue;ii.purple;ii.magenta;ii.grey;var Nn=function(e,t,n){var i=Af(e),a=Af(t);return Af([(1-n)*i.red()+n*a.red(),(1-n)*i.green()+n*a.green(),(1-n)*i.blue()+n*a.blue()]).rgb()},P6=function(e,t,n){t===void 0&&(t="#fff"),n===void 0&&(n="rgb(150, 150, 150)");var i=Nn(t,e,.05).rgb().toString(),a=Nn(t,e,.1).rgb().toString(),o=Nn(t,e,.2).rgb().toString(),s=Nn(t,e,.4).rgb().toString(),u=Nn(t,n,.02).rgb().toString(),l=Nn(t,n,.05).rgb().toString(),f=Nn(t,n,.1).rgb().toString(),c=Nn(t,n,.2).rgb().toString(),h=Nn(t,n,.3).rgb().toString(),d=md(e,{theme:"default",backgroundColor:t}),v=Af(e).hex().toLowerCase(),p=d.indexOf(v),g=e;return p!==-1&&(g=d[p+1]),{mainStroke:e,mainFill:a,activeStroke:e,activeFill:i,inactiveStroke:s,inactiveFill:i,selectedStroke:e,selectedFill:t,highlightStroke:g,highlightFill:o,disableStroke:h,disableFill:l,edgeMainStroke:h,edgeActiveStroke:e,edgeInactiveStroke:c,edgeSelectedStroke:e,edgeHighlightStroke:e,edgeDisableStroke:f,comboMainStroke:h,comboMainFill:u,comboActiveStroke:e,comboActiveFill:i,comboInactiveStroke:h,comboInactiveFill:u,comboSelectedStroke:e,comboSelectedFill:u,comboHighlightStroke:g,comboHighlightFill:u,comboDisableStroke:c,comboDisableFill:l}},N6=function(e,t,n){t===void 0&&(t="#fff"),n===void 0&&(n="#777");var i=Nn(t,e,.2).rgb().toString(),a=Nn(t,e,.3).rgb().toString(),o=Nn(t,e,.6).rgb().toString(),s=Nn(t,e,.8).rgb().toString(),u=Nn(t,n,.2).rgb().toString(),l=Nn(t,n,.25).rgb().toString(),f=Nn(t,n,.3).rgb().toString(),c=Nn(t,n,.4).rgb().toString(),h=Nn(t,n,.5).rgb().toString(),d=md(e,{theme:"dark",backgroundColor:t}),v=Af(e).hex().toLowerCase(),p=d.indexOf(v),g=e;return p!==-1&&(g=d[p+1]),{mainStroke:s,mainFill:i,activeStroke:e,activeFill:a,inactiveStroke:s,inactiveFill:i,selectedStroke:e,selectedFill:i,highlightStroke:e,highlightFill:o,disableStroke:h,disableFill:l,edgeMainStroke:n,edgeActiveStroke:e,edgeInactiveStroke:n,edgeSelectedStroke:e,edgeHighlightStroke:e,edgeDisableStroke:f,comboMainStroke:c,comboMainFill:l,comboActiveStroke:e,comboActiveFill:u,comboInactiveStroke:c,comboInactiveFill:l,comboSelectedStroke:e,comboSelectedFill:u,comboHighlightStroke:g,comboHighlightFill:l,comboDisableStroke:c,comboDisableFill:u}},Wy=function(e,t,n,i){return t===void 0&&(t="#fff"),n===void 0&&(n="default"),n==="default"?P6(e,t,"rgb(150, 150, 150)"):N6(e,t,"#777")},L6=function(e,t,n,i){t===void 0&&(t="#fff"),n===void 0&&(n="default");var a=[];return e.forEach(function(o){a.push(Wy(o,t,n))}),a},O6=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",mixColor:Nn,getColorsWithSubjectColor:Wy,getColorSetsBySubjectColors:L6}),R6="rgb(95, 149, 255)",B6="rgb(255, 255, 255)",FE="rgb(0, 0, 0)",lr=Wy(R6,B6),Ts={version:"0.3.11",rootContainerClassName:"root-container",nodeContainerClassName:"node-container",edgeContainerClassName:"edge-container",comboContainerClassName:"combo-container",delegateContainerClassName:"delegate-container",defaultLoopPosition:"top",nodeLabel:{style:{fill:"#000",fontSize:12,textAlign:"center",textBaseline:"middle"},offset:4},defaultNode:{type:"circle",style:{lineWidth:1,stroke:lr.mainStroke,fill:lr.mainFill},size:20,color:lr.mainStroke,linkPoints:{size:8,lineWidth:1,fill:lr.activeFill,stroke:lr.activeStroke}},nodeStateStyles:{active:{fill:lr.activeFill,stroke:lr.activeStroke,lineWidth:2,shadowColor:lr.mainStroke,shadowBlur:10},selected:{fill:lr.selectedFill,stroke:lr.selectedStroke,lineWidth:4,shadowColor:lr.selectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{fill:lr.highlightFill,stroke:lr.highlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{fill:lr.inactiveFill,stroke:lr.inactiveStroke,lineWidth:1},disable:{fill:lr.disableFill,stroke:lr.disableStroke,lineWidth:1}},edgeLabel:{style:{fill:FE,textAlign:"center",textBaseline:"middle",fontSize:12}},defaultEdge:{type:"line",size:1,style:{stroke:lr.edgeMainStroke,lineAppendWidth:2},color:lr.edgeMainStroke},edgeStateStyles:{active:{stroke:lr.edgeActiveStroke,lineWidth:1},selected:{stroke:lr.edgeSelectedStroke,lineWidth:2,shadowColor:lr.edgeSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:lr.edgeHighlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{stroke:lr.edgeInactiveStroke,lineWidth:1},disable:{stroke:lr.edgeDisableStroke,lineWidth:1}},comboLabel:{style:{fill:FE,textBaseline:"middle",fontSize:12},refY:10,refX:10},defaultCombo:{type:"circle",style:{fill:lr.comboMainFill,lineWidth:1,stroke:lr.comboMainStroke,r:5,width:20,height:10},size:[20,5],color:lr.comboMainStroke,padding:[25,20,15,20]},comboStateStyles:{active:{stroke:lr.comboActiveStroke,lineWidth:1,fill:lr.comboActiveFill},selected:{stroke:lr.comboSelectedStroke,lineWidth:2,fill:lr.comboSelectedFill,shadowColor:lr.comboSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:lr.comboHighlightStroke,lineWidth:2,fill:lr.comboHighlightFill,"text-shape":{fontWeight:500}},inactive:{stroke:lr.comboInactiveStroke,fill:lr.comboInactiveFill,lineWidth:1},disable:{stroke:lr.comboDisableStroke,fill:lr.comboDisableFill,lineWidth:1}},delegateStyle:{fill:"#F3F9FF",fillOpacity:.5,stroke:"#1890FF",strokeOpacity:.9,lineDash:[5,5]},textWaterMarkerConfig:{width:150,height:100,compatible:!1,text:{x:0,y:60,lineHeight:20,rotate:20,fontSize:14,fontFamily:"Microsoft YaHei",fill:"rgba(0, 0, 0, 0.1)",baseline:"Middle"}},imageWaterMarkerConfig:{width:150,height:130,compatible:!1,image:{x:0,y:0,width:30,height:20,rotate:0}},waterMarkerImage:"https://gw.alipayobjects.com/os/s/prod/antv/assets/image/logo-with-text-73b8a.svg"};function Tf(r,e,t){if(r){if(typeof r.addEventListener=="function")return r.addEventListener(e,t,!1),{remove:function(){r.removeEventListener(e,t,!1)}};if(typeof r.attachEvent=="function")return r.attachEvent("on"+e,t),{remove:function(){r.detachEvent("on"+e,t)}}}}var Mf,jy,UE,Xy;function G6(){Mf=document.createElement("table"),jy=document.createElement("tr"),UE=/^\s*<(\w+|!)[^>]*>/,Xy={tr:document.createElement("tbody"),tbody:Mf,thead:Mf,tfoot:Mf,td:jy,th:jy,"*":document.createElement("div")}}function yn(r){Mf||G6();var e=UE.test(r)&&RegExp.$1;(!e||!(e in Xy))&&(e="*");var t=Xy[e];r=r.replace(/(^\s*)|(\s*$)/g,""),t.innerHTML=""+r;var n=t.childNodes[0];return t.removeChild(n),n}function Lr(r,e){if(r)for(var t in e)e.hasOwnProperty(t)&&(r.style[t]=e[t]);return r}var F6=ta.cloneEvent,U6=ta.isViewportChanged,z6=function(r){$t(e,r);function e(t){var n=r.call(this,t)||this;return n.extendEvents=[],n.dragging=!1,n.preItem=null,n.graph=t,n.destroyed=!1,n.initEvents(),n}return e.prototype.initEvents=function(){var t=this,n=t.graph,i=t.extendEvents,a=i===void 0?[]:i,o=n.get("canvas"),s=o.get("el"),u=wu(this,"onCanvasEvents"),l=wu(this,"onExtendEvents"),f=wu(this,"onWheelEvent");o.off("*").on("*",u),this.canvasHandler=u,a.push(Tf(s,"DOMMouseScroll",f)),a.push(Tf(s,"mousewheel",f)),typeof window!="undefined"&&(a.push(Tf(window,"keydown",l)),a.push(Tf(window,"keyup",l)),a.push(Tf(window,"focus",l)))},e.getItemRoot=function(t){for(;t&&!t.get("item");)t=t.get("parent");return t},e.prototype.onCanvasEvents=function(t){var n=this.graph,i=n.get("canvas"),a=t.target,o=t.type;t.canvasX=t.x,t.canvasY=t.y;var s={x:t.canvasX,y:t.canvasY},u=n.get("group"),l=u.getMatrix();if(l||(l=[1,0,0,0,1,0,0,0,1]),U6(l)&&(s=n.getPointByClient(t.clientX,t.clientY)),t.x=s.x,t.y=s.y,t.currentTarget=n,a===i){(o==="mousemove"||o==="mouseleave")&&this.handleMouseMove(t,"canvas"),t.target=i,t.item=null,n.emit(o,t),n.emit("canvas:"+o,t);return}var f=e.getItemRoot(a);if(!f){n.emit(o,t);return}var c=f.get("item");if(!c.destroyed){var h=c.getType();if(t.target=a,t.item=c,t.canvasX===t.x&&t.canvasY===t.y){var d=n.getCanvasByPoint(t.x,t.y);t.canvasX=d.x,t.canvasY=d.y}n.emit(o,t),t.name&&!t.name.includes(":")?n.emit(h+":"+o,t):n.emit(t.name,t),o==="dragstart"&&(this.dragging=!0),o==="dragend"&&(this.dragging=!1),o==="mousemove"&&this.handleMouseMove(t,h)}},e.prototype.onExtendEvents=function(t){this.graph.emit(t.type,t)},e.prototype.onWheelEvent=function(t){yt(t.wheelDelta)&&(t.wheelDelta=-t.detail),this.graph.emit("wheel",t)},e.prototype.handleMouseMove=function(t,n){var i=this,a=i.graph,o=i.preItem,s=a.get("canvas"),u=t.target===s?null:t.item;t=F6(t),o&&o!==u&&!o.destroyed&&(t.item=o,this.emitCustomEvent(o.getType(),"mouseleave",t),this.dragging&&this.emitCustomEvent(o.getType(),"dragleave",t)),u&&o!==u&&(t.item=u,this.emitCustomEvent(n,"mouseenter",t),this.dragging&&this.emitCustomEvent(n,"dragenter",t)),this.preItem=u},e.prototype.emitCustomEvent=function(t,n,i){i.type=n,this.graph.emit(t+":"+n,i)},e.prototype.destroy=function(){var t=this,n=t.graph,i=t.canvasHandler,a=t.extendEvents,o=n.get("canvas");o.off("*",i),xe(a,function(s){s.remove()}),this.dragging=!1,this.preItem=null,this.extendEvents.length=0,this.canvasHandler=null,this.destroyed=!0},e}(TU);class hi{constructor(){this.nodes=[],this.edges=[],this.combos=[],this.positions=[],this.destroyed=!1,this.onLayoutEnd=()=>{}}layout(e){return this.init(e),this.execute(!0)}init(e){this.nodes=e.nodes||[],this.edges=e.edges||[],this.combos=e.combos||[]}execute(e){}executeWithWorker(){}getDefaultCfg(){return{}}updateCfg(e){e&&Object.assign(this,e)}getType(){return"base"}destroy(){this.nodes=null,this.edges=null,this.combos=null,this.positions=null,this.destroyed=!0}}const If=r=>typeof r=="string",qn=Array.isArray,ft=r=>typeof r=="number",Hy=r=>Number.isNaN(Number(r)),Ma=r=>r!==null&&typeof r=="object",Yy=r=>{if(r===null)return r;if(r instanceof Date)return new Date(r.getTime());if(r instanceof Array){const e=[];return r.forEach(t=>{e.push(t)}),e.map(t=>Yy(t))}if(typeof r=="object"&&r!=={}){const e=Object.assign({},r);return Object.keys(e).forEach(t=>{e[t]=Yy(e[t])}),e}return r},_r=(r,e)=>{const t=r[e];return Ma(t)?t.cell:t},kf=(r,e,t)=>{const n=[];for(let i=0;i<r;i++)n[i]=0;return t&&t.forEach(i=>{const a=_r(i,"source"),o=_r(i,"target");a&&(n[e[a]]+=1),o&&(n[e[o]]+=1)}),n},zE=r=>{const e=[],t=r.length;for(let n=0;n<t;n+=1){e[n]=[];for(let i=0;i<t;i+=1)n===i?e[n][i]=0:r[n][i]===0||!r[n][i]?e[n][i]=1/0:e[n][i]=r[n][i]}for(let n=0;n<t;n+=1)for(let i=0;i<t;i+=1)for(let a=0;a<t;a+=1)e[i][a]>e[i][n]+e[n][a]&&(e[i][a]=e[i][n]+e[n][a]);return e},$E=(r,e)=>{const{nodes:t,edges:n}=r,i=[],a={};if(!t)throw new Error("invalid nodes data!");return t&&t.forEach((o,s)=>{a[o.id]=s;const u=[];i.push(u)}),n&&n.forEach(o=>{const s=_r(o,"source"),u=_r(o,"target"),l=a[s],f=a[u];i[l][f]=1,e||(i[f][l]=1)}),i},$6=(r,e)=>{const t=[];return r.forEach(n=>{const i=[];n.forEach(a=>{i.push(a*e)}),t.push(i)}),t},VE=(r,e)=>{if(r&&r.children){for(let t=r.children.length-1;t>=0;t--)if(!VE(r.children[t],e))return}return!!e(r)},bd=(r,e)=>{typeof e=="function"&&VE(r,e)},To=r=>typeof r=="function",Df=new Map,ai=(r,e)=>{if(Df.get(r)&&console.warn(`The layout with the name ${r} exists already, it will be overridden`),Ma(e)){class t extends hi{constructor(i){super();const a=this,o={},s=a.getDefaultCfg();Object.assign(o,s,e,i),Object.keys(o).forEach(u=>{const l=o[u];a[u]=l})}}Df.set(r,t)}else Df.set(r,e)},V6=r=>Df.has(r)?Df.get(r):null;class W6 extends hi{constructor(e){super();this.begin=[0,0],this.preventOverlap=!0,this.preventOverlapPadding=10,this.condense=!1,this.sortBy="degree",this.nodeSize=30,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.row=0,this.col=0,this.cellWidth=0,this.cellHeight=0,this.cellUsed={},this.id2manPos={},this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30}}execute(){const e=this,t=e.nodes,n=e.edges,i=t.length,a=e.begin;if(i===0)return e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n};if(i===1)return t[0].x=a[0],t[0].y=a[1],e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n};const o=[];t.forEach(f=>{o.push(f)});const s={};if(o.forEach((f,c)=>{s[f.id]=c}),(e.sortBy==="degree"||!If(e.sortBy)||o[0][e.sortBy]===void 0)&&(e.sortBy="degree",Hy(t[0].degree))){const f=kf(o.length,s,n);o.forEach((c,h)=>{c.degree=f[h]})}o.sort((f,c)=>c[e.sortBy]-f[e.sortBy]),!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight);const u=e.rows,l=e.cols!=null?e.cols:e.columns;if(e.cells=i,u!=null&&l!=null?(e.rows=u,e.cols=l):u!=null&&l==null?(e.rows=u,e.cols=Math.ceil(e.cells/e.rows)):u==null&&l!=null?(e.cols=l,e.rows=Math.ceil(e.cells/e.cols)):(e.splits=Math.sqrt(e.cells*e.height/e.width),e.rows=Math.round(e.splits),e.cols=Math.round(e.width/e.height*e.splits)),e.cols*e.rows>e.cells){const f=e.small(),c=e.large();(f-1)*c>=e.cells?e.small(f-1):(c-1)*f>=e.cells&&e.large(c-1)}else for(;e.cols*e.rows<e.cells;){const f=e.small(),c=e.large();(c+1)*f>=e.cells?e.large(c+1):e.small(f+1)}e.cellWidth=e.width/e.cols,e.cellHeight=e.height/e.rows,e.condense&&(e.cellWidth=0,e.cellHeight=0),e.preventOverlap&&o.forEach(f=>{(!f.x||!f.y)&&(f.x=0,f.y=0);let c,h;qn(f.size)?(c=f.size[0],h=f.size[1]):ft(f.size)?(c=f.size,h=f.size):Ma(f.size)&&(c=f.size.width,h=f.size.height),(c===void 0||h===void 0)&&(qn(e.nodeSize)?(c=e.nodeSize[0],h=e.nodeSize[1]):ft(e.nodeSize)?(c=e.nodeSize,h=e.nodeSize):(c=30,h=30));const d=e.preventOverlapPadding,v=c+d,p=h+d;e.cellWidth=Math.max(e.cellWidth,v),e.cellHeight=Math.max(e.cellHeight,p)}),e.cellUsed={},e.row=0,e.col=0,e.id2manPos={};for(let f=0;f<o.length;f++){const c=o[f];let h;if(e.position&&(h=e.position(c)),h&&(h.row!==void 0||h.col!==void 0)){const d={row:h.row,col:h.col};if(d.col===void 0)for(d.col=0;e.used(d.row,d.col);)d.col++;else if(d.row===void 0)for(d.row=0;e.used(d.row,d.col);)d.row++;e.id2manPos[c.id]=d,e.use(d.row,d.col)}e.getPos(c)}return e.onLayoutEnd&&e.onLayoutEnd(),{edges:n,nodes:o}}small(e){const t=this;let n;const i=t.rows||5,a=t.cols||5;return e==null?n=Math.min(i,a):Math.min(i,a)===t.rows?t.rows=e:t.cols=e,n}large(e){const t=this;let n;const i=t.rows||5,a=t.cols||5;return e==null?n=Math.max(i,a):Math.max(i,a)===t.rows?t.rows=e:t.cols=e,n}used(e,t){return this.cellUsed[`c-${e}-${t}`]||!1}use(e,t){const n=this;n.cellUsed[`c-${e}-${t}`]=!0}moveToNextCell(){const e=this,t=e.cols||5;e.col++,e.col>=t&&(e.col=0,e.row++)}getPos(e){const t=this,n=t.begin,i=t.cellWidth,a=t.cellHeight;let o,s;const u=t.id2manPos[e.id];if(u)o=u.col*i+i/2+n[0],s=u.row*a+a/2+n[1];else{for(;t.used(t.row,t.col);)t.moveToNextCell();o=t.col*i+i/2+n[0],s=t.row*a+a/2+n[1],t.use(t.row,t.col),t.moveToNextCell()}e.x=o,e.y=s}getType(){return"grid"}}class j6 extends hi{constructor(e){super();this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{center:[0,0],width:300,height:300}}execute(){const e=this,t=e.nodes,n=.9,i=e.center;return!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight),t&&t.forEach(a=>{a.x=(Math.random()-.5)*n*e.width+i[0],a.y=(Math.random()-.5)*n*e.height+i[1]}),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:this.edges}}getType(){return"random"}}const qy=(r,e)=>{let t;return r?ft(r)?t=n=>r:t=r:t=n=>e||1,t};class X6 extends hi{constructor(e){super();this.maxIteration=1e3,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.preventOverlap=!0,this.tick=()=>{},this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(e)}getDefaultCfg(){return{maxIteration:500,gravity:10,enableTick:!0}}execute(){const e=this,t=e.nodes;if(e.timeInterval!==void 0&&typeof window!="undefined"&&window.clearInterval(e.timeInterval),!t||t.length===0){e.onLayoutEnd&&e.onLayoutEnd();return}!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const n=e.center;if(t.length===1){t[0].x=n[0],t[0].y=n[1],e.onLayoutEnd&&e.onLayoutEnd();return}const i={},a={};t.forEach((l,f)=>{ft(l.x)||(l.x=Math.random()*e.width),ft(l.y)||(l.y=Math.random()*e.height),i[l.id]=l,a[l.id]=f}),e.nodeMap=i,e.nodeIdxMap=a,e.linkDistance=qy(e.linkDistance,1),e.nodeStrength=qy(e.nodeStrength,1),e.edgeStrength=qy(e.edgeStrength,1);const o=e.nodeSize;let s;if(e.preventOverlap){const l=e.nodeSpacing;let f;ft(l)?f=()=>l:To(l)?f=l:f=()=>0,o?qn(o)?s=c=>(o[0]>o[1]?o[0]:o[1])+f(c):s=c=>o+f(c):s=c=>c.size?qn(c.size)?(c.size[0]>c.size[1]?c.size[0]:c.size[1])+f(c):Ma(c.size)?(c.size.width>c.size.height?c.size.width:c.size.height)+f(c):c.size+f(c):10+f(c)}e.nodeSize=s;const u=e.edges;e.degrees=kf(t.length,e.nodeIdxMap,u),e.getMass||(e.getMass=l=>e.degrees[e.nodeIdxMap[l.id]]||1),e.run()}run(){const e=this,t=e.nodes,n=e.edges,i=e.maxIteration;if(typeof window=="undefined")return;let a=0;this.timeInterval=window.setInterval(()=>{const o=[],s=[];if(!t)return;t.forEach((c,h)=>{o[2*h]=0,o[2*h+1]=0,s[2*h]=0,s[2*h+1]=0}),e.calRepulsive(o,t),n&&e.calAttractive(o,n),e.calGravity(o,t);const u=Math.max(.02,e.interval-a*.002);e.updateVelocity(o,s,u,t);const l=[];t.forEach(c=>{l.push({x:c.x,y:c.y})}),e.updatePosition(s,u,t),e.tick&&e.tick();let f=0;t.forEach((c,h)=>{const d=c.x-l[h].x,v=c.y-l[h].y;f+=Math.sqrt(d*d+v*v)}),f/=t.length,f<e.minMovement&&(window.clearInterval(e.timeInterval),e.onLayoutEnd&&e.onLayoutEnd()),a++,a>=i&&(e.onLayoutEnd&&e.onLayoutEnd(),window.clearInterval(e.timeInterval))},0)}calRepulsive(e,t){const n=this,i=n.getMass,a=n.nodeStrength,o=n.factor,s=n.coulombDisScale,u=n.preventOverlap,l=n.nodeSize;t.forEach((f,c)=>{const h=i?i(f):1;t.forEach((d,v)=>{if(c>=v)return;const p=f.x-d.x,g=f.y-d.y,y=Math.sqrt(p*p+g*g)+.01,m=(y+.1)*s,b=p/y,x=g/y,_=(a(f)+a(d))/2*o/(m*m),S=i?i(d):1;if(e[2*c]+=b*_,e[2*c+1]+=x*_,e[2*v]-=b*_,e[2*v+1]-=x*_,u&&y<(l(f)+l(d))/2){const E=(a(f)+a(d))/2/(y*y);e[2*c]+=b*E/h,e[2*c+1]+=x*E/h,e[2*v]-=b*E/S,e[2*v+1]-=x*E/S}})})}calAttractive(e,t){const n=this,i=n.nodeMap,a=n.nodeIdxMap,o=n.linkDistance,s=n.edgeStrength,u=n.getMass;t.forEach((l,f)=>{const c=_r(l,"source"),h=_r(l,"target"),d=i[c],v=i[h],p=v.x-d.x,g=v.y-d.y,y=Math.sqrt(p*p+g*g)+.01,m=p/y,b=g/y,S=((o(l)||1)-y)*s(l),E=a[c],C=a[h],M=u?u(d):1,w=u?u(v):1;e[2*E]-=m*S/M,e[2*E+1]-=b*S/M,e[2*C]+=m*S/w,e[2*C+1]+=b*S/w})}calGravity(e,t){const n=this,i=n.center,a=n.gravity,o=n.degrees,s=t.length;for(let u=0;u<s;u++){const l=t[u];let f=l.x-i[0],c=l.y-i[1],h=a;if(n.getCenter){const d=n.getCenter(l,o[u]);d&&ft(d[0])&&ft(d[1])&&ft(d[2])&&(f=l.x-d[0],c=l.y-d[1],h=d[2])}!h||(e[2*u]-=h*f,e[2*u+1]-=h*c)}}updateVelocity(e,t,n,i){const a=this,o=n*a.damping;i.forEach((s,u)=>{let l=e[2*u]*o||.01,f=e[2*u+1]*o||.01;const c=Math.sqrt(l*l+f*f);if(c>a.maxSpeed){const h=a.maxSpeed/c;l=h*l,f=h*f}t[2*u]=l,t[2*u+1]=f})}updatePosition(e,t,n){n.forEach((i,a)=>{if(ft(i.fx)&&ft(i.fy)){i.x=i.fx,i.y=i.fy;return}const o=e[2*a]*t,s=e[2*a+1]*t;i.x+=o,i.y+=s})}stop(){this.timeInterval&&typeof window!="undefined"&&window.clearInterval(this.timeInterval)}destroy(){const e=this;e.stop(),e.tick=null,e.nodes=null,e.edges=null,e.destroyed=!0}getType(){return"gForce"}}function H6(r,e){var t,n=1;r==null&&(r=0),e==null&&(e=0);function i(){var a,o=t.length,s,u=0,l=0;for(a=0;a<o;++a)s=t[a],u+=s.x,l+=s.y;for(u=(u/o-r)*n,l=(l/o-e)*n,a=0;a<o;++a)s=t[a],s.x-=u,s.y-=l}return i.initialize=function(a){t=a},i.x=function(a){return arguments.length?(r=+a,i):r},i.y=function(a){return arguments.length?(e=+a,i):e},i.strength=function(a){return arguments.length?(n=+a,i):n},i}function Y6(r){const e=+this._x.call(null,r),t=+this._y.call(null,r);return WE(this.cover(e,t),e,t,r)}function WE(r,e,t,n){if(isNaN(e)||isNaN(t))return r;var i,a=r._root,o={data:n},s=r._x0,u=r._y0,l=r._x1,f=r._y1,c,h,d,v,p,g,y,m;if(!a)return r._root=o,r;for(;a.length;)if((p=e>=(c=(s+l)/2))?s=c:l=c,(g=t>=(h=(u+f)/2))?u=h:f=h,i=a,!(a=a[y=g<<1|p]))return i[y]=o,r;if(d=+r._x.call(null,a.data),v=+r._y.call(null,a.data),e===d&&t===v)return o.next=a,i?i[y]=o:r._root=o,r;do i=i?i[y]=new Array(4):r._root=new Array(4),(p=e>=(c=(s+l)/2))?s=c:l=c,(g=t>=(h=(u+f)/2))?u=h:f=h;while((y=g<<1|p)==(m=(v>=h)<<1|d>=c));return i[m]=a,i[y]=o,r}function q6(r){var e,t,n=r.length,i,a,o=new Array(n),s=new Array(n),u=1/0,l=1/0,f=-1/0,c=-1/0;for(t=0;t<n;++t)isNaN(i=+this._x.call(null,e=r[t]))||isNaN(a=+this._y.call(null,e))||(o[t]=i,s[t]=a,i<u&&(u=i),i>f&&(f=i),a<l&&(l=a),a>c&&(c=a));if(u>f||l>c)return this;for(this.cover(u,l).cover(f,c),t=0;t<n;++t)WE(this,o[t],s[t],r[t]);return this}function K6(r,e){if(isNaN(r=+r)||isNaN(e=+e))return this;var t=this._x0,n=this._y0,i=this._x1,a=this._y1;if(isNaN(t))i=(t=Math.floor(r))+1,a=(n=Math.floor(e))+1;else{for(var o=i-t||1,s=this._root,u,l;t>r||r>=i||n>e||e>=a;)switch(l=(e<n)<<1|r<t,u=new Array(4),u[l]=s,s=u,o*=2,l){case 0:i=t+o,a=n+o;break;case 1:t=i-o,a=n+o;break;case 2:i=t+o,n=a-o;break;case 3:t=i-o,n=a-o;break}this._root&&this._root.length&&(this._root=s)}return this._x0=t,this._y0=n,this._x1=i,this._y1=a,this}function Z6(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function Q6(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function di(r,e,t,n,i){this.node=r,this.x0=e,this.y0=t,this.x1=n,this.y1=i}function J6(r,e,t){var n,i=this._x0,a=this._y0,o,s,u,l,f=this._x1,c=this._y1,h=[],d=this._root,v,p;for(d&&h.push(new di(d,i,a,f,c)),t==null?t=1/0:(i=r-t,a=e-t,f=r+t,c=e+t,t*=t);v=h.pop();)if(!(!(d=v.node)||(o=v.x0)>f||(s=v.y0)>c||(u=v.x1)<i||(l=v.y1)<a))if(d.length){var g=(o+u)/2,y=(s+l)/2;h.push(new di(d[3],g,y,u,l),new di(d[2],o,y,g,l),new di(d[1],g,s,u,y),new di(d[0],o,s,g,y)),(p=(e>=y)<<1|r>=g)&&(v=h[h.length-1],h[h.length-1]=h[h.length-1-p],h[h.length-1-p]=v)}else{var m=r-+this._x.call(null,d.data),b=e-+this._y.call(null,d.data),x=m*m+b*b;if(x<t){var _=Math.sqrt(t=x);i=r-_,a=e-_,f=r+_,c=e+_,n=d.data}}return n}function e8(r){if(isNaN(f=+this._x.call(null,r))||isNaN(c=+this._y.call(null,r)))return this;var e,t=this._root,n,i,a,o=this._x0,s=this._y0,u=this._x1,l=this._y1,f,c,h,d,v,p,g,y;if(!t)return this;if(t.length)for(;;){if((v=f>=(h=(o+u)/2))?o=h:u=h,(p=c>=(d=(s+l)/2))?s=d:l=d,e=t,!(t=t[g=p<<1|v]))return this;if(!t.length)break;(e[g+1&3]||e[g+2&3]||e[g+3&3])&&(n=e,y=g)}for(;t.data!==r;)if(i=t,!(t=t.next))return this;return(a=t.next)&&delete t.next,i?(a?i.next=a:delete i.next,this):e?(a?e[g]=a:delete e[g],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(n?n[y]=t:this._root=t),this):(this._root=a,this)}function t8(r){for(var e=0,t=r.length;e<t;++e)this.remove(r[e]);return this}function r8(){return this._root}function n8(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function i8(r){var e=[],t,n=this._root,i,a,o,s,u;for(n&&e.push(new di(n,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!r(n=t.node,a=t.x0,o=t.y0,s=t.x1,u=t.y1)&&n.length){var l=(a+s)/2,f=(o+u)/2;(i=n[3])&&e.push(new di(i,l,f,s,u)),(i=n[2])&&e.push(new di(i,a,f,l,u)),(i=n[1])&&e.push(new di(i,l,o,s,f)),(i=n[0])&&e.push(new di(i,a,o,l,f))}return this}function a8(r){var e=[],t=[],n;for(this._root&&e.push(new di(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var a,o=n.x0,s=n.y0,u=n.x1,l=n.y1,f=(o+u)/2,c=(s+l)/2;(a=i[0])&&e.push(new di(a,o,s,f,c)),(a=i[1])&&e.push(new di(a,f,s,u,c)),(a=i[2])&&e.push(new di(a,o,c,f,l)),(a=i[3])&&e.push(new di(a,f,c,u,l))}t.push(n)}for(;n=t.pop();)r(n.node,n.x0,n.y0,n.x1,n.y1);return this}function o8(r){return r[0]}function s8(r){return arguments.length?(this._x=r,this):this._x}function u8(r){return r[1]}function l8(r){return arguments.length?(this._y=r,this):this._y}function Ky(r,e,t){var n=new Zy(e==null?o8:e,t==null?u8:t,NaN,NaN,NaN,NaN);return r==null?n:n.addAll(r)}function Zy(r,e,t,n,i,a){this._x=r,this._y=e,this._x0=t,this._y0=n,this._x1=i,this._y1=a,this._root=void 0}function jE(r){for(var e={data:r.data},t=e;r=r.next;)t=t.next={data:r.data};return e}var vi=Ky.prototype=Zy.prototype;vi.copy=function(){var r=new Zy(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,t,n;if(!e)return r;if(!e.length)return r._root=jE(e),r;for(t=[{source:e,target:r._root=new Array(4)}];e=t.pop();)for(var i=0;i<4;++i)(n=e.source[i])&&(n.length?t.push({source:n,target:e.target[i]=new Array(4)}):e.target[i]=jE(n));return r};vi.add=Y6;vi.addAll=q6;vi.cover=K6;vi.data=Z6;vi.extent=Q6;vi.find=J6;vi.remove=e8;vi.removeAll=t8;vi.root=r8;vi.size=n8;vi.visit=i8;vi.visitAfter=a8;vi.x=s8;vi.y=l8;function pi(r){return function(){return r}}function Mo(r){return(r()-.5)*1e-6}function f8(r){return r.x+r.vx}function c8(r){return r.y+r.vy}function XE(r){var e,t,n,i=1,a=1;typeof r!="function"&&(r=pi(r==null?1:+r));function o(){for(var l,f=e.length,c,h,d,v,p,g,y=0;y<a;++y)for(c=Ky(e,f8,c8).visitAfter(s),l=0;l<f;++l)h=e[l],p=t[h.index],g=p*p,d=h.x+h.vx,v=h.y+h.vy,c.visit(m);function m(b,x,_,S,E){var C=b.data,M=b.r,w=p+M;if(C){if(C.index>h.index){var T=d-C.x-C.vx,I=v-C.y-C.vy,k=T*T+I*I;k<w*w&&(T===0&&(T=Mo(n),k+=T*T),I===0&&(I=Mo(n),k+=I*I),k=(w-(k=Math.sqrt(k)))/k*i,h.vx+=(T*=k)*(w=(M*=M)/(g+M)),h.vy+=(I*=k)*w,C.vx-=T*(w=1-w),C.vy-=I*w)}return}return x>d+w||S<d-w||_>v+w||E<v-w}}function s(l){if(l.data)return l.r=t[l.data.index];for(var f=l.r=0;f<4;++f)l[f]&&l[f].r>l.r&&(l.r=l[f].r)}function u(){if(!!e){var l,f=e.length,c;for(t=new Array(f),l=0;l<f;++l)c=e[l],t[c.index]=+r(c,l,e)}}return o.initialize=function(l,f){e=l,n=f,u()},o.iterations=function(l){return arguments.length?(a=+l,o):a},o.strength=function(l){return arguments.length?(i=+l,o):i},o.radius=function(l){return arguments.length?(r=typeof l=="function"?l:pi(+l),u(),o):r},o}function h8(r){return r.index}function HE(r,e){var t=r.get(e);if(!t)throw new Error("node not found: "+e);return t}function Qy(r){var e=h8,t=c,n,i=pi(30),a,o,s,u,l,f=1;r==null&&(r=[]);function c(g){return 1/Math.min(s[g.source.index],s[g.target.index])}function h(g){for(var y=0,m=r.length;y<f;++y)for(var b=0,x,_,S,E,C,M,w;b<m;++b)x=r[b],_=x.source,S=x.target,E=S.x+S.vx-_.x-_.vx||Mo(l),C=S.y+S.vy-_.y-_.vy||Mo(l),M=Math.sqrt(E*E+C*C),M=(M-a[b])/M*g*n[b],E*=M,C*=M,S.vx-=E*(w=u[b]),S.vy-=C*w,_.vx+=E*(w=1-w),_.vy+=C*w}function d(){if(!!o){var g,y=o.length,m=r.length,b=new Map(o.map((_,S)=>[e(_,S,o),_])),x;for(g=0,s=new Array(y);g<m;++g)x=r[g],x.index=g,typeof x.source!="object"&&(x.source=HE(b,x.source)),typeof x.target!="object"&&(x.target=HE(b,x.target)),s[x.source.index]=(s[x.source.index]||0)+1,s[x.target.index]=(s[x.target.index]||0)+1;for(g=0,u=new Array(m);g<m;++g)x=r[g],u[g]=s[x.source.index]/(s[x.source.index]+s[x.target.index]);n=new Array(m),v(),a=new Array(m),p()}}function v(){if(!!o)for(var g=0,y=r.length;g<y;++g)n[g]=+t(r[g],g,r)}function p(){if(!!o)for(var g=0,y=r.length;g<y;++g)a[g]=+i(r[g],g,r)}return h.initialize=function(g,y){o=g,l=y,d()},h.links=function(g){return arguments.length?(r=g,d(),h):r},h.id=function(g){return arguments.length?(e=g,h):e},h.iterations=function(g){return arguments.length?(f=+g,h):f},h.strength=function(g){return arguments.length?(t=typeof g=="function"?g:pi(+g),v(),h):t},h.distance=function(g){return arguments.length?(i=typeof g=="function"?g:pi(+g),p(),h):i},h}var d8={value:()=>{}};function YE(){for(var r=0,e=arguments.length,t={},n;r<e;++r){if(!(n=arguments[r]+"")||n in t||/[\s.]/.test(n))throw new Error("illegal type: "+n);t[n]=[]}return new xd(t)}function xd(r){this._=r}function v8(r,e){return r.trim().split(/^|\s+/).map(function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}xd.prototype=YE.prototype={constructor:xd,on:function(r,e){var t=this._,n=v8(r+"",t),i,a=-1,o=n.length;if(arguments.length<2){for(;++a<o;)if((i=(r=n[a]).type)&&(i=p8(t[i],r.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<o;)if(i=(r=n[a]).type)t[i]=qE(t[i],r.name,e);else if(e==null)for(i in t)t[i]=qE(t[i],r.name,null);return this},copy:function(){var r={},e=this._;for(var t in e)r[t]=e[t].slice();return new xd(r)},call:function(r,e){if((i=arguments.length-2)>0)for(var t=new Array(i),n=0,i,a;n<i;++n)t[n]=arguments[n+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(a=this._[r],n=0,i=a.length;n<i;++n)a[n].value.apply(e,t)},apply:function(r,e,t){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var n=this._[r],i=0,a=n.length;i<a;++i)n[i].value.apply(e,t)}};function p8(r,e){for(var t=0,n=r.length,i;t<n;++t)if((i=r[t]).name===e)return i.value}function qE(r,e,t){for(var n=0,i=r.length;n<i;++n)if(r[n].name===e){r[n]=d8,r=r.slice(0,n).concat(r.slice(n+1));break}return t!=null&&r.push({name:e,value:t}),r}const g8=1664525,y8=1013904223,KE=4294967296;function m8(){let r=1;return()=>(r=(g8*r+y8)%KE)/KE}function b8(r){return r.x}function x8(r){return r.y}var _8=10,w8=Math.PI*(3-Math.sqrt(5));function ZE(r){var e,t=1,n=.001,i=1-Math.pow(n,1/300),a=0,o=.6,s=new Map,u=$g(c),l=YE("tick","end"),f=m8();r==null&&(r=[]);function c(){h(),l.call("tick",e),t<n&&(u.stop(),l.call("end",e))}function h(p){var g,y=r.length,m;p===void 0&&(p=1);for(var b=0;b<p;++b)for(t+=(a-t)*i,s.forEach(function(x){x(t)}),g=0;g<y;++g)m=r[g],m.fx==null?m.x+=m.vx*=o:(m.x=m.fx,m.vx=0),m.fy==null?m.y+=m.vy*=o:(m.y=m.fy,m.vy=0);return e}function d(){for(var p=0,g=r.length,y;p<g;++p){if(y=r[p],y.index=p,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var m=_8*Math.sqrt(.5+p),b=p*w8;y.x=m*Math.cos(b),y.y=m*Math.sin(b)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function v(p){return p.initialize&&p.initialize(r,f),p}return d(),e={tick:h,restart:function(){return u.restart(c),e},stop:function(){return u.stop(),e},nodes:function(p){return arguments.length?(r=p,d(),s.forEach(v),e):r},alpha:function(p){return arguments.length?(t=+p,e):t},alphaMin:function(p){return arguments.length?(n=+p,e):n},alphaDecay:function(p){return arguments.length?(i=+p,e):+i},alphaTarget:function(p){return arguments.length?(a=+p,e):a},velocityDecay:function(p){return arguments.length?(o=1-p,e):1-o},randomSource:function(p){return arguments.length?(f=p,s.forEach(v),e):f},force:function(p,g){return arguments.length>1?(g==null?s.delete(p):s.set(p,v(g)),e):s.get(p)},find:function(p,g,y){var m=0,b=r.length,x,_,S,E,C;for(y==null?y=1/0:y*=y,m=0;m<b;++m)E=r[m],x=p-E.x,_=g-E.y,S=x*x+_*_,S<y&&(C=E,y=S);return C},on:function(p,g){return arguments.length>1?(l.on(p,g),e):l.on(p)}}}function QE(){var r,e,t,n,i=pi(-30),a,o=1,s=1/0,u=.81;function l(d){var v,p=r.length,g=Ky(r,b8,x8).visitAfter(c);for(n=d,v=0;v<p;++v)e=r[v],g.visit(h)}function f(){if(!!r){var d,v=r.length,p;for(a=new Array(v),d=0;d<v;++d)p=r[d],a[p.index]=+i(p,d,r)}}function c(d){var v=0,p,g,y=0,m,b,x;if(d.length){for(m=b=x=0;x<4;++x)(p=d[x])&&(g=Math.abs(p.value))&&(v+=p.value,y+=g,m+=g*p.x,b+=g*p.y);d.x=m/y,d.y=b/y}else{p=d,p.x=p.data.x,p.y=p.data.y;do v+=a[p.data.index];while(p=p.next)}d.value=v}function h(d,v,p,g){if(!d.value)return!0;var y=d.x-e.x,m=d.y-e.y,b=g-v,x=y*y+m*m;if(b*b/u<x)return x<s&&(y===0&&(y=Mo(t),x+=y*y),m===0&&(m=Mo(t),x+=m*m),x<o&&(x=Math.sqrt(o*x)),e.vx+=y*d.value*n/x,e.vy+=m*d.value*n/x),!0;if(d.length||x>=s)return;(d.data!==e||d.next)&&(y===0&&(y=Mo(t),x+=y*y),m===0&&(m=Mo(t),x+=m*m),x<o&&(x=Math.sqrt(o*x)));do d.data!==e&&(b=a[d.data.index]*n/x,e.vx+=y*b,e.vy+=m*b);while(d=d.next)}return l.initialize=function(d,v){r=d,t=v,f()},l.strength=function(d){return arguments.length?(i=typeof d=="function"?d:pi(+d),f(),l):i},l.distanceMin=function(d){return arguments.length?(o=d*d,l):Math.sqrt(o)},l.distanceMax=function(d){return arguments.length?(s=d*d,l):Math.sqrt(s)},l.theta=function(d){return arguments.length?(u=d*d,l):Math.sqrt(u)},l}function S8(r){var e=pi(.1),t,n,i;typeof r!="function"&&(r=pi(r==null?0:+r));function a(s){for(var u=0,l=t.length,f;u<l;++u)f=t[u],f.vx+=(i[u]-f.x)*n[u]*s}function o(){if(!!t){var s,u=t.length;for(n=new Array(u),i=new Array(u),s=0;s<u;++s)n[s]=isNaN(i[s]=+r(t[s],s,t))?0:+e(t[s],s,t)}}return a.initialize=function(s){t=s,o()},a.strength=function(s){return arguments.length?(e=typeof s=="function"?s:pi(+s),o(),a):e},a.x=function(s){return arguments.length?(r=typeof s=="function"?s:pi(+s),o(),a):r},a}function E8(r){var e=pi(.1),t,n,i;typeof r!="function"&&(r=pi(r==null?0:+r));function a(s){for(var u=0,l=t.length,f;u<l;++u)f=t[u],f.vy+=(i[u]-f.y)*n[u]*s}function o(){if(!!t){var s,u=t.length;for(n=new Array(u),i=new Array(u),s=0;s<u;++s)n[s]=isNaN(i[s]=+r(t[s],s,t))?0:+e(t[s],s,t)}}return a.initialize=function(s){t=s,o()},a.strength=function(s){return arguments.length?(e=typeof s=="function"?s:pi(+s),o(),a):e},a.y=function(s){return arguments.length?(r=typeof s=="function"?s:pi(+s),o(),a):r},a}function C8(){function r(ne){return()=>ne}let e=ne=>ne.cluster,t=r(1),n=r(-1),i=r(100),a=r(.1),o=[0,0],s=[],u={},l=[],f=100,c=100,h={none:{x:0,y:0}},d=[],v,p="force",g=!0,y=.1;function m(ne){if(!g)return m;v.tick(),C();for(let pe=0,Ge=s.length,ke,rt=ne*y;pe<Ge;++pe)ke=s[pe],ke.vx+=(h[e(ke)].x-ke.x)*rt,ke.vy+=(h[e(ke)].y-ke.y)*rt}function b(){!s||x()}function x(){if(!s||!s.length)return;if(e(s[0])===void 0)throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInABox.groupBy('clusterAttr') before calling .links()");const ne=_();v=ZE(ne.nodes).force("x",S8(f).strength(.1)).force("y",E8(c).strength(.1)).force("collide",XE(pe=>pe.r).iterations(4)).force("charge",QE().strength(n)).force("links",Qy(ne.nodes.length?ne.links:[]).distance(i).strength(a)),d=v.nodes(),C()}function _(){const ne=[],pe=[],Ge={};let ke=[],rt={},$e=[];return rt=S(s),$e=E(l),ke=Object.keys(rt),ke.forEach((ut,pt)=>{const qt=rt[ut];ne.push({id:ut,size:qt.count,r:Math.sqrt(qt.sumforceNodeSize/Math.PI)}),Ge[ut]=pt}),$e.forEach(ut=>{const pt=_r(ut,"source"),qt=_r(ut,"target"),F=Ge[pt],Z=Ge[qt];F!==void 0&&Z!==void 0&&pe.push({source:F,target:Z,count:ut.count})}),{nodes:ne,links:pe}}function S(ne){const pe={};return ne.forEach(Ge=>{const ke=e(Ge);pe[ke]||(pe[ke]={count:0,sumforceNodeSize:0})}),ne.forEach(Ge=>{const ke=e(Ge),rt=t(Ge),$e=pe[ke];$e.count=$e.count+1,$e.sumforceNodeSize=$e.sumforceNodeSize+Math.PI*(rt*rt)*1.3,pe[ke]=$e}),pe}function E(ne){const pe={},Ge=[];return ne.forEach(rt=>{const $e=M(rt);let ut=0;pe[$e]!==void 0&&(ut=pe[$e]),ut+=1,pe[$e]=ut}),Object.entries(pe).forEach(([rt,$e])=>{const ut=rt.split("~")[0],pt=rt.split("~")[1];ut!==void 0&&pt!==void 0&&Ge.push({source:ut,target:pt,count:$e})}),Ge}function C(){return h={none:{x:0,y:0}},d.forEach(ne=>{h[ne.id]={x:ne.x-o[0],y:ne.y-o[1]}}),h}function M(ne){const pe=_r(ne,"source"),Ge=_r(ne,"target"),ke=e(u[pe]),rt=e(u[Ge]);return ke<=rt?`${ke}~${rt}`:`${rt}~${ke}`}function w(ne){u={},ne.forEach(pe=>{u[pe.id]=pe})}function T(ne){return arguments.length?(p=ne,b(),m):p}function I(ne){return arguments.length?typeof ne=="string"?(e=pe=>pe[ne],m):(e=ne,m):e}function k(ne){return arguments.length?(g=ne,m):g}function O(ne){return arguments.length?(y=ne,m):y}function U(ne){return arguments.length?(f=ne,m):f}function q(ne){return arguments.length?(c=ne,m):c}function K(ne){return arguments.length?(w(ne||[]),s=ne||[],m):s}function le(ne){return arguments.length?(l=ne||[],b(),m):l}function he(ne){return arguments.length?(typeof ne=="function"?t=ne:t=r(+ne),b(),m):t}function te(ne){return arguments.length?(typeof ne=="function"?n=ne:n=r(+ne),b(),m):n}function se(ne){return arguments.length?(typeof ne=="function"?i=ne:i=r(+ne),b(),m):i}function ge(ne){return arguments.length?(typeof ne=="function"?a=ne:a=r(+ne),b(),m):a}function Se(ne){return arguments.length?(o=ne,m):o}return m.initialize=ne=>{s=ne,b()},m.template=T,m.groupBy=I,m.enableGrouping=k,m.strength=O,m.centerX=U,m.centerY=q,m.nodes=K,m.links=le,m.forceNodeSize=he,m.nodeSize=m.forceNodeSize,m.forceCharge=te,m.forceLinkDistance=se,m.forceLinkStrength=ge,m.offset=Se,m.getFocis=C,m}const Jy={RUN:"LAYOUT_RUN",END:"LAYOUT_END",ERROR:"LAYOUT_ERROR",TICK:"LAYOUT_TICK",GPURUN:"GPU_LAYOUT_RUN",GPUEND:"GPU_LAYOUT_END"};class A8 extends hi{constructor(e){super();this.center=[0,0],this.nodeStrength=null,this.edgeStrength=null,this.preventOverlap=!1,this.clusterNodeStrength=null,this.clusterEdgeStrength=null,this.clusterEdgeDistance=null,this.clusterNodeSize=null,this.clusterFociStrength=null,this.linkDistance=50,this.alphaDecay=.028,this.alphaMin=.001,this.alpha=.3,this.collideStrength=1,this.workerEnabled=!1,this.tick=()=>{},this.onLayoutEnd=()=>{},this.ticking=void 0,e&&this.updateCfg(e)}getDefaultCfg(){return{center:[0,0],nodeStrength:null,edgeStrength:null,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10,tick(){},onLayoutEnd(){},workerEnabled:!1}}init(e){const t=this;t.nodes=e.nodes||[];const n=e.edges||[];t.edges=n.map(i=>{const a={},o=["targetNode","sourceNode","startPoint","endPoint"];return Object.keys(i).forEach(s=>{o.indexOf(s)>-1||(a[s]=i[s])}),a}),t.ticking=!1}execute(e){const t=this,n=t.nodes,i=t.edges;if(t.ticking)return;let a=t.forceSimulation;const o=t.alphaMin,s=t.alphaDecay,u=t.alpha;if(a){if(e){if(t.clustering&&t.clusterForce&&(t.clusterForce.nodes(n),t.clusterForce.links(i)),a.nodes(n),i&&t.edgeForce)t.edgeForce.links(i);else if(i&&!t.edgeForce){const l=Qy().id(f=>f.id).links(i);t.edgeStrength&&l.strength(t.edgeStrength),t.linkDistance&&l.distance(t.linkDistance),t.edgeForce=l,a.force("link",l)}}t.preventOverlap&&t.overlapProcess(a),a.alpha(u).restart(),this.ticking=!0}else try{const l=QE();if(t.nodeStrength&&l.strength(t.nodeStrength),a=ZE().nodes(n),t.clustering){const f=C8();f.centerX(t.center[0]).centerY(t.center[1]).template("force").strength(t.clusterFociStrength),i&&f.links(i),n&&f.nodes(n),f.forceLinkDistance(t.clusterEdgeDistance).forceLinkStrength(t.clusterEdgeStrength).forceCharge(t.clusterNodeStrength).forceNodeSize(t.clusterNodeSize),t.clusterForce=f,a.force("group",f)}if(a.force("center",H6(t.center[0],t.center[1])).force("charge",l).alpha(u).alphaDecay(s).alphaMin(o),t.preventOverlap&&t.overlapProcess(a),i){const f=Qy().id(c=>c.id).links(i);t.edgeStrength&&f.strength(t.edgeStrength),t.linkDistance&&f.distance(t.linkDistance),t.edgeForce=f,a.force("link",f)}if(t.workerEnabled&&!M8()&&(t.workerEnabled=!1,console.warn("workerEnabled option is only supported when running in web worker.")),!t.workerEnabled)a.on("tick",()=>{t.tick()}).on("end",()=>{t.ticking=!1,t.onLayoutEnd&&t.onLayoutEnd()}),t.ticking=!0;else{a.stop();const f=T8(a);for(let c=1;c<=f;c++)a.tick(),postMessage({nodes:n,currentTick:c,totalTicks:f,type:Jy.TICK},void 0);t.ticking=!1}t.forceSimulation=a,t.ticking=!0}catch(l){t.ticking=!1,console.warn(l)}}overlapProcess(e){const t=this,n=t.nodeSize,i=t.nodeSpacing;let a,o;const s=t.collideStrength;if(ft(i)?o=()=>i:To(i)?o=i:o=()=>0,!n)a=u=>u.size?qn(u.size)?(u.size[0]>u.size[1]?u.size[0]:u.size[1])/2+o(u):Ma(u.size)?(u.size.width>u.size.height?u.size.width:u.size.height)/2+o(u):u.size/2+o(u):10+o(u);else if(To(n))a=u=>n(u)+o(u);else if(qn(n)){const l=(n[0]>n[1]?n[0]:n[1])/2;a=f=>l+o(f)}else if(ft(n)){const u=n/2;a=l=>u+o(l)}else a=()=>10;e.force("collisionForce",XE(a).strength(s))}updateCfg(e){const t=this;t.ticking&&(t.forceSimulation.stop(),t.ticking=!1),t.forceSimulation=null,Object.assign(t,e)}destroy(){const e=this;e.ticking&&(e.forceSimulation.stop(),e.ticking=!1),e.nodes=null,e.edges=null,e.destroyed=!0}}function T8(r){const e=r.alphaMin(),t=r.alphaTarget(),n=r.alpha(),i=Math.log((e-t)/(n-t))/Math.log(1-r.alphaDecay());return Math.ceil(i)}function M8(){return typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope}function I8(r,e,t,n){r.forEach((i,a)=>{r[a].children=[],r[a].parent=[]}),n?e.forEach(i=>{const a=_r(i,"source"),o=_r(i,"target");let s=0;a&&(s=t[a]);let u=0;o&&(u=t[o]);const l=r[s].children,f=r[u].parent;l.push(r[u].id),f.push(r[s].id)}):e.forEach(i=>{const a=_r(i,"source"),o=_r(i,"target");let s=0;a&&(s=t[a]);let u=0;o&&(u=t[o]);const l=r[s].children,f=r[u].children;l.push(r[u].id),f.push(r[s].id)})}function k8(r,e,t){const n=t.length;for(let i=0;i<n;i++){const a=_r(t[i],"source"),o=_r(t[i],"target");if(r.id===a&&e.id===o||e.id===a&&r.id===o)return!0}return!1}function D8(r,e){const t=r.degree,n=e.degree;return t<n?-1:t>n?1:0}class P8 extends hi{constructor(e){super();this.radius=null,this.startRadius=null,this.endRadius=null,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.divisions=1,this.ordering=null,this.angleRatio=1,this.nodes=[],this.edges=[],this.nodeMap={},this.degrees=[],this.width=300,this.height=300,this.updateCfg(e)}getDefaultCfg(){return{radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1}}execute(){const e=this,t=e.nodes,n=e.edges,i=t.length;if(i===0){e.onLayoutEnd&&e.onLayoutEnd();return}!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const a=e.center;if(i===1){t[0].x=a[0],t[0].y=a[1],e.onLayoutEnd&&e.onLayoutEnd();return}let o=e.radius,s=e.startRadius,u=e.endRadius;const l=e.divisions,f=e.startAngle,c=e.endAngle,h=(c-f)/i,d={};t.forEach((_,S)=>{d[_.id]=S}),e.nodeMap=d;const v=kf(t.length,d,n);e.degrees=v,!o&&!s&&!u?o=e.height>e.width?e.width/2:e.height/2:!s&&u?s=u:s&&!u&&(u=s);const p=e.angleRatio,g=h*p,y=e.ordering;let m=[];y==="topology"?m=e.topologyOrdering():y==="topology-directed"?m=e.topologyOrdering(!0):y==="degree"?m=e.degreeOrdering():m=t;const b=e.clockwise,x=Math.ceil(i/l);for(let _=0;_<i;++_){let S=o;!S&&s!==null&&u!==null&&(S=s+_*(u-s)/(i-1)),S||(S=10+_*100/(i-1));let E=f+_%x*g+2*Math.PI/l*Math.floor(_/x);b||(E=c-_%x*g-2*Math.PI/l*Math.floor(_/x)),m[_].x=a[0]+Math.cos(E)*S,m[_].y=a[1]+Math.sin(E)*S,m[_].weight=v[_]}return e.onLayoutEnd&&e.onLayoutEnd(),{nodes:m,edges:this.edges}}topologyOrdering(e=!1){const t=this,n=t.degrees,i=t.edges,a=t.nodes,o=Yy(a),s=t.nodeMap,u=[o[0]],l=[a[0]],f=[],c=a.length;f[0]=!0,I8(o,i,s,e);let h=0;return o.forEach((d,v)=>{if(v!==0)if((v===c-1||n[v]!==n[v+1]||k8(u[h],d,i))&&!f[v])u.push(d),l.push(a[s[d.id]]),f[v]=!0,h++;else{const p=u[h].children;let g=!1;for(let m=0;m<p.length;m++){const b=s[p[m]];if(n[b]===n[v]&&!f[b]){u.push(o[b]),l.push(a[s[o[b].id]]),f[b]=!0,g=!0;break}}let y=0;for(;!g&&(f[y]||(u.push(o[y]),l.push(a[s[o[y].id]]),f[y]=!0,g=!0),y++,y!==c););}}),l}degreeOrdering(){const e=this,t=e.nodes,n=[],i=e.degrees;return t.forEach((a,o)=>{a.degree=i[o],n.push(a)}),n.sort(D8),n}getType(){return"circular"}}function N8(){this.__data__=[],this.size=0}var L8=N8;function O8(r,e){return r===e||r!==r&&e!==e}var Gu=O8;function R8(r,e){for(var t=r.length;t--;)if(Gu(r[t][0],e))return t;return-1}var _d=R8,B8=Array.prototype,G8=B8.splice;function F8(r){var e=this.__data__,t=_d(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():G8.call(e,t,1),--this.size,!0}var U8=F8;function z8(r){var e=this.__data__,t=_d(e,r);return t<0?void 0:e[t][1]}var $8=z8;function V8(r){return _d(this.__data__,r)>-1}var W8=V8;function j8(r,e){var t=this.__data__,n=_d(t,r);return n<0?(++this.size,t.push([r,e])):t[n][1]=e,this}var X8=j8;function Fu(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Fu.prototype.clear=L8;Fu.prototype.delete=U8;Fu.prototype.get=$8;Fu.prototype.has=W8;Fu.prototype.set=X8;var wd=Fu;function H8(){this.__data__=new wd,this.size=0}var Y8=H8;function q8(r){var e=this.__data__,t=e.delete(r);return this.size=e.size,t}var K8=q8;function Z8(r){return this.__data__.get(r)}var Q8=Z8;function J8(r){return this.__data__.has(r)}var e$=J8,t$=typeof ss=="object"&&ss&&ss.Object===Object&&ss,JE=t$,r$=typeof self=="object"&&self&&self.Object===Object&&self,n$=JE||r$||Function("return this")(),ia=n$,i$=ia.Symbol,$i=i$,e2=Object.prototype,a$=e2.hasOwnProperty,o$=e2.toString,Pf=$i?$i.toStringTag:void 0;function s$(r){var e=a$.call(r,Pf),t=r[Pf];try{r[Pf]=void 0;var n=!0}catch(a){}var i=o$.call(r);return n&&(e?r[Pf]=t:delete r[Pf]),i}var u$=s$,l$=Object.prototype,f$=l$.toString;function c$(r){return f$.call(r)}var h$=c$,d$="[object Null]",v$="[object Undefined]",t2=$i?$i.toStringTag:void 0;function p$(r){return r==null?r===void 0?v$:d$:t2&&t2 in Object(r)?u$(r):h$(r)}var Io=p$;function g$(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var xi=g$,y$="[object AsyncFunction]",m$="[object Function]",b$="[object GeneratorFunction]",x$="[object Proxy]";function _$(r){if(!xi(r))return!1;var e=Io(r);return e==m$||e==b$||e==y$||e==x$}var Nf=_$,w$=ia["__core-js_shared__"],em=w$,r2=function(){var r=/[^.]+$/.exec(em&&em.keys&&em.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function S$(r){return!!r2&&r2 in r}var E$=S$,C$=Function.prototype,A$=C$.toString;function T$(r){if(r!=null){try{return A$.call(r)}catch(e){}try{return r+""}catch(e){}}return""}var Ms=T$,M$=/[\\^$.*+?()[\]{}|]/g,I$=/^\[object .+?Constructor\]$/,k$=Function.prototype,D$=Object.prototype,P$=k$.toString,N$=D$.hasOwnProperty,L$=RegExp("^"+P$.call(N$).replace(M$,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function O$(r){if(!xi(r)||E$(r))return!1;var e=Nf(r)?L$:I$;return e.test(Ms(r))}var R$=O$;function B$(r,e){return r==null?void 0:r[e]}var G$=B$;function F$(r,e){var t=G$(r,e);return R$(t)?t:void 0}var Is=F$,U$=Is(ia,"Map"),Lf=U$,z$=Is(Object,"create"),Of=z$;function $$(){this.__data__=Of?Of(null):{},this.size=0}var V$=$$;function W$(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var j$=W$,X$="__lodash_hash_undefined__",H$=Object.prototype,Y$=H$.hasOwnProperty;function q$(r){var e=this.__data__;if(Of){var t=e[r];return t===X$?void 0:t}return Y$.call(e,r)?e[r]:void 0}var K$=q$,Z$=Object.prototype,Q$=Z$.hasOwnProperty;function J$(r){var e=this.__data__;return Of?e[r]!==void 0:Q$.call(e,r)}var eV=J$,tV="__lodash_hash_undefined__";function rV(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=Of&&e===void 0?tV:e,this}var nV=rV;function Uu(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Uu.prototype.clear=V$;Uu.prototype.delete=j$;Uu.prototype.get=K$;Uu.prototype.has=eV;Uu.prototype.set=nV;var n2=Uu;function iV(){this.size=0,this.__data__={hash:new n2,map:new(Lf||wd),string:new n2}}var aV=iV;function oV(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}var sV=oV;function uV(r,e){var t=r.__data__;return sV(e)?t[typeof e=="string"?"string":"hash"]:t.map}var Sd=uV;function lV(r){var e=Sd(this,r).delete(r);return this.size-=e?1:0,e}var fV=lV;function cV(r){return Sd(this,r).get(r)}var hV=cV;function dV(r){return Sd(this,r).has(r)}var vV=dV;function pV(r,e){var t=Sd(this,r),n=t.size;return t.set(r,e),this.size+=t.size==n?0:1,this}var gV=pV;function zu(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}zu.prototype.clear=aV;zu.prototype.delete=fV;zu.prototype.get=hV;zu.prototype.has=vV;zu.prototype.set=gV;var Ed=zu,yV=200;function mV(r,e){var t=this.__data__;if(t instanceof wd){var n=t.__data__;if(!Lf||n.length<yV-1)return n.push([r,e]),this.size=++t.size,this;t=this.__data__=new Ed(n)}return t.set(r,e),this.size=t.size,this}var bV=mV;function $u(r){var e=this.__data__=new wd(r);this.size=e.size}$u.prototype.clear=Y8;$u.prototype.delete=K8;$u.prototype.get=Q8;$u.prototype.has=e$;$u.prototype.set=bV;var Vu=$u;function xV(r,e){for(var t=-1,n=r==null?0:r.length;++t<n&&e(r[t],t,r)!==!1;);return r}var tm=xV,_V=function(){try{var r=Is(Object,"defineProperty");return r({},"",{}),r}catch(e){}}(),Cd=_V;function wV(r,e,t){e=="__proto__"&&Cd?Cd(r,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):r[e]=t}var Ad=wV,SV=Object.prototype,EV=SV.hasOwnProperty;function CV(r,e,t){var n=r[e];(!(EV.call(r,e)&&Gu(n,t))||t===void 0&&!(e in r))&&Ad(r,e,t)}var Td=CV;function AV(r,e,t,n){var i=!t;t||(t={});for(var a=-1,o=e.length;++a<o;){var s=e[a],u=n?n(t[s],r[s],s,t,r):void 0;u===void 0&&(u=r[s]),i?Ad(t,s,u):Td(t,s,u)}return t}var Rf=AV;function TV(r,e){for(var t=-1,n=Array(r);++t<r;)n[t]=e(t);return n}var MV=TV;function IV(r){return r!=null&&typeof r=="object"}var aa=IV,kV="[object Arguments]";function DV(r){return aa(r)&&Io(r)==kV}var i2=DV,a2=Object.prototype,PV=a2.hasOwnProperty,NV=a2.propertyIsEnumerable,LV=i2(function(){return arguments}())?i2:function(r){return aa(r)&&PV.call(r,"callee")&&!NV.call(r,"callee")},Wu=LV,OV=Array.isArray,mn=OV;function RV(){return!1}var BV=RV,ks=xr(function(r,e){var t=e&&!e.nodeType&&e,n=t&&!0&&r&&!r.nodeType&&r,i=n&&n.exports===t,a=i?ia.Buffer:void 0,o=a?a.isBuffer:void 0,s=o||BV;r.exports=s}),GV=9007199254740991,FV=/^(?:0|[1-9]\d*)$/;function UV(r,e){var t=typeof r;return e=e==null?GV:e,!!e&&(t=="number"||t!="symbol"&&FV.test(r))&&r>-1&&r%1==0&&r<e}var Md=UV,zV=9007199254740991;function $V(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=zV}var rm=$V,VV="[object Arguments]",WV="[object Array]",jV="[object Boolean]",XV="[object Date]",HV="[object Error]",YV="[object Function]",qV="[object Map]",KV="[object Number]",ZV="[object Object]",QV="[object RegExp]",JV="[object Set]",eW="[object String]",tW="[object WeakMap]",rW="[object ArrayBuffer]",nW="[object DataView]",iW="[object Float32Array]",aW="[object Float64Array]",oW="[object Int8Array]",sW="[object Int16Array]",uW="[object Int32Array]",lW="[object Uint8Array]",fW="[object Uint8ClampedArray]",cW="[object Uint16Array]",hW="[object Uint32Array]",Qr={};Qr[iW]=Qr[aW]=Qr[oW]=Qr[sW]=Qr[uW]=Qr[lW]=Qr[fW]=Qr[cW]=Qr[hW]=!0;Qr[VV]=Qr[WV]=Qr[rW]=Qr[jV]=Qr[nW]=Qr[XV]=Qr[HV]=Qr[YV]=Qr[qV]=Qr[KV]=Qr[ZV]=Qr[QV]=Qr[JV]=Qr[eW]=Qr[tW]=!1;function dW(r){return aa(r)&&rm(r.length)&&!!Qr[Io(r)]}var vW=dW;function pW(r){return function(e){return r(e)}}var Id=pW,ju=xr(function(r,e){var t=e&&!e.nodeType&&e,n=t&&!0&&r&&!r.nodeType&&r,i=n&&n.exports===t,a=i&&JE.process,o=function(){try{var s=n&&n.require&&n.require("util").types;return s||a&&a.binding&&a.binding("util")}catch(u){}}();r.exports=o}),o2=ju&&ju.isTypedArray,gW=o2?Id(o2):vW,Bf=gW,yW=Object.prototype,mW=yW.hasOwnProperty;function bW(r,e){var t=mn(r),n=!t&&Wu(r),i=!t&&!n&&ks(r),a=!t&&!n&&!i&&Bf(r),o=t||n||i||a,s=o?MV(r.length,String):[],u=s.length;for(var l in r)(e||mW.call(r,l))&&!(o&&(l=="length"||i&&(l=="offset"||l=="parent")||a&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||Md(l,u)))&&s.push(l);return s}var s2=bW,xW=Object.prototype;function _W(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||xW;return r===t}var kd=_W;function wW(r,e){return function(t){return r(e(t))}}var u2=wW,SW=u2(Object.keys,Object),EW=SW,CW=Object.prototype,AW=CW.hasOwnProperty;function TW(r){if(!kd(r))return EW(r);var e=[];for(var t in Object(r))AW.call(r,t)&&t!="constructor"&&e.push(t);return e}var nm=TW;function MW(r){return r!=null&&rm(r.length)&&!Nf(r)}var Ya=MW;function IW(r){return Ya(r)?s2(r):nm(r)}var ko=IW;function kW(r,e){return r&&Rf(e,ko(e),r)}var DW=kW;function PW(r){var e=[];if(r!=null)for(var t in Object(r))e.push(t);return e}var NW=PW,LW=Object.prototype,OW=LW.hasOwnProperty;function RW(r){if(!xi(r))return NW(r);var e=kd(r),t=[];for(var n in r)n=="constructor"&&(e||!OW.call(r,n))||t.push(n);return t}var BW=RW;function GW(r){return Ya(r)?s2(r,!0):BW(r)}var Ds=GW;function FW(r,e){return r&&Rf(e,Ds(e),r)}var UW=FW,l2=xr(function(r,e){var t=e&&!e.nodeType&&e,n=t&&!0&&r&&!r.nodeType&&r,i=n&&n.exports===t,a=i?ia.Buffer:void 0,o=a?a.allocUnsafe:void 0;function s(u,l){if(l)return u.slice();var f=u.length,c=o?o(f):new u.constructor(f);return u.copy(c),c}r.exports=s});function zW(r,e){var t=-1,n=r.length;for(e||(e=Array(n));++t<n;)e[t]=r[t];return e}var f2=zW;function $W(r,e){for(var t=-1,n=r==null?0:r.length,i=0,a=[];++t<n;){var o=r[t];e(o,t,r)&&(a[i++]=o)}return a}var c2=$W;function VW(){return[]}var h2=VW,WW=Object.prototype,jW=WW.propertyIsEnumerable,d2=Object.getOwnPropertySymbols,XW=d2?function(r){return r==null?[]:(r=Object(r),c2(d2(r),function(e){return jW.call(r,e)}))}:h2,im=XW;function HW(r,e){return Rf(r,im(r),e)}var YW=HW;function qW(r,e){for(var t=-1,n=e.length,i=r.length;++t<n;)r[i+t]=e[t];return r}var am=qW,KW=u2(Object.getPrototypeOf,Object),Dd=KW,ZW=Object.getOwnPropertySymbols,QW=ZW?function(r){for(var e=[];r;)am(e,im(r)),r=Dd(r);return e}:h2,v2=QW;function JW(r,e){return Rf(r,v2(r),e)}var e9=JW;function t9(r,e,t){var n=e(r);return mn(r)?n:am(n,t(r))}var p2=t9;function r9(r){return p2(r,ko,im)}var om=r9;function n9(r){return p2(r,Ds,v2)}var i9=n9,a9=Is(ia,"DataView"),sm=a9,o9=Is(ia,"Promise"),um=o9,s9=Is(ia,"Set"),Xu=s9,u9=Is(ia,"WeakMap"),lm=u9,g2="[object Map]",l9="[object Object]",y2="[object Promise]",m2="[object Set]",b2="[object WeakMap]",x2="[object DataView]",f9=Ms(sm),c9=Ms(Lf),h9=Ms(um),d9=Ms(Xu),v9=Ms(lm),Ps=Io;(sm&&Ps(new sm(new ArrayBuffer(1)))!=x2||Lf&&Ps(new Lf)!=g2||um&&Ps(um.resolve())!=y2||Xu&&Ps(new Xu)!=m2||lm&&Ps(new lm)!=b2)&&(Ps=function(r){var e=Io(r),t=e==l9?r.constructor:void 0,n=t?Ms(t):"";if(n)switch(n){case f9:return x2;case c9:return g2;case h9:return y2;case d9:return m2;case v9:return b2}return e});var Ns=Ps,p9=Object.prototype,g9=p9.hasOwnProperty;function y9(r){var e=r.length,t=new r.constructor(e);return e&&typeof r[0]=="string"&&g9.call(r,"index")&&(t.index=r.index,t.input=r.input),t}var m9=y9,b9=ia.Uint8Array,Pd=b9;function x9(r){var e=new r.constructor(r.byteLength);return new Pd(e).set(new Pd(r)),e}var fm=x9;function _9(r,e){var t=e?fm(r.buffer):r.buffer;return new r.constructor(t,r.byteOffset,r.byteLength)}var w9=_9,S9=/\w*$/;function E9(r){var e=new r.constructor(r.source,S9.exec(r));return e.lastIndex=r.lastIndex,e}var C9=E9,_2=$i?$i.prototype:void 0,w2=_2?_2.valueOf:void 0;function A9(r){return w2?Object(w2.call(r)):{}}var T9=A9;function M9(r,e){var t=e?fm(r.buffer):r.buffer;return new r.constructor(t,r.byteOffset,r.length)}var S2=M9,I9="[object Boolean]",k9="[object Date]",D9="[object Map]",P9="[object Number]",N9="[object RegExp]",L9="[object Set]",O9="[object String]",R9="[object Symbol]",B9="[object ArrayBuffer]",G9="[object DataView]",F9="[object Float32Array]",U9="[object Float64Array]",z9="[object Int8Array]",$9="[object Int16Array]",V9="[object Int32Array]",W9="[object Uint8Array]",j9="[object Uint8ClampedArray]",X9="[object Uint16Array]",H9="[object Uint32Array]";function Y9(r,e,t){var n=r.constructor;switch(e){case B9:return fm(r);case I9:case k9:return new n(+r);case G9:return w9(r,t);case F9:case U9:case z9:case $9:case V9:case W9:case j9:case X9:case H9:return S2(r,t);case D9:return new n;case P9:case O9:return new n(r);case N9:return C9(r);case L9:return new n;case R9:return T9(r)}}var q9=Y9,E2=Object.create,K9=function(){function r(){}return function(e){if(!xi(e))return{};if(E2)return E2(e);r.prototype=e;var t=new r;return r.prototype=void 0,t}}(),C2=K9;function Z9(r){return typeof r.constructor=="function"&&!kd(r)?C2(Dd(r)):{}}var A2=Z9,Q9="[object Map]";function J9(r){return aa(r)&&Ns(r)==Q9}var ej=J9,T2=ju&&ju.isMap,tj=T2?Id(T2):ej,rj=tj,nj="[object Set]";function ij(r){return aa(r)&&Ns(r)==nj}var aj=ij,M2=ju&&ju.isSet,oj=M2?Id(M2):aj,sj=oj,uj=1,lj=2,fj=4,I2="[object Arguments]",cj="[object Array]",hj="[object Boolean]",dj="[object Date]",vj="[object Error]",k2="[object Function]",pj="[object GeneratorFunction]",gj="[object Map]",yj="[object Number]",D2="[object Object]",mj="[object RegExp]",bj="[object Set]",xj="[object String]",_j="[object Symbol]",wj="[object WeakMap]",Sj="[object ArrayBuffer]",Ej="[object DataView]",Cj="[object Float32Array]",Aj="[object Float64Array]",Tj="[object Int8Array]",Mj="[object Int16Array]",Ij="[object Int32Array]",kj="[object Uint8Array]",Dj="[object Uint8ClampedArray]",Pj="[object Uint16Array]",Nj="[object Uint32Array]",qr={};qr[I2]=qr[cj]=qr[Sj]=qr[Ej]=qr[hj]=qr[dj]=qr[Cj]=qr[Aj]=qr[Tj]=qr[Mj]=qr[Ij]=qr[gj]=qr[yj]=qr[D2]=qr[mj]=qr[bj]=qr[xj]=qr[_j]=qr[kj]=qr[Dj]=qr[Pj]=qr[Nj]=!0;qr[vj]=qr[k2]=qr[wj]=!1;function Nd(r,e,t,n,i,a){var o,s=e&uj,u=e&lj,l=e&fj;if(t&&(o=i?t(r,n,i,a):t(r)),o!==void 0)return o;if(!xi(r))return r;var f=mn(r);if(f){if(o=m9(r),!s)return f2(r,o)}else{var c=Ns(r),h=c==k2||c==pj;if(ks(r))return l2(r,s);if(c==D2||c==I2||h&&!i){if(o=u||h?{}:A2(r),!s)return u?e9(r,UW(o,r)):YW(r,DW(o,r))}else{if(!qr[c])return i?r:{};o=q9(r,c,s)}}a||(a=new Vu);var d=a.get(r);if(d)return d;a.set(r,o),sj(r)?r.forEach(function(g){o.add(Nd(g,e,t,g,r,a))}):rj(r)&&r.forEach(function(g,y){o.set(y,Nd(g,e,t,y,r,a))});var v=l?u?i9:om:u?Ds:ko,p=f?void 0:v(r);return tm(p||r,function(g,y){p&&(y=g,g=r[y]),Td(o,y,Nd(g,e,t,y,r,a))}),o}var P2=Nd,Lj=4;function Oj(r){return P2(r,Lj)}var Rj=Oj;function Bj(r){return function(){return r}}var cm=Bj;function Gj(r){return function(e,t,n){for(var i=-1,a=Object(e),o=n(e),s=o.length;s--;){var u=o[r?s:++i];if(t(a[u],u,a)===!1)break}return e}}var Fj=Gj,Uj=Fj(),hm=Uj;function zj(r,e){return r&&hm(r,e,ko)}var dm=zj;function $j(r,e){return function(t,n){if(t==null)return t;if(!Ya(t))return r(t,n);for(var i=t.length,a=e?i:-1,o=Object(t);(e?a--:++a<i)&&n(o[a],a,o)!==!1;);return t}}var Vj=$j,Wj=Vj(dm),Ld=Wj;function jj(r){return r}var Ls=jj;function Xj(r){return typeof r=="function"?r:Ls}var N2=Xj;function Hj(r,e){var t=mn(r)?tm:Ld;return t(r,N2(e))}var L2=Hj,O2=L2;function Yj(r,e){var t=[];return Ld(r,function(n,i,a){e(n,i,a)&&t.push(n)}),t}var qj=Yj,Kj="__lodash_hash_undefined__";function Zj(r){return this.__data__.set(r,Kj),this}var Qj=Zj;function Jj(r){return this.__data__.has(r)}var eX=Jj;function Od(r){var e=-1,t=r==null?0:r.length;for(this.__data__=new Ed;++e<t;)this.add(r[e])}Od.prototype.add=Od.prototype.push=Qj;Od.prototype.has=eX;var R2=Od;function tX(r,e){for(var t=-1,n=r==null?0:r.length;++t<n;)if(e(r[t],t,r))return!0;return!1}var rX=tX;function nX(r,e){return r.has(e)}var B2=nX,iX=1,aX=2;function oX(r,e,t,n,i,a){var o=t&iX,s=r.length,u=e.length;if(s!=u&&!(o&&u>s))return!1;var l=a.get(r),f=a.get(e);if(l&&f)return l==e&&f==r;var c=-1,h=!0,d=t&aX?new R2:void 0;for(a.set(r,e),a.set(e,r);++c<s;){var v=r[c],p=e[c];if(n)var g=o?n(p,v,c,e,r,a):n(v,p,c,r,e,a);if(g!==void 0){if(g)continue;h=!1;break}if(d){if(!rX(e,function(y,m){if(!B2(d,m)&&(v===y||i(v,y,t,n,a)))return d.push(m)})){h=!1;break}}else if(!(v===p||i(v,p,t,n,a))){h=!1;break}}return a.delete(r),a.delete(e),h}var G2=oX;function sX(r){var e=-1,t=Array(r.size);return r.forEach(function(n,i){t[++e]=[i,n]}),t}var uX=sX;function lX(r){var e=-1,t=Array(r.size);return r.forEach(function(n){t[++e]=n}),t}var vm=lX,fX=1,cX=2,hX="[object Boolean]",dX="[object Date]",vX="[object Error]",pX="[object Map]",gX="[object Number]",yX="[object RegExp]",mX="[object Set]",bX="[object String]",xX="[object Symbol]",_X="[object ArrayBuffer]",wX="[object DataView]",F2=$i?$i.prototype:void 0,pm=F2?F2.valueOf:void 0;function SX(r,e,t,n,i,a,o){switch(t){case wX:if(r.byteLength!=e.byteLength||r.byteOffset!=e.byteOffset)return!1;r=r.buffer,e=e.buffer;case _X:return!(r.byteLength!=e.byteLength||!a(new Pd(r),new Pd(e)));case hX:case dX:case gX:return Gu(+r,+e);case vX:return r.name==e.name&&r.message==e.message;case yX:case bX:return r==e+"";case pX:var s=uX;case mX:var u=n&fX;if(s||(s=vm),r.size!=e.size&&!u)return!1;var l=o.get(r);if(l)return l==e;n|=cX,o.set(r,e);var f=G2(s(r),s(e),n,i,a,o);return o.delete(r),f;case xX:if(pm)return pm.call(r)==pm.call(e)}return!1}var EX=SX,CX=1,AX=Object.prototype,TX=AX.hasOwnProperty;function MX(r,e,t,n,i,a){var o=t&CX,s=om(r),u=s.length,l=om(e),f=l.length;if(u!=f&&!o)return!1;for(var c=u;c--;){var h=s[c];if(!(o?h in e:TX.call(e,h)))return!1}var d=a.get(r),v=a.get(e);if(d&&v)return d==e&&v==r;var p=!0;a.set(r,e),a.set(e,r);for(var g=o;++c<u;){h=s[c];var y=r[h],m=e[h];if(n)var b=o?n(m,y,h,e,r,a):n(y,m,h,r,e,a);if(!(b===void 0?y===m||i(y,m,t,n,a):b)){p=!1;break}g||(g=h=="constructor")}if(p&&!g){var x=r.constructor,_=e.constructor;x!=_&&"constructor"in r&&"constructor"in e&&!(typeof x=="function"&&x instanceof x&&typeof _=="function"&&_ instanceof _)&&(p=!1)}return a.delete(r),a.delete(e),p}var IX=MX,kX=1,U2="[object Arguments]",z2="[object Array]",Rd="[object Object]",DX=Object.prototype,$2=DX.hasOwnProperty;function PX(r,e,t,n,i,a){var o=mn(r),s=mn(e),u=o?z2:Ns(r),l=s?z2:Ns(e);u=u==U2?Rd:u,l=l==U2?Rd:l;var f=u==Rd,c=l==Rd,h=u==l;if(h&&ks(r)){if(!ks(e))return!1;o=!0,f=!1}if(h&&!f)return a||(a=new Vu),o||Bf(r)?G2(r,e,t,n,i,a):EX(r,e,u,t,n,i,a);if(!(t&kX)){var d=f&&$2.call(r,"__wrapped__"),v=c&&$2.call(e,"__wrapped__");if(d||v){var p=d?r.value():r,g=v?e.value():e;return a||(a=new Vu),i(p,g,t,n,a)}}return h?(a||(a=new Vu),IX(r,e,t,n,i,a)):!1}var NX=PX;function V2(r,e,t,n,i){return r===e?!0:r==null||e==null||!aa(r)&&!aa(e)?r!==r&&e!==e:NX(r,e,t,n,V2,i)}var W2=V2,LX=1,OX=2;function RX(r,e,t,n){var i=t.length,a=i,o=!n;if(r==null)return!a;for(r=Object(r);i--;){var s=t[i];if(o&&s[2]?s[1]!==r[s[0]]:!(s[0]in r))return!1}for(;++i<a;){s=t[i];var u=s[0],l=r[u],f=s[1];if(o&&s[2]){if(l===void 0&&!(u in r))return!1}else{var c=new Vu;if(n)var h=n(l,f,u,r,e,c);if(!(h===void 0?W2(f,l,LX|OX,n,c):h))return!1}}return!0}var BX=RX;function GX(r){return r===r&&!xi(r)}var j2=GX;function FX(r){for(var e=ko(r),t=e.length;t--;){var n=e[t],i=r[n];e[t]=[n,i,j2(i)]}return e}var UX=FX;function zX(r,e){return function(t){return t==null?!1:t[r]===e&&(e!==void 0||r in Object(t))}}var X2=zX;function $X(r){var e=UX(r);return e.length==1&&e[0][2]?X2(e[0][0],e[0][1]):function(t){return t===r||BX(t,r,e)}}var VX=$X,WX="[object Symbol]";function jX(r){return typeof r=="symbol"||aa(r)&&Io(r)==WX}var Os=jX,XX=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,HX=/^\w*$/;function YX(r,e){if(mn(r))return!1;var t=typeof r;return t=="number"||t=="symbol"||t=="boolean"||r==null||Os(r)?!0:HX.test(r)||!XX.test(r)||e!=null&&r in Object(e)}var gm=YX,qX="Expected a function";function ym(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError(qX);var t=function(){var n=arguments,i=e?e.apply(this,n):n[0],a=t.cache;if(a.has(i))return a.get(i);var o=r.apply(this,n);return t.cache=a.set(i,o)||a,o};return t.cache=new(ym.Cache||Ed),t}ym.Cache=Ed;var KX=ym,ZX=500;function QX(r){var e=KX(r,function(n){return t.size===ZX&&t.clear(),n}),t=e.cache;return e}var JX=QX,e7=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,t7=/\\(\\)?/g,r7=JX(function(r){var e=[];return r.charCodeAt(0)===46&&e.push(""),r.replace(e7,function(t,n,i,a){e.push(i?a.replace(t7,"$1"):n||t)}),e}),n7=r7;function i7(r,e){for(var t=-1,n=r==null?0:r.length,i=Array(n);++t<n;)i[t]=e(r[t],t,r);return i}var Hu=i7,a7=1/0,H2=$i?$i.prototype:void 0,Y2=H2?H2.toString:void 0;function q2(r){if(typeof r=="string")return r;if(mn(r))return Hu(r,q2)+"";if(Os(r))return Y2?Y2.call(r):"";var e=r+"";return e=="0"&&1/r==-a7?"-0":e}var o7=q2;function s7(r){return r==null?"":o7(r)}var K2=s7;function u7(r,e){return mn(r)?r:gm(r,e)?[r]:n7(K2(r))}var Bd=u7,l7=1/0;function f7(r){if(typeof r=="string"||Os(r))return r;var e=r+"";return e=="0"&&1/r==-l7?"-0":e}var Gf=f7;function c7(r,e){e=Bd(e,r);for(var t=0,n=e.length;r!=null&&t<n;)r=r[Gf(e[t++])];return t&&t==n?r:void 0}var Gd=c7;function h7(r,e,t){var n=r==null?void 0:Gd(r,e);return n===void 0?t:n}var d7=h7;function v7(r,e){return r!=null&&e in Object(r)}var p7=v7;function g7(r,e,t){e=Bd(e,r);for(var n=-1,i=e.length,a=!1;++n<i;){var o=Gf(e[n]);if(!(a=r!=null&&t(r,o)))break;r=r[o]}return a||++n!=i?a:(i=r==null?0:r.length,!!i&&rm(i)&&Md(o,i)&&(mn(r)||Wu(r)))}var Z2=g7;function y7(r,e){return r!=null&&Z2(r,e,p7)}var Q2=y7,m7=1,b7=2;function x7(r,e){return gm(r)&&j2(e)?X2(Gf(r),e):function(t){var n=d7(t,r);return n===void 0&&n===e?Q2(t,r):W2(e,n,m7|b7)}}var _7=x7;function w7(r){return function(e){return e==null?void 0:e[r]}}var J2=w7;function S7(r){return function(e){return Gd(e,r)}}var E7=S7;function C7(r){return gm(r)?J2(Gf(r)):E7(r)}var A7=C7;function T7(r){return typeof r=="function"?r:r==null?Ls:typeof r=="object"?mn(r)?_7(r[0],r[1]):VX(r):A7(r)}var qa=T7;function M7(r,e){var t=mn(r)?c2:qj;return t(r,qa(e))}var eC=M7,I7=Object.prototype,k7=I7.hasOwnProperty;function D7(r,e){return r!=null&&k7.call(r,e)}var P7=D7;function N7(r,e){return r!=null&&Z2(r,e,P7)}var tC=N7,L7="[object Map]",O7="[object Set]",R7=Object.prototype,B7=R7.hasOwnProperty;function G7(r){if(r==null)return!0;if(Ya(r)&&(mn(r)||typeof r=="string"||typeof r.splice=="function"||ks(r)||Bf(r)||Wu(r)))return!r.length;var e=Ns(r);if(e==L7||e==O7)return!r.size;if(kd(r))return!nm(r).length;for(var t in r)if(B7.call(r,t))return!1;return!0}var F7=G7;function U7(r){return r===void 0}var rC=U7;function z7(r,e){var t=-1,n=Ya(r)?Array(r.length):[];return Ld(r,function(i,a,o){n[++t]=e(i,a,o)}),n}var nC=z7;function $7(r,e){var t=mn(r)?Hu:nC;return t(r,qa(e))}var iC=$7;function V7(r,e,t,n){var i=-1,a=r==null?0:r.length;for(n&&a&&(t=r[++i]);++i<a;)t=e(t,r[i],i,r);return t}var W7=V7;function j7(r,e,t,n,i){return i(r,function(a,o,s){t=n?(n=!1,a):e(t,a,o,s)}),t}var X7=j7;function H7(r,e,t){var n=mn(r)?W7:X7,i=arguments.length<3;return n(r,qa(e),t,i,Ld)}var aC=H7,Y7="[object String]";function q7(r){return typeof r=="string"||!mn(r)&&aa(r)&&Io(r)==Y7}var K7=q7,Z7=J2("length"),Q7=Z7,J7="\\ud800-\\udfff",eH="\\u0300-\\u036f",tH="\\ufe20-\\ufe2f",rH="\\u20d0-\\u20ff",nH=eH+tH+rH,iH="\\ufe0e\\ufe0f",aH="\\u200d",oH=RegExp("["+aH+J7+nH+iH+"]");function sH(r){return oH.test(r)}var uH=sH,oC="\\ud800-\\udfff",lH="\\u0300-\\u036f",fH="\\ufe20-\\ufe2f",cH="\\u20d0-\\u20ff",hH=lH+fH+cH,dH="\\ufe0e\\ufe0f",vH="["+oC+"]",mm="["+hH+"]",bm="\\ud83c[\\udffb-\\udfff]",pH="(?:"+mm+"|"+bm+")",sC="[^"+oC+"]",uC="(?:\\ud83c[\\udde6-\\uddff]){2}",lC="[\\ud800-\\udbff][\\udc00-\\udfff]",gH="\\u200d",fC=pH+"?",cC="["+dH+"]?",yH="(?:"+gH+"(?:"+[sC,uC,lC].join("|")+")"+cC+fC+")*",mH=cC+fC+yH,bH="(?:"+[sC+mm+"?",mm,uC,lC,vH].join("|")+")",hC=RegExp(bm+"(?="+bm+")|"+bH+mH,"g");function xH(r){for(var e=hC.lastIndex=0;hC.test(r);)++e;return e}var _H=xH;function wH(r){return uH(r)?_H(r):Q7(r)}var SH=wH,EH="[object Map]",CH="[object Set]";function AH(r){if(r==null)return 0;if(Ya(r))return K7(r)?SH(r):r.length;var e=Ns(r);return e==EH||e==CH?r.size:nm(r).length}var TH=AH;function MH(r,e,t){var n=mn(r),i=n||ks(r)||Bf(r);if(e=qa(e),t==null){var a=r&&r.constructor;i?t=n?new a:[]:xi(r)?t=Nf(a)?C2(Dd(r)):{}:t={}}return(i?tm:dm)(r,function(o,s,u){return e(t,o,s,u)}),t}var IH=MH,dC=$i?$i.isConcatSpreadable:void 0;function kH(r){return mn(r)||Wu(r)||!!(dC&&r&&r[dC])}var DH=kH;function vC(r,e,t,n,i){var a=-1,o=r.length;for(t||(t=DH),i||(i=[]);++a<o;){var s=r[a];e>0&&t(s)?e>1?vC(s,e-1,t,n,i):am(i,s):n||(i[i.length]=s)}return i}var xm=vC;function PH(r,e,t){switch(t.length){case 0:return r.call(e);case 1:return r.call(e,t[0]);case 2:return r.call(e,t[0],t[1]);case 3:return r.call(e,t[0],t[1],t[2])}return r.apply(e,t)}var NH=PH,pC=Math.max;function LH(r,e,t){return e=pC(e===void 0?r.length-1:e,0),function(){for(var n=arguments,i=-1,a=pC(n.length-e,0),o=Array(a);++i<a;)o[i]=n[e+i];i=-1;for(var s=Array(e+1);++i<e;)s[i]=n[i];return s[e]=t(o),NH(r,this,s)}}var gC=LH,OH=Cd?function(r,e){return Cd(r,"toString",{configurable:!0,enumerable:!1,value:cm(e),writable:!0})}:Ls,RH=OH,BH=800,GH=16,FH=Date.now;function UH(r){var e=0,t=0;return function(){var n=FH(),i=GH-(n-t);if(t=n,i>0){if(++e>=BH)return arguments[0]}else e=0;return r.apply(void 0,arguments)}}var zH=UH,$H=zH(RH),yC=$H;function VH(r,e){return yC(gC(r,e,Ls),r+"")}var Fd=VH;function WH(r,e,t,n){for(var i=r.length,a=t+(n?1:-1);n?a--:++a<i;)if(e(r[a],a,r))return a;return-1}var mC=WH;function jH(r){return r!==r}var XH=jH;function HH(r,e,t){for(var n=t-1,i=r.length;++n<i;)if(r[n]===e)return n;return-1}var YH=HH;function qH(r,e,t){return e===e?YH(r,e,t):mC(r,XH,t)}var KH=qH;function ZH(r,e){var t=r==null?0:r.length;return!!t&&KH(r,e,0)>-1}var QH=ZH;function JH(r,e,t){for(var n=-1,i=r==null?0:r.length;++n<i;)if(t(e,r[n]))return!0;return!1}var eY=JH;function tY(){}var rY=tY,nY=1/0,iY=Xu&&1/vm(new Xu([,-0]))[1]==nY?function(r){return new Xu(r)}:rY,aY=iY,oY=200;function sY(r,e,t){var n=-1,i=QH,a=r.length,o=!0,s=[],u=s;if(t)o=!1,i=eY;else if(a>=oY){var l=e?null:aY(r);if(l)return vm(l);o=!1,i=B2,u=new R2}else u=e?[]:s;e:for(;++n<a;){var f=r[n],c=e?e(f):f;if(f=t||f!==0?f:0,o&&c===c){for(var h=u.length;h--;)if(u[h]===c)continue e;e&&u.push(c),s.push(f)}else i(u,c,t)||(u!==s&&u.push(c),s.push(f))}return s}var uY=sY;function lY(r){return aa(r)&&Ya(r)}var bC=lY,fY=Fd(function(r){return uY(xm(r,1,bC,!0))}),cY=fY;function hY(r,e){return Hu(e,function(t){return r[t]})}var dY=hY;function vY(r){return r==null?[]:dY(r,ko(r))}var xC=vY,Ud;if(typeof jp=="function")try{Ud={clone:Rj,constant:cm,each:O2,filter:eC,has:tC,isArray:mn,isEmpty:F7,isFunction:Nf,isUndefined:rC,keys:ko,map:iC,reduce:aC,size:TH,transform:IH,union:cY,values:xC}}catch(r){}Ud||(Ud=window._);var vt=Ud,_m=pr,pY="\0",Rs="\0",_C="";function pr(r){this._isDirected=vt.has(r,"directed")?r.directed:!0,this._isMultigraph=vt.has(r,"multigraph")?r.multigraph:!1,this._isCompound=vt.has(r,"compound")?r.compound:!1,this._label=void 0,this._defaultNodeLabelFn=vt.constant(void 0),this._defaultEdgeLabelFn=vt.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[Rs]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}pr.prototype._nodeCount=0;pr.prototype._edgeCount=0;pr.prototype.isDirected=function(){return this._isDirected};pr.prototype.isMultigraph=function(){return this._isMultigraph};pr.prototype.isCompound=function(){return this._isCompound};pr.prototype.setGraph=function(r){return this._label=r,this};pr.prototype.graph=function(){return this._label};pr.prototype.setDefaultNodeLabel=function(r){return vt.isFunction(r)||(r=vt.constant(r)),this._defaultNodeLabelFn=r,this};pr.prototype.nodeCount=function(){return this._nodeCount};pr.prototype.nodes=function(){return vt.keys(this._nodes)};pr.prototype.sources=function(){var r=this;return vt.filter(this.nodes(),function(e){return vt.isEmpty(r._in[e])})};pr.prototype.sinks=function(){var r=this;return vt.filter(this.nodes(),function(e){return vt.isEmpty(r._out[e])})};pr.prototype.setNodes=function(r,e){var t=arguments,n=this;return vt.each(r,function(i){t.length>1?n.setNode(i,e):n.setNode(i)}),this};pr.prototype.setNode=function(r,e){return vt.has(this._nodes,r)?(arguments.length>1&&(this._nodes[r]=e),this):(this._nodes[r]=arguments.length>1?e:this._defaultNodeLabelFn(r),this._isCompound&&(this._parent[r]=Rs,this._children[r]={},this._children[Rs][r]=!0),this._in[r]={},this._preds[r]={},this._out[r]={},this._sucs[r]={},++this._nodeCount,this)};pr.prototype.node=function(r){return this._nodes[r]};pr.prototype.hasNode=function(r){return vt.has(this._nodes,r)};pr.prototype.removeNode=function(r){var e=this;if(vt.has(this._nodes,r)){var t=function(n){e.removeEdge(e._edgeObjs[n])};delete this._nodes[r],this._isCompound&&(this._removeFromParentsChildList(r),delete this._parent[r],vt.each(this.children(r),function(n){e.setParent(n)}),delete this._children[r]),vt.each(vt.keys(this._in[r]),t),delete this._in[r],delete this._preds[r],vt.each(vt.keys(this._out[r]),t),delete this._out[r],delete this._sucs[r],--this._nodeCount}return this};pr.prototype.setParent=function(r,e){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(vt.isUndefined(e))e=Rs;else{e+="";for(var t=e;!vt.isUndefined(t);t=this.parent(t))if(t===r)throw new Error("Setting "+e+" as parent of "+r+" would create a cycle");this.setNode(e)}return this.setNode(r),this._removeFromParentsChildList(r),this._parent[r]=e,this._children[e][r]=!0,this};pr.prototype._removeFromParentsChildList=function(r){delete this._children[this._parent[r]][r]};pr.prototype.parent=function(r){if(this._isCompound){var e=this._parent[r];if(e!==Rs)return e}};pr.prototype.children=function(r){if(vt.isUndefined(r)&&(r=Rs),this._isCompound){var e=this._children[r];if(e)return vt.keys(e)}else{if(r===Rs)return this.nodes();if(this.hasNode(r))return[]}};pr.prototype.predecessors=function(r){var e=this._preds[r];if(e)return vt.keys(e)};pr.prototype.successors=function(r){var e=this._sucs[r];if(e)return vt.keys(e)};pr.prototype.neighbors=function(r){var e=this.predecessors(r);if(e)return vt.union(e,this.successors(r))};pr.prototype.isLeaf=function(r){var e;return this.isDirected()?e=this.successors(r):e=this.neighbors(r),e.length===0};pr.prototype.filterNodes=function(r){var e=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});e.setGraph(this.graph());var t=this;vt.each(this._nodes,function(a,o){r(o)&&e.setNode(o,a)}),vt.each(this._edgeObjs,function(a){e.hasNode(a.v)&&e.hasNode(a.w)&&e.setEdge(a,t.edge(a))});var n={};function i(a){var o=t.parent(a);return o===void 0||e.hasNode(o)?(n[a]=o,o):o in n?n[o]:i(o)}return this._isCompound&&vt.each(e.nodes(),function(a){e.setParent(a,i(a))}),e};pr.prototype.setDefaultEdgeLabel=function(r){return vt.isFunction(r)||(r=vt.constant(r)),this._defaultEdgeLabelFn=r,this};pr.prototype.edgeCount=function(){return this._edgeCount};pr.prototype.edges=function(){return vt.values(this._edgeObjs)};pr.prototype.setPath=function(r,e){var t=this,n=arguments;return vt.reduce(r,function(i,a){return n.length>1?t.setEdge(i,a,e):t.setEdge(i,a),a}),this};pr.prototype.setEdge=function(){var r,e,t,n,i=!1,a=arguments[0];typeof a=="object"&&a!==null&&"v"in a?(r=a.v,e=a.w,t=a.name,arguments.length===2&&(n=arguments[1],i=!0)):(r=a,e=arguments[1],t=arguments[3],arguments.length>2&&(n=arguments[2],i=!0)),r=""+r,e=""+e,vt.isUndefined(t)||(t=""+t);var o=Ff(this._isDirected,r,e,t);if(vt.has(this._edgeLabels,o))return i&&(this._edgeLabels[o]=n),this;if(!vt.isUndefined(t)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(r),this.setNode(e),this._edgeLabels[o]=i?n:this._defaultEdgeLabelFn(r,e,t);var s=gY(this._isDirected,r,e,t);return r=s.v,e=s.w,Object.freeze(s),this._edgeObjs[o]=s,wC(this._preds[e],r),wC(this._sucs[r],e),this._in[e][o]=s,this._out[r][o]=s,this._edgeCount++,this};pr.prototype.edge=function(r,e,t){var n=arguments.length===1?wm(this._isDirected,arguments[0]):Ff(this._isDirected,r,e,t);return this._edgeLabels[n]};pr.prototype.hasEdge=function(r,e,t){var n=arguments.length===1?wm(this._isDirected,arguments[0]):Ff(this._isDirected,r,e,t);return vt.has(this._edgeLabels,n)};pr.prototype.removeEdge=function(r,e,t){var n=arguments.length===1?wm(this._isDirected,arguments[0]):Ff(this._isDirected,r,e,t),i=this._edgeObjs[n];return i&&(r=i.v,e=i.w,delete this._edgeLabels[n],delete this._edgeObjs[n],SC(this._preds[e],r),SC(this._sucs[r],e),delete this._in[e][n],delete this._out[r][n],this._edgeCount--),this};pr.prototype.inEdges=function(r,e){var t=this._in[r];if(t){var n=vt.values(t);return e?vt.filter(n,function(i){return i.v===e}):n}};pr.prototype.outEdges=function(r,e){var t=this._out[r];if(t){var n=vt.values(t);return e?vt.filter(n,function(i){return i.w===e}):n}};pr.prototype.nodeEdges=function(r,e){var t=this.inEdges(r,e);if(t)return t.concat(this.outEdges(r,e))};function wC(r,e){r[e]?r[e]++:r[e]=1}function SC(r,e){--r[e]||delete r[e]}function Ff(r,e,t,n){var i=""+e,a=""+t;if(!r&&i>a){var o=i;i=a,a=o}return i+_C+a+_C+(vt.isUndefined(n)?pY:n)}function gY(r,e,t,n){var i=""+e,a=""+t;if(!r&&i>a){var o=i;i=a,a=o}var s={v:i,w:a};return n&&(s.name=n),s}function wm(r,e){return Ff(r,e.v,e.w,e.name)}var yY="2.1.8",EC={Graph:_m,version:yY},Sm={write:mY,read:_Y};function mY(r){var e={options:{directed:r.isDirected(),multigraph:r.isMultigraph(),compound:r.isCompound()},nodes:bY(r),edges:xY(r)};return vt.isUndefined(r.graph())||(e.value=vt.clone(r.graph())),e}function bY(r){return vt.map(r.nodes(),function(e){var t=r.node(e),n=r.parent(e),i={v:e};return vt.isUndefined(t)||(i.value=t),vt.isUndefined(n)||(i.parent=n),i})}function xY(r){return vt.map(r.edges(),function(e){var t=r.edge(e),n={v:e.v,w:e.w};return vt.isUndefined(e.name)||(n.name=e.name),vt.isUndefined(t)||(n.value=t),n})}function _Y(r){var e=new _m(r.options).setGraph(r.value);return vt.each(r.nodes,function(t){e.setNode(t.v,t.value),t.parent&&e.setParent(t.v,t.parent)}),vt.each(r.edges,function(t){e.setEdge({v:t.v,w:t.w,name:t.name},t.value)}),e}Sm.write;Sm.read;var wY=SY;function SY(r){var e={},t=[],n;function i(a){vt.has(e,a)||(e[a]=!0,n.push(a),vt.each(r.successors(a),i),vt.each(r.predecessors(a),i))}return vt.each(r.nodes(),function(a){n=[],i(a),n.length&&t.push(n)}),t}var CC=Vi;function Vi(){this._arr=[],this._keyIndices={}}Vi.prototype.size=function(){return this._arr.length};Vi.prototype.keys=function(){return this._arr.map(function(r){return r.key})};Vi.prototype.has=function(r){return vt.has(this._keyIndices,r)};Vi.prototype.priority=function(r){var e=this._keyIndices[r];if(e!==void 0)return this._arr[e].priority};Vi.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key};Vi.prototype.add=function(r,e){var t=this._keyIndices;if(r=String(r),!vt.has(t,r)){var n=this._arr,i=n.length;return t[r]=i,n.push({key:r,priority:e}),this._decrease(i),!0}return!1};Vi.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var r=this._arr.pop();return delete this._keyIndices[r.key],this._heapify(0),r.key};Vi.prototype.decrease=function(r,e){var t=this._keyIndices[r];if(e>this._arr[t].priority)throw new Error("New priority is greater than current priority. Key: "+r+" Old: "+this._arr[t].priority+" New: "+e);this._arr[t].priority=e,this._decrease(t)};Vi.prototype._heapify=function(r){var e=this._arr,t=2*r,n=t+1,i=r;t<e.length&&(i=e[t].priority<e[i].priority?t:i,n<e.length&&(i=e[n].priority<e[i].priority?n:i),i!==r&&(this._swap(r,i),this._heapify(i)))};Vi.prototype._decrease=function(r){for(var e=this._arr,t=e[r].priority,n;r!==0&&(n=r>>1,!(e[n].priority<t));)this._swap(r,n),r=n};Vi.prototype._swap=function(r,e){var t=this._arr,n=this._keyIndices,i=t[r],a=t[e];t[r]=a,t[e]=i,n[a.key]=r,n[i.key]=e};var AC=CY,EY=vt.constant(1);function CY(r,e,t,n){return AY(r,String(e),t||EY,n||function(i){return r.outEdges(i)})}function AY(r,e,t,n){var i={},a=new CC,o,s,u=function(l){var f=l.v!==o?l.v:l.w,c=i[f],h=t(l),d=s.distance+h;if(h<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+l+" Weight: "+h);d<c.distance&&(c.distance=d,c.predecessor=o,a.decrease(f,d))};for(r.nodes().forEach(function(l){var f=l===e?0:Number.POSITIVE_INFINITY;i[l]={distance:f},a.add(l,f)});a.size()>0&&(o=a.removeMin(),s=i[o],s.distance!==Number.POSITIVE_INFINITY);)n(o).forEach(u);return i}var TY=MY;function MY(r,e,t){return vt.transform(r.nodes(),function(n,i){n[i]=AC(r,i,e,t)},{})}var TC=IY;function IY(r){var e=0,t=[],n={},i=[];function a(o){var s=n[o]={onStack:!0,lowlink:e,index:e++};if(t.push(o),r.successors(o).forEach(function(f){vt.has(n,f)?n[f].onStack&&(s.lowlink=Math.min(s.lowlink,n[f].index)):(a(f),s.lowlink=Math.min(s.lowlink,n[f].lowlink))}),s.lowlink===s.index){var u=[],l;do l=t.pop(),n[l].onStack=!1,u.push(l);while(o!==l);i.push(u)}}return r.nodes().forEach(function(o){vt.has(n,o)||a(o)}),i}var kY=DY;function DY(r){return vt.filter(TC(r),function(e){return e.length>1||e.length===1&&r.hasEdge(e[0],e[0])})}var PY=LY,NY=vt.constant(1);function LY(r,e,t){return OY(r,e||NY,t||function(n){return r.outEdges(n)})}function OY(r,e,t){var n={},i=r.nodes();return i.forEach(function(a){n[a]={},n[a][a]={distance:0},i.forEach(function(o){a!==o&&(n[a][o]={distance:Number.POSITIVE_INFINITY})}),t(a).forEach(function(o){var s=o.v===a?o.w:o.v,u=e(o);n[a][s]={distance:u,predecessor:a}})}),i.forEach(function(a){var o=n[a];i.forEach(function(s){var u=n[s];i.forEach(function(l){var f=u[a],c=o[l],h=u[l],d=f.distance+c.distance;d<h.distance&&(h.distance=d,h.predecessor=c.predecessor)})})}),n}var Em=MC;MC.CycleException=zd;function MC(r){var e={},t={},n=[];function i(a){if(vt.has(t,a))throw new zd;vt.has(e,a)||(t[a]=!0,e[a]=!0,vt.each(r.predecessors(a),i),delete t[a],n.push(a))}if(vt.each(r.sinks(),i),vt.size(e)!==r.nodeCount())throw new zd;return n}function zd(){}zd.prototype=new Error;var RY=BY;function BY(r){try{Em(r)}catch(e){if(e instanceof Em.CycleException)return!1;throw e}return!0}var IC=GY;function GY(r,e,t){vt.isArray(e)||(e=[e]);var n=(r.isDirected()?r.successors:r.neighbors).bind(r),i=[],a={};return vt.each(e,function(o){if(!r.hasNode(o))throw new Error("Graph does not have node: "+o);kC(r,o,t==="post",a,n,i)}),i}function kC(r,e,t,n,i,a){vt.has(n,e)||(n[e]=!0,t||a.push(e),vt.each(i(e),function(o){kC(r,o,t,n,i,a)}),t&&a.push(e))}var FY=UY;function UY(r,e){return IC(r,e,"post")}var zY=$Y;function $Y(r,e){return IC(r,e,"pre")}var VY=WY;function WY(r,e){var t=new _m,n={},i=new CC,a;function o(u){var l=u.v===a?u.w:u.v,f=i.priority(l);if(f!==void 0){var c=e(u);c<f&&(n[l]=a,i.decrease(l,c))}}if(r.nodeCount()===0)return t;vt.each(r.nodes(),function(u){i.add(u,Number.POSITIVE_INFINITY),t.setNode(u)}),i.decrease(r.nodes()[0],0);for(var s=!1;i.size()>0;){if(a=i.removeMin(),vt.has(n,a))t.setEdge(a,n[a]);else{if(s)throw new Error("Input graph is not connected: "+r);s=!0}r.nodeEdges(a).forEach(o)}return t}var Wi={components:wY,dijkstra:AC,dijkstraAll:TY,findCycles:kY,floydWarshall:PY,isAcyclic:RY,postorder:FY,preorder:zY,prim:VY,tarjan:TC,topsort:Em};Wi.components;Wi.dijkstra;Wi.dijkstraAll;Wi.findCycles;Wi.floydWarshall;Wi.isAcyclic;Wi.postorder;Wi.preorder;Wi.prim;Wi.tarjan;Wi.topsort;var Uf={Graph:EC.Graph,json:Sm,alg:Wi,version:EC.version};Uf.Graph;Uf.json;Uf.alg;Uf.version;var $d;if(typeof jp=="function")try{$d=Uf}catch(r){}$d||($d=window.graphlib);var oa=$d,jY=1,XY=4;function HY(r){return P2(r,jY|XY)}var YY=HY;function qY(r,e,t){if(!xi(t))return!1;var n=typeof e;return(n=="number"?Ya(t)&&Md(e,t.length):n=="string"&&e in t)?Gu(t[e],r):!1}var zf=qY,DC=Object.prototype,KY=DC.hasOwnProperty,ZY=Fd(function(r,e){r=Object(r);var t=-1,n=e.length,i=n>2?e[2]:void 0;for(i&&zf(e[0],e[1],i)&&(n=1);++t<n;)for(var a=e[t],o=Ds(a),s=-1,u=o.length;++s<u;){var l=o[s],f=r[l];(f===void 0||Gu(f,DC[l])&&!KY.call(r,l))&&(r[l]=a[l])}return r}),QY=ZY;function JY(r){return function(e,t,n){var i=Object(e);if(!Ya(e)){var a=qa(t);e=ko(e),t=function(s){return a(i[s],s,i)}}var o=r(e,t,n);return o>-1?i[a?e[o]:o]:void 0}}var eq=JY,tq=/\s/;function rq(r){for(var e=r.length;e--&&tq.test(r.charAt(e)););return e}var nq=rq,iq=/^\s+/;function aq(r){return r&&r.slice(0,nq(r)+1).replace(iq,"")}var oq=aq,PC=0/0,sq=/^[-+]0x[0-9a-f]+$/i,uq=/^0b[01]+$/i,lq=/^0o[0-7]+$/i,fq=parseInt;function cq(r){if(typeof r=="number")return r;if(Os(r))return PC;if(xi(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=xi(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=oq(r);var t=uq.test(r);return t||lq.test(r)?fq(r.slice(2),t?2:8):sq.test(r)?PC:+r}var hq=cq,NC=1/0,dq=17976931348623157e292;function vq(r){if(!r)return r===0?r:0;if(r=hq(r),r===NC||r===-NC){var e=r<0?-1:1;return e*dq}return r===r?r:0}var Vd=vq;function pq(r){var e=Vd(r),t=e%1;return e===e?t?e-t:e:0}var gq=pq,yq=Math.max;function mq(r,e,t){var n=r==null?0:r.length;if(!n)return-1;var i=t==null?0:gq(t);return i<0&&(i=yq(n+i,0)),mC(r,qa(e),i)}var bq=mq,xq=eq(bq),_q=xq;function wq(r){var e=r==null?0:r.length;return e?xm(r,1):[]}var LC=wq;function Sq(r,e){return r==null?r:hm(r,N2(e),Ds)}var Eq=Sq;function Cq(r){var e=r==null?0:r.length;return e?r[e-1]:void 0}var Aq=Cq;function Tq(r,e){var t={};return e=qa(e),dm(r,function(n,i,a){Ad(t,i,e(n,i,a))}),t}var Mq=Tq;function Iq(r,e,t){for(var n=-1,i=r.length;++n<i;){var a=r[n],o=e(a);if(o!=null&&(s===void 0?o===o&&!Os(o):t(o,s)))var s=o,u=a}return u}var Cm=Iq;function kq(r,e){return r>e}var Dq=kq;function Pq(r){return r&&r.length?Cm(r,Ls,Dq):void 0}var Nq=Pq;function Lq(r,e,t){(t!==void 0&&!Gu(r[e],t)||t===void 0&&!(e in r))&&Ad(r,e,t)}var Am=Lq,Oq="[object Object]",Rq=Function.prototype,Bq=Object.prototype,OC=Rq.toString,Gq=Bq.hasOwnProperty,Fq=OC.call(Object);function Uq(r){if(!aa(r)||Io(r)!=Oq)return!1;var e=Dd(r);if(e===null)return!0;var t=Gq.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&OC.call(t)==Fq}var zq=Uq;function $q(r,e){if(!(e==="constructor"&&typeof r[e]=="function")&&e!="__proto__")return r[e]}var Tm=$q;function Vq(r){return Rf(r,Ds(r))}var Wq=Vq;function jq(r,e,t,n,i,a,o){var s=Tm(r,t),u=Tm(e,t),l=o.get(u);if(l){Am(r,t,l);return}var f=a?a(s,u,t+"",r,e,o):void 0,c=f===void 0;if(c){var h=mn(u),d=!h&&ks(u),v=!h&&!d&&Bf(u);f=u,h||d||v?mn(s)?f=s:bC(s)?f=f2(s):d?(c=!1,f=l2(u,!0)):v?(c=!1,f=S2(u,!0)):f=[]:zq(u)||Wu(u)?(f=s,Wu(s)?f=Wq(s):(!xi(s)||Nf(s))&&(f=A2(u))):c=!1}c&&(o.set(u,f),i(f,u,n,a,o),o.delete(u)),Am(r,t,f)}var Xq=jq;function RC(r,e,t,n,i){r!==e&&hm(e,function(a,o){if(i||(i=new Vu),xi(a))Xq(r,e,o,t,RC,n,i);else{var s=n?n(Tm(r,o),a,o+"",r,e,i):void 0;s===void 0&&(s=a),Am(r,o,s)}},Ds)}var Hq=RC;function Yq(r){return Fd(function(e,t){var n=-1,i=t.length,a=i>1?t[i-1]:void 0,o=i>2?t[2]:void 0;for(a=r.length>3&&typeof a=="function"?(i--,a):void 0,o&&zf(t[0],t[1],o)&&(a=i<3?void 0:a,i=1),e=Object(e);++n<i;){var s=t[n];s&&r(e,s,n,a)}return e})}var qq=Yq,Kq=qq(function(r,e,t){Hq(r,e,t)}),Zq=Kq;function Qq(r,e){return r<e}var BC=Qq;function Jq(r){return r&&r.length?Cm(r,Ls,BC):void 0}var eK=Jq;function tK(r,e){return r&&r.length?Cm(r,qa(e),BC):void 0}var rK=tK,nK=function(){return ia.Date.now()},iK=nK;function aK(r,e,t,n){if(!xi(r))return r;e=Bd(e,r);for(var i=-1,a=e.length,o=a-1,s=r;s!=null&&++i<a;){var u=Gf(e[i]),l=t;if(u==="__proto__"||u==="constructor"||u==="prototype")return r;if(i!=o){var f=s[u];l=n?n(f,u,s):void 0,l===void 0&&(l=xi(f)?f:Md(e[i+1])?[]:{})}Td(s,u,l),s=s[u]}return r}var oK=aK;function sK(r,e,t){for(var n=-1,i=e.length,a={};++n<i;){var o=e[n],s=Gd(r,o);t(s,o)&&oK(a,Bd(o,r),s)}return a}var uK=sK;function lK(r,e){return uK(r,e,function(t,n){return Q2(r,n)})}var fK=lK;function cK(r){return yC(gC(r,void 0,LC),r+"")}var hK=cK,dK=hK(function(r,e){return r==null?{}:fK(r,e)}),vK=dK,pK=Math.ceil,gK=Math.max;function yK(r,e,t,n){for(var i=-1,a=gK(pK((e-r)/(t||1)),0),o=Array(a);a--;)o[n?a:++i]=r,r+=t;return o}var mK=yK;function bK(r){return function(e,t,n){return n&&typeof n!="number"&&zf(e,t,n)&&(t=n=void 0),e=Vd(e),t===void 0?(t=e,e=0):t=Vd(t),n=n===void 0?e<t?1:-1:Vd(n),mK(e,t,n,r)}}var xK=bK,_K=xK(),wK=_K;function SK(r,e){var t=r.length;for(r.sort(e);t--;)r[t]=r[t].value;return r}var EK=SK;function CK(r,e){if(r!==e){var t=r!==void 0,n=r===null,i=r===r,a=Os(r),o=e!==void 0,s=e===null,u=e===e,l=Os(e);if(!s&&!l&&!a&&r>e||a&&o&&u&&!s&&!l||n&&o&&u||!t&&u||!i)return 1;if(!n&&!a&&!l&&r<e||l&&t&&i&&!n&&!a||s&&t&&i||!o&&i||!u)return-1}return 0}var AK=CK;function TK(r,e,t){for(var n=-1,i=r.criteria,a=e.criteria,o=i.length,s=t.length;++n<o;){var u=AK(i[n],a[n]);if(u){if(n>=s)return u;var l=t[n];return u*(l=="desc"?-1:1)}}return r.index-e.index}var MK=TK;function IK(r,e,t){e.length?e=Hu(e,function(a){return mn(a)?function(o){return Gd(o,a.length===1?a[0]:a)}:a}):e=[Ls];var n=-1;e=Hu(e,Id(qa));var i=nC(r,function(a,o,s){var u=Hu(e,function(l){return l(a)});return{criteria:u,index:++n,value:a}});return EK(i,function(a,o){return MK(a,o,t)})}var kK=IK,DK=Fd(function(r,e){if(r==null)return[];var t=e.length;return t>1&&zf(r,e[0],e[1])?e=[]:t>2&&zf(e[0],e[1],e[2])&&(e=[e[0]]),kK(r,xm(e,1),[])}),PK=DK,NK=0;function LK(r){var e=++NK;return K2(r)+e}var OK=LK;function RK(r,e,t){for(var n=-1,i=r.length,a=e.length,o={};++n<i;){var s=n<a?e[n]:void 0;t(o,r[n],s)}return o}var BK=RK;function GK(r,e){return BK(r||[],e||[],Td)}var FK=GK,Wd;if(typeof jp=="function")try{Wd={cloneDeep:YY,constant:cm,defaults:QY,each:O2,filter:eC,find:_q,flatten:LC,forEach:L2,forIn:Eq,has:tC,isUndefined:rC,last:Aq,map:iC,mapValues:Mq,max:Nq,merge:Zq,min:eK,minBy:rK,now:iK,pick:vK,range:wK,reduce:aC,sortBy:PK,uniqueId:OK,values:xC,zipObject:FK}}catch(r){}Wd||(Wd=window._);var X=Wd,UK=jd;function jd(){var r={};r._next=r._prev=r,this._sentinel=r}jd.prototype.dequeue=function(){var r=this._sentinel,e=r._prev;if(e!==r)return GC(e),e};jd.prototype.enqueue=function(r){var e=this._sentinel;r._prev&&r._next&&GC(r),r._next=e._next,e._next._prev=r,e._next=r,r._prev=e};jd.prototype.toString=function(){for(var r=[],e=this._sentinel,t=e._prev;t!==e;)r.push(JSON.stringify(t,zK)),t=t._prev;return"["+r.join(", ")+"]"};function GC(r){r._prev._next=r._next,r._next._prev=r._prev,delete r._next,delete r._prev}function zK(r,e){if(r!=="_next"&&r!=="_prev")return e}var $K=oa.Graph,VK=jK,WK=X.constant(1);function jK(r,e){if(r.nodeCount()<=1)return[];var t=HK(r,e||WK),n=XK(t.graph,t.buckets,t.zeroIdx);return X.flatten(X.map(n,function(i){return r.outEdges(i.v,i.w)}),!0)}function XK(r,e,t){for(var n=[],i=e[e.length-1],a=e[0],o;r.nodeCount();){for(;o=a.dequeue();)Mm(r,e,t,o);for(;o=i.dequeue();)Mm(r,e,t,o);if(r.nodeCount()){for(var s=e.length-2;s>0;--s)if(o=e[s].dequeue(),o){n=n.concat(Mm(r,e,t,o,!0));break}}}return n}function Mm(r,e,t,n,i){var a=i?[]:void 0;return X.forEach(r.inEdges(n.v),function(o){var s=r.edge(o),u=r.node(o.v);i&&a.push({v:o.v,w:o.w}),u.out-=s,Im(e,t,u)}),X.forEach(r.outEdges(n.v),function(o){var s=r.edge(o),u=o.w,l=r.node(u);l.in-=s,Im(e,t,l)}),r.removeNode(n.v),a}function HK(r,e){var t=new $K,n=0,i=0;X.forEach(r.nodes(),function(s){t.setNode(s,{v:s,in:0,out:0})}),X.forEach(r.edges(),function(s){var u=t.edge(s.v,s.w)||0,l=e(s),f=u+l;t.setEdge(s.v,s.w,f),i=Math.max(i,t.node(s.v).out+=l),n=Math.max(n,t.node(s.w).in+=l)});var a=X.range(i+n+3).map(function(){return new UK}),o=n+1;return X.forEach(t.nodes(),function(s){Im(a,o,t.node(s))}),{graph:t,buckets:a,zeroIdx:o}}function Im(r,e,t){t.out?t.in?r[t.out-t.in+e].enqueue(t):r[r.length-1].enqueue(t):r[0].enqueue(t)}var FC={run:YK,undo:KK};function YK(r){var e=r.graph().acyclicer==="greedy"?VK(r,t(r)):qK(r);X.forEach(e,function(n){var i=r.edge(n);r.removeEdge(n),i.forwardName=n.name,i.reversed=!0,r.setEdge(n.w,n.v,i,X.uniqueId("rev"))});function t(n){return function(i){return n.edge(i).weight}}}function qK(r){var e=[],t={},n={};function i(a){X.has(n,a)||(n[a]=!0,t[a]=!0,X.forEach(r.outEdges(a),function(o){X.has(t,o.w)?e.push(o):i(o.w)}),delete t[a])}return X.forEach(r.nodes(),i),e}function KK(r){X.forEach(r.edges(),function(e){var t=r.edge(e);if(t.reversed){r.removeEdge(e);var n=t.forwardName;delete t.reversed,delete t.forwardName,r.setEdge(e.w,e.v,t,n)}})}var UC=oa.Graph,jn={addDummyNode:zC,simplify:ZK,asNonCompoundGraph:QK,successorWeights:JK,predecessorWeights:eZ,intersectRect:tZ,buildLayerMatrix:rZ,normalizeRanks:nZ,removeEmptyRanks:iZ,addBorderNode:aZ,maxRank:$C,partition:oZ,time:sZ,notime:uZ};function zC(r,e,t,n){var i;do i=X.uniqueId(n);while(r.hasNode(i));return t.dummy=e,r.setNode(i,t),i}function ZK(r){var e=new UC().setGraph(r.graph());return X.forEach(r.nodes(),function(t){e.setNode(t,r.node(t))}),X.forEach(r.edges(),function(t){var n=e.edge(t.v,t.w)||{weight:0,minlen:1},i=r.edge(t);e.setEdge(t.v,t.w,{weight:n.weight+i.weight,minlen:Math.max(n.minlen,i.minlen)})}),e}function QK(r){var e=new UC({multigraph:r.isMultigraph()}).setGraph(r.graph());return X.forEach(r.nodes(),function(t){r.children(t).length||e.setNode(t,r.node(t))}),X.forEach(r.edges(),function(t){e.setEdge(t,r.edge(t))}),e}function JK(r){var e=X.map(r.nodes(),function(t){var n={};return X.forEach(r.outEdges(t),function(i){n[i.w]=(n[i.w]||0)+r.edge(i).weight}),n});return X.zipObject(r.nodes(),e)}function eZ(r){var e=X.map(r.nodes(),function(t){var n={};return X.forEach(r.inEdges(t),function(i){n[i.v]=(n[i.v]||0)+r.edge(i).weight}),n});return X.zipObject(r.nodes(),e)}function tZ(r,e){var t=r.x,n=r.y,i=e.x-t,a=e.y-n,o=r.width/2,s=r.height/2;if(!i&&!a)throw new Error("Not possible to find intersection inside of the rectangle");var u,l;return Math.abs(a)*o>Math.abs(i)*s?(a<0&&(s=-s),u=s*i/a,l=s):(i<0&&(o=-o),u=o,l=o*a/i),{x:t+u,y:n+l}}function rZ(r){var e=X.map(X.range($C(r)+1),function(){return[]});return X.forEach(r.nodes(),function(t){var n=r.node(t),i=n.rank;X.isUndefined(i)||(e[i][n.order]=t)}),e}function nZ(r){var e=X.min(X.map(r.nodes(),function(t){return r.node(t).rank}));X.forEach(r.nodes(),function(t){var n=r.node(t);X.has(n,"rank")&&(n.rank-=e)})}function iZ(r){var e=X.min(X.map(r.nodes(),function(a){return r.node(a).rank})),t=[];X.forEach(r.nodes(),function(a){var o=r.node(a).rank-e;t[o]||(t[o]=[]),t[o].push(a)});var n=0,i=r.graph().nodeRankFactor;X.forEach(t,function(a,o){X.isUndefined(a)&&o%i!=0?--n:n&&X.forEach(a,function(s){r.node(s).rank+=n})})}function aZ(r,e,t,n){var i={width:0,height:0};return arguments.length>=4&&(i.rank=t,i.order=n),zC(r,"border",i,e)}function $C(r){return X.max(X.map(r.nodes(),function(e){var t=r.node(e).rank;if(!X.isUndefined(t))return t}))}function oZ(r,e){var t={lhs:[],rhs:[]};return X.forEach(r,function(n){e(n)?t.lhs.push(n):t.rhs.push(n)}),t}function sZ(r,e){var t=X.now();try{return e()}finally{console.log(r+" time: "+(X.now()-t)+"ms")}}function uZ(r,e){return e()}var VC={run:lZ,undo:cZ};function lZ(r){r.graph().dummyChains=[],X.forEach(r.edges(),function(e){fZ(r,e)})}function fZ(r,e){var t=e.v,n=r.node(t).rank,i=e.w,a=r.node(i).rank,o=e.name,s=r.edge(e),u=s.labelRank;if(a!==n+1){r.removeEdge(e);var l,f,c;for(c=0,++n;n<a;++c,++n)s.points=[],f={width:0,height:0,edgeLabel:s,edgeObj:e,rank:n},l=jn.addDummyNode(r,"edge",f,"_d"),n===u&&(f.width=s.width,f.height=s.height,f.dummy="edge-label",f.labelpos=s.labelpos),r.setEdge(t,l,{weight:s.weight},o),c===0&&r.graph().dummyChains.push(l),t=l;r.setEdge(t,i,{weight:s.weight},o)}}function cZ(r){X.forEach(r.graph().dummyChains,function(e){var t=r.node(e),n=t.edgeLabel,i;for(r.setEdge(t.edgeObj,n);t.dummy;)i=r.successors(e)[0],r.removeNode(e),n.points.push({x:t.x,y:t.y}),t.dummy==="edge-label"&&(n.x=t.x,n.y=t.y,n.width=t.width,n.height=t.height),e=i,t=r.node(e)})}var Xd={longestPath:hZ,slack:dZ};function hZ(r){var e={};function t(n){var i=r.node(n);if(X.has(e,n))return i.rank;e[n]=!0;var a=X.min(X.map(r.outEdges(n),function(o){return t(o.w)-r.edge(o).minlen}));return(a===Number.POSITIVE_INFINITY||a===void 0||a===null)&&(a=0),i.rank=a}X.forEach(r.sources(),t)}function dZ(r,e){return r.node(e.w).rank-r.node(e.v).rank-r.edge(e).minlen}var vZ=oa.Graph,Hd=Xd.slack,WC=pZ;function pZ(r){var e=new vZ({directed:!1}),t=r.nodes()[0],n=r.nodeCount();e.setNode(t,{});for(var i,a;gZ(e,r)<n;)i=yZ(e,r),a=e.hasNode(i.v)?Hd(r,i):-Hd(r,i),mZ(e,r,a);return e}function gZ(r,e){function t(n){X.forEach(e.nodeEdges(n),function(i){var a=i.v,o=n===a?i.w:a;!r.hasNode(o)&&!Hd(e,i)&&(r.setNode(o,{}),r.setEdge(n,o,{}),t(o))})}return X.forEach(r.nodes(),t),r.nodeCount()}function yZ(r,e){return X.minBy(e.edges(),function(t){if(r.hasNode(t.v)!==r.hasNode(t.w))return Hd(e,t)})}function mZ(r,e,t){X.forEach(r.nodes(),function(n){e.node(n).rank+=t})}var bZ=Xd.slack,xZ=Xd.longestPath,_Z=oa.alg.preorder,wZ=oa.alg.postorder,SZ=jn.simplify,EZ=Bs;Bs.initLowLimValues=Dm;Bs.initCutValues=km;Bs.calcCutValue=jC;Bs.leaveEdge=HC;Bs.enterEdge=YC;Bs.exchangeEdges=qC;function Bs(r){r=SZ(r),xZ(r);var e=WC(r);Dm(e),km(e,r);for(var t,n;t=HC(e);)n=YC(e,r,t),qC(e,r,t,n)}function km(r,e){var t=wZ(r,r.nodes());t=t.slice(0,t.length-1),X.forEach(t,function(n){CZ(r,e,n)})}function CZ(r,e,t){var n=r.node(t),i=n.parent;r.edge(t,i).cutvalue=jC(r,e,t)}function jC(r,e,t){var n=r.node(t),i=n.parent,a=!0,o=e.edge(t,i),s=0;return o||(a=!1,o=e.edge(i,t)),s=o.weight,X.forEach(e.nodeEdges(t),function(u){var l=u.v===t,f=l?u.w:u.v;if(f!==i){var c=l===a,h=e.edge(u).weight;if(s+=c?h:-h,TZ(r,t,f)){var d=r.edge(t,f).cutvalue;s+=c?-d:d}}}),s}function Dm(r,e){arguments.length<2&&(e=r.nodes()[0]),XC(r,{},1,e)}function XC(r,e,t,n,i){var a=t,o=r.node(n);return e[n]=!0,X.forEach(r.neighbors(n),function(s){X.has(e,s)||(t=XC(r,e,t,s,n))}),o.low=a,o.lim=t++,i?o.parent=i:delete o.parent,t}function HC(r){return X.find(r.edges(),function(e){return r.edge(e).cutvalue<0})}function YC(r,e,t){var n=t.v,i=t.w;e.hasEdge(n,i)||(n=t.w,i=t.v);var a=r.node(n),o=r.node(i),s=a,u=!1;a.lim>o.lim&&(s=o,u=!0);var l=X.filter(e.edges(),function(f){return u===KC(r,r.node(f.v),s)&&u!==KC(r,r.node(f.w),s)});return X.minBy(l,function(f){return bZ(e,f)})}function qC(r,e,t,n){var i=t.v,a=t.w;r.removeEdge(i,a),r.setEdge(n.v,n.w,{}),Dm(r),km(r,e),AZ(r,e)}function AZ(r,e){var t=X.find(r.nodes(),function(i){return!e.node(i).parent}),n=_Z(r,t);n=n.slice(1),X.forEach(n,function(i){var a=r.node(i).parent,o=e.edge(i,a),s=!1;o||(o=e.edge(a,i),s=!0),e.node(i).rank=e.node(a).rank+(s?o.minlen:-o.minlen)})}function TZ(r,e,t){return r.hasEdge(e,t)}function KC(r,e,t){return t.low<=e.lim&&e.lim<=t.lim}var ZC=Xd.longestPath,MZ=IZ;function IZ(r){switch(r.graph().ranker){case"network-simplex":QC(r);break;case"tight-tree":DZ(r);break;case"longest-path":kZ(r);break;default:QC(r)}}var kZ=ZC;function DZ(r){ZC(r),WC(r)}function QC(r){EZ(r)}var PZ=NZ;function NZ(r){var e=OZ(r);X.forEach(r.graph().dummyChains,function(t){for(var n=r.node(t),i=n.edgeObj,a=LZ(r,e,i.v,i.w),o=a.path,s=a.lca,u=0,l=o[u],f=!0;t!==i.w;){if(n=r.node(t),f){for(;(l=o[u])!==s&&r.node(l).maxRank<n.rank;)u++;l===s&&(f=!1)}if(!f){for(;u<o.length-1&&r.node(l=o[u+1]).minRank<=n.rank;)u++;l=o[u]}r.setParent(t,l),t=r.successors(t)[0]}})}function LZ(r,e,t,n){var i=[],a=[],o=Math.min(e[t].low,e[n].low),s=Math.max(e[t].lim,e[n].lim),u,l;u=t;do u=r.parent(u),i.push(u);while(u&&(e[u].low>o||s>e[u].lim));for(l=u,u=n;(u=r.parent(u))!==l;)a.push(u);return{path:i.concat(a.reverse()),lca:l}}function OZ(r){var e={},t=0;function n(i){var a=t;X.forEach(r.children(i),n),e[i]={low:a,lim:t++}}return X.forEach(r.children(),n),e}var JC={run:RZ,cleanup:FZ};function RZ(r){var e=jn.addDummyNode(r,"root",{},"_root"),t=BZ(r),n=X.max(X.values(t))-1,i=2*n+1;r.graph().nestingRoot=e,X.forEach(r.edges(),function(o){r.edge(o).minlen*=i});var a=GZ(r)+1;X.forEach(r.children(),function(o){eA(r,e,i,a,n,t,o)}),r.graph().nodeRankFactor=i}function eA(r,e,t,n,i,a,o){var s=r.children(o);if(!s.length){o!==e&&r.setEdge(e,o,{weight:0,minlen:t});return}var u=jn.addBorderNode(r,"_bt"),l=jn.addBorderNode(r,"_bb"),f=r.node(o);r.setParent(u,o),f.borderTop=u,r.setParent(l,o),f.borderBottom=l,X.forEach(s,function(c){eA(r,e,t,n,i,a,c);var h=r.node(c),d=h.borderTop?h.borderTop:c,v=h.borderBottom?h.borderBottom:c,p=h.borderTop?n:2*n,g=d!==v?1:i-a[o]+1;r.setEdge(u,d,{weight:p,minlen:g,nestingEdge:!0}),r.setEdge(v,l,{weight:p,minlen:g,nestingEdge:!0})}),r.parent(o)||r.setEdge(e,u,{weight:0,minlen:i+a[o]})}function BZ(r){var e={};function t(n,i){var a=r.children(n);a&&a.length&&X.forEach(a,function(o){t(o,i+1)}),e[n]=i}return X.forEach(r.children(),function(n){t(n,1)}),e}function GZ(r){return X.reduce(r.edges(),function(e,t){return e+r.edge(t).weight},0)}function FZ(r){var e=r.graph();r.removeNode(e.nestingRoot),delete e.nestingRoot,X.forEach(r.edges(),function(t){var n=r.edge(t);n.nestingEdge&&r.removeEdge(t)})}var UZ=zZ;function zZ(r){function e(t){var n=r.children(t),i=r.node(t);if(n.length&&X.forEach(n,e),X.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var a=i.minRank,o=i.maxRank+1;a<o;++a)tA(r,"borderLeft","_bl",t,i,a),tA(r,"borderRight","_br",t,i,a)}}X.forEach(r.children(),e)}function tA(r,e,t,n,i,a){var o={width:0,height:0,rank:a,borderType:e},s=i[e][a-1],u=jn.addDummyNode(r,"border",o,t);i[e][a]=u,r.setParent(u,n),s&&r.setEdge(s,u,{weight:1})}var rA={adjust:$Z,undo:VZ};function $Z(r){var e=r.graph().rankdir.toLowerCase();(e==="lr"||e==="rl")&&nA(r)}function VZ(r){var e=r.graph().rankdir.toLowerCase();(e==="bt"||e==="rl")&&WZ(r),(e==="lr"||e==="rl")&&(jZ(r),nA(r))}function nA(r){X.forEach(r.nodes(),function(e){iA(r.node(e))}),X.forEach(r.edges(),function(e){iA(r.edge(e))})}function iA(r){var e=r.width;r.width=r.height,r.height=e}function WZ(r){X.forEach(r.nodes(),function(e){Pm(r.node(e))}),X.forEach(r.edges(),function(e){var t=r.edge(e);X.forEach(t.points,Pm),X.has(t,"y")&&Pm(t)})}function Pm(r){r.y=-r.y}function jZ(r){X.forEach(r.nodes(),function(e){Nm(r.node(e))}),X.forEach(r.edges(),function(e){var t=r.edge(e);X.forEach(t.points,Nm),X.has(t,"x")&&Nm(t)})}function Nm(r){var e=r.x;r.x=r.y,r.y=e}var XZ=HZ;function HZ(r){var e={},t=X.filter(r.nodes(),function(s){return!r.children(s).length}),n=X.max(X.map(t,function(s){return r.node(s).rank})),i=X.map(X.range(n+1),function(){return[]});function a(s){if(!X.has(e,s)){e[s]=!0;var u=r.node(s);i[u.rank].push(s),X.forEach(r.successors(s),a)}}var o=X.sortBy(t,function(s){return r.node(s).rank});return X.forEach(o,a),i}var YZ=qZ;function qZ(r,e){for(var t=0,n=1;n<e.length;++n)t+=KZ(r,e[n-1],e[n]);return t}function KZ(r,e,t){for(var n=X.zipObject(t,X.map(t,function(l,f){return f})),i=X.flatten(X.map(e,function(l){return X.sortBy(X.map(r.outEdges(l),function(f){return{pos:n[f.w],weight:r.edge(f).weight}}),"pos")}),!0),a=1;a<t.length;)a<<=1;var o=2*a-1;a-=1;var s=X.map(new Array(o),function(){return 0}),u=0;return X.forEach(i.forEach(function(l){var f=l.pos+a;s[f]+=l.weight;for(var c=0;f>0;)f%2&&(c+=s[f+1]),f=f-1>>1,s[f]+=l.weight;u+=l.weight*c})),u}var ZZ=QZ;function QZ(r,e){return X.map(e,function(t){var n=r.inEdges(t);if(n.length){var i=X.reduce(n,function(a,o){var s=r.edge(o),u=r.node(o.v);return{sum:a.sum+s.weight*u.order,weight:a.weight+s.weight}},{sum:0,weight:0});return{v:t,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:t}})}var JZ=eQ;function eQ(r,e){var t={};X.forEach(r,function(i,a){var o=t[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:a};X.isUndefined(i.barycenter)||(o.barycenter=i.barycenter,o.weight=i.weight)}),X.forEach(e.edges(),function(i){var a=t[i.v],o=t[i.w];!X.isUndefined(a)&&!X.isUndefined(o)&&(o.indegree++,a.out.push(t[i.w]))});var n=X.filter(t,function(i){return!i.indegree});return tQ(n)}function tQ(r){var e=[];function t(a){return function(o){o.merged||(X.isUndefined(o.barycenter)||X.isUndefined(a.barycenter)||o.barycenter>=a.barycenter)&&rQ(a,o)}}function n(a){return function(o){o.in.push(a),--o.indegree==0&&r.push(o)}}for(;r.length;){var i=r.pop();e.push(i),X.forEach(i.in.reverse(),t(i)),X.forEach(i.out,n(i))}return X.map(X.filter(e,function(a){return!a.merged}),function(a){return X.pick(a,["vs","i","barycenter","weight"])})}function rQ(r,e){var t=0,n=0;r.weight&&(t+=r.barycenter*r.weight,n+=r.weight),e.weight&&(t+=e.barycenter*e.weight,n+=e.weight),r.vs=e.vs.concat(r.vs),r.barycenter=t/n,r.weight=n,r.i=Math.min(e.i,r.i),e.merged=!0}var nQ=iQ;function iQ(r,e){var t=jn.partition(r,function(f){return X.has(f,"barycenter")}),n=t.lhs,i=X.sortBy(t.rhs,function(f){return-f.i}),a=[],o=0,s=0,u=0;n.sort(aQ(!!e)),u=aA(a,i,u),X.forEach(n,function(f){u+=f.vs.length,a.push(f.vs),o+=f.barycenter*f.weight,s+=f.weight,u=aA(a,i,u)});var l={vs:X.flatten(a,!0)};return s&&(l.barycenter=o/s,l.weight=s),l}function aA(r,e,t){for(var n;e.length&&(n=X.last(e)).i<=t;)e.pop(),r.push(n.vs),t++;return t}function aQ(r){return function(e,t){return e.barycenter<t.barycenter?-1:e.barycenter>t.barycenter?1:r?t.i-e.i:e.i-t.i}}var oQ=oA;function oA(r,e,t,n){var i=r.children(e),a=r.node(e),o=a?a.borderLeft:void 0,s=a?a.borderRight:void 0,u={};o&&(i=X.filter(i,function(v){return v!==o&&v!==s}));var l=ZZ(r,i);X.forEach(l,function(v){if(r.children(v.v).length){var p=oA(r,v.v,t,n);u[v.v]=p,X.has(p,"barycenter")&&uQ(v,p)}});var f=JZ(l,t);sQ(f,u);var c=nQ(f,n);if(o&&(c.vs=X.flatten([o,c.vs,s],!0),r.predecessors(o).length)){var h=r.node(r.predecessors(o)[0]),d=r.node(r.predecessors(s)[0]);X.has(c,"barycenter")||(c.barycenter=0,c.weight=0),c.barycenter=(c.barycenter*c.weight+h.order+d.order)/(c.weight+2),c.weight+=2}return c}function sQ(r,e){X.forEach(r,function(t){t.vs=X.flatten(t.vs.map(function(n){return e[n]?e[n].vs:n}),!0)})}function uQ(r,e){X.isUndefined(r.barycenter)?(r.barycenter=e.barycenter,r.weight=e.weight):(r.barycenter=(r.barycenter*r.weight+e.barycenter*e.weight)/(r.weight+e.weight),r.weight+=e.weight)}var lQ=oa.Graph,fQ=cQ;function cQ(r,e,t){var n=hQ(r),i=new lQ({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(function(a){return r.node(a)});return X.forEach(r.nodes(),function(a){var o=r.node(a),s=r.parent(a);(o.rank===e||o.minRank<=e&&e<=o.maxRank)&&(i.setNode(a),i.setParent(a,s||n),X.forEach(r[t](a),function(u){var l=u.v===a?u.w:u.v,f=i.edge(l,a),c=X.isUndefined(f)?0:f.weight;i.setEdge(l,a,{weight:r.edge(u).weight+c})}),X.has(o,"minRank")&&i.setNode(a,{borderLeft:o.borderLeft[e],borderRight:o.borderRight[e]}))}),i}function hQ(r){for(var e;r.hasNode(e=X.uniqueId("_root")););return e}var dQ=vQ;function vQ(r,e,t){var n={},i;X.forEach(t,function(a){for(var o=r.parent(a),s,u;o;){if(s=r.parent(o),s?(u=n[s],n[s]=o):(u=i,i=o),u&&u!==o){e.setEdge(u,o);return}o=s}})}var pQ=oa.Graph,gQ=yQ;function yQ(r){var e=jn.maxRank(r),t=sA(r,X.range(1,e+1),"inEdges"),n=sA(r,X.range(e-1,-1,-1),"outEdges"),i=XZ(r);uA(r,i);for(var a=Number.POSITIVE_INFINITY,o,s=0,u=0;u<4;++s,++u){mQ(s%2?t:n,s%4>=2),i=jn.buildLayerMatrix(r);var l=YZ(r,i);l<a&&(u=0,o=X.cloneDeep(i),a=l)}uA(r,o)}function sA(r,e,t){return X.map(e,function(n){return fQ(r,n,t)})}function mQ(r,e){var t=new pQ;X.forEach(r,function(n){var i=n.graph().root,a=oQ(n,i,t,e);X.forEach(a.vs,function(o,s){n.node(o).order=s}),dQ(n,t,a.vs)})}function uA(r,e){X.forEach(e,function(t){X.forEach(t,function(n,i){r.node(n).order=i})})}var bQ=oa.Graph,xQ={positionX:SQ,findType1Conflicts:lA,findType2Conflicts:fA,addConflict:Lm,hasConflict:cA,verticalAlignment:hA,horizontalCompaction:dA,alignCoordinates:pA,findSmallestWidthAlignment:vA,balance:gA};function lA(r,e){var t={};function n(i,a){var o=0,s=0,u=i.length,l=X.last(a);return X.forEach(a,function(f,c){var h=_Q(r,f),d=h?r.node(h).order:u;(h||f===l)&&(X.forEach(a.slice(s,c+1),function(v){X.forEach(r.predecessors(v),function(p){var g=r.node(p),y=g.order;(y<o||d<y)&&!(g.dummy&&r.node(v).dummy)&&Lm(t,p,v)})}),s=c+1,o=d)}),a}return X.reduce(e,n),t}function fA(r,e){var t={};function n(a,o,s,u,l){var f;X.forEach(X.range(o,s),function(c){f=a[c],r.node(f).dummy&&X.forEach(r.predecessors(f),function(h){var d=r.node(h);d.dummy&&(d.order<u||d.order>l)&&Lm(t,h,f)})})}function i(a,o){var s=-1,u,l=0;return X.forEach(o,function(f,c){if(r.node(f).dummy==="border"){var h=r.predecessors(f);h.length&&(u=r.node(h[0]).order,n(o,l,c,s,u),l=c,s=u)}n(o,l,o.length,u,a.length)}),o}return X.reduce(e,i),t}function _Q(r,e){if(r.node(e).dummy)return X.find(r.predecessors(e),function(t){return r.node(t).dummy})}function Lm(r,e,t){if(e>t){var n=e;e=t,t=n}var i=r[e];i||(r[e]=i={}),i[t]=!0}function cA(r,e,t){if(e>t){var n=e;e=t,t=n}return X.has(r[e],t)}function hA(r,e,t,n){var i={},a={},o={};return X.forEach(e,function(s){X.forEach(s,function(u,l){i[u]=u,a[u]=u,o[u]=l})}),X.forEach(e,function(s){var u=-1;X.forEach(s,function(l){var f=n(l);if(f.length){f=X.sortBy(f,function(p){return o[p]});for(var c=(f.length-1)/2,h=Math.floor(c),d=Math.ceil(c);h<=d;++h){var v=f[h];a[l]===l&&u<o[v]&&!cA(t,l,v)&&(a[v]=l,a[l]=i[l]=i[v],u=o[v])}}})}),{root:i,align:a}}function dA(r,e,t,n,i){var a={},o=wQ(r,e,t,i),s=i?"borderLeft":"borderRight";function u(c,h){for(var d=o.nodes(),v=d.pop(),p={};v;)p[v]?c(v):(p[v]=!0,d.push(v),d=d.concat(h(v))),v=d.pop()}function l(c){a[c]=o.inEdges(c).reduce(function(h,d){return Math.max(h,a[d.v]+o.edge(d))},0)}function f(c){var h=o.outEdges(c).reduce(function(v,p){return Math.min(v,a[p.w]-o.edge(p))},Number.POSITIVE_INFINITY),d=r.node(c);h!==Number.POSITIVE_INFINITY&&d.borderType!==s&&(a[c]=Math.max(a[c],h))}return u(l,o.predecessors.bind(o)),u(f,o.successors.bind(o)),X.forEach(n,function(c){a[c]=a[t[c]]}),a}function wQ(r,e,t,n){var i=new bQ,a=r.graph(),o=EQ(a.nodesep,a.edgesep,n);return X.forEach(e,function(s){var u;X.forEach(s,function(l){var f=t[l];if(i.setNode(f),u){var c=t[u],h=i.edge(c,f);i.setEdge(c,f,Math.max(o(r,l,u),h||0))}u=l})}),i}function vA(r,e){return X.minBy(X.values(e),function(t){var n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return X.forIn(t,function(a,o){var s=CQ(r,o)/2;n=Math.max(a+s,n),i=Math.min(a-s,i)}),n-i})}function pA(r,e){var t=X.values(e),n=X.min(t),i=X.max(t);X.forEach(["u","d"],function(a){X.forEach(["l","r"],function(o){var s=a+o,u=r[s],l;if(u!==e){var f=X.values(u);l=o==="l"?n-X.min(f):i-X.max(f),l&&(r[s]=X.mapValues(u,function(c){return c+l}))}})})}function gA(r,e){return X.mapValues(r.ul,function(t,n){if(e)return r[e.toLowerCase()][n];var i=X.sortBy(X.map(r,n));return(i[1]+i[2])/2})}function SQ(r){var e=jn.buildLayerMatrix(r),t=X.merge(lA(r,e),fA(r,e)),n={},i;X.forEach(["u","d"],function(o){i=o==="u"?e:X.values(e).reverse(),X.forEach(["l","r"],function(s){s==="r"&&(i=X.map(i,function(c){return X.values(c).reverse()}));var u=(o==="u"?r.predecessors:r.successors).bind(r),l=hA(r,i,t,u),f=dA(r,i,l.root,l.align,s==="r");s==="r"&&(f=X.mapValues(f,function(c){return-c})),n[o+s]=f})});var a=vA(r,n);return pA(n,a),gA(n,r.graph().align)}function EQ(r,e,t){return function(n,i,a){var o=n.node(i),s=n.node(a),u=0,l;if(u+=o.width/2,X.has(o,"labelpos"))switch(o.labelpos.toLowerCase()){case"l":l=-o.width/2;break;case"r":l=o.width/2;break}if(l&&(u+=t?l:-l),l=0,u+=(o.dummy?e:r)/2,u+=(s.dummy?e:r)/2,u+=s.width/2,X.has(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":l=s.width/2;break;case"r":l=-s.width/2;break}return l&&(u+=t?l:-l),l=0,u}}function CQ(r,e){return r.node(e).width}var AQ=xQ.positionX,TQ=MQ;function MQ(r){r=jn.asNonCompoundGraph(r),IQ(r),X.forEach(AQ(r),function(e,t){r.node(t).x=e})}function IQ(r){var e=jn.buildLayerMatrix(r),t=r.graph().ranksep,n=0;X.forEach(e,function(i){var a=X.max(X.map(i,function(o){return r.node(o).height}));X.forEach(i,function(o){r.node(o).y=n+a/2}),n+=a+t})}var kQ=jn.normalizeRanks,DQ=jn.removeEmptyRanks,Do=jn,PQ=oa.Graph,NQ=LQ;function LQ(r,e){var t=e&&e.debugTiming?Do.time:Do.notime;t("layout",function(){var n=t("  buildLayoutGraph",function(){return jQ(r)});t("  runLayout",function(){OQ(n,t)}),t("  updateInputGraph",function(){RQ(r,n)})})}function OQ(r,e){e("    makeSpaceForEdgeLabels",function(){XQ(r)}),e("    removeSelfEdges",function(){tJ(r)}),e("    acyclic",function(){FC.run(r)}),e("    nestingGraph.run",function(){JC.run(r)}),e("    rank",function(){MZ(Do.asNonCompoundGraph(r))}),e("    injectEdgeLabelProxies",function(){HQ(r)}),e("    removeEmptyRanks",function(){DQ(r)}),e("    nestingGraph.cleanup",function(){JC.cleanup(r)}),e("    normalizeRanks",function(){kQ(r)}),e("    assignRankMinMax",function(){YQ(r)}),e("    removeEdgeLabelProxies",function(){qQ(r)}),e("    normalize.run",function(){VC.run(r)}),e("    parentDummyChains",function(){PZ(r)}),e("    addBorderSegments",function(){UZ(r)}),e("    order",function(){gQ(r)}),e("    insertSelfEdges",function(){rJ(r)}),e("    adjustCoordinateSystem",function(){rA.adjust(r)}),e("    position",function(){TQ(r)}),e("    positionSelfEdges",function(){nJ(r)}),e("    removeBorderNodes",function(){eJ(r)}),e("    normalize.undo",function(){VC.undo(r)}),e("    fixupEdgeLabelCoords",function(){QQ(r)}),e("    undoCoordinateSystem",function(){rA.undo(r)}),e("    translateGraph",function(){KQ(r)}),e("    assignNodeIntersects",function(){ZQ(r)}),e("    reversePoints",function(){JQ(r)}),e("    acyclic.undo",function(){FC.undo(r)})}function RQ(r,e){X.forEach(r.nodes(),function(t){var n=r.node(t),i=e.node(t);n&&(n.x=i.x,n.y=i.y,e.children(t).length&&(n.width=i.width,n.height=i.height))}),X.forEach(r.edges(),function(t){var n=r.edge(t),i=e.edge(t);n.points=i.points,X.has(i,"x")&&(n.x=i.x,n.y=i.y)}),r.graph().width=e.graph().width,r.graph().height=e.graph().height}var BQ=["nodesep","edgesep","ranksep","marginx","marginy"],GQ={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},FQ=["acyclicer","ranker","rankdir","align"],UQ=["width","height"],zQ={width:0,height:0},$Q=["minlen","weight","width","height","labeloffset"],VQ={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},WQ=["labelpos"];function jQ(r){var e=new PQ({multigraph:!0,compound:!0}),t=Rm(r.graph());return e.setGraph(X.merge({},GQ,Om(t,BQ),X.pick(t,FQ))),X.forEach(r.nodes(),function(n){var i=Rm(r.node(n));e.setNode(n,X.defaults(Om(i,UQ),zQ)),e.setParent(n,r.parent(n))}),X.forEach(r.edges(),function(n){var i=Rm(r.edge(n));e.setEdge(n,X.merge({},VQ,Om(i,$Q),X.pick(i,WQ)))}),e}function XQ(r){var e=r.graph();e.ranksep/=2,X.forEach(r.edges(),function(t){var n=r.edge(t);n.minlen*=2,n.labelpos.toLowerCase()!=="c"&&(e.rankdir==="TB"||e.rankdir==="BT"?n.width+=n.labeloffset:n.height+=n.labeloffset)})}function HQ(r){X.forEach(r.edges(),function(e){var t=r.edge(e);if(t.width&&t.height){var n=r.node(e.v),i=r.node(e.w),a={rank:(i.rank-n.rank)/2+n.rank,e};Do.addDummyNode(r,"edge-proxy",a,"_ep")}})}function YQ(r){var e=0;X.forEach(r.nodes(),function(t){var n=r.node(t);n.borderTop&&(n.minRank=r.node(n.borderTop).rank,n.maxRank=r.node(n.borderBottom).rank,e=X.max(e,n.maxRank))}),r.graph().maxRank=e}function qQ(r){X.forEach(r.nodes(),function(e){var t=r.node(e);t.dummy==="edge-proxy"&&(r.edge(t.e).labelRank=t.rank,r.removeNode(e))})}function KQ(r){var e=Number.POSITIVE_INFINITY,t=0,n=Number.POSITIVE_INFINITY,i=0,a=r.graph(),o=a.marginx||0,s=a.marginy||0;function u(l){var f=l.x,c=l.y,h=l.width,d=l.height;e=Math.min(e,f-h/2),t=Math.max(t,f+h/2),n=Math.min(n,c-d/2),i=Math.max(i,c+d/2)}X.forEach(r.nodes(),function(l){u(r.node(l))}),X.forEach(r.edges(),function(l){var f=r.edge(l);X.has(f,"x")&&u(f)}),e-=o,n-=s,X.forEach(r.nodes(),function(l){var f=r.node(l);f.x-=e,f.y-=n}),X.forEach(r.edges(),function(l){var f=r.edge(l);X.forEach(f.points,function(c){c.x-=e,c.y-=n}),X.has(f,"x")&&(f.x-=e),X.has(f,"y")&&(f.y-=n)}),a.width=t-e+o,a.height=i-n+s}function ZQ(r){X.forEach(r.edges(),function(e){var t=r.edge(e),n=r.node(e.v),i=r.node(e.w),a,o;t.points?(a=t.points[0],o=t.points[t.points.length-1]):(t.points=[],a=i,o=n),t.points.unshift(Do.intersectRect(n,a)),t.points.push(Do.intersectRect(i,o))})}function QQ(r){X.forEach(r.edges(),function(e){var t=r.edge(e);if(X.has(t,"x"))switch((t.labelpos==="l"||t.labelpos==="r")&&(t.width-=t.labeloffset),t.labelpos){case"l":t.x-=t.width/2+t.labeloffset;break;case"r":t.x+=t.width/2+t.labeloffset;break}})}function JQ(r){X.forEach(r.edges(),function(e){var t=r.edge(e);t.reversed&&t.points.reverse()})}function eJ(r){X.forEach(r.nodes(),function(e){if(r.children(e).length){var t=r.node(e),n=r.node(t.borderTop),i=r.node(t.borderBottom),a=r.node(X.last(t.borderLeft)),o=r.node(X.last(t.borderRight));t.width=Math.abs(o.x-a.x),t.height=Math.abs(i.y-n.y),t.x=a.x+t.width/2,t.y=n.y+t.height/2}}),X.forEach(r.nodes(),function(e){r.node(e).dummy==="border"&&r.removeNode(e)})}function tJ(r){X.forEach(r.edges(),function(e){if(e.v===e.w){var t=r.node(e.v);t.selfEdges||(t.selfEdges=[]),t.selfEdges.push({e,label:r.edge(e)}),r.removeEdge(e)}})}function rJ(r){var e=Do.buildLayerMatrix(r);X.forEach(e,function(t){var n=0;X.forEach(t,function(i,a){var o=r.node(i);o.order=a+n,X.forEach(o.selfEdges,function(s){Do.addDummyNode(r,"selfedge",{width:s.label.width,height:s.label.height,rank:o.rank,order:a+ ++n,e:s.e,label:s.label},"_se")}),delete o.selfEdges})})}function nJ(r){X.forEach(r.nodes(),function(e){var t=r.node(e);if(t.dummy==="selfedge"){var n=r.node(t.e.v),i=n.x+n.width/2,a=n.y,o=t.x-i,s=n.height/2;r.setEdge(t.e,t.label),r.removeNode(e),t.label.points=[{x:i+2*o/3,y:a-s},{x:i+5*o/6,y:a-s},{x:i+o,y:a},{x:i+5*o/6,y:a+s},{x:i+2*o/3,y:a+s}],t.label.x=t.x,t.label.y=t.y}})}function Om(r,e){return X.mapValues(X.pick(r,e),Number)}function Rm(r){var e={};return X.forEach(r,function(t,n){e[n.toLowerCase()]=t}),e}var iJ=oa.Graph,aJ={debugOrdering:oJ};function oJ(r){var e=jn.buildLayerMatrix(r),t=new iJ({compound:!0,multigraph:!0}).setGraph({});return X.forEach(r.nodes(),function(n){t.setNode(n,{label:n}),t.setParent(n,"layer"+r.node(n).rank)}),X.forEach(r.edges(),function(n){t.setEdge(n.v,n.w,{},n.name)}),X.forEach(e,function(n,i){var a="layer"+i;t.setNode(a,{rank:"same"}),X.reduce(n,function(o,s){return t.setEdge(o,s,{style:"invis"}),s})}),t}var sJ="0.8.5",yA={graphlib:oa,layout:NQ,debug:aJ,util:{time:jn.time,notime:jn.notime},version:sJ};class uJ extends hi{constructor(e){super();this.rankdir="TB",this.nodesep=50,this.ranksep=50,this.controlPoints=!1,this.sortByCombo=!1,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{rankdir:"TB",align:void 0,nodeSize:void 0,nodesepFunc:void 0,ranksepFunc:void 0,nodesep:50,ranksep:50,controlPoints:!1}}execute(){const e=this,{nodes:t,nodeSize:n,rankdir:i,combos:a}=e;if(!t)return;const o=e.edges||[],s=new yA.graphlib.Graph({multigraph:!0,compound:!0});let u;n?qn(n)?u=()=>n:u=()=>[n,n]:u=d=>d.size?qn(d.size)?d.size:Ma(d.size)?[d.size.width||40,d.size.height||40]:[d.size,d.size]:[40,40];let l=Yd(e.nodesepFunc,e.nodesep,50),f=Yd(e.ranksepFunc,e.ranksep,50);(i==="LR"||i==="RL")&&(l=Yd(e.ranksepFunc,e.ranksep,50),f=Yd(e.nodesepFunc,e.nodesep,50)),s.setDefaultEdgeLabel(()=>({})),s.setGraph(e);const c={};t.filter(d=>d.layout!==!1).forEach(d=>{const v=u(d),p=f(d),g=l(d),y=v[0]+2*g,m=v[1]+2*p;s.setNode(d.id,{width:y,height:m}),this.sortByCombo&&d.comboId&&(c[d.comboId]||(c[d.comboId]=!0,s.setNode(d.comboId,{})),s.setParent(d.id,d.comboId))}),this.sortByCombo&&a&&a.forEach(d=>{!d.parentId||(c[d.parentId]||(c[d.parentId]=!0,s.setNode(d.parentId,{})),s.setParent(d.id,d.parentId))}),o.forEach(d=>{const v=_r(d,"source"),p=_r(d,"target");s.setEdge(v,p,{weight:d.weight||1})}),yA.layout(s);let h;return s.nodes().forEach(d=>{h=s.node(d);const v=t.findIndex(p=>p.id===d);!t[v]||(t[v].x=h.x,t[v].y=h.y)}),s.edges().forEach(d=>{h=s.edge(d);const v=o.findIndex(p=>{const g=_r(p,"source"),y=_r(p,"target");return g===d.v&&y===d.w});e.controlPoints&&o[v].type!=="loop"&&(o[v].controlPoints=h.points.slice(1,h.points.length-1))}),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:o}}getType(){return"dagre"}}function Yd(r,e,t){let n;return r?n=r:ft(e)?n=()=>e:n=()=>t,n}const lJ=Object.prototype.toString;function qd(r){return lJ.call(r).endsWith("Array]")}function fJ(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!qd(r))throw new TypeError("input must be an array");if(r.length===0)throw new TypeError("input must not be empty");var t=e.fromIndex,n=t===void 0?0:t,i=e.toIndex,a=i===void 0?r.length:i;if(n<0||n>=r.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=n||a>r.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=r[n],s=n+1;s<a;s++)r[s]>o&&(o=r[s]);return o}function cJ(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!qd(r))throw new TypeError("input must be an array");if(r.length===0)throw new TypeError("input must not be empty");var t=e.fromIndex,n=t===void 0?0:t,i=e.toIndex,a=i===void 0?r.length:i;if(n<0||n>=r.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=n||a>r.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=r[n],s=n+1;s<a;s++)r[s]<o&&(o=r[s]);return o}function mA(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(qd(r)){if(r.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var t;if(e.output!==void 0){if(!qd(e.output))throw new TypeError("output option must be an array if specified");t=e.output}else t=new Array(r.length);var n=cJ(r),i=fJ(r);if(n===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var a=e.min,o=a===void 0?e.autoMinMax?n:0:a,s=e.max,u=s===void 0?e.autoMinMax?i:1:s;if(o>=u)throw new RangeError("min option must be smaller than max option");for(var l=(u-o)/(i-n),f=0;f<r.length;f++)t[f]=(r[f]-n)*l+o;return t}const Kd=" ".repeat(2),bA=" ".repeat(4);function hJ(){return xA(this)}function xA(r,e={}){const{maxRows:t=15,maxColumns:n=10,maxNumSize:i=8}=e;return`${r.constructor.name} {
${Kd}[
${bA}${dJ(r,t,n,i)}
${Kd}]
${Kd}rows: ${r.rows}
${Kd}columns: ${r.columns}
}`}function dJ(r,e,t,n){const{rows:i,columns:a}=r,o=Math.min(i,e),s=Math.min(a,t),u=[];for(let l=0;l<o;l++){let f=[];for(let c=0;c<s;c++)f.push(vJ(r.get(l,c),n));u.push(`${f.join(" ")}`)}return s!==a&&(u[u.length-1]+=` ... ${a-t} more columns`),o!==i&&u.push(`... ${i-e} more rows`),u.join(`
${bA}`)}function vJ(r,e){const t=String(r);if(t.length<=e)return t.padEnd(e," ");const n=r.toPrecision(e-2);if(n.length<=e)return n;const i=r.toExponential(e-2),a=i.indexOf("e"),o=i.slice(a);return i.slice(0,e-o.length)+o}function pJ(r,e){r.prototype.add=function(n){return typeof n=="number"?this.addS(n):this.addM(n)},r.prototype.addS=function(n){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)+n);return this},r.prototype.addM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)+n.get(i,a));return this},r.add=function(n,i){return new e(n).add(i)},r.prototype.sub=function(n){return typeof n=="number"?this.subS(n):this.subM(n)},r.prototype.subS=function(n){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)-n);return this},r.prototype.subM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)-n.get(i,a));return this},r.sub=function(n,i){return new e(n).sub(i)},r.prototype.subtract=r.prototype.sub,r.prototype.subtractS=r.prototype.subS,r.prototype.subtractM=r.prototype.subM,r.subtract=r.sub,r.prototype.mul=function(n){return typeof n=="number"?this.mulS(n):this.mulM(n)},r.prototype.mulS=function(n){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)*n);return this},r.prototype.mulM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)*n.get(i,a));return this},r.mul=function(n,i){return new e(n).mul(i)},r.prototype.multiply=r.prototype.mul,r.prototype.multiplyS=r.prototype.mulS,r.prototype.multiplyM=r.prototype.mulM,r.multiply=r.mul,r.prototype.div=function(n){return typeof n=="number"?this.divS(n):this.divM(n)},r.prototype.divS=function(n){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)/n);return this},r.prototype.divM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)/n.get(i,a));return this},r.div=function(n,i){return new e(n).div(i)},r.prototype.divide=r.prototype.div,r.prototype.divideS=r.prototype.divS,r.prototype.divideM=r.prototype.divM,r.divide=r.div,r.prototype.mod=function(n){return typeof n=="number"?this.modS(n):this.modM(n)},r.prototype.modS=function(n){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)%n);return this},r.prototype.modM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)%n.get(i,a));return this},r.mod=function(n,i){return new e(n).mod(i)},r.prototype.modulus=r.prototype.mod,r.prototype.modulusS=r.prototype.modS,r.prototype.modulusM=r.prototype.modM,r.modulus=r.mod,r.prototype.and=function(n){return typeof n=="number"?this.andS(n):this.andM(n)},r.prototype.andS=function(n){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)&n);return this},r.prototype.andM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)&n.get(i,a));return this},r.and=function(n,i){return new e(n).and(i)},r.prototype.or=function(n){return typeof n=="number"?this.orS(n):this.orM(n)},r.prototype.orS=function(n){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)|n);return this},r.prototype.orM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)|n.get(i,a));return this},r.or=function(n,i){return new e(n).or(i)},r.prototype.xor=function(n){return typeof n=="number"?this.xorS(n):this.xorM(n)},r.prototype.xorS=function(n){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)^n);return this},r.prototype.xorM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)^n.get(i,a));return this},r.xor=function(n,i){return new e(n).xor(i)},r.prototype.leftShift=function(n){return typeof n=="number"?this.leftShiftS(n):this.leftShiftM(n)},r.prototype.leftShiftS=function(n){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)<<n);return this},r.prototype.leftShiftM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)<<n.get(i,a));return this},r.leftShift=function(n,i){return new e(n).leftShift(i)},r.prototype.signPropagatingRightShift=function(n){return typeof n=="number"?this.signPropagatingRightShiftS(n):this.signPropagatingRightShiftM(n)},r.prototype.signPropagatingRightShiftS=function(n){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)>>n);return this},r.prototype.signPropagatingRightShiftM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)>>n.get(i,a));return this},r.signPropagatingRightShift=function(n,i){return new e(n).signPropagatingRightShift(i)},r.prototype.rightShift=function(n){return typeof n=="number"?this.rightShiftS(n):this.rightShiftM(n)},r.prototype.rightShiftS=function(n){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)>>>n);return this},r.prototype.rightShiftM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,this.get(i,a)>>>n.get(i,a));return this},r.rightShift=function(n,i){return new e(n).rightShift(i)},r.prototype.zeroFillRightShift=r.prototype.rightShift,r.prototype.zeroFillRightShiftS=r.prototype.rightShiftS,r.prototype.zeroFillRightShiftM=r.prototype.rightShiftM,r.zeroFillRightShift=r.rightShift,r.prototype.not=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,~this.get(n,i));return this},r.not=function(n){return new e(n).not()},r.prototype.abs=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.abs(this.get(n,i)));return this},r.abs=function(n){return new e(n).abs()},r.prototype.acos=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.acos(this.get(n,i)));return this},r.acos=function(n){return new e(n).acos()},r.prototype.acosh=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.acosh(this.get(n,i)));return this},r.acosh=function(n){return new e(n).acosh()},r.prototype.asin=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.asin(this.get(n,i)));return this},r.asin=function(n){return new e(n).asin()},r.prototype.asinh=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.asinh(this.get(n,i)));return this},r.asinh=function(n){return new e(n).asinh()},r.prototype.atan=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.atan(this.get(n,i)));return this},r.atan=function(n){return new e(n).atan()},r.prototype.atanh=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.atanh(this.get(n,i)));return this},r.atanh=function(n){return new e(n).atanh()},r.prototype.cbrt=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.cbrt(this.get(n,i)));return this},r.cbrt=function(n){return new e(n).cbrt()},r.prototype.ceil=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.ceil(this.get(n,i)));return this},r.ceil=function(n){return new e(n).ceil()},r.prototype.clz32=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.clz32(this.get(n,i)));return this},r.clz32=function(n){return new e(n).clz32()},r.prototype.cos=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.cos(this.get(n,i)));return this},r.cos=function(n){return new e(n).cos()},r.prototype.cosh=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.cosh(this.get(n,i)));return this},r.cosh=function(n){return new e(n).cosh()},r.prototype.exp=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.exp(this.get(n,i)));return this},r.exp=function(n){return new e(n).exp()},r.prototype.expm1=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.expm1(this.get(n,i)));return this},r.expm1=function(n){return new e(n).expm1()},r.prototype.floor=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.floor(this.get(n,i)));return this},r.floor=function(n){return new e(n).floor()},r.prototype.fround=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.fround(this.get(n,i)));return this},r.fround=function(n){return new e(n).fround()},r.prototype.log=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.log(this.get(n,i)));return this},r.log=function(n){return new e(n).log()},r.prototype.log1p=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.log1p(this.get(n,i)));return this},r.log1p=function(n){return new e(n).log1p()},r.prototype.log10=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.log10(this.get(n,i)));return this},r.log10=function(n){return new e(n).log10()},r.prototype.log2=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.log2(this.get(n,i)));return this},r.log2=function(n){return new e(n).log2()},r.prototype.round=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.round(this.get(n,i)));return this},r.round=function(n){return new e(n).round()},r.prototype.sign=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.sign(this.get(n,i)));return this},r.sign=function(n){return new e(n).sign()},r.prototype.sin=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.sin(this.get(n,i)));return this},r.sin=function(n){return new e(n).sin()},r.prototype.sinh=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.sinh(this.get(n,i)));return this},r.sinh=function(n){return new e(n).sinh()},r.prototype.sqrt=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.sqrt(this.get(n,i)));return this},r.sqrt=function(n){return new e(n).sqrt()},r.prototype.tan=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.tan(this.get(n,i)));return this},r.tan=function(n){return new e(n).tan()},r.prototype.tanh=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.tanh(this.get(n,i)));return this},r.tanh=function(n){return new e(n).tanh()},r.prototype.trunc=function(){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.set(n,i,Math.trunc(this.get(n,i)));return this},r.trunc=function(n){return new e(n).trunc()},r.pow=function(n,i){return new e(n).pow(i)},r.prototype.pow=function(n){return typeof n=="number"?this.powS(n):this.powM(n)},r.prototype.powS=function(n){for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,Math.pow(this.get(i,a),n));return this},r.prototype.powM=function(n){if(n=e.checkMatrix(n),this.rows!==n.rows||this.columns!==n.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let a=0;a<this.columns;a++)this.set(i,a,Math.pow(this.get(i,a),n.get(i,a)));return this}}function sa(r,e,t){let n=t?r.rows:r.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function ua(r,e,t){let n=t?r.columns:r.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function Yu(r,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==r.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function qu(r,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==r.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function gJ(r,e,t){return{row:yJ(r,e),column:mJ(r,t)}}function yJ(r,e){if(typeof e!="object")throw new TypeError("unexpected type for row indices");if(e.some(n=>n<0||n>=r.rows))throw new RangeError("row indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function mJ(r,e){if(typeof e!="object")throw new TypeError("unexpected type for column indices");if(e.some(n=>n<0||n>=r.columns))throw new RangeError("column indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function _A(r,e,t,n,i){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(Qd("startRow",e),Qd("endRow",t),Qd("startColumn",n),Qd("endColumn",i),e>t||n>i||e<0||e>=r.rows||t<0||t>=r.rows||n<0||n>=r.columns||i<0||i>=r.columns)throw new RangeError("Submatrix indices are out of range")}function Zd(r,e=0){let t=[];for(let n=0;n<r;n++)t.push(e);return t}function Qd(r,e){if(typeof e!="number")throw new TypeError(`${r} must be a number`)}function Ku(r){if(r.isEmpty())throw new Error("Empty matrix has no elements to index")}function bJ(r){let e=Zd(r.rows);for(let t=0;t<r.rows;++t)for(let n=0;n<r.columns;++n)e[t]+=r.get(t,n);return e}function xJ(r){let e=Zd(r.columns);for(let t=0;t<r.rows;++t)for(let n=0;n<r.columns;++n)e[n]+=r.get(t,n);return e}function _J(r){let e=0;for(let t=0;t<r.rows;t++)for(let n=0;n<r.columns;n++)e+=r.get(t,n);return e}function wJ(r){let e=Zd(r.rows,1);for(let t=0;t<r.rows;++t)for(let n=0;n<r.columns;++n)e[t]*=r.get(t,n);return e}function SJ(r){let e=Zd(r.columns,1);for(let t=0;t<r.rows;++t)for(let n=0;n<r.columns;++n)e[n]*=r.get(t,n);return e}function EJ(r){let e=1;for(let t=0;t<r.rows;t++)for(let n=0;n<r.columns;n++)e*=r.get(t,n);return e}function CJ(r,e,t){const n=r.rows,i=r.columns,a=[];for(let o=0;o<n;o++){let s=0,u=0,l=0;for(let f=0;f<i;f++)l=r.get(o,f)-t[o],s+=l,u+=l*l;e?a.push((u-s*s/i)/(i-1)):a.push((u-s*s/i)/i)}return a}function AJ(r,e,t){const n=r.rows,i=r.columns,a=[];for(let o=0;o<i;o++){let s=0,u=0,l=0;for(let f=0;f<n;f++)l=r.get(f,o)-t[o],s+=l,u+=l*l;e?a.push((u-s*s/n)/(n-1)):a.push((u-s*s/n)/n)}return a}function TJ(r,e,t){const n=r.rows,i=r.columns,a=n*i;let o=0,s=0,u=0;for(let l=0;l<n;l++)for(let f=0;f<i;f++)u=r.get(l,f)-t,o+=u,s+=u*u;return e?(s-o*o/a)/(a-1):(s-o*o/a)/a}function MJ(r,e){for(let t=0;t<r.rows;t++)for(let n=0;n<r.columns;n++)r.set(t,n,r.get(t,n)-e[t])}function IJ(r,e){for(let t=0;t<r.rows;t++)for(let n=0;n<r.columns;n++)r.set(t,n,r.get(t,n)-e[n])}function kJ(r,e){for(let t=0;t<r.rows;t++)for(let n=0;n<r.columns;n++)r.set(t,n,r.get(t,n)-e)}function DJ(r){const e=[];for(let t=0;t<r.rows;t++){let n=0;for(let i=0;i<r.columns;i++)n+=Math.pow(r.get(t,i),2)/(r.columns-1);e.push(Math.sqrt(n))}return e}function PJ(r,e){for(let t=0;t<r.rows;t++)for(let n=0;n<r.columns;n++)r.set(t,n,r.get(t,n)/e[t])}function NJ(r){const e=[];for(let t=0;t<r.columns;t++){let n=0;for(let i=0;i<r.rows;i++)n+=Math.pow(r.get(i,t),2)/(r.rows-1);e.push(Math.sqrt(n))}return e}function LJ(r,e){for(let t=0;t<r.rows;t++)for(let n=0;n<r.columns;n++)r.set(t,n,r.get(t,n)/e[n])}function OJ(r){const e=r.size-1;let t=0;for(let n=0;n<r.columns;n++)for(let i=0;i<r.rows;i++)t+=Math.pow(r.get(i,n),2)/e;return Math.sqrt(t)}function RJ(r,e){for(let t=0;t<r.rows;t++)for(let n=0;n<r.columns;n++)r.set(t,n,r.get(t,n)/e)}class gr{static from1DArray(e,t,n){if(e*t!==n.length)throw new RangeError("data length does not match given dimensions");let a=new Wt(e,t);for(let o=0;o<e;o++)for(let s=0;s<t;s++)a.set(o,s,n[o*t+s]);return a}static rowVector(e){let t=new Wt(1,e.length);for(let n=0;n<e.length;n++)t.set(0,n,e[n]);return t}static columnVector(e){let t=new Wt(e.length,1);for(let n=0;n<e.length;n++)t.set(n,0,e[n]);return t}static zeros(e,t){return new Wt(e,t)}static ones(e,t){return new Wt(e,t).fill(1)}static rand(e,t,n={}){if(typeof n!="object")throw new TypeError("options must be an object");const{random:i=Math.random}=n;let a=new Wt(e,t);for(let o=0;o<e;o++)for(let s=0;s<t;s++)a.set(o,s,i());return a}static randInt(e,t,n={}){if(typeof n!="object")throw new TypeError("options must be an object");const{min:i=0,max:a=1e3,random:o=Math.random}=n;if(!Number.isInteger(i))throw new TypeError("min must be an integer");if(!Number.isInteger(a))throw new TypeError("max must be an integer");if(i>=a)throw new RangeError("min must be smaller than max");let s=a-i,u=new Wt(e,t);for(let l=0;l<e;l++)for(let f=0;f<t;f++){let c=i+Math.round(o()*s);u.set(l,f,c)}return u}static eye(e,t,n){t===void 0&&(t=e),n===void 0&&(n=1);let i=Math.min(e,t),a=this.zeros(e,t);for(let o=0;o<i;o++)a.set(o,o,n);return a}static diag(e,t,n){let i=e.length;t===void 0&&(t=i),n===void 0&&(n=t);let a=Math.min(i,t,n),o=this.zeros(t,n);for(let s=0;s<a;s++)o.set(s,s,e[s]);return o}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);let n=e.rows,i=e.columns,a=new Wt(n,i);for(let o=0;o<n;o++)for(let s=0;s<i;s++)a.set(o,s,Math.min(e.get(o,s),t.get(o,s)));return a}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);let n=e.rows,i=e.columns,a=new this(n,i);for(let o=0;o<n;o++)for(let s=0;s<i;s++)a.set(o,s,Math.max(e.get(o,s),t.get(o,s)));return a}static checkMatrix(e){return gr.isMatrix(e)?e:new Wt(e)}static isMatrix(e){return e!=null&&e.klass==="Matrix"}get size(){return this.rows*this.columns}apply(e){if(typeof e!="function")throw new TypeError("callback must be a function");for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.call(this,t,n);return this}to1DArray(){let e=[];for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.push(this.get(t,n));return e}to2DArray(){let e=[];for(let t=0;t<this.rows;t++){e.push([]);for(let n=0;n<this.columns;n++)e[t].push(this.get(t,n))}return e}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let e=0;e<this.rows;e++)for(let t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}isEchelonForm(){let e=0,t=0,n=-1,i=!0,a=!1;for(;e<this.rows&&i;){for(t=0,a=!1;t<this.columns&&a===!1;)this.get(e,t)===0?t++:this.get(e,t)===1&&t>n?(a=!0,n=t):(i=!1,a=!0);e++}return i}isReducedEchelonForm(){let e=0,t=0,n=-1,i=!0,a=!1;for(;e<this.rows&&i;){for(t=0,a=!1;t<this.columns&&a===!1;)this.get(e,t)===0?t++:this.get(e,t)===1&&t>n?(a=!0,n=t):(i=!1,a=!0);for(let o=t+1;o<this.rows;o++)this.get(e,o)!==0&&(i=!1);e++}return i}echelonForm(){let e=this.clone(),t=0,n=0;for(;t<e.rows&&n<e.columns;){let i=t;for(let a=t;a<e.rows;a++)e.get(a,n)>e.get(i,n)&&(i=a);if(e.get(i,n)===0)n++;else{e.swapRows(t,i);let a=e.get(t,n);for(let o=n;o<e.columns;o++)e.set(t,o,e.get(t,o)/a);for(let o=t+1;o<e.rows;o++){let s=e.get(o,n)/e.get(t,n);e.set(o,n,0);for(let u=n+1;u<e.columns;u++)e.set(o,u,e.get(o,u)-e.get(t,u)*s)}t++,n++}}return e}reducedEchelonForm(){let e=this.echelonForm(),t=e.columns,n=e.rows,i=n-1;for(;i>=0;)if(e.maxRow(i)===0)i--;else{let a=0,o=!1;for(;a<n&&o===!1;)e.get(i,a)===1?o=!0:a++;for(let s=0;s<i;s++){let u=e.get(s,a);for(let l=a;l<t;l++){let f=e.get(s,l)-u*e.get(i,l);e.set(s,l,f)}}i--}return e}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(e={}){if(typeof e!="object")throw new TypeError("options must be an object");const{rows:t=1,columns:n=1}=e;if(!Number.isInteger(t)||t<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(n)||n<=0)throw new TypeError("columns must be a positive integer");let i=new Wt(this.rows*t,this.columns*n);for(let a=0;a<t;a++)for(let o=0;o<n;o++)i.setSubMatrix(this,this.rows*a,this.columns*o);return i}fill(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,e);return this}neg(){return this.mulS(-1)}getRow(e){sa(this,e);let t=[];for(let n=0;n<this.columns;n++)t.push(this.get(e,n));return t}getRowVector(e){return Wt.rowVector(this.getRow(e))}setRow(e,t){sa(this,e),t=Yu(this,t);for(let n=0;n<this.columns;n++)this.set(e,n,t[n]);return this}swapRows(e,t){sa(this,e),sa(this,t);for(let n=0;n<this.columns;n++){let i=this.get(e,n);this.set(e,n,this.get(t,n)),this.set(t,n,i)}return this}getColumn(e){ua(this,e);let t=[];for(let n=0;n<this.rows;n++)t.push(this.get(n,e));return t}getColumnVector(e){return Wt.columnVector(this.getColumn(e))}setColumn(e,t){ua(this,e),t=qu(this,t);for(let n=0;n<this.rows;n++)this.set(n,e,t[n]);return this}swapColumns(e,t){ua(this,e),ua(this,t);for(let n=0;n<this.rows;n++){let i=this.get(n,e);this.set(n,e,this.get(n,t)),this.set(n,t,i)}return this}addRowVector(e){e=Yu(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e[n]);return this}subRowVector(e){e=Yu(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e[n]);return this}mulRowVector(e){e=Yu(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e[n]);return this}divRowVector(e){e=Yu(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e[n]);return this}addColumnVector(e){e=qu(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e[t]);return this}subColumnVector(e){e=qu(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e[t]);return this}mulColumnVector(e){e=qu(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e[t]);return this}divColumnVector(e){e=qu(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e[t]);return this}mulRow(e,t){sa(this,e);for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this}mulColumn(e,t){ua(this,e);for(let n=0;n<this.rows;n++)this.set(n,e,this.get(n,e)*t);return this}max(){if(this.isEmpty())return NaN;let e=this.get(0,0);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxIndex(){Ku(this);let e=this.get(0,0),t=[0,0];for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.get(n,i)>e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}min(){if(this.isEmpty())return NaN;let e=this.get(0,0);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minIndex(){Ku(this);let e=this.get(0,0),t=[0,0];for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.get(n,i)<e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}maxRow(e){if(sa(this,e),this.isEmpty())return NaN;let t=this.get(e,0);for(let n=1;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxRowIndex(e){sa(this,e),Ku(this);let t=this.get(e,0),n=[e,0];for(let i=1;i<this.columns;i++)this.get(e,i)>t&&(t=this.get(e,i),n[1]=i);return n}minRow(e){if(sa(this,e),this.isEmpty())return NaN;let t=this.get(e,0);for(let n=1;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minRowIndex(e){sa(this,e),Ku(this);let t=this.get(e,0),n=[e,0];for(let i=1;i<this.columns;i++)this.get(e,i)<t&&(t=this.get(e,i),n[1]=i);return n}maxColumn(e){if(ua(this,e),this.isEmpty())return NaN;let t=this.get(0,e);for(let n=1;n<this.rows;n++)this.get(n,e)>t&&(t=this.get(n,e));return t}maxColumnIndex(e){ua(this,e),Ku(this);let t=this.get(0,e),n=[0,e];for(let i=1;i<this.rows;i++)this.get(i,e)>t&&(t=this.get(i,e),n[0]=i);return n}minColumn(e){if(ua(this,e),this.isEmpty())return NaN;let t=this.get(0,e);for(let n=1;n<this.rows;n++)this.get(n,e)<t&&(t=this.get(n,e));return t}minColumnIndex(e){ua(this,e),Ku(this);let t=this.get(0,e),n=[0,e];for(let i=1;i<this.rows;i++)this.get(i,e)<t&&(t=this.get(i,e),n[0]=i);return n}diag(){let e=Math.min(this.rows,this.columns),t=[];for(let n=0;n<e;n++)t.push(this.get(n,n));return t}norm(e="frobenius"){let t=0;if(e==="max")return this.max();if(e==="frobenius"){for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)t=t+this.get(n,i)*this.get(n,i);return Math.sqrt(t)}else throw new RangeError(`unknown norm type: ${e}`)}cumulativeSum(){let e=0;for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e+=this.get(t,n),this.set(t,n,e);return this}dot(e){gr.isMatrix(e)&&(e=e.to1DArray());let t=this.to1DArray();if(t.length!==e.length)throw new RangeError("vectors do not have the same size");let n=0;for(let i=0;i<t.length;i++)n+=t[i]*e[i];return n}mmul(e){e=Wt.checkMatrix(e);let t=this.rows,n=this.columns,i=e.columns,a=new Wt(t,i),o=new Float64Array(n);for(let s=0;s<i;s++){for(let u=0;u<n;u++)o[u]=e.get(u,s);for(let u=0;u<t;u++){let l=0;for(let f=0;f<n;f++)l+=this.get(u,f)*o[f];a.set(u,s,l)}}return a}strassen2x2(e){e=Wt.checkMatrix(e);let t=new Wt(2,2);const n=this.get(0,0),i=e.get(0,0),a=this.get(0,1),o=e.get(0,1),s=this.get(1,0),u=e.get(1,0),l=this.get(1,1),f=e.get(1,1),c=(n+l)*(i+f),h=(s+l)*i,d=n*(o-f),v=l*(u-i),p=(n+a)*f,g=(s-n)*(i+o),y=(a-l)*(u+f),m=c+v-p+y,b=d+p,x=h+v,_=c-h+d+g;return t.set(0,0,m),t.set(0,1,b),t.set(1,0,x),t.set(1,1,_),t}strassen3x3(e){e=Wt.checkMatrix(e);let t=new Wt(3,3);const n=this.get(0,0),i=this.get(0,1),a=this.get(0,2),o=this.get(1,0),s=this.get(1,1),u=this.get(1,2),l=this.get(2,0),f=this.get(2,1),c=this.get(2,2),h=e.get(0,0),d=e.get(0,1),v=e.get(0,2),p=e.get(1,0),g=e.get(1,1),y=e.get(1,2),m=e.get(2,0),b=e.get(2,1),x=e.get(2,2),_=(n+i+a-o-s-f-c)*g,S=(n-o)*(-d+g),E=s*(-h+d+p-g-y-m+x),C=(-n+o+s)*(h-d+g),M=(o+s)*(-h+d),w=n*h,T=(-n+l+f)*(h-v+y),I=(-n+l)*(v-y),k=(l+f)*(-h+v),O=(n+i+a-s-u-l-f)*y,U=f*(-h+v+p-g-y-m+b),q=(-a+f+c)*(g+m-b),K=(a-c)*(g-b),le=a*m,he=(f+c)*(-m+b),te=(-a+s+u)*(y+m-x),se=(a-u)*(y-x),ge=(s+u)*(-m+x),Se=i*p,ne=u*b,pe=o*v,Ge=l*d,ke=c*x,rt=w+le+Se,$e=_+C+M+w+q+le+he,ut=w+T+k+O+le+te+ge,pt=S+E+C+w+le+te+se,qt=S+C+M+w+ne,F=le+te+se+ge+pe,Z=w+T+I+U+q+K+le,V=q+K+le+he+Ge,Fe=w+T+I+k+ke;return t.set(0,0,rt),t.set(0,1,$e),t.set(0,2,ut),t.set(1,0,pt),t.set(1,1,qt),t.set(1,2,F),t.set(2,0,Z),t.set(2,1,V),t.set(2,2,Fe),t}mmulStrassen(e){e=Wt.checkMatrix(e);let t=this.clone(),n=t.rows,i=t.columns,a=e.rows,o=e.columns;i!==a&&console.warn(`Multiplying ${n} x ${i} and ${a} x ${o} matrix: dimensions do not match.`);function s(c,h,d){let v=c.rows,p=c.columns;if(v===h&&p===d)return c;{let g=gr.zeros(h,d);return g=g.setSubMatrix(c,0,0),g}}let u=Math.max(n,a),l=Math.max(i,o);t=s(t,u,l),e=s(e,u,l);function f(c,h,d,v){if(d<=512||v<=512)return c.mmul(h);d%2==1&&v%2==1?(c=s(c,d+1,v+1),h=s(h,d+1,v+1)):d%2==1?(c=s(c,d+1,v),h=s(h,d+1,v)):v%2==1&&(c=s(c,d,v+1),h=s(h,d,v+1));let p=parseInt(c.rows/2,10),g=parseInt(c.columns/2,10),y=c.subMatrix(0,p-1,0,g-1),m=h.subMatrix(0,p-1,0,g-1),b=c.subMatrix(0,p-1,g,c.columns-1),x=h.subMatrix(0,p-1,g,h.columns-1),_=c.subMatrix(p,c.rows-1,0,g-1),S=h.subMatrix(p,h.rows-1,0,g-1),E=c.subMatrix(p,c.rows-1,g,c.columns-1),C=h.subMatrix(p,h.rows-1,g,h.columns-1),M=f(gr.add(y,E),gr.add(m,C),p,g),w=f(gr.add(_,E),m,p,g),T=f(y,gr.sub(x,C),p,g),I=f(E,gr.sub(S,m),p,g),k=f(gr.add(y,b),C,p,g),O=f(gr.sub(_,y),gr.add(m,x),p,g),U=f(gr.sub(b,E),gr.add(S,C),p,g),q=gr.add(M,I);q.sub(k),q.add(U);let K=gr.add(T,k),le=gr.add(w,I),he=gr.sub(M,w);he.add(T),he.add(O);let te=gr.zeros(2*q.rows,2*q.columns);return te=te.setSubMatrix(q,0,0),te=te.setSubMatrix(K,q.rows,0),te=te.setSubMatrix(le,0,q.columns),te=te.setSubMatrix(he,q.rows,q.columns),te.subMatrix(0,d-1,0,v-1)}return f(t,e,u,l)}scaleRows(e={}){if(typeof e!="object")throw new TypeError("options must be an object");const{min:t=0,max:n=1}=e;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(t>=n)throw new RangeError("min must be smaller than max");let i=new Wt(this.rows,this.columns);for(let a=0;a<this.rows;a++){const o=this.getRow(a);o.length>0&&mA(o,{min:t,max:n,output:o}),i.setRow(a,o)}return i}scaleColumns(e={}){if(typeof e!="object")throw new TypeError("options must be an object");const{min:t=0,max:n=1}=e;if(!Number.isFinite(t))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(t>=n)throw new RangeError("min must be smaller than max");let i=new Wt(this.rows,this.columns);for(let a=0;a<this.columns;a++){const o=this.getColumn(a);o.length&&mA(o,{min:t,max:n,output:o}),i.setColumn(a,o)}return i}flipRows(){const e=Math.ceil(this.columns/2);for(let t=0;t<this.rows;t++)for(let n=0;n<e;n++){let i=this.get(t,n),a=this.get(t,this.columns-1-n);this.set(t,n,a),this.set(t,this.columns-1-n,i)}return this}flipColumns(){const e=Math.ceil(this.rows/2);for(let t=0;t<this.columns;t++)for(let n=0;n<e;n++){let i=this.get(n,t),a=this.get(this.rows-1-n,t);this.set(n,t,a),this.set(this.rows-1-n,t,i)}return this}kroneckerProduct(e){e=Wt.checkMatrix(e);let t=this.rows,n=this.columns,i=e.rows,a=e.columns,o=new Wt(t*i,n*a);for(let s=0;s<t;s++)for(let u=0;u<n;u++)for(let l=0;l<i;l++)for(let f=0;f<a;f++)o.set(i*s+l,a*u+f,this.get(s,u)*e.get(l,f));return o}kroneckerSum(e){if(e=Wt.checkMatrix(e),!this.isSquare()||!e.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let t=this.rows,n=e.rows,i=this.kroneckerProduct(Wt.eye(n,n)),a=Wt.eye(t,t).kroneckerProduct(e);return i.add(a)}transpose(){let e=new Wt(this.columns,this.rows);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.set(n,t,this.get(t,n));return e}sortRows(e=wA){for(let t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this}sortColumns(e=wA){for(let t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this}subMatrix(e,t,n,i){_A(this,e,t,n,i);let a=new Wt(t-e+1,i-n+1);for(let o=e;o<=t;o++)for(let s=n;s<=i;s++)a.set(o-e,s-n,this.get(o,s));return a}subMatrixRow(e,t,n){if(t===void 0&&(t=0),n===void 0&&(n=this.columns-1),t>n||t<0||t>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");let i=new Wt(e.length,n-t+1);for(let a=0;a<e.length;a++)for(let o=t;o<=n;o++){if(e[a]<0||e[a]>=this.rows)throw new RangeError(`Row index out of range: ${e[a]}`);i.set(a,o-t,this.get(e[a],o))}return i}subMatrixColumn(e,t,n){if(t===void 0&&(t=0),n===void 0&&(n=this.rows-1),t>n||t<0||t>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");let i=new Wt(n-t+1,e.length);for(let a=0;a<e.length;a++)for(let o=t;o<=n;o++){if(e[a]<0||e[a]>=this.columns)throw new RangeError(`Column index out of range: ${e[a]}`);i.set(o-t,a,this.get(o,e[a]))}return i}setSubMatrix(e,t,n){if(e=Wt.checkMatrix(e),e.isEmpty())return this;let i=t+e.rows-1,a=n+e.columns-1;_A(this,t,i,n,a);for(let o=0;o<e.rows;o++)for(let s=0;s<e.columns;s++)this.set(t+o,n+s,e.get(o,s));return this}selection(e,t){let n=gJ(this,e,t),i=new Wt(e.length,t.length);for(let a=0;a<n.row.length;a++){let o=n.row[a];for(let s=0;s<n.column.length;s++){let u=n.column[s];i.set(a,s,this.get(o,u))}}return i}trace(){let e=Math.min(this.rows,this.columns),t=0;for(let n=0;n<e;n++)t+=this.get(n,n);return t}clone(){let e=new Wt(this.rows,this.columns);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.set(t,n,this.get(t,n));return e}sum(e){switch(e){case"row":return bJ(this);case"column":return xJ(this);case void 0:return _J(this);default:throw new Error(`invalid option: ${e}`)}}product(e){switch(e){case"row":return wJ(this);case"column":return SJ(this);case void 0:return EJ(this);default:throw new Error(`invalid option: ${e}`)}}mean(e){const t=this.sum(e);switch(e){case"row":{for(let n=0;n<this.rows;n++)t[n]/=this.columns;return t}case"column":{for(let n=0;n<this.columns;n++)t[n]/=this.rows;return t}case void 0:return t/this.size;default:throw new Error(`invalid option: ${e}`)}}variance(e,t={}){if(typeof e=="object"&&(t=e,e=void 0),typeof t!="object")throw new TypeError("options must be an object");const{unbiased:n=!0,mean:i=this.mean(e)}=t;if(typeof n!="boolean")throw new TypeError("unbiased must be a boolean");switch(e){case"row":{if(!Array.isArray(i))throw new TypeError("mean must be an array");return CJ(this,n,i)}case"column":{if(!Array.isArray(i))throw new TypeError("mean must be an array");return AJ(this,n,i)}case void 0:{if(typeof i!="number")throw new TypeError("mean must be a number");return TJ(this,n,i)}default:throw new Error(`invalid option: ${e}`)}}standardDeviation(e,t){typeof e=="object"&&(t=e,e=void 0);const n=this.variance(e,t);if(e===void 0)return Math.sqrt(n);for(let i=0;i<n.length;i++)n[i]=Math.sqrt(n[i]);return n}center(e,t={}){if(typeof e=="object"&&(t=e,e=void 0),typeof t!="object")throw new TypeError("options must be an object");const{center:n=this.mean(e)}=t;switch(e){case"row":{if(!Array.isArray(n))throw new TypeError("center must be an array");return MJ(this,n),this}case"column":{if(!Array.isArray(n))throw new TypeError("center must be an array");return IJ(this,n),this}case void 0:{if(typeof n!="number")throw new TypeError("center must be a number");return kJ(this,n),this}default:throw new Error(`invalid option: ${e}`)}}scale(e,t={}){if(typeof e=="object"&&(t=e,e=void 0),typeof t!="object")throw new TypeError("options must be an object");let n=t.scale;switch(e){case"row":{if(n===void 0)n=DJ(this);else if(!Array.isArray(n))throw new TypeError("scale must be an array");return PJ(this,n),this}case"column":{if(n===void 0)n=NJ(this);else if(!Array.isArray(n))throw new TypeError("scale must be an array");return LJ(this,n),this}case void 0:{if(n===void 0)n=OJ(this);else if(typeof n!="number")throw new TypeError("scale must be a number");return RJ(this,n),this}default:throw new Error(`invalid option: ${e}`)}}toString(e){return xA(this,e)}}gr.prototype.klass="Matrix";typeof Symbol!="undefined"&&(gr.prototype[Symbol.for("nodejs.util.inspect.custom")]=hJ);function wA(r,e){return r-e}gr.random=gr.rand;gr.randomInt=gr.randInt;gr.diagonal=gr.diag;gr.prototype.diagonal=gr.prototype.diag;gr.identity=gr.eye;gr.prototype.negate=gr.prototype.neg;gr.prototype.tensorProduct=gr.prototype.kroneckerProduct;class Wt extends gr{constructor(e,t){super();if(Wt.isMatrix(e))return e.clone();if(Number.isInteger(e)&&e>=0)if(this.data=[],Number.isInteger(t)&&t>=0)for(let n=0;n<e;n++)this.data.push(new Float64Array(t));else throw new TypeError("nColumns must be a positive integer");else if(Array.isArray(e)){const n=e;if(e=n.length,t=e?n[0].length:0,typeof t!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let i=0;i<e;i++){if(n[i].length!==t)throw new RangeError("Inconsistent array dimensions");this.data.push(Float64Array.from(n[i]))}}else throw new TypeError("First argument must be a positive number or an array");this.rows=e,this.columns=t}set(e,t,n){return this.data[e][t]=n,this}get(e,t){return this.data[e][t]}removeRow(e){return sa(this,e),this.data.splice(e,1),this.rows-=1,this}addRow(e,t){return t===void 0&&(t=e,e=this.rows),sa(this,e,!0),t=Float64Array.from(Yu(this,t)),this.data.splice(e,0,t),this.rows+=1,this}removeColumn(e){ua(this,e);for(let t=0;t<this.rows;t++){const n=new Float64Array(this.columns-1);for(let i=0;i<e;i++)n[i]=this.data[t][i];for(let i=e+1;i<this.columns;i++)n[i-1]=this.data[t][i];this.data[t]=n}return this.columns-=1,this}addColumn(e,t){typeof t=="undefined"&&(t=e,e=this.columns),ua(this,e,!0),t=qu(this,t);for(let n=0;n<this.rows;n++){const i=new Float64Array(this.columns+1);let a=0;for(;a<e;a++)i[a]=this.data[n][a];for(i[a++]=t[n];a<this.columns+1;a++)i[a]=this.data[n][a-1];this.data[n]=i}return this.columns+=1,this}}pJ(gr,Wt);class BJ extends gr{constructor(e){super();this.data=e,this.rows=e.length,this.columns=e[0].length}set(e,t,n){return this.data[e][t]=n,this}get(e,t){return this.data[e][t]}}function Zu(r,e){let t=0;return Math.abs(r)>Math.abs(e)?(t=e/r,Math.abs(r)*Math.sqrt(1+t*t)):e!==0?(t=r/e,Math.abs(e)*Math.sqrt(1+t*t)):0}class SA{constructor(e,t={}){if(e=BJ.checkMatrix(e),e.isEmpty())throw new Error("Matrix must be non-empty");let n=e.rows,i=e.columns;const{computeLeftSingularVectors:a=!0,computeRightSingularVectors:o=!0,autoTranspose:s=!1}=t;let u=Boolean(a),l=Boolean(o),f=!1,c;if(n<i)if(!s)c=e.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{c=e.transpose(),n=c.rows,i=c.columns,f=!0;let w=u;u=l,l=w}else c=e.clone();let h=Math.min(n,i),d=Math.min(n+1,i),v=new Float64Array(d),p=new Wt(n,h),g=new Wt(i,i),y=new Float64Array(i),m=new Float64Array(n),b=new Float64Array(d);for(let w=0;w<d;w++)b[w]=w;let x=Math.min(n-1,i),_=Math.max(0,Math.min(i-2,n)),S=Math.max(x,_);for(let w=0;w<S;w++){if(w<x){v[w]=0;for(let T=w;T<n;T++)v[w]=Zu(v[w],c.get(T,w));if(v[w]!==0){c.get(w,w)<0&&(v[w]=-v[w]);for(let T=w;T<n;T++)c.set(T,w,c.get(T,w)/v[w]);c.set(w,w,c.get(w,w)+1)}v[w]=-v[w]}for(let T=w+1;T<i;T++){if(w<x&&v[w]!==0){let I=0;for(let k=w;k<n;k++)I+=c.get(k,w)*c.get(k,T);I=-I/c.get(w,w);for(let k=w;k<n;k++)c.set(k,T,c.get(k,T)+I*c.get(k,w))}y[T]=c.get(w,T)}if(u&&w<x)for(let T=w;T<n;T++)p.set(T,w,c.get(T,w));if(w<_){y[w]=0;for(let T=w+1;T<i;T++)y[w]=Zu(y[w],y[T]);if(y[w]!==0){y[w+1]<0&&(y[w]=0-y[w]);for(let T=w+1;T<i;T++)y[T]/=y[w];y[w+1]+=1}if(y[w]=-y[w],w+1<n&&y[w]!==0){for(let T=w+1;T<n;T++)m[T]=0;for(let T=w+1;T<n;T++)for(let I=w+1;I<i;I++)m[T]+=y[I]*c.get(T,I);for(let T=w+1;T<i;T++){let I=-y[T]/y[w+1];for(let k=w+1;k<n;k++)c.set(k,T,c.get(k,T)+I*m[k])}}if(l)for(let T=w+1;T<i;T++)g.set(T,w,y[T])}}let E=Math.min(i,n+1);if(x<i&&(v[x]=c.get(x,x)),n<E&&(v[E-1]=0),_+1<E&&(y[_]=c.get(_,E-1)),y[E-1]=0,u){for(let w=x;w<h;w++){for(let T=0;T<n;T++)p.set(T,w,0);p.set(w,w,1)}for(let w=x-1;w>=0;w--)if(v[w]!==0){for(let T=w+1;T<h;T++){let I=0;for(let k=w;k<n;k++)I+=p.get(k,w)*p.get(k,T);I=-I/p.get(w,w);for(let k=w;k<n;k++)p.set(k,T,p.get(k,T)+I*p.get(k,w))}for(let T=w;T<n;T++)p.set(T,w,-p.get(T,w));p.set(w,w,1+p.get(w,w));for(let T=0;T<w-1;T++)p.set(T,w,0)}else{for(let T=0;T<n;T++)p.set(T,w,0);p.set(w,w,1)}}if(l)for(let w=i-1;w>=0;w--){if(w<_&&y[w]!==0)for(let T=w+1;T<i;T++){let I=0;for(let k=w+1;k<i;k++)I+=g.get(k,w)*g.get(k,T);I=-I/g.get(w+1,w);for(let k=w+1;k<i;k++)g.set(k,T,g.get(k,T)+I*g.get(k,w))}for(let T=0;T<i;T++)g.set(T,w,0);g.set(w,w,1)}let C=E-1,M=Number.EPSILON;for(;E>0;){let w,T;for(w=E-2;w>=-1&&w!==-1;w--){const I=Number.MIN_VALUE+M*Math.abs(v[w]+Math.abs(v[w+1]));if(Math.abs(y[w])<=I||Number.isNaN(y[w])){y[w]=0;break}}if(w===E-2)T=4;else{let I;for(I=E-1;I>=w&&I!==w;I--){let k=(I!==E?Math.abs(y[I]):0)+(I!==w+1?Math.abs(y[I-1]):0);if(Math.abs(v[I])<=M*k){v[I]=0;break}}I===w?T=3:I===E-1?T=1:(T=2,w=I)}switch(w++,T){case 1:{let I=y[E-2];y[E-2]=0;for(let k=E-2;k>=w;k--){let O=Zu(v[k],I),U=v[k]/O,q=I/O;if(v[k]=O,k!==w&&(I=-q*y[k-1],y[k-1]=U*y[k-1]),l)for(let K=0;K<i;K++)O=U*g.get(K,k)+q*g.get(K,E-1),g.set(K,E-1,-q*g.get(K,k)+U*g.get(K,E-1)),g.set(K,k,O)}break}case 2:{let I=y[w-1];y[w-1]=0;for(let k=w;k<E;k++){let O=Zu(v[k],I),U=v[k]/O,q=I/O;if(v[k]=O,I=-q*y[k],y[k]=U*y[k],u)for(let K=0;K<n;K++)O=U*p.get(K,k)+q*p.get(K,w-1),p.set(K,w-1,-q*p.get(K,k)+U*p.get(K,w-1)),p.set(K,k,O)}break}case 3:{const I=Math.max(Math.abs(v[E-1]),Math.abs(v[E-2]),Math.abs(y[E-2]),Math.abs(v[w]),Math.abs(y[w])),k=v[E-1]/I,O=v[E-2]/I,U=y[E-2]/I,q=v[w]/I,K=y[w]/I,le=((O+k)*(O-k)+U*U)/2,he=k*U*(k*U);let te=0;(le!==0||he!==0)&&(le<0?te=0-Math.sqrt(le*le+he):te=Math.sqrt(le*le+he),te=he/(le+te));let se=(q+k)*(q-k)+te,ge=q*K;for(let Se=w;Se<E-1;Se++){let ne=Zu(se,ge);ne===0&&(ne=Number.MIN_VALUE);let pe=se/ne,Ge=ge/ne;if(Se!==w&&(y[Se-1]=ne),se=pe*v[Se]+Ge*y[Se],y[Se]=pe*y[Se]-Ge*v[Se],ge=Ge*v[Se+1],v[Se+1]=pe*v[Se+1],l)for(let ke=0;ke<i;ke++)ne=pe*g.get(ke,Se)+Ge*g.get(ke,Se+1),g.set(ke,Se+1,-Ge*g.get(ke,Se)+pe*g.get(ke,Se+1)),g.set(ke,Se,ne);if(ne=Zu(se,ge),ne===0&&(ne=Number.MIN_VALUE),pe=se/ne,Ge=ge/ne,v[Se]=ne,se=pe*y[Se]+Ge*v[Se+1],v[Se+1]=-Ge*y[Se]+pe*v[Se+1],ge=Ge*y[Se+1],y[Se+1]=pe*y[Se+1],u&&Se<n-1)for(let ke=0;ke<n;ke++)ne=pe*p.get(ke,Se)+Ge*p.get(ke,Se+1),p.set(ke,Se+1,-Ge*p.get(ke,Se)+pe*p.get(ke,Se+1)),p.set(ke,Se,ne)}y[E-2]=se;break}case 4:{if(v[w]<=0&&(v[w]=v[w]<0?-v[w]:0,l))for(let I=0;I<=C;I++)g.set(I,w,-g.get(I,w));for(;w<C&&!(v[w]>=v[w+1]);){let I=v[w];if(v[w]=v[w+1],v[w+1]=I,l&&w<i-1)for(let k=0;k<i;k++)I=g.get(k,w+1),g.set(k,w+1,g.get(k,w)),g.set(k,w,I);if(u&&w<n-1)for(let k=0;k<n;k++)I=p.get(k,w+1),p.set(k,w+1,p.get(k,w)),p.set(k,w,I);w++}E--;break}}}if(f){let w=g;g=p,p=w}this.m=n,this.n=i,this.s=v,this.U=p,this.V=g}solve(e){let t=e,n=this.threshold,i=this.s.length,a=Wt.zeros(i,i);for(let h=0;h<i;h++)Math.abs(this.s[h])<=n?a.set(h,h,0):a.set(h,h,1/this.s[h]);let o=this.U,s=this.rightSingularVectors,u=s.mmul(a),l=s.rows,f=o.rows,c=Wt.zeros(l,f);for(let h=0;h<l;h++)for(let d=0;d<f;d++){let v=0;for(let p=0;p<i;p++)v+=u.get(h,p)*o.get(d,p);c.set(h,d,v)}return c.mmul(t)}solveForDiagonal(e){return this.solve(Wt.diag(e))}inverse(){let e=this.V,t=this.threshold,n=e.rows,i=e.columns,a=new Wt(n,this.s.length);for(let f=0;f<n;f++)for(let c=0;c<i;c++)Math.abs(this.s[c])>t&&a.set(f,c,e.get(f,c)/this.s[c]);let o=this.U,s=o.rows,u=o.columns,l=new Wt(n,s);for(let f=0;f<n;f++)for(let c=0;c<s;c++){let h=0;for(let d=0;d<u;d++)h+=a.get(f,d)*o.get(c,d);l.set(f,c,h)}return l}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let e=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,t=0,n=this.s;for(let i=0,a=n.length;i<a;i++)n[i]>e&&t++;return t}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return Wt.diag(this.s)}}class GJ{constructor(e){this.distances=e.distances,this.dimension=e.dimension||2,this.linkDistance=e.linkDistance}layout(){const e=this,{dimension:t,distances:n,linkDistance:i}=e;try{const a=Wt.mul(Wt.pow(n,2),-.5),o=a.mean("row"),s=a.mean("column"),u=a.mean();a.add(u).subRowVector(o).subColumnVector(s);const l=new SA(a),f=Wt.sqrt(l.diagonalMatrix).diagonal();return l.leftSingularVectors.toJSON().map(c=>Wt.mul([c],[f]).toJSON()[0].splice(0,t))}catch(a){const o=[];for(let s=0;s<n.length;s++){const u=Math.random()*i,l=Math.random()*i;o.push([u,l])}return o}}}const FJ=800;class UJ{constructor(e){this.disp=[],this.positions=e.positions,this.adjMatrix=e.adjMatrix,this.focusID=e.focusID,this.radii=e.radii,this.iterations=e.iterations||10,this.height=e.height||10,this.width=e.width||10,this.speed=e.speed||100,this.gravity=e.gravity||10,this.nodeSizeFunc=e.nodeSizeFunc,this.k=e.k||5,this.strictRadial=e.strictRadial,this.nodes=e.nodes}layout(){const e=this,t=e.positions,n=[],i=e.iterations,a=e.width/10;e.maxDisplace=a,e.disp=n;for(let o=0;o<i;o++)t.forEach((s,u)=>{n[u]={x:0,y:0}}),e.getRepulsion(),e.updatePositions();return t}getRepulsion(){const e=this,t=e.positions,n=e.nodes,i=e.disp,a=e.k,o=e.radii||[];t.forEach((s,u)=>{i[u]={x:0,y:0},t.forEach((l,f)=>{if(u===f||o[u]!==o[f])return;let c=s[0]-l[0],h=s[1]-l[1],d=Math.sqrt(c*c+h*h);if(d===0){d=1;const v=u>f?1:-1;c=.01*v,h=.01*v}if(d<e.nodeSizeFunc(n[u])/2+e.nodeSizeFunc(n[f])/2){const v=a*a/d;i[u].x+=c/d*v,i[u].y+=h/d*v}})})}updatePositions(){const e=this,t=e.positions,n=e.disp,i=e.speed,a=e.strictRadial,o=e.focusID,s=e.maxDisplace||e.width/10;a&&n.forEach((l,f)=>{const c=t[f][0]-t[o][0],h=t[f][1]-t[o][1],d=Math.sqrt(c*c+h*h);let v=h/d,p=-c/d;const g=Math.sqrt(l.x*l.x+l.y*l.y);let y=Math.acos((v*l.x+p*l.y)/g);y>Math.PI/2&&(y-=Math.PI/2,v*=-1,p*=-1);const m=Math.cos(y)*g;l.x=v*m,l.y=p*m});const u=e.radii;t.forEach((l,f)=>{if(f===o)return;const c=Math.sqrt(n[f].x*n[f].x+n[f].y*n[f].y);if(c>0&&f!==o){const h=Math.min(s*(i/FJ),c);if(l[0]+=n[f].x/c*h,l[1]+=n[f].y/c*h,a){let d=l[0]-t[o][0],v=l[1]-t[o][1];const p=Math.sqrt(d*d+v*v);d=d/p*u[f],v=v/p*u[f],l[0]=t[o][0]+d,l[1]=t[o][1]+v}}})}}function zJ(r){const e=r.length,t=r[0].length,n=[];for(let i=0;i<e;i++){const a=[];for(let o=0;o<t;o++)r[i][o]!==0?a.push(1/(r[i][o]*r[i][o])):a.push(0);n.push(a)}return n}function $J(r,e){let t=-1;return r.forEach((n,i)=>{n.id===e&&(t=i)}),t}function EA(r,e){return Math.sqrt((r[0]-e[0])*(r[0]-e[0])+(r[1]-e[1])*(r[1]-e[1]))}class VJ extends hi{constructor(e){super();this.maxIteration=1e3,this.focusNode=null,this.unitRadius=null,this.linkDistance=50,this.preventOverlap=!1,this.strictRadial=!0,this.maxPreventOverlapIteration=200,this.sortStrength=10,this.nodes=[],this.edges=[],this.updateCfg(e)}getDefaultCfg(){return{maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,strictRadial:!0,maxPreventOverlapIteration:200,sortBy:void 0,sortStrength:10}}execute(){const e=this,t=e.nodes,n=e.edges||[];if(!t||t.length===0){e.onLayoutEnd&&e.onLayoutEnd();return}!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const i=e.center;if(t.length===1){t[0].x=i[0],t[0].y=i[1],e.onLayoutEnd&&e.onLayoutEnd();return}const a=e.linkDistance;let o=null;if(If(e.focusNode)){let T=!1;for(let I=0;I<t.length;I++)t[I].id===e.focusNode&&(o=t[I],e.focusNode=o,T=!0,I=t.length);T||(o=null)}else o=e.focusNode;o||(o=t[0],e.focusNode=o);const s=$J(t,o.id);e.focusIndex=s;const u=$E({nodes:t,edges:n},!1),l=zE(u),f=e.maxToFocus(l,s);e.handleInfinity(l,s,f+1),e.distances=l;const c=l[s],h=e.width||500,d=e.height||500;let v=h-i[0]>i[0]?i[0]:h-i[0],p=d-i[1]>i[1]?i[1]:d-i[1];v===0&&(v=h/2),p===0&&(p=d/2);const g=p>v?v:p,y=Math.max(...c),m=[];c.forEach((T,I)=>{e.unitRadius||(e.unitRadius=g/y),m[I]=T*e.unitRadius}),e.radii=m;const b=e.eIdealDisMatrix();e.eIdealDistances=b;const x=zJ(b);e.weights=x;let S=new GJ({linkDistance:a,distances:b}).layout();S.forEach(T=>{Hy(T[0])&&(T[0]=Math.random()*a),Hy(T[1])&&(T[1]=Math.random()*a)}),e.positions=S,S.forEach((T,I)=>{t[I].x=T[0]+i[0],t[I].y=T[1]+i[1]}),S.forEach(T=>{T[0]-=S[s][0],T[1]-=S[s][1]}),e.run();const E=e.preventOverlap,C=e.nodeSize;let M;const w=e.strictRadial;if(E){const T=e.nodeSpacing;let I;ft(T)?I=()=>T:To(T)?I=T:I=()=>0,C?qn(C)?M=U=>(C[0]>C[1]?C[0]:C[1])+I(U):M=U=>C+I(U):M=U=>U.size?qn(U.size)?(U.size[0]>U.size[1]?U.size[0]:U.size[1])+I(U):Ma(U.size)?(U.size.width>U.size.height?U.size.width:U.size.height)+I(U):U.size+I(U):10+I(U);const k={nodes:t,nodeSizeFunc:M,adjMatrix:u,positions:S,radii:m,height:d,width:h,strictRadial:w,focusID:s,iterations:e.maxPreventOverlapIteration||200,k:S.length/4.5};S=new UJ(k).layout()}return S.forEach((T,I)=>{t[I].x=T[0]+i[0],t[I].y=T[1]+i[1]}),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n}}run(){const e=this,t=e.maxIteration,n=e.positions||[],i=e.weights||[],a=e.eIdealDistances||[],o=e.radii||[];for(let s=0;s<=t;s++){const u=s/t;e.oneIteration(u,n,o,a,i)}}oneIteration(e,t,n,i,a){const o=this,s=1-e,u=o.focusIndex;t.forEach((l,f)=>{const c=EA(l,[0,0]),h=c===0?0:1/c;if(f===u)return;let d=0,v=0,p=0;t.forEach((y,m)=>{if(f===m)return;const b=EA(l,y),x=b===0?0:1/b,_=i[m][f];p+=a[f][m],d+=a[f][m]*(y[0]+_*(l[0]-y[0])*x),v+=a[f][m]*(y[1]+_*(l[1]-y[1])*x)});const g=n[f]===0?0:1/n[f];p*=s,p+=e*g*g,d*=s,d+=e*g*l[0]*h,l[0]=d/p,v*=s,v+=e*g*l[1]*h,l[1]=v/p})}eIdealDisMatrix(){const e=this,t=e.nodes;if(!t)return[];const n=e.distances,i=e.linkDistance,a=e.radii||[],o=e.unitRadius||50,s=[];return n&&n.forEach((u,l)=>{const f=[];u.forEach((c,h)=>{if(l===h)f.push(0);else if(a[l]===a[h])if(e.sortBy==="data")f.push(c*(Math.abs(l-h)*e.sortStrength)/(a[l]/o));else if(e.sortBy){let d=t[l][e.sortBy]||0,v=t[h][e.sortBy]||0;If(d)&&(d=d.charCodeAt(0)),If(v)&&(v=v.charCodeAt(0)),f.push(c*(Math.abs(d-v)*e.sortStrength)/(a[l]/o))}else f.push(c*i/(a[l]/o));else{const d=(i+o)/2;f.push(c*d)}}),s.push(f)}),s}handleInfinity(e,t,n){const i=e.length;for(let a=0;a<i;a++)if(e[t][a]===1/0){e[t][a]=n,e[a][t]=n;for(let o=0;o<i;o++)e[a][o]!==1/0&&e[t][o]===1/0&&(e[t][o]=n+e[a][o],e[o][t]=n+e[a][o])}for(let a=0;a<i;a++)if(a!==t){for(let o=0;o<i;o++)if(e[a][o]===1/0){let s=Math.abs(e[t][a]-e[t][o]);s=s===0?1:s,e[a][o]=s}}}maxToFocus(e,t){let n=0;for(let i=0;i<e[t].length;i++)e[t][i]!==1/0&&(n=e[t][i]>n?e[t][i]:n);return n}getType(){return"radial"}}class WJ extends hi{constructor(e){super();this.nodeSize=30,this.minNodeSpacing=10,this.preventOverlap=!1,this.equidistant=!1,this.startAngle=3/2*Math.PI,this.clockwise=!0,this.sortBy="degree",this.nodes=[],this.edges=[],this.width=300,this.height=300,this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{nodeSize:30,minNodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:3/2*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"}}execute(){const e=this,t=e.nodes,n=e.edges,i=t.length;if(i===0){e.onLayoutEnd&&e.onLayoutEnd();return}!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const a=e.center;if(i===1){t[0].x=a[0],t[0].y=a[1],e.onLayoutEnd&&e.onLayoutEnd();return}const o=[];let s;qn(e.nodeSize)?s=Math.max(e.nodeSize[0],e.nodeSize[1]):s=e.nodeSize,t.forEach(v=>{o.push(v);let p=s;qn(v.size)?p=Math.max(v.size[0],v.size[1]):ft(v.size)?p=v.size:Ma(v.size)&&(p=Math.max(v.size.width,v.size.height)),s=Math.max(s,p)}),e.clockwise=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise;const u={},l={};if(o.forEach((v,p)=>{u[v.id]=v,l[v.id]=p}),(e.sortBy==="degree"||!If(e.sortBy)||o[0][e.sortBy]===void 0)&&(e.sortBy="degree",!ft(t[0].degree))){const v=kf(t.length,l,n);o.forEach((p,g)=>{p.degree=v[g]})}o.sort((v,p)=>p[e.sortBy]-v[e.sortBy]),e.maxValueNode=o[0],e.maxLevelDiff=e.maxLevelDiff||e.maxValueNode[e.sortBy]/4;const f=[[]];let c=f[0];o.forEach(v=>{if(c.length>0){const p=Math.abs(c[0][e.sortBy]-v[e.sortBy]);e.maxLevelDiff&&p>=e.maxLevelDiff&&(c=[],f.push(c))}c.push(v)});let h=s+e.minNodeSpacing;if(!e.preventOverlap){const v=f.length>0&&f[0].length>1,g=(Math.min(e.width,e.height)/2-h)/(f.length+(v?1:0));h=Math.min(h,g)}let d=0;if(f.forEach(v=>{let p=e.sweep;p===void 0&&(p=2*Math.PI-2*Math.PI/v.length);const g=v.dTheta=p/Math.max(1,v.length-1);if(v.length>1&&e.preventOverlap){const y=Math.cos(g)-Math.cos(0),m=Math.sin(g)-Math.sin(0),b=Math.sqrt(h*h/(y*y+m*m));d=Math.max(b,d)}v.r=d,d+=h}),e.equidistant){let v=0,p=0;for(let g=0;g<f.length;g++){const m=f[g].r-p;v=Math.max(v,m)}p=0,f.forEach((g,y)=>{y===0&&(p=g.r),g.r=p,p+=v})}return f.forEach(v=>{const p=v.dTheta,g=v.r;v.forEach((y,m)=>{const b=e.startAngle+(e.clockwise?1:-1)*p*m;y.x=a[0]+g*Math.cos(b),y.y=a[1]+g*Math.sin(b)})}),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n}}getType(){return"concentric"}}class jJ extends hi{constructor(e){super();this.center=[0,0],this.linkDistance=50,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(e)}getDefaultCfg(){return{center:[0,0],linkDistance:50}}execute(){const e=this,{nodes:t,edges:n=[]}=e,i=e.center;if(!t||t.length===0){e.onLayoutEnd&&e.onLayoutEnd();return}if(t.length===1){t[0].x=i[0],t[0].y=i[1],e.onLayoutEnd&&e.onLayoutEnd();return}const a=e.linkDistance,o=$E({nodes:t,edges:n},!1),s=zE(o);e.handleInfinity(s);const u=$6(s,a);e.scaledDistances=u;const l=e.runMDS();return e.positions=l,l.forEach((f,c)=>{t[c].x=f[0]+i[0],t[c].y=f[1]+i[1]}),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:t,edges:n}}runMDS(){const e=this,t=2,n=e.scaledDistances,i=Wt.mul(Wt.pow(n,2),-.5),a=i.mean("row"),o=i.mean("column"),s=i.mean();i.add(s).subRowVector(a).subColumnVector(o);const u=new SA(i),l=Wt.sqrt(u.diagonalMatrix).diagonal();return u.leftSingularVectors.toJSON().map(f=>Wt.mul([f],[l]).toJSON()[0].splice(0,t))}handleInfinity(e){let t=-999999;e.forEach(n=>{n.forEach(i=>{i!==1/0&&t<i&&(t=i)})}),e.forEach((n,i)=>{n.forEach((a,o)=>{a===1/0&&(e[i][o]=t)})})}getType(){return"mds"}}const XJ=800;class HJ extends hi{constructor(e){super();this.maxIteration=1e3,this.gravity=10,this.speed=5,this.clustering=!1,this.clusterGravity=10,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.onLayoutEnd=()=>{},this.tick=()=>{},this.updateCfg(e)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10}}execute(){const e=this,t=e.nodes;if(e.timeInterval!==void 0&&typeof window!="undefined"&&window.clearInterval(e.timeInterval),!t||t.length===0){e.onLayoutEnd&&e.onLayoutEnd();return}!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const n=e.center;if(t.length===1){t[0].x=n[0],t[0].y=n[1],e.onLayoutEnd&&e.onLayoutEnd();return}const i={},a={};return t.forEach((o,s)=>{ft(o.x)||(o.x=Math.random()*this.width),ft(o.y)||(o.y=Math.random()*this.height),i[o.id]=o,a[o.id]=s}),e.nodeMap=i,e.nodeIdxMap=a,e.run()}run(){const e=this,t=e.nodes;if(!t)return;const n=e.edges,i=e.maxIteration,a=e.center,o=e.height*e.width,s=Math.sqrt(o)/10,u=o/(t.length+1),l=Math.sqrt(u),f=e.gravity,c=e.speed,h=e.clustering,d={};if(h){t.forEach(p=>{if(d[p.cluster]===void 0){const y={name:p.cluster,cx:0,cy:0,count:0};d[p.cluster]=y}const g=d[p.cluster];ft(p.x)&&(g.cx+=p.x),ft(p.y)&&(g.cy+=p.y),g.count++});for(const p in d)d[p].cx/=d[p].count,d[p].cy/=d[p].count}if(typeof window=="undefined")return;let v=0;return this.timeInterval=window.setInterval(()=>{if(!t)return;const p=[];if(t.forEach((g,y)=>{p[y]={x:0,y:0}}),e.applyCalculate(t,n,p,l,u),h){const g=e.clusterGravity||f;t.forEach((y,m)=>{if(!ft(y.x)||!ft(y.y))return;const b=d[y.cluster],x=Math.sqrt((y.x-b.cx)*(y.x-b.cx)+(y.y-b.cy)*(y.y-b.cy)),_=l*g;p[m].x-=_*(y.x-b.cx)/x,p[m].y-=_*(y.y-b.cy)/x});for(const y in d)d[y].cx=0,d[y].cy=0,d[y].count=0;t.forEach(y=>{const m=d[y.cluster];ft(y.x)&&(m.cx+=y.x),ft(y.y)&&(m.cy+=y.y),m.count++});for(const y in d)d[y].cx/=d[y].count,d[y].cy/=d[y].count}t.forEach((g,y)=>{if(!ft(g.x)||!ft(g.y))return;const m=.01*l*f;p[y].x-=m*(g.x-a[0]),p[y].y-=m*(g.y-a[1])}),t.forEach((g,y)=>{if(ft(g.fx)&&ft(g.fy)){g.x=g.fx,g.y=g.fy;return}if(!ft(g.x)||!ft(g.y))return;const m=Math.sqrt(p[y].x*p[y].x+p[y].y*p[y].y);if(m>0){const b=Math.min(s*(c/XJ),m);g.x+=p[y].x/m*b,g.y+=p[y].y/m*b}}),e.tick&&e.tick(),v++,v>=i&&(e.onLayoutEnd&&e.onLayoutEnd(),window.clearInterval(e.timeInterval))},0),{nodes:t,edges:n}}applyCalculate(e,t,n,i,a){const o=this;o.calRepulsive(e,n,a),t&&o.calAttractive(t,n,i)}calRepulsive(e,t,n){e.forEach((i,a)=>{t[a]={x:0,y:0},e.forEach((o,s)=>{if(a===s||!ft(i.x)||!ft(o.x)||!ft(i.y)||!ft(o.y))return;let u=i.x-o.x,l=i.y-o.y,f=u*u+l*l;if(f===0){f=1;const h=a>s?1:-1;u=.01*h,l=.01*h}const c=n/f;t[a].x+=u*c,t[a].y+=l*c})})}calAttractive(e,t,n){e.forEach(i=>{const a=_r(i,"source"),o=_r(i,"target");if(!a||!o)return;const s=this.nodeIdxMap[a],u=this.nodeIdxMap[o];if(s===u)return;const l=this.nodeMap[a],f=this.nodeMap[o];if(!ft(f.x)||!ft(l.x)||!ft(f.y)||!ft(l.y))return;const c=f.x-l.x,h=f.y-l.y,d=Math.sqrt(c*c+h*h),v=d*d/n;t[u].x-=c/d*v,t[u].y-=h/d*v,t[s].x+=c/d*v,t[s].y+=h/d*v})}stop(){this.timeInterval&&typeof window!="undefined"&&window.clearInterval(this.timeInterval)}destroy(){const e=this;e.stop(),e.tick=null,e.nodes=null,e.edges=null,e.destroyed=!0}getType(){return"fruchterman"}}function Dt(r,e,t,n){!t||Object.defineProperty(r,e,{enumerable:t.enumerable,configurable:t.configurable,writable:t.writable,value:t.initializer?t.initializer.call(n):void 0})}function Pt(r,e,t,n,i){var a={};return Object.keys(n).forEach(function(o){a[o]=n[o]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=t.slice().reverse().reduce(function(o,s){return s(r,e,o)||o},a),i&&a.initializer!==void 0&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0),a.initializer===void 0&&(Object.defineProperty(r,e,a),a=null),a}/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var CA;(function(r){(function(e){var t=typeof ss=="object"?ss:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),n=i(r);typeof t.Reflect=="undefined"?t.Reflect=r:n=i(t.Reflect,n),e(n);function i(a,o){return function(s,u){typeof a[s]!="function"&&Object.defineProperty(a,s,{configurable:!0,writable:!0,value:u}),o&&o(s,u)}}})(function(e){var t=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",i=n&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",a=n&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",o=typeof Object.create=="function",s={__proto__:[]}instanceof Array,u=!o&&!s,l={create:o?function(){return D(Object.create(null))}:s?function(){return D({__proto__:null})}:function(){return D({})},has:u?function(ee,be){return t.call(ee,be)}:function(ee,be){return be in ee},get:u?function(ee,be){return t.call(ee,be)?ee[be]:void 0}:function(ee,be){return ee[be]}},f=Object.getPrototypeOf(Function),c=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",h=!c&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Ye(),d=!c&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:nt(),v=!c&&typeof WeakMap=="function"?WeakMap:Et(),p=new v;function g(ee,be,we,Oe){if(se(we)){if(!ut(ee))throw new TypeError;if(!qt(be))throw new TypeError;return w(ee,be)}else{if(!ut(ee))throw new TypeError;if(!ne(be))throw new TypeError;if(!ne(Oe)&&!se(Oe)&&!ge(Oe))throw new TypeError;return ge(Oe)&&(Oe=void 0),we=$e(we),T(ee,be,we,Oe)}}e("decorate",g);function y(ee,be){function we(Oe,qe){if(!ne(Oe))throw new TypeError;if(!se(qe)&&!F(qe))throw new TypeError;K(ee,be,Oe,qe)}return we}e("metadata",y);function m(ee,be,we,Oe){if(!ne(we))throw new TypeError;return se(Oe)||(Oe=$e(Oe)),K(ee,be,we,Oe)}e("defineMetadata",m);function b(ee,be,we){if(!ne(be))throw new TypeError;return se(we)||(we=$e(we)),k(ee,be,we)}e("hasMetadata",b);function x(ee,be,we){if(!ne(be))throw new TypeError;return se(we)||(we=$e(we)),O(ee,be,we)}e("hasOwnMetadata",x);function _(ee,be,we){if(!ne(be))throw new TypeError;return se(we)||(we=$e(we)),U(ee,be,we)}e("getMetadata",_);function S(ee,be,we){if(!ne(be))throw new TypeError;return se(we)||(we=$e(we)),q(ee,be,we)}e("getOwnMetadata",S);function E(ee,be){if(!ne(ee))throw new TypeError;return se(be)||(be=$e(be)),le(ee,be)}e("getMetadataKeys",E);function C(ee,be){if(!ne(ee))throw new TypeError;return se(be)||(be=$e(be)),he(ee,be)}e("getOwnMetadataKeys",C);function M(ee,be,we){if(!ne(be))throw new TypeError;se(we)||(we=$e(we));var Oe=I(be,we,!1);if(se(Oe)||!Oe.delete(ee))return!1;if(Oe.size>0)return!0;var qe=p.get(be);return qe.delete(we),qe.size>0||p.delete(be),!0}e("deleteMetadata",M);function w(ee,be){for(var we=ee.length-1;we>=0;--we){var Oe=ee[we],qe=Oe(be);if(!se(qe)&&!ge(qe)){if(!qt(qe))throw new TypeError;be=qe}}return be}function T(ee,be,we,Oe){for(var qe=ee.length-1;qe>=0;--qe){var Jt=ee[qe],gt=Jt(be,we,Oe);if(!se(gt)&&!ge(gt)){if(!ne(gt))throw new TypeError;Oe=gt}}return Oe}function I(ee,be,we){var Oe=p.get(ee);if(se(Oe)){if(!we)return;Oe=new h,p.set(ee,Oe)}var qe=Oe.get(be);if(se(qe)){if(!we)return;qe=new h,Oe.set(be,qe)}return qe}function k(ee,be,we){var Oe=O(ee,be,we);if(Oe)return!0;var qe=ct(be);return ge(qe)?!1:k(ee,qe,we)}function O(ee,be,we){var Oe=I(be,we,!1);return se(Oe)?!1:ke(Oe.has(ee))}function U(ee,be,we){var Oe=O(ee,be,we);if(Oe)return q(ee,be,we);var qe=ct(be);if(!ge(qe))return U(ee,qe,we)}function q(ee,be,we){var Oe=I(be,we,!1);if(!se(Oe))return Oe.get(ee)}function K(ee,be,we,Oe){var qe=I(we,Oe,!0);qe.set(ee,be)}function le(ee,be){var we=he(ee,be),Oe=ct(ee);if(Oe===null)return we;var qe=le(Oe,be);if(qe.length<=0)return we;if(we.length<=0)return qe;for(var Jt=new d,gt=[],Ct=0,kt=we;Ct<kt.length;Ct++){var Gt=kt[Ct],Zt=Jt.has(Gt);Zt||(Jt.add(Gt),gt.push(Gt))}for(var ar=0,ei=qe;ar<ei.length;ar++){var Gt=ei[ar],Zt=Jt.has(Gt);Zt||(Jt.add(Gt),gt.push(Gt))}return gt}function he(ee,be){var we=[],Oe=I(ee,be,!1);if(se(Oe))return we;for(var qe=Oe.keys(),Jt=V(qe),gt=0;;){var Ct=at(Jt);if(!Ct)return we.length=gt,we;var kt=Fe(Ct);try{we[gt]=kt}catch(Gt){try{Me(Jt)}finally{throw Gt}}gt++}}function te(ee){if(ee===null)return 1;switch(typeof ee){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return ee===null?1:6;default:return 6}}function se(ee){return ee===void 0}function ge(ee){return ee===null}function Se(ee){return typeof ee=="symbol"}function ne(ee){return typeof ee=="object"?ee!==null:typeof ee=="function"}function pe(ee,be){switch(te(ee)){case 0:return ee;case 1:return ee;case 2:return ee;case 3:return ee;case 4:return ee;case 5:return ee}var we=be===3?"string":be===5?"number":"default",Oe=Z(ee,i);if(Oe!==void 0){var qe=Oe.call(ee,we);if(ne(qe))throw new TypeError;return qe}return Ge(ee,we==="default"?"number":we)}function Ge(ee,be){if(be==="string"){var we=ee.toString;if(pt(we)){var Oe=we.call(ee);if(!ne(Oe))return Oe}var qe=ee.valueOf;if(pt(qe)){var Oe=qe.call(ee);if(!ne(Oe))return Oe}}else{var qe=ee.valueOf;if(pt(qe)){var Oe=qe.call(ee);if(!ne(Oe))return Oe}var Jt=ee.toString;if(pt(Jt)){var Oe=Jt.call(ee);if(!ne(Oe))return Oe}}throw new TypeError}function ke(ee){return!!ee}function rt(ee){return""+ee}function $e(ee){var be=pe(ee,3);return Se(be)?be:rt(be)}function ut(ee){return Array.isArray?Array.isArray(ee):ee instanceof Object?ee instanceof Array:Object.prototype.toString.call(ee)==="[object Array]"}function pt(ee){return typeof ee=="function"}function qt(ee){return typeof ee=="function"}function F(ee){switch(te(ee)){case 3:return!0;case 4:return!0;default:return!1}}function Z(ee,be){var we=ee[be];if(we!=null){if(!pt(we))throw new TypeError;return we}}function V(ee){var be=Z(ee,a);if(!pt(be))throw new TypeError;var we=be.call(ee);if(!ne(we))throw new TypeError;return we}function Fe(ee){return ee.value}function at(ee){var be=ee.next();return be.done?!1:be}function Me(ee){var be=ee.return;be&&be.call(ee)}function ct(ee){var be=Object.getPrototypeOf(ee);if(typeof ee!="function"||ee===f||be!==f)return be;var we=ee.prototype,Oe=we&&Object.getPrototypeOf(we);if(Oe==null||Oe===Object.prototype)return be;var qe=Oe.constructor;return typeof qe!="function"||qe===ee?be:qe}function Ye(){var ee={},be=[],we=function(){function gt(Ct,kt,Gt){this._index=0,this._keys=Ct,this._values=kt,this._selector=Gt}return gt.prototype["@@iterator"]=function(){return this},gt.prototype[a]=function(){return this},gt.prototype.next=function(){var Ct=this._index;if(Ct>=0&&Ct<this._keys.length){var kt=this._selector(this._keys[Ct],this._values[Ct]);return Ct+1>=this._keys.length?(this._index=-1,this._keys=be,this._values=be):this._index++,{value:kt,done:!1}}return{value:void 0,done:!0}},gt.prototype.throw=function(Ct){throw this._index>=0&&(this._index=-1,this._keys=be,this._values=be),Ct},gt.prototype.return=function(Ct){return this._index>=0&&(this._index=-1,this._keys=be,this._values=be),{value:Ct,done:!0}},gt}();return function(){function gt(){this._keys=[],this._values=[],this._cacheKey=ee,this._cacheIndex=-2}return Object.defineProperty(gt.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),gt.prototype.has=function(Ct){return this._find(Ct,!1)>=0},gt.prototype.get=function(Ct){var kt=this._find(Ct,!1);return kt>=0?this._values[kt]:void 0},gt.prototype.set=function(Ct,kt){var Gt=this._find(Ct,!0);return this._values[Gt]=kt,this},gt.prototype.delete=function(Ct){var kt=this._find(Ct,!1);if(kt>=0){for(var Gt=this._keys.length,Zt=kt+1;Zt<Gt;Zt++)this._keys[Zt-1]=this._keys[Zt],this._values[Zt-1]=this._values[Zt];return this._keys.length--,this._values.length--,Ct===this._cacheKey&&(this._cacheKey=ee,this._cacheIndex=-2),!0}return!1},gt.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=ee,this._cacheIndex=-2},gt.prototype.keys=function(){return new we(this._keys,this._values,Oe)},gt.prototype.values=function(){return new we(this._keys,this._values,qe)},gt.prototype.entries=function(){return new we(this._keys,this._values,Jt)},gt.prototype["@@iterator"]=function(){return this.entries()},gt.prototype[a]=function(){return this.entries()},gt.prototype._find=function(Ct,kt){return this._cacheKey!==Ct&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Ct)),this._cacheIndex<0&&kt&&(this._cacheIndex=this._keys.length,this._keys.push(Ct),this._values.push(void 0)),this._cacheIndex},gt}();function Oe(gt,Ct){return gt}function qe(gt,Ct){return Ct}function Jt(gt,Ct){return[gt,Ct]}}function nt(){return function(){function ee(){this._map=new h}return Object.defineProperty(ee.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),ee.prototype.has=function(be){return this._map.has(be)},ee.prototype.add=function(be){return this._map.set(be,be),this},ee.prototype.delete=function(be){return this._map.delete(be)},ee.prototype.clear=function(){this._map.clear()},ee.prototype.keys=function(){return this._map.keys()},ee.prototype.values=function(){return this._map.values()},ee.prototype.entries=function(){return this._map.entries()},ee.prototype["@@iterator"]=function(){return this.keys()},ee.prototype[a]=function(){return this.keys()},ee}()}function Et(){var ee=16,be=l.create(),we=Oe();return function(){function kt(){this._key=Oe()}return kt.prototype.has=function(Gt){var Zt=qe(Gt,!1);return Zt!==void 0?l.has(Zt,this._key):!1},kt.prototype.get=function(Gt){var Zt=qe(Gt,!1);return Zt!==void 0?l.get(Zt,this._key):void 0},kt.prototype.set=function(Gt,Zt){var ar=qe(Gt,!0);return ar[this._key]=Zt,this},kt.prototype.delete=function(Gt){var Zt=qe(Gt,!1);return Zt!==void 0?delete Zt[this._key]:!1},kt.prototype.clear=function(){this._key=Oe()},kt}();function Oe(){var kt;do kt="@@WeakMap@@"+Ct();while(l.has(be,kt));return be[kt]=!0,kt}function qe(kt,Gt){if(!t.call(kt,we)){if(!Gt)return;Object.defineProperty(kt,we,{value:l.create()})}return kt[we]}function Jt(kt,Gt){for(var Zt=0;Zt<Gt;++Zt)kt[Zt]=Math.random()*255|0;return kt}function gt(kt){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(kt)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(kt)):Jt(new Uint8Array(kt),kt):Jt(new Array(kt),kt)}function Ct(){var kt=gt(ee);kt[6]=kt[6]&79|64,kt[8]=kt[8]&191|128;for(var Gt="",Zt=0;Zt<ee;++Zt){var ar=kt[Zt];(Zt===4||Zt===6||Zt===8)&&(Gt+="-"),ar<16&&(Gt+="0"),Gt+=ar.toString(16).toLowerCase()}return Gt}}function D(ee){return ee.__=void 0,delete ee.__,ee}})})(CA||(CA={}));function AA(r,e,t,n,i,a,o){try{var s=r[a](o),u=s.value}catch(l){t(l);return}s.done?e(u):Promise.resolve(u).then(n,i)}function wr(r){return function(){var e=this,t=arguments;return new Promise(function(n,i){var a=r.apply(e,t);function o(u){AA(a,n,i,o,s,"next",u)}function s(u){AA(a,n,i,o,s,"throw",u)}o(void 0)})}}var YJ=-1,qJ=1;function Ia(){return qJ++}var Gs=function r(e){wt(this,r)},Fs=function(){function r(e){wt(this,r),this.clazz=void 0,this.components=[],this.entities=[],this.lookup={},this.clazz=e}return Bt(r,[{key:"clear",value:function(){this.components=[],this.entities=[],this.lookup={}}},{key:"contains",value:function(t){return this.lookup[t]>-1}},{key:"create",value:function(t,n){this.lookup[t]=this.components.length;var i=new this.clazz(n||{});return this.components.push(i),this.entities.push(t),i}},{key:"remove",value:function(t){var n=this.lookup[t];n>-1&&n<this.components.length-1&&(this.components[n]=this.components[this.components.length-1],this.entities[n]=this.entities[this.entities.length-1],this.lookup[this.entities[n]]=n),this.components.pop(),this.entities.pop(),delete this.lookup[t]}},{key:"removeKeepSorted",value:function(t){var n=this.lookup[t];if(n>-1){var i=this.entities[n];if(n<this.components.length-1){for(var a=n+1;a<this.components.length;++a)this.components[a-1]=this.components[a];for(var o=n+1;o<this.entities.length;++o)this.entities[o-1]=this.entities[o],this.lookup[this.entities[o-1]]=o-1}this.components.pop(),this.entities.pop(),delete this.lookup[i]}}},{key:"moveItem",value:function(t,n){if(t!==n){for(var i=this.components[t],a=this.entities[t],o=t<n?1:-1,s=t;s!==n;s+=o){var u=s+o;this.components[s]=this.components[u],this.entities[s]=this.entities[u],this.lookup[this.entities[s]]=s}this.components[n]=i,this.entities[n]=a,this.lookup[a]=n}}},{key:"getEntity",value:function(t){return this.entities[t]}},{key:"getComponent",value:function(t){return this.components[t]}},{key:"getComponentByEntity",value:function(t){var n=this.lookup[t];return n>-1?this.components[n]:null}},{key:"getCount",value:function(){return this.components.length}},{key:"getEntityByComponentIndex",value:function(t){for(var n=0,i=Object.keys(this.lookup);n<i.length;n++){var a=i[n],o=Number(a);if(this.lookup[o]===t)return o}return YJ}},{key:"find",value:function(t){for(var n=0;n<this.getCount();n++){var i=this.getComponent(n);if(t(i,n))return i}return null}},{key:"findIndex",value:function(t){for(var n=0;n<this.getCount();n++){var i=this.getComponent(n);if(t(i,n))return n}return-1}},{key:"forEach",value:function(t){for(var n=0,i=Object.keys(this.lookup);n<i.length;n++){var a=i[n],o=Number(a),s=this.lookup[o];t(o,this.getComponent(s))}}},{key:"forEachAsync",value:function(){var e=wr(bt.mark(function n(i){var a,o,s,u,l;return bt.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:a=0,o=Object.keys(this.lookup);case 1:if(!(a<o.length)){c.next=10;break}return s=o[a],u=Number(s),l=this.lookup[u],c.next=7,i(u,this.getComponent(l));case 7:a++,c.next=1;break;case 10:case"end":return c.stop()}},n,this)}));function t(n){return e.apply(this,arguments)}return t}()},{key:"map",value:function(t){for(var n=[],i=0,a=Object.keys(this.lookup);i<a.length;i++){var o=a[i],s=Number(o),u=this.lookup[s];n.push(t(s,this.getComponent(u)))}return n}}]),r}(),la="named",TA="name",Bm="unmanaged",MA="optional",Jd="inject",$f="multi_inject",IA="inversify:tagged",kA="inversify:tagged_props",Gm="inversify:paramtypes",KJ="design:paramtypes",DA="post_construct";function ZJ(){return[Jd,$f,TA,Bm,la,MA]}var PA=ZJ(),Kn={Request:"Request",Singleton:"Singleton",Transient:"Transient"},Zn={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},Ka={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},QJ=0;function Vf(){return QJ++}var JJ=function(){function r(e,t){this.id=Vf(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=Zn.Invalid,this.constraint=function(n){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return r.prototype.clone=function(){var e=new r(this.serviceIdentifier,this.scope);return e.activated=e.scope===Kn.Singleton?this.activated:!1,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.cache=this.cache,e},r}(),eee="Cannot apply @injectable decorator multiple times.",tee="Metadata key was used more than once in a parameter:",Wf="NULL argument",NA="Key Not Found",ree="Ambiguous match found for serviceIdentifier:",nee="Could not unbind serviceIdentifier:",iee="No matching bindings found for serviceIdentifier:",aee="Missing required @injectable annotation in:",oee="Missing required @inject or @multiInject annotation in:",see=function(r){return"@inject called with undefined this could mean that the class "+r+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},uee="Circular dependency found:",lee="Invalid binding type:",fee="No snapshot available to restore.",cee="Invalid return type in middleware. Middleware must return!",hee="Value provided to function binding must be a function!",dee="The toSelf function can only be applied when a constructor is used as service identifier",vee="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",pee=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return"The number of constructor arguments in the derived class "+(r[0]+" must be >= than the number of constructor arguments of its base class.")},gee="Invalid Container constructor argument. Container options must be an object.",yee="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",mee="Invalid Container option. Auto bind injectable must be a boolean",bee="Invalid Container option. Skip base check must be a boolean",xee=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return"@postConstruct error in class "+r[0]+": "+r[1]},_ee=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return"It looks like there is a circular dependency "+("in one of the '"+r[0]+"' bindings. Please investigate bindings with")+("service identifier '"+r[1]+"'.")},wee="Maximum call stack size exceeded",See=function(){function r(){}return r.prototype.getConstructorMetadata=function(e){var t=Reflect.getMetadata(Gm,e),n=Reflect.getMetadata(IA,e);return{compilerGeneratedMetadata:t,userGeneratedMetadata:n||{}}},r.prototype.getPropertiesMetadata=function(e){var t=Reflect.getMetadata(kA,e)||[];return t},r}(),ev={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};function LA(r){return r instanceof RangeError||r.message===wee}function jf(r){if(typeof r=="function"){var e=r;return e.name}else{if(typeof r=="symbol")return r.toString();var e=r;return e}}function OA(r,e,t){var n="",i=t(r,e);return i.length!==0&&(n=`
Registered bindings:`,i.forEach(function(a){var o="Object";a.implementationType!==null&&(o=tv(a.implementationType)),n=n+`
 `+o,a.constraint.metaData&&(n=n+" - "+a.constraint.metaData)})),n}function RA(r,e){return r.parentRequest===null?!1:r.parentRequest.serviceIdentifier===e?!0:RA(r.parentRequest,e)}function Eee(r){function e(n,i){i===void 0&&(i=[]);var a=jf(n.serviceIdentifier);return i.push(a),n.parentRequest!==null?e(n.parentRequest,i):i}var t=e(r);return t.reverse().join(" --> ")}function BA(r){r.childRequests.forEach(function(e){if(RA(e,e.serviceIdentifier)){var t=Eee(e);throw new Error(uee+" "+t)}else BA(e)})}function Cee(r,e){if(e.isTagged()||e.isNamed()){var t="",n=e.getNamedTag(),i=e.getCustomTags();return n!==null&&(t+=n.toString()+`
`),i!==null&&i.forEach(function(a){t+=a.toString()+`
`})," "+r+`
 `+r+" - "+t}else return" "+r}function tv(r){if(r.name)return r.name;var e=r.toString(),t=e.match(/^function\s*([^\s(]+)/);return t?t[1]:"Anonymous function: "+e}var GA=function(){function r(e){this.id=Vf(),this.container=e}return r.prototype.addPlan=function(e){this.plan=e},r.prototype.setCurrentRequest=function(e){this.currentRequest=e},r}(),Po=function(){function r(e,t){this.key=e,this.value=t}return r.prototype.toString=function(){return this.key===la?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},r}(),Aee=function(){function r(e,t){this.parentContext=e,this.rootRequest=t}return r}();function FA(r,e,t,n){var i=IA;zA(i,r,e,n,t)}function UA(r,e,t){var n=kA;zA(n,r.constructor,e,t)}function zA(r,e,t,n,i){var a={},o=typeof i=="number",s=i!==void 0&&o?i.toString():t;if(o&&t!==void 0)throw new Error(vee);Reflect.hasOwnMetadata(r,e)&&(a=Reflect.getMetadata(r,e));var u=a[s];if(!Array.isArray(u))u=[];else for(var l=0,f=u;l<f.length;l++){var c=f[l];if(c.key===n.key)throw new Error(tee+" "+c.key.toString())}u.push(n),a[s]=u,Reflect.defineMetadata(r,a,e)}var Tee=function(){function r(e){this._cb=e}return r.prototype.unwrap=function(){return this._cb()},r}();function Nt(r){return function(e,t,n){if(r===void 0)throw new Error(see(e.name));var i=new Po(Jd,r);typeof n=="number"?FA(e,t,n,i):UA(e,t,i)}}var Mee=function(){function r(e){this.str=e}return r.prototype.startsWith=function(e){return this.str.indexOf(e)===0},r.prototype.endsWith=function(e){var t="",n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},r.prototype.contains=function(e){return this.str.indexOf(e)!==-1},r.prototype.equals=function(e){return this.str===e},r.prototype.value=function(){return this.str},r}(),rv=function(){function r(e,t,n,i){this.id=Vf(),this.type=e,this.serviceIdentifier=n,this.name=new Mee(t||""),this.metadata=new Array;var a=null;typeof i=="string"?a=new Po(la,i):i instanceof Po&&(a=i),a!==null&&this.metadata.push(a)}return r.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){var i=n[t];if(i.key===e)return!0}return!1},r.prototype.isArray=function(){return this.hasTag($f)},r.prototype.matchesArray=function(e){return this.matchesTag($f)(e)},r.prototype.isNamed=function(){return this.hasTag(la)},r.prototype.isTagged=function(){return this.metadata.some(function(e){return PA.every(function(t){return e.key!==t})})},r.prototype.isOptional=function(){return this.matchesTag(MA)(!0)},r.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(e){return e.key===la})[0]:null},r.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(e){return PA.every(function(t){return e.key!==t})}):null},r.prototype.matchesNamedTag=function(e){return this.matchesTag(la)(e)},r.prototype.matchesTag=function(e){var t=this;return function(n){for(var i=0,a=t.metadata;i<a.length;i++){var o=a[i];if(o.key===e&&o.value===n)return!0}return!1}},r}(),nv=function(r,e){for(var t=0,n=e.length,i=r.length;t<n;t++,i++)r[i]=e[t];return r};function Iee(r,e){var t=tv(e),n=$A(r,t,e,!1);return n}function $A(r,e,t,n){var i=r.getConstructorMetadata(t),a=i.compilerGeneratedMetadata;if(a===void 0){var o=aee+" "+e+".";throw new Error(o)}var s=i.userGeneratedMetadata,u=Object.keys(s),l=t.length===0&&u.length>0,f=u.length>t.length,c=l||f?u.length:t.length,h=Dee(n,e,a,s,c),d=VA(r,t),v=nv(nv([],h),d);return v}function kee(r,e,t,n,i){var a=i[r.toString()]||[],o=jA(a),s=o.unmanaged!==!0,u=n[r],l=o.inject||o.multiInject;if(u=l||u,u instanceof Tee&&(u=u.unwrap()),s){var f=u===Object,c=u===Function,h=u===void 0,d=f||c||h;if(!e&&d){var v=oee+" argument "+r+" in class "+t+".";throw new Error(v)}var p=new rv(Ka.ConstructorArgument,o.targetName,u);return p.metadata=a,p}return null}function Dee(r,e,t,n,i){for(var a=[],o=0;o<i;o++){var s=o,u=kee(s,r,e,t,n);u!==null&&a.push(u)}return a}function VA(r,e){for(var t=r.getPropertiesMetadata(e),n=[],i=Object.keys(t),a=0,o=i;a<o.length;a++){var s=o[a],u=t[s],l=jA(t[s]),f=l.targetName||s,c=l.inject||l.multiInject,h=new rv(Ka.ClassProperty,f,c);h.metadata=u,n.push(h)}var d=Object.getPrototypeOf(e.prototype).constructor;if(d!==Object){var v=VA(r,d);n=nv(nv([],n),v)}return n}function WA(r,e){var t=Object.getPrototypeOf(e.prototype).constructor;if(t!==Object){var n=tv(t),i=$A(r,n,t,!0),a=i.map(function(u){return u.metadata.filter(function(l){return l.key===Bm})}),o=[].concat.apply([],a).length,s=i.length-o;return s>0?s:WA(r,t)}else return 0}function jA(r){var e={};return r.forEach(function(t){e[t.key.toString()]=t.value}),{inject:e[Jd],multiInject:e[$f],targetName:e[TA],unmanaged:e[Bm]}}var Fm=function(){function r(e,t,n,i,a){this.id=Vf(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=a,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=n===null?new Map:null}return r.prototype.addChildRequest=function(e,t,n){var i=new r(e,this.parentContext,this,t,n);return this.childRequests.push(i),i},r}();function Um(r){return r._bindingDictionary}function Pee(r,e,t,n,i,a){var o=r?$f:Jd,s=new Po(o,t),u=new rv(e,n,t,s);if(i!==void 0){var l=new Po(i,a);u.metadata.push(l)}return u}function XA(r,e,t,n,i){var a=Xf(t.container,i.serviceIdentifier),o=[];return a.length===ev.NoBindingsAvailable&&t.container.options.autoBindInjectable&&typeof i.serviceIdentifier=="function"&&r.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(t.container.bind(i.serviceIdentifier).toSelf(),a=Xf(t.container,i.serviceIdentifier)),e?o=a:o=a.filter(function(s){var u=new Fm(s.serviceIdentifier,t,n,s,i);return s.constraint(u)}),Nee(i.serviceIdentifier,o,i,t.container),o}function Nee(r,e,t,n){switch(e.length){case ev.NoBindingsAvailable:if(t.isOptional())return e;var i=jf(r),a=iee;throw a+=Cee(i,t),a+=OA(n,i,Xf),new Error(a);case ev.OnlyOneBindingAvailable:if(!t.isArray())return e;case ev.MultipleBindingsAvailable:default:if(t.isArray())return e;var i=jf(r),a=ree+" "+i;throw a+=OA(n,i,Xf),new Error(a)}}function HA(r,e,t,n,i,a){var o,s;if(i===null){o=XA(r,e,n,null,a),s=new Fm(t,n,null,o,a);var u=new Aee(n,s);n.addPlan(u)}else o=XA(r,e,n,i,a),s=i.addChildRequest(a.serviceIdentifier,o,a);o.forEach(function(l){var f=null;if(a.isArray())f=s.addChildRequest(l.serviceIdentifier,l,a);else{if(l.cache)return;f=s}if(l.type===Zn.Instance&&l.implementationType!==null){var c=Iee(r,l.implementationType);if(!n.container.options.skipBaseClassChecks){var h=WA(r,l.implementationType);if(c.length<h){var d=pee(tv(l.implementationType));throw new Error(d)}}c.forEach(function(v){HA(r,!1,v.serviceIdentifier,n,f,v)})}})}function Xf(r,e){var t=[],n=Um(r);return n.hasKey(e)?t=n.get(e):r.parent!==null&&(t=Xf(r.parent,e)),t}function Lee(r,e,t,n,i,a,o,s){s===void 0&&(s=!1);var u=new GA(e),l=Pee(t,n,i,"",a,o);try{return HA(r,s,i,u,null,l),u}catch(f){throw LA(f)&&u.plan&&BA(u.plan.rootRequest),f}}function Oee(r,e,t,n){var i=new rv(Ka.Variable,"",e,new Po(t,n)),a=new GA(r),o=new Fm(e,a,null,[],i);return o}var Ree=function(r,e){for(var t=0,n=e.length,i=r.length;t<n;t++,i++)r[i]=e[t];return r};function Bee(r,e,t){var n=e.filter(function(a){return a.target!==null&&a.target.type===Ka.ClassProperty}),i=n.map(t);return n.forEach(function(a,o){var s="";s=a.target.name.value();var u=i[o];r[s]=u}),r}function Gee(r,e){return new(r.bind.apply(r,Ree([void 0],e)))}function Fee(r,e){if(Reflect.hasMetadata(DA,r)){var t=Reflect.getMetadata(DA,r);try{e[t.value]()}catch(n){throw new Error(xee(r.name,n.message))}}}function Uee(r,e,t){var n=null;if(e.length>0){var i=e.filter(function(o){return o.target!==null&&o.target.type===Ka.ConstructorArgument}),a=i.map(t);n=Gee(r,a),n=Bee(n,e,t)}else n=new r;return Fee(r,n),n}var zm=function(r,e,t){try{return t()}catch(n){throw LA(n)?new Error(_ee(r,e.toString())):n}},$m=function(r){return function(e){e.parentContext.setCurrentRequest(e);var t=e.bindings,n=e.childRequests,i=e.target&&e.target.isArray(),a=!e.parentRequest||!e.parentRequest.target||!e.target||!e.parentRequest.target.matchesArray(e.target.serviceIdentifier);if(i&&a)return n.map(function(c){var h=$m(r);return h(c)});var o=null;if(e.target.isOptional()&&t.length===0)return;var s=t[0],u=s.scope===Kn.Singleton,l=s.scope===Kn.Request;if(u&&s.activated)return s.cache;if(l&&r!==null&&r.has(s.id))return r.get(s.id);if(s.type===Zn.ConstantValue)o=s.cache,s.activated=!0;else if(s.type===Zn.Function)o=s.cache,s.activated=!0;else if(s.type===Zn.Constructor)o=s.implementationType;else if(s.type===Zn.DynamicValue&&s.dynamicValue!==null)o=zm("toDynamicValue",s.serviceIdentifier,function(){return s.dynamicValue(e.parentContext)});else if(s.type===Zn.Factory&&s.factory!==null)o=zm("toFactory",s.serviceIdentifier,function(){return s.factory(e.parentContext)});else if(s.type===Zn.Provider&&s.provider!==null)o=zm("toProvider",s.serviceIdentifier,function(){return s.provider(e.parentContext)});else if(s.type===Zn.Instance&&s.implementationType!==null)o=Uee(s.implementationType,n,$m(r));else{var f=jf(e.serviceIdentifier);throw new Error(lee+" "+f)}return typeof s.onActivation=="function"&&(o=s.onActivation(e.parentContext,o)),u&&(s.cache=o,s.activated=!0),l&&r!==null&&!r.has(s.id)&&r.set(s.id,o),o}};function zee(r){var e=$m(r.plan.rootRequest.requestScope);return e(r.plan.rootRequest)}var Za=function(r,e){var t=r.parentRequest;return t!==null?e(t)?!0:Za(t,e):!1},Hf=function(r){return function(e){var t=function(n){return n!==null&&n.target!==null&&n.target.matchesTag(r)(e)};return t.metaData=new Po(r,e),t}},iv=Hf(la),Vm=function(r){return function(e){var t=null;if(e!==null)if(t=e.bindings[0],typeof r=="string"){var n=t.serviceIdentifier;return n===r}else{var i=e.bindings[0].implementationType;return r===i}return!1}},Wm=function(){function r(e){this._binding=e}return r.prototype.when=function(e){return this._binding.constraint=e,new Qn(this._binding)},r.prototype.whenTargetNamed=function(e){return this._binding.constraint=iv(e),new Qn(this._binding)},r.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){var t=e.target!==null&&!e.target.isNamed()&&!e.target.isTagged();return t},new Qn(this._binding)},r.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=Hf(e)(t),new Qn(this._binding)},r.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return Vm(e)(t.parentRequest)},new Qn(this._binding)},r.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return iv(e)(t.parentRequest)},new Qn(this._binding)},r.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return Hf(e)(t)(n.parentRequest)},new Qn(this._binding)},r.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return Za(t,Vm(e))},new Qn(this._binding)},r.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return!Za(t,Vm(e))},new Qn(this._binding)},r.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return Za(t,iv(e))},new Qn(this._binding)},r.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return!Za(t,iv(e))},new Qn(this._binding)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return Za(n,Hf(e)(t))},new Qn(this._binding)},r.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return!Za(n,Hf(e)(t))},new Qn(this._binding)},r.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return Za(t,e)},new Qn(this._binding)},r.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return!Za(t,e)},new Qn(this._binding)},r}(),Qn=function(){function r(e){this._binding=e}return r.prototype.onActivation=function(e){return this._binding.onActivation=e,new Wm(this._binding)},r}(),No=function(){function r(e){this._binding=e,this._bindingWhenSyntax=new Wm(this._binding),this._bindingOnSyntax=new Qn(this._binding)}return r.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},r.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},r.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},r.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},r.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},r.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},r.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},r.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},r.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},r.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},r.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},r.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},r.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},r.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},r.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},r}(),$ee=function(){function r(e){this._binding=e}return r.prototype.inRequestScope=function(){return this._binding.scope=Kn.Request,new No(this._binding)},r.prototype.inSingletonScope=function(){return this._binding.scope=Kn.Singleton,new No(this._binding)},r.prototype.inTransientScope=function(){return this._binding.scope=Kn.Transient,new No(this._binding)},r}(),YA=function(){function r(e){this._binding=e,this._bindingWhenSyntax=new Wm(this._binding),this._bindingOnSyntax=new Qn(this._binding),this._bindingInSyntax=new $ee(e)}return r.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},r.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},r.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},r.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},r.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},r.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},r.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},r.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},r.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},r.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},r.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},r.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},r.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},r.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},r.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},r.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},r.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},r.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},r}(),Vee=function(){function r(e){this._binding=e}return r.prototype.to=function(e){return this._binding.type=Zn.Instance,this._binding.implementationType=e,new YA(this._binding)},r.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+dee);var e=this._binding.serviceIdentifier;return this.to(e)},r.prototype.toConstantValue=function(e){return this._binding.type=Zn.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=Kn.Singleton,new No(this._binding)},r.prototype.toDynamicValue=function(e){return this._binding.type=Zn.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new YA(this._binding)},r.prototype.toConstructor=function(e){return this._binding.type=Zn.Constructor,this._binding.implementationType=e,this._binding.scope=Kn.Singleton,new No(this._binding)},r.prototype.toFactory=function(e){return this._binding.type=Zn.Factory,this._binding.factory=e,this._binding.scope=Kn.Singleton,new No(this._binding)},r.prototype.toFunction=function(e){if(typeof e!="function")throw new Error(hee);var t=this.toConstantValue(e);return this._binding.type=Zn.Function,this._binding.scope=Kn.Singleton,t},r.prototype.toAutoFactory=function(e){return this._binding.type=Zn.Factory,this._binding.factory=function(t){var n=function(){return t.container.get(e)};return n},this._binding.scope=Kn.Singleton,new No(this._binding)},r.prototype.toProvider=function(e){return this._binding.type=Zn.Provider,this._binding.provider=e,this._binding.scope=Kn.Singleton,new No(this._binding)},r.prototype.toService=function(e){this.toDynamicValue(function(t){return t.container.get(e)})},r}(),Wee=function(){function r(){}return r.of=function(e,t){var n=new r;return n.bindings=e,n.middleware=t,n},r}(),qA=function(){function r(){this._map=new Map}return r.prototype.getMap=function(){return this._map},r.prototype.add=function(e,t){if(e==null)throw new Error(Wf);if(t==null)throw new Error(Wf);var n=this._map.get(e);n!==void 0?(n.push(t),this._map.set(e,n)):this._map.set(e,[t])},r.prototype.get=function(e){if(e==null)throw new Error(Wf);var t=this._map.get(e);if(t!==void 0)return t;throw new Error(NA)},r.prototype.remove=function(e){if(e==null)throw new Error(Wf);if(!this._map.delete(e))throw new Error(NA)},r.prototype.removeByCondition=function(e){var t=this;this._map.forEach(function(n,i){var a=n.filter(function(o){return!e(o)});a.length>0?t._map.set(i,a):t._map.delete(i)})},r.prototype.hasKey=function(e){if(e==null)throw new Error(Wf);return this._map.has(e)},r.prototype.clone=function(){var e=new r;return this._map.forEach(function(t,n){t.forEach(function(i){return e.add(n,i.clone())})}),e},r.prototype.traverse=function(e){this._map.forEach(function(t,n){e(n,t)})},r}(),jee=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function s(f){try{l(n.next(f))}catch(c){o(c)}}function u(f){try{l(n.throw(f))}catch(c){o(c)}}function l(f){f.done?a(f.value):i(f.value).then(s,u)}l((n=n.apply(r,e||[])).next())})},Xee=function(r,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(f){return u([l,f])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,i=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(r,t)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},Hee=function(r,e){for(var t=0,n=e.length,i=r.length;t<n;t++,i++)r[i]=e[t];return r},KA=function(){function r(e){this._appliedMiddleware=[];var t=e||{};if(typeof t!="object")throw new Error(""+gee);if(t.defaultScope===void 0)t.defaultScope=Kn.Transient;else if(t.defaultScope!==Kn.Singleton&&t.defaultScope!==Kn.Transient&&t.defaultScope!==Kn.Request)throw new Error(""+yee);if(t.autoBindInjectable===void 0)t.autoBindInjectable=!1;else if(typeof t.autoBindInjectable!="boolean")throw new Error(""+mee);if(t.skipBaseClassChecks===void 0)t.skipBaseClassChecks=!1;else if(typeof t.skipBaseClassChecks!="boolean")throw new Error(""+bee);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=Vf(),this._bindingDictionary=new qA,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new See}return r.merge=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var a=new r,o=Hee([e,t],n).map(function(l){return Um(l)}),s=Um(a);function u(l,f){l.traverse(function(c,h){h.forEach(function(d){f.add(d.serviceIdentifier,d.clone())})})}return o.forEach(function(l){u(l,s)}),a},r.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),i=0,a=e;i<a.length;i++){var o=a[i],s=n(o.id);o.registry(s.bindFunction,s.unbindFunction,s.isboundFunction,s.rebindFunction)}},r.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return jee(this,void 0,void 0,function(){var n,i,a,o,s;return Xee(this,function(u){switch(u.label){case 0:n=this._getContainerModuleHelpersFactory(),i=0,a=e,u.label=1;case 1:return i<a.length?(o=a[i],s=n(o.id),[4,o.registry(s.bindFunction,s.unbindFunction,s.isboundFunction,s.rebindFunction)]):[3,4];case 2:u.sent(),u.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},r.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=function(a){return function(o){return o.moduleId===a}};t.forEach(function(a){var o=i(a.id);e._bindingDictionary.removeByCondition(o)})},r.prototype.bind=function(e){var t=this.options.defaultScope||Kn.Transient,n=new JJ(e,t);return this._bindingDictionary.add(e,n),new Vee(n)},r.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},r.prototype.unbind=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(nee+" "+jf(e))}},r.prototype.unbindAll=function(){this._bindingDictionary=new qA},r.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},r.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,la,t)},r.prototype.isBoundTagged=function(e,t,n){var i=!1;if(this._bindingDictionary.hasKey(e)){var a=this._bindingDictionary.get(e),o=Oee(this,e,t,n);i=a.some(function(s){return s.constraint(o)})}return!i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i},r.prototype.snapshot=function(){this._snapshots.push(Wee.of(this._bindingDictionary.clone(),this._middleware))},r.prototype.restore=function(){var e=this._snapshots.pop();if(e===void 0)throw new Error(fee);this._bindingDictionary=e.bindings,this._middleware=e.middleware},r.prototype.createChild=function(e){var t=new r(e||this.options);return t.parent=this,t},r.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._appliedMiddleware=this._appliedMiddleware.concat(e);var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce(function(i,a){return a(i)},n)},r.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},r.prototype.get=function(e){return this._get(!1,!1,Ka.Variable,e)},r.prototype.getTagged=function(e,t,n){return this._get(!1,!1,Ka.Variable,e,t,n)},r.prototype.getNamed=function(e,t){return this.getTagged(e,la,t)},r.prototype.getAll=function(e){return this._get(!0,!0,Ka.Variable,e)},r.prototype.getAllTagged=function(e,t,n){return this._get(!1,!0,Ka.Variable,e,t,n)},r.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,la,t)},r.prototype.resolve=function(e){var t=this.createChild();return t.bind(e).toSelf(),this._appliedMiddleware.forEach(function(n){t.applyMiddleware(n)}),t.get(e)},r.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(s,u){s._binding.moduleId=u},n=function(s){return function(u){var l=e.bind.bind(e),f=l(u);return t(f,s),f}},i=function(s){return function(u){var l=e.unbind.bind(e);l(u)}},a=function(s){return function(u){var l=e.isBound.bind(e);return l(u)}},o=function(s){return function(u){var l=e.rebind.bind(e),f=l(u);return t(f,s),f}};return function(s){return{bindFunction:n(s),isboundFunction:a(s),rebindFunction:o(s),unbindFunction:i(s)}}},r.prototype._get=function(e,t,n,i,a,o){var s=null,u={avoidConstraints:e,contextInterceptor:function(l){return l},isMultiInject:t,key:a,serviceIdentifier:i,targetType:n,value:o};if(this._middleware){if(s=this._middleware(u),s==null)throw new Error(cee)}else s=this._planAndResolve()(u);return s},r.prototype._planAndResolve=function(){var e=this;return function(t){var n=Lee(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);n=t.contextInterceptor(n);var i=zee(n);return i}},r}();function Ar(){return function(r){if(Reflect.hasOwnMetadata(Gm,r))throw new Error(eee);var e=Reflect.getMetadata(KJ,r)||[];return Reflect.defineMetadata(Gm,e,r),r}}function ka(r){return function(e,t,n){var i=new Po(la,r);typeof n=="number"?FA(e,t,n,i):UA(e,t,i)}}var Le={HierarchyComponentManager:Symbol("HierarchyComponentManager"),TransformComponentManager:Symbol("TransformComponentManager"),NameComponentManager:Symbol("NameComponentManager"),SceneGraphSystem:Symbol("SceneGraphSystem"),FrameGraphSystem:Symbol("FrameGraphSystem"),ResourcePool:Symbol("ResourcePool"),ResourceHandleComponentManager:Symbol("ResourceHandleComponentManager"),PassNodeComponentManager:Symbol("PassNodeComponentManager"),RendererSystem:Symbol("RendererSystem"),RenderPass:Symbol("RenderPass"),RenderPassFactory:Symbol("Factory<IRenderPass>"),Renderable:Symbol("Factory<IRenderPass>"),MeshSystem:Symbol("MeshSystem"),MeshComponentManager:Symbol("MeshComponentManager"),CullableComponentManager:Symbol("CullableComponentManager"),Geometry:Symbol("Geometry"),GeometrySystem:Symbol("GeometrySystem"),GeometryComponentManager:Symbol("GeometryComponentManager"),Material:Symbol("Material"),MaterialSystem:Symbol("MaterialSystem"),MaterialComponentManager:Symbol("MaterialComponentManager"),ForwardRenderPath:Symbol("ForwardRenderPath"),ComputeSystem:Symbol("ComputeSystem"),ComputeComponentManager:Symbol("ComputeComponentManager"),ComputeStrategy:Symbol("ComputeStrategy"),Systems:Symbol("Systems"),World:Symbol("World"),RenderEngine:Symbol("RenderEngine"),WebGPUEngine:Symbol("WebGPUEngine"),WebGLEngine:Symbol("WebGLEngine"),ShaderModuleService:Symbol("ShaderModuleService"),ConfigService:Symbol("ConfigService"),InteractorService:Symbol("InteractorService"),IEventEmitter:Symbol("IEventEmitter"),Light:Symbol("Light")},Yee=function r(){wt(this,r),this.index=void 0},qee=function r(){wt(this,r),this.name=void 0,this.data=void 0,this.execute=void 0,this.tearDown=void 0},Kee=function(){function r(){wt(this,r),this.name=void 0,this.refCount=0,this.hasSideEffect=!1,this.devirtualize=[],this.destroy=[],this.reads=[],this.writes=[]}return Bt(r,[{key:"read",value:function(t){return this.reads.find(function(n){return n.index===t.index})||this.reads.push(t),t}},{key:"sample",value:function(t){return this.read(t),t}},{key:"write",value:function(t,n){var i=this.writes.find(function(u){return u.index===n.index});if(i)return n;var a=t.getResourceNode(n);a.resource.version++,a.resource.imported&&(this.hasSideEffect=!0);var o=t.createResourceNode(a.resource),s=t.getResourceNode(o);return s.writer=this,this.writes.push(o),o}}]),r}();function jm(r,e){return jm=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},jm(r,e)}function oi(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),e&&jm(r,e)}function cn(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function si(r,e){return e&&(us(e)==="object"||typeof e=="function")?e:cn(r)}function Tr(r){return Tr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Tr(r)}var Zee=function r(){wt(this,r),this.first=void 0,this.last=void 0};function Qee(r){var e=Jee();return function(){var n=Tr(r),i;if(e){var a=Tr(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return si(this,i)}}function Jee(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var ZA=function(r){oi(t,r);var e=Qee(t);function t(){var n;wt(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=e.call.apply(e,[this].concat(a)),n.version=0,n.refs=0,n.name=void 0,n.imported=void 0,n.priority=void 0,n.discardStart=!0,n.discardEnd=!1,n.descriptor=void 0,n.resource=void 0,n}return Bt(t,[{key:"preExecuteDestroy",value:function(){this.discardEnd=!0}},{key:"postExecuteDestroy",value:function(){!this.imported}},{key:"postExecuteDevirtualize",value:function(){this.discardStart=!1}},{key:"preExecuteDevirtualize",value:function(){!this.imported}}]),t}(Zee),ete=function r(){wt(this,r),this.resource=void 0,this.writer=void 0,this.readerCount=0,this.version=void 0},QA,JA,eT,Xm,tT,rT;function ji(r,e){var t;if(typeof Symbol=="undefined"||r[Symbol.iterator]==null){if(Array.isArray(r)||(t=tte(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=r[Symbol.iterator]()},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function tte(r,e){if(!!r){if(typeof r=="string")return nT(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return nT(r,e)}}function nT(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}var rte=(QA=Ar(),JA=Nt(Le.RenderEngine),QA(eT=(Xm=(rT=function(){function r(){wt(this,r),this.passNodes=[],this.resourceNodes=[],this.frameGraphPasses=[],Dt(this,"engine",tT,this)}return Bt(r,[{key:"execute",value:function(){var e=wr(bt.mark(function n(i){return bt.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.compile(),o.next=3,this.executePassNodes(i);case 3:case"end":return o.stop()}},n,this)}));function t(n){return e.apply(this,arguments)}return t}()},{key:"tearDown",value:function(){this.frameGraphPasses.forEach(function(t){t.tearDown&&t.tearDown()}),this.reset()}},{key:"addPass",value:function(t,n,i,a){var o=new qee;o.execute=i,a&&(o.tearDown=a),o.name=t;var s=new Kee;return s.name=t,this.passNodes.push(s),this.frameGraphPasses.push(o),n(this,s,o),o}},{key:"getPass",value:function(t){return this.frameGraphPasses.find(function(n){return n.name===t})}},{key:"compile",value:function(){var t=this,n=ji(this.passNodes),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;a.refCount=a.writes.length+(a.hasSideEffect?1:0),a.reads.forEach(function(le){t.resourceNodes[le.index].readerCount++})}}catch(le){n.e(le)}finally{n.f()}var o=[],s=ji(this.resourceNodes),u;try{for(s.s();!(u=s.n()).done;){var l=u.value;l.readerCount===0&&o.push(l)}}catch(le){s.e(le)}finally{s.f()}for(;o.length;){var f=o.pop(),c=f&&f.writer;if(c&&--c.refCount==0){var h=ji(c.reads),d;try{for(h.s();!(d=h.n()).done;){var v=d.value,p=this.resourceNodes[v.index];--p.readerCount==0&&o.push(p)}}catch(le){h.e(le)}finally{h.f()}}}this.resourceNodes.forEach(function(le){le.resource.refs+=le.readerCount});var g=ji(this.passNodes),y;try{for(g.s();!(y=g.n()).done;){var m=y.value;if(!!m.refCount){var b=ji(m.reads),x;try{for(b.s();!(x=b.n()).done;){var _=x.value,S=this.resourceNodes[_.index].resource;S.first=S.first?S.first:m,S.last=m}}catch(le){b.e(le)}finally{b.f()}var E=ji(m.writes),C;try{for(E.s();!(C=E.n()).done;){var M=C.value,w=this.resourceNodes[M.index].resource;w.first=w.first?w.first:m,w.last=m}}catch(le){E.e(le)}finally{E.f()}}}}catch(le){g.e(le)}finally{g.f()}for(var T=0;T<2;T++){var I=ji(this.resourceNodes),k;try{for(I.s();!(k=I.n()).done;){var O=k.value,U=O.resource;if(U.priority===T&&U.refs){var q=U.first,K=U.last;q&&K&&(q.devirtualize.push(U),K.destroy.push(U))}}}catch(le){I.e(le)}finally{I.f()}}}},{key:"executePassNodes",value:function(){var e=wr(bt.mark(function n(i){var a,o,s,u,l,f,c,h,d,v,p,g,y,m,b,x,_;return bt.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:a=ji(this.passNodes.entries()),E.prev=1,a.s();case 3:if((o=a.n()).done){E.next=18;break}if(s=oh(o.value,2),u=s[0],l=s[1],!l.refCount){E.next=16;break}f=ji(l.devirtualize);try{for(f.s();!(c=f.n()).done;)h=c.value,h.preExecuteDevirtualize(this.engine)}catch(C){f.e(C)}finally{f.f()}d=ji(l.destroy);try{for(d.s();!(v=d.n()).done;)p=v.value,p.preExecuteDestroy(this.engine)}catch(C){d.e(C)}finally{d.f()}return E.next=12,this.frameGraphPasses[u].execute(this,this.frameGraphPasses[u],i);case 12:g=ji(l.devirtualize);try{for(g.s();!(y=g.n()).done;)m=y.value,m.postExecuteDevirtualize(this.engine)}catch(C){g.e(C)}finally{g.f()}b=ji(l.destroy);try{for(b.s();!(x=b.n()).done;)_=x.value,_.postExecuteDestroy(this.engine)}catch(C){b.e(C)}finally{b.f()}case 16:E.next=3;break;case 18:E.next=23;break;case 20:E.prev=20,E.t0=E.catch(1),a.e(E.t0);case 23:return E.prev=23,a.f(),E.finish(23);case 26:this.reset();case 27:case"end":return E.stop()}},n,this,[[1,20,23,26]])}));function t(n){return e.apply(this,arguments)}return t}()},{key:"reset",value:function(){this.passNodes=[],this.resourceNodes=[],this.frameGraphPasses=[]}},{key:"getResourceNode",value:function(t){return this.resourceNodes[t.index]}},{key:"createResourceNode",value:function(t){var n=new ete;n.resource=t,n.version=t.version,this.resourceNodes.push(n);var i=new Yee;return i.index=this.resourceNodes.length-1,i}},{key:"createTexture",value:function(t,n,i){var a=new ZA;return a.name=n,a.descriptor=i,this.createResourceNode(a)}},{key:"createRenderTarget",value:function(t,n,i){var a=new ZA;return a.name=n,a.descriptor=i,this.createResourceNode(a)}},{key:"present",value:function(t){this.addPass("Present",function(n,i){i.read(t),i.hasSideEffect=!0},wr(bt.mark(function n(){return bt.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:case"end":return a.stop()}},n)})))}}]),r}(),rT),tT=Pt(Xm.prototype,"engine",[JA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xm))||eT),nte=9007199254740991,ite="[object Arguments]",ate="[object Array]",ote="[object Boolean]",ste="[object Date]",ute="[object Error]",lte="[object Function]",fte="[object Map]",cte="[object Number]",hte="[object Object]",dte="[object RegExp]",vte="[object Set]",pte="[object String]",gte="[object WeakMap]",yte="[object ArrayBuffer]",mte="[object DataView]",bte="[object Float32Array]",xte="[object Float64Array]",_te="[object Int8Array]",wte="[object Int16Array]",Ste="[object Int32Array]",Ete="[object Uint8Array]",Cte="[object Uint8ClampedArray]",Ate="[object Uint16Array]",Tte="[object Uint32Array]",Jr={};Jr[bte]=Jr[xte]=Jr[_te]=Jr[wte]=Jr[Ste]=Jr[Ete]=Jr[Cte]=Jr[Ate]=Jr[Tte]=!0;Jr[ite]=Jr[ate]=Jr[yte]=Jr[ote]=Jr[mte]=Jr[ste]=Jr[ute]=Jr[lte]=Jr[fte]=Jr[cte]=Jr[hte]=Jr[dte]=Jr[vte]=Jr[pte]=Jr[gte]=!1;var Mte=Object.prototype,Ite=Mte.toString;function kte(r){return Pte(r)&&Dte(r.length)&&!!Jr[Ite.call(r)]}function Dte(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=nte}function Pte(r){return!!r&&us(r)==="object"}var iT=kte;function aT(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function oT(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?aT(Object(t),!0).forEach(function(n){Ce(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):aT(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function Nte(r){var e=Lte();return function(){var n=Tr(r),i;if(e){var a=Tr(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return si(this,i)}}function Lte(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var Ote=function(r){oi(t,r);var e=Nte(t);function t(n){var i;return wt(this,t),i=e.call(this,n),i.dirty=!0,i.attributes=[],i.indices=void 0,i.indicesBuffer=void 0,i.vertexCount=0,i.maxInstancedCount=void 0,i.aabb=void 0,i.entity=void 0,Object.assign(cn(i),n),i}return Bt(t,[{key:"setAttribute",value:function(i,a,o,s){var u=this.attributes.find(function(l){return l.name===i});return u?(u.data=a,u.dirty=!0):this.attributes.push(oT(oT({dirty:!0,name:i,data:a},o),{},{bufferGetter:s})),this.dirty=!0,this}},{key:"setIndex",value:function(i){return this.indices=new Uint32Array(i.buffer?i.buffer:i),this.dirty=!0,this}},{key:"applyMatrix",value:function(i){var a=this.attributes.find(function(h){var d=h.name;return d==="position"}),o=this.attributes.find(function(h){var d=h.name;return d==="normal"});if(a&&(a.dirty=!0,a.data&&a.data.length))for(var s=0;s<a.data.length;s+=3){var u=Cx(a.data[s],a.data[s+1],a.data[s+2],1);Hl(u,u,i),iT(a.data)?a.data.set([u[0],u[1],u[2]],s):(a.data[s]=u[0],a.data[s+1]=u[1],a.data[s+2]=u[2])}if(o){var l=bx(Cu(),i);if(o.data&&o.data.length)for(var f=0;f<o.data.length;f+=3){var c=nr(o.data[f],o.data[f+1],o.data[f+2]);Mu(c,c,l),jl(c,c),iT(o.data)?o.data.set([c[0],c[1],c[2]],f):(o.data[f]=c[0],o.data[f+1]=c[1],o.data[f+2]=c[2])}}}}]),t}(Gs),ae;(function(r){r[r.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",r[r.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",r[r.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN",r[r.ZERO=0]="ZERO",r[r.ONE=1]="ONE",r[r.SRC_COLOR=768]="SRC_COLOR",r[r.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",r[r.SRC_ALPHA=770]="SRC_ALPHA",r[r.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",r[r.DST_ALPHA=772]="DST_ALPHA",r[r.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",r[r.DST_COLOR=774]="DST_COLOR",r[r.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",r[r.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",r[r.FUNC_ADD=32774]="FUNC_ADD",r[r.BLEND_EQUATION=32777]="BLEND_EQUATION",r[r.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",r[r.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",r[r.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",r[r.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",r[r.MAX_EXT=32776]="MAX_EXT",r[r.MIN_EXT=32775]="MIN_EXT",r[r.BLEND_DST_RGB=32968]="BLEND_DST_RGB",r[r.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",r[r.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",r[r.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",r[r.CONSTANT_COLOR=32769]="CONSTANT_COLOR",r[r.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",r[r.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",r[r.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",r[r.BLEND_COLOR=32773]="BLEND_COLOR",r[r.ARRAY_BUFFER=34962]="ARRAY_BUFFER",r[r.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",r[r.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",r[r.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",r[r.STREAM_DRAW=35040]="STREAM_DRAW",r[r.STATIC_DRAW=35044]="STATIC_DRAW",r[r.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",r[r.BUFFER_SIZE=34660]="BUFFER_SIZE",r[r.BUFFER_USAGE=34661]="BUFFER_USAGE",r[r.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",r[r.FRONT=1028]="FRONT",r[r.BACK=1029]="BACK",r[r.FRONT_AND_BACK=1032]="FRONT_AND_BACK",r[r.CULL_FACE=2884]="CULL_FACE",r[r.BLEND=3042]="BLEND",r[r.DITHER=3024]="DITHER",r[r.STENCIL_TEST=2960]="STENCIL_TEST",r[r.DEPTH_TEST=2929]="DEPTH_TEST",r[r.SCISSOR_TEST=3089]="SCISSOR_TEST",r[r.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",r[r.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",r[r.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",r[r.NO_ERROR=0]="NO_ERROR",r[r.INVALID_ENUM=1280]="INVALID_ENUM",r[r.INVALID_VALUE=1281]="INVALID_VALUE",r[r.INVALID_OPERATION=1282]="INVALID_OPERATION",r[r.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",r[r.CW=2304]="CW",r[r.CCW=2305]="CCW",r[r.LINE_WIDTH=2849]="LINE_WIDTH",r[r.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",r[r.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",r[r.CULL_FACE_MODE=2885]="CULL_FACE_MODE",r[r.FRONT_FACE=2886]="FRONT_FACE",r[r.DEPTH_RANGE=2928]="DEPTH_RANGE",r[r.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",r[r.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",r[r.DEPTH_FUNC=2932]="DEPTH_FUNC",r[r.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",r[r.STENCIL_FUNC=2962]="STENCIL_FUNC",r[r.STENCIL_FAIL=2964]="STENCIL_FAIL",r[r.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",r[r.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",r[r.STENCIL_REF=2967]="STENCIL_REF",r[r.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",r[r.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",r[r.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",r[r.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",r[r.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",r[r.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",r[r.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",r[r.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",r[r.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",r[r.VIEWPORT=2978]="VIEWPORT",r[r.SCISSOR_BOX=3088]="SCISSOR_BOX",r[r.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",r[r.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",r[r.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",r[r.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",r[r.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",r[r.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",r[r.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",r[r.RED_BITS=3410]="RED_BITS",r[r.GREEN_BITS=3411]="GREEN_BITS",r[r.BLUE_BITS=3412]="BLUE_BITS",r[r.ALPHA_BITS=3413]="ALPHA_BITS",r[r.DEPTH_BITS=3414]="DEPTH_BITS",r[r.STENCIL_BITS=3415]="STENCIL_BITS",r[r.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",r[r.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",r[r.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",r[r.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",r[r.SAMPLES=32937]="SAMPLES",r[r.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",r[r.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",r[r.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",r[r.DONT_CARE=4352]="DONT_CARE",r[r.FASTEST=4353]="FASTEST",r[r.NICEST=4354]="NICEST",r[r.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",r[r.BYTE=5120]="BYTE",r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.SHORT=5122]="SHORT",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.INT=5124]="INT",r[r.UNSIGNED_INT=5125]="UNSIGNED_INT",r[r.FLOAT=5126]="FLOAT",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.ALPHA=6406]="ALPHA",r[r.RGB=6407]="RGB",r[r.RGBA=6408]="RGBA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",r[r.VERTEX_SHADER=35633]="VERTEX_SHADER",r[r.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",r[r.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",r[r.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",r[r.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",r[r.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",r[r.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",r[r.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",r[r.SHADER_TYPE=35663]="SHADER_TYPE",r[r.DELETE_STATUS=35712]="DELETE_STATUS",r[r.LINK_STATUS=35714]="LINK_STATUS",r[r.VALIDATE_STATUS=35715]="VALIDATE_STATUS",r[r.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",r[r.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",r[r.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",r[r.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",r[r.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",r[r.NEVER=512]="NEVER",r[r.LESS=513]="LESS",r[r.EQUAL=514]="EQUAL",r[r.LEQUAL=515]="LEQUAL",r[r.GREATER=516]="GREATER",r[r.NOTEQUAL=517]="NOTEQUAL",r[r.GEQUAL=518]="GEQUAL",r[r.ALWAYS=519]="ALWAYS",r[r.KEEP=7680]="KEEP",r[r.REPLACE=7681]="REPLACE",r[r.INCR=7682]="INCR",r[r.DECR=7683]="DECR",r[r.INVERT=5386]="INVERT",r[r.INCR_WRAP=34055]="INCR_WRAP",r[r.DECR_WRAP=34056]="DECR_WRAP",r[r.VENDOR=7936]="VENDOR",r[r.RENDERER=7937]="RENDERER",r[r.VERSION=7938]="VERSION",r[r.NEAREST=9728]="NEAREST",r[r.LINEAR=9729]="LINEAR",r[r.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",r[r.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",r[r.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",r[r.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",r[r.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",r[r.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",r[r.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",r[r.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE=5890]="TEXTURE",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",r[r.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",r[r.TEXTURE0=33984]="TEXTURE0",r[r.TEXTURE1=33985]="TEXTURE1",r[r.TEXTURE2=33986]="TEXTURE2",r[r.TEXTURE3=33987]="TEXTURE3",r[r.TEXTURE4=33988]="TEXTURE4",r[r.TEXTURE5=33989]="TEXTURE5",r[r.TEXTURE6=33990]="TEXTURE6",r[r.TEXTURE7=33991]="TEXTURE7",r[r.TEXTURE8=33992]="TEXTURE8",r[r.TEXTURE9=33993]="TEXTURE9",r[r.TEXTURE10=33994]="TEXTURE10",r[r.TEXTURE11=33995]="TEXTURE11",r[r.TEXTURE12=33996]="TEXTURE12",r[r.TEXTURE13=33997]="TEXTURE13",r[r.TEXTURE14=33998]="TEXTURE14",r[r.TEXTURE15=33999]="TEXTURE15",r[r.TEXTURE16=34e3]="TEXTURE16",r[r.TEXTURE17=34001]="TEXTURE17",r[r.TEXTURE18=34002]="TEXTURE18",r[r.TEXTURE19=34003]="TEXTURE19",r[r.TEXTURE20=34004]="TEXTURE20",r[r.TEXTURE21=34005]="TEXTURE21",r[r.TEXTURE22=34006]="TEXTURE22",r[r.TEXTURE23=34007]="TEXTURE23",r[r.TEXTURE24=34008]="TEXTURE24",r[r.TEXTURE25=34009]="TEXTURE25",r[r.TEXTURE26=34010]="TEXTURE26",r[r.TEXTURE27=34011]="TEXTURE27",r[r.TEXTURE28=34012]="TEXTURE28",r[r.TEXTURE29=34013]="TEXTURE29",r[r.TEXTURE30=34014]="TEXTURE30",r[r.TEXTURE31=34015]="TEXTURE31",r[r.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",r[r.REPEAT=10497]="REPEAT",r[r.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",r[r.FLOAT_VEC2=35664]="FLOAT_VEC2",r[r.FLOAT_VEC3=35665]="FLOAT_VEC3",r[r.FLOAT_VEC4=35666]="FLOAT_VEC4",r[r.INT_VEC2=35667]="INT_VEC2",r[r.INT_VEC3=35668]="INT_VEC3",r[r.INT_VEC4=35669]="INT_VEC4",r[r.BOOL=35670]="BOOL",r[r.BOOL_VEC2=35671]="BOOL_VEC2",r[r.BOOL_VEC3=35672]="BOOL_VEC3",r[r.BOOL_VEC4=35673]="BOOL_VEC4",r[r.FLOAT_MAT2=35674]="FLOAT_MAT2",r[r.FLOAT_MAT3=35675]="FLOAT_MAT3",r[r.FLOAT_MAT4=35676]="FLOAT_MAT4",r[r.SAMPLER_2D=35678]="SAMPLER_2D",r[r.SAMPLER_CUBE=35680]="SAMPLER_CUBE",r[r.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",r[r.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",r[r.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",r[r.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",r[r.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",r[r.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",r[r.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",r[r.COMPILE_STATUS=35713]="COMPILE_STATUS",r[r.LOW_FLOAT=36336]="LOW_FLOAT",r[r.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",r[r.HIGH_FLOAT=36338]="HIGH_FLOAT",r[r.LOW_INT=36339]="LOW_INT",r[r.MEDIUM_INT=36340]="MEDIUM_INT",r[r.HIGH_INT=36341]="HIGH_INT",r[r.FRAMEBUFFER=36160]="FRAMEBUFFER",r[r.RENDERBUFFER=36161]="RENDERBUFFER",r[r.RGBA4=32854]="RGBA4",r[r.RGB5_A1=32855]="RGB5_A1",r[r.RGB565=36194]="RGB565",r[r.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",r[r.STENCIL_INDEX=6401]="STENCIL_INDEX",r[r.STENCIL_INDEX8=36168]="STENCIL_INDEX8",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL",r[r.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",r[r.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",r[r.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",r[r.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",r[r.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",r[r.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",r[r.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",r[r.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",r[r.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",r[r.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",r[r.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",r[r.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",r[r.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",r[r.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",r[r.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",r[r.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",r[r.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",r[r.NONE=0]="NONE",r[r.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",r[r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",r[r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",r[r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",r[r.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",r[r.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",r[r.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",r[r.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",r[r.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",r[r.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",r[r.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",r[r.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",r[r.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",r[r.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",r[r.COPY_SRC=1]="COPY_SRC",r[r.COPY_DST=2]="COPY_DST",r[r.SAMPLED=4]="SAMPLED",r[r.STORAGE=8]="STORAGE",r[r.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(ae||(ae={}));var sT,uT,lT,fT,av,cT,hT,dT,Rte=(sT=Ar(),uT=Nt(Le.GeometryComponentManager),lT=Nt(Le.RenderEngine),sT(fT=(av=(dT=function(){function r(){wt(this,r),Dt(this,"geometry",cT,this),Dt(this,"engine",hT,this)}return Bt(r,[{key:"execute",value:function(){var e=wr(bt.mark(function n(){var i=this;return bt.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:this.geometry.forEach(function(s,u){u.dirty&&(u.attributes.forEach(function(l){if(l.dirty&&l.data){if(!l.buffer)l.buffer=i.engine.createBuffer({data:l.data,type:ae.FLOAT});else{var f;(f=l.buffer)===null||f===void 0||f.subData({data:l.data,offset:0})}l.dirty=!1}}),u.indices&&(u.indicesBuffer?u.indicesBuffer.subData({data:u.indices,offset:0}):u.indicesBuffer=i.engine.createElements({data:u.indices,count:u.indices.length,type:ae.UNSIGNED_INT,usage:ae.STATIC_DRAW})),u.dirty=!1)});case 1:case"end":return o.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"tearDown",value:function(){this.geometry.forEach(function(t,n){n.indicesBuffer&&n.indicesBuffer.destroy(),n.attributes.forEach(function(i){i.buffer&&i.buffer.destroy()})}),this.geometry.clear()}},{key:"createBufferGeometry",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{vertexCount:3},n=t.vertexCount,i=Ia();return this.geometry.create(i,{vertexCount:n})}},{key:"createInstancedBufferGeometry",value:function(t){var n=t.maxInstancedCount,i=t.vertexCount,a=Ia();return this.geometry.create(a,{maxInstancedCount:n,vertexCount:i})}}]),r}(),dT),cT=Pt(av.prototype,"geometry",[uT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hT=Pt(av.prototype,"engine",[lT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),av))||fT);function vT(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function pT(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?vT(Object(t),!0).forEach(function(n){Ce(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):vT(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function Bte(r){var e=Gte();return function(){var n=Tr(r),i;if(e){var a=Tr(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return si(this,i)}}function Gte(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var Fte=function(r){oi(t,r);var e=Bte(t);function t(n){var i;return wt(this,t),i=e.call(this,n),i.vertexShaderGLSL=void 0,i.fragmentShaderGLSL=void 0,i.defines={},i.dirty=!0,i.uniforms=[],i.cull={enable:!0,face:ae.BACK},i.depth={enable:!0},i.blend=void 0,i.entity=void 0,i.type=void 0,Object.assign(cn(i),n),i}return Bt(t,[{key:"setDefines",value:function(i){return this.defines=pT(pT({},this.defines),i),this}},{key:"setCull",value:function(i){return this.cull=i,this}},{key:"setDepth",value:function(i){return this.depth=i,this}},{key:"setBlend",value:function(i){return this.blend=i,this}},{key:"setUniform",value:function(i,a){var o=this;if(typeof i!="string")return Object.keys(i).forEach(function(u){return o.setUniform(u,i[u])}),this;var s=this.uniforms.find(function(u){return u.name===i});return s?(s.dirty=!0,s.data=a):this.uniforms.push({name:i,dirty:!0,data:a}),this.dirty=!0,this}}]),t}(Gs),gT,yT,mT,bT,xT,Yf,_T,wT,ST,ET;function CT(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function AT(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?CT(Object(t),!0).forEach(function(n){Ce(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):CT(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var Ute=(gT=Ar(),yT=Nt(Le.MaterialComponentManager),mT=Nt(Le.RenderEngine),bT=Nt(Le.ShaderModuleService),gT(xT=(Yf=(ET=function(){function r(){wt(this,r),Dt(this,"material",_T,this),Dt(this,"engine",wT,this),Dt(this,"shaderModule",ST,this)}return Bt(r,[{key:"execute",value:function(){var e=wr(bt.mark(function n(){return bt.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:case"end":return a.stop()}},n)}));function t(){return e.apply(this,arguments)}return t}()},{key:"tearDown",value:function(){this.material.clear()}},{key:"createShaderMaterial",value:function(t){var n=Ia(),i=t.vertexShader,a=t.fragmentShader,o=[];if(!this.engine.supportWebGPU){var s="material-".concat(n);this.shaderModule.registerModule(s,{vs:t.vertexShader,fs:t.fragmentShader});var u=this.shaderModule.getModule(s);i=u.vs,a=u.fs,u.uniforms&&(o=Object.keys(u.uniforms).map(function(l){return{dirty:!0,name:l,data:u.uniforms[l]}}))}return this.material.create(n,AT(AT({vertexShaderGLSL:i,fragmentShaderGLSL:a},t),{},{uniforms:o}))}}]),r}(),ET),_T=Pt(Yf.prototype,"material",[yT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wT=Pt(Yf.prototype,"engine",[mT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ST=Pt(Yf.prototype,"shaderModule",[bT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yf))||xT);function zte(r){var e=$te();return function(){var n=Tr(r),i;if(e){var a=Tr(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return si(this,i)}}function $te(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var Hm;(function(r){r[r.Standard=0]="Standard"})(Hm||(Hm={}));var Vte=function(r){oi(t,r);var e=zte(t);function t(n){var i;return wt(this,t),i=e.call(this,n),i.strategy=Hm.Standard,i.visibilityPlaneMask=0,i.visible=!1,Object.assign(cn(i),n),i}return t}(Gs),Ym=function(){function r(e,t){wt(this,r),this.center=void 0,this.halfExtents=void 0,this.min=Nr(),this.max=Nr(),this.update(e,t)}return Bt(r,[{key:"update",value:function(t,n){this.center=t||Nr(),this.halfExtents=n||nr(.5,.5,.5),this.min=dg(this.min,this.center,this.halfExtents),this.max=Wa(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(t,n){Wa(this.center,n,t),Wl(this.center,this.center,.5),dg(this.halfExtents,n,t),Wl(this.halfExtents,this.halfExtents,.5),Xn(this.min,t),Xn(this.max,n)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(t){var n=this.center,i=n[0],a=n[1],o=n[2],s=this.halfExtents,u=s[0],l=s[1],f=s[2],c=i-u,h=i+u,d=a-l,v=a+l,p=o-f,g=o+f,y=t.center,m=y[0],b=y[1],x=y[2],_=t.halfExtents,S=_[0],E=_[1],C=_[2],M=m-S,w=m+S,T=b-E,I=b+E,k=x-C,O=x+C;M<c&&(c=M),w>h&&(h=w),T<d&&(d=T),I>v&&(v=I),k<p&&(p=k),O>g&&(g=O),n[0]=(c+h)*.5,n[1]=(d+v)*.5,n[2]=(p+g)*.5,s[0]=(h-c)*.5,s[1]=(v-d)*.5,s[2]=(g-p)*.5,this.min[0]=c,this.min[1]=d,this.min[2]=p,this.max[0]=h,this.max[1]=v,this.max[2]=g}},{key:"intersects",value:function(t){var n=this.getMax(),i=this.getMin(),a=t.getMax(),o=t.getMin();return i[0]<=a[0]&&n[0]>=o[0]&&i[1]<=a[1]&&n[1]>=o[1]&&i[2]<=a[2]&&n[2]>=o[2]}},{key:"containsPoint",value:function(t){var n=this.getMin(),i=this.getMax();return!(t[0]<n[0]||t[0]>i[0]||t[1]<n[1]||t[1]>i[1]||t[2]<n[2]||t[2]>i[2])}},{key:"getNegativeFarPoint",value:function(t){return t.pnVertexFlag===273?Xn(Nr(),this.min):t.pnVertexFlag===272?nr(this.min[0],this.min[1],this.max[2]):t.pnVertexFlag===257?nr(this.min[0],this.max[1],this.min[2]):t.pnVertexFlag===256?nr(this.min[0],this.max[1],this.max[2]):t.pnVertexFlag===17?nr(this.max[0],this.min[1],this.min[2]):t.pnVertexFlag===16?nr(this.max[0],this.min[1],this.max[2]):t.pnVertexFlag===1?nr(this.max[0],this.max[1],this.min[2]):nr(this.max[0],this.max[1],this.max[2])}},{key:"getPositiveFarPoint",value:function(t){return t.pnVertexFlag===273?Xn(Nr(),this.max):t.pnVertexFlag===272?nr(this.max[0],this.max[1],this.min[2]):t.pnVertexFlag===257?nr(this.max[0],this.min[1],this.max[2]):t.pnVertexFlag===256?nr(this.max[0],this.min[1],this.min[2]):t.pnVertexFlag===17?nr(this.min[0],this.max[1],this.max[2]):t.pnVertexFlag===16?nr(this.min[0],this.max[1],this.min[2]):t.pnVertexFlag===1?nr(this.min[0],this.min[1],this.max[2]):nr(this.min[0],this.min[1],this.min[2])}}]),r}();function Wte(r){var e=jte();return function(){var n=Tr(r),i;if(e){var a=Tr(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return si(this,i)}}function jte(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var Xte=function(r){oi(t,r);var e=Wte(t);function t(n){var i;return wt(this,t),i=e.call(this,n),i.material=void 0,i.geometry=void 0,i.aabb=new Ym,i.aabbDirty=!0,i.model=void 0,i.visible=!0,i.children=[],Object.assign(cn(i),n),i}return t}(Gs),Hte=function(){function r(e,t){wt(this,r),this.distance=void 0,this.normal=void 0,this.pnVertexFlag=void 0,this.distance=e||0,this.normal=t||nr(0,1,0),this.updatePNVertexFlag()}return Bt(r,[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(t){return bh(t,this.normal)-this.distance}},{key:"normalize",value:function(){var t=1/Ex(this.normal);Wl(this.normal,this.normal,t),this.distance*=t}},{key:"intersectsLine",value:function(t,n,i){var a=this.distanceToPoint(t),o=this.distanceToPoint(n),s=a/(a-o),u=s>=0&&s<=1;return u&&i&&hs(i,t,n,s),u}}]),r}(),Lo;(function(r){r[r.OUTSIDE=4294967295]="OUTSIDE",r[r.INSIDE=0]="INSIDE",r[r.INDETERMINATE=2147483647]="INDETERMINATE"})(Lo||(Lo={}));var Yte=function(){function r(e){if(wt(this,r),this.planes=[],e)this.planes=e;else for(var t=0;t<6;t++)this.planes.push(new Hte)}return Bt(r,[{key:"extractFromVPMatrix",value:function(t){var n=oh(t,16),i=n[0],a=n[1],o=n[2],s=n[3],u=n[4],l=n[5],f=n[6],c=n[7],h=n[8],d=n[9],v=n[10],p=n[11],g=n[12],y=n[13],m=n[14],b=n[15];Tu(this.planes[0].normal,s-i,c-u,p-h),this.planes[0].distance=-(b-g),Tu(this.planes[1].normal,s+i,c+u,p+h),this.planes[1].distance=-(b+g),Tu(this.planes[2].normal,s+a,c+l,p+d),this.planes[2].distance=-(b+y),Tu(this.planes[3].normal,s-a,c-l,p-d),this.planes[3].distance=-(b-y),Tu(this.planes[4].normal,s-o,c-f,p-v),this.planes[4].distance=-(b-m),Tu(this.planes[5].normal,s+o,c+f,p+v),this.planes[5].distance=-(b+m),this.planes.forEach(function(x){x.normalize(),x.updatePNVertexFlag()})}}]),r}();function qte(r,e){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[4],e[4]=r[5],e[5]=r[6],e[6]=r[8],e[7]=r[9],e[8]=r[10],e}function Kte(r){var e=oh(r,3),t=e[0],n=e[1],i=e[2],a=t+n*256+i*65536-1;return a}var TT,MT,IT,kT,DT,PT,NT,Us,LT,OT,RT,BT,GT,FT;function UT(r,e){var t;if(typeof Symbol=="undefined"||r[Symbol.iterator]==null){if(Array.isArray(r)||(t=Zte(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=r[Symbol.iterator]()},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function Zte(r,e){if(!!r){if(typeof r=="string")return zT(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return zT(r,e)}}function zT(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}var Qte=(TT=Ar(),MT=Nt(Le.MeshComponentManager),IT=Nt(Le.CullableComponentManager),kT=Nt(Le.GeometryComponentManager),DT=Nt(Le.HierarchyComponentManager),PT=Nt(Le.TransformComponentManager),TT(NT=(Us=(FT=function(){function r(){wt(this,r),Dt(this,"mesh",LT,this),Dt(this,"cullable",OT,this),Dt(this,"geometry",RT,this),Dt(this,"hierarchy",BT,this),Dt(this,"transform",GT,this),this.planes=void 0}return Bt(r,[{key:"setFrustumPlanes",value:function(t){this.planes=t}},{key:"execute",value:function(){var e=wr(bt.mark(function n(i){var a,o,s,u,l,f,c,h,d,v,p,g,y,m,b,x,_,S,E,C,M;return bt.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:a=UT(i);try{for(a.s();!(o=a.n()).done;){s=o.value,u=s.getScene(),l=s.getCamera(),f=UT(u.getEntities());try{for(f.s();!(c=f.n()).done;)h=c.value,d=this.mesh.getComponentByEntity(h),d&&(v=this.hierarchy.getComponentByEntity(h),p=this.cullable.getComponentByEntity(h),g=d.geometry,y=this.transform.getComponentByEntity(h),g&&g.aabb&&y&&d.aabbDirty&&(m=y.worldTransform,b=g.aabb,x=b.center,_=b.halfExtents,S=hg(Nr(),x,m),E=qte(m,Cu()),C=Mu(Nr(),_,E),d.aabb.update(S,C),d.aabbDirty=!1),p&&g&&(M=this.cullable.getComponentByEntity((v==null?void 0:v.parentID)||-1),p.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(d.aabb,(M==null?void 0:M.visibilityPlaneMask)||Lo.INDETERMINATE,this.planes||l.getFrustum().planes),p.visible=p.visibilityPlaneMask!==Lo.OUTSIDE))}catch(I){f.e(I)}finally{f.f()}}}catch(I){a.e(I)}finally{a.f()}case 2:case"end":return T.stop()}},n,this)}));function t(n){return e.apply(this,arguments)}return t}()},{key:"tearDown",value:function(){this.cullable.clear(),this.mesh.clear()}},{key:"computeVisibilityWithPlaneMask",value:function(t,n,i){if(n===Lo.OUTSIDE||n===Lo.INSIDE)return n;for(var a=Lo.INSIDE,o=0,s=i.length;o<s;++o){var u=o<31?1<<o:0;if(!(o<31&&(n&u)==0)){var l=i[o],f=l.normal,c=l.distance;if(bh(f,t.getNegativeFarPoint(i[o]))+c>0)return Lo.OUTSIDE;bh(f,t.getPositiveFarPoint(i[o]))+c>0&&(a|=u)}}return a}}]),r}(),FT),LT=Pt(Us.prototype,"mesh",[MT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OT=Pt(Us.prototype,"cullable",[IT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RT=Pt(Us.prototype,"geometry",[kT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BT=Pt(Us.prototype,"hierarchy",[DT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GT=Pt(Us.prototype,"transform",[PT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Us))||NT),$T,VT,WT,jT,XT,HT,YT,qT,KT,ZT,QT,JT,fa,eM,tM,rM,nM,iM,aM,oM,sM,uM,lM,fM;function ov(r,e){var t;if(typeof Symbol=="undefined"||r[Symbol.iterator]==null){if(Array.isArray(r)||(t=Jte(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=r[Symbol.iterator]()},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function Jte(r,e){if(!!r){if(typeof r=="string")return cM(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return cM(r,e)}}function cM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}var Qu=($T=Ar(),VT=Nt(Le.MeshComponentManager),WT=Nt(Le.GeometryComponentManager),jT=Nt(Le.MaterialComponentManager),XT=Nt(Le.CullableComponentManager),HT=Nt(Le.TransformComponentManager),YT=Nt(Le.HierarchyComponentManager),qT=Nt(Le.Systems),KT=ka(Le.FrameGraphSystem),ZT=Nt(Le.RenderEngine),QT=Nt(Le.ResourcePool),$T(JT=(fa=(fM=lM=function(){function r(){var e=this;wt(this,r),Dt(this,"mesh",eM,this),Dt(this,"geometry",tM,this),Dt(this,"material",rM,this),Dt(this,"cullable",nM,this),Dt(this,"transform",iM,this),Dt(this,"hierarchy",aM,this),Dt(this,"frameGraphSystem",oM,this),Dt(this,"engine",sM,this),Dt(this,"resourcePool",uM,this),this.modelCache={},this.setup=function(t,n,i){var a=t.createRenderTarget(n,"color buffer",{width:1,height:1,usage:ae.RENDER_ATTACHMENT|ae.SAMPLED|ae.COPY_SRC});i.data={output:n.write(t,a)}},this.execute=function(){var t=wr(bt.mark(function n(i,a,o){var s,u,l,f,c,h;return bt.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:s=i.getResourceNode(a.data.output),u=e.resourcePool.getOrCreateResource(s.resource),l=ov(o),v.prev=3,l.s();case 5:if((f=l.n()).done){v.next=11;break}return c=f.value,v.next=9,e.initView(c);case 9:v.next=5;break;case 11:v.next=16;break;case 13:v.prev=13,v.t0=v.catch(3),l.e(v.t0);case 16:return v.prev=16,l.f(),v.finish(16);case 19:h=e.engine.getCanvas(),u.resize({width:h.width,height:h.height}),e.engine.setScissor({enable:!1}),e.engine.clear({framebuffer:u,color:o[0].getClearColor(),depth:1}),e.engine.useFramebuffer(u,function(){var p=ov(o),g;try{for(p.s();!(g=p.n()).done;){var y=g.value;e.renderView(y)}}catch(m){p.e(m)}finally{p.f()}});case 24:case"end":return v.stop()}},n,null,[[3,13,16,19]])}));return function(n,i,a){return t.apply(this,arguments)}}()}return Bt(r,[{key:"renderView",value:function(t){var n=t.getScene(),i=t.getCamera(),a=i.getViewTransform(),o=cs(bi(),i.getPerspective(),a);i.getFrustum().extractFromVPMatrix(o);var s=t.getViewport(),u=s.x,l=s.y,f=s.width,c=s.height;this.engine.viewport({x:u,y:l,width:f,height:c});var h=ov(n.getEntities()),d;try{for(h.s();!(d=h.n()).done;){var v=d.value;this.renderMesh(v,{camera:i,view:t,viewMatrix:a})}}catch(p){h.e(p)}finally{h.f()}}},{key:"renderMesh",value:function(t,n){var i=n.camera,a=n.view,o=n.viewMatrix,s=this.mesh.getComponentByEntity(t);if(!(!s||!s.visible)){var u=s.material,l=s.geometry;if(!(!l||l.dirty||!u)){var f=this.transform.getComponentByEntity(t),c=cs(bi(),o,f.worldTransform),h=a.getViewport(),d=h.width,v=h.height;u.setUniform({projectionMatrix:i.getPerspective(),modelViewMatrix:c,modelMatrix:f.worldTransform,viewMatrix:o,cameraPosition:i.getPosition(),u_viewport:[d,v]}),s.model&&(s.model.draw({uniforms:u.uniforms.reduce(function(p,g){return p[g.name]=g.data,p},{})}),u.uniforms.forEach(function(p){p.dirty=!1}),u.dirty=!1)}}}},{key:"initMesh",value:function(){var e=wr(bt.mark(function n(i,a){var o,s,u,l,f,c,h,d;return bt.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(o=this.mesh.getComponentByEntity(i),o){p.next=3;break}return p.abrupt("return");case 3:if(s=o.material,u=o.geometry,!(!u||u.dirty||!s)){p.next=7;break}return p.abrupt("return");case 7:if(o.model){p.next=24;break}if(l="m-".concat(s.entity,"-g-").concat(u.entity),!this.modelCache[l]){p.next=12;break}return o.model=this.modelCache[l],p.abrupt("return");case 12:return s.setUniform({projectionMatrix:1,modelViewMatrix:1,modelMatrix:1,viewMatrix:1,cameraPosition:1,u_viewport:1}),f=this.engine,c=f.createModel,h=f.createAttribute,d={vs:s.vertexShaderGLSL,fs:s.fragmentShaderGLSL,defines:s.defines,attributes:u.attributes.reduce(function(g,y){return y.data&&y.buffer&&(g[y.name]=h({buffer:y.buffer,attributes:y.attributes,arrayStride:y.arrayStride,stepMode:y.stepMode,divisor:y.stepMode==="vertex"?0:1})),g},{}),uniforms:s.uniforms.reduce(function(g,y){return g[y.name]=y.data,g},{}),scissor:{enable:!0,box:function(){return a.getViewport()}}},s.cull&&(d.cull=s.cull),s.depth&&(d.depth=s.depth),s.blend&&(d.blend=s.blend),u.indicesBuffer&&(d.elements=u.indicesBuffer),u.maxInstancedCount&&(d.instances=u.maxInstancedCount,d.count=u.vertexCount||3),p.next=22,c(d);case 22:o.model=p.sent,this.modelCache[l]=o.model;case 24:case"end":return p.stop()}},n,this)}));function t(n,i){return e.apply(this,arguments)}return t}()},{key:"initView",value:function(){var e=wr(bt.mark(function n(i){var a,o,s,u;return bt.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:a=i.getScene(),o=ov(a.getEntities()),f.prev=2,o.s();case 4:if((s=o.n()).done){f.next=10;break}return u=s.value,f.next=8,this.initMesh(u,i);case 8:f.next=4;break;case 10:f.next=15;break;case 12:f.prev=12,f.t0=f.catch(2),o.e(f.t0);case 15:return f.prev=15,o.f(),f.finish(15);case 18:case"end":return f.stop()}},n,this,[[2,12,15,18]])}));function t(n){return e.apply(this,arguments)}return t}()}]),r}(),lM.IDENTIFIER="Render Pass",fM),eM=Pt(fa.prototype,"mesh",[VT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tM=Pt(fa.prototype,"geometry",[WT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rM=Pt(fa.prototype,"material",[jT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nM=Pt(fa.prototype,"cullable",[XT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iM=Pt(fa.prototype,"transform",[HT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aM=Pt(fa.prototype,"hierarchy",[YT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oM=Pt(fa.prototype,"frameGraphSystem",[qT,KT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sM=Pt(fa.prototype,"engine",[ZT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uM=Pt(fa.prototype,"resourcePool",[QT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fa))||JT),hM,dM,vM,pM,gM,yM,Ju,mM,bM,xM,_M,wM,SM;function qm(r,e){var t;if(typeof Symbol=="undefined"||r[Symbol.iterator]==null){if(Array.isArray(r)||(t=ere(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=r[Symbol.iterator]()},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function ere(r,e){if(!!r){if(typeof r=="string")return EM(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return EM(r,e)}}function EM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}var Km={NONE:0,ENCODE:1,HIGHLIGHT:2},Zm=(hM=Ar(),dM=Nt(Le.RenderEngine),vM=Nt(Le.ResourcePool),pM=Nt(Le.RenderPassFactory),gM=Nt(Le.MeshComponentManager),hM(yM=(Ju=(SM=wM=function(){function r(){var e=this;wt(this,r),Dt(this,"engine",mM,this),Dt(this,"resourcePool",bM,this),Dt(this,"renderPassFactory",xM,this),Dt(this,"mesh",_M,this),this.pickingFBO=void 0,this.views=void 0,this.highlightEnabled=!0,this.highlightColor=[255,0,0,255],this.alreadyInRendering=!1,this.setup=function(t,n,i){var a=t.createRenderTarget(n,"picking fbo",{width:1,height:1});i.data={output:n.write(t,a)},n.hasSideEffect=!0},this.execute=function(){var t=wr(bt.mark(function n(i,a,o){var s,u,l;return bt.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(e.views=o,!e.alreadyInRendering){c.next=3;break}return c.abrupt("return");case 3:s=qm(o);try{for(l=function(){var d=u.value,v=d.getViewport(),p=v.width,g=v.height;e.alreadyInRendering=!0;var y=i.getResourceNode(a.data.output);e.pickingFBO=e.resourcePool.getOrCreateResource(y.resource),e.pickingFBO.resize({width:p,height:g}),e.engine.useFramebuffer(e.pickingFBO,function(){e.engine.clear({framebuffer:e.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var m=e.renderPassFactory(Qu.IDENTIFIER),b=[],x=d.getScene(),_=qm(x.getEntities()),S;try{for(_.s();!(S=_.n()).done;){var E=S.value,C=e.mesh.getComponentByEntity(E),M=C.material;M.setUniform("u_PickingStage",Km.ENCODE),b.push(C)}}catch(w){_.e(w)}finally{_.f()}m.renderView(d),b.forEach(function(w){var T=w.material;T.setUniform("u_PickingStage",Km.HIGHLIGHT)}),e.alreadyInRendering=!1})},s.s();!(u=s.n()).done;)l()}catch(h){s.e(h)}finally{s.f()}case 5:case"end":return c.stop()}},n)}));return function(n,i,a){return t.apply(this,arguments)}}(),this.pick=function(t,n){var i=t.x,a=t.y,o=e.engine,s=o.readPixels,u=o.useFramebuffer,l=n.getViewport(),f=l.width,c=l.height,h=i*window.devicePixelRatio,d=a*window.devicePixelRatio;if(!(h>f||h<0||d>c||d<0)){var v,p;return u(e.pickingFBO,function(){v=s({x:Math.round(h),y:Math.round(c-(a+1)*window.devicePixelRatio),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:e.pickingFBO}),(v[0]!==0||v[1]!==0||v[2]!==0)&&(p=Kte(v),e.highlightEnabled&&e.highlightPickedFeature(v,n))}),p}}}return Bt(r,[{key:"enableHighlight",value:function(t){this.highlightEnabled=t}},{key:"setHighlightColor",value:function(t){this.highlightColor=t}},{key:"highlightPickedFeature",value:function(t,n){if(t){var i=qm(n.getScene().getEntities()),a;try{for(i.s();!(a=i.n()).done;){var o=a.value,s=this.mesh.getComponentByEntity(o),u=s.material;u.setUniform("u_PickingStage",Km.HIGHLIGHT),u.setUniform("u_PickingColor",[t[0],t[1],t[2]]),u.setUniform("u_HighlightColor",this.highlightColor)}}catch(l){i.e(l)}finally{i.f()}}}}]),r}(),wM.IDENTIFIER="PixelPicking Pass",SM),mM=Pt(Ju.prototype,"engine",[dM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bM=Pt(Ju.prototype,"resourcePool",[vM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xM=Pt(Ju.prototype,"renderPassFactory",[pM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_M=Pt(Ju.prototype,"mesh",[gM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ju))||yM),CM,AM,TM,MM,sv,IM,kM,DM,PM,tre=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,rre=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,nre=`layout(set = 0, binding = 0) uniform sampler u_TextureSampler;
layout(set = 0, binding = 1) uniform texture2D u_Texture;

layout(location = 0) in vec2 v_UV;
layout(location = 0) out vec4 outColor;

void main() {
  outColor = texture(sampler2D(u_Texture, u_TextureSampler), v_UV);
}`,ire=`layout(location = 0) in vec2 a_Position;
layout(location = 0) out vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,uv=(CM=Ar(),AM=Nt(Le.RenderEngine),TM=Nt(Le.ResourcePool),CM(MM=(sv=(PM=DM=function r(){var e=this;wt(this,r),Dt(this,"engine",IM,this),Dt(this,"resourcePool",kM,this),this.model=void 0,this.setup=function(t,n,i){var a=t.getPass(Qu.IDENTIFIER);if(a){var o=t.createRenderTarget(n,"render to screen",{width:1,height:1});i.data={input:n.read(a.data.output),output:n.write(t,o)}}},this.execute=function(){var t=wr(bt.mark(function n(i,a){var o,s,u,l,f,c,h;return bt.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(o=e.engine,s=o.createModel,u=o.createAttribute,l=o.createBuffer,e.model){v.next=6;break}return v.next=4,s({vs:e.engine.supportWebGPU?ire:rre,fs:e.engine.supportWebGPU?nre:tre,attributes:{a_Position:u({buffer:l({data:[-4,-4,4,-4,0,4],type:ae.FLOAT}),size:2,arrayStride:2*4,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]})},uniforms:{u_Texture:null},depth:{enable:!1},count:3,blend:{enable:!0}});case 4:f=v.sent,e.model=f;case 6:c=i.getResourceNode(a.data.input),h=e.resourcePool.getOrCreateResource(c.resource),e.engine.useFramebuffer(null,function(){e.engine.clear({framebuffer:null,color:[0,0,0,0],depth:1,stencil:0}),e.model.draw({uniforms:{u_Texture:h}})});case 9:case"end":return v.stop()}},n)}));return function(n,i){return t.apply(this,arguments)}}(),this.tearDown=function(){e.model=void 0}},DM.IDENTIFIER="Copy Pass",PM),IM=Pt(sv.prototype,"engine",[AM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kM=Pt(sv.prototype,"resourcePool",[TM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sv))||MM),NM,LM,OM,RM,BM,GM,FM,el,UM,zM,$M,VM,WM,are=(NM=Ar(),LM=Nt(Le.Systems),OM=ka(Le.FrameGraphSystem),RM=Nt(Le.RenderPassFactory),BM=Nt(Le.ConfigService),GM=Nt(Le.ResourcePool),NM(FM=(el=(WM=function(){function r(){wt(this,r),Dt(this,"frameGraphSystem",UM,this),Dt(this,"renderPassFactory",zM,this),Dt(this,"configService",$M,this),Dt(this,"resourcePool",VM,this)}return Bt(r,[{key:"execute",value:function(){var e=wr(bt.mark(function n(i){var a,o,s,u,l,f,c,h;return bt.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:a=this.renderPassFactory(Qu.IDENTIFIER),o=a.setup,s=a.execute,this.frameGraphSystem.addPass(Qu.IDENTIFIER,o,s),u=this.renderPassFactory(uv.IDENTIFIER),l=u.setup,f=u.execute,c=u.tearDown,h=this.frameGraphSystem.addPass(uv.IDENTIFIER,l,f,c),this.frameGraphSystem.present(h.data.output);case 5:case"end":return v.stop()}},n,this)}));function t(n){return e.apply(this,arguments)}return t}()},{key:"tearDown",value:function(){this.resourcePool.clean()}},{key:"pick",value:function(t,n){var i=this.renderPassFactory(Zm.IDENTIFIER);return i.pick(t,n)}}]),r}(),WM),UM=Pt(el.prototype,"frameGraphSystem",[LM,OM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zM=Pt(el.prototype,"renderPassFactory",[RM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$M=Pt(el.prototype,"configService",[BM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VM=Pt(el.prototype,"resourcePool",[GM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),el))||FM);function ore(r){var e=sre();return function(){var n=Tr(r),i;if(e){var a=Tr(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return si(this,i)}}function sre(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var ure=function(r){oi(t,r);var e=ore(t);function t(n){var i;return wt(this,t),i=e.call(this,n),i.parentID=void 0,Object.assign(cn(i),n),i}return t}(Gs),jM,XM,HM,YM,qM,qf,KM,ZM,QM,JM,lre=(jM=Ar(),XM=Nt(Le.HierarchyComponentManager),HM=Nt(Le.TransformComponentManager),YM=Nt(Le.MeshComponentManager),jM(qM=(qf=(JM=function(){function r(){wt(this,r),Dt(this,"hierarchy",KM,this),Dt(this,"transform",ZM,this),Dt(this,"mesh",QM,this)}return Bt(r,[{key:"execute",value:function(){var e=wr(bt.mark(function n(){return bt.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:this.runTransformUpdateSystem(),this.runHierarchyUpdateSystem();case 2:case"end":return a.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"tearDown",value:function(){this.hierarchy.clear(),this.transform.clear()}},{key:"getHierarchyComponentManager",value:function(){return this.hierarchy}},{key:"getTransformComponentManager",value:function(){return this.transform}},{key:"runTransformUpdateSystem",value:function(){var t=this;this.transform.forEach(function(n,i){(i.isDirty()||i.isLocalDirty())&&(t.setMeshAABBDirty(t.mesh.getComponentByEntity(n)),i.updateTransform())})}},{key:"runHierarchyUpdateSystem",value:function(){var t=this;this.hierarchy.forEach(function(n,i){var a=t.transform.getComponentByEntity(n),o=t.transform.getComponentByEntity(i.parentID);a!==null&&o!==null&&a.updateTransformWithParent(o)})}},{key:"attach",value:function(t,n,i){this.hierarchy.contains(t)&&this.detach(t),this.hierarchy.create(t,{parentID:n});var a=this.mesh.getComponentByEntity(n);if(this.setMeshAABBDirty(a),a&&a.children.indexOf(t)===-1&&a.children.push(t),this.hierarchy.getCount()>1)for(var o=this.hierarchy.getCount()-1;o>0;--o)for(var s=this.hierarchy.getEntity(o),u=0;u<o;++u){var l=this.hierarchy.getComponent(u);if(l.parentID===s){this.hierarchy.moveItem(o,u),++o;break}}this.hierarchy.getComponentByEntity(t);var f=this.transform.getComponentByEntity(n);f===null&&(f=this.transform.create(n));var c=this.transform.getComponentByEntity(t);c===null&&(c=this.transform.create(t),f=this.transform.getComponentByEntity(n)),c.parent=f,!i&&f&&(c.matrixTransform(yh(bi(),f.worldTransform)),c.updateTransform()),f&&c.updateTransformWithParent(f)}},{key:"detach",value:function(t){var n=this.hierarchy.getComponentByEntity(t);if(n!==null){var i=this.transform.getComponentByEntity(t);i!==null&&(i.parent=null,i.applyTransform()),this.hierarchy.removeKeepSorted(t);var a=this.mesh.getComponentByEntity(n.parentID);if(a){var o=a.children.indexOf(t);a.children.splice(o,1)}this.setMeshAABBDirty(a)}}},{key:"detachChildren",value:function(t){var n=this.mesh.getComponentByEntity(t);n&&(n.children=[]);for(var i=0;i<this.hierarchy.getCount();){var a;if(((a=this.hierarchy.getComponent(i))===null||a===void 0?void 0:a.parentID)===t){var o=this.hierarchy.getEntity(i);this.detach(o)}else++i}}},{key:"setMeshAABBDirty",value:function(t){t&&(t.aabbDirty=!0)}}]),r}(),JM),KM=Pt(qf.prototype,"hierarchy",[XM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZM=Pt(qf.prototype,"transform",[HM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QM=Pt(qf.prototype,"mesh",[YM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qf))||qM);function fre(r){var e=cre();return function(){var n=Tr(r),i;if(e){var a=Tr(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return si(this,i)}}function cre(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var eI=function(r){oi(t,r);var e=fre(t);function t(n){var i;return wt(this,t),i=e.call(this,n),i.dirtyFlag=void 0,i.localDirtyFlag=void 0,i.parent=null,i.localPosition=nr(0,0,0),i.localRotation=pg(0,0,0,1),i.localScale=nr(1,1,1),i.localTransform=bi(),i.position=nr(0,0,0),i.rotation=pg(0,0,0,1),i.scaling=nr(1,1,1),i.worldTransform=bi(),i.matrixTransform=function(){var a=bi();return function(o){cs(a,i.getLocalTransform(),o),Au(i.localScale,a),$l(i.localPosition,a),Vl(i.localRotation,a)}}(),i.rotateRollPitchYaw=function(){var a=Dn(),o=Dn(),s=Dn();return function(u,l,f){i.setDirty(),vg(a,u,0,0),vg(o,0,l,0),vg(s,0,0,f),Fi(i.localRotation,a,i.localRotation),Fi(i.localRotation,i.localRotation,o),Fi(i.localRotation,s,i.localRotation),Iu(i.localRotation,i.localRotation)}}(),i.lerp=function(){var a=Nr(),o=Dn(),s=Nr(),u=Nr(),l=Dn(),f=Nr();return function(c,h,d){i.setDirty(),Au(a,c.worldTransform),$l(s,c.worldTransform),Vl(o,c.worldTransform),Au(u,h.worldTransform),$l(f,h.worldTransform),Vl(l,h.worldTransform),hs(i.localScale,a,u,d),xh(i.localRotation,o,l,d),hs(i.localPosition,s,f,d)}}(),i.translate=function(){var a=Nr();return function(o){return Wa(a,i.getPosition(),o),i.setPosition(a),i.setDirty(!0),cn(i)}}(),i.translateLocal=function(){return function(a){return r5(a,a,i.localRotation),Wa(i.localPosition,i.localPosition,a),i.setLocalDirty(!0),cn(i)}}(),i.setPosition=function(){var a=bi();return function(o){return i.position=o,i.setLocalDirty(!0),i.parent===null?Xn(i.localPosition,o):(lg(a,i.parent.worldTransform),yh(a,a),hg(i.localPosition,o,a)),cn(i)}}(),i.rotate=function(){var a=Dn();return function(o){if(i.parent===null)Fi(i.localRotation,i.localRotation,o),Iu(i.localRotation,i.localRotation);else{var s=i.getRotation(),u=i.parent.getRotation();Yl(a,u),Ax(a,a),Fi(a,a,o),Fi(i.localRotation,o,s),Iu(i.localRotation,i.localRotation)}return i.setLocalDirty(),cn(i)}}(),i.rotateLocal=function(){return function(a){return Fi(i.localRotation,i.localRotation,a),Iu(i.localRotation,i.localRotation),i.setLocalDirty(!0),cn(i)}}(),i.setRotation=function(){var a=Dn();return function(o){return i.parent===null?Yl(i.localRotation,o):(Yl(a,i.parent.getRotation()),Ax(a,a),Yl(i.localRotation,a),o5(i.localRotation,i.localRotation,o)),i.setLocalDirty(!0),cn(i)}}(),i}return Bt(t,[{key:"setLocalPosition",value:function(i){Xn(this.localPosition,i),this.setLocalDirty(!0)}},{key:"setLocalScale",value:function(i){Xn(this.localScale,i),this.setLocalDirty(!0)}},{key:"setLocalRotation",value:function(i){return Yl(this.localRotation,i),this.setLocalDirty(!0),this}},{key:"isDirty",value:function(){return this.dirtyFlag}},{key:"setDirty",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i?this.dirtyFlag|=t.DIRTY:this.dirtyFlag&=~t.DIRTY}},{key:"isLocalDirty",value:function(){return this.localDirtyFlag}},{key:"setLocalDirty",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i?(this.localDirtyFlag|=t.DIRTY,this.setDirty(!0)):this.localDirtyFlag&=~t.DIRTY}},{key:"updateTransform",value:function(){this.isLocalDirty()&&this.getLocalTransform(),this.isDirty()&&this.parent===null&&(lg(this.worldTransform,this.getLocalTransform()),this.setDirty(!1))}},{key:"updateTransformWithParent",value:function(i){cs(this.worldTransform,i.worldTransform,this.getLocalTransform())}},{key:"applyTransform",value:function(){this.setDirty(),Au(this.localScale,this.worldTransform),$l(this.localPosition,this.worldTransform),Vl(this.localRotation,this.worldTransform)}},{key:"clearTransform",value:function(){this.setDirty(),this.localPosition=nr(0,0,0),this.localRotation=pg(0,0,0,1),this.localScale=nr(1,1,1)}},{key:"scaleLocal",value:function(i){return this.setLocalDirty(),e5(this.localScale,this.localScale,i),this}},{key:"getLocalPosition",value:function(){return this.localPosition}},{key:"getLocalRotation",value:function(){return this.localRotation}},{key:"getLocalScale",value:function(){return this.localScale}},{key:"getLocalTransform",value:function(){return this.localDirtyFlag&&(YB(this.localTransform,this.localRotation,this.localPosition,this.localScale),this.setLocalDirty(!1)),this.localTransform}},{key:"getWorldTransform",value:function(){return!this.isLocalDirty()&&!this.isDirty()?this.worldTransform:(this.parent&&this.parent.getWorldTransform(),this.updateTransform(),this.worldTransform)}},{key:"getPosition",value:function(){return $l(this.position,this.worldTransform),this.position}},{key:"getRotation",value:function(){return Vl(this.rotation,this.worldTransform),this.rotation}},{key:"getScale",value:function(){return Au(this.scaling,this.worldTransform),this.scaling}}]),t}(Gs);eI.DIRTY=1<<0;var tI,rI,nI,Qm,iI,aI,hre=(tI=Ar(),rI=Nt(Le.RenderEngine),tI(nI=(Qm=(aI=function(){function r(){wt(this,r),Dt(this,"engine",iI,this),this.resourcePool={}}return Bt(r,[{key:"getOrCreateResource",value:function(t){if(!this.resourcePool[t.name]){var n=t.descriptor,i=n.width,a=n.height,o=n.usage;this.resourcePool[t.name]=this.engine.createFramebuffer({color:this.engine.createTexture2D({width:i,height:a,wrapS:ae.CLAMP_TO_EDGE,wrapT:ae.CLAMP_TO_EDGE,usage:o})})}return this.resourcePool[t.name]}},{key:"clean",value:function(){this.resourcePool={}}}]),r}(),aI),iI=Pt(Qm.prototype,"engine",[rI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qm))||nI);function dre(r){var e=vre();return function(){var n=Tr(r),i;if(e){var a=Tr(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return si(this,i)}}function vre(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var pre=function(r){oi(t,r);var e=dre(t);function t(n){var i;return wt(this,t),i=e.call(this,n),i.name=void 0,i.name=n.name||"",i}return t}(Gs),oI,sI,uI,gre=(oI=Ar(),oI(sI=(uI=function(){function r(){wt(this,r),this.config=void 0}return Bt(r,[{key:"get",value:function(){return this.config}},{key:"set",value:function(t){this.config=t}}]),r}(),uI))||sI),lI,fI,cI;(function(r){r.PANSTART="PANSTART",r.PANEND="PANEND",r.PANMOVE="PANMOVE",r.PINCH="PINCH",r.KEYDOWN="KEYDOWN",r.KEYUP="KEYUP",r.HOVER="HOVER"})(cI||(cI={}));var yre=(lI=Ar(),lI(fI=function(){function r(){wt(this,r)}return Bt(r,[{key:"listen",value:function(t){}},{key:"on",value:function(t,n){}},{key:"connect",value:function(){}},{key:"disconnect",value:function(){}},{key:"destroy",value:function(){}}]),r}())||fI);function mre(r){var e=0;switch(r){case"vec2":case"ivec2":e=2;break;case"vec3":case"ivec3":e=3;break;case"vec4":case"ivec4":case"mat2":e=4;break;case"mat3":e=9;break;case"mat4":e=16;break}return e}var bre=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function hI(r){var e={};return r=r.replace(bre,function(t,n,i){var a=i.split(":"),o=a[0].trim(),s="";switch(a.length>1&&(s=a[1].trim()),n){case"bool":s=s==="true";break;case"float":case"int":s=Number(s);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":s?s=s.replace("[","").replace("]","").split(",").reduce(function(u,l){return u.push(Number(l.trim())),u},[]):s=new Array(mre(n)).fill(0);break}return e[o]=s,"uniform ".concat(n," ").concat(o,`;
`)}),{content:r,uniforms:e}}function xre(r){return r.filter(function(e,t,n){return n.indexOf(e)===t})}var dI,vI,pI;function gI(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function Kf(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?gI(Object(t),!0).forEach(function(n){Ce(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):gI(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var _re=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;

#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color) {
  bool selected = bool(v_PickingResult.a);

  if (selected) {
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(resultRGB, color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  return filterPickingColor(filterHighlightColor(color));
}
`,wre=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;

#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  // compares only in highlight stage
  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}`,Sre=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}`,Ere=/precision\s+(high|low|medium)p\s+float/,Cre=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,Are=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,Tre=(dI=Ar(),dI(vI=(pI=function(){function r(){wt(this,r),this.moduleCache={},this.rawContentCache={}}return Bt(r,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("picking",{vs:wre,fs:_re}),this.registerModule("sdf2d",{vs:"",fs:Sre})}},{key:"registerModule",value:function(t,n){if(!this.rawContentCache[t]){var i=n.vs,a=i===void 0?"":i,o=n.fs,s=o===void 0?"":o,u=n.uniforms,l=hI(a),f=l.content,c=l.uniforms,h=hI(s),d=h.content,v=h.uniforms;this.rawContentCache[t]={fs:d,uniforms:Kf(Kf(Kf({},c),v),u),vs:f}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(t){var n=this;if(this.moduleCache[t])return this.moduleCache[t];var i=this.rawContentCache[t].vs||"",a=this.rawContentCache[t].fs||"",o=this.processModule(i,[],"vs"),s=o.content,u=o.includeList,l=this.processModule(a,[],"fs"),f=l.content,c=l.includeList,h=f,d=xre(u.concat(c).concat(t)).reduce(function(v,p){return Kf(Kf({},v),n.rawContentCache[p].uniforms)},{});return Ere.test(f)||(h=Cre+f),this.moduleCache[t]={fs:h.trim(),uniforms:d,vs:s.trim()},this.moduleCache[t]}},{key:"processModule",value:function(t,n,i){var a=this,o=t.replace(Are,function(s,u){var l=u.split(" "),f=l[0].replace(/"/g,"");if(n.indexOf(f)>-1)return"";var c=a.rawContentCache[f][i];n.push(f);var h=a.processModule(c||"",n,i),d=h.content;return d});return{content:o,includeList:n}}}]),r}(),pI))||vI),Qa=new KA;Qa.bind(Le.ShaderModuleService).to(Tre).inSingletonScope();Qa.bind(Le.NameComponentManager).toConstantValue(new Fs(pre));Qa.bind(Le.HierarchyComponentManager).toConstantValue(new Fs(ure));Qa.bind(Le.TransformComponentManager).toConstantValue(new Fs(eI));Qa.bind(Le.MeshComponentManager).toConstantValue(new Fs(Xte));Qa.bind(Le.CullableComponentManager).toConstantValue(new Fs(Vte));Qa.bind(Le.GeometryComponentManager).toConstantValue(new Fs(Ote));Qa.bind(Le.MaterialComponentManager).toConstantValue(new Fs(Fte));function Mre(){var r=new KA;return r.parent=Qa,r.bind(Le.Systems).to(lre).inSingletonScope().whenTargetNamed(Le.SceneGraphSystem),r.bind(Le.Systems).to(rte).inSingletonScope().whenTargetNamed(Le.FrameGraphSystem),r.bind(Le.Systems).to(Qte).inSingletonScope().whenTargetNamed(Le.MeshSystem),r.bind(Le.Systems).to(Rte).inSingletonScope().whenTargetNamed(Le.GeometrySystem),r.bind(Le.Systems).to(Ute).inSingletonScope().whenTargetNamed(Le.MaterialSystem),r.bind(Le.Systems).to(are).inSingletonScope().whenTargetNamed(Le.RendererSystem),r.bind(Le.ResourcePool).to(hre).inSingletonScope(),r.bind(Le.ConfigService).to(gre).inSingletonScope(),r.bind(Le.InteractorService).to(yre).inSingletonScope(),r.bind(Le.RenderPass).to(Qu).inSingletonScope().whenTargetNamed(Qu.IDENTIFIER),r.bind(Le.RenderPass).to(uv).inSingletonScope().whenTargetNamed(uv.IDENTIFIER),r.bind(Le.RenderPass).to(Zm).inSingletonScope().whenTargetNamed(Zm.IDENTIFIER),r.bind(Le.RenderPassFactory).toFactory(function(e){return function(t){return e.container.getNamed(Le.RenderPass,t)}}),r}function Jm(r){for(var e=new Ym,t=nr(r[0],r[1],r[2]),n=nr(r[0],r[1],r[2]),i=3;i<r.length;){var a=r[i++],o=r[i++],s=r[i++];a<t[0]&&(t[0]=a),o<t[1]&&(t[1]=o),s<t[2]&&(t[2]=s),a>n[0]&&(n[0]=a),o>n[1]&&(n[1]=o),s>n[2]&&(n[2]=s)}return e.setMinMax(t,n),e}var _i=typeof navigator!="undefined"&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent);Nr();Nr();Nr();Nr();Nr();Nr();var yI;(function(r){r.Normal="normal",r.PostProcessing="post-processing"})(yI||(yI={}));var zs;(function(r){r.Void="Void",r.Boolean="Boolean",r.Float="Float",r.Uint32="Uint32",r.Int32="Int32",r.Vector="Vector",r.Vector2Float="vec2<f32>",r.Vector3Float="vec3<f32>",r.Vector4Float="vec4<f32>",r.Vector2Boolean="vec2<bool>",r.Vector3Boolean="vec3<bool>",r.Vector4Boolean="vec4<bool>",r.Vector2Uint="vec2<u32>",r.Vector3Uint="vec3<u32>",r.Vector4Uint="vec4<u32>",r.Vector2Int="vec2<i32>",r.Vector3Int="vec3<i32>",r.Vector4Int="vec4<i32>",r.Matrix="Matrix",r.Matrix3x3Float="mat3x3<f32>",r.Matrix4x4Float="mat4x4<i32>",r.Struct="Struct",r.FloatArray="Float[]",r.Vector4FloatArray="vec4<f32>[]"})(zs||(zs={}));var mI;(function(r){r.Program="Program",r.Identifier="Identifier",r.VariableDeclaration="VariableDeclaration",r.BlockStatement="BlockStatement",r.ReturnStatement="ReturnStatement",r.FunctionDeclaration="FunctionDeclaration",r.VariableDeclarator="VariableDeclarator",r.AssignmentExpression="AssignmentExpression",r.LogicalExpression="LogicalExpression",r.BinaryExpression="BinaryExpression",r.ArrayExpression="ArrayExpression",r.UnaryExpression="UnaryExpression",r.UpdateExpression="UpdateExpression",r.FunctionExpression="FunctionExpression",r.MemberExpression="MemberExpression",r.ConditionalExpression="ConditionalExpression",r.ExpressionStatement="ExpressionStatement",r.CallExpression="CallExpression",r.NumThreadStatement="NumThreadStatement",r.StorageStatement="StorageStatement",r.DoWhileStatement="DoWhileStatement",r.WhileStatement="WhileStatement",r.ForStatement="ForStatement",r.BreakStatement="BreakStatement",r.ContinueStatement="ContinueStatement",r.IfStatement="IfStatement",r.ImportedFunctionStatement="ImportedFunctionStatement"})(mI||(mI={}));var Oo;(function(r){r.Input="Input",r.Output="Output",r.Uniform="Uniform",r.Workgroup="Workgroup",r.UniformConstant="UniformConstant",r.Image="Image",r.StorageBuffer="StorageBuffer",r.Private="Private",r.Function="Function"})(Oo||(Oo={}));var Zf;(function(r){r.GLSL100="GLSL100",r.GLSL450="GLSL450",r.WGSL="WGSL"})(Zf||(Zf={}));var Ire="__DefineValuePlaceholder__";function e0(r){return typeof r=="number"}function Ja(r){return r===void 0?0:r>360||r<-360?r%360:r}function $s(r,e,t){return e0(r)?nr(r,e,t):r.length===3?Va(r):nr(r[0],r[1],r[2])}var bI=function(){function r(e,t){wt(this,r),this.name=void 0,this.matrix=void 0,this.right=void 0,this.up=void 0,this.forward=void 0,this.position=void 0,this.focalPoint=void 0,this.distanceVector=void 0,this.distance=void 0,this.dollyingStep=void 0,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.name=e,this.matrix=jB(t.matrix),this.right=Va(t.right),this.up=Va(t.up),this.forward=Va(t.forward),this.position=Va(t.position),this.focalPoint=Va(t.focalPoint),this.distanceVector=Va(t.distanceVector),this.azimuth=t.azimuth,this.elevation=t.elevation,this.roll=t.roll,this.relAzimuth=t.relAzimuth,this.relElevation=t.relElevation,this.relRoll=t.relRoll,this.dollyingStep=t.dollyingStep,this.distance=t.distance}return Bt(r,[{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getRoll",value:function(){return this.roll}},{key:"retrieve",value:function(t){t.matrix=lg(t.matrix,this.matrix),t.right=Xn(t.right,this.right),t.up=Xn(t.up,this.up),t.forward=Xn(t.forward,this.forward),t.position=Xn(t.position,this.position),t.focalPoint=Xn(t.focalPoint,this.focalPoint),t.distanceVector=Xn(t.distanceVector,this.distanceVector),t.azimuth=this.azimuth,t.elevation=this.elevation,t.roll=this.roll,t.relAzimuth=this.relAzimuth,t.relElevation=this.relElevation,t.relRoll=this.relRoll,t.dollyingStep=this.dollyingStep,t.distance=this.distance}}]),r}(),xI,_I,wI,t0,SI,EI,CI,Fr;(function(r){r.ORBITING="ORBITING",r.EXPLORING="EXPLORING",r.TRACKING="TRACKING"})(Fr||(Fr={}));var lv;(function(r){r.DEFAULT="DEFAULT",r.ROTATIONAL="ROTATIONAL",r.TRANSLATIONAL="TRANSLATIONAL",r.CINEMATIC="CINEMATIC"})(lv||(lv={}));var Vs;(function(r){r.ORTHOGRAPHIC="ORTHOGRAPHIC",r.PERSPECTIVE="PERSPECTIVE"})(Vs||(Vs={}));var eo=Math.PI/180,Ro=180/Math.PI,AI=(xI=Ar(),_I=Nt(Le.InteractorService),xI(wI=(t0=(CI=EI=function(){function r(){wt(this,r),this.matrix=bi(),this.right=nr(1,0,0),this.up=nr(0,1,0),this.forward=nr(0,0,1),this.position=nr(0,0,1),this.focalPoint=nr(0,0,0),this.distanceVector=nr(0,0,0),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.rotateWorld=!1,Dt(this,"interactor",SI,this),this.fov=30,this.near=.1,this.far=1e4,this.aspect=1,this.left=void 0,this.rright=void 0,this.top=void 0,this.bottom=void 0,this.zoom=1,this.perspective=bi(),this.view=void 0,this.following=void 0,this.type=Fr.EXPLORING,this.trackingMode=lv.DEFAULT,this.projectionMode=Vs.PERSPECTIVE,this.frustum=new Yte,this.landmarks=[],this.landmarkAnimationID=void 0}return Bt(r,[{key:"clone",value:function(){var t=new r;return t.setType(this.type,void 0),t.interactor=this.interactor,t}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.perspective}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"setType",value:function(t,n){return this.type=t,this.type===Fr.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===Fr.TRACKING&&n!==void 0&&this.setTrackingMode(n),this}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this}},{key:"setTrackingMode",value:function(t){if(this.type!==Fr.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this}},{key:"setWorldRotation",value:function(t){this.rotateWorld=t,this._getAngles()}},{key:"getViewTransform",value:function(){return yh(bi(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this}},{key:"setViewOffset",value:function(t,n,i,a,o,s){return this.aspect=t/n,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=a,this.view.width=o,this.view.height=s,this.projectionMode===Vs.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===Vs.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setPerspective",value:function(t,n,i,a){return this.projectionMode=Vs.PERSPECTIVE,this.fov=i,this.near=t,this.far=n,this.aspect=a,KB(this.perspective,this.fov*eo,this.aspect,this.near,this.far),this}},{key:"setOrthographic",value:function(t,n,i,a,o,s){this.projectionMode=Vs.ORTHOGRAPHIC,this.rright=n,this.left=t,this.top=i,this.bottom=a,this.near=o,this.far=s;var u=(this.rright-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),f=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,h=f-u,d=f+u,v=c+l,p=c-l;if(this.view!==void 0&&this.view.enabled){var g=(this.rright-this.left)/this.view.fullWidth/this.zoom,y=(this.top-this.bottom)/this.view.fullHeight/this.zoom;h+=g*this.view.offsetX,d=h+g*this.view.width,v-=y*this.view.offsetY,p=v-y*this.view.height}return QB(this.perspective,h,d,v,p,o,s),this}},{key:"setPosition",value:function(t,n,i){return this._setPosition(t,n,i),this.setFocalPoint(this.focalPoint),this}},{key:"setFocalPoint",value:function(t,n,i){var a=nr(0,1,0);if(this.focalPoint=$s(t,n,i),this.trackingMode===lv.CINEMATIC){var o=fg(Nr(),this.focalPoint,this.position);t=o[0],n=o[1],i=o[2];var s=mh(o),u=Math.asin(n/s)*Ro,l=90+Math.atan2(i,t)*Ro,f=bi();HB(f,f,l*eo),XB(f,f,u*eo),a=hg(Nr(),[0,1,0],f)}return yh(this.matrix,JB(bi(),this.position,this.focalPoint,a)),this._getAxes(),this._getDistance(),this._getAngles(),this}},{key:"setDistance",value:function(t){if(!(this.distance===t||t<0)){this.distance=t,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var n=Nr();t=this.distance;var i=this.forward,a=this.focalPoint;return n[0]=t*i[0]+a[0],n[1]=t*i[1]+a[1],n[2]=t*i[2]+a[2],this._setPosition(n),this}}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this}},{key:"changeAzimuth",value:function(t){return this.setAzimuth(this.azimuth+t),this}},{key:"changeElevation",value:function(t){return this.setElevation(this.elevation+t),this}},{key:"changeRoll",value:function(t){return this.setRoll(this.roll+t),this}},{key:"setAzimuth",value:function(t){return this.azimuth=Ja(t),this.computeMatrix(),this._getAxes(),this.type===Fr.ORBITING||this.type===Fr.EXPLORING?this._getPosition():this.type===Fr.TRACKING&&this._getFocalPoint(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(t){return this.elevation=Ja(t),this.computeMatrix(),this._getAxes(),this.type===Fr.ORBITING||this.type===Fr.EXPLORING?this._getPosition():this.type===Fr.TRACKING&&this._getFocalPoint(),this}},{key:"setRoll",value:function(t){return this.roll=Ja(t),this.computeMatrix(),this._getAxes(),this.type===Fr.ORBITING||this.type===Fr.EXPLORING?this._getPosition():this.type===Fr.TRACKING&&this._getFocalPoint(),this}},{key:"rotate",value:function(t,n,i){if(this.type===Fr.EXPLORING){t=Ja(t),n=Ja(n),i=Ja(i);var a=ds(Dn(),[1,0,0],(this.rotateWorld?1:-1)*n*eo),o=ds(Dn(),[0,1,0],(this.rotateWorld?1:-1)*t*eo),s=ds(Dn(),[0,0,1],i*eo),u=Fi(Dn(),o,a);u=Fi(Dn(),u,s);var l=wx(bi(),u);zl(this.matrix,this.matrix,[0,0,-this.distance]),cs(this.matrix,this.matrix,l),zl(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation+n)>90)return;this.relElevation=Ja(n),this.relAzimuth=Ja(t),this.relRoll=Ja(i),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.computeMatrix()}return this._getAxes(),this.type===Fr.ORBITING||this.type===Fr.EXPLORING?this._getPosition():this.type===Fr.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(t,n){var i=$s(t,n,0),a=Va(this.position);return Wa(a,a,Wl(Nr(),this.right,i[0])),Wa(a,a,Wl(Nr(),this.up,i[1])),this._setPosition(a),this}},{key:"dolly",value:function(t){var n=this.forward,i=Va(this.position),a=t*this.dollyingStep,o=this.distance+t*this.dollyingStep;return a=Math.max(Math.min(o,this.maxDistance),this.minDistance)-this.distance,i[0]+=a*n[0],i[1]+=a*n[1],i[2]+=a*n[2],this._setPosition(i),this.type===Fr.ORBITING||this.type===Fr.EXPLORING?this._getDistance():this.type===Fr.TRACKING&&Wa(this.focalPoint,i,this.distanceVector),this}},{key:"createLandmark",value:function(t,n){var i=this.clone();i.setPosition(n.position),i.setFocalPoint(n.focalPoint),n.roll!==void 0&&i.setRoll(n.roll);var a=new bI(t,i);return this.landmarks.push(a),a}},{key:"setLandmark",value:function(t){var n=new bI(t,this);return this.landmarks.push(n),this}},{key:"gotoLandmark",value:function(t){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3,a=this.landmarks.find(function(c){return c.name===t});if(a){if(i===0){a.retrieve(this);return}this.landmarkAnimationID!==void 0&&window.cancelAnimationFrame(this.landmarkAnimationID),this.interactor.disconnect();var o=a.getPosition(),s=a.getFocalPoint(),u=a.getRoll(),l,f=function c(h){l===void 0&&(l=h);var d=h-l,v=(1-Math.cos(d/i*Math.PI))/2,p=Nr(),g=Nr(),y=0;hs(p,n.focalPoint,s,v),hs(g,n.position,o,v),y=n.roll*(1-v)+u*v,n.setFocalPoint(p),n.setPosition(g),n.setRoll(y),n.computeMatrix();var m=Sx(p,s)+Sx(g,o);if(!(m>.01)){n.setFocalPoint(p),n.setPosition(g),n.setRoll(y),n.computeMatrix(),n.interactor.connect();return}d<i&&(n.landmarkAnimationID=window.requestAnimationFrame(c))};window.requestAnimationFrame(f)}}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles()}},{key:"computeMatrix",value:function(){var t,n,i=ds(Dn(),[0,0,1],this.roll*eo);_x(this.matrix),t=ds(Dn(),[1,0,0],(this.rotateWorld&&this.type!==Fr.TRACKING||this.type===Fr.TRACKING?1:-1)*this.elevation*eo),n=ds(Dn(),[0,1,0],(this.rotateWorld&&this.type!==Fr.TRACKING||this.type===Fr.TRACKING?1:-1)*this.azimuth*eo);var a=Fi(Dn(),n,t);a=Fi(Dn(),a,i);var o=wx(bi(),a);this.type===Fr.ORBITING||this.type===Fr.EXPLORING?(zl(this.matrix,this.matrix,this.focalPoint),cs(this.matrix,this.matrix,o),zl(this.matrix,this.matrix,[0,0,this.distance])):this.type===Fr.TRACKING&&(zl(this.matrix,this.matrix,this.position),cs(this.matrix,this.matrix,o))}},{key:"_setPosition",value:function(t,n,i){this.position=$s(t,n,i);var a=this.matrix;a[12]=this.position[0],a[13]=this.position[1],a[14]=this.position[2],a[15]=1}},{key:"_getAxes",value:function(){Xn(this.right,$s(Hl(Xl(),[1,0,0,0],this.matrix))),Xn(this.up,$s(Hl(Xl(),[0,1,0,0],this.matrix))),Xn(this.forward,$s(Hl(Xl(),[0,0,1,0],this.matrix))),jl(this.right,this.right),jl(this.up,this.up),jl(this.forward,this.forward)}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],n=this.distanceVector[1],i=this.distanceVector[2],a=mh(this.distanceVector);if(a===0){this.elevation=0,this.azimuth=0;return}this.type===Fr.TRACKING?(this.elevation=Math.asin(n/a)*Ro,this.azimuth=Math.atan2(-t,-i)*Ro):this.rotateWorld?(this.elevation=Math.asin(n/a)*Ro,this.azimuth=Math.atan2(-t,-i)*Ro):(this.elevation=-Math.asin(n/a)*Ro,this.azimuth=-Math.atan2(-t,-i)*Ro)}},{key:"_getPosition",value:function(){Xn(this.position,$s(Hl(Xl(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){Mu(this.distanceVector,[0,0,-this.distance],mx(Cu(),this.matrix)),Wa(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=fg(Nr(),this.focalPoint,this.position),this.distance=mh(this.distanceVector),this.dollyingStep=this.distance/100}}]),r}(),EI.ProjectionMode={ORTHOGRAPHIC:"ORTHOGRAPHIC",PERSPECTIVE:"PERSPECTIVE"},CI),SI=Pt(t0.prototype,"interactor",[_I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t0))||wI),TI,MI,II,r0,kI,Qf,DI,Bo=(TI=Ar(),MI=Nt(Le.GeometryComponentManager),TI(II=(r0=(DI=Qf=function(){function r(){wt(this,r),this.config=void 0,Dt(this,"geometry",kI,this),this.entity=void 0,this.component=void 0}return Bt(r,[{key:"getEntity",value:function(){return this.entity}},{key:"getComponent",value:function(){return this.component}},{key:"setConfig",value:function(t){this.config=t}},{key:"setEntity",value:function(t){this.entity=t,this.component=this.geometry.create(t),this.component.entity=t,this.onEntityCreated()}},{key:"onEntityCreated",value:function(){}}]),r}(),Qf.BOX="box",Qf.SPHERE="sphere",Qf.PLANE="plane",Qf.MERGED="merged",DI),kI=Pt(r0.prototype,"geometry",[MI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r0))||II),zr=xr(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.TextureCompressionBC="texture-compression-bc"}(e.ExtensionName||(e.ExtensionName={})),function(t){t.ClampToEdge="clamp-to-edge",t.Repeat="repeat",t.MirrorRepeat="mirror-repeat"}(e.AddressMode||(e.AddressMode={})),function(t){t.UniformBuffer="uniform-buffer",t.StorageBuffer="storage-buffer",t.ReadonlyStorageBuffer="readonly-storage-buffer",t.Sampler="sampler",t.ComparisonSampler="comparison-sampler",t.SampledTexture="sampled-texture",t.ReadonlyStorageTexture="readonly-storage-texture",t.WriteonlyStorageTexture="writeonly-storage-texture"}(e.BindingType||(e.BindingType={})),function(t){t.Zero="zero",t.One="one",t.SrcColor="src-color",t.OneMinusSrcColor="one-minus-src-color",t.SrcAlpha="src-alpha",t.OneMinusSrcAlpha="one-minus-src-alpha",t.DstColor="dst-color",t.OneMinusDstColor="one-minus-dst-color",t.DstAlpha="dst-alpha",t.OneMinusDstAlpha="one-minus-dst-alpha",t.SrcAlphaSaturated="src-alpha-saturated",t.BlendColor="blend-color",t.OneMinusBlendColor="one-minus-blend-color"}(e.BlendFactor||(e.BlendFactor={})),function(t){t.Add="add",t.Subtract="subtract",t.ReverseSubtract="reverse-subtract",t.Min="min",t.Max="max"}(e.BlendOperation||(e.BlendOperation={})),function(t){t.Never="never",t.Less="less",t.Equal="equal",t.LessEqual="less-equal",t.Greater="greater",t.NotEqual="not-equal",t.GreaterEqual="greater-equal",t.Always="always"}(e.CompareFunction||(e.CompareFunction={})),function(t){t.None="none",t.Front="front",t.Back="back"}(e.CullMode||(e.CullMode={})),function(t){t.Nearest="nearest",t.Linear="linear"}(e.FilterMode||(e.FilterMode={})),function(t){t.CCW="ccw",t.CW="cw"}(e.FrontFace||(e.FrontFace={})),function(t){t.Uint16="uint16",t.Uint32="uint32"}(e.IndexFormat||(e.IndexFormat={})),function(t){t.Vertex="vertex",t.Instance="instance"}(e.InputStepMode||(e.InputStepMode={})),function(t){t.Load="load"}(e.LoadOp||(e.LoadOp={})),function(t){t.PointList="point-list",t.LineList="line-list",t.LineStrip="line-strip",t.TriangleList="triangle-list",t.TriangleStrip="triangle-strip"}(e.PrimitiveTopology||(e.PrimitiveTopology={})),function(t){t.Keep="keep",t.Zero="zero",t.Replace="replace",t.Invert="invert",t.IncrementClamp="increment-clamp",t.DecrementClamp="decrement-clamp",t.IncrementWrap="increment-wrap",t.DecrementWrap="decrement-wrap"}(e.StencilOperation||(e.StencilOperation={})),function(t){t.Store="store",t.Clear="clear"}(e.StoreOp||(e.StoreOp={})),function(t){t.E1d="1d",t.E2d="2d",t.E3d="3d"}(e.TextureDimension||(e.TextureDimension={})),function(t){t.R8Unorm="r8unorm",t.R8Snorm="r8snorm",t.R8Uint="r8uint",t.R8Sint="r8sint",t.R16Uint="r16uint",t.R16Sint="r16sint",t.R16Float="r16float",t.RG8Unorm="rg8unorm",t.RG8Snorm="rg8snorm",t.RG8Uint="rg8uint",t.RG8Sint="rg8sint",t.R32Uint="r32uint",t.R32Sint="r32sint",t.R32Float="r32float",t.RG16Uint="rg16uint",t.RG16Sint="rg16sint",t.RG16Float="rg16float",t.RGBA8Unorm="rgba8unorm",t.RGBA8UnormSRGB="rgba8unorm-srgb",t.RGBA8Snorm="rgba8snorm",t.RGBA8Uint="rgba8uint",t.RGBA8Sint="rgba8sint",t.BGRA8Unorm="bgra8unorm",t.BGRA8UnormSRGB="bgra8unorm-srgb",t.RGB10A2Unorm="rgb10a2unorm",t.RG11B10Float="rg11b10float",t.RG32Uint="rg32uint",t.RG32Sint="rg32sint",t.RG32Float="rg32float",t.RGBA16Uint="rgba16uint",t.RGBA16Sint="rgba16sint",t.RGBA16Float="rgba16float",t.RGBA32Uint="rgba32uint",t.RGBA32Sint="rgba32sint",t.RGBA32Float="rgba32float",t.Depth32Float="depth32float",t.Depth24Plus="depth24plus",t.Depth24PlusStencil8="depth24plus-stencil8"}(e.TextureFormat||(e.TextureFormat={})),function(t){t.Float="float",t.Sint="sint",t.Uint="uint"}(e.TextureComponentType||(e.TextureComponentType={})),function(t){t.E1d="1d",t.E2d="2d",t.E2dArray="2d-array",t.Cube="cube",t.CubeArray="cube-array",t.E3d="3d"}(e.TextureViewDimension||(e.TextureViewDimension={})),function(t){t.Uchar2="uchar2",t.Uchar4="uchar4",t.Char2="char2",t.Char4="char4",t.Uchar2Norm="uchar2norm",t.Uchar4Norm="uchar4norm",t.Char2Norm="char2norm",t.Char4Norm="char4norm",t.Ushort2="ushort2",t.Ushort4="ushort4",t.Short2="short2",t.Short4="short4",t.Ushort2Norm="ushort2norm",t.Ushort4Norm="ushort4norm",t.Short2Norm="short2norm",t.Short4Norm="short4norm",t.Half2="half2",t.Half4="half4",t.Float="float",t.Float2="float2",t.Float3="float3",t.Float4="float4",t.Uint="uint",t.Uint2="uint2",t.Uint3="uint3",t.Uint4="uint4",t.Int="int",t.Int2="int2",t.Int3="int3",t.Int4="int4"}(e.VertexFormat||(e.VertexFormat={})),function(t){t.All="all",t.StencilOnly="stencil-only",t.DepthOnly="depth-only"}(e.TextureAspect||(e.TextureAspect={})),function(t){t.Error="error",t.Warning="warning",t.Info="info"}(e.CompilationMessageType||(e.CompilationMessageType={})),function(t){t.Occlusion="occlusion"}(e.QueryType||(e.QueryType={})),function(t){t[t.MapRead=1]="MapRead",t[t.MapWrite=2]="MapWrite",t[t.CopySrc=4]="CopySrc",t[t.CopyDst=8]="CopyDst",t[t.Index=16]="Index",t[t.Vertex=32]="Vertex",t[t.Uniform=64]="Uniform",t[t.Storage=128]="Storage",t[t.Indirect=256]="Indirect",t[t.QueryResolve=512]="QueryResolve"}(e.BufferUsage||(e.BufferUsage={})),function(t){t[t.Red=1]="Red",t[t.Green=2]="Green",t[t.Blue=4]="Blue",t[t.Alpha=8]="Alpha",t[t.All=15]="All"}(e.ColorWrite||(e.ColorWrite={})),function(t){t[t.Vertex=1]="Vertex",t[t.Fragment=2]="Fragment",t[t.Compute=4]="Compute"}(e.ShaderStage||(e.ShaderStage={})),function(t){t[t.CopySrc=1]="CopySrc",t[t.CopyDst=2]="CopyDst",t[t.Sampled=4]="Sampled",t[t.Storage=8]="Storage",t[t.OutputAttachment=16]="OutputAttachment"}(e.TextureUsage||(e.TextureUsage={})),function(t){t[t.Read=1]="Read",t[t.Write=2]="Write"}(e.MapMode||(e.MapMode={}))});Xr(zr);zr.ExtensionName;zr.AddressMode;var n0=zr.BindingType,Di=zr.BlendFactor,Jf=zr.BlendOperation,to=zr.CompareFunction,fv=zr.CullMode;zr.FilterMode;var kre=zr.FrontFace,Dre=zr.IndexFormat;zr.InputStepMode;var tl=zr.LoadOp,Ws=zr.PrimitiveTopology,i0=zr.StencilOperation,js=zr.StoreOp,a0=zr.TextureDimension,rl=zr.TextureFormat;zr.TextureComponentType;var Pre=zr.TextureViewDimension;zr.VertexFormat;var Nre=zr.TextureAspect;zr.CompilationMessageType;zr.QueryType;var wi=zr.BufferUsage,Lre=zr.ColorWrite,cv=zr.ShaderStage,Xs=zr.TextureUsage,Ore=zr.MapMode;function PI(){if(typeof document!="undefined")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}var Rre={}.toString,Bre=function(e,t){return Rre.call(e)==="[object "+t+"]"},Gre=function(r){return Array.isArray?Array.isArray(r):Bre(r,"Array")},Fre=9007199254740991,Ure="[object Arguments]",zre="[object Array]",$re="[object Boolean]",Vre="[object Date]",Wre="[object Error]",jre="[object Function]",Xre="[object Map]",Hre="[object Number]",Yre="[object Object]",qre="[object RegExp]",Kre="[object Set]",Zre="[object String]",Qre="[object WeakMap]",Jre="[object ArrayBuffer]",ene="[object DataView]",tne="[object Float32Array]",rne="[object Float64Array]",nne="[object Int8Array]",ine="[object Int16Array]",ane="[object Int32Array]",one="[object Uint8Array]",sne="[object Uint8ClampedArray]",une="[object Uint16Array]",lne="[object Uint32Array]",en={};en[tne]=en[rne]=en[nne]=en[ine]=en[ane]=en[one]=en[sne]=en[une]=en[lne]=!0;en[Ure]=en[zre]=en[Jre]=en[$re]=en[ene]=en[Vre]=en[Wre]=en[jre]=en[Xre]=en[Hre]=en[Yre]=en[qre]=en[Kre]=en[Zre]=en[Qre]=!1;var fne=Object.prototype,cne=fne.toString;function hne(r){return vne(r)&&dne(r.length)&&!!en[cne.call(r)]}function dne(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=Fre}function vne(r){return!!r&&us(r)==="object"}var NI=hne,LI,OI,RI,BI,hv,GI,FI,UI;function zI(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function $I(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?zI(Object(t),!0).forEach(function(n){Ce(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):zI(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var VI=(LI=Ar(),OI=Nt(Le.RenderEngine),RI=Nt(Le.ConfigService),LI(BI=(hv=(UI=function(){function r(){wt(this,r),Dt(this,"engine",GI,this),Dt(this,"configService",FI,this),this.entity=Ia(),this.model=void 0,this.dirty=!0,this.compiledBundle=void 0,this.initPromise=void 0}return Bt(r,[{key:"init",value:function(){var t=this.configService.get(),n=t.canvas,i=t.engineOptions;this.initPromise=this.engine.init($I({canvas:n||PI(),swapChainFormat:rl.BGRA8Unorm,antialiasing:!1},i))}},{key:"setBundle",value:function(t){this.compiledBundle=JSON.parse(JSON.stringify(t))}},{key:"setDispatch",value:function(t){return this.compiledBundle.context&&(this.compiledBundle.context.dispatch=t),this}},{key:"setMaxIteration",value:function(t){return this.compiledBundle.context&&(this.compiledBundle.context.maxIteration=t),this}},{key:"setBinding",value:function(t,n){var i=this;if(typeof t=="string"){var a=e0(n)||NI(n)||Gre(n);if(this.compiledBundle&&this.compiledBundle.context){var o=this.compiledBundle.context.defines.find(function(u){return u.name===t});if(o)return o.value=n,this;var s=this.compiledBundle.context.uniforms.find(function(u){return u.name===t});s&&(a?(s.data=n,s.isReferer=!1,s.storageClass===Oo.Uniform?this.model&&this.model.updateUniform(t,n):this.model&&this.model.updateBuffer(t,n)):(s.isReferer=!0,s.data=n))}}else Object.keys(t).forEach(function(u){i.setBinding(u,t[u])});return this}},{key:"execute",value:function(){var e=wr(bt.mark(function n(){var i=this,a,o,s=arguments;return bt.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(a=s.length>0&&s[0]!==void 0?s[0]:1,!this.dirty){l.next=6;break}return this.compiledBundle.context&&(a>1?this.compiledBundle.context.maxIteration=a:this.compiledBundle.context.maxIteration++),l.next=5,this.compile();case 5:this.dirty=!1;case 6:for(this.engine.beginFrame(),this.engine.clear({}),this.compiledBundle.context&&this.compiledBundle.context.uniforms.filter(function(f){var c=f.isReferer;return c}).forEach(function(f){var c=f.data,h=f.name;i.model.confirmInput(c.model,h)}),o=0;o<a;o++)this.model.run();return this.engine.endFrame(),l.abrupt("return",this);case 12:case"end":return l.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getOutput",value:function(){var e=wr(bt.mark(function n(){return bt.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",this.model.readData());case 1:case"end":return a.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"compile",value:function(){var e=wr(bt.mark(function n(){var i,a,o;return bt.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.initPromise;case 2:return i=$I({},this.compiledBundle.context),a=this.engine.supportWebGPU?this.engine.useWGSL?Zf.WGSL:Zf.GLSL450:Zf.GLSL100,o=this.compiledBundle.shaders[a],i.defines.filter(function(l){return l.runtime}).forEach(function(l){var f="".concat(Ire).concat(l.name);o=o.replace(f,"".concat(l.value))}),i.shader=o,i.uniforms.forEach(function(l){if(!l.data&&l.storageClass===Oo.StorageBuffer){var f=1;l.type===zs.FloatArray?f=1:l.type===zs.Vector4FloatArray&&(f=4),l.data=new Float32Array(i.output.length*f).fill(0)}}),this.compiledBundle.context=i,u.next=11,this.engine.createComputeModel(this.compiledBundle.context);case 11:this.model=u.sent;case 12:case"end":return u.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()}]),r}(),UI),GI=Pt(hv.prototype,"engine",[OI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FI=Pt(hv.prototype,"configService",[RI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hv))||BI),WI,jI,XI,o0,HI,YI,qI,KI=(WI=Ar(),jI=Nt(Le.MaterialComponentManager),WI(XI=(o0=(qI=YI=function(){function r(){wt(this,r),this.config=void 0,Dt(this,"material",HI,this),this.entity=void 0,this.component=void 0}return Bt(r,[{key:"getEntity",value:function(){return this.entity}},{key:"getComponent",value:function(){return this.component}},{key:"setConfig",value:function(t){this.config=t}},{key:"setEntity",value:function(t,n){this.entity=t,this.component=this.material.create(t),this.component.entity=t,this.component.type=n,this.onEntityCreated()}},{key:"onEntityCreated",value:function(){}}]),r}(),YI.BASIC="basic",qI),HI=Pt(o0.prototype,"material",[jI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o0))||XI),ZI,QI,JI,ek,tk,rk,nk,nl,ik,ak,ok,sk,dv,uk,Go=(ZI=Ar(),QI=Nt(Le.MeshComponentManager),JI=Nt(Le.CullableComponentManager),ek=Nt(Le.TransformComponentManager),tk=Nt(Le.Systems),rk=ka(Le.SceneGraphSystem),ZI(nk=(nl=(uk=dv=function(){function r(){wt(this,r),this.attributes={},this.config=void 0,Dt(this,"mesh",ik,this),Dt(this,"cullable",ak,this),Dt(this,"transform",ok,this),Dt(this,"sceneGraphSystem",sk,this),this.meshComponent=void 0,this.transformComponent=void 0,this.entity=void 0}return Bt(r,[{key:"getEntity",value:function(){return this.entity}},{key:"getTransformComponent",value:function(){return this.transformComponent}},{key:"getMeshComponent",value:function(){return this.meshComponent}},{key:"setConfig",value:function(t){this.config=t}},{key:"setEntity",value:function(t){this.entity=t,this.cullable.create(t),this.meshComponent=this.mesh.create(t),this.transformComponent=this.transform.create(t),this.onEntityCreated()}},{key:"setMaterial",value:function(t){return this.meshComponent.material=t,this}},{key:"setGeometry",value:function(t){return this.meshComponent.geometry=t,this}},{key:"setAttributes",value:function(t){var n=this;Object.keys(t).forEach(function(i){t[i]!==void 0&&t[i]!==n.attributes[i]&&(n.onAttributeChanged({name:i,data:t[i]}),n.attributes[i]=t[i])})}},{key:"setVisible",value:function(t){var n=this;return this.meshComponent.visible=t,this.meshComponent.children.forEach(function(i){var a=n.mesh.getComponentByEntity(i);a&&(a.visible=t)}),this}},{key:"isVisible",value:function(){return this.meshComponent.visible}},{key:"attach",value:function(t){return this.sceneGraphSystem.attach(this.entity,t.entity),this}},{key:"detach",value:function(){return this.sceneGraphSystem.detach(this.entity),this}},{key:"detachChildren",value:function(){return this.sceneGraphSystem.detachChildren(this.entity),this}},{key:"onEntityCreated",value:function(){}},{key:"onAttributeChanged",value:function(t){var n=t.name,i=t.data;this.meshComponent&&this.meshComponent.material&&this.meshComponent.material.setUniform(this.convertAttributeName2UniformName(n),i)}},{key:"convertAttributeName2UniformName",value:function(t){return t}}]),r}(),dv.POINT="point",dv.LINE="line",dv.GRID="grid",uk),ik=Pt(nl.prototype,"mesh",[QI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ak=Pt(nl.prototype,"cullable",[JI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ok=Pt(nl.prototype,"transform",[ek],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sk=Pt(nl.prototype,"sceneGraphSystem",[tk,rk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nl))||nk),pne=xr(function(r,e){(function(t,n){r.exports=n()})(ss,function(){var t=function(A){return A instanceof Uint8Array||A instanceof Uint16Array||A instanceof Uint32Array||A instanceof Int8Array||A instanceof Int16Array||A instanceof Int32Array||A instanceof Float32Array||A instanceof Float64Array||A instanceof Uint8ClampedArray},n=function(A,N){for(var $=Object.keys(N),de=0;de<$.length;++de)A[$[de]]=N[$[de]];return A},i=`
`;function a(A){return typeof atob!="undefined"?atob(A):"base64:"+A}function o(A){var N=new Error("(regl) "+A);throw console.error(N),N}function s(A,N){A||o(N)}function u(A){return A?": "+A:""}function l(A,N,$){A in N||o("unknown parameter ("+A+")"+u($)+". possible values: "+Object.keys(N).join())}function f(A,N){t(A)||o("invalid parameter type"+u(N)+". must be a typed array")}function c(A,N){switch(N){case"number":return typeof A=="number";case"object":return typeof A=="object";case"string":return typeof A=="string";case"boolean":return typeof A=="boolean";case"function":return typeof A=="function";case"undefined":return typeof A=="undefined";case"symbol":return typeof A=="symbol"}}function h(A,N,$){c(A,N)||o("invalid parameter type"+u($)+". expected "+N+", got "+typeof A)}function d(A,N){A>=0&&(A|0)===A||o("invalid parameter type, ("+A+")"+u(N)+". must be a nonnegative integer")}function v(A,N,$){N.indexOf(A)<0&&o("invalid value"+u($)+". must be one of: "+N)}var p=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function g(A){Object.keys(A).forEach(function(N){p.indexOf(N)<0&&o('invalid regl constructor argument "'+N+'". must be one of '+p)})}function y(A,N){for(A=A+"";A.length<N;)A=" "+A;return A}function m(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function b(A,N){this.number=A,this.line=N,this.errors=[]}function x(A,N,$){this.file=A,this.line=N,this.message=$}function _(){var A=new Error,N=(A.stack||A).toString(),$=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(N);if($)return $[1];var de=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(N);return de?de[1]:"unknown"}function S(){var A=new Error,N=(A.stack||A).toString(),$=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(N);if($)return $[1];var de=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(N);return de?de[1]:"unknown"}function E(A,N){var $=A.split(`
`),de=1,Ae=0,ce={unknown:new m,0:new m};ce.unknown.name=ce[0].name=N||_(),ce.unknown.lines.push(new b(0,""));for(var ye=0;ye<$.length;++ye){var Re=$[ye],Ue=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Re);if(Ue)switch(Ue[1]){case"line":var je=/(\d+)(\s+\d+)?/.exec(Ue[2]);je&&(de=je[1]|0,je[2]&&(Ae=je[2]|0,Ae in ce||(ce[Ae]=new m)));break;case"define":var ze=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Ue[2]);ze&&(ce[Ae].name=ze[1]?a(ze[2]):ze[2]);break}ce[Ae].lines.push(new b(de++,Re))}return Object.keys(ce).forEach(function(Ke){var et=ce[Ke];et.lines.forEach(function(Be){et.index[Be.number]=Be})}),ce}function C(A){var N=[];return A.split(`
`).forEach(function($){if(!($.length<5)){var de=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec($);de?N.push(new x(de[1]|0,de[2]|0,de[3].trim())):$.length>0&&N.push(new x("unknown",0,$))}}),N}function M(A,N){N.forEach(function($){var de=A[$.file];if(de){var Ae=de.index[$.line];if(Ae){Ae.errors.push($),de.hasErrors=!0;return}}A.unknown.hasErrors=!0,A.unknown.lines[0].errors.push($)})}function w(A,N,$,de,Ae){if(!A.getShaderParameter(N,A.COMPILE_STATUS)){var ce=A.getShaderInfoLog(N),ye=de===A.FRAGMENT_SHADER?"fragment":"vertex";K($,"string",ye+" shader source must be a string",Ae);var Re=E($,Ae),Ue=C(ce);M(Re,Ue),Object.keys(Re).forEach(function(je){var ze=Re[je];if(!ze.hasErrors)return;var Ke=[""],et=[""];function Be(Ze,ie){Ke.push(Ze),et.push(ie||"")}Be("file number "+je+": "+ze.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),ze.lines.forEach(function(Ze){if(Ze.errors.length>0){Be(y(Ze.number,4)+"|  ","background-color:yellow; font-weight:bold"),Be(Ze.line+i,"color:red; background-color:yellow; font-weight:bold");var ie=0;Ze.errors.forEach(function(me){var We=me.message,it=/^\s*'(.*)'\s*:\s*(.*)$/.exec(We);if(it){var De=it[1];switch(We=it[2],De){case"assign":De="=";break}ie=Math.max(Ze.line.indexOf(De,ie),0)}else ie=0;Be(y("| ",6)),Be(y("^^^",ie+3)+i,"font-weight:bold"),Be(y("| ",6)),Be(We+i,"font-weight:bold")}),Be(y("| ",6)+i)}else Be(y(Ze.number,4)+"|  "),Be(Ze.line+i,"color:red")}),typeof document!="undefined"&&!window.chrome?(et[0]=Ke.join("%c"),console.log.apply(console,et)):console.log(Ke.join(""))}),s.raise("Error compiling "+ye+" shader, "+Re[0].name)}}function T(A,N,$,de,Ae){if(!A.getProgramParameter(N,A.LINK_STATUS)){var ce=A.getProgramInfoLog(N),ye=E($,Ae),Re=E(de,Ae),Ue='Error linking program with vertex shader, "'+Re[0].name+'", and fragment shader "'+ye[0].name+'"';typeof document!="undefined"?console.log("%c"+Ue+i+"%c"+ce,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Ue+i+ce),s.raise(Ue)}}function I(A){A._commandRef=_()}function k(A,N,$,de){I(A);function Ae(Ue){return Ue?de.id(Ue):0}A._fragId=Ae(A.static.frag),A._vertId=Ae(A.static.vert);function ce(Ue,je){Object.keys(je).forEach(function(ze){Ue[de.id(ze)]=!0})}var ye=A._uniformSet={};ce(ye,N.static),ce(ye,N.dynamic);var Re=A._attributeSet={};ce(Re,$.static),ce(Re,$.dynamic),A._hasCount="count"in A.static||"count"in A.dynamic||"elements"in A.static||"elements"in A.dynamic}function O(A,N){var $=S();o(A+" in command "+(N||_())+($==="unknown"?"":" called from "+$))}function U(A,N,$){A||O(N,$||_())}function q(A,N,$,de){A in N||O("unknown parameter ("+A+")"+u($)+". possible values: "+Object.keys(N).join(),de||_())}function K(A,N,$,de){c(A,N)||O("invalid parameter type"+u($)+". expected "+N+", got "+typeof A,de||_())}function le(A){A()}function he(A,N,$){A.texture?v(A.texture._texture.internalformat,N,"unsupported texture format for attachment"):v(A.renderbuffer._renderbuffer.format,$,"unsupported renderbuffer format for attachment")}var te=33071,se=9728,ge=9984,Se=9985,ne=9986,pe=9987,Ge=5120,ke=5121,rt=5122,$e=5123,ut=5124,pt=5125,qt=5126,F=32819,Z=32820,V=33635,Fe=34042,at=36193,Me={};Me[Ge]=Me[ke]=1,Me[rt]=Me[$e]=Me[at]=Me[V]=Me[F]=Me[Z]=2,Me[ut]=Me[pt]=Me[qt]=Me[Fe]=4;function ct(A,N){return A===Z||A===F||A===V?2:A===Fe?4:Me[A]*N}function Ye(A){return!(A&A-1)&&!!A}function nt(A,N,$){var de,Ae=N.width,ce=N.height,ye=N.channels;s(Ae>0&&Ae<=$.maxTextureSize&&ce>0&&ce<=$.maxTextureSize,"invalid texture shape"),(A.wrapS!==te||A.wrapT!==te)&&s(Ye(Ae)&&Ye(ce),"incompatible wrap mode for texture, both width and height must be power of 2"),N.mipmask===1?Ae!==1&&ce!==1&&s(A.minFilter!==ge&&A.minFilter!==ne&&A.minFilter!==Se&&A.minFilter!==pe,"min filter requires mipmap"):(s(Ye(Ae)&&Ye(ce),"texture must be a square power of 2 to support mipmapping"),s(N.mipmask===(Ae<<1)-1,"missing or incomplete mipmap data")),N.type===qt&&($.extensions.indexOf("oes_texture_float_linear")<0&&s(A.minFilter===se&&A.magFilter===se,"filter not supported, must enable oes_texture_float_linear"),s(!A.genMipmaps,"mipmap generation not supported with float textures"));var Re=N.images;for(de=0;de<16;++de)if(Re[de]){var Ue=Ae>>de,je=ce>>de;s(N.mipmask&1<<de,"missing mipmap data");var ze=Re[de];if(s(ze.width===Ue&&ze.height===je,"invalid shape for mip images"),s(ze.format===N.format&&ze.internalformat===N.internalformat&&ze.type===N.type,"incompatible type for mip image"),!ze.compressed)if(ze.data){var Ke=Math.ceil(ct(ze.type,ye)*Ue/ze.unpackAlignment)*ze.unpackAlignment;s(ze.data.byteLength===Ke*je,"invalid data for image, buffer size is inconsistent with image format")}else ze.element||ze.copy}else A.genMipmaps||s((N.mipmask&1<<de)==0,"extra mipmap data");N.compressed&&s(!A.genMipmaps,"mipmap generation for compressed images not supported")}function Et(A,N,$,de){var Ae=A.width,ce=A.height,ye=A.channels;s(Ae>0&&Ae<=de.maxTextureSize&&ce>0&&ce<=de.maxTextureSize,"invalid texture shape"),s(Ae===ce,"cube map must be square"),s(N.wrapS===te&&N.wrapT===te,"wrap mode not supported by cube map");for(var Re=0;Re<$.length;++Re){var Ue=$[Re];s(Ue.width===Ae&&Ue.height===ce,"inconsistent cube map face shape"),N.genMipmaps&&(s(!Ue.compressed,"can not generate mipmap for compressed textures"),s(Ue.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var je=Ue.images,ze=0;ze<16;++ze){var Ke=je[ze];if(Ke){var et=Ae>>ze,Be=ce>>ze;s(Ue.mipmask&1<<ze,"missing mipmap data"),s(Ke.width===et&&Ke.height===Be,"invalid shape for mip images"),s(Ke.format===A.format&&Ke.internalformat===A.internalformat&&Ke.type===A.type,"incompatible type for mip image"),Ke.compressed||(Ke.data?s(Ke.data.byteLength===et*Be*Math.max(ct(Ke.type,ye),Ke.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Ke.element||Ke.copy)}}}}var D=n(s,{optional:le,raise:o,commandRaise:O,command:U,parameter:l,commandParameter:q,constructor:g,type:h,commandType:K,isTypedArray:f,nni:d,oneOf:v,shaderError:w,linkError:T,callSite:S,saveCommandRef:I,saveDrawInfo:k,framebufferFormat:he,guessCommand:_,texture2D:nt,textureCube:Et}),ee=0,be=0,we=5,Oe=6;function qe(A,N){this.id=ee++,this.type=A,this.data=N}function Jt(A){return A.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function gt(A){if(A.length===0)return[];var N=A.charAt(0),$=A.charAt(A.length-1);if(A.length>1&&N===$&&(N==='"'||N==="'"))return['"'+Jt(A.substr(1,A.length-2))+'"'];var de=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(A);if(de)return gt(A.substr(0,de.index)).concat(gt(de[1])).concat(gt(A.substr(de.index+de[0].length)));var Ae=A.split(".");if(Ae.length===1)return['"'+Jt(A)+'"'];for(var ce=[],ye=0;ye<Ae.length;++ye)ce=ce.concat(gt(Ae[ye]));return ce}function Ct(A){return"["+gt(A).join("][")+"]"}function kt(A,N){return new qe(A,Ct(N+""))}function Gt(A){return typeof A=="function"&&!A._reglType||A instanceof qe}function Zt(A,N){if(typeof A=="function")return new qe(be,A);if(typeof A=="number"||typeof A=="boolean")return new qe(we,A);if(Array.isArray(A))return new qe(Oe,A.map(($,de)=>Zt($,N+"["+de+"]")));if(A instanceof qe)return A;D(!1,"invalid option type in uniform "+N)}var ar={DynamicVariable:qe,define:kt,isDynamic:Gt,unbox:Zt,accessor:Ct},ei={next:typeof requestAnimationFrame=="function"?function(A){return requestAnimationFrame(A)}:function(A){return setTimeout(A,16)},cancel:typeof cancelAnimationFrame=="function"?function(A){return cancelAnimationFrame(A)}:clearTimeout},jt=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Sr(){var A={"":0},N=[""];return{id:function($){var de=A[$];return de||(de=A[$]=N.length,N.push($),de)},str:function($){return N[$]}}}function Ir(A,N,$){var de=document.createElement("canvas");n(de.style,{border:0,margin:0,padding:0,top:0,left:0}),A.appendChild(de),A===document.body&&(de.style.position="absolute",n(A.style,{margin:0,padding:0}));function Ae(){var Re=window.innerWidth,Ue=window.innerHeight;if(A!==document.body){var je=A.getBoundingClientRect();Re=je.right-je.left,Ue=je.bottom-je.top}de.width=$*Re,de.height=$*Ue,n(de.style,{width:Re+"px",height:Ue+"px"})}var ce;A!==document.body&&typeof ResizeObserver=="function"?(ce=new ResizeObserver(function(){setTimeout(Ae)}),ce.observe(A)):window.addEventListener("resize",Ae,!1);function ye(){ce?ce.disconnect():window.removeEventListener("resize",Ae),A.removeChild(de)}return Ae(),{canvas:de,onDestroy:ye}}function or(A,N){function $(de){try{return A.getContext(de,N)}catch(Ae){return null}}return $("webgl")||$("experimental-webgl")||$("webgl-experimental")}function $r(A){return typeof A.nodeName=="string"&&typeof A.appendChild=="function"&&typeof A.getBoundingClientRect=="function"}function Vt(A){return typeof A.drawArrays=="function"||typeof A.drawElements=="function"}function kr(A){return typeof A=="string"?A.split():(D(Array.isArray(A),"invalid extension array"),A)}function Mr(A){return typeof A=="string"?(D(typeof document!="undefined","not supported outside of DOM"),document.querySelector(A)):A}function fr(A){var N=A||{},$,de,Ae,ce,ye={},Re=[],Ue=[],je=typeof window=="undefined"?1:window.devicePixelRatio,ze=!1,Ke=function(Ze){Ze&&D.raise(Ze)},et=function(){};if(typeof N=="string"?(D(typeof document!="undefined","selector queries only supported in DOM enviroments"),$=document.querySelector(N),D($,"invalid query string for element")):typeof N=="object"?$r(N)?$=N:Vt(N)?(ce=N,Ae=ce.canvas):(D.constructor(N),"gl"in N?ce=N.gl:"canvas"in N?Ae=Mr(N.canvas):"container"in N&&(de=Mr(N.container)),"attributes"in N&&(ye=N.attributes,D.type(ye,"object","invalid context attributes")),"extensions"in N&&(Re=kr(N.extensions)),"optionalExtensions"in N&&(Ue=kr(N.optionalExtensions)),"onDone"in N&&(D.type(N.onDone,"function","invalid or missing onDone callback"),Ke=N.onDone),"profile"in N&&(ze=!!N.profile),"pixelRatio"in N&&(je=+N.pixelRatio,D(je>0,"invalid pixel ratio"))):D.raise("invalid arguments to regl"),$&&($.nodeName.toLowerCase()==="canvas"?Ae=$:de=$),!ce){if(!Ae){D(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var Be=Ir(de||document.body,Ke,je);if(!Be)return null;Ae=Be.canvas,et=Be.onDestroy}ye.premultipliedAlpha===void 0&&(ye.premultipliedAlpha=!0),ce=or(Ae,ye)}return ce?{gl:ce,canvas:Ae,container:de,extensions:Re,optionalExtensions:Ue,pixelRatio:je,profile:ze,onDone:Ke,onDestroy:et}:(et(),Ke("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Er(A,N){var $={};function de(ye){D.type(ye,"string","extension name must be string");var Re=ye.toLowerCase(),Ue;try{Ue=$[Re]=A.getExtension(Re)}catch(je){}return!!Ue}for(var Ae=0;Ae<N.extensions.length;++Ae){var ce=N.extensions[Ae];if(!de(ce))return N.onDestroy(),N.onDone('"'+ce+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return N.optionalExtensions.forEach(de),{extensions:$,restore:function(){Object.keys($).forEach(function(ye){if($[ye]&&!de(ye))throw new Error("(regl): error restoring extension "+ye)})}}}function ur(A,N){for(var $=Array(A),de=0;de<A;++de)$[de]=N(de);return $}var bn=5120,On=5121,Vr=5122,Rn=5123,Cn=5124,cr=5125,Rr=5126;function Ur(A){for(var N=16;N<=1<<28;N*=16)if(A<=N)return N;return 0}function Or(A){var N,$;return N=(A>65535)<<4,A>>>=N,$=(A>255)<<3,A>>>=$,N|=$,$=(A>15)<<2,A>>>=$,N|=$,$=(A>3)<<1,A>>>=$,N|=$,N|A>>1}function An(){var A=ur(8,function(){return[]});function N(ce){var ye=Ur(ce),Re=A[Or(ye)>>2];return Re.length>0?Re.pop():new ArrayBuffer(ye)}function $(ce){A[Or(ce.byteLength)>>2].push(ce)}function de(ce,ye){var Re=null;switch(ce){case bn:Re=new Int8Array(N(ye),0,ye);break;case On:Re=new Uint8Array(N(ye),0,ye);break;case Vr:Re=new Int16Array(N(2*ye),0,ye);break;case Rn:Re=new Uint16Array(N(2*ye),0,ye);break;case Cn:Re=new Int32Array(N(4*ye),0,ye);break;case cr:Re=new Uint32Array(N(4*ye),0,ye);break;case Rr:Re=new Float32Array(N(4*ye),0,ye);break;default:return null}return Re.length!==ye?Re.subarray(0,ye):Re}function Ae(ce){$(ce.buffer)}return{alloc:N,free:$,allocType:de,freeType:Ae}}var Br=An();Br.zero=An();var Ei=3408,fo=3410,Js=3411,eu=3412,tu=3413,pl=3414,Ec=3415,Xv=33901,Hv=33902,Yv=3379,ru=3386,Yi=34921,nu=36347,Wr=36348,ui=35661,xn=35660,Ni=34930,Fa=36349,Cc=34076,Ac=34024,gl=7936,Tc=7937,Mc=7938,Ic=35724,sL=34047,uL=36063,lL=34852,kc=3553,J0=34067,fL=34069,cL=33984,yl=6408,qv=5126,e1=5121,Kv=36160,hL=36053,dL=36064,vL=16384,pL=function(A,N){var $=1;N.ext_texture_filter_anisotropic&&($=A.getParameter(sL));var de=1,Ae=1;N.webgl_draw_buffers&&(de=A.getParameter(lL),Ae=A.getParameter(uL));var ce=!!N.oes_texture_float;if(ce){var ye=A.createTexture();A.bindTexture(kc,ye),A.texImage2D(kc,0,yl,1,1,0,yl,qv,null);var Re=A.createFramebuffer();if(A.bindFramebuffer(Kv,Re),A.framebufferTexture2D(Kv,dL,kc,ye,0),A.bindTexture(kc,null),A.checkFramebufferStatus(Kv)!==hL)ce=!1;else{A.viewport(0,0,1,1),A.clearColor(1,0,0,1),A.clear(vL);var Ue=Br.allocType(qv,4);A.readPixels(0,0,1,1,yl,qv,Ue),A.getError()?ce=!1:(A.deleteFramebuffer(Re),A.deleteTexture(ye),ce=Ue[0]===1),Br.freeType(Ue)}}var je=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),ze=!0;if(!je){var Ke=A.createTexture(),et=Br.allocType(e1,36);A.activeTexture(cL),A.bindTexture(J0,Ke),A.texImage2D(fL,0,yl,3,3,0,yl,e1,et),Br.freeType(et),A.bindTexture(J0,null),A.deleteTexture(Ke),ze=!A.getError()}return{colorBits:[A.getParameter(fo),A.getParameter(Js),A.getParameter(eu),A.getParameter(tu)],depthBits:A.getParameter(pl),stencilBits:A.getParameter(Ec),subpixelBits:A.getParameter(Ei),extensions:Object.keys(N).filter(function(Be){return!!N[Be]}),maxAnisotropic:$,maxDrawbuffers:de,maxColorAttachments:Ae,pointSizeDims:A.getParameter(Xv),lineWidthDims:A.getParameter(Hv),maxViewportDims:A.getParameter(ru),maxCombinedTextureUnits:A.getParameter(ui),maxCubeMapSize:A.getParameter(Cc),maxRenderbufferSize:A.getParameter(Ac),maxTextureUnits:A.getParameter(Ni),maxTextureSize:A.getParameter(Yv),maxAttributes:A.getParameter(Yi),maxVertexUniforms:A.getParameter(nu),maxVertexTextureUnits:A.getParameter(xn),maxVaryingVectors:A.getParameter(Wr),maxFragmentUniforms:A.getParameter(Fa),glsl:A.getParameter(Ic),renderer:A.getParameter(Tc),vendor:A.getParameter(gl),version:A.getParameter(Mc),readFloat:ce,npotTextureCube:ze}};function qi(A){return!!A&&typeof A=="object"&&Array.isArray(A.shape)&&Array.isArray(A.stride)&&typeof A.offset=="number"&&A.shape.length===A.stride.length&&(Array.isArray(A.data)||t(A.data))}var Ci=function(A){return Object.keys(A).map(function(N){return A[N]})},Dc={shape:bL,flatten:mL};function gL(A,N,$){for(var de=0;de<N;++de)$[de]=A[de]}function yL(A,N,$,de){for(var Ae=0,ce=0;ce<N;++ce)for(var ye=A[ce],Re=0;Re<$;++Re)de[Ae++]=ye[Re]}function t1(A,N,$,de,Ae,ce){for(var ye=ce,Re=0;Re<N;++Re)for(var Ue=A[Re],je=0;je<$;++je)for(var ze=Ue[je],Ke=0;Ke<de;++Ke)Ae[ye++]=ze[Ke]}function r1(A,N,$,de,Ae){for(var ce=1,ye=$+1;ye<N.length;++ye)ce*=N[ye];var Re=N[$];if(N.length-$==4){var Ue=N[$+1],je=N[$+2],ze=N[$+3];for(ye=0;ye<Re;++ye)t1(A[ye],Ue,je,ze,de,Ae),Ae+=ce}else for(ye=0;ye<Re;++ye)r1(A[ye],N,$+1,de,Ae),Ae+=ce}function mL(A,N,$,de){var Ae=1;if(N.length)for(var ce=0;ce<N.length;++ce)Ae*=N[ce];else Ae=0;var ye=de||Br.allocType($,Ae);switch(N.length){case 0:break;case 1:gL(A,N[0],ye);break;case 2:yL(A,N[0],N[1],ye);break;case 3:t1(A,N[0],N[1],N[2],ye,0);break;default:r1(A,N,0,ye,0)}return ye}function bL(A){for(var N=[],$=A;$.length;$=$[0])N.push($.length);return N}var Zv={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},xL=5120,_L=5122,wL=5124,SL=5121,EL=5123,CL=5125,AL=5126,TL=5126,Ho={int8:xL,int16:_L,int32:wL,uint8:SL,uint16:EL,uint32:CL,float:AL,float32:TL},ML=35048,IL=35040,Pc={dynamic:ML,stream:IL,static:35044},Qv=Dc.flatten,n1=Dc.shape,i1=35044,kL=35040,Jv=5121,ep=5126,co=[];co[5120]=1,co[5122]=2,co[5124]=4,co[5121]=1,co[5123]=2,co[5125]=4,co[5126]=4;function Nc(A){return Zv[Object.prototype.toString.call(A)]|0}function a1(A,N){for(var $=0;$<N.length;++$)A[$]=N[$]}function o1(A,N,$,de,Ae,ce,ye){for(var Re=0,Ue=0;Ue<$;++Ue)for(var je=0;je<de;++je)A[Re++]=N[Ae*Ue+ce*je+ye]}function DL(A,N,$,de){var Ae=0,ce={};function ye(ie){this.id=Ae++,this.buffer=A.createBuffer(),this.type=ie,this.usage=i1,this.byteLength=0,this.dimension=1,this.dtype=Jv,this.persistentData=null,$.profile&&(this.stats={size:0})}ye.prototype.bind=function(){A.bindBuffer(this.type,this.buffer)},ye.prototype.destroy=function(){et(this)};var Re=[];function Ue(ie,me){var We=Re.pop();return We||(We=new ye(ie)),We.bind(),Ke(We,me,kL,0,1,!1),We}function je(ie){Re.push(ie)}function ze(ie,me,We){ie.byteLength=me.byteLength,A.bufferData(ie.type,me,We)}function Ke(ie,me,We,it,De,ot){var Ne;if(ie.usage=We,Array.isArray(me)){if(ie.dtype=it||ep,me.length>0){var Qe;if(Array.isArray(me[0])){Ne=n1(me);for(var Pe=1,Je=1;Je<Ne.length;++Je)Pe*=Ne[Je];ie.dimension=Pe,Qe=Qv(me,Ne,ie.dtype),ze(ie,Qe,We),ot?ie.persistentData=Qe:Br.freeType(Qe)}else if(typeof me[0]=="number"){ie.dimension=De;var _t=Br.allocType(ie.dtype,me.length);a1(_t,me),ze(ie,_t,We),ot?ie.persistentData=_t:Br.freeType(_t)}else t(me[0])?(ie.dimension=me[0].length,ie.dtype=it||Nc(me[0])||ep,Qe=Qv(me,[me.length,me[0].length],ie.dtype),ze(ie,Qe,We),ot?ie.persistentData=Qe:Br.freeType(Qe)):D.raise("invalid buffer data")}}else if(t(me))ie.dtype=it||Nc(me),ie.dimension=De,ze(ie,me,We),ot&&(ie.persistentData=new Uint8Array(new Uint8Array(me.buffer)));else if(qi(me)){Ne=me.shape;var Ft=me.stride,tt=me.offset,He=0,Ie=0,Ot=0,Xt=0;Ne.length===1?(He=Ne[0],Ie=1,Ot=Ft[0],Xt=0):Ne.length===2?(He=Ne[0],Ie=Ne[1],Ot=Ft[0],Xt=Ft[1]):D.raise("invalid shape"),ie.dtype=it||Nc(me.data)||ep,ie.dimension=Ie;var ht=Br.allocType(ie.dtype,He*Ie);o1(ht,me.data,He,Ie,Ot,Xt,tt),ze(ie,ht,We),ot?ie.persistentData=ht:Br.freeType(ht)}else me instanceof ArrayBuffer?(ie.dtype=Jv,ie.dimension=De,ze(ie,me,We),ot&&(ie.persistentData=new Uint8Array(new Uint8Array(me)))):D.raise("invalid buffer data")}function et(ie){N.bufferCount--,de(ie);var me=ie.buffer;D(me,"buffer must not be deleted already"),A.deleteBuffer(me),ie.buffer=null,delete ce[ie.id]}function Be(ie,me,We,it){N.bufferCount++;var De=new ye(me);ce[De.id]=De;function ot(Pe){var Je=i1,_t=null,Ft=0,tt=0,He=1;return Array.isArray(Pe)||t(Pe)||qi(Pe)||Pe instanceof ArrayBuffer?_t=Pe:typeof Pe=="number"?Ft=Pe|0:Pe&&(D.type(Pe,"object","buffer arguments must be an object, a number or an array"),"data"in Pe&&(D(_t===null||Array.isArray(_t)||t(_t)||qi(_t),"invalid data for buffer"),_t=Pe.data),"usage"in Pe&&(D.parameter(Pe.usage,Pc,"invalid buffer usage"),Je=Pc[Pe.usage]),"type"in Pe&&(D.parameter(Pe.type,Ho,"invalid buffer type"),tt=Ho[Pe.type]),"dimension"in Pe&&(D.type(Pe.dimension,"number","invalid dimension"),He=Pe.dimension|0),"length"in Pe&&(D.nni(Ft,"buffer length must be a nonnegative integer"),Ft=Pe.length|0)),De.bind(),_t?Ke(De,_t,Je,tt,He,it):(Ft&&A.bufferData(De.type,Ft,Je),De.dtype=tt||Jv,De.usage=Je,De.dimension=He,De.byteLength=Ft),$.profile&&(De.stats.size=De.byteLength*co[De.dtype]),ot}function Ne(Pe,Je){D(Je+Pe.byteLength<=De.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Pe.byteLength+" starting from offset "+Je+" to a buffer of size "+De.byteLength),A.bufferSubData(De.type,Je,Pe)}function Qe(Pe,Je){var _t=(Je||0)|0,Ft;if(De.bind(),t(Pe)||Pe instanceof ArrayBuffer)Ne(Pe,_t);else if(Array.isArray(Pe)){if(Pe.length>0)if(typeof Pe[0]=="number"){var tt=Br.allocType(De.dtype,Pe.length);a1(tt,Pe),Ne(tt,_t),Br.freeType(tt)}else if(Array.isArray(Pe[0])||t(Pe[0])){Ft=n1(Pe);var He=Qv(Pe,Ft,De.dtype);Ne(He,_t),Br.freeType(He)}else D.raise("invalid buffer data")}else if(qi(Pe)){Ft=Pe.shape;var Ie=Pe.stride,Ot=0,Xt=0,ht=0,er=0;Ft.length===1?(Ot=Ft[0],Xt=1,ht=Ie[0],er=0):Ft.length===2?(Ot=Ft[0],Xt=Ft[1],ht=Ie[0],er=Ie[1]):D.raise("invalid shape");var Ut=Array.isArray(Pe.data)?De.dtype:Nc(Pe.data),Kt=Br.allocType(Ut,Ot*Xt);o1(Kt,Pe.data,Ot,Xt,ht,er,Pe.offset),Ne(Kt,_t),Br.freeType(Kt)}else D.raise("invalid data for buffer subdata");return ot}return We||ot(ie),ot._reglType="buffer",ot._buffer=De,ot.subdata=Qe,$.profile&&(ot.stats=De.stats),ot.destroy=function(){et(De)},ot}function Ze(){Ci(ce).forEach(function(ie){ie.buffer=A.createBuffer(),A.bindBuffer(ie.type,ie.buffer),A.bufferData(ie.type,ie.persistentData||ie.byteLength,ie.usage)})}return $.profile&&(N.getTotalBufferSize=function(){var ie=0;return Object.keys(ce).forEach(function(me){ie+=ce[me].stats.size}),ie}),{create:Be,createStream:Ue,destroyStream:je,clear:function(){Ci(ce).forEach(et),Re.forEach(et)},getBuffer:function(ie){return ie&&ie._buffer instanceof ye?ie._buffer:null},restore:Ze,_initBuffer:Ke}}var PL=0,NL=0,LL=1,OL=1,RL=4,BL=4,iu={points:PL,point:NL,lines:LL,line:OL,triangles:RL,triangle:BL,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},GL=0,FL=1,ml=4,UL=5120,au=5121,s1=5122,ou=5123,u1=5124,Yo=5125,tp=34963,zL=35040,$L=35044;function VL(A,N,$,de){var Ae={},ce=0,ye={uint8:au,uint16:ou};N.oes_element_index_uint&&(ye.uint32=Yo);function Re(Ze){this.id=ce++,Ae[this.id]=this,this.buffer=Ze,this.primType=ml,this.vertCount=0,this.type=0}Re.prototype.bind=function(){this.buffer.bind()};var Ue=[];function je(Ze){var ie=Ue.pop();return ie||(ie=new Re($.create(null,tp,!0,!1)._buffer)),Ke(ie,Ze,zL,-1,-1,0,0),ie}function ze(Ze){Ue.push(Ze)}function Ke(Ze,ie,me,We,it,De,ot){Ze.buffer.bind();var Ne;if(ie){var Qe=ot;!ot&&(!t(ie)||qi(ie)&&!t(ie.data))&&(Qe=N.oes_element_index_uint?Yo:ou),$._initBuffer(Ze.buffer,ie,me,Qe,3)}else A.bufferData(tp,De,me),Ze.buffer.dtype=Ne||au,Ze.buffer.usage=me,Ze.buffer.dimension=3,Ze.buffer.byteLength=De;if(Ne=ot,!ot){switch(Ze.buffer.dtype){case au:case UL:Ne=au;break;case ou:case s1:Ne=ou;break;case Yo:case u1:Ne=Yo;break;default:D.raise("unsupported type for element array")}Ze.buffer.dtype=Ne}Ze.type=Ne,D(Ne!==Yo||!!N.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Pe=it;Pe<0&&(Pe=Ze.buffer.byteLength,Ne===ou?Pe>>=1:Ne===Yo&&(Pe>>=2)),Ze.vertCount=Pe;var Je=We;if(We<0){Je=ml;var _t=Ze.buffer.dimension;_t===1&&(Je=GL),_t===2&&(Je=FL),_t===3&&(Je=ml)}Ze.primType=Je}function et(Ze){de.elementsCount--,D(Ze.buffer!==null,"must not double destroy elements"),delete Ae[Ze.id],Ze.buffer.destroy(),Ze.buffer=null}function Be(Ze,ie){var me=$.create(null,tp,!0),We=new Re(me._buffer);de.elementsCount++;function it(De){if(!De)me(),We.primType=ml,We.vertCount=0,We.type=au;else if(typeof De=="number")me(De),We.primType=ml,We.vertCount=De|0,We.type=au;else{var ot=null,Ne=$L,Qe=-1,Pe=-1,Je=0,_t=0;Array.isArray(De)||t(De)||qi(De)?ot=De:(D.type(De,"object","invalid arguments for elements"),"data"in De&&(ot=De.data,D(Array.isArray(ot)||t(ot)||qi(ot),"invalid data for element buffer")),"usage"in De&&(D.parameter(De.usage,Pc,"invalid element buffer usage"),Ne=Pc[De.usage]),"primitive"in De&&(D.parameter(De.primitive,iu,"invalid element buffer primitive"),Qe=iu[De.primitive]),"count"in De&&(D(typeof De.count=="number"&&De.count>=0,"invalid vertex count for elements"),Pe=De.count|0),"type"in De&&(D.parameter(De.type,ye,"invalid buffer type"),_t=ye[De.type]),"length"in De?Je=De.length|0:(Je=Pe,_t===ou||_t===s1?Je*=2:(_t===Yo||_t===u1)&&(Je*=4))),Ke(We,ot,Ne,Qe,Pe,Je,_t)}return it}return it(Ze),it._reglType="elements",it._elements=We,it.subdata=function(De,ot){return me.subdata(De,ot),it},it.destroy=function(){et(We)},it}return{create:Be,createStream:je,destroyStream:ze,getElements:function(Ze){return typeof Ze=="function"&&Ze._elements instanceof Re?Ze._elements:null},clear:function(){Ci(Ae).forEach(et)}}}var l1=new Float32Array(1),WL=new Uint32Array(l1.buffer),jL=5123;function f1(A){for(var N=Br.allocType(jL,A.length),$=0;$<A.length;++$)if(isNaN(A[$]))N[$]=65535;else if(A[$]===1/0)N[$]=31744;else if(A[$]===-1/0)N[$]=64512;else{l1[0]=A[$];var de=WL[0],Ae=de>>>31<<15,ce=(de<<1>>>24)-127,ye=de>>13&(1<<10)-1;if(ce<-24)N[$]=Ae;else if(ce<-14){var Re=-14-ce;N[$]=Ae+(ye+(1<<10)>>Re)}else ce>15?N[$]=Ae+31744:N[$]=Ae+(ce+15<<10)+ye}return N}function sn(A){return Array.isArray(A)||t(A)}var c1=function(A){return!(A&A-1)&&!!A},XL=34467,ha=3553,rp=34067,Lc=34069,qo=6408,np=6406,Oc=6407,bl=6409,Rc=6410,h1=32854,ip=32855,d1=36194,HL=32819,YL=32820,qL=33635,KL=34042,ap=6402,Bc=34041,op=35904,sp=35906,su=36193,up=33776,lp=33777,fp=33778,cp=33779,v1=35986,p1=35987,g1=34798,y1=35840,m1=35841,b1=35842,x1=35843,_1=36196,uu=5121,hp=5123,dp=5125,xl=5126,ZL=10242,QL=10243,JL=10497,vp=33071,eO=33648,tO=10240,rO=10241,pp=9728,nO=9729,gp=9984,w1=9985,S1=9986,yp=9987,iO=33170,Gc=4352,aO=4353,oO=4354,sO=34046,uO=3317,lO=37440,fO=37441,cO=37443,E1=37444,_l=33984,hO=[gp,S1,w1,yp],Fc=[0,bl,Rc,Oc,qo],Li={};Li[bl]=Li[np]=Li[ap]=1,Li[Bc]=Li[Rc]=2,Li[Oc]=Li[op]=3,Li[qo]=Li[sp]=4;function lu(A){return"[object "+A+"]"}var C1=lu("HTMLCanvasElement"),A1=lu("OffscreenCanvas"),T1=lu("CanvasRenderingContext2D"),M1=lu("ImageBitmap"),I1=lu("HTMLImageElement"),k1=lu("HTMLVideoElement"),dO=Object.keys(Zv).concat([C1,A1,T1,M1,I1,k1]),fu=[];fu[uu]=1,fu[xl]=4,fu[su]=2,fu[hp]=2,fu[dp]=4;var Bn=[];Bn[h1]=2,Bn[ip]=2,Bn[d1]=2,Bn[Bc]=4,Bn[up]=.5,Bn[lp]=.5,Bn[fp]=1,Bn[cp]=1,Bn[v1]=.5,Bn[p1]=1,Bn[g1]=1,Bn[y1]=.5,Bn[m1]=.25,Bn[b1]=.5,Bn[x1]=.25,Bn[_1]=.5;function D1(A){return Array.isArray(A)&&(A.length===0||typeof A[0]=="number")}function P1(A){if(!Array.isArray(A))return!1;var N=A.length;return!(N===0||!sn(A[0]))}function Ko(A){return Object.prototype.toString.call(A)}function N1(A){return Ko(A)===C1}function L1(A){return Ko(A)===A1}function vO(A){return Ko(A)===T1}function pO(A){return Ko(A)===M1}function gO(A){return Ko(A)===I1}function yO(A){return Ko(A)===k1}function mp(A){if(!A)return!1;var N=Ko(A);return dO.indexOf(N)>=0?!0:D1(A)||P1(A)||qi(A)}function O1(A){return Zv[Object.prototype.toString.call(A)]|0}function mO(A,N){var $=N.length;switch(A.type){case uu:case hp:case dp:case xl:var de=Br.allocType(A.type,$);de.set(N),A.data=de;break;case su:A.data=f1(N);break;default:D.raise("unsupported texture type, must specify a typed array")}}function R1(A,N){return Br.allocType(A.type===su?xl:A.type,N)}function B1(A,N){A.type===su?(A.data=f1(N),Br.freeType(N)):A.data=N}function bO(A,N,$,de,Ae,ce){for(var ye=A.width,Re=A.height,Ue=A.channels,je=ye*Re*Ue,ze=R1(A,je),Ke=0,et=0;et<Re;++et)for(var Be=0;Be<ye;++Be)for(var Ze=0;Ze<Ue;++Ze)ze[Ke++]=N[$*Be+de*et+Ae*Ze+ce];B1(A,ze)}function Uc(A,N,$,de,Ae,ce){var ye;if(typeof Bn[A]!="undefined"?ye=Bn[A]:ye=Li[A]*fu[N],ce&&(ye*=6),Ae){for(var Re=0,Ue=$;Ue>=1;)Re+=ye*Ue*Ue,Ue/=2;return Re}else return ye*$*de}function xO(A,N,$,de,Ae,ce,ye){var Re={"don't care":Gc,"dont care":Gc,nice:oO,fast:aO},Ue={repeat:JL,clamp:vp,mirror:eO},je={nearest:pp,linear:nO},ze=n({mipmap:yp,"nearest mipmap nearest":gp,"linear mipmap nearest":w1,"nearest mipmap linear":S1,"linear mipmap linear":yp},je),Ke={none:0,browser:E1},et={uint8:uu,rgba4:HL,rgb565:qL,"rgb5 a1":YL},Be={alpha:np,luminance:bl,"luminance alpha":Rc,rgb:Oc,rgba:qo,rgba4:h1,"rgb5 a1":ip,rgb565:d1},Ze={};N.ext_srgb&&(Be.srgb=op,Be.srgba=sp),N.oes_texture_float&&(et.float32=et.float=xl),N.oes_texture_half_float&&(et.float16=et["half float"]=su),N.webgl_depth_texture&&(n(Be,{depth:ap,"depth stencil":Bc}),n(et,{uint16:hp,uint32:dp,"depth stencil":KL})),N.webgl_compressed_texture_s3tc&&n(Ze,{"rgb s3tc dxt1":up,"rgba s3tc dxt1":lp,"rgba s3tc dxt3":fp,"rgba s3tc dxt5":cp}),N.webgl_compressed_texture_atc&&n(Ze,{"rgb atc":v1,"rgba atc explicit alpha":p1,"rgba atc interpolated alpha":g1}),N.webgl_compressed_texture_pvrtc&&n(Ze,{"rgb pvrtc 4bppv1":y1,"rgb pvrtc 2bppv1":m1,"rgba pvrtc 4bppv1":b1,"rgba pvrtc 2bppv1":x1}),N.webgl_compressed_texture_etc1&&(Ze["rgb etc1"]=_1);var ie=Array.prototype.slice.call(A.getParameter(XL));Object.keys(Ze).forEach(function(z){var ve=Ze[z];ie.indexOf(ve)>=0&&(Be[z]=ve)});var me=Object.keys(Be);$.textureFormats=me;var We=[];Object.keys(Be).forEach(function(z){var ve=Be[z];We[ve]=z});var it=[];Object.keys(et).forEach(function(z){var ve=et[z];it[ve]=z});var De=[];Object.keys(je).forEach(function(z){var ve=je[z];De[ve]=z});var ot=[];Object.keys(ze).forEach(function(z){var ve=ze[z];ot[ve]=z});var Ne=[];Object.keys(Ue).forEach(function(z){var ve=Ue[z];Ne[ve]=z});var Qe=me.reduce(function(z,ve){var fe=Be[ve];return fe===bl||fe===np||fe===bl||fe===Rc||fe===ap||fe===Bc||N.ext_srgb&&(fe===op||fe===sp)?z[fe]=fe:fe===ip||ve.indexOf("rgba")>=0?z[fe]=qo:z[fe]=Oc,z},{});function Pe(){this.internalformat=qo,this.format=qo,this.type=uu,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=E1,this.width=0,this.height=0,this.channels=0}function Je(z,ve){z.internalformat=ve.internalformat,z.format=ve.format,z.type=ve.type,z.compressed=ve.compressed,z.premultiplyAlpha=ve.premultiplyAlpha,z.flipY=ve.flipY,z.unpackAlignment=ve.unpackAlignment,z.colorSpace=ve.colorSpace,z.width=ve.width,z.height=ve.height,z.channels=ve.channels}function _t(z,ve){if(!(typeof ve!="object"||!ve)){if("premultiplyAlpha"in ve&&(D.type(ve.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),z.premultiplyAlpha=ve.premultiplyAlpha),"flipY"in ve&&(D.type(ve.flipY,"boolean","invalid texture flip"),z.flipY=ve.flipY),"alignment"in ve&&(D.oneOf(ve.alignment,[1,2,4,8],"invalid texture unpack alignment"),z.unpackAlignment=ve.alignment),"colorSpace"in ve&&(D.parameter(ve.colorSpace,Ke,"invalid colorSpace"),z.colorSpace=Ke[ve.colorSpace]),"type"in ve){var fe=ve.type;D(N.oes_texture_float||!(fe==="float"||fe==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),D(N.oes_texture_half_float||!(fe==="half float"||fe==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),D(N.webgl_depth_texture||!(fe==="uint16"||fe==="uint32"||fe==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),D.parameter(fe,et,"invalid texture type"),z.type=et[fe]}var st=z.width,tr=z.height,B=z.channels,P=!1;"shape"in ve?(D(Array.isArray(ve.shape)&&ve.shape.length>=2,"shape must be an array"),st=ve.shape[0],tr=ve.shape[1],ve.shape.length===3&&(B=ve.shape[2],D(B>0&&B<=4,"invalid number of channels"),P=!0),D(st>=0&&st<=$.maxTextureSize,"invalid width"),D(tr>=0&&tr<=$.maxTextureSize,"invalid height")):("radius"in ve&&(st=tr=ve.radius,D(st>=0&&st<=$.maxTextureSize,"invalid radius")),"width"in ve&&(st=ve.width,D(st>=0&&st<=$.maxTextureSize,"invalid width")),"height"in ve&&(tr=ve.height,D(tr>=0&&tr<=$.maxTextureSize,"invalid height")),"channels"in ve&&(B=ve.channels,D(B>0&&B<=4,"invalid number of channels"),P=!0)),z.width=st|0,z.height=tr|0,z.channels=B|0;var j=!1;if("format"in ve){var re=ve.format;D(N.webgl_depth_texture||!(re==="depth"||re==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),D.parameter(re,Be,"invalid texture format");var oe=z.internalformat=Be[re];z.format=Qe[oe],re in et&&("type"in ve||(z.type=et[re])),re in Ze&&(z.compressed=!0),j=!0}!P&&j?z.channels=Li[z.format]:P&&!j?z.channels!==Fc[z.format]&&(z.format=z.internalformat=Fc[z.channels]):j&&P&&D(z.channels===Li[z.format],"number of channels inconsistent with specified format")}}function Ft(z){A.pixelStorei(lO,z.flipY),A.pixelStorei(fO,z.premultiplyAlpha),A.pixelStorei(cO,z.colorSpace),A.pixelStorei(uO,z.unpackAlignment)}function tt(){Pe.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function He(z,ve){var fe=null;if(mp(ve)?fe=ve:ve&&(D.type(ve,"object","invalid pixel data type"),_t(z,ve),"x"in ve&&(z.xOffset=ve.x|0),"y"in ve&&(z.yOffset=ve.y|0),mp(ve.data)&&(fe=ve.data)),D(!z.compressed||fe instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),ve.copy){D(!fe,"can not specify copy and data field for the same texture");var st=Ae.viewportWidth,tr=Ae.viewportHeight;z.width=z.width||st-z.xOffset,z.height=z.height||tr-z.yOffset,z.needsCopy=!0,D(z.xOffset>=0&&z.xOffset<st&&z.yOffset>=0&&z.yOffset<tr&&z.width>0&&z.width<=st&&z.height>0&&z.height<=tr,"copy texture read out of bounds")}else if(!fe)z.width=z.width||1,z.height=z.height||1,z.channels=z.channels||4;else if(t(fe))z.channels=z.channels||4,z.data=fe,!("type"in ve)&&z.type===uu&&(z.type=O1(fe));else if(D1(fe))z.channels=z.channels||4,mO(z,fe),z.alignment=1,z.needsFree=!0;else if(qi(fe)){var B=fe.data;!Array.isArray(B)&&z.type===uu&&(z.type=O1(B));var P=fe.shape,j=fe.stride,re,oe,Y,H,Q,G;P.length===3?(Y=P[2],G=j[2]):(D(P.length===2,"invalid ndarray pixel data, must be 2 or 3D"),Y=1,G=1),re=P[0],oe=P[1],H=j[0],Q=j[1],z.alignment=1,z.width=re,z.height=oe,z.channels=Y,z.format=z.internalformat=Fc[Y],z.needsFree=!0,bO(z,B,H,Q,G,fe.offset)}else if(N1(fe)||L1(fe)||vO(fe))N1(fe)||L1(fe)?z.element=fe:z.element=fe.canvas,z.width=z.element.width,z.height=z.element.height,z.channels=4;else if(pO(fe))z.element=fe,z.width=fe.width,z.height=fe.height,z.channels=4;else if(gO(fe))z.element=fe,z.width=fe.naturalWidth,z.height=fe.naturalHeight,z.channels=4;else if(yO(fe))z.element=fe,z.width=fe.videoWidth,z.height=fe.videoHeight,z.channels=4;else if(P1(fe)){var W=z.width||fe[0].length,R=z.height||fe.length,J=z.channels;sn(fe[0][0])?J=J||fe[0][0].length:J=J||1;for(var ue=Dc.shape(fe),Ee=1,Te=0;Te<ue.length;++Te)Ee*=ue[Te];var _e=R1(z,Ee);Dc.flatten(fe,ue,"",_e),B1(z,_e),z.alignment=1,z.width=W,z.height=R,z.channels=J,z.format=z.internalformat=Fc[J],z.needsFree=!0}z.type===xl?D($.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):z.type===su&&D($.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Ie(z,ve,fe){var st=z.element,tr=z.data,B=z.internalformat,P=z.format,j=z.type,re=z.width,oe=z.height;Ft(z),st?A.texImage2D(ve,fe,P,P,j,st):z.compressed?A.compressedTexImage2D(ve,fe,B,re,oe,0,tr):z.needsCopy?(de(),A.copyTexImage2D(ve,fe,P,z.xOffset,z.yOffset,re,oe,0)):A.texImage2D(ve,fe,P,re,oe,0,P,j,tr||null)}function Ot(z,ve,fe,st,tr){var B=z.element,P=z.data,j=z.internalformat,re=z.format,oe=z.type,Y=z.width,H=z.height;Ft(z),B?A.texSubImage2D(ve,tr,fe,st,re,oe,B):z.compressed?A.compressedTexSubImage2D(ve,tr,fe,st,j,Y,H,P):z.needsCopy?(de(),A.copyTexSubImage2D(ve,tr,fe,st,z.xOffset,z.yOffset,Y,H)):A.texSubImage2D(ve,tr,fe,st,Y,H,re,oe,P)}var Xt=[];function ht(){return Xt.pop()||new tt}function er(z){z.needsFree&&Br.freeType(z.data),tt.call(z),Xt.push(z)}function Ut(){Pe.call(this),this.genMipmaps=!1,this.mipmapHint=Gc,this.mipmask=0,this.images=Array(16)}function Kt(z,ve,fe){var st=z.images[0]=ht();z.mipmask=1,st.width=z.width=ve,st.height=z.height=fe,st.channels=z.channels=4}function hr(z,ve){var fe=null;if(mp(ve))fe=z.images[0]=ht(),Je(fe,z),He(fe,ve),z.mipmask=1;else if(_t(z,ve),Array.isArray(ve.mipmap))for(var st=ve.mipmap,tr=0;tr<st.length;++tr)fe=z.images[tr]=ht(),Je(fe,z),fe.width>>=tr,fe.height>>=tr,He(fe,st[tr]),z.mipmask|=1<<tr;else fe=z.images[0]=ht(),Je(fe,z),He(fe,ve),z.mipmask=1;Je(z,z.images[0]),z.compressed&&(z.internalformat===up||z.internalformat===lp||z.internalformat===fp||z.internalformat===cp)&&D(z.width%4==0&&z.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function dn(z,ve){for(var fe=z.images,st=0;st<fe.length;++st){if(!fe[st])return;Ie(fe[st],ve,st)}}var Tn=[];function ir(){var z=Tn.pop()||new Ut;Pe.call(z),z.mipmask=0;for(var ve=0;ve<16;++ve)z.images[ve]=null;return z}function _n(z){for(var ve=z.images,fe=0;fe<ve.length;++fe)ve[fe]&&er(ve[fe]),ve[fe]=null;Tn.push(z)}function jr(){this.minFilter=pp,this.magFilter=pp,this.wrapS=vp,this.wrapT=vp,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Gc}function vn(z,ve){if("min"in ve){var fe=ve.min;D.parameter(fe,ze),z.minFilter=ze[fe],hO.indexOf(z.minFilter)>=0&&!("faces"in ve)&&(z.genMipmaps=!0)}if("mag"in ve){var st=ve.mag;D.parameter(st,je),z.magFilter=je[st]}var tr=z.wrapS,B=z.wrapT;if("wrap"in ve){var P=ve.wrap;typeof P=="string"?(D.parameter(P,Ue),tr=B=Ue[P]):Array.isArray(P)&&(D.parameter(P[0],Ue),D.parameter(P[1],Ue),tr=Ue[P[0]],B=Ue[P[1]])}else{if("wrapS"in ve){var j=ve.wrapS;D.parameter(j,Ue),tr=Ue[j]}if("wrapT"in ve){var re=ve.wrapT;D.parameter(re,Ue),B=Ue[re]}}if(z.wrapS=tr,z.wrapT=B,"anisotropic"in ve){var oe=ve.anisotropic;D(typeof oe=="number"&&oe>=1&&oe<=$.maxAnisotropic,"aniso samples must be between 1 and "),z.anisotropic=ve.anisotropic}if("mipmap"in ve){var Y=!1;switch(typeof ve.mipmap){case"string":D.parameter(ve.mipmap,Re,"invalid mipmap hint"),z.mipmapHint=Re[ve.mipmap],z.genMipmaps=!0,Y=!0;break;case"boolean":Y=z.genMipmaps=ve.mipmap;break;case"object":D(Array.isArray(ve.mipmap),"invalid mipmap type"),z.genMipmaps=!1,Y=!0;break;default:D.raise("invalid mipmap type")}Y&&!("min"in ve)&&(z.minFilter=gp)}}function wn(z,ve){A.texParameteri(ve,rO,z.minFilter),A.texParameteri(ve,tO,z.magFilter),A.texParameteri(ve,ZL,z.wrapS),A.texParameteri(ve,QL,z.wrapT),N.ext_texture_filter_anisotropic&&A.texParameteri(ve,sO,z.anisotropic),z.genMipmaps&&(A.hint(iO,z.mipmapHint),A.generateMipmap(ve))}var Sn=0,In={},Gn=$.maxTextureUnits,un=Array(Gn).map(function(){return null});function Ht(z){Pe.call(this),this.mipmask=0,this.internalformat=qo,this.id=Sn++,this.refCount=1,this.target=z,this.texture=A.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new jr,ye.profile&&(this.stats={size:0})}function Fn(z){A.activeTexture(_l),A.bindTexture(z.target,z.texture)}function br(){var z=un[0];z?A.bindTexture(z.target,z.texture):A.bindTexture(ha,null)}function Mt(z){var ve=z.texture;D(ve,"must not double destroy texture");var fe=z.unit,st=z.target;fe>=0&&(A.activeTexture(_l+fe),A.bindTexture(st,null),un[fe]=null),A.deleteTexture(ve),z.texture=null,z.params=null,z.pixels=null,z.refCount=0,delete In[z.id],ce.textureCount--}n(Ht.prototype,{bind:function(){var z=this;z.bindCount+=1;var ve=z.unit;if(ve<0){for(var fe=0;fe<Gn;++fe){var st=un[fe];if(st){if(st.bindCount>0)continue;st.unit=-1}un[fe]=z,ve=fe;break}ve>=Gn&&D.raise("insufficient number of texture units"),ye.profile&&ce.maxTextureUnits<ve+1&&(ce.maxTextureUnits=ve+1),z.unit=ve,A.activeTexture(_l+ve),A.bindTexture(z.target,z.texture)}return ve},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Mt(this)}});function rr(z,ve){var fe=new Ht(ha);In[fe.id]=fe,ce.textureCount++;function st(P,j){var re=fe.texInfo;jr.call(re);var oe=ir();return typeof P=="number"?typeof j=="number"?Kt(oe,P|0,j|0):Kt(oe,P|0,P|0):P?(D.type(P,"object","invalid arguments to regl.texture"),vn(re,P),hr(oe,P)):Kt(oe,1,1),re.genMipmaps&&(oe.mipmask=(oe.width<<1)-1),fe.mipmask=oe.mipmask,Je(fe,oe),D.texture2D(re,oe,$),fe.internalformat=oe.internalformat,st.width=oe.width,st.height=oe.height,Fn(fe),dn(oe,ha),wn(re,ha),br(),_n(oe),ye.profile&&(fe.stats.size=Uc(fe.internalformat,fe.type,oe.width,oe.height,re.genMipmaps,!1)),st.format=We[fe.internalformat],st.type=it[fe.type],st.mag=De[re.magFilter],st.min=ot[re.minFilter],st.wrapS=Ne[re.wrapS],st.wrapT=Ne[re.wrapT],st}function tr(P,j,re,oe){D(!!P,"must specify image data");var Y=j|0,H=re|0,Q=oe|0,G=ht();return Je(G,fe),G.width=0,G.height=0,He(G,P),G.width=G.width||(fe.width>>Q)-Y,G.height=G.height||(fe.height>>Q)-H,D(fe.type===G.type&&fe.format===G.format&&fe.internalformat===G.internalformat,"incompatible format for texture.subimage"),D(Y>=0&&H>=0&&Y+G.width<=fe.width&&H+G.height<=fe.height,"texture.subimage write out of bounds"),D(fe.mipmask&1<<Q,"missing mipmap data"),D(G.data||G.element||G.needsCopy,"missing image data"),Fn(fe),Ot(G,ha,Y,H,Q),br(),er(G),st}function B(P,j){var re=P|0,oe=j|0||re;if(re===fe.width&&oe===fe.height)return st;st.width=fe.width=re,st.height=fe.height=oe,Fn(fe);for(var Y=0;fe.mipmask>>Y;++Y){var H=re>>Y,Q=oe>>Y;if(!H||!Q)break;A.texImage2D(ha,Y,fe.format,H,Q,0,fe.format,fe.type,null)}return br(),ye.profile&&(fe.stats.size=Uc(fe.internalformat,fe.type,re,oe,!1,!1)),st}return st(z,ve),st.subimage=tr,st.resize=B,st._reglType="texture2d",st._texture=fe,ye.profile&&(st.stats=fe.stats),st.destroy=function(){fe.decRef()},st}function sr(z,ve,fe,st,tr,B){var P=new Ht(rp);In[P.id]=P,ce.cubeCount++;var j=new Array(6);function re(H,Q,G,W,R,J){var ue,Ee=P.texInfo;for(jr.call(Ee),ue=0;ue<6;++ue)j[ue]=ir();if(typeof H=="number"||!H){var Te=H|0||1;for(ue=0;ue<6;++ue)Kt(j[ue],Te,Te)}else if(typeof H=="object")if(Q)hr(j[0],H),hr(j[1],Q),hr(j[2],G),hr(j[3],W),hr(j[4],R),hr(j[5],J);else if(vn(Ee,H),_t(P,H),"faces"in H){var _e=H.faces;for(D(Array.isArray(_e)&&_e.length===6,"cube faces must be a length 6 array"),ue=0;ue<6;++ue)D(typeof _e[ue]=="object"&&!!_e[ue],"invalid input for cube map face"),Je(j[ue],P),hr(j[ue],_e[ue])}else for(ue=0;ue<6;++ue)hr(j[ue],H);else D.raise("invalid arguments to cube map");for(Je(P,j[0]),$.npotTextureCube||D(c1(P.width)&&c1(P.height),"your browser does not support non power or two texture dimensions"),Ee.genMipmaps?P.mipmask=(j[0].width<<1)-1:P.mipmask=j[0].mipmask,D.textureCube(P,Ee,j,$),P.internalformat=j[0].internalformat,re.width=j[0].width,re.height=j[0].height,Fn(P),ue=0;ue<6;++ue)dn(j[ue],Lc+ue);for(wn(Ee,rp),br(),ye.profile&&(P.stats.size=Uc(P.internalformat,P.type,re.width,re.height,Ee.genMipmaps,!0)),re.format=We[P.internalformat],re.type=it[P.type],re.mag=De[Ee.magFilter],re.min=ot[Ee.minFilter],re.wrapS=Ne[Ee.wrapS],re.wrapT=Ne[Ee.wrapT],ue=0;ue<6;++ue)_n(j[ue]);return re}function oe(H,Q,G,W,R){D(!!Q,"must specify image data"),D(typeof H=="number"&&H===(H|0)&&H>=0&&H<6,"invalid face");var J=G|0,ue=W|0,Ee=R|0,Te=ht();return Je(Te,P),Te.width=0,Te.height=0,He(Te,Q),Te.width=Te.width||(P.width>>Ee)-J,Te.height=Te.height||(P.height>>Ee)-ue,D(P.type===Te.type&&P.format===Te.format&&P.internalformat===Te.internalformat,"incompatible format for texture.subimage"),D(J>=0&&ue>=0&&J+Te.width<=P.width&&ue+Te.height<=P.height,"texture.subimage write out of bounds"),D(P.mipmask&1<<Ee,"missing mipmap data"),D(Te.data||Te.element||Te.needsCopy,"missing image data"),Fn(P),Ot(Te,Lc+H,J,ue,Ee),br(),er(Te),re}function Y(H){var Q=H|0;if(Q!==P.width){re.width=P.width=Q,re.height=P.height=Q,Fn(P);for(var G=0;G<6;++G)for(var W=0;P.mipmask>>W;++W)A.texImage2D(Lc+G,W,P.format,Q>>W,Q>>W,0,P.format,P.type,null);return br(),ye.profile&&(P.stats.size=Uc(P.internalformat,P.type,re.width,re.height,!1,!0)),re}}return re(z,ve,fe,st,tr,B),re.subimage=oe,re.resize=Y,re._reglType="textureCube",re._texture=P,ye.profile&&(re.stats=P.stats),re.destroy=function(){P.decRef()},re}function ln(){for(var z=0;z<Gn;++z)A.activeTexture(_l+z),A.bindTexture(ha,null),un[z]=null;Ci(In).forEach(Mt),ce.cubeCount=0,ce.textureCount=0}ye.profile&&(ce.getTotalTextureSize=function(){var z=0;return Object.keys(In).forEach(function(ve){z+=In[ve].stats.size}),z});function va(){for(var z=0;z<Gn;++z){var ve=un[z];ve&&(ve.bindCount=0,ve.unit=-1,un[z]=null)}Ci(In).forEach(function(fe){fe.texture=A.createTexture(),A.bindTexture(fe.target,fe.texture);for(var st=0;st<32;++st)if((fe.mipmask&1<<st)!=0)if(fe.target===ha)A.texImage2D(ha,st,fe.internalformat,fe.width>>st,fe.height>>st,0,fe.internalformat,fe.type,null);else for(var tr=0;tr<6;++tr)A.texImage2D(Lc+tr,st,fe.internalformat,fe.width>>st,fe.height>>st,0,fe.internalformat,fe.type,null);wn(fe.texInfo,fe.target)})}function ns(){for(var z=0;z<Gn;++z){var ve=un[z];ve&&(ve.bindCount=0,ve.unit=-1,un[z]=null),A.activeTexture(_l+z),A.bindTexture(ha,null),A.bindTexture(rp,null)}}return{create2D:rr,createCube:sr,clear:ln,getTexture:function(z){return null},restore:va,refresh:ns}}var ho=36161,zc=32854,G1=32855,F1=36194,U1=33189,z1=36168,$1=34041,V1=35907,W1=34836,j1=34842,X1=34843,Ki=[];Ki[zc]=2,Ki[G1]=2,Ki[F1]=2,Ki[U1]=2,Ki[z1]=1,Ki[$1]=4,Ki[V1]=4,Ki[W1]=16,Ki[j1]=8,Ki[X1]=6;function H1(A,N,$){return Ki[A]*N*$}var _O=function(A,N,$,de,Ae){var ce={rgba4:zc,rgb565:F1,"rgb5 a1":G1,depth:U1,stencil:z1,"depth stencil":$1};N.ext_srgb&&(ce.srgba=V1),N.ext_color_buffer_half_float&&(ce.rgba16f=j1,ce.rgb16f=X1),N.webgl_color_buffer_float&&(ce.rgba32f=W1);var ye=[];Object.keys(ce).forEach(function(Be){var Ze=ce[Be];ye[Ze]=Be});var Re=0,Ue={};function je(Be){this.id=Re++,this.refCount=1,this.renderbuffer=Be,this.format=zc,this.width=0,this.height=0,Ae.profile&&(this.stats={size:0})}je.prototype.decRef=function(){--this.refCount<=0&&ze(this)};function ze(Be){var Ze=Be.renderbuffer;D(Ze,"must not double destroy renderbuffer"),A.bindRenderbuffer(ho,null),A.deleteRenderbuffer(Ze),Be.renderbuffer=null,Be.refCount=0,delete Ue[Be.id],de.renderbufferCount--}function Ke(Be,Ze){var ie=new je(A.createRenderbuffer());Ue[ie.id]=ie,de.renderbufferCount++;function me(it,De){var ot=0,Ne=0,Qe=zc;if(typeof it=="object"&&it){var Pe=it;if("shape"in Pe){var Je=Pe.shape;D(Array.isArray(Je)&&Je.length>=2,"invalid renderbuffer shape"),ot=Je[0]|0,Ne=Je[1]|0}else"radius"in Pe&&(ot=Ne=Pe.radius|0),"width"in Pe&&(ot=Pe.width|0),"height"in Pe&&(Ne=Pe.height|0);"format"in Pe&&(D.parameter(Pe.format,ce,"invalid renderbuffer format"),Qe=ce[Pe.format])}else typeof it=="number"?(ot=it|0,typeof De=="number"?Ne=De|0:Ne=ot):it?D.raise("invalid arguments to renderbuffer constructor"):ot=Ne=1;if(D(ot>0&&Ne>0&&ot<=$.maxRenderbufferSize&&Ne<=$.maxRenderbufferSize,"invalid renderbuffer size"),!(ot===ie.width&&Ne===ie.height&&Qe===ie.format))return me.width=ie.width=ot,me.height=ie.height=Ne,ie.format=Qe,A.bindRenderbuffer(ho,ie.renderbuffer),A.renderbufferStorage(ho,Qe,ot,Ne),D(A.getError()===0,"invalid render buffer format"),Ae.profile&&(ie.stats.size=H1(ie.format,ie.width,ie.height)),me.format=ye[ie.format],me}function We(it,De){var ot=it|0,Ne=De|0||ot;return ot===ie.width&&Ne===ie.height||(D(ot>0&&Ne>0&&ot<=$.maxRenderbufferSize&&Ne<=$.maxRenderbufferSize,"invalid renderbuffer size"),me.width=ie.width=ot,me.height=ie.height=Ne,A.bindRenderbuffer(ho,ie.renderbuffer),A.renderbufferStorage(ho,ie.format,ot,Ne),D(A.getError()===0,"invalid render buffer format"),Ae.profile&&(ie.stats.size=H1(ie.format,ie.width,ie.height))),me}return me(Be,Ze),me.resize=We,me._reglType="renderbuffer",me._renderbuffer=ie,Ae.profile&&(me.stats=ie.stats),me.destroy=function(){ie.decRef()},me}Ae.profile&&(de.getTotalRenderbufferSize=function(){var Be=0;return Object.keys(Ue).forEach(function(Ze){Be+=Ue[Ze].stats.size}),Be});function et(){Ci(Ue).forEach(function(Be){Be.renderbuffer=A.createRenderbuffer(),A.bindRenderbuffer(ho,Be.renderbuffer),A.renderbufferStorage(ho,Be.format,Be.width,Be.height)}),A.bindRenderbuffer(ho,null)}return{create:Ke,clear:function(){Ci(Ue).forEach(ze)},restore:et}},Ua=36160,bp=36161,Zo=3553,$c=34069,Y1=36064,q1=36096,K1=36128,Z1=33306,Q1=36053,wO=36054,SO=36055,EO=36057,CO=36061,AO=36193,TO=5121,MO=5126,J1=6407,eb=6408,IO=6402,kO=[J1,eb],xp=[];xp[eb]=4,xp[J1]=3;var Vc=[];Vc[TO]=1,Vc[MO]=4,Vc[AO]=2;var DO=32854,PO=32855,NO=36194,LO=33189,OO=36168,tb=34041,RO=35907,BO=34836,GO=34842,FO=34843,UO=[DO,PO,NO,RO,GO,FO,BO],cu={};cu[Q1]="complete",cu[wO]="incomplete attachment",cu[EO]="incomplete dimensions",cu[SO]="incomplete, missing attachment",cu[CO]="unsupported";function zO(A,N,$,de,Ae,ce){var ye={cur:null,next:null,dirty:!1,setFBO:null},Re=["rgba"],Ue=["rgba4","rgb565","rgb5 a1"];N.ext_srgb&&Ue.push("srgba"),N.ext_color_buffer_half_float&&Ue.push("rgba16f","rgb16f"),N.webgl_color_buffer_float&&Ue.push("rgba32f");var je=["uint8"];N.oes_texture_half_float&&je.push("half float","float16"),N.oes_texture_float&&je.push("float","float32");function ze(tt,He,Ie){this.target=tt,this.texture=He,this.renderbuffer=Ie;var Ot=0,Xt=0;He?(Ot=He.width,Xt=He.height):Ie&&(Ot=Ie.width,Xt=Ie.height),this.width=Ot,this.height=Xt}function Ke(tt){tt&&(tt.texture&&tt.texture._texture.decRef(),tt.renderbuffer&&tt.renderbuffer._renderbuffer.decRef())}function et(tt,He,Ie){if(!!tt)if(tt.texture){var Ot=tt.texture._texture,Xt=Math.max(1,Ot.width),ht=Math.max(1,Ot.height);D(Xt===He&&ht===Ie,"inconsistent width/height for supplied texture"),Ot.refCount+=1}else{var er=tt.renderbuffer._renderbuffer;D(er.width===He&&er.height===Ie,"inconsistent width/height for renderbuffer"),er.refCount+=1}}function Be(tt,He){He&&(He.texture?A.framebufferTexture2D(Ua,tt,He.target,He.texture._texture.texture,0):A.framebufferRenderbuffer(Ua,tt,bp,He.renderbuffer._renderbuffer.renderbuffer))}function Ze(tt){var He=Zo,Ie=null,Ot=null,Xt=tt;typeof tt=="object"&&(Xt=tt.data,"target"in tt&&(He=tt.target|0)),D.type(Xt,"function","invalid attachment data");var ht=Xt._reglType;return ht==="texture2d"?(Ie=Xt,D(He===Zo)):ht==="textureCube"?(Ie=Xt,D(He>=$c&&He<$c+6,"invalid cube map target")):ht==="renderbuffer"?(Ot=Xt,He=bp):D.raise("invalid regl object for attachment"),new ze(He,Ie,Ot)}function ie(tt,He,Ie,Ot,Xt){if(Ie){var ht=de.create2D({width:tt,height:He,format:Ot,type:Xt});return ht._texture.refCount=0,new ze(Zo,ht,null)}else{var er=Ae.create({width:tt,height:He,format:Ot});return er._renderbuffer.refCount=0,new ze(bp,null,er)}}function me(tt){return tt&&(tt.texture||tt.renderbuffer)}function We(tt,He,Ie){tt&&(tt.texture?tt.texture.resize(He,Ie):tt.renderbuffer&&tt.renderbuffer.resize(He,Ie),tt.width=He,tt.height=Ie)}var it=0,De={};function ot(){this.id=it++,De[this.id]=this,this.framebuffer=A.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Ne(tt){tt.colorAttachments.forEach(Ke),Ke(tt.depthAttachment),Ke(tt.stencilAttachment),Ke(tt.depthStencilAttachment)}function Qe(tt){var He=tt.framebuffer;D(He,"must not double destroy framebuffer"),A.deleteFramebuffer(He),tt.framebuffer=null,ce.framebufferCount--,delete De[tt.id]}function Pe(tt){var He;A.bindFramebuffer(Ua,tt.framebuffer);var Ie=tt.colorAttachments;for(He=0;He<Ie.length;++He)Be(Y1+He,Ie[He]);for(He=Ie.length;He<$.maxColorAttachments;++He)A.framebufferTexture2D(Ua,Y1+He,Zo,null,0);A.framebufferTexture2D(Ua,Z1,Zo,null,0),A.framebufferTexture2D(Ua,q1,Zo,null,0),A.framebufferTexture2D(Ua,K1,Zo,null,0),Be(q1,tt.depthAttachment),Be(K1,tt.stencilAttachment),Be(Z1,tt.depthStencilAttachment);var Ot=A.checkFramebufferStatus(Ua);!A.isContextLost()&&Ot!==Q1&&D.raise("framebuffer configuration not supported, status = "+cu[Ot]),A.bindFramebuffer(Ua,ye.next?ye.next.framebuffer:null),ye.cur=ye.next,A.getError()}function Je(tt,He){var Ie=new ot;ce.framebufferCount++;function Ot(ht,er){var Ut;D(ye.next!==Ie,"can not update framebuffer which is currently in use");var Kt=0,hr=0,dn=!0,Tn=!0,ir=null,_n=!0,jr="rgba",vn="uint8",wn=1,Sn=null,In=null,Gn=null,un=!1;if(typeof ht=="number")Kt=ht|0,hr=er|0||Kt;else if(!ht)Kt=hr=1;else{D.type(ht,"object","invalid arguments for framebuffer");var Ht=ht;if("shape"in Ht){var Fn=Ht.shape;D(Array.isArray(Fn)&&Fn.length>=2,"invalid shape for framebuffer"),Kt=Fn[0],hr=Fn[1]}else"radius"in Ht&&(Kt=hr=Ht.radius),"width"in Ht&&(Kt=Ht.width),"height"in Ht&&(hr=Ht.height);("color"in Ht||"colors"in Ht)&&(ir=Ht.color||Ht.colors,Array.isArray(ir)&&D(ir.length===1||N.webgl_draw_buffers,"multiple render targets not supported")),ir||("colorCount"in Ht&&(wn=Ht.colorCount|0,D(wn>0,"invalid color buffer count")),"colorTexture"in Ht&&(_n=!!Ht.colorTexture,jr="rgba4"),"colorType"in Ht&&(vn=Ht.colorType,_n?(D(N.oes_texture_float||!(vn==="float"||vn==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),D(N.oes_texture_half_float||!(vn==="half float"||vn==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):vn==="half float"||vn==="float16"?(D(N.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),jr="rgba16f"):(vn==="float"||vn==="float32")&&(D(N.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),jr="rgba32f"),D.oneOf(vn,je,"invalid color type")),"colorFormat"in Ht&&(jr=Ht.colorFormat,Re.indexOf(jr)>=0?_n=!0:Ue.indexOf(jr)>=0?_n=!1:_n?D.oneOf(Ht.colorFormat,Re,"invalid color format for texture"):D.oneOf(Ht.colorFormat,Ue,"invalid color format for renderbuffer"))),("depthTexture"in Ht||"depthStencilTexture"in Ht)&&(un=!!(Ht.depthTexture||Ht.depthStencilTexture),D(!un||N.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Ht&&(typeof Ht.depth=="boolean"?dn=Ht.depth:(Sn=Ht.depth,Tn=!1)),"stencil"in Ht&&(typeof Ht.stencil=="boolean"?Tn=Ht.stencil:(In=Ht.stencil,dn=!1)),"depthStencil"in Ht&&(typeof Ht.depthStencil=="boolean"?dn=Tn=Ht.depthStencil:(Gn=Ht.depthStencil,dn=!1,Tn=!1))}var br=null,Mt=null,rr=null,sr=null;if(Array.isArray(ir))br=ir.map(Ze);else if(ir)br=[Ze(ir)];else for(br=new Array(wn),Ut=0;Ut<wn;++Ut)br[Ut]=ie(Kt,hr,_n,jr,vn);D(N.webgl_draw_buffers||br.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),D(br.length<=$.maxColorAttachments,"too many color attachments, not supported"),Kt=Kt||br[0].width,hr=hr||br[0].height,Sn?Mt=Ze(Sn):dn&&!Tn&&(Mt=ie(Kt,hr,un,"depth","uint32")),In?rr=Ze(In):Tn&&!dn&&(rr=ie(Kt,hr,!1,"stencil","uint8")),Gn?sr=Ze(Gn):!Sn&&!In&&Tn&&dn&&(sr=ie(Kt,hr,un,"depth stencil","depth stencil")),D(!!Sn+!!In+!!Gn<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var ln=null;for(Ut=0;Ut<br.length;++Ut)if(et(br[Ut],Kt,hr),D(!br[Ut]||br[Ut].texture&&kO.indexOf(br[Ut].texture._texture.format)>=0||br[Ut].renderbuffer&&UO.indexOf(br[Ut].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Ut+" is invalid"),br[Ut]&&br[Ut].texture){var va=xp[br[Ut].texture._texture.format]*Vc[br[Ut].texture._texture.type];ln===null?ln=va:D(ln===va,"all color attachments much have the same number of bits per pixel.")}return et(Mt,Kt,hr),D(!Mt||Mt.texture&&Mt.texture._texture.format===IO||Mt.renderbuffer&&Mt.renderbuffer._renderbuffer.format===LO,"invalid depth attachment for framebuffer object"),et(rr,Kt,hr),D(!rr||rr.renderbuffer&&rr.renderbuffer._renderbuffer.format===OO,"invalid stencil attachment for framebuffer object"),et(sr,Kt,hr),D(!sr||sr.texture&&sr.texture._texture.format===tb||sr.renderbuffer&&sr.renderbuffer._renderbuffer.format===tb,"invalid depth-stencil attachment for framebuffer object"),Ne(Ie),Ie.width=Kt,Ie.height=hr,Ie.colorAttachments=br,Ie.depthAttachment=Mt,Ie.stencilAttachment=rr,Ie.depthStencilAttachment=sr,Ot.color=br.map(me),Ot.depth=me(Mt),Ot.stencil=me(rr),Ot.depthStencil=me(sr),Ot.width=Ie.width,Ot.height=Ie.height,Pe(Ie),Ot}function Xt(ht,er){D(ye.next!==Ie,"can not resize a framebuffer which is currently in use");var Ut=Math.max(ht|0,1),Kt=Math.max(er|0||Ut,1);if(Ut===Ie.width&&Kt===Ie.height)return Ot;for(var hr=Ie.colorAttachments,dn=0;dn<hr.length;++dn)We(hr[dn],Ut,Kt);return We(Ie.depthAttachment,Ut,Kt),We(Ie.stencilAttachment,Ut,Kt),We(Ie.depthStencilAttachment,Ut,Kt),Ie.width=Ot.width=Ut,Ie.height=Ot.height=Kt,Pe(Ie),Ot}return Ot(tt,He),n(Ot,{resize:Xt,_reglType:"framebuffer",_framebuffer:Ie,destroy:function(){Qe(Ie),Ne(Ie)},use:function(ht){ye.setFBO({framebuffer:Ot},ht)}})}function _t(tt){var He=Array(6);function Ie(Xt){var ht;D(He.indexOf(ye.next)<0,"can not update framebuffer which is currently in use");var er={color:null},Ut=0,Kt=null,hr="rgba",dn="uint8",Tn=1;if(typeof Xt=="number")Ut=Xt|0;else if(!Xt)Ut=1;else{D.type(Xt,"object","invalid arguments for framebuffer");var ir=Xt;if("shape"in ir){var _n=ir.shape;D(Array.isArray(_n)&&_n.length>=2,"invalid shape for framebuffer"),D(_n[0]===_n[1],"cube framebuffer must be square"),Ut=_n[0]}else"radius"in ir&&(Ut=ir.radius|0),"width"in ir?(Ut=ir.width|0,"height"in ir&&D(ir.height===Ut,"must be square")):"height"in ir&&(Ut=ir.height|0);("color"in ir||"colors"in ir)&&(Kt=ir.color||ir.colors,Array.isArray(Kt)&&D(Kt.length===1||N.webgl_draw_buffers,"multiple render targets not supported")),Kt||("colorCount"in ir&&(Tn=ir.colorCount|0,D(Tn>0,"invalid color buffer count")),"colorType"in ir&&(D.oneOf(ir.colorType,je,"invalid color type"),dn=ir.colorType),"colorFormat"in ir&&(hr=ir.colorFormat,D.oneOf(ir.colorFormat,Re,"invalid color format for texture"))),"depth"in ir&&(er.depth=ir.depth),"stencil"in ir&&(er.stencil=ir.stencil),"depthStencil"in ir&&(er.depthStencil=ir.depthStencil)}var jr;if(Kt)if(Array.isArray(Kt))for(jr=[],ht=0;ht<Kt.length;++ht)jr[ht]=Kt[ht];else jr=[Kt];else{jr=Array(Tn);var vn={radius:Ut,format:hr,type:dn};for(ht=0;ht<Tn;++ht)jr[ht]=de.createCube(vn)}for(er.color=Array(jr.length),ht=0;ht<jr.length;++ht){var wn=jr[ht];D(typeof wn=="function"&&wn._reglType==="textureCube","invalid cube map"),Ut=Ut||wn.width,D(wn.width===Ut&&wn.height===Ut,"invalid cube map shape"),er.color[ht]={target:$c,data:jr[ht]}}for(ht=0;ht<6;++ht){for(var Sn=0;Sn<jr.length;++Sn)er.color[Sn].target=$c+ht;ht>0&&(er.depth=He[0].depth,er.stencil=He[0].stencil,er.depthStencil=He[0].depthStencil),He[ht]?He[ht](er):He[ht]=Je(er)}return n(Ie,{width:Ut,height:Ut,color:jr})}function Ot(Xt){var ht,er=Xt|0;if(D(er>0&&er<=$.maxCubeMapSize,"invalid radius for cube fbo"),er===Ie.width)return Ie;var Ut=Ie.color;for(ht=0;ht<Ut.length;++ht)Ut[ht].resize(er);for(ht=0;ht<6;++ht)He[ht].resize(er);return Ie.width=Ie.height=er,Ie}return Ie(tt),n(Ie,{faces:He,resize:Ot,_reglType:"framebufferCube",destroy:function(){He.forEach(function(Xt){Xt.destroy()})}})}function Ft(){ye.cur=null,ye.next=null,ye.dirty=!0,Ci(De).forEach(function(tt){tt.framebuffer=A.createFramebuffer(),Pe(tt)})}return n(ye,{getFramebuffer:function(tt){if(typeof tt=="function"&&tt._reglType==="framebuffer"){var He=tt._framebuffer;if(He instanceof ot)return He}return null},create:Je,createCube:_t,clear:function(){Ci(De).forEach(Qe)},restore:Ft})}var $O=5126,rb=34962;function _p(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=$O,this.offset=0,this.stride=0,this.divisor=0}function VO(A,N,$,de,Ae){for(var ce=$.maxAttributes,ye=new Array(ce),Re=0;Re<ce;++Re)ye[Re]=new _p;var Ue=0,je={},ze={Record:_p,scope:{},state:ye,currentVAO:null,targetVAO:null,restore:et()?De:function(){},createVAO:ot,getVAO:Ze,destroyBuffer:Ke,setVAO:et()?ie:me,clear:et()?We:function(){}};function Ke(Ne){for(var Qe=0;Qe<ye.length;++Qe){var Pe=ye[Qe];Pe.buffer===Ne&&(A.disableVertexAttribArray(Qe),Pe.buffer=null)}}function et(){return N.oes_vertex_array_object}function Be(){return N.angle_instanced_arrays}function Ze(Ne){return typeof Ne=="function"&&Ne._vao?Ne._vao:null}function ie(Ne){if(Ne!==ze.currentVAO){var Qe=et();Ne?Qe.bindVertexArrayOES(Ne.vao):Qe.bindVertexArrayOES(null),ze.currentVAO=Ne}}function me(Ne){if(Ne!==ze.currentVAO){if(Ne)Ne.bindAttrs();else for(var Qe=Be(),Pe=0;Pe<ye.length;++Pe){var Je=ye[Pe];Je.buffer?(A.enableVertexAttribArray(Pe),A.vertexAttribPointer(Pe,Je.size,Je.type,Je.normalized,Je.stride,Je.offfset),Qe&&Je.divisor&&Qe.vertexAttribDivisorANGLE(Pe,Je.divisor)):(A.disableVertexAttribArray(Pe),A.vertexAttrib4f(Pe,Je.x,Je.y,Je.z,Je.w))}ze.currentVAO=Ne}}function We(){Ci(je).forEach(function(Ne){Ne.destroy()})}function it(){this.id=++Ue,this.attributes=[];var Ne=et();Ne?this.vao=Ne.createVertexArrayOES():this.vao=null,je[this.id]=this,this.buffers=[]}it.prototype.bindAttrs=function(){for(var Ne=Be(),Qe=this.attributes,Pe=0;Pe<Qe.length;++Pe){var Je=Qe[Pe];Je.buffer?(A.enableVertexAttribArray(Pe),A.bindBuffer(rb,Je.buffer.buffer),A.vertexAttribPointer(Pe,Je.size,Je.type,Je.normalized,Je.stride,Je.offset),Ne&&Je.divisor&&Ne.vertexAttribDivisorANGLE(Pe,Je.divisor)):(A.disableVertexAttribArray(Pe),A.vertexAttrib4f(Pe,Je.x,Je.y,Je.z,Je.w))}for(var _t=Qe.length;_t<ce;++_t)A.disableVertexAttribArray(_t)},it.prototype.refresh=function(){var Ne=et();Ne&&(Ne.bindVertexArrayOES(this.vao),this.bindAttrs(),ze.currentVAO=this)},it.prototype.destroy=function(){if(this.vao){var Ne=et();this===ze.currentVAO&&(ze.currentVAO=null,Ne.bindVertexArrayOES(null)),Ne.deleteVertexArrayOES(this.vao),this.vao=null}je[this.id]&&(delete je[this.id],de.vaoCount-=1)};function De(){var Ne=et();Ne&&Ci(je).forEach(function(Qe){Qe.refresh()})}function ot(Ne){var Qe=new it;de.vaoCount+=1;function Pe(Je){D(Array.isArray(Je),"arguments to vertex array constructor must be an array"),D(Je.length<ce,"too many attributes"),D(Je.length>0,"must specify at least one attribute");var _t={},Ft=Qe.attributes;Ft.length=Je.length;for(var tt=0;tt<Je.length;++tt){var He=Je[tt],Ie=Ft[tt]=new _p,Ot=He.data||He;if(Array.isArray(Ot)||t(Ot)||qi(Ot)){var Xt;Qe.buffers[tt]&&(Xt=Qe.buffers[tt],t(Ot)&&Xt._buffer.byteLength>=Ot.byteLength?Xt.subdata(Ot):(Xt.destroy(),Qe.buffers[tt]=null)),Qe.buffers[tt]||(Xt=Qe.buffers[tt]=Ae.create(He,rb,!1,!0)),Ie.buffer=Ae.getBuffer(Xt),Ie.size=Ie.buffer.dimension|0,Ie.normalized=!1,Ie.type=Ie.buffer.dtype,Ie.offset=0,Ie.stride=0,Ie.divisor=0,Ie.state=1,_t[tt]=1}else Ae.getBuffer(He)?(Ie.buffer=Ae.getBuffer(He),Ie.size=Ie.buffer.dimension|0,Ie.normalized=!1,Ie.type=Ie.buffer.dtype,Ie.offset=0,Ie.stride=0,Ie.divisor=0,Ie.state=1):Ae.getBuffer(He.buffer)?(Ie.buffer=Ae.getBuffer(He.buffer),Ie.size=(+He.size||Ie.buffer.dimension)|0,Ie.normalized=!!He.normalized||!1,"type"in He?(D.parameter(He.type,Ho,"invalid buffer type"),Ie.type=Ho[He.type]):Ie.type=Ie.buffer.dtype,Ie.offset=(He.offset||0)|0,Ie.stride=(He.stride||0)|0,Ie.divisor=(He.divisor||0)|0,Ie.state=1,D(Ie.size>=1&&Ie.size<=4,"size must be between 1 and 4"),D(Ie.offset>=0,"invalid offset"),D(Ie.stride>=0&&Ie.stride<=255,"stride must be between 0 and 255"),D(Ie.divisor>=0,"divisor must be positive"),D(!Ie.divisor||!!N.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in He?(D(tt>0,"first attribute must not be a constant"),Ie.x=+He.x||0,Ie.y=+He.y||0,Ie.z=+He.z||0,Ie.w=+He.w||0,Ie.state=2):D(!1,"invalid attribute spec for location "+tt)}for(var ht=0;ht<Qe.buffers.length;++ht)!_t[ht]&&Qe.buffers[ht]&&(Qe.buffers[ht].destroy(),Qe.buffers[ht]=null);return Qe.refresh(),Pe}return Pe.destroy=function(){for(var Je=0;Je<Qe.buffers.length;++Je)Qe.buffers[Je]&&Qe.buffers[Je].destroy();Qe.buffers.length=0,Qe.destroy()},Pe._vao=Qe,Pe._reglType="vao",Pe(Ne)}return ze}var nb=35632,WO=35633,jO=35718,XO=35721;function HO(A,N,$,de){var Ae={},ce={};function ye(ie,me,We,it){this.name=ie,this.id=me,this.location=We,this.info=it}function Re(ie,me){for(var We=0;We<ie.length;++We)if(ie[We].id===me.id){ie[We].location=me.location;return}ie.push(me)}function Ue(ie,me,We){var it=ie===nb?Ae:ce,De=it[me];if(!De){var ot=N.str(me);De=A.createShader(ie),A.shaderSource(De,ot),A.compileShader(De),D.shaderError(A,De,ot,ie,We),it[me]=De}return De}var je={},ze=[],Ke=0;function et(ie,me){this.id=Ke++,this.fragId=ie,this.vertId=me,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,de.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Be(ie,me,We){var it,De,ot=Ue(nb,ie.fragId),Ne=Ue(WO,ie.vertId),Qe=ie.program=A.createProgram();if(A.attachShader(Qe,ot),A.attachShader(Qe,Ne),We)for(it=0;it<We.length;++it){var Pe=We[it];A.bindAttribLocation(Qe,Pe[0],Pe[1])}A.linkProgram(Qe),D.linkError(A,Qe,N.str(ie.fragId),N.str(ie.vertId),me);var Je=A.getProgramParameter(Qe,jO);de.profile&&(ie.stats.uniformsCount=Je);var _t=ie.uniforms;for(it=0;it<Je;++it)if(De=A.getActiveUniform(Qe,it),De)if(De.size>1)for(var Ft=0;Ft<De.size;++Ft){var tt=De.name.replace("[0]","["+Ft+"]");Re(_t,new ye(tt,N.id(tt),A.getUniformLocation(Qe,tt),De))}else Re(_t,new ye(De.name,N.id(De.name),A.getUniformLocation(Qe,De.name),De));var He=A.getProgramParameter(Qe,XO);de.profile&&(ie.stats.attributesCount=He);var Ie=ie.attributes;for(it=0;it<He;++it)De=A.getActiveAttrib(Qe,it),De&&Re(Ie,new ye(De.name,N.id(De.name),A.getAttribLocation(Qe,De.name),De))}de.profile&&($.getMaxUniformsCount=function(){var ie=0;return ze.forEach(function(me){me.stats.uniformsCount>ie&&(ie=me.stats.uniformsCount)}),ie},$.getMaxAttributesCount=function(){var ie=0;return ze.forEach(function(me){me.stats.attributesCount>ie&&(ie=me.stats.attributesCount)}),ie});function Ze(){Ae={},ce={};for(var ie=0;ie<ze.length;++ie)Be(ze[ie],null,ze[ie].attributes.map(function(me){return[me.location,me.name]}))}return{clear:function(){var ie=A.deleteShader.bind(A);Ci(Ae).forEach(ie),Ae={},Ci(ce).forEach(ie),ce={},ze.forEach(function(me){A.deleteProgram(me.program)}),ze.length=0,je={},$.shaderCount=0},program:function(ie,me,We,it){D.command(ie>=0,"missing vertex shader",We),D.command(me>=0,"missing fragment shader",We);var De=je[me];De||(De=je[me]={});var ot=De[ie];if(ot&&(ot.refCount++,!it))return ot;var Ne=new et(me,ie);return $.shaderCount++,Be(Ne,We,it),ot||(De[ie]=Ne),ze.push(Ne),n(Ne,{destroy:function(){if(Ne.refCount--,Ne.refCount<=0){A.deleteProgram(Ne.program);var Qe=ze.indexOf(Ne);ze.splice(Qe,1),$.shaderCount--}De[Ne.vertId].refCount<=0&&(A.deleteShader(ce[Ne.vertId]),delete ce[Ne.vertId],delete je[Ne.fragId][Ne.vertId]),Object.keys(je[Ne.fragId]).length||(A.deleteShader(Ae[Ne.fragId]),delete Ae[Ne.fragId],delete je[Ne.fragId])}})},restore:Ze,shader:Ue,frag:-1,vert:-1}}var YO=6408,wl=5121,qO=3333,Wc=5126;function KO(A,N,$,de,Ae,ce,ye){function Re(ze){var Ke;N.next===null?(D(Ae.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Ke=wl):(D(N.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Ke=N.next.colorAttachments[0].texture._texture.type,ce.oes_texture_float?(D(Ke===wl||Ke===Wc,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Ke===Wc&&D(ye.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):D(Ke===wl,"Reading from a framebuffer is only allowed for the type 'uint8'"));var et=0,Be=0,Ze=de.framebufferWidth,ie=de.framebufferHeight,me=null;t(ze)?me=ze:ze&&(D.type(ze,"object","invalid arguments to regl.read()"),et=ze.x|0,Be=ze.y|0,D(et>=0&&et<de.framebufferWidth,"invalid x offset for regl.read"),D(Be>=0&&Be<de.framebufferHeight,"invalid y offset for regl.read"),Ze=(ze.width||de.framebufferWidth-et)|0,ie=(ze.height||de.framebufferHeight-Be)|0,me=ze.data||null),me&&(Ke===wl?D(me instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Ke===Wc&&D(me instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),D(Ze>0&&Ze+et<=de.framebufferWidth,"invalid width for read pixels"),D(ie>0&&ie+Be<=de.framebufferHeight,"invalid height for read pixels"),$();var We=Ze*ie*4;return me||(Ke===wl?me=new Uint8Array(We):Ke===Wc&&(me=me||new Float32Array(We))),D.isTypedArray(me,"data buffer for regl.read() must be a typedarray"),D(me.byteLength>=We,"data buffer for regl.read() too small"),A.pixelStorei(qO,4),A.readPixels(et,Be,Ze,ie,YO,Ke,me),me}function Ue(ze){var Ke;return N.setFBO({framebuffer:ze.framebuffer},function(){Ke=Re(ze)}),Ke}function je(ze){return!ze||!("framebuffer"in ze)?Re(ze):Ue(ze)}return je}function hu(A){return Array.prototype.slice.call(A)}function du(A){return hu(A).join("")}function ZO(){var A=0,N=[],$=[];function de(Ke){for(var et=0;et<$.length;++et)if($[et]===Ke)return N[et];var Be="g"+A++;return N.push(Be),$.push(Ke),Be}function Ae(){var Ke=[];function et(){Ke.push.apply(Ke,hu(arguments))}var Be=[];function Ze(){var ie="v"+A++;return Be.push(ie),arguments.length>0&&(Ke.push(ie,"="),Ke.push.apply(Ke,hu(arguments)),Ke.push(";")),ie}return n(et,{def:Ze,toString:function(){return du([Be.length>0?"var "+Be.join(",")+";":"",du(Ke)])}})}function ce(){var Ke=Ae(),et=Ae(),Be=Ke.toString,Ze=et.toString;function ie(me,We){et(me,We,"=",Ke.def(me,We),";")}return n(function(){Ke.apply(Ke,hu(arguments))},{def:Ke.def,entry:Ke,exit:et,save:ie,set:function(me,We,it){ie(me,We),Ke(me,We,"=",it,";")},toString:function(){return Be()+Ze()}})}function ye(){var Ke=du(arguments),et=ce(),Be=ce(),Ze=et.toString,ie=Be.toString;return n(et,{then:function(){return et.apply(et,hu(arguments)),this},else:function(){return Be.apply(Be,hu(arguments)),this},toString:function(){var me=ie();return me&&(me="else{"+me+"}"),du(["if(",Ke,"){",Ze(),"}",me])}})}var Re=Ae(),Ue={};function je(Ke,et){var Be=[];function Ze(){var De="a"+Be.length;return Be.push(De),De}et=et||0;for(var ie=0;ie<et;++ie)Ze();var me=ce(),We=me.toString,it=Ue[Ke]=n(me,{arg:Ze,toString:function(){return du(["function(",Be.join(),"){",We(),"}"])}});return it}function ze(){var Ke=['"use strict";',Re,"return {"];Object.keys(Ue).forEach(function(Ze){Ke.push('"',Ze,'":',Ue[Ze].toString(),",")}),Ke.push("}");var et=du(Ke).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Be=Function.apply(null,N.concat(et));return Be.apply(null,$)}return{global:Re,link:de,block:Ae,proc:je,scope:ce,cond:ye,compile:ze}}var vu="xyzw".split(""),ib=5121,pu=1,wp=2,Sp=0,Ep=1,Cp=2,Ap=3,jc=4,ab=5,ob=6,sb="dither",ub="blend.enable",lb="blend.color",Tp="blend.equation",Mp="blend.func",fb="depth.enable",cb="depth.func",hb="depth.range",db="depth.mask",Ip="colorMask",vb="cull.enable",pb="cull.face",kp="frontFace",Dp="lineWidth",gb="polygonOffset.enable",Pp="polygonOffset.offset",yb="sample.alpha",mb="sample.enable",Np="sample.coverage",bb="stencil.enable",xb="stencil.mask",Lp="stencil.func",Op="stencil.opFront",Sl="stencil.opBack",_b="scissor.enable",Xc="scissor.box",za="viewport",El="profile",Qo="framebuffer",Cl="vert",Al="frag",Jo="elements",es="primitive",ts="count",Hc="offset",Yc="instances",Tl="vao",Rp="Width",Bp="Height",gu=Qo+Rp,yu=Qo+Bp,QO=za+Rp,JO=za+Bp,wb="drawingBuffer",Sb=wb+Rp,Eb=wb+Bp,eR=[Mp,Tp,Lp,Op,Sl,Np,za,Xc,Pp],mu=34962,tR=34963,rR=35632,nR=35633,Cb=3553,iR=34067,aR=2884,oR=3042,sR=3024,uR=2960,lR=2929,fR=3089,cR=32823,hR=32926,dR=32928,Gp=5126,qc=35664,Kc=35665,Zc=35666,Fp=5124,Qc=35667,Jc=35668,eh=35669,Up=35670,th=35671,rh=35672,nh=35673,Ml=35674,Il=35675,kl=35676,Dl=35678,Pl=35680,Ab=4,Nl=1028,rs=1029,Tb=2304,zp=2305,vR=32775,pR=32776,gR=519,vo=7680,Mb=0,Ib=1,kb=32774,yR=513,Db=36160,mR=36064,da={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Pb=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],bu={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},po={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Nb={frag:rR,vert:nR},$p={cw:Tb,ccw:zp};function ih(A){return Array.isArray(A)||t(A)||qi(A)}function Lb(A){return A.sort(function(N,$){return N===za?-1:$===za?1:N<$?-1:1})}function li(A,N,$,de){this.thisDep=A,this.contextDep=N,this.propDep=$,this.append=de}function go(A){return A&&!(A.thisDep||A.contextDep||A.propDep)}function hn(A){return new li(!1,!1,!1,A)}function yi(A,N){var $=A.type;if($===Sp){var de=A.data.length;return new li(!0,de>=1,de>=2,N)}else if($===jc){var Ae=A.data;return new li(Ae.thisDep,Ae.contextDep,Ae.propDep,N)}else{if($===ab)return new li(!1,!1,!1,N);if($===ob){for(var ce=!1,ye=!1,Re=!1,Ue=0;Ue<A.data.length;++Ue){var je=A.data[Ue];if(je.type===Ep)Re=!0;else if(je.type===Cp)ye=!0;else if(je.type===Ap)ce=!0;else if(je.type===Sp){ce=!0;var ze=je.data;ze>=1&&(ye=!0),ze>=2&&(Re=!0)}else je.type===jc&&(ce=ce||je.data.thisDep,ye=ye||je.data.contextDep,Re=Re||je.data.propDep)}return new li(ce,ye,Re,N)}else return new li($===Ap,$===Cp,$===Ep,N)}}var Ob=new li(!1,!1,!1,function(){});function bR(A,N,$,de,Ae,ce,ye,Re,Ue,je,ze,Ke,et,Be,Ze){var ie=je.Record,me={add:32774,subtract:32778,"reverse subtract":32779};$.ext_blend_minmax&&(me.min=vR,me.max=pR);var We=$.angle_instanced_arrays,it=$.webgl_draw_buffers,De={dirty:!0,profile:Ze.profile},ot={},Ne=[],Qe={},Pe={};function Je(B){return B.replace(".","_")}function _t(B,P,j){var re=Je(B);Ne.push(B),ot[re]=De[re]=!!j,Qe[re]=P}function Ft(B,P,j){var re=Je(B);Ne.push(B),Array.isArray(j)?(De[re]=j.slice(),ot[re]=j.slice()):De[re]=ot[re]=j,Pe[re]=P}_t(sb,sR),_t(ub,oR),Ft(lb,"blendColor",[0,0,0,0]),Ft(Tp,"blendEquationSeparate",[kb,kb]),Ft(Mp,"blendFuncSeparate",[Ib,Mb,Ib,Mb]),_t(fb,lR,!0),Ft(cb,"depthFunc",yR),Ft(hb,"depthRange",[0,1]),Ft(db,"depthMask",!0),Ft(Ip,Ip,[!0,!0,!0,!0]),_t(vb,aR),Ft(pb,"cullFace",rs),Ft(kp,kp,zp),Ft(Dp,Dp,1),_t(gb,cR),Ft(Pp,"polygonOffset",[0,0]),_t(yb,hR),_t(mb,dR),Ft(Np,"sampleCoverage",[1,!1]),_t(bb,uR),Ft(xb,"stencilMask",-1),Ft(Lp,"stencilFunc",[gR,0,-1]),Ft(Op,"stencilOpSeparate",[Nl,vo,vo,vo]),Ft(Sl,"stencilOpSeparate",[rs,vo,vo,vo]),_t(_b,fR),Ft(Xc,"scissor",[0,0,A.drawingBufferWidth,A.drawingBufferHeight]),Ft(za,za,[0,0,A.drawingBufferWidth,A.drawingBufferHeight]);var tt={gl:A,context:et,strings:N,next:ot,current:De,draw:Ke,elements:ce,buffer:Ae,shader:ze,attributes:je.state,vao:je,uniforms:Ue,framebuffer:Re,extensions:$,timer:Be,isBufferArgs:ih},He={primTypes:iu,compareFuncs:bu,blendFuncs:da,blendEquations:me,stencilOps:po,glTypes:Ho,orientationType:$p};D.optional(function(){tt.isArrayLike=sn}),it&&(He.backBuffer=[rs],He.drawBuffer=ur(de.maxDrawbuffers,function(B){return B===0?[0]:ur(B,function(P){return mR+P})}));var Ie=0;function Ot(){var B=ZO(),P=B.link,j=B.global;B.id=Ie++,B.batchId="0";var re=P(tt),oe=B.shared={props:"a0"};Object.keys(tt).forEach(function(W){oe[W]=j.def(re,".",W)}),D.optional(function(){B.CHECK=P(D),B.commandStr=D.guessCommand(),B.command=P(B.commandStr),B.assert=function(W,R,J){W("if(!(",R,"))",this.CHECK,".commandRaise(",P(J),",",this.command,");")},He.invalidBlendCombinations=Pb});var Y=B.next={},H=B.current={};Object.keys(Pe).forEach(function(W){Array.isArray(De[W])&&(Y[W]=j.def(oe.next,".",W),H[W]=j.def(oe.current,".",W))});var Q=B.constants={};Object.keys(He).forEach(function(W){Q[W]=j.def(JSON.stringify(He[W]))}),B.invoke=function(W,R){switch(R.type){case Sp:var J=["this",oe.context,oe.props,B.batchId];return W.def(P(R.data),".call(",J.slice(0,Math.max(R.data.length+1,4)),")");case Ep:return W.def(oe.props,R.data);case Cp:return W.def(oe.context,R.data);case Ap:return W.def("this",R.data);case jc:return R.data.append(B,W),R.data.ref;case ab:return R.data.toString();case ob:return R.data.map(function(ue){return B.invoke(W,ue)})}},B.attribCache={};var G={};return B.scopeAttrib=function(W){var R=N.id(W);if(R in G)return G[R];var J=je.scope[R];J||(J=je.scope[R]=new ie);var ue=G[R]=P(J);return ue},B}function Xt(B){var P=B.static,j=B.dynamic,re;if(El in P){var oe=!!P[El];re=hn(function(H,Q){return oe}),re.enable=oe}else if(El in j){var Y=j[El];re=yi(Y,function(H,Q){return H.invoke(Q,Y)})}return re}function ht(B,P){var j=B.static,re=B.dynamic;if(Qo in j){var oe=j[Qo];return oe?(oe=Re.getFramebuffer(oe),D.command(oe,"invalid framebuffer object"),hn(function(H,Q){var G=H.link(oe),W=H.shared;Q.set(W.framebuffer,".next",G);var R=W.context;return Q.set(R,"."+gu,G+".width"),Q.set(R,"."+yu,G+".height"),G})):hn(function(H,Q){var G=H.shared;Q.set(G.framebuffer,".next","null");var W=G.context;return Q.set(W,"."+gu,W+"."+Sb),Q.set(W,"."+yu,W+"."+Eb),"null"})}else if(Qo in re){var Y=re[Qo];return yi(Y,function(H,Q){var G=H.invoke(Q,Y),W=H.shared,R=W.framebuffer,J=Q.def(R,".getFramebuffer(",G,")");D.optional(function(){H.assert(Q,"!"+G+"||"+J,"invalid framebuffer object")}),Q.set(R,".next",J);var ue=W.context;return Q.set(ue,"."+gu,J+"?"+J+".width:"+ue+"."+Sb),Q.set(ue,"."+yu,J+"?"+J+".height:"+ue+"."+Eb),J})}else return null}function er(B,P,j){var re=B.static,oe=B.dynamic;function Y(G){if(G in re){var W=re[G];D.commandType(W,"object","invalid "+G,j.commandStr);var R=!0,J=W.x|0,ue=W.y|0,Ee,Te;return"width"in W?(Ee=W.width|0,D.command(Ee>=0,"invalid "+G,j.commandStr)):R=!1,"height"in W?(Te=W.height|0,D.command(Te>=0,"invalid "+G,j.commandStr)):R=!1,new li(!R&&P&&P.thisDep,!R&&P&&P.contextDep,!R&&P&&P.propDep,function(xt,Yt){var dt=xt.shared.context,It=Ee;"width"in W||(It=Yt.def(dt,".",gu,"-",J));var zt=Te;return"height"in W||(zt=Yt.def(dt,".",yu,"-",ue)),[J,ue,It,zt]})}else if(G in oe){var _e=oe[G],Ve=yi(_e,function(xt,Yt){var dt=xt.invoke(Yt,_e);D.optional(function(){xt.assert(Yt,dt+"&&typeof "+dt+'==="object"',"invalid "+G)});var It=xt.shared.context,zt=Yt.def(dt,".x|0"),dr=Yt.def(dt,".y|0"),rn=Yt.def('"width" in ',dt,"?",dt,".width|0:","(",It,".",gu,"-",zt,")"),fi=Yt.def('"height" in ',dt,"?",dt,".height|0:","(",It,".",yu,"-",dr,")");return D.optional(function(){xt.assert(Yt,rn+">=0&&"+fi+">=0","invalid "+G)}),[zt,dr,rn,fi]});return P&&(Ve.thisDep=Ve.thisDep||P.thisDep,Ve.contextDep=Ve.contextDep||P.contextDep,Ve.propDep=Ve.propDep||P.propDep),Ve}else return P?new li(P.thisDep,P.contextDep,P.propDep,function(xt,Yt){var dt=xt.shared.context;return[0,0,Yt.def(dt,".",gu),Yt.def(dt,".",yu)]}):null}var H=Y(za);if(H){var Q=H;H=new li(H.thisDep,H.contextDep,H.propDep,function(G,W){var R=Q.append(G,W),J=G.shared.context;return W.set(J,"."+QO,R[2]),W.set(J,"."+JO,R[3]),R})}return{viewport:H,scissor_box:Y(Xc)}}function Ut(B,P){var j=B.static,re=typeof j[Al]=="string"&&typeof j[Cl]=="string";if(re){if(Object.keys(P.dynamic).length>0)return null;var oe=P.static,Y=Object.keys(oe);if(Y.length>0&&typeof oe[Y[0]]=="number"){for(var H=[],Q=0;Q<Y.length;++Q)D(typeof oe[Y[Q]]=="number","must specify all vertex attribute locations when using vaos"),H.push([oe[Y[Q]]|0,Y[Q]]);return H}}return null}function Kt(B,P,j){var re=B.static,oe=B.dynamic;function Y(R){if(R in re){var J=N.id(re[R]);D.optional(function(){ze.shader(Nb[R],J,D.guessCommand())});var ue=hn(function(){return J});return ue.id=J,ue}else if(R in oe){var Ee=oe[R];return yi(Ee,function(Te,_e){var Ve=Te.invoke(_e,Ee),xt=_e.def(Te.shared.strings,".id(",Ve,")");return D.optional(function(){_e(Te.shared.shader,".shader(",Nb[R],",",xt,",",Te.command,");")}),xt})}return null}var H=Y(Al),Q=Y(Cl),G=null,W;return go(H)&&go(Q)?(G=ze.program(Q.id,H.id,null,j),W=hn(function(R,J){return R.link(G)})):W=new li(H&&H.thisDep||Q&&Q.thisDep,H&&H.contextDep||Q&&Q.contextDep,H&&H.propDep||Q&&Q.propDep,function(R,J){var ue=R.shared.shader,Ee;H?Ee=H.append(R,J):Ee=J.def(ue,".",Al);var Te;Q?Te=Q.append(R,J):Te=J.def(ue,".",Cl);var _e=ue+".program("+Te+","+Ee;return D.optional(function(){_e+=","+R.command}),J.def(_e+")")}),{frag:H,vert:Q,progVar:W,program:G}}function hr(B,P){var j=B.static,re=B.dynamic;function oe(){if(Jo in j){var R=j[Jo];ih(R)?R=ce.getElements(ce.create(R,!0)):R&&(R=ce.getElements(R),D.command(R,"invalid elements",P.commandStr));var J=hn(function(Ee,Te){if(R){var _e=Ee.link(R);return Ee.ELEMENTS=_e,_e}return Ee.ELEMENTS=null,null});return J.value=R,J}else if(Jo in re){var ue=re[Jo];return yi(ue,function(Ee,Te){var _e=Ee.shared,Ve=_e.isBufferArgs,xt=_e.elements,Yt=Ee.invoke(Te,ue),dt=Te.def("null"),It=Te.def(Ve,"(",Yt,")"),zt=Ee.cond(It).then(dt,"=",xt,".createStream(",Yt,");").else(dt,"=",xt,".getElements(",Yt,");");return D.optional(function(){Ee.assert(zt.else,"!"+Yt+"||"+dt,"invalid elements")}),Te.entry(zt),Te.exit(Ee.cond(It).then(xt,".destroyStream(",dt,");")),Ee.ELEMENTS=dt,dt})}return null}var Y=oe();function H(){if(es in j){var R=j[es];return D.commandParameter(R,iu,"invalid primitve",P.commandStr),hn(function(ue,Ee){return iu[R]})}else if(es in re){var J=re[es];return yi(J,function(ue,Ee){var Te=ue.constants.primTypes,_e=ue.invoke(Ee,J);return D.optional(function(){ue.assert(Ee,_e+" in "+Te,"invalid primitive, must be one of "+Object.keys(iu))}),Ee.def(Te,"[",_e,"]")})}else if(Y)return go(Y)?Y.value?hn(function(ue,Ee){return Ee.def(ue.ELEMENTS,".primType")}):hn(function(){return Ab}):new li(Y.thisDep,Y.contextDep,Y.propDep,function(ue,Ee){var Te=ue.ELEMENTS;return Ee.def(Te,"?",Te,".primType:",Ab)});return null}function Q(R,J){if(R in j){var ue=j[R]|0;return D.command(!J||ue>=0,"invalid "+R,P.commandStr),hn(function(Te,_e){return J&&(Te.OFFSET=ue),ue})}else if(R in re){var Ee=re[R];return yi(Ee,function(Te,_e){var Ve=Te.invoke(_e,Ee);return J&&(Te.OFFSET=Ve,D.optional(function(){Te.assert(_e,Ve+">=0","invalid "+R)})),Ve})}else if(J&&Y)return hn(function(Te,_e){return Te.OFFSET="0",0});return null}var G=Q(Hc,!0);function W(){if(ts in j){var R=j[ts]|0;return D.command(typeof R=="number"&&R>=0,"invalid vertex count",P.commandStr),hn(function(){return R})}else if(ts in re){var J=re[ts];return yi(J,function(Te,_e){var Ve=Te.invoke(_e,J);return D.optional(function(){Te.assert(_e,"typeof "+Ve+'==="number"&&'+Ve+">=0&&"+Ve+"===("+Ve+"|0)","invalid vertex count")}),Ve})}else if(Y)if(go(Y)){if(Y)return G?new li(G.thisDep,G.contextDep,G.propDep,function(Te,_e){var Ve=_e.def(Te.ELEMENTS,".vertCount-",Te.OFFSET);return D.optional(function(){Te.assert(_e,Ve+">=0","invalid vertex offset/element buffer too small")}),Ve}):hn(function(Te,_e){return _e.def(Te.ELEMENTS,".vertCount")});var ue=hn(function(){return-1});return D.optional(function(){ue.MISSING=!0}),ue}else{var Ee=new li(Y.thisDep||G.thisDep,Y.contextDep||G.contextDep,Y.propDep||G.propDep,function(Te,_e){var Ve=Te.ELEMENTS;return Te.OFFSET?_e.def(Ve,"?",Ve,".vertCount-",Te.OFFSET,":-1"):_e.def(Ve,"?",Ve,".vertCount:-1")});return D.optional(function(){Ee.DYNAMIC=!0}),Ee}return null}return{elements:Y,primitive:H(),count:W(),instances:Q(Yc,!1),offset:G}}function dn(B,P){var j=B.static,re=B.dynamic,oe={};return Ne.forEach(function(Y){var H=Je(Y);function Q(G,W){if(Y in j){var R=G(j[Y]);oe[H]=hn(function(){return R})}else if(Y in re){var J=re[Y];oe[H]=yi(J,function(ue,Ee){return W(ue,Ee,ue.invoke(Ee,J))})}}switch(Y){case vb:case ub:case sb:case bb:case fb:case _b:case gb:case yb:case mb:case db:return Q(function(G){return D.commandType(G,"boolean",Y,P.commandStr),G},function(G,W,R){return D.optional(function(){G.assert(W,"typeof "+R+'==="boolean"',"invalid flag "+Y,G.commandStr)}),R});case cb:return Q(function(G){return D.commandParameter(G,bu,"invalid "+Y,P.commandStr),bu[G]},function(G,W,R){var J=G.constants.compareFuncs;return D.optional(function(){G.assert(W,R+" in "+J,"invalid "+Y+", must be one of "+Object.keys(bu))}),W.def(J,"[",R,"]")});case hb:return Q(function(G){return D.command(sn(G)&&G.length===2&&typeof G[0]=="number"&&typeof G[1]=="number"&&G[0]<=G[1],"depth range is 2d array",P.commandStr),G},function(G,W,R){D.optional(function(){G.assert(W,G.shared.isArrayLike+"("+R+")&&"+R+".length===2&&typeof "+R+'[0]==="number"&&typeof '+R+'[1]==="number"&&'+R+"[0]<="+R+"[1]","depth range must be a 2d array")});var J=W.def("+",R,"[0]"),ue=W.def("+",R,"[1]");return[J,ue]});case Mp:return Q(function(G){D.commandType(G,"object","blend.func",P.commandStr);var W="srcRGB"in G?G.srcRGB:G.src,R="srcAlpha"in G?G.srcAlpha:G.src,J="dstRGB"in G?G.dstRGB:G.dst,ue="dstAlpha"in G?G.dstAlpha:G.dst;return D.commandParameter(W,da,H+".srcRGB",P.commandStr),D.commandParameter(R,da,H+".srcAlpha",P.commandStr),D.commandParameter(J,da,H+".dstRGB",P.commandStr),D.commandParameter(ue,da,H+".dstAlpha",P.commandStr),D.command(Pb.indexOf(W+", "+J)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+W+", "+J+")",P.commandStr),[da[W],da[J],da[R],da[ue]]},function(G,W,R){var J=G.constants.blendFuncs;D.optional(function(){G.assert(W,R+"&&typeof "+R+'==="object"',"invalid blend func, must be an object")});function ue(dt,It){var zt=W.def('"',dt,It,'" in ',R,"?",R,".",dt,It,":",R,".",dt);return D.optional(function(){G.assert(W,zt+" in "+J,"invalid "+Y+"."+dt+It+", must be one of "+Object.keys(da))}),zt}var Ee=ue("src","RGB"),Te=ue("dst","RGB");D.optional(function(){var dt=G.constants.invalidBlendCombinations;G.assert(W,dt+".indexOf("+Ee+'+", "+'+Te+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var _e=W.def(J,"[",Ee,"]"),Ve=W.def(J,"[",ue("src","Alpha"),"]"),xt=W.def(J,"[",Te,"]"),Yt=W.def(J,"[",ue("dst","Alpha"),"]");return[_e,xt,Ve,Yt]});case Tp:return Q(function(G){if(typeof G=="string")return D.commandParameter(G,me,"invalid "+Y,P.commandStr),[me[G],me[G]];if(typeof G=="object")return D.commandParameter(G.rgb,me,Y+".rgb",P.commandStr),D.commandParameter(G.alpha,me,Y+".alpha",P.commandStr),[me[G.rgb],me[G.alpha]];D.commandRaise("invalid blend.equation",P.commandStr)},function(G,W,R){var J=G.constants.blendEquations,ue=W.def(),Ee=W.def(),Te=G.cond("typeof ",R,'==="string"');return D.optional(function(){function _e(Ve,xt,Yt){G.assert(Ve,Yt+" in "+J,"invalid "+xt+", must be one of "+Object.keys(me))}_e(Te.then,Y,R),G.assert(Te.else,R+"&&typeof "+R+'==="object"',"invalid "+Y),_e(Te.else,Y+".rgb",R+".rgb"),_e(Te.else,Y+".alpha",R+".alpha")}),Te.then(ue,"=",Ee,"=",J,"[",R,"];"),Te.else(ue,"=",J,"[",R,".rgb];",Ee,"=",J,"[",R,".alpha];"),W(Te),[ue,Ee]});case lb:return Q(function(G){return D.command(sn(G)&&G.length===4,"blend.color must be a 4d array",P.commandStr),ur(4,function(W){return+G[W]})},function(G,W,R){return D.optional(function(){G.assert(W,G.shared.isArrayLike+"("+R+")&&"+R+".length===4","blend.color must be a 4d array")}),ur(4,function(J){return W.def("+",R,"[",J,"]")})});case xb:return Q(function(G){return D.commandType(G,"number",H,P.commandStr),G|0},function(G,W,R){return D.optional(function(){G.assert(W,"typeof "+R+'==="number"',"invalid stencil.mask")}),W.def(R,"|0")});case Lp:return Q(function(G){D.commandType(G,"object",H,P.commandStr);var W=G.cmp||"keep",R=G.ref||0,J="mask"in G?G.mask:-1;return D.commandParameter(W,bu,Y+".cmp",P.commandStr),D.commandType(R,"number",Y+".ref",P.commandStr),D.commandType(J,"number",Y+".mask",P.commandStr),[bu[W],R,J]},function(G,W,R){var J=G.constants.compareFuncs;D.optional(function(){function _e(){G.assert(W,Array.prototype.join.call(arguments,""),"invalid stencil.func")}_e(R+"&&typeof ",R,'==="object"'),_e('!("cmp" in ',R,")||(",R,".cmp in ",J,")")});var ue=W.def('"cmp" in ',R,"?",J,"[",R,".cmp]",":",vo),Ee=W.def(R,".ref|0"),Te=W.def('"mask" in ',R,"?",R,".mask|0:-1");return[ue,Ee,Te]});case Op:case Sl:return Q(function(G){D.commandType(G,"object",H,P.commandStr);var W=G.fail||"keep",R=G.zfail||"keep",J=G.zpass||"keep";return D.commandParameter(W,po,Y+".fail",P.commandStr),D.commandParameter(R,po,Y+".zfail",P.commandStr),D.commandParameter(J,po,Y+".zpass",P.commandStr),[Y===Sl?rs:Nl,po[W],po[R],po[J]]},function(G,W,R){var J=G.constants.stencilOps;D.optional(function(){G.assert(W,R+"&&typeof "+R+'==="object"',"invalid "+Y)});function ue(Ee){return D.optional(function(){G.assert(W,'!("'+Ee+'" in '+R+")||("+R+"."+Ee+" in "+J+")","invalid "+Y+"."+Ee+", must be one of "+Object.keys(po))}),W.def('"',Ee,'" in ',R,"?",J,"[",R,".",Ee,"]:",vo)}return[Y===Sl?rs:Nl,ue("fail"),ue("zfail"),ue("zpass")]});case Pp:return Q(function(G){D.commandType(G,"object",H,P.commandStr);var W=G.factor|0,R=G.units|0;return D.commandType(W,"number",H+".factor",P.commandStr),D.commandType(R,"number",H+".units",P.commandStr),[W,R]},function(G,W,R){D.optional(function(){G.assert(W,R+"&&typeof "+R+'==="object"',"invalid "+Y)});var J=W.def(R,".factor|0"),ue=W.def(R,".units|0");return[J,ue]});case pb:return Q(function(G){var W=0;return G==="front"?W=Nl:G==="back"&&(W=rs),D.command(!!W,H,P.commandStr),W},function(G,W,R){return D.optional(function(){G.assert(W,R+'==="front"||'+R+'==="back"',"invalid cull.face")}),W.def(R,'==="front"?',Nl,":",rs)});case Dp:return Q(function(G){return D.command(typeof G=="number"&&G>=de.lineWidthDims[0]&&G<=de.lineWidthDims[1],"invalid line width, must be a positive number between "+de.lineWidthDims[0]+" and "+de.lineWidthDims[1],P.commandStr),G},function(G,W,R){return D.optional(function(){G.assert(W,"typeof "+R+'==="number"&&'+R+">="+de.lineWidthDims[0]+"&&"+R+"<="+de.lineWidthDims[1],"invalid line width")}),R});case kp:return Q(function(G){return D.commandParameter(G,$p,H,P.commandStr),$p[G]},function(G,W,R){return D.optional(function(){G.assert(W,R+'==="cw"||'+R+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),W.def(R+'==="cw"?'+Tb+":"+zp)});case Ip:return Q(function(G){return D.command(sn(G)&&G.length===4,"color.mask must be length 4 array",P.commandStr),G.map(function(W){return!!W})},function(G,W,R){return D.optional(function(){G.assert(W,G.shared.isArrayLike+"("+R+")&&"+R+".length===4","invalid color.mask")}),ur(4,function(J){return"!!"+R+"["+J+"]"})});case Np:return Q(function(G){D.command(typeof G=="object"&&G,H,P.commandStr);var W="value"in G?G.value:1,R=!!G.invert;return D.command(typeof W=="number"&&W>=0&&W<=1,"sample.coverage.value must be a number between 0 and 1",P.commandStr),[W,R]},function(G,W,R){D.optional(function(){G.assert(W,R+"&&typeof "+R+'==="object"',"invalid sample.coverage")});var J=W.def('"value" in ',R,"?+",R,".value:1"),ue=W.def("!!",R,".invert");return[J,ue]})}}),oe}function Tn(B,P){var j=B.static,re=B.dynamic,oe={};return Object.keys(j).forEach(function(Y){var H=j[Y],Q;if(typeof H=="number"||typeof H=="boolean")Q=hn(function(){return H});else if(typeof H=="function"){var G=H._reglType;G==="texture2d"||G==="textureCube"?Q=hn(function(W){return W.link(H)}):G==="framebuffer"||G==="framebufferCube"?(D.command(H.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Y+'"',P.commandStr),Q=hn(function(W){return W.link(H.color[0])})):D.commandRaise('invalid data for uniform "'+Y+'"',P.commandStr)}else sn(H)?Q=hn(function(W){var R=W.global.def("[",ur(H.length,function(J){return D.command(typeof H[J]=="number"||typeof H[J]=="boolean","invalid uniform "+Y,W.commandStr),H[J]}),"]");return R}):D.commandRaise('invalid or missing data for uniform "'+Y+'"',P.commandStr);Q.value=H,oe[Y]=Q}),Object.keys(re).forEach(function(Y){var H=re[Y];oe[Y]=yi(H,function(Q,G){return Q.invoke(G,H)})}),oe}function ir(B,P){var j=B.static,re=B.dynamic,oe={};return Object.keys(j).forEach(function(Y){var H=j[Y],Q=N.id(Y),G=new ie;if(ih(H))G.state=pu,G.buffer=Ae.getBuffer(Ae.create(H,mu,!1,!0)),G.type=0;else{var W=Ae.getBuffer(H);if(W)G.state=pu,G.buffer=W,G.type=0;else if(D.command(typeof H=="object"&&H,"invalid data for attribute "+Y,P.commandStr),"constant"in H){var R=H.constant;G.buffer="null",G.state=wp,typeof R=="number"?G.x=R:(D.command(sn(R)&&R.length>0&&R.length<=4,"invalid constant for attribute "+Y,P.commandStr),vu.forEach(function(xt,Yt){Yt<R.length&&(G[xt]=R[Yt])}))}else{ih(H.buffer)?W=Ae.getBuffer(Ae.create(H.buffer,mu,!1,!0)):W=Ae.getBuffer(H.buffer),D.command(!!W,'missing buffer for attribute "'+Y+'"',P.commandStr);var J=H.offset|0;D.command(J>=0,'invalid offset for attribute "'+Y+'"',P.commandStr);var ue=H.stride|0;D.command(ue>=0&&ue<256,'invalid stride for attribute "'+Y+'", must be integer betweeen [0, 255]',P.commandStr);var Ee=H.size|0;D.command(!("size"in H)||Ee>0&&Ee<=4,'invalid size for attribute "'+Y+'", must be 1,2,3,4',P.commandStr);var Te=!!H.normalized,_e=0;"type"in H&&(D.commandParameter(H.type,Ho,"invalid type for attribute "+Y,P.commandStr),_e=Ho[H.type]);var Ve=H.divisor|0;"divisor"in H&&(D.command(Ve===0||We,'cannot specify divisor for attribute "'+Y+'", instancing not supported',P.commandStr),D.command(Ve>=0,'invalid divisor for attribute "'+Y+'"',P.commandStr)),D.optional(function(){var xt=P.commandStr,Yt=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(H).forEach(function(dt){D.command(Yt.indexOf(dt)>=0,'unknown parameter "'+dt+'" for attribute pointer "'+Y+'" (valid parameters are '+Yt+")",xt)})}),G.buffer=W,G.state=pu,G.size=Ee,G.normalized=Te,G.type=_e||W.dtype,G.offset=J,G.stride=ue,G.divisor=Ve}}oe[Y]=hn(function(xt,Yt){var dt=xt.attribCache;if(Q in dt)return dt[Q];var It={isStream:!1};return Object.keys(G).forEach(function(zt){It[zt]=G[zt]}),G.buffer&&(It.buffer=xt.link(G.buffer),It.type=It.type||It.buffer+".dtype"),dt[Q]=It,It})}),Object.keys(re).forEach(function(Y){var H=re[Y];function Q(G,W){var R=G.invoke(W,H),J=G.shared,ue=G.constants,Ee=J.isBufferArgs,Te=J.buffer;D.optional(function(){G.assert(W,R+"&&(typeof "+R+'==="object"||typeof '+R+'==="function")&&('+Ee+"("+R+")||"+Te+".getBuffer("+R+")||"+Te+".getBuffer("+R+".buffer)||"+Ee+"("+R+'.buffer)||("constant" in '+R+"&&(typeof "+R+'.constant==="number"||'+J.isArrayLike+"("+R+".constant))))",'invalid dynamic attribute "'+Y+'"')});var _e={isStream:W.def(!1)},Ve=new ie;Ve.state=pu,Object.keys(Ve).forEach(function(It){_e[It]=W.def(""+Ve[It])});var xt=_e.buffer,Yt=_e.type;W("if(",Ee,"(",R,")){",_e.isStream,"=true;",xt,"=",Te,".createStream(",mu,",",R,");",Yt,"=",xt,".dtype;","}else{",xt,"=",Te,".getBuffer(",R,");","if(",xt,"){",Yt,"=",xt,".dtype;",'}else if("constant" in ',R,"){",_e.state,"=",wp,";","if(typeof "+R+'.constant === "number"){',_e[vu[0]],"=",R,".constant;",vu.slice(1).map(function(It){return _e[It]}).join("="),"=0;","}else{",vu.map(function(It,zt){return _e[It]+"="+R+".constant.length>"+zt+"?"+R+".constant["+zt+"]:0;"}).join(""),"}}else{","if(",Ee,"(",R,".buffer)){",xt,"=",Te,".createStream(",mu,",",R,".buffer);","}else{",xt,"=",Te,".getBuffer(",R,".buffer);","}",Yt,'="type" in ',R,"?",ue.glTypes,"[",R,".type]:",xt,".dtype;",_e.normalized,"=!!",R,".normalized;");function dt(It){W(_e[It],"=",R,".",It,"|0;")}return dt("size"),dt("offset"),dt("stride"),dt("divisor"),W("}}"),W.exit("if(",_e.isStream,"){",Te,".destroyStream(",xt,");","}"),_e}oe[Y]=yi(H,Q)}),oe}function _n(B,P){var j=B.static,re=B.dynamic;if(Tl in j){var oe=j[Tl];return oe!==null&&je.getVAO(oe)===null&&(oe=je.createVAO(oe)),hn(function(H){return H.link(je.getVAO(oe))})}else if(Tl in re){var Y=re[Tl];return yi(Y,function(H,Q){var G=H.invoke(Q,Y);return Q.def(H.shared.vao+".getVAO("+G+")")})}return null}function jr(B){var P=B.static,j=B.dynamic,re={};return Object.keys(P).forEach(function(oe){var Y=P[oe];re[oe]=hn(function(H,Q){return typeof Y=="number"||typeof Y=="boolean"?""+Y:H.link(Y)})}),Object.keys(j).forEach(function(oe){var Y=j[oe];re[oe]=yi(Y,function(H,Q){return H.invoke(Q,Y)})}),re}function vn(B,P,j,re,oe){var Y=B.static,H=B.dynamic;D.optional(function(){var dt=[Qo,Cl,Al,Jo,es,Hc,ts,Yc,El,Tl].concat(Ne);function It(zt){Object.keys(zt).forEach(function(dr){D.command(dt.indexOf(dr)>=0,'unknown parameter "'+dr+'"',oe.commandStr)})}It(Y),It(H)});var Q=Ut(B,P),G=ht(B),W=er(B,G,oe),R=hr(B,oe),J=dn(B,oe),ue=Kt(B,oe,Q);function Ee(dt){var It=W[dt];It&&(J[dt]=It)}Ee(za),Ee(Je(Xc));var Te=Object.keys(J).length>0,_e={framebuffer:G,draw:R,shader:ue,state:J,dirty:Te,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(_e.profile=Xt(B),_e.uniforms=Tn(j,oe),_e.drawVAO=_e.scopeVAO=_n(B),!_e.drawVAO&&ue.program&&!Q&&$.angle_instanced_arrays){var Ve=!0,xt=ue.program.attributes.map(function(dt){var It=P.static[dt];return Ve=Ve&&!!It,It});if(Ve&&xt.length>0){var Yt=je.getVAO(je.createVAO(xt));_e.drawVAO=new li(null,null,null,function(dt,It){return dt.link(Yt)}),_e.useVAO=!0}}return Q?_e.useVAO=!0:_e.attributes=ir(P,oe),_e.context=jr(re),_e}function wn(B,P,j){var re=B.shared,oe=re.context,Y=B.scope();Object.keys(j).forEach(function(H){P.save(oe,"."+H);var Q=j[H],G=Q.append(B,P);Array.isArray(G)?Y(oe,".",H,"=[",G.join(),"];"):Y(oe,".",H,"=",G,";")}),P(Y)}function Sn(B,P,j,re){var oe=B.shared,Y=oe.gl,H=oe.framebuffer,Q;it&&(Q=P.def(oe.extensions,".webgl_draw_buffers"));var G=B.constants,W=G.drawBuffer,R=G.backBuffer,J;j?J=j.append(B,P):J=P.def(H,".next"),re||P("if(",J,"!==",H,".cur){"),P("if(",J,"){",Y,".bindFramebuffer(",Db,",",J,".framebuffer);"),it&&P(Q,".drawBuffersWEBGL(",W,"[",J,".colorAttachments.length]);"),P("}else{",Y,".bindFramebuffer(",Db,",null);"),it&&P(Q,".drawBuffersWEBGL(",R,");"),P("}",H,".cur=",J,";"),re||P("}")}function In(B,P,j){var re=B.shared,oe=re.gl,Y=B.current,H=B.next,Q=re.current,G=re.next,W=B.cond(Q,".dirty");Ne.forEach(function(R){var J=Je(R);if(!(J in j.state)){var ue,Ee;if(J in H){ue=H[J],Ee=Y[J];var Te=ur(De[J].length,function(Ve){return W.def(ue,"[",Ve,"]")});W(B.cond(Te.map(function(Ve,xt){return Ve+"!=="+Ee+"["+xt+"]"}).join("||")).then(oe,".",Pe[J],"(",Te,");",Te.map(function(Ve,xt){return Ee+"["+xt+"]="+Ve}).join(";"),";"))}else{ue=W.def(G,".",J);var _e=B.cond(ue,"!==",Q,".",J);W(_e),J in Qe?_e(B.cond(ue).then(oe,".enable(",Qe[J],");").else(oe,".disable(",Qe[J],");"),Q,".",J,"=",ue,";"):_e(oe,".",Pe[J],"(",ue,");",Q,".",J,"=",ue,";")}}}),Object.keys(j.state).length===0&&W(Q,".dirty=false;"),P(W)}function Gn(B,P,j,re){var oe=B.shared,Y=B.current,H=oe.current,Q=oe.gl;Lb(Object.keys(j)).forEach(function(G){var W=j[G];if(!(re&&!re(W))){var R=W.append(B,P);if(Qe[G]){var J=Qe[G];go(W)?R?P(Q,".enable(",J,");"):P(Q,".disable(",J,");"):P(B.cond(R).then(Q,".enable(",J,");").else(Q,".disable(",J,");")),P(H,".",G,"=",R,";")}else if(sn(R)){var ue=Y[G];P(Q,".",Pe[G],"(",R,");",R.map(function(Ee,Te){return ue+"["+Te+"]="+Ee}).join(";"),";")}else P(Q,".",Pe[G],"(",R,");",H,".",G,"=",R,";")}})}function un(B,P){We&&(B.instancing=P.def(B.shared.extensions,".angle_instanced_arrays"))}function Ht(B,P,j,re,oe){var Y=B.shared,H=B.stats,Q=Y.current,G=Y.timer,W=j.profile;function R(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var J,ue;function Ee(dt){J=P.def(),dt(J,"=",R(),";"),typeof oe=="string"?dt(H,".count+=",oe,";"):dt(H,".count++;"),Be&&(re?(ue=P.def(),dt(ue,"=",G,".getNumPendingQueries();")):dt(G,".beginQuery(",H,");"))}function Te(dt){dt(H,".cpuTime+=",R(),"-",J,";"),Be&&(re?dt(G,".pushScopeStats(",ue,",",G,".getNumPendingQueries(),",H,");"):dt(G,".endQuery();"))}function _e(dt){var It=P.def(Q,".profile");P(Q,".profile=",dt,";"),P.exit(Q,".profile=",It,";")}var Ve;if(W){if(go(W)){W.enable?(Ee(P),Te(P.exit),_e("true")):_e("false");return}Ve=W.append(B,P),_e(Ve)}else Ve=P.def(Q,".profile");var xt=B.block();Ee(xt),P("if(",Ve,"){",xt,"}");var Yt=B.block();Te(Yt),P.exit("if(",Ve,"){",Yt,"}")}function Fn(B,P,j,re,oe){var Y=B.shared;function H(G){switch(G){case qc:case Qc:case th:return 2;case Kc:case Jc:case rh:return 3;case Zc:case eh:case nh:return 4;default:return 1}}function Q(G,W,R){var J=Y.gl,ue=P.def(G,".location"),Ee=P.def(Y.attributes,"[",ue,"]"),Te=R.state,_e=R.buffer,Ve=[R.x,R.y,R.z,R.w],xt=["buffer","normalized","offset","stride"];function Yt(){P("if(!",Ee,".buffer){",J,".enableVertexAttribArray(",ue,");}");var It=R.type,zt;if(R.size?zt=P.def(R.size,"||",W):zt=W,P("if(",Ee,".type!==",It,"||",Ee,".size!==",zt,"||",xt.map(function(rn){return Ee+"."+rn+"!=="+R[rn]}).join("||"),"){",J,".bindBuffer(",mu,",",_e,".buffer);",J,".vertexAttribPointer(",[ue,zt,It,R.normalized,R.stride,R.offset],");",Ee,".type=",It,";",Ee,".size=",zt,";",xt.map(function(rn){return Ee+"."+rn+"="+R[rn]+";"}).join(""),"}"),We){var dr=R.divisor;P("if(",Ee,".divisor!==",dr,"){",B.instancing,".vertexAttribDivisorANGLE(",[ue,dr],");",Ee,".divisor=",dr,";}")}}function dt(){P("if(",Ee,".buffer){",J,".disableVertexAttribArray(",ue,");",Ee,".buffer=null;","}if(",vu.map(function(It,zt){return Ee+"."+It+"!=="+Ve[zt]}).join("||"),"){",J,".vertexAttrib4f(",ue,",",Ve,");",vu.map(function(It,zt){return Ee+"."+It+"="+Ve[zt]+";"}).join(""),"}")}Te===pu?Yt():Te===wp?dt():(P("if(",Te,"===",pu,"){"),Yt(),P("}else{"),dt(),P("}"))}re.forEach(function(G){var W=G.name,R=j.attributes[W],J;if(R){if(!oe(R))return;J=R.append(B,P)}else{if(!oe(Ob))return;var ue=B.scopeAttrib(W);D.optional(function(){B.assert(P,ue+".state","missing attribute "+W)}),J={},Object.keys(new ie).forEach(function(Ee){J[Ee]=P.def(ue,".",Ee)})}Q(B.link(G),H(G.info.type),J)})}function br(B,P,j,re,oe){for(var Y=B.shared,H=Y.gl,Q,G=0;G<re.length;++G){var W=re[G],R=W.name,J=W.info.type,ue=j.uniforms[R],Ee=B.link(W),Te=Ee+".location",_e;if(ue){if(!oe(ue))continue;if(go(ue)){var Ve=ue.value;if(D.command(Ve!==null&&typeof Ve!="undefined",'missing uniform "'+R+'"',B.commandStr),J===Dl||J===Pl){D.command(typeof Ve=="function"&&(J===Dl&&(Ve._reglType==="texture2d"||Ve._reglType==="framebuffer")||J===Pl&&(Ve._reglType==="textureCube"||Ve._reglType==="framebufferCube")),"invalid texture for uniform "+R,B.commandStr);var xt=B.link(Ve._texture||Ve.color[0]._texture);P(H,".uniform1i(",Te,",",xt+".bind());"),P.exit(xt,".unbind();")}else if(J===Ml||J===Il||J===kl){D.optional(function(){D.command(sn(Ve),"invalid matrix for uniform "+R,B.commandStr),D.command(J===Ml&&Ve.length===4||J===Il&&Ve.length===9||J===kl&&Ve.length===16,"invalid length for matrix uniform "+R,B.commandStr)});var Yt=B.global.def("new Float32Array(["+Array.prototype.slice.call(Ve)+"])"),dt=2;J===Il?dt=3:J===kl&&(dt=4),P(H,".uniformMatrix",dt,"fv(",Te,",false,",Yt,");")}else{switch(J){case Gp:D.commandType(Ve,"number","uniform "+R,B.commandStr),Q="1f";break;case qc:D.command(sn(Ve)&&Ve.length===2,"uniform "+R,B.commandStr),Q="2f";break;case Kc:D.command(sn(Ve)&&Ve.length===3,"uniform "+R,B.commandStr),Q="3f";break;case Zc:D.command(sn(Ve)&&Ve.length===4,"uniform "+R,B.commandStr),Q="4f";break;case Up:D.commandType(Ve,"boolean","uniform "+R,B.commandStr),Q="1i";break;case Fp:D.commandType(Ve,"number","uniform "+R,B.commandStr),Q="1i";break;case th:D.command(sn(Ve)&&Ve.length===2,"uniform "+R,B.commandStr),Q="2i";break;case Qc:D.command(sn(Ve)&&Ve.length===2,"uniform "+R,B.commandStr),Q="2i";break;case rh:D.command(sn(Ve)&&Ve.length===3,"uniform "+R,B.commandStr),Q="3i";break;case Jc:D.command(sn(Ve)&&Ve.length===3,"uniform "+R,B.commandStr),Q="3i";break;case nh:D.command(sn(Ve)&&Ve.length===4,"uniform "+R,B.commandStr),Q="4i";break;case eh:D.command(sn(Ve)&&Ve.length===4,"uniform "+R,B.commandStr),Q="4i";break}P(H,".uniform",Q,"(",Te,",",sn(Ve)?Array.prototype.slice.call(Ve):Ve,");")}continue}else _e=ue.append(B,P)}else{if(!oe(Ob))continue;_e=P.def(Y.uniforms,"[",N.id(R),"]")}J===Dl?(D(!Array.isArray(_e),"must specify a scalar prop for textures"),P("if(",_e,"&&",_e,'._reglType==="framebuffer"){',_e,"=",_e,".color[0];","}")):J===Pl&&(D(!Array.isArray(_e),"must specify a scalar prop for cube maps"),P("if(",_e,"&&",_e,'._reglType==="framebufferCube"){',_e,"=",_e,".color[0];","}")),D.optional(function(){function fi(Zi,$b){B.assert(P,Zi,'bad data or missing for uniform "'+R+'".  '+$b)}function Vp(Zi){D(!Array.isArray(_e),"must not specify an array type for uniform"),fi("typeof "+_e+'==="'+Zi+'"',"invalid type, expected "+Zi)}function Oi(Zi,$b){Array.isArray(_e)?D(_e.length===Zi,"must have length "+Zi):fi(Y.isArrayLike+"("+_e+")&&"+_e+".length==="+Zi,"invalid vector, should have length "+Zi,B.commandStr)}function zb(Zi){D(!Array.isArray(_e),"must not specify a value type"),fi("typeof "+_e+'==="function"&&'+_e+'._reglType==="texture'+(Zi===Cb?"2d":"Cube")+'"',"invalid texture type",B.commandStr)}switch(J){case Fp:Vp("number");break;case Qc:Oi(2);break;case Jc:Oi(3);break;case eh:Oi(4);break;case Gp:Vp("number");break;case qc:Oi(2);break;case Kc:Oi(3);break;case Zc:Oi(4);break;case Up:Vp("boolean");break;case th:Oi(2);break;case rh:Oi(3);break;case nh:Oi(4);break;case Ml:Oi(4);break;case Il:Oi(9);break;case kl:Oi(16);break;case Dl:zb(Cb);break;case Pl:zb(iR);break}});var It=1;switch(J){case Dl:case Pl:var zt=P.def(_e,"._texture");P(H,".uniform1i(",Te,",",zt,".bind());"),P.exit(zt,".unbind();");continue;case Fp:case Up:Q="1i";break;case Qc:case th:Q="2i",It=2;break;case Jc:case rh:Q="3i",It=3;break;case eh:case nh:Q="4i",It=4;break;case Gp:Q="1f";break;case qc:Q="2f",It=2;break;case Kc:Q="3f",It=3;break;case Zc:Q="4f",It=4;break;case Ml:Q="Matrix2fv";break;case Il:Q="Matrix3fv";break;case kl:Q="Matrix4fv";break}if(P(H,".uniform",Q,"(",Te,","),Q.charAt(0)==="M"){var dr=Math.pow(J-Ml+2,2),rn=B.global.def("new Float32Array(",dr,")");Array.isArray(_e)?P("false,(",ur(dr,function(fi){return rn+"["+fi+"]="+_e[fi]}),",",rn,")"):P("false,(Array.isArray(",_e,")||",_e," instanceof Float32Array)?",_e,":(",ur(dr,function(fi){return rn+"["+fi+"]="+_e+"["+fi+"]"}),",",rn,")")}else It>1?P(ur(It,function(fi){return Array.isArray(_e)?_e[fi]:_e+"["+fi+"]"})):(D(!Array.isArray(_e),"uniform value must not be an array"),P(_e));P(");")}}function Mt(B,P,j,re){var oe=B.shared,Y=oe.gl,H=oe.draw,Q=re.draw;function G(){var zt=Q.elements,dr,rn=P;return zt?((zt.contextDep&&re.contextDynamic||zt.propDep)&&(rn=j),dr=zt.append(B,rn)):dr=rn.def(H,".",Jo),dr&&rn("if("+dr+")"+Y+".bindBuffer("+tR+","+dr+".buffer.buffer);"),dr}function W(){var zt=Q.count,dr,rn=P;return zt?((zt.contextDep&&re.contextDynamic||zt.propDep)&&(rn=j),dr=zt.append(B,rn),D.optional(function(){zt.MISSING&&B.assert(P,"false","missing vertex count"),zt.DYNAMIC&&B.assert(rn,dr+">=0","missing vertex count")})):(dr=rn.def(H,".",ts),D.optional(function(){B.assert(rn,dr+">=0","missing vertex count")})),dr}var R=G();function J(zt){var dr=Q[zt];return dr?dr.contextDep&&re.contextDynamic||dr.propDep?dr.append(B,j):dr.append(B,P):P.def(H,".",zt)}var ue=J(es),Ee=J(Hc),Te=W();if(typeof Te=="number"){if(Te===0)return}else j("if(",Te,"){"),j.exit("}");var _e,Ve;We&&(_e=J(Yc),Ve=B.instancing);var xt=R+".type",Yt=Q.elements&&go(Q.elements);function dt(){function zt(){j(Ve,".drawElementsInstancedANGLE(",[ue,Te,xt,Ee+"<<(("+xt+"-"+ib+")>>1)",_e],");")}function dr(){j(Ve,".drawArraysInstancedANGLE(",[ue,Ee,Te,_e],");")}R?Yt?zt():(j("if(",R,"){"),zt(),j("}else{"),dr(),j("}")):dr()}function It(){function zt(){j(Y+".drawElements("+[ue,Te,xt,Ee+"<<(("+xt+"-"+ib+")>>1)"]+");")}function dr(){j(Y+".drawArrays("+[ue,Ee,Te]+");")}R?Yt?zt():(j("if(",R,"){"),zt(),j("}else{"),dr(),j("}")):dr()}We&&(typeof _e!="number"||_e>=0)?typeof _e=="string"?(j("if(",_e,">0){"),dt(),j("}else if(",_e,"<0){"),It(),j("}")):dt():It()}function rr(B,P,j,re,oe){var Y=Ot(),H=Y.proc("body",oe);return D.optional(function(){Y.commandStr=P.commandStr,Y.command=Y.link(P.commandStr)}),We&&(Y.instancing=H.def(Y.shared.extensions,".angle_instanced_arrays")),B(Y,H,j,re),Y.compile().body}function sr(B,P,j,re){un(B,P),j.useVAO?j.drawVAO?P(B.shared.vao,".setVAO(",j.drawVAO.append(B,P),");"):P(B.shared.vao,".setVAO(",B.shared.vao,".targetVAO);"):(P(B.shared.vao,".setVAO(null);"),Fn(B,P,j,re.attributes,function(){return!0})),br(B,P,j,re.uniforms,function(){return!0}),Mt(B,P,P,j)}function ln(B,P){var j=B.proc("draw",1);un(B,j),wn(B,j,P.context),Sn(B,j,P.framebuffer),In(B,j,P),Gn(B,j,P.state),Ht(B,j,P,!1,!0);var re=P.shader.progVar.append(B,j);if(j(B.shared.gl,".useProgram(",re,".program);"),P.shader.program)sr(B,j,P,P.shader.program);else{j(B.shared.vao,".setVAO(null);");var oe=B.global.def("{}"),Y=j.def(re,".id"),H=j.def(oe,"[",Y,"]");j(B.cond(H).then(H,".call(this,a0);").else(H,"=",oe,"[",Y,"]=",B.link(function(Q){return rr(sr,B,P,Q,1)}),"(",re,");",H,".call(this,a0);"))}Object.keys(P.state).length>0&&j(B.shared.current,".dirty=true;")}function va(B,P,j,re){B.batchId="a1",un(B,P);function oe(){return!0}Fn(B,P,j,re.attributes,oe),br(B,P,j,re.uniforms,oe),Mt(B,P,P,j)}function ns(B,P,j,re){un(B,P);var oe=j.contextDep,Y=P.def(),H="a0",Q="a1",G=P.def();B.shared.props=G,B.batchId=Y;var W=B.scope(),R=B.scope();P(W.entry,"for(",Y,"=0;",Y,"<",Q,";++",Y,"){",G,"=",H,"[",Y,"];",R,"}",W.exit);function J(xt){return xt.contextDep&&oe||xt.propDep}function ue(xt){return!J(xt)}if(j.needsContext&&wn(B,R,j.context),j.needsFramebuffer&&Sn(B,R,j.framebuffer),Gn(B,R,j.state,J),j.profile&&J(j.profile)&&Ht(B,R,j,!1,!0),re)j.useVAO?j.drawVAO?J(j.drawVAO)?R(B.shared.vao,".setVAO(",j.drawVAO.append(B,R),");"):W(B.shared.vao,".setVAO(",j.drawVAO.append(B,W),");"):W(B.shared.vao,".setVAO(",B.shared.vao,".targetVAO);"):(W(B.shared.vao,".setVAO(null);"),Fn(B,W,j,re.attributes,ue),Fn(B,R,j,re.attributes,J)),br(B,W,j,re.uniforms,ue),br(B,R,j,re.uniforms,J),Mt(B,W,R,j);else{var Ee=B.global.def("{}"),Te=j.shader.progVar.append(B,R),_e=R.def(Te,".id"),Ve=R.def(Ee,"[",_e,"]");R(B.shared.gl,".useProgram(",Te,".program);","if(!",Ve,"){",Ve,"=",Ee,"[",_e,"]=",B.link(function(xt){return rr(va,B,j,xt,2)}),"(",Te,");}",Ve,".call(this,a0[",Y,"],",Y,");")}}function z(B,P){var j=B.proc("batch",2);B.batchId="0",un(B,j);var re=!1,oe=!0;Object.keys(P.context).forEach(function(Ee){re=re||P.context[Ee].propDep}),re||(wn(B,j,P.context),oe=!1);var Y=P.framebuffer,H=!1;Y?(Y.propDep?re=H=!0:Y.contextDep&&re&&(H=!0),H||Sn(B,j,Y)):Sn(B,j,null),P.state.viewport&&P.state.viewport.propDep&&(re=!0);function Q(Ee){return Ee.contextDep&&re||Ee.propDep}In(B,j,P),Gn(B,j,P.state,function(Ee){return!Q(Ee)}),(!P.profile||!Q(P.profile))&&Ht(B,j,P,!1,"a1"),P.contextDep=re,P.needsContext=oe,P.needsFramebuffer=H;var G=P.shader.progVar;if(G.contextDep&&re||G.propDep)ns(B,j,P,null);else{var W=G.append(B,j);if(j(B.shared.gl,".useProgram(",W,".program);"),P.shader.program)ns(B,j,P,P.shader.program);else{j(B.shared.vao,".setVAO(null);");var R=B.global.def("{}"),J=j.def(W,".id"),ue=j.def(R,"[",J,"]");j(B.cond(ue).then(ue,".call(this,a0,a1);").else(ue,"=",R,"[",J,"]=",B.link(function(Ee){return rr(ns,B,P,Ee,2)}),"(",W,");",ue,".call(this,a0,a1);"))}}Object.keys(P.state).length>0&&j(B.shared.current,".dirty=true;")}function ve(B,P){var j=B.proc("scope",3);B.batchId="a2";var re=B.shared,oe=re.current;wn(B,j,P.context),P.framebuffer&&P.framebuffer.append(B,j),Lb(Object.keys(P.state)).forEach(function(H){var Q=P.state[H],G=Q.append(B,j);sn(G)?G.forEach(function(W,R){j.set(B.next[H],"["+R+"]",W)}):j.set(re.next,"."+H,G)}),Ht(B,j,P,!0,!0),[Jo,Hc,ts,Yc,es].forEach(function(H){var Q=P.draw[H];!Q||j.set(re.draw,"."+H,""+Q.append(B,j))}),Object.keys(P.uniforms).forEach(function(H){var Q=P.uniforms[H].append(B,j);Array.isArray(Q)&&(Q="["+Q.join()+"]"),j.set(re.uniforms,"["+N.id(H)+"]",Q)}),Object.keys(P.attributes).forEach(function(H){var Q=P.attributes[H].append(B,j),G=B.scopeAttrib(H);Object.keys(new ie).forEach(function(W){j.set(G,"."+W,Q[W])})}),P.scopeVAO&&j.set(re.vao,".targetVAO",P.scopeVAO.append(B,j));function Y(H){var Q=P.shader[H];Q&&j.set(re.shader,"."+H,Q.append(B,j))}Y(Cl),Y(Al),Object.keys(P.state).length>0&&(j(oe,".dirty=true;"),j.exit(oe,".dirty=true;")),j("a1(",B.shared.context,",a0,",B.batchId,");")}function fe(B){if(!(typeof B!="object"||sn(B))){for(var P=Object.keys(B),j=0;j<P.length;++j)if(ar.isDynamic(B[P[j]]))return!0;return!1}}function st(B,P,j){var re=P.static[j];if(!re||!fe(re))return;var oe=B.global,Y=Object.keys(re),H=!1,Q=!1,G=!1,W=B.global.def("{}");Y.forEach(function(J){var ue=re[J];if(ar.isDynamic(ue)){typeof ue=="function"&&(ue=re[J]=ar.unbox(ue));var Ee=yi(ue,null);H=H||Ee.thisDep,G=G||Ee.propDep,Q=Q||Ee.contextDep}else{switch(oe(W,".",J,"="),typeof ue){case"number":oe(ue);break;case"string":oe('"',ue,'"');break;case"object":Array.isArray(ue)&&oe("[",ue.join(),"]");break;default:oe(B.link(ue));break}oe(";")}});function R(J,ue){Y.forEach(function(Ee){var Te=re[Ee];if(!!ar.isDynamic(Te)){var _e=J.invoke(ue,Te);ue(W,".",Ee,"=",_e,";")}})}P.dynamic[j]=new ar.DynamicVariable(jc,{thisDep:H,contextDep:Q,propDep:G,ref:W,append:R}),delete P.static[j]}function tr(B,P,j,re,oe){var Y=Ot();Y.stats=Y.link(oe),Object.keys(P.static).forEach(function(Q){st(Y,P,Q)}),eR.forEach(function(Q){st(Y,B,Q)});var H=vn(B,P,j,re,Y);return ln(Y,H),ve(Y,H),z(Y,H),n(Y.compile(),{destroy:function(){H.shader.program.destroy()}})}return{next:ot,current:De,procs:function(){var B=Ot(),P=B.proc("poll"),j=B.proc("refresh"),re=B.block();P(re),j(re);var oe=B.shared,Y=oe.gl,H=oe.next,Q=oe.current;re(Q,".dirty=false;"),Sn(B,P),Sn(B,j,null,!0);var G;We&&(G=B.link(We)),$.oes_vertex_array_object&&j(B.link($.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var W=0;W<de.maxAttributes;++W){var R=j.def(oe.attributes,"[",W,"]"),J=B.cond(R,".buffer");J.then(Y,".enableVertexAttribArray(",W,");",Y,".bindBuffer(",mu,",",R,".buffer.buffer);",Y,".vertexAttribPointer(",W,",",R,".size,",R,".type,",R,".normalized,",R,".stride,",R,".offset);").else(Y,".disableVertexAttribArray(",W,");",Y,".vertexAttrib4f(",W,",",R,".x,",R,".y,",R,".z,",R,".w);",R,".buffer=null;"),j(J),We&&j(G,".vertexAttribDivisorANGLE(",W,",",R,".divisor);")}return j(B.shared.vao,".currentVAO=null;",B.shared.vao,".setVAO(",B.shared.vao,".targetVAO);"),Object.keys(Qe).forEach(function(ue){var Ee=Qe[ue],Te=re.def(H,".",ue),_e=B.block();_e("if(",Te,"){",Y,".enable(",Ee,")}else{",Y,".disable(",Ee,")}",Q,".",ue,"=",Te,";"),j(_e),P("if(",Te,"!==",Q,".",ue,"){",_e,"}")}),Object.keys(Pe).forEach(function(ue){var Ee=Pe[ue],Te=De[ue],_e,Ve,xt=B.block();if(xt(Y,".",Ee,"("),sn(Te)){var Yt=Te.length;_e=B.global.def(H,".",ue),Ve=B.global.def(Q,".",ue),xt(ur(Yt,function(dt){return _e+"["+dt+"]"}),");",ur(Yt,function(dt){return Ve+"["+dt+"]="+_e+"["+dt+"];"}).join("")),P("if(",ur(Yt,function(dt){return _e+"["+dt+"]!=="+Ve+"["+dt+"]"}).join("||"),"){",xt,"}")}else _e=re.def(H,".",ue),Ve=re.def(Q,".",ue),xt(_e,");",Q,".",ue,"=",_e,";"),P("if(",_e,"!==",Ve,"){",xt,"}");j(xt)}),B.compile()}(),compile:tr}}function xR(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var _R=34918,wR=34919,Rb=35007,SR=function(A,N){if(!N.ext_disjoint_timer_query)return null;var $=[];function de(){return $.pop()||N.ext_disjoint_timer_query.createQueryEXT()}function Ae(We){$.push(We)}var ce=[];function ye(We){var it=de();N.ext_disjoint_timer_query.beginQueryEXT(Rb,it),ce.push(it),Be(ce.length-1,ce.length,We)}function Re(){N.ext_disjoint_timer_query.endQueryEXT(Rb)}function Ue(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var je=[];function ze(){return je.pop()||new Ue}function Ke(We){je.push(We)}var et=[];function Be(We,it,De){var ot=ze();ot.startQueryIndex=We,ot.endQueryIndex=it,ot.sum=0,ot.stats=De,et.push(ot)}var Ze=[],ie=[];function me(){var We,it,De=ce.length;if(De!==0){ie.length=Math.max(ie.length,De+1),Ze.length=Math.max(Ze.length,De+1),Ze[0]=0,ie[0]=0;var ot=0;for(We=0,it=0;it<ce.length;++it){var Ne=ce[it];N.ext_disjoint_timer_query.getQueryObjectEXT(Ne,wR)?(ot+=N.ext_disjoint_timer_query.getQueryObjectEXT(Ne,_R),Ae(Ne)):ce[We++]=Ne,Ze[it+1]=ot,ie[it+1]=We}for(ce.length=We,We=0,it=0;it<et.length;++it){var Qe=et[it],Pe=Qe.startQueryIndex,Je=Qe.endQueryIndex;Qe.sum+=Ze[Je]-Ze[Pe];var _t=ie[Pe],Ft=ie[Je];Ft===_t?(Qe.stats.gpuTime+=Qe.sum/1e6,Ke(Qe)):(Qe.startQueryIndex=_t,Qe.endQueryIndex=Ft,et[We++]=Qe)}et.length=We}}return{beginQuery:ye,endQuery:Re,pushScopeStats:Be,update:me,getNumPendingQueries:function(){return ce.length},clear:function(){$.push.apply($,ce);for(var We=0;We<$.length;We++)N.ext_disjoint_timer_query.deleteQueryEXT($[We]);ce.length=0,$.length=0},restore:function(){ce.length=0,$.length=0}}},ER=16384,CR=256,AR=1024,TR=34962,Bb="webglcontextlost",Gb="webglcontextrestored",Fb=1,MR=2,IR=3;function Ub(A,N){for(var $=0;$<A.length;++$)if(A[$]===N)return $;return-1}function kR(A){var N=fr(A);if(!N)return null;var $=N.gl,de=$.getContextAttributes(),Ae=$.isContextLost(),ce=Er($,N);if(!ce)return null;var ye=Sr(),Re=xR(),Ue=ce.extensions,je=SR($,Ue),ze=jt(),Ke=$.drawingBufferWidth,et=$.drawingBufferHeight,Be={tick:0,time:0,viewportWidth:Ke,viewportHeight:et,framebufferWidth:Ke,framebufferHeight:et,drawingBufferWidth:Ke,drawingBufferHeight:et,pixelRatio:N.pixelRatio},Ze={},ie={elements:null,primitive:4,count:-1,offset:0,instances:-1},me=pL($,Ue),We=DL($,Re,N,De),it=VO($,Ue,me,Re,We);function De(Mt){return it.destroyBuffer(Mt)}var ot=VL($,Ue,We,Re),Ne=HO($,ye,Re,N),Qe=xO($,Ue,me,function(){_t.procs.poll()},Be,Re,N),Pe=_O($,Ue,me,Re,N),Je=zO($,Ue,me,Qe,Pe,Re),_t=bR($,ye,Ue,me,We,ot,Qe,Je,Ze,it,Ne,ie,Be,je,N),Ft=KO($,Je,_t.procs.poll,Be,de,Ue,me),tt=_t.next,He=$.canvas,Ie=[],Ot=[],Xt=[],ht=[N.onDestroy],er=null;function Ut(){if(Ie.length===0){je&&je.update(),er=null;return}er=ei.next(Ut),Gn();for(var Mt=Ie.length-1;Mt>=0;--Mt){var rr=Ie[Mt];rr&&rr(Be,null,0)}$.flush(),je&&je.update()}function Kt(){!er&&Ie.length>0&&(er=ei.next(Ut))}function hr(){er&&(ei.cancel(Ut),er=null)}function dn(Mt){Mt.preventDefault(),Ae=!0,hr(),Ot.forEach(function(rr){rr()})}function Tn(Mt){$.getError(),Ae=!1,ce.restore(),Ne.restore(),We.restore(),Qe.restore(),Pe.restore(),Je.restore(),it.restore(),je&&je.restore(),_t.procs.refresh(),Kt(),Xt.forEach(function(rr){rr()})}He&&(He.addEventListener(Bb,dn,!1),He.addEventListener(Gb,Tn,!1));function ir(){Ie.length=0,hr(),He&&(He.removeEventListener(Bb,dn),He.removeEventListener(Gb,Tn)),Ne.clear(),Je.clear(),Pe.clear(),Qe.clear(),ot.clear(),We.clear(),it.clear(),je&&je.clear(),ht.forEach(function(Mt){Mt()})}function _n(Mt){D(!!Mt,"invalid args to regl({...})"),D.type(Mt,"object","invalid args to regl({...})");function rr(oe){var Y=n({},oe);delete Y.uniforms,delete Y.attributes,delete Y.context,delete Y.vao,"stencil"in Y&&Y.stencil.op&&(Y.stencil.opBack=Y.stencil.opFront=Y.stencil.op,delete Y.stencil.op);function H(Q){if(Q in Y){var G=Y[Q];delete Y[Q],Object.keys(G).forEach(function(W){Y[Q+"."+W]=G[W]})}}return H("blend"),H("depth"),H("cull"),H("stencil"),H("polygonOffset"),H("scissor"),H("sample"),"vao"in oe&&(Y.vao=oe.vao),Y}function sr(oe,Y){var H={},Q={};return Object.keys(oe).forEach(function(G){var W=oe[G];if(ar.isDynamic(W)){Q[G]=ar.unbox(W,G);return}else if(Y&&Array.isArray(W)){for(var R=0;R<W.length;++R)if(ar.isDynamic(W[R])){Q[G]=ar.unbox(W,G);return}}H[G]=W}),{dynamic:Q,static:H}}var ln=sr(Mt.context||{},!0),va=sr(Mt.uniforms||{},!0),ns=sr(Mt.attributes||{},!1),z=sr(rr(Mt),!1),ve={gpuTime:0,cpuTime:0,count:0},fe=_t.compile(z,ns,va,ln,ve),st=fe.draw,tr=fe.batch,B=fe.scope,P=[];function j(oe){for(;P.length<oe;)P.push(null);return P}function re(oe,Y){var H;if(Ae&&D.raise("context lost"),typeof oe=="function")return B.call(this,null,oe,0);if(typeof Y=="function")if(typeof oe=="number")for(H=0;H<oe;++H)B.call(this,null,Y,H);else if(Array.isArray(oe))for(H=0;H<oe.length;++H)B.call(this,oe[H],Y,H);else return B.call(this,oe,Y,0);else if(typeof oe=="number"){if(oe>0)return tr.call(this,j(oe|0),oe|0)}else if(Array.isArray(oe)){if(oe.length)return tr.call(this,oe,oe.length)}else return st.call(this,oe)}return n(re,{stats:ve,destroy:function(){fe.destroy()}})}var jr=Je.setFBO=_n({framebuffer:ar.define.call(null,Fb,"framebuffer")});function vn(Mt,rr){var sr=0;_t.procs.poll();var ln=rr.color;ln&&($.clearColor(+ln[0]||0,+ln[1]||0,+ln[2]||0,+ln[3]||0),sr|=ER),"depth"in rr&&($.clearDepth(+rr.depth),sr|=CR),"stencil"in rr&&($.clearStencil(rr.stencil|0),sr|=AR),D(!!sr,"called regl.clear with no buffer specified"),$.clear(sr)}function wn(Mt){if(D(typeof Mt=="object"&&Mt,"regl.clear() takes an object as input"),"framebuffer"in Mt)if(Mt.framebuffer&&Mt.framebuffer_reglType==="framebufferCube")for(var rr=0;rr<6;++rr)jr(n({framebuffer:Mt.framebuffer.faces[rr]},Mt),vn);else jr(Mt,vn);else vn(null,Mt)}function Sn(Mt){D.type(Mt,"function","regl.frame() callback must be a function"),Ie.push(Mt);function rr(){var sr=Ub(Ie,Mt);D(sr>=0,"cannot cancel a frame twice");function ln(){var va=Ub(Ie,ln);Ie[va]=Ie[Ie.length-1],Ie.length-=1,Ie.length<=0&&hr()}Ie[sr]=ln}return Kt(),{cancel:rr}}function In(){var Mt=tt.viewport,rr=tt.scissor_box;Mt[0]=Mt[1]=rr[0]=rr[1]=0,Be.viewportWidth=Be.framebufferWidth=Be.drawingBufferWidth=Mt[2]=rr[2]=$.drawingBufferWidth,Be.viewportHeight=Be.framebufferHeight=Be.drawingBufferHeight=Mt[3]=rr[3]=$.drawingBufferHeight}function Gn(){Be.tick+=1,Be.time=Ht(),In(),_t.procs.poll()}function un(){Qe.refresh(),In(),_t.procs.refresh(),je&&je.update()}function Ht(){return(jt()-ze)/1e3}un();function Fn(Mt,rr){D.type(rr,"function","listener callback must be a function");var sr;switch(Mt){case"frame":return Sn(rr);case"lost":sr=Ot;break;case"restore":sr=Xt;break;case"destroy":sr=ht;break;default:D.raise("invalid event, must be one of frame,lost,restore,destroy")}return sr.push(rr),{cancel:function(){for(var ln=0;ln<sr.length;++ln)if(sr[ln]===rr){sr[ln]=sr[sr.length-1],sr.pop();return}}}}var br=n(_n,{clear:wn,prop:ar.define.bind(null,Fb),context:ar.define.bind(null,MR),this:ar.define.bind(null,IR),draw:_n({}),buffer:function(Mt){return We.create(Mt,TR,!1,!1)},elements:function(Mt){return ot.create(Mt,!1)},texture:Qe.create2D,cube:Qe.createCube,renderbuffer:Pe.create,framebuffer:Je.create,framebufferCube:Je.createCube,vao:it.createVAO,attributes:de,frame:Sn,on:Fn,limits:me,hasExtension:function(Mt){return me.extensions.indexOf(Mt.toLowerCase())>=0},read:Ft,destroy:ir,_gl:$,_refresh:un,poll:function(){Gn(),je&&je.update()},now:Ht,stats:Re});return N.onDone(null,br),br}return kR})}),gne=function(){function r(e,t){wt(this,r),this.attribute=void 0,this.buffer=void 0;var n=t.buffer,i=t.offset,a=t.stride,o=t.normalized,s=t.size,u=t.divisor;this.buffer=n,this.attribute={buffer:n.get(),offset:i||0,stride:a||0,normalized:o||!1,divisor:u||0},s&&(this.attribute.size=s)}return Bt(r,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(t){this.buffer.subData(t)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),r}(),ro,ec,no,Xi,tc,Fo,rc,vv,Da,Hs,Jn,Pa,Na,pv,yne=(ro={},Ce(ro,ae.POINTS,"points"),Ce(ro,ae.LINES,"lines"),Ce(ro,ae.LINE_LOOP,"line loop"),Ce(ro,ae.LINE_STRIP,"line strip"),Ce(ro,ae.TRIANGLES,"triangles"),Ce(ro,ae.TRIANGLE_FAN,"triangle fan"),Ce(ro,ae.TRIANGLE_STRIP,"triangle strip"),ro),lk=(ec={},Ce(ec,ae.STATIC_DRAW,"static"),Ce(ec,ae.DYNAMIC_DRAW,"dynamic"),Ce(ec,ae.STREAM_DRAW,"stream"),ec),s0=(no={},Ce(no,ae.BYTE,"int8"),Ce(no,ae.UNSIGNED_INT,"int16"),Ce(no,ae.INT,"int32"),Ce(no,ae.UNSIGNED_BYTE,"uint8"),Ce(no,ae.UNSIGNED_SHORT,"uint16"),Ce(no,ae.UNSIGNED_INT,"uint32"),Ce(no,ae.FLOAT,"float"),no),mne=(Xi={},Ce(Xi,ae.ALPHA,"alpha"),Ce(Xi,ae.LUMINANCE,"luminance"),Ce(Xi,ae.LUMINANCE_ALPHA,"luminance alpha"),Ce(Xi,ae.RGB,"rgb"),Ce(Xi,ae.RGBA,"rgba"),Ce(Xi,ae.RGBA4,"rgba4"),Ce(Xi,ae.RGB5_A1,"rgb5 a1"),Ce(Xi,ae.RGB565,"rgb565"),Ce(Xi,ae.DEPTH_COMPONENT,"depth"),Ce(Xi,ae.DEPTH_STENCIL,"depth stencil"),Xi),bne=(tc={},Ce(tc,ae.DONT_CARE,"dont care"),Ce(tc,ae.NICEST,"nice"),Ce(tc,ae.FASTEST,"fast"),tc),fk=(Fo={},Ce(Fo,ae.NEAREST,"nearest"),Ce(Fo,ae.LINEAR,"linear"),Ce(Fo,ae.LINEAR_MIPMAP_LINEAR,"mipmap"),Ce(Fo,ae.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),Ce(Fo,ae.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),Ce(Fo,ae.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Fo),ck=(rc={},Ce(rc,ae.REPEAT,"repeat"),Ce(rc,ae.CLAMP_TO_EDGE,"clamp"),Ce(rc,ae.MIRRORED_REPEAT,"mirror"),rc),xne=(vv={},Ce(vv,ae.NONE,"none"),Ce(vv,ae.BROWSER_DEFAULT_WEBGL,"browser"),vv),_ne=(Da={},Ce(Da,ae.NEVER,"never"),Ce(Da,ae.ALWAYS,"always"),Ce(Da,ae.LESS,"less"),Ce(Da,ae.LEQUAL,"lequal"),Ce(Da,ae.GREATER,"greater"),Ce(Da,ae.GEQUAL,"gequal"),Ce(Da,ae.EQUAL,"equal"),Ce(Da,ae.NOTEQUAL,"notequal"),Da),hk=(Hs={},Ce(Hs,ae.FUNC_ADD,"add"),Ce(Hs,ae.MIN_EXT,"min"),Ce(Hs,ae.MAX_EXT,"max"),Ce(Hs,ae.FUNC_SUBTRACT,"subtract"),Ce(Hs,ae.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Hs),gv=(Jn={},Ce(Jn,ae.ZERO,"zero"),Ce(Jn,ae.ONE,"one"),Ce(Jn,ae.SRC_COLOR,"src color"),Ce(Jn,ae.ONE_MINUS_SRC_COLOR,"one minus src color"),Ce(Jn,ae.SRC_ALPHA,"src alpha"),Ce(Jn,ae.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),Ce(Jn,ae.DST_COLOR,"dst color"),Ce(Jn,ae.ONE_MINUS_DST_COLOR,"one minus dst color"),Ce(Jn,ae.DST_ALPHA,"dst alpha"),Ce(Jn,ae.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),Ce(Jn,ae.CONSTANT_COLOR,"constant color"),Ce(Jn,ae.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),Ce(Jn,ae.CONSTANT_ALPHA,"constant alpha"),Ce(Jn,ae.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),Ce(Jn,ae.SRC_ALPHA_SATURATE,"src alpha saturate"),Jn),wne=(Pa={},Ce(Pa,ae.NEVER,"never"),Ce(Pa,ae.ALWAYS,"always"),Ce(Pa,ae.LESS,"less"),Ce(Pa,ae.LEQUAL,"lequal"),Ce(Pa,ae.GREATER,"greater"),Ce(Pa,ae.GEQUAL,"gequal"),Ce(Pa,ae.EQUAL,"equal"),Ce(Pa,ae.NOTEQUAL,"notequal"),Pa),il=(Na={},Ce(Na,ae.ZERO,"zero"),Ce(Na,ae.KEEP,"keep"),Ce(Na,ae.REPLACE,"replace"),Ce(Na,ae.INVERT,"invert"),Ce(Na,ae.INCR,"increment"),Ce(Na,ae.DECR,"decrement"),Ce(Na,ae.INCR_WRAP,"increment wrap"),Ce(Na,ae.DECR_WRAP,"decrement wrap"),Na),Sne=(pv={},Ce(pv,ae.FRONT,"front"),Ce(pv,ae.BACK,"back"),pv),Ene=function(){function r(e,t){wt(this,r),this.buffer=void 0;var n=t.data,i=t.usage,a=t.type;this.buffer=e.buffer({data:n,usage:lk[i||ae.STATIC_DRAW],type:s0[a||ae.UNSIGNED_BYTE]})}return Bt(r,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){}},{key:"subData",value:function(t){var n=t.data,i=t.offset;this.buffer.subdata(n,i)}}]),r}(),Cne=9007199254740991,Ane="[object Arguments]",Tne="[object Array]",Mne="[object Boolean]",Ine="[object Date]",kne="[object Error]",Dne="[object Function]",Pne="[object Map]",Nne="[object Number]",Lne="[object Object]",One="[object RegExp]",Rne="[object Set]",Bne="[object String]",Gne="[object WeakMap]",Fne="[object ArrayBuffer]",Une="[object DataView]",zne="[object Float32Array]",$ne="[object Float64Array]",Vne="[object Int8Array]",Wne="[object Int16Array]",jne="[object Int32Array]",Xne="[object Uint8Array]",Hne="[object Uint8ClampedArray]",Yne="[object Uint16Array]",qne="[object Uint32Array]",tn={};tn[zne]=tn[$ne]=tn[Vne]=tn[Wne]=tn[jne]=tn[Xne]=tn[Hne]=tn[Yne]=tn[qne]=!0;tn[Ane]=tn[Tne]=tn[Fne]=tn[Mne]=tn[Une]=tn[Ine]=tn[kne]=tn[Dne]=tn[Pne]=tn[Nne]=tn[Lne]=tn[One]=tn[Rne]=tn[Bne]=tn[Gne]=!1;var Kne=Object.prototype,Zne=Kne.toString;function Qne(r){return eie(r)&&Jne(r.length)&&!!tn[Zne.call(r)]}function Jne(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=Cne}function eie(r){return!!r&&us(r)==="object"}var u0=Qne;function dk(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function vk(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?dk(Object(t),!0).forEach(function(n){Ce(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):dk(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var tie=`attribute vec3 a_Position;
attribute vec2 a_TexCoord;

varying vec2 v_TexCoord;

void main() {
  gl_Position = vec4(a_Position, 1.0);
  v_TexCoord = a_TexCoord;
}`,pk=0,rie=function(){function r(e,t){var n=this;wt(this,r),this.reGl=e,this.context=t,this.entity=Ia(),this.texFBO=void 0,this.computeCommand=void 0,this.textureCache={},this.outputTextureName=void 0,this.swapOutputTextureName=void 0,this.compiledPingpong=void 0,this.dynamicPingpong=void 0;var i={};this.context.uniforms.forEach(function(l){var f=l.name,c=l.type,h=l.data,d=l.isReferer,v=l.storageClass;if(v===Oo.StorageBuffer){if(d)n.textureCache[f]={data:void 0},i["".concat(f,"Size")]=function(){return h.compiledBundle.context.output.textureSize};else{n.textureCache[f]=n.calcDataTexture(f,c,h);var p=n.textureCache[f],g=p.textureWidth,y=p.isOutput;i["".concat(f,"Size")]=[g,g],y&&(n.outputTextureName=f,n.context.needPingpong&&(n.outputTextureName="".concat(f,"Output"),n.textureCache[n.outputTextureName]=n.calcDataTexture(f,c,h)))}i[f]=function(){return n.textureCache[f].texture}}else if(v===Oo.Uniform){if(h&&(Array.isArray(h)||u0(h))&&h.length>16)throw new Error("invalid data type ".concat(c));i[f]=function(){return l.data}}});var a=this.getOuputDataTexture(),o=a.textureWidth,s=a.texelCount;i.u_OutputTextureSize=[o,o],i.u_OutputTexelCount=s,this.context.output.textureSize=[o,o];var u={attributes:{a_Position:[[-1,1,0],[-1,-1,0],[1,1,0],[1,-1,0]],a_TexCoord:[[0,1],[0,0],[1,1],[1,0]]},frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(this.context.shader),uniforms:i,vert:tie,primitive:"triangle strip",count:4};this.computeCommand=this.reGl(u)}return Bt(r,[{key:"run",value:function(){var t=this;this.context.maxIteration>1&&this.context.needPingpong&&(this.compiledPingpong=!0),(this.compiledPingpong||this.dynamicPingpong)&&this.swap(),this.texFBO=this.reGl.framebuffer({color:this.getOuputDataTexture().texture}),this.texFBO.use(function(){t.computeCommand()})}},{key:"readData",value:function(){var e=wr(bt.mark(function n(){var i=this,a,o,s,u,l,f,c,h;return bt.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(this.reGl({framebuffer:this.texFBO})(function(){a=i.reGl.read()}),!a){v.next=6;break}if(o=this.getOuputDataTexture(),s=o.originalDataLength,u=o.elementsPerTexel,l=o.typedArrayConstructor,f=l===void 0?Float32Array:l,c=[],u!==4)for(h=0;h<a.length;h+=4)u===1?c.push(a[h]):u===2?c.push(a[h],a[h+1]):c.push(a[h],a[h+1],a[h+2]);else c=a;return v.abrupt("return",new f(c.slice(0,s)));case 6:return v.abrupt("return",new Float32Array);case 7:case"end":return v.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"confirmInput",value:function(t,n){var i;this.entity===t.entity?(this.dynamicPingpong=!0,i=this):i=t,this.textureCache[n].id=i.getOuputDataTexture().id,this.textureCache[n].texture=i.getOuputDataTexture().texture}},{key:"updateUniform",value:function(){}},{key:"updateBuffer",value:function(t,n){var i=this.context.uniforms.find(function(u){var l=u.name;return l===t});if(i){var a=this.calcDataTexture(t,i.type,n),o=a.texture,s=a.data;this.textureCache[t].data=s,this.textureCache[t].texture=o}}},{key:"destroy",value:function(){}},{key:"swap",value:function(){if(this.swapOutputTextureName||this.createSwapOutputDataTexture(),this.compiledPingpong){var t=this.context.output.name;this.textureCache[t].id=this.getOuputDataTexture().id,this.textureCache[t].texture=this.getOuputDataTexture().texture}var n=this.outputTextureName;this.outputTextureName=this.swapOutputTextureName,this.swapOutputTextureName=n}},{key:"getOuputDataTexture",value:function(){return this.textureCache[this.outputTextureName]}},{key:"createSwapOutputDataTexture",value:function(){var t=this.cloneDataTexture(this.getOuputDataTexture());this.swapOutputTextureName="".concat(this.entity,"-swap"),this.textureCache[this.swapOutputTextureName]=t}},{key:"cloneDataTexture",value:function(t){var n=t.data,i=t.textureWidth;return vk(vk({},t),{},{id:pk++,texture:this.reGl.texture({width:i,height:i,data:n,type:"float"})})}},{key:"calcDataTexture",value:function(t,n,i){var a=1;n===zs.Vector4FloatArray&&(a=4);for(var o=[],s=0;s<i.length;s+=a)a===1?o.push(i[s],0,0,0):a===2?o.push(i[s],i[s+1],0,0):a===3?o.push(i[s],i[s+1],i[s+2],0):a===4&&o.push(i[s],i[s+1],i[s+2],i[s+3]);var u=i.length,l=Math.ceil(u/a),f=Math.ceil(Math.sqrt(l)),c=f*f;l<c&&o.push.apply(o,En(new Array((c-l)*4).fill(0)));var h=this.reGl.texture({width:f,height:f,data:o,type:"float"});return{id:pk++,data:o,originalDataLength:u,typedArrayConstructor:u0(i)?i.constructor:void 0,textureWidth:f,texture:h,texelCount:l,elementsPerTexel:a,isOutput:t===this.context.output.name}}}]),r}(),nie=function(){function r(e,t){wt(this,r),this.elements=void 0;var n=t.data,i=t.usage,a=t.type,o=t.count;this.elements=e.elements({data:n,usage:lk[i||ae.STATIC_DRAW],type:s0[a||ae.UNSIGNED_BYTE],count:o})}return Bt(r,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(t){var n=t.data;this.elements.subdata(n)}},{key:"destroy",value:function(){this.elements.destroy()}}]),r}(),iie=function(){function r(e,t){wt(this,r),this.framebuffer=void 0;var n=t.width,i=t.height,a=t.color,o=t.colors;t.depth,t.stencil;var s={width:n,height:i};Array.isArray(o)&&(s.colors=o.map(function(u){return u.get()})),a&&typeof a!="boolean"&&(s.color=a.get()),this.framebuffer=e.framebuffer(s)}return Bt(r,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(t){var n=t.width,i=t.height;this.framebuffer.resize(n,i)}}]),r}();function aie(r){var e=us(r);return r!=null&&(e==="object"||e==="function")}function nc(r){var e={};return Object.keys(r).forEach(function(t){l0(t,r[t],e,"")}),e}function l0(r,e,t,n){if(e===null||typeof e=="number"||typeof e=="boolean"||Array.isArray(e)&&typeof e[0]=="number"||u0(e)||e===""||e.resize!==void 0){t["".concat(n&&n+".").concat(r)]=e;return}aie(e)&&Object.keys(e).forEach(function(i){l0(i,e[i],t,"".concat(n&&n+".").concat(r))}),Array.isArray(e)&&e.forEach(function(i,a){Object.keys(i).forEach(function(o){l0(o,i[o],t,"".concat(n&&n+".").concat(r,"[").concat(a,"]"))})})}function gk(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function al(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?gk(Object(t),!0).forEach(function(n){Ce(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):gk(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var oie=function(){function r(e,t){wt(this,r),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=e;var n=t.vs,i=t.fs,a=t.defines,o=t.attributes,s=t.uniforms,u=t.primitive,l=t.count,f=t.elements,c=t.depth,h=t.blend,d=t.stencil,v=t.cull,p=t.instances,g=t.scissor,y=t.viewport,m={};s&&(this.uniforms=nc(s),Object.keys(s).forEach(function(S){m[S]=e.prop(S)}));var b={};Object.keys(o).forEach(function(S){b[S]=o[S].get()});var x=a&&this.generateDefines(a)||"",_={attributes:b,frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(x,`
`).concat(i),uniforms:m,vert:`
`.concat(x,`
`).concat(n),primitive:yne[u===void 0?ae.TRIANGLES:u]};p&&(_.instances=p),l&&(_.count=l),f&&(_.elements=f.get()),g&&(_.scissor=g),y&&(_.viewport=y),this.initDepthDrawParams({depth:c},_),this.initBlendDrawParams({blend:h},_),this.initStencilDrawParams({stencil:d},_),this.initCullDrawParams({cull:v},_),this.drawCommand=e(_)}return Bt(r,[{key:"addUniforms",value:function(t){this.uniforms=al(al({},this.uniforms),nc(t))}},{key:"draw",value:function(t){var n=al(al({},this.uniforms),nc(t.uniforms||{})),i={};Object.keys(n).forEach(function(a){var o=us(n[a]);o==="boolean"||o==="number"||Array.isArray(n[a])||n[a].BYTES_PER_ELEMENT?i[a]=n[a]:o==="string"||(i[a]=n[a].get())}),this.drawCommand(i)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(t,n){var i=t.depth;i&&(n.depth={enable:i.enable===void 0?!0:!!i.enable,mask:i.mask===void 0?!0:!!i.mask,func:_ne[i.func||ae.LESS],range:i.range||[0,1]})}},{key:"initBlendDrawParams",value:function(t,n){var i=t.blend;if(i){var a=i.enable,o=i.func,s=i.equation,u=i.color,l=u===void 0?[0,0,0,0]:u;n.blend={enable:!!a,func:{srcRGB:gv[o&&o.srcRGB||ae.SRC_ALPHA],srcAlpha:gv[o&&o.srcAlpha||ae.SRC_ALPHA],dstRGB:gv[o&&o.dstRGB||ae.ONE_MINUS_SRC_ALPHA],dstAlpha:gv[o&&o.dstAlpha||ae.ONE_MINUS_SRC_ALPHA]},equation:{rgb:hk[s&&s.rgb||ae.FUNC_ADD],alpha:hk[s&&s.alpha||ae.FUNC_ADD]},color:l}}}},{key:"initStencilDrawParams",value:function(t,n){var i=t.stencil;if(i){var a=i.enable,o=i.mask,s=o===void 0?-1:o,u=i.func,l=u===void 0?{cmp:ae.ALWAYS,ref:0,mask:-1}:u,f=i.opFront,c=f===void 0?{fail:ae.KEEP,zfail:ae.KEEP,zpass:ae.KEEP}:f,h=i.opBack,d=h===void 0?{fail:ae.KEEP,zfail:ae.KEEP,zpass:ae.KEEP}:h;n.stencil={enable:!!a,mask:s,func:al(al({},l),{},{cmp:wne[l.cmp]}),opFront:{fail:il[c.fail],zfail:il[c.zfail],zpass:il[c.zpass]},opBack:{fail:il[d.fail],zfail:il[d.zfail],zpass:il[d.zpass]}}}}},{key:"initCullDrawParams",value:function(t,n){var i=t.cull;if(i){var a=i.enable,o=i.face,s=o===void 0?ae.BACK:o;n.cull={enable:!!a,face:Sne[s]}}}},{key:"generateDefines",value:function(t){return Object.keys(t).map(function(n){return"#define ".concat(n," ").concat(Number(t[n]))}).join(`
`)}}]),r}(),sie=function(){function r(e,t){wt(this,r),this.texture=void 0,this.width=void 0,this.height=void 0;var n=t.data,i=t.type,a=i===void 0?ae.UNSIGNED_BYTE:i,o=t.width,s=t.height,u=t.flipY,l=u===void 0?!1:u,f=t.format,c=f===void 0?ae.RGBA:f,h=t.mipmap,d=h===void 0?!1:h,v=t.wrapS,p=v===void 0?ae.CLAMP_TO_EDGE:v,g=t.wrapT,y=g===void 0?ae.CLAMP_TO_EDGE:g,m=t.aniso,b=m===void 0?0:m,x=t.alignment,_=x===void 0?1:x,S=t.premultiplyAlpha,E=S===void 0?!1:S,C=t.mag,M=C===void 0?ae.NEAREST:C,w=t.min,T=w===void 0?ae.NEAREST:w,I=t.colorSpace,k=I===void 0?ae.BROWSER_DEFAULT_WEBGL:I;this.width=o,this.height=s;var O={width:o,height:s,type:s0[a],format:mne[c],wrapS:ck[p],wrapT:ck[y],mag:fk[M],min:fk[T],alignment:_,flipY:l,colorSpace:xne[k],premultiplyAlpha:E,aniso:b};n&&(O.data=n),typeof d=="number"?O.mipmap=bne[d]:typeof d=="boolean"&&(O.mipmap=d),this.texture=e.texture(O)}return Bt(r,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(t){var n=t.width,i=t.height;this.texture.resize(n,i),this.width=n,this.height=i}},{key:"destroy",value:function(){this.texture.destroy()}}]),r}(),yk,mk,bk,uie=(yk=Ar(),yk(mk=(bk=function(){function r(){var e=this;wt(this,r),this.supportWebGPU=!1,this.useWGSL=!1,this.$canvas=void 0,this.gl=void 0,this.inited=void 0,this.createModel=function(){var t=wr(bt.mark(function n(i){return bt.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!i.uniforms){o.next=3;break}return o.next=3,Promise.all(Object.keys(i.uniforms).map(function(){var s=wr(bt.mark(function u(l){var f;return bt.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!(i.uniforms[l]&&i.uniforms[l].load!==void 0)){h.next=5;break}return h.next=3,i.uniforms[l].load();case 3:f=h.sent,i.uniforms[l]=f;case 5:case"end":return h.stop()}},u)}));return function(u){return s.apply(this,arguments)}}()));case 3:return o.abrupt("return",new oie(e.gl,i));case 4:case"end":return o.stop()}},n)}));return function(n){return t.apply(this,arguments)}}(),this.createAttribute=function(t){return new gne(e.gl,t)},this.createBuffer=function(t){return new Ene(e.gl,t)},this.createElements=function(t){return new nie(e.gl,t)},this.createTexture2D=function(t){return new sie(e.gl,t)},this.createFramebuffer=function(t){return new iie(e.gl,t)},this.useFramebuffer=function(t,n){e.gl({framebuffer:t?t.get():null})(n)},this.createComputeModel=function(){var t=wr(bt.mark(function n(i){return bt.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",new rie(e.gl,i));case 1:case"end":return o.stop()}},n)}));return function(n){return t.apply(this,arguments)}}(),this.clear=function(t){var n=t.color,i=t.depth,a=t.stencil,o=t.framebuffer,s=o===void 0?null:o,u={color:n,depth:i,stencil:a};u.framebuffer=s===null?s:s.get(),e.gl.clear(u)},this.setScissor=function(t){e.gl&&e.gl._gl&&(t.enable&&t.box?(e.gl._gl.enable(ae.SCISSOR_TEST),e.gl._gl.scissor(t.box.x,t.box.y,t.box.width,t.box.height)):e.gl._gl.disable(ae.SCISSOR_TEST),e.gl._refresh())},this.viewport=function(t){var n=t.x,i=t.y,a=t.width,o=t.height;e.gl&&e.gl._gl&&(e.gl._gl.viewport(n,i,a,o),e.gl._refresh())},this.readPixels=function(t){var n=t.framebuffer,i=t.x,a=t.y,o=t.width,s=t.height,u={x:i,y:a,width:o,height:s};return n&&(u.framebuffer=n.get()),e.gl.read(u)},this.getCanvas=function(){return e.$canvas},this.getGLContext=function(){return e.gl._gl},this.destroy=function(){e.gl&&(e.gl.destroy(),e.inited=!1)}}return Bt(r,[{key:"init",value:function(){var e=wr(bt.mark(function n(i){return bt.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!this.inited){o.next=2;break}return o.abrupt("return");case 2:return this.$canvas=i.canvas,o.next=5,new Promise(function(s,u){pne({canvas:i.canvas,attributes:{alpha:!0,antialias:i.antialias,premultipliedAlpha:!0},pixelRatio:1,extensions:["OES_element_index_uint","OES_texture_float","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(f,c){(f||!c)&&u(f),s(c)}})});case 5:this.gl=o.sent,this.inited=!0;case 7:case"end":return o.stop()}},n,this)}));function t(n){return e.apply(this,arguments)}return t}()},{key:"isFloatSupported",value:function(){return this.gl.limits.readFloat}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),r}(),bk))||mk);function lie(){return typeof window!="undefined"}function fie(r,e,t,n){if(!!lie()){var i=document.getElementsByTagName("head")[0],a=document.createElement("script");a.setAttribute("type","text/javascript"),a.setAttribute("src",r),n&&(a.id=n),a.onload=function(){e&&e()},a.onerror=function(o){t&&t("Unable to load script '".concat(r,"'"),o)},i.appendChild(a)}}function cie(r,e){return new Promise(function(t,n){fie(r,function(){t()},function(i,a){n(a)})})}var yv;function hie(){return f0.apply(this,arguments)}function f0(){return f0=wr(bt.mark(function r(){return bt.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!yv){t.next=2;break}return t.abrupt("return",yv);case 2:return t.next=4,cie("https://preview.babylonjs.com/glslang/glslang.js");case 4:return yv=window.glslang("https://preview.babylonjs.com/glslang/glslang.wasm"),t.abrupt("return",yv);case 6:case"end":return t.stop()}},r)})),f0.apply(this,arguments)}var die=function(){function r(e,t){wt(this,r),this.engine=e,this.options=t,this.attribute=void 0,this.buffer=void 0;var n=t,i=n.buffer,a=n.offset,o=n.stride,s=n.normalized,u=n.size,l=n.divisor,f=n.arrayStride,c=n.attributes,h=n.stepMode;this.buffer=i,this.attribute={buffer:i.get(),offset:a||0,stride:o||0,normalized:s||!1,divisor:l||0,arrayStride:f||0,attributes:c,stepMode:h||"vertex"},u&&(this.attribute.size=u)}return Bt(r,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(t){this.buffer.subData(t)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),r}(),ol=function(){function r(e,t){wt(this,r),this.engine=e,this.options=t,this.buffer=void 0;var n=t,i=n.data,a=n.usage;n.type,this.buffer=this.createBuffer(i instanceof Array?new Float32Array(i):i,a||wi.Vertex|wi.CopyDst)}return Bt(r,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(t){var n=t.data,i=t.offset;this.setSubData(this.buffer,i,n instanceof Array?new Float32Array(n):n)}},{key:"createBuffer",value:function(t,n){var i=t.byteLength%4,a={size:t.byteLength+i,usage:n},o=this.engine.device.createBuffer(a);return this.setSubData(o,0,t),o}},{key:"setSubData",value:function(t,n,i){var a=_i?this.engine.device.getQueue():this.engine.device.defaultQueue;a.writeBuffer(t,n,i)}}]),r}();function vie(r){return typeof r=="number"}var pie=function(){function r(e,t){wt(this,r),this.engine=e,this.context=t,this.entity=Ia(),this.uniformGPUBufferLayout=[],this.uniformBuffer=void 0,this.vertexBuffers={},this.outputBuffer=void 0,this.bindGroupEntries=void 0,this.bindGroup=void 0,this.computePipeline=void 0}return Bt(r,[{key:"init",value:function(){var e=wr(bt.mark(function n(){var i=this,a,o,s,u,l,f,c;return bt.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.compileComputePipelineStageDescriptor(this.context.shader);case 2:a=d.sent,o=a.computeStage,s=this.context.uniforms.filter(function(v){return v.storageClass===Oo.StorageBuffer}),u=this.context.uniforms.filter(function(v){return v.storageClass===Oo.Uniform}),l=u.length?1:0,this.bindGroupEntries=[],l&&(f=0,c=[],u.forEach(function(v){if(vie(v.data))i.uniformGPUBufferLayout.push({name:v.name,offset:f}),f+=4,c.push(v.data);else{var p,g=((p=v.data)===null||p===void 0?void 0:p.length)||1;g===3&&(g=4,v.data.push(0));var y=f/4%4;if(y>0){var m=4-y;if(g>1&&g<=m)g===2&&(m===3&&(f+=4,c.push(0)),c.push.apply(c,En(v.data)),i.uniformGPUBufferLayout.push({name:v.name,offset:f}));else{for(var b=0;b<m;b++)f+=4,c.push(0);c.push.apply(c,En(v.data)),i.uniformGPUBufferLayout.push({name:v.name,offset:f})}}f+=4*g}}),this.uniformBuffer=new ol(this.engine,{data:c instanceof Array?new Float32Array(c):c,usage:wi.Uniform|wi.CopyDst}),this.bindGroupEntries.push({binding:0,resource:{buffer:this.uniformBuffer.get()}})),s.forEach(function(v){if(v.data!==null&&(v.type===zs.Vector4FloatArray||v.type===zs.FloatArray)){var p;v.name===i.context.output.name?(p=new ol(i.engine,{data:isFinite(Number(v.data))?[v.data]:v.data,usage:wi.Storage|wi.CopyDst|wi.CopySrc}),i.outputBuffer=p,i.context.output={name:v.name,length:isFinite(Number(v.data))?1:v.data.length,typedArrayConstructor:Float32Array,gpuBuffer:p.get()}):v.isReferer?v.data.model&&v.data.model.outputBuffer&&(p=v.data.model.outputBuffer):p=new ol(i.engine,{data:isFinite(Number(v.data))?[v.data]:v.data,usage:wi.Storage|wi.CopyDst|wi.CopySrc}),i.vertexBuffers[v.name]=p,i.bindGroupEntries.push({binding:l,resource:{name:v.name,refer:p?void 0:v.data,buffer:p?p.get():void 0}}),l++}}),this.computePipeline=this.engine.device.createComputePipeline({computeStage:o}),console.log(this.bindGroupEntries),this.bindGroup=this.engine.device.createBindGroup({layout:this.computePipeline.getBindGroupLayout(0),entries:this.bindGroupEntries});case 13:case"end":return d.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"destroy",value:function(){var t=this;this.uniformBuffer&&this.uniformBuffer.destroy(),Object.keys(this.vertexBuffers).forEach(function(n){return t.vertexBuffers[n].destroy()})}},{key:"readData",value:function(){var e=wr(bt.mark(function n(){var i,a,o,s,u,l,f,c,h,d;return bt.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(i=this.context.output,!i){p.next=16;break}if(a=i.length,o=i.typedArrayConstructor,s=i.gpuBuffer,!s){p.next=16;break}return u=a*o.BYTES_PER_ELEMENT,l=this.engine.device.createBuffer({size:u,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),f=this.engine.device.createCommandEncoder(),f.copyBufferToBuffer(s,0,l,0,u),c=_i?this.engine.device.getQueue():this.engine.device.defaultQueue,c.submit([f.finish()]),p.next=12,l.mapAsync(Ore.Read);case 12:return h=l.getMappedRange(),d=new o(h.slice(0)),l.unmap(),p.abrupt("return",d);case 16:return p.abrupt("return",new Float32Array);case 17:case"end":return p.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"run",value:function(){if(this.engine.currentComputePass){var t;this.engine.currentComputePass.setPipeline(this.computePipeline),this.engine.currentComputePass.setBindGroup(0,this.bindGroup),(t=this.engine.currentComputePass).dispatch.apply(t,En(this.context.dispatch))}}},{key:"updateBuffer",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=this.vertexBuffers[t];a&&a.subData({data:n,offset:i})}},{key:"updateUniform",value:function(t,n){var i=this.uniformGPUBufferLayout.find(function(a){return a.name===t});i&&this.uniformBuffer.subData({data:Number.isFinite(n)?new Float32Array([n]):new Float32Array(n),offset:i.offset})}},{key:"confirmInput",value:function(t,n){var i=this.vertexBuffers[n],a=t.outputBuffer;if(i&&a&&i!==a){var o=this.engine.device.createCommandEncoder(),s=t.context.output,u=s.length,l=s.typedArrayConstructor,f=u*l.BYTES_PER_ELEMENT;o.copyBufferToBuffer(a.get(),0,i.get(),0,f);var c=_i?this.engine.device.getQueue():this.engine.device.defaultQueue;c.submit([o.finish()])}}},{key:"compileShaderToSpirV",value:function(t,n,i){return this.compileRawShaderToSpirV(i+t,n)}},{key:"compileRawShaderToSpirV",value:function(t,n){return this.engine.glslang.compileGLSL(t,n)}},{key:"compileComputePipelineStageDescriptor",value:function(){var e=wr(bt.mark(function n(i){var a,o;return bt.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a=i,o=`#version 450
`,this.engine.options.useWGSL){u.next=6;break}return u.next=5,this.compileShaderToSpirV(i,"compute",o);case 5:a=u.sent;case 6:return u.abrupt("return",{computeStage:{module:this.engine.device.createShaderModule({code:a,isWHLSL:_i}),entryPoint:"main"}});case 7:case"end":return u.stop()}},n,this)}));function t(n){return e.apply(this,arguments)}return t}()}]),r}(),gie=function(){function r(e,t){wt(this,r),this.engine=e,this.options=t,this.indexCount=void 0,this.buffer=void 0;var n=t,i=n.data;n.usage,n.type;var a=n.count;this.indexCount=a||0,this.buffer=new ol(e,{data:i instanceof Array?new Uint16Array(i):i,usage:wi.Index|wi.CopyDst})}return Bt(r,[{key:"get",value:function(){return this.buffer}},{key:"subData",value:function(t){this.buffer.subData(t)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),r}(),yie=function(){function r(e,t){wt(this,r),this.engine=e,this.options=t,this.colorTexture=void 0,this.depthTexture=void 0,this.width=0,this.height=0;var n=t;n.width,n.height;var i=n.color;n.colors;var a=n.depth;n.stencil,i&&(this.colorTexture=i),a&&(this.depthTexture=a)}return Bt(r,[{key:"get",value:function(){var t,n;return{color:(t=this.colorTexture)===null||t===void 0?void 0:t.get(),depth:(n=this.depthTexture)===null||n===void 0?void 0:n.get()}}},{key:"destroy",value:function(){var t,n;(t=this.colorTexture)===null||t===void 0||t.destroy(),(n=this.depthTexture)===null||n===void 0||n.destroy()}},{key:"resize",value:function(t){var n=t.width,i=t.height;if(n!==this.width||i!==this.height){var a,o;(a=this.colorTexture)===null||a===void 0||a.resize({width:n,height:i}),(o=this.depthTexture)===null||o===void 0||o.resize({width:n,height:i})}this.width=n,this.height=i}}]),r}(),io,La,Ys,gi,sl,mv,ic,mie=(io={},Ce(io,ae.POINTS,Ws.PointList),Ce(io,ae.LINES,Ws.LineList),Ce(io,ae.LINE_LOOP,Ws.LineList),Ce(io,ae.LINE_STRIP,Ws.LineStrip),Ce(io,ae.TRIANGLES,Ws.TriangleList),Ce(io,ae.TRIANGLE_FAN,Ws.TriangleList),Ce(io,ae.TRIANGLE_STRIP,Ws.TriangleStrip),io),bie=(La={},Ce(La,ae.NEVER,to.Never),Ce(La,ae.ALWAYS,to.Always),Ce(La,ae.LESS,to.Less),Ce(La,ae.LEQUAL,to.LessEqual),Ce(La,ae.GREATER,to.Greater),Ce(La,ae.GEQUAL,to.GreaterEqual),Ce(La,ae.EQUAL,to.Equal),Ce(La,ae.NOTEQUAL,to.NotEqual),La),xk=(Ys={},Ce(Ys,ae.FUNC_ADD,Jf.Add),Ce(Ys,ae.MIN_EXT,Jf.Min),Ce(Ys,ae.MAX_EXT,Jf.Max),Ce(Ys,ae.FUNC_SUBTRACT,Jf.Subtract),Ce(Ys,ae.FUNC_REVERSE_SUBTRACT,Jf.ReverseSubtract),Ys),bv=(gi={},Ce(gi,ae.ZERO,Di.Zero),Ce(gi,ae.ONE,Di.One),Ce(gi,ae.SRC_COLOR,Di.SrcColor),Ce(gi,ae.ONE_MINUS_SRC_COLOR,Di.OneMinusSrcColor),Ce(gi,ae.SRC_ALPHA,Di.SrcAlpha),Ce(gi,ae.ONE_MINUS_SRC_ALPHA,Di.OneMinusSrcAlpha),Ce(gi,ae.DST_COLOR,Di.DstColor),Ce(gi,ae.ONE_MINUS_DST_COLOR,Di.OneMinusDstColor),Ce(gi,ae.DST_ALPHA,Di.DstAlpha),Ce(gi,ae.ONE_MINUS_DST_ALPHA,Di.OneMinusDstAlpha),Ce(gi,ae.CONSTANT_COLOR,Di.BlendColor),Ce(gi,ae.ONE_MINUS_CONSTANT_COLOR,Di.OneMinusBlendColor),Ce(gi,ae.SRC_ALPHA_SATURATE,Di.SrcAlphaSaturated),gi),xie=(sl={},Ce(sl,ae.ALPHA,"r8unorm"),Ce(sl,ae.RGBA,"rgba8unorm"),Ce(sl,ae.DEPTH_COMPONENT,"depth32float"),Ce(sl,ae.DEPTH_STENCIL,"depth24plus-stencil8"),sl),_k=(mv={},Ce(mv,ae.NEAREST,"nearest"),Ce(mv,ae.LINEAR,"linear"),mv),c0=(ic={},Ce(ic,ae.REPEAT,"repeat"),Ce(ic,ae.CLAMP_TO_EDGE,"clamp-to-edge"),Ce(ic,ae.MIRRORED_REPEAT,"mirror-repeat"),ic);function _ie(r){var e=r.cull;if(!e||!e.enable)return fv.None;if(e.face)return e.face===ae.FRONT?fv.Front:fv.Back}function wie(r){var e=r.depth;r.stencil;var t={compare:to.Always,depthFailOp:i0.Keep,failOp:i0.Keep,passOp:i0.Keep};return{depthWriteEnabled:e&&e.enable,depthCompare:bie[(e==null?void 0:e.func)||ae.ALWAYS],format:rl.Depth24PlusStencil8,stencilFront:t,stencilBack:t,stencilReadMask:4294967295,stencilWriteMask:4294967295}}function Sie(r,e){var t=r.blend;return[{format:e,alphaBlend:{srcFactor:bv[t&&t.func&&t.func.srcAlpha||ae.ONE],dstFactor:bv[t&&t.func&&t.func.dstAlpha||ae.ZERO],operation:xk[t&&t.equation&&t.equation.alpha||ae.FUNC_ADD]},colorBlend:{srcFactor:bv[t&&t.func&&t.func.srcRGB||ae.ONE],dstFactor:bv[t&&t.func&&t.func.dstRGB||ae.ZERO],operation:xk[t&&t.equation&&t.equation.rgb||ae.FUNC_ADD]},writeMask:Lre.All}]}function wk(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function ul(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?wk(Object(t),!0).forEach(function(n){Ce(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):wk(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function Eie(r){for(var e=0,t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var a=0,o=n;a<o.length;a++){var s=o[a];e+=s.length}for(var u=new r(e),l=0,f=0,c=n;f<c.length;f++){var h=c[f];u.set(h,l),l+=h.length}return u}var Cie=function(){function r(e,t){wt(this,r),this.engine=e,this.options=t,this.pipelineLayout=void 0,this.renderPipeline=void 0,this.uniformsBindGroupLayout=void 0,this.uniformBindGroup=void 0,this.uniformBuffer=void 0,this.uniforms={},this.uniformGPUBufferLayout=[],this.attributeCache={},this.indexBuffer=void 0,this.indexCount=void 0}return Bt(r,[{key:"init",value:function(){var e=wr(bt.mark(function n(){var i=this,a,o,s,u,l,f,c,h,d,v,p,g,y,m,b,x;return bt.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return a=this.options,o=a.vs,s=a.fs,u=a.attributes,l=a.uniforms,f=a.primitive,c=a.elements,h=a.depth,d=a.blend,v=a.stencil,p=a.cull,S.next=3,this.compilePipelineStageDescriptor(o,s,null);case 3:g=S.sent,y=g.vertexStage,m=g.fragmentStage,l&&this.buildUniformBindGroup(l),c&&(this.indexBuffer=c.get(),this.indexCount=c.indexCount),b={vertexBuffers:Object.keys(u).map(function(E,C){var M=u[E],w=M.get(),T=w.arrayStride,I=w.stepMode,k=w.attributes;return i.attributeCache[E]=M,{arrayStride:T,stepMode:I,attributes:k}})},x={sampleCount:this.engine.mainPassSampleCount,primitiveTopology:mie[f||ae.TRIANGLES],rasterizationState:ul(ul({},this.getDefaultRasterizationStateDescriptor()),{},{cullMode:_ie({cull:p})}),depthStencilState:wie({depth:h,stencil:v}),colorStates:Sie({blend:d},this.engine.options.swapChainFormat),layout:this.pipelineLayout,vertexStage:y,fragmentStage:m,vertexState:b},this.renderPipeline=this.engine.device.createRenderPipeline(x);case 11:case"end":return S.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"addUniforms",value:function(t){this.uniforms=ul(ul({},this.uniforms),nc(t))}},{key:"draw",value:function(t){var n=this,i=this.engine.getCurrentRenderPass(),a=ul(ul({},this.uniforms),nc(t.uniforms||{})),o=[];Object.keys(a).forEach(function(s){var u=us(a[s]);if(u==="boolean"||u==="number"||Array.isArray(a[s])||a[s].BYTES_PER_ELEMENT){var l,f=(l=n.uniformGPUBufferLayout.find(function(y){var m=y.name;return m===s}))===null||l===void 0?void 0:l.offset;f!==null&&n.uniformBuffer.subData({data:a[s],offset:f})}else{var c,h=(c=n.uniformGPUBufferLayout.find(function(y){var m=y.name;return m===s}))===null||c===void 0?void 0:c.offset;if(h!==null){var d=a[s].get(),v=d.color||d,p=v.texture,g=v.sampler;g&&(o.push({binding:h,resource:g}),h++),o.push({binding:h,resource:p.createView()})}}}),this.uniformBuffer&&(o[0]={binding:0,resource:{buffer:this.uniformBuffer.get()}}),this.uniformBindGroup=this.engine.device.createBindGroup({layout:this.uniformsBindGroupLayout,entries:o}),this.renderPipeline&&i.setPipeline(this.renderPipeline),i.setBindGroup(0,this.uniformBindGroup),this.indexBuffer&&i.setIndexBuffer(this.indexBuffer.get(),Dre.Uint32,0),Object.keys(this.attributeCache).forEach(function(s,u){i.setVertexBuffer(0+u,n.attributeCache[s].get().buffer,0)}),this.indexBuffer?i.drawIndexed(this.indexCount,this.options.instances||1,0,0,0):i.draw(this.options.count||0,this.options.instances||0,0,0)}},{key:"destroy",value:function(){throw new Error("Method not implemented.")}},{key:"compilePipelineStageDescriptor",value:function(){var e=wr(bt.mark(function n(i,a,o){var s,u,l;return bt.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(s=`#version 450
`,u=i,l=a,this.engine.options.useWGSL){c.next=10;break}return c.next=6,this.compileShaderToSpirV(i,"vertex",s);case 6:return u=c.sent,c.next=9,this.compileShaderToSpirV(a,"fragment",s);case 9:l=c.sent;case 10:return c.abrupt("return",this.createPipelineStageDescriptor(u,l));case 11:case"end":return c.stop()}},n,this)}));function t(n,i,a){return e.apply(this,arguments)}return t}()},{key:"compileShaderToSpirV",value:function(t,n,i){return this.compileRawShaderToSpirV(i+t,n)}},{key:"compileRawShaderToSpirV",value:function(t,n){return this.engine.glslang.compileGLSL(t,n)}},{key:"createPipelineStageDescriptor",value:function(t,n){return{vertexStage:{module:this.engine.device.createShaderModule({code:t,isWHLSL:_i}),entryPoint:"main"},fragmentStage:{module:this.engine.device.createShaderModule({code:n,isWHLSL:_i}),entryPoint:"main"}}}},{key:"getDefaultRasterizationStateDescriptor",value:function(){return{frontFace:kre.CCW,cullMode:fv.None,depthBias:0,depthBiasSlopeScale:0,depthBiasClamp:0}}},{key:"buildUniformBindGroup",value:function(t){var n=this,i=0,a=Eie.apply(void 0,[Float32Array].concat(En(Object.keys(t).map(function(u){return t[u]?(n.uniformGPUBufferLayout.push({name:u,offset:i}),i+=(t[u].length||1)*4,t[u]):[]})))),o=[],s=!1;a.length&&(s=!0,o.push({binding:0,visibility:cv.Fragment|cv.Vertex,type:n0.UniformBuffer})),Object.keys(t).filter(function(u){return t[u]===null}).forEach(function(u,l){n.uniformGPUBufferLayout.push({name:u,offset:l*2+(s?1:0)}),o.push({binding:l*2+(s?1:0),visibility:cv.Fragment,type:n0.Sampler},{binding:l*2+(s?1:0)+1,visibility:cv.Fragment,type:n0.SampledTexture})}),this.uniformsBindGroupLayout=this.engine.device.createBindGroupLayout({entries:o}),this.pipelineLayout=this.engine.device.createPipelineLayout({bindGroupLayouts:[this.uniformsBindGroupLayout]}),s&&(this.uniformBuffer=new ol(this.engine,{data:a instanceof Array?new Float32Array(a):a,usage:wi.Uniform|wi.CopyDst}))}}]),r}(),Aie=function(){function r(e,t){wt(this,r),this.engine=e,this.options=t,this.texture=void 0,this.sampler=void 0,this.width=void 0,this.height=void 0,this.createTexture()}return Bt(r,[{key:"get",value:function(){return{texture:this.texture,sampler:this.sampler}}},{key:"update",value:function(){}},{key:"resize",value:function(t){var n=t.width,i=t.height;(n!==this.width||i!==this.height)&&(this.destroy(),this.createTexture()),this.width=n,this.height=i}},{key:"destroy",value:function(){this.texture&&this.texture.destroy()}},{key:"createTexture",value:function(){var t=this.options;t.data;var n=t.type;n===void 0&&ae.UNSIGNED_BYTE;var i=t.width,a=t.height;t.flipY;var o=t.format,s=o===void 0?ae.RGBA:o;t.mipmap;var u=t.wrapS,l=u===void 0?ae.CLAMP_TO_EDGE:u,f=t.wrapT,c=f===void 0?ae.CLAMP_TO_EDGE:f,h=t.aniso,d=h===void 0?0:h;t.alignment,t.premultiplyAlpha;var v=t.mag,p=v===void 0?ae.NEAREST:v,g=t.min,y=g===void 0?ae.NEAREST:g,m=t.colorSpace;m===void 0&&ae.BROWSER_DEFAULT_WEBGL;var b=t.usage;this.width=i,this.height=a,this.texture=this.engine.device.createTexture({size:[i,a,1],mipLevelCount:1,sampleCount:1,dimension:a0.E2d,format:xie[s],usage:b||Xs.Sampled|Xs.CopyDst}),(!b||b&Xs.Sampled)&&(this.sampler=this.engine.device.createSampler({addressModeU:c0[l],addressModeV:c0[c],addressModeW:c0[l],magFilter:_k[p],minFilter:_k[y],maxAnisotropy:d}))}}]),r}(),Sk,Ek,Ck,Tie=(Sk=Ar(),Sk(Ek=(Ck=function(){function r(){var e=this;wt(this,r),this.supportWebGPU=!0,this.useWGSL=!1,this.options=void 0,this.canvas=void 0,this.context=void 0,this.glslang=void 0,this.adapter=void 0,this.device=void 0,this.swapChain=void 0,this.mainPassSampleCount=void 0,this.mainTexture=void 0,this.depthTexture=void 0,this.mainColorAttachments=void 0,this.mainTextureExtends=void 0,this.mainDepthAttachment=void 0,this.uploadEncoder=void 0,this.renderEncoder=void 0,this.computeEncoder=void 0,this.renderTargetEncoder=void 0,this.commandBuffers=new Array(4).fill(void 0),this.currentRenderPass=null,this.mainRenderPass=null,this.currentRenderTargetViewDescriptor=void 0,this.currentComputePass=null,this.bundleEncoder=void 0,this.tempBuffers=[],this.currentRenderTarget=null,this.uploadEncoderDescriptor={label:"upload"},this.renderEncoderDescriptor={label:"render"},this.renderTargetEncoderDescriptor={label:"renderTarget"},this.computeEncoderDescriptor={label:"compute"},this.pipelines={},this.computePipelines={},this.defaultSampleCount=4,this.clearDepthValue=1,this.clearStencilValue=0,this.transientViewport={x:1/0,y:0,width:0,height:0},this.cachedViewport={x:0,y:0,width:0,height:0},this.clear=function(t){t.framebuffer;var n=t.color,i=t.depth,a=t.stencil;e.options.supportCompute&&e.startComputePass(),e.currentRenderTarget?(e.currentRenderPass&&e.endRenderTargetRenderPass(),e.startRenderTargetRenderPass(e.currentRenderTarget,n||null,!!i,!!a)):(e.mainColorAttachments[0].loadValue=n||tl.Load,e.mainDepthAttachment.depthLoadValue=i||tl.Load,e.mainDepthAttachment.stencilLoadValue=a?e.clearStencilValue:tl.Load,e.mainRenderPass&&e.endMainRenderPass(),e.startMainRenderPass())},this.createModel=function(){var t=wr(bt.mark(function n(i){var a;return bt.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a=new Cie(e,i),s.next=3,a.init();case 3:return s.abrupt("return",a);case 4:case"end":return s.stop()}},n)}));return function(n){return t.apply(this,arguments)}}(),this.createAttribute=function(t){return new die(e,t)},this.createBuffer=function(t){return new ol(e,t)},this.createElements=function(t){return new gie(e,t)},this.createTexture2D=function(t){return new Aie(e,t)},this.createFramebuffer=function(t){return new yie(e,t)},this.useFramebuffer=function(t,n){e.currentRenderTarget&&e.unbindFramebuffer(e.currentRenderTarget),e.currentRenderTarget=t,e.currentRenderTargetViewDescriptor={dimension:Pre.E2d,arrayLayerCount:1,aspect:Nre.All},e.currentRenderPass=null,n()},this.createComputeModel=function(){var t=wr(bt.mark(function n(i){var a;return bt.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a=new pie(e,i),s.next=3,a.init();case 3:return s.abrupt("return",a);case 4:case"end":return s.stop()}},n)}));return function(n){return t.apply(this,arguments)}}(),this.getCanvas=function(){return e.canvas},this.getGLContext=function(){throw new Error("Method not implemented.")},this.viewport=function(t){var n=t.x,i=t.y,a=t.width,o=t.height;if(!e.currentRenderPass)e.transientViewport={x:n,y:i,width:a,height:o};else if(e.transientViewport.x!==1/0){var s=e.getCurrentRenderPass();s.setViewport(e.transientViewport.x,e.transientViewport.y,e.transientViewport.width,e.transientViewport.height,0,1)}else if(n!==e.cachedViewport.x||i!==e.cachedViewport.y||a!==e.cachedViewport.width||o!==e.cachedViewport.height){e.cachedViewport={x:n,y:i,width:a,height:o};var u=e.getCurrentRenderPass();u.setViewport(n,i,a,o,0,1)}},this.readPixels=function(t){throw new Error("Method not implemented.")}}return Bt(r,[{key:"isFloatSupported",value:function(){return!0}},{key:"init",value:function(){var e=wr(bt.mark(function n(i){return bt.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.canvas=i.canvas,this.options=i,this.useWGSL=!!i.useWGSL,this.mainPassSampleCount=i.antialiasing?this.defaultSampleCount:1,o.next=6,this.initGlslang();case 6:this.initContextAndSwapChain(),this.initMainAttachments();case 8:case"end":return o.stop()}},n,this)}));function t(n){return e.apply(this,arguments)}return t}()},{key:"setScissor",value:function(t){throw new Error("Method not implemented.")}},{key:"destroy",value:function(){this.mainTexture&&this.mainTexture.destroy(),this.depthTexture&&this.depthTexture.destroy(),this.tempBuffers.forEach(function(t){return t.destroy()}),this.tempBuffers=[]}},{key:"beginFrame",value:function(){this.uploadEncoder=this.device.createCommandEncoder(this.uploadEncoderDescriptor),this.renderEncoder=this.device.createCommandEncoder(this.renderEncoderDescriptor),this.renderTargetEncoder=this.device.createCommandEncoder(this.renderTargetEncoderDescriptor),this.options.supportCompute&&(this.computeEncoder=this.device.createCommandEncoder(this.computeEncoderDescriptor))}},{key:"endFrame",value:function(){this.options.supportCompute&&this.endComputePass(),this.endMainRenderPass(),this.commandBuffers[0]=this.uploadEncoder.finish(),this.commandBuffers[1]=this.renderEncoder.finish(),this.options.supportCompute&&(this.commandBuffers[2]=this.computeEncoder.finish()),this.commandBuffers[3]=this.renderTargetEncoder.finish(),_i?this.device.getQueue().submit(this.commandBuffers.filter(function(t){return t})):this.device.defaultQueue.submit(this.commandBuffers.filter(function(t){return t}))}},{key:"getCurrentRenderPass",value:function(){return this.currentRenderTarget&&!this.currentRenderPass?this.startRenderTargetRenderPass(this.currentRenderTarget,null,!1,!1):this.currentRenderPass||this.startMainRenderPass(),this.currentRenderPass}},{key:"initGlslang",value:function(){var e=wr(bt.mark(function n(){var i,a;return bt.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,hie();case 2:return this.glslang=s.sent,s.next=5,(i=navigator)===null||i===void 0||(a=i.gpu)===null||a===void 0?void 0:a.requestAdapter();case 5:return this.adapter=s.sent,s.next=8,this.adapter.requestDevice();case 8:this.device=s.sent;case 9:case"end":return s.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"initContextAndSwapChain",value:function(){this.context=this.canvas.getContext(_i?"gpu":"gpupresent"),this.swapChain=this.context.configureSwapChain({device:this.device,format:this.options.swapChainFormat,usage:Xs.OutputAttachment|Xs.CopySrc})}},{key:"initMainAttachments",value:function(){if(this.mainTextureExtends={width:this.canvas.width,height:this.canvas.height,depth:1},this.options.antialiasing){var t={size:this.mainTextureExtends,mipLevelCount:1,sampleCount:this.mainPassSampleCount,dimension:a0.E2d,format:rl.BGRA8Unorm,usage:Xs.OutputAttachment};this.mainTexture&&this.mainTexture.destroy(),this.mainTexture=this.device.createTexture(t),this.mainColorAttachments=[{attachment:_i?this.mainTexture.createDefaultView():this.mainTexture.createView(),loadValue:[0,0,0,1],storeOp:js.Store}]}else this.mainColorAttachments=[{attachment:_i?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView(),loadValue:[0,0,0,1],storeOp:js.Store}];var n={size:this.mainTextureExtends,mipLevelCount:1,sampleCount:this.mainPassSampleCount,dimension:a0.E2d,format:_i?"depth32float-stencil8":rl.Depth24PlusStencil8,usage:Xs.OutputAttachment};this.depthTexture&&this.depthTexture.destroy(),this.depthTexture=this.device.createTexture(n),this.mainDepthAttachment={attachment:_i?this.depthTexture.createDefaultView():this.depthTexture.createView(),depthLoadValue:this.clearDepthValue,depthStoreOp:js.Store,stencilLoadValue:this.clearStencilValue,stencilStoreOp:js.Store}}},{key:"startComputePass",value:function(){this.currentComputePass&&this.endComputePass(),this.currentComputePass=this.computeEncoder.beginComputePass()}},{key:"startMainRenderPass",value:function(){this.currentRenderPass&&!this.currentRenderTarget&&this.endMainRenderPass(),this.options.antialiasing?this.mainColorAttachments[0].resolveTarget=_i?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView():this.mainColorAttachments[0].attachment=_i?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView(),this.currentRenderPass=this.renderEncoder.beginRenderPass({colorAttachments:this.mainColorAttachments,depthStencilAttachment:this.mainDepthAttachment}),this.mainRenderPass=this.currentRenderPass,this.cachedViewport&&this.viewport(this.cachedViewport)}},{key:"startRenderTargetRenderPass",value:function(t,n,i){var a,o,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,u=(a=t.get().color)===null||a===void 0?void 0:a.texture,l;u&&(l=u.createView(this.currentRenderTargetViewDescriptor));var f=(o=t.get().depth)===null||o===void 0?void 0:o.texture,c;f&&(c=f.createView());var h=this.renderTargetEncoder.beginRenderPass({colorAttachments:[{attachment:l,loadValue:n!==null?n:tl.Load,storeOp:js.Store}],depthStencilAttachment:f&&c?{attachment:c,depthLoadValue:i?this.clearDepthValue:tl.Load,depthStoreOp:js.Store,stencilLoadValue:s?this.clearStencilValue:tl.Load,stencilStoreOp:js.Store}:void 0});this.currentRenderPass=h,this.cachedViewport&&this.viewport(this.cachedViewport)}},{key:"endMainRenderPass",value:function(){this.currentRenderPass===this.mainRenderPass&&this.currentRenderPass!==null&&(this.currentRenderPass.endPass(),this.resetCachedViewport(),this.currentRenderPass=null,this.mainRenderPass=null)}},{key:"endComputePass",value:function(){this.currentComputePass&&(this.currentComputePass.endPass(),this.currentComputePass=null)}},{key:"endRenderTargetRenderPass",value:function(){this.currentRenderPass&&(this.currentRenderPass.endPass(),this.resetCachedViewport())}},{key:"resetCachedViewport",value:function(){this.cachedViewport={x:0,y:0,width:0,height:0}}},{key:"unbindFramebuffer",value:function(t){this.currentRenderPass&&this.currentRenderPass!==this.mainRenderPass&&this.endRenderTargetRenderPass(),this.transientViewport.x=1/0,this.currentRenderTarget=null,this.currentRenderPass=this.mainRenderPass}}]),r}(),Ck))||Ek),Ak,Tk;function Mie(r){var e=Iie();return function(){var n=Tr(r),i;if(e){var a=Tr(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return si(this,i)}}function Iie(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var h0=4/64,Mk=1-h0*2,kie=(Ak=Ar(),Ak(Tk=function(r){oi(t,r);var e=Mie(t);function t(){return wt(this,t),e.apply(this,arguments)}return Bt(t,[{key:"onEntityCreated",value:function(){var i=this.config,a=i.widthSegments,o=a===void 0?1:a,s=i.heightSegments,u=s===void 0?1:s,l=i.depthSegments,f=l===void 0?1:l,c=i.halfExtents,h=c===void 0?nr(.5,.5,.5):c,d=o,v=u,p=f,g=oh(h,3),y=g[0],m=g[1],b=g[2],x=[nr(-y,-m,b),nr(y,-m,b),nr(y,m,b),nr(-y,m,b),nr(y,-m,-b),nr(-y,-m,-b),nr(-y,m,-b),nr(y,m,-b)],_=[[0,1,3],[4,5,7],[3,2,6],[1,0,4],[1,4,2],[5,0,6]],S=[[0,0,1],[0,0,-1],[0,1,0],[0,-1,0],[1,0,0],[-1,0,0]],E={FRONT:0,BACK:1,TOP:2,BOTTOM:3,RIGHT:4,LEFT:5},C=[],M=[],w=[],T=[],I=0,k=function(K,le,he){var te,se,ge,Se;for(ge=0;ge<=le;ge++)for(Se=0;Se<=he;Se++){var ne=Nr(),pe=Nr(),Ge=Nr(),ke=Nr();hs(ne,x[_[K][0]],x[_[K][1]],ge/le),hs(pe,x[_[K][0]],x[_[K][2]],Se/he),dg(Ge,pe,x[_[K][0]]),Wa(ke,ne,Ge),te=ge/le,se=Se/he,C.push(ke[0],ke[1],ke[2]),M.push(S[K][0],S[K][1],S[K][2]),w.push(te,se),te/=3,se/=3,te=te*Mk+h0,se=se*Mk+h0,te+=K%3/3,se+=Math.floor(K/3)/3,ge<le&&Se<he&&(T.push(I+he+1,I+1,I),T.push(I+he+1,I+he+2,I+1)),I++}};k(E.FRONT,d,v),k(E.BACK,d,v),k(E.TOP,d,p),k(E.BOTTOM,d,p),k(E.RIGHT,p,v),k(E.LEFT,p,v);var O=Jm(C),U=this.getComponent();U.indices=Uint32Array.from(T),U.aabb=O,U.vertexCount=I,U.attributes=[{dirty:!0,name:"position",data:Float32Array.from(C),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(M),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(w),arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),t}(Bo))||Tk);function Die(r,e){if(!r&&!e)throw new Error("Please specify valid arguments for parameters a and b.");if(!e||e.length===0)return r;if(!r||r.length===0)return e;if(Object.prototype.toString.call(r)!==Object.prototype.toString.call(e))throw new Error("The types of the two arguments passed for parameters a and b do not match.");var t=new r.constructor(r.length+e.length);return t.set(r),t.set(e,r.length),t}var Ik,kk;function Pie(r){var e=Nie();return function(){var n=Tr(r),i;if(e){var a=Tr(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return si(this,i)}}function Nie(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var Lie=(Ik=Ar(),Ik(kk=function(r){oi(t,r);var e=Pie(t);function t(){return wt(this,t),e.apply(this,arguments)}return Bt(t,[{key:"onEntityCreated",value:function(){var i=this.config.geometries,a=i===void 0?[]:i,o=this.getComponent();o.aabb=new Ym;var s=[],u=[],l=0;a.forEach(function(f){var c=f.aabb,h=f.indices,d=f.vertexCount,v=f.attributes;o.aabb.add(c),o.vertexCount+=d,h&&u.push.apply(u,En(h.map(function(p){return p+l}))),l+=d,v.forEach(function(p,g){s[g]?p.data&&(e0(p.data)?s[g].push(p.data):NI(p.data)?s[g].data=Die(s[g].data,p.data):s[g].data=s[g].data.concat(p.data)):(s[g]=p,s[g].dirty=!0)})}),o.attributes=s,o.indices=Uint32Array.from(u),o.dirty=!0}}]),t}(Bo))||kk),Dk,Pk;function Oie(r){var e=Rie();return function(){var n=Tr(r),i;if(e){var a=Tr(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return si(this,i)}}function Rie(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var Bie=(Dk=Ar(),Dk(Pk=function(r){oi(t,r);var e=Oie(t);function t(){return wt(this,t),e.apply(this,arguments)}return Bt(t,[{key:"onEntityCreated",value:function(){for(var i=this.config,a=i.halfExtents,o=a===void 0?[.5,.5]:a,s=i.widthSegments,u=s===void 0?5:s,l=i.lengthSegments,f=l===void 0?5:l,c=[],h=[],d=[],v=[],p=0,g=0;g<=u;g++)for(var y=0;y<=f;y++){var m=-o[0]+2*o[0]*g/u,b=0,x=-(-o[1]+2*o[1]*y/f),_=g/u,S=y/f;c.push(m,b,x),h.push(0,1,0),d.push(_,S),g<u&&y<f&&(v.push(p+f+1,p+1,p),v.push(p+f+1,p+f+2,p+1)),p++}var E=Jm(c),C=this.getComponent();C.indices=Uint32Array.from(v),C.aabb=E,C.vertexCount=p,C.attributes=[{dirty:!0,name:"position",data:Float32Array.from(c),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(h),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(d),arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),t}(Bo))||Pk),Nk,Lk;function Gie(r){var e=Fie();return function(){var n=Tr(r),i;if(e){var a=Tr(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return si(this,i)}}function Fie(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var Uie=(Nk=Ar(),Nk(Lk=function(r){oi(t,r);var e=Gie(t);function t(){return wt(this,t),e.apply(this,arguments)}return Bt(t,[{key:"onEntityCreated",value:function(){for(var i=this.config,a=i.radius,o=a===void 0?.5:a,s=i.latitudeBands,u=s===void 0?16:s,l=i.longitudeBands,f=l===void 0?16:l,c=[],h=[],d=[],v=[],p=0;p<=u;p++)for(var g=p*Math.PI/u,y=Math.sin(g),m=Math.cos(g),b=0;b<=f;b++){var x=b*2*Math.PI/f-Math.PI/2,_=Math.sin(x),S=Math.cos(x),E=S*y,C=m,M=_*y,w=1-b/f,T=1-p/u;c.push(E*o,C*o,M*o),h.push(E,C,M),d.push(w,T)}for(var I=0;I<u;++I)for(var k=0;k<f;++k){var O=I*(f+1)+k,U=O+f+1;v.push(O+1,U,O),v.push(O+1,U+1,U)}var q=Jm(c),K=this.getComponent();K.indices=Uint32Array.from(v),K.aabb=q,K.vertexCount=c.length/3,K.attributes=[{dirty:!0,name:"position",data:Float32Array.from(c),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(h),arrayStride:4*3,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(d),arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),t}(Bo))||Lk),Ok,Rk,Bk,Gk,xv,Fk,Uk,zk;function zie(r){var e=$ie();return function(){var n=Tr(r),i;if(e){var a=Tr(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return si(this,i)}}function $ie(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var Vie=`varying vec4 fragColor;

#pragma include "uv.frag.declaration"
#pragma include "map.frag.declaration"

void main() {
  vec4 diffuseColor = fragColor;

  #pragma include "map.frag.main"

  gl_FragColor = diffuseColor;
}`,Wie=`attribute vec3 position;
attribute vec3 normal;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;
uniform vec4 color;

varying vec4 fragColor;

#pragma include "uv.vert.declaration"

void main() {
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  fragColor = color;

  #pragma include "uv.vert.main"
}`,jie=`// layout(set = 0, binding = 1) uniform WireframeUniforms {
//   float lineWidth;
//   vec4 lineColor;
// } wireframe;

layout(location = 0) in vec4 fragColor;
// layout(location = 1) in vec3 v_Barycentric;

layout(location = 0) out vec4 outColor;

// wireframe
// float edgeFactor() {
//   vec3 d = fwidth(v_Barycentric);
//   vec3 a3 = smoothstep(vec3(0.0), d * wireframe.lineWidth, v_Barycentric);
//   return min(min(a3.x, a3.y), a3.z);
// }

void main() {
  // outColor = mix(fragColor, wireframe.lineColor, (1.0 - edgeFactor()));
  outColor = fragColor;
}`,Xie=`layout(set = 0, binding = 0) uniform Uniforms {
  vec4 color;
  mat4 projectionMatrix;
  mat4 modelViewMatrix;
} uniforms;

layout(location = 0) in vec3 position;
// layout(location = 1) in vec3 barycentric;

layout(location = 0) out vec4 fragColor;
// layout(location = 1) out vec3 v_Barycentric;

void main() {
  gl_Position = uniforms.projectionMatrix * uniforms.modelViewMatrix * vec4(position, 1.0);
  fragColor = uniforms.color;
  // v_Barycentric = barycentric;
}`,Hie=(Ok=Ar(),Rk=Nt(Le.RenderEngine),Bk=Nt(Le.ShaderModuleService),Ok(Gk=(xv=(zk=function(r){oi(t,r);var e=zie(t);function t(){var n;wt(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=e.call.apply(e,[this].concat(a)),Dt(n,"engine",Fk,cn(n)),Dt(n,"shaderModuleService",Uk,cn(n)),n}return Bt(t,[{key:"onEntityCreated",value:function(){var i=this.getComponent(),a=this.engine.supportWebGPU?Xie:Wie,o=this.engine.supportWebGPU?jie:Vie;this.shaderModuleService.registerModule("material-basic",{vs:a,fs:o});var s=this.shaderModuleService.getModule("material-basic"),u=s.vs,l=s.fs,f=s.uniforms;i.vertexShaderGLSL=u,i.fragmentShaderGLSL=l,i.setUniform(f),this.config.map&&(i.setDefines({USE_UV:1,USE_MAP:1}),i.setUniform({map:this.config.map,uvTransform:Cu()}))}}]),t}(KI),zk),Fk=Pt(xv.prototype,"engine",[Rk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uk=Pt(xv.prototype,"shaderModuleService",[Bk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xv))||Gk),$k,Vk,Wk,jk,Xk,Hk,Yk,ac,qk,Kk,Zk,Qk;function Yie(r){var e=qie();return function(){var n=Tr(r),i;if(e){var a=Tr(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return si(this,i)}}function qie(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var Kie=`// generate grid, borrow from clay.gl viewer
// @see https://github.com/pissang/clay-viewer/blob/master/src/graphic/ground.glsl
#extension GL_OES_standard_derivatives : enable

varying vec3 v_Position;
// varying vec3 v_Normal;

uniform float u_GridSize : 5;
uniform float u_GridSize2 : .5;
uniform vec4 u_GridColor : [0, 0, 0, 1];
uniform vec4 u_GridColor2 : [0.3, 0.3, 0.3, 1];
uniform bool u_GridEnabled : true;

// uniform vec3 u_LightDirection;
// uniform vec3 u_LightColor;
// uniform vec3 u_Camera;

void main() {
  // vec3 n = v_Normal;
  // vec3 l = normalize(u_LightDirection);
  // float NdotL = clamp(dot(n, l), 0.001, 1.0);

  gl_FragColor = vec4(1.);

  if (u_GridEnabled) {
    float wx = v_Position.x;
    float wz = v_Position.z;
    // float x0 = abs(fract(wx / u_GridSize - 0.5) - 0.5) / fwidth(wx) * u_GridSize / 2.0;
    // float z0 = abs(fract(wz / u_GridSize - 0.5) - 0.5) / fwidth(wz) * u_GridSize / 2.0;

    float x1 = abs(fract(wx / u_GridSize2 - 0.5) - 0.5) / fwidth(wx) * u_GridSize2;
    float z1 = abs(fract(wz / u_GridSize2 - 0.5) - 0.5) / fwidth(wz) * u_GridSize2;

    // float v0 = 1.0 - clamp(min(x0, z0), 0.0, 1.0);
    float v1 = 1.0 - clamp(min(x1, z1), 0.0, 1.0);
    // if (v0 > 0.1) {
        // gl_FragColor = mix(gl_FragColor, u_GridColor, v0);
    // }
    // else {
        gl_FragColor = mix(gl_FragColor, u_GridColor2, v1);
    // }
  }

  // float shadowFactor = calcShadow(u_ShadowMap, v_PositionFromLight, l, n);
  // vec3 diffuseColor = u_LightColor * NdotL * shadowFactor;

  // gl_FragColor.rgb *= diffuseColor;
}`,Zie=`attribute vec3 a_Position;

varying vec3 v_Position;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;

void main() {
  v_Position = a_Position;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_Position, 1.);
}`,Qie=($k=Ar(),Vk=Nt(Le.Systems),Wk=ka(Le.MaterialSystem),jk=Nt(Le.Systems),Xk=ka(Le.GeometrySystem),Hk=Nt(Le.ShaderModuleService),$k(Yk=(ac=(Qk=function(r){oi(t,r);var e=Yie(t);function t(){var n;wt(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=e.call.apply(e,[this].concat(a)),Dt(n,"materialSystem",qk,cn(n)),Dt(n,"geometrySystem",Kk,cn(n)),Dt(n,"shaderModuleService",Zk,cn(n)),n}return Bt(t,[{key:"onAttributeChanged",value:function(i){var a=i.name,o=i.data,s=this.getMeshComponent();s&&s.material&&(a==="gridColor"?(s.material.setUniform("u_GridColor",o),s.material.setUniform("u_GridColor2",o)):a==="gridSize"&&(s.material.setUniform("u_GridSize",o),s.material.setUniform("u_GridSize2",o)))}},{key:"onEntityCreated",value:function(){this.shaderModuleService.registerModule("grid",{vs:Zie,fs:Kie});var i=this.shaderModuleService.getModule("grid"),a=i.vs,o=i.fs,s=i.uniforms,u=this.materialSystem.createShaderMaterial({vertexShader:a,fragmentShader:o});this.setMaterial(u);var l=this.geometrySystem.createBufferGeometry({vertexCount:4});this.setGeometry(l),u.setCull({enable:!1,face:ae.BACK}).setDepth({enable:!0,func:ae.LESS}),u.setUniform(s),this.setAttributes({gridColor:this.config.gridColor,gridSize:this.config.gridSize}),l.setIndex([0,3,2,2,1,0]),l.setAttribute("a_Position",Float32Array.from([-4,-1,-4,4,-1,-4,4,-1,4,-4,-1,4]),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]})}}]),t}(Go),Qk),qk=Pt(ac.prototype,"materialSystem",[Vk,Wk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kk=Pt(ac.prototype,"geometrySystem",[jk,Xk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zk=Pt(ac.prototype,"shaderModuleService",[Hk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ac))||Yk),d0=1e-6,Jk=Jie;function Jie(){var r=new Float32Array(2);return r[0]=0,r[1]=0,r}var eae=tae;function tae(r){var e=new Float32Array(2);return e[0]=r[0],e[1]=r[1],e}var rae=nae;function nae(r,e){var t=new Float32Array(2);return t[0]=r,t[1]=e,t}var iae=aae;function aae(r,e){return r[0]=e[0],r[1]=e[1],r}var _v=oae;function oae(r,e,t){return r[0]=e,r[1]=t,r}var sae=uae;function uae(r,e){var t=r[0],n=r[1],i=e[0],a=e[1];return Math.abs(t-i)<=d0*Math.max(1,Math.abs(t),Math.abs(i))&&Math.abs(n-a)<=d0*Math.max(1,Math.abs(n),Math.abs(a))}var lae=fae;function fae(r,e){return r[0]===e[0]&&r[1]===e[1]}var eD=cae;function cae(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r}var v0=hae;function hae(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r}var dae=v0,tD=vae;function vae(r,e,t){return r[0]=e[0]*t[0],r[1]=e[1]*t[1],r}var pae=tD,rD=gae;function gae(r,e,t){return r[0]=e[0]/t[0],r[1]=e[1]/t[1],r}var yae=rD,mae=bae;function bae(r,e){return r[0]=1/e[0],r[1]=1/e[1],r}var xae=_ae;function _ae(r,e,t){return r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r}var wae=Sae;function Sae(r,e,t){return r[0]=Math.max(e[0],t[0]),r[1]=Math.max(e[1],t[1]),r}var Eae=Cae;function Cae(r,e,t){var n=Math.cos(t),i=Math.sin(t),a=e[0],o=e[1];return r[0]=a*n-o*i,r[1]=a*i+o*n,r}var Aae=Tae;function Tae(r,e){return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r}var Mae=Iae;function Iae(r,e){return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r}var kae=Dae;function Dae(r,e){return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r}var Pae=Nae;function Nae(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r}var Lae=Oae;function Oae(r,e,t,n){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r}var nD=Rae;function Rae(r,e){var t=e[0]-r[0],n=e[1]-r[1];return Math.sqrt(t*t+n*n)}var Bae=nD,iD=Gae;function Gae(r,e){var t=e[0]-r[0],n=e[1]-r[1];return t*t+n*n}var Fae=iD,aD=Uae;function Uae(r){var e=r[0],t=r[1];return Math.sqrt(e*e+t*t)}var zae=aD,oD=$ae;function $ae(r){var e=r[0],t=r[1];return e*e+t*t}var Vae=oD,Wae=jae;function jae(r,e){return r[0]=-e[0],r[1]=-e[1],r}var p0=Xae;function Xae(r,e){var t=e[0],n=e[1],i=t*t+n*n;return i>0&&(i=1/Math.sqrt(i),r[0]=e[0]*i,r[1]=e[1]*i),r}var sD=Hae;function Hae(r,e){return r[0]*e[0]+r[1]*e[1]}var Yae=qae;function qae(r,e,t){var n=e[0]*t[1]-e[1]*t[0];return r[0]=r[1]=0,r[2]=n,r}var Kae=Zae;function Zae(r,e,t,n){var i=e[0],a=e[1];return r[0]=i+n*(t[0]-i),r[1]=a+n*(t[1]-a),r}var Qae=Jae;function Jae(r,e){e=e||1;var t=Math.random()*2*Math.PI;return r[0]=Math.cos(t)*e,r[1]=Math.sin(t)*e,r}var eoe=toe;function toe(r,e,t){var n=e[0],i=e[1];return r[0]=t[0]*n+t[2]*i,r[1]=t[1]*n+t[3]*i,r}var roe=noe;function noe(r,e,t){var n=e[0],i=e[1];return r[0]=t[0]*n+t[2]*i+t[4],r[1]=t[1]*n+t[3]*i+t[5],r}var ioe=aoe;function aoe(r,e,t){var n=e[0],i=e[1];return r[0]=t[0]*n+t[3]*i+t[6],r[1]=t[1]*n+t[4]*i+t[7],r}var ooe=soe;function soe(r,e,t){var n=e[0],i=e[1];return r[0]=t[0]*n+t[4]*i+t[12],r[1]=t[1]*n+t[5]*i+t[13],r}var uoe=loe,ll=Jk();function loe(r,e,t,n,i,a){var o,s;for(e||(e=2),t||(t=0),n?s=Math.min(n*e+t,r.length):s=r.length,o=t;o<s;o+=e)ll[0]=r[o],ll[1]=r[o+1],i(ll,ll,a),r[o]=ll[0],r[o+1]=ll[1];return r}var foe=coe;function coe(r,e,t){var n=e[0]*e[0]+e[1]*e[1];if(n>t*t){var i=Math.sqrt(n);r[0]=e[0]/i*t,r[1]=e[1]/i*t}else r[0]=e[0],r[1]=e[1];return r}var g0={EPSILON:d0,create:Jk,clone:eae,fromValues:rae,copy:iae,set:_v,equals:sae,exactEquals:lae,add:eD,subtract:v0,sub:dae,multiply:tD,mul:pae,divide:rD,div:yae,inverse:mae,min:xae,max:wae,rotate:Eae,floor:Aae,ceil:Mae,round:kae,scale:Pae,scaleAndAdd:Lae,distance:nD,dist:Bae,squaredDistance:iD,sqrDist:Fae,length:aD,len:zae,squaredLength:oD,sqrLen:Vae,negate:Wae,normalize:p0,dot:sD,cross:Yae,lerp:Kae,random:Qae,transformMat2:eoe,transformMat2d:roe,transformMat3:ioe,transformMat4:ooe,forEach:uoe,limit:foe},hoe=g0.create,uD=g0.copy,doe=g0.dot,lD=[0,0],voe=function(e,t,n,i,a){return eD(e,n,i),p0(e,e),_v(t,-e[1],e[0]),_v(lD,-n[1],n[0]),a/sD(t,lD)},wv=function(e,t){return _v(e,-t[1],t[0]),e},fD=function(e,t,n){return v0(e,t,n),p0(e,e),e};function Sv(r,e,t,n,i){oc(e,n,-i),oc(e,n,i),r.push(t),r.push(t)}function oc(r,e,t){r.push([[e[0],e[1]],t])}function poe(r,e,t){var n=[0,0],i=[0,0],a=[0,0],o=[0,0],s=-1,u=!1,l=null,f=hoe(),c=t||0,h=3,d=[],v=[],p=[],g=[0,0];e&&(r=r.slice(),r.push(r[0]));for(var y=r.length,m=1;m<y;m++){var b=c,x=r[m-1],_=r[m],S=m<r.length-1?r[m+1]:null;if(g.push(m/y,m/y),fD(n,_,x),l||(l=[0,0],wv(l,n)),u||(u=!0,Sv(v,d,x,l,1)),p.push([b+0,b+1,b+2]),!S)wv(l,n),Sv(v,d,_,l,1),p.push(s===1?[b,b+2,b+3]:[b+2,b+1,b+3]),c+=2;else{fD(i,S,_);var E=voe(a,o,n,i,1),C=doe(a,l)<0?-1:1,M=E>h;if(!isFinite(E)){wv(l,n),Sv(v,d,_,l,1),p.push(s===1?[b,b+2,b+3]:[b+2,b+1,b+3]),c+=2,s=C;continue}M?(E=h,g.push(m/y),oc(d,l,-C),v.push(_),oc(d,o,E*C),v.push(_),p.push(s!==-C?[b,b+2,b+3]:[b+2,b+1,b+3]),p.push([b+2,b+3,b+4]),wv(f,i),uD(l,f),oc(d,l,-C),v.push(_),c+=3):(Sv(v,d,_,o,E),p.push(s===1?[b,b+2,b+3]:[b+2,b+1,b+3]),C=-1,uD(l,o),c+=2),s=C}}return{normals:d,attrIndex:p,attrPos:v,attrCounters:g}}var cD,hD,dD,vD,pD,gD,yD,sc,mD,bD,xD,_D;function goe(r){var e=yoe();return function(){var n=Tr(r),i;if(e){var a=Tr(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return si(this,i)}}function yoe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var moe=`uniform float u_dash_array : 0.02;
uniform float u_dash_offset : 0;
uniform float u_dash_ratio : 0;
uniform float u_thickness : 0.02;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_counters;

void main() {
    float blur = 1. - smoothstep(0.98, 1., length(v_normal));

    gl_FragColor = v_color;
    gl_FragColor.a *= blur * ceil(mod(v_counters + u_dash_offset, u_dash_array) - (u_dash_array * u_dash_ratio));
}`,boe=`attribute vec2 a_pos;
attribute vec4 a_color;
attribute float a_line_miter;
attribute vec2 a_line_normal;
attribute float a_counters;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;
uniform float u_thickness : 0.02;
uniform vec2 u_viewport;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_counters;

void main() {
  v_color = a_color;
  v_counters = a_counters;

  vec3 normal = normalize(vec3(a_line_normal, 0.0));

  vec4 offset = vec4(normal * u_thickness / 2.0 * a_line_miter, 0.0);

  v_normal = vec2(normal * sign(a_line_miter));

  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_pos, 0.0, 1.0) + offset;
}
`,xoe=(cD=Ar(),hD=Nt(Le.Systems),dD=ka(Le.MaterialSystem),vD=Nt(Le.Systems),pD=ka(Le.GeometrySystem),gD=Nt(Le.ShaderModuleService),cD(yD=(sc=(_D=function(r){oi(t,r);var e=goe(t);function t(){var n;wt(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=e.call.apply(e,[this].concat(a)),Dt(n,"materialSystem",mD,cn(n)),Dt(n,"geometrySystem",bD,cn(n)),Dt(n,"shaderModuleService",xD,cn(n)),n.vertexCount=void 0,n}return Bt(t,[{key:"onAttributeChanged",value:function(i){var a=i.name,o=i.data,s=this.getMeshComponent();if(s&&s.material)switch(a){case"dashArray":s.material.setUniform("u_dash_array",o);break;case"dashOffset":s.material.setUniform("u_dash_offset",o);break;case"dashRatio":s.material.setUniform("u_dash_ratio",o);break;case"thickness":s.material.setUniform("u_thickness",o);break;case"color":var u=new Array(this.vertexCount).fill(void 0).map(function(){return o}).reduce(function(l,f){return[].concat(En(l),En(f))},[]);s.geometry.setAttribute("a_color",Float32Array.from(u),{arrayStride:4*4,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float4"}]});break}}},{key:"onEntityCreated",value:function(){var i=this;this.shaderModuleService.registerModule("line",{vs:boe,fs:moe});var a=this.shaderModuleService.getModule("line"),o=a.vs,s=a.fs,u=a.uniforms,l=this.materialSystem.createShaderMaterial({vertexShader:o,fragmentShader:s}),f=poe(this.config.points,!1),c=f.normals,h=f.attrIndex,d=f.attrPos,v=f.attrCounters,p=d.length;this.vertexCount=p;var g=this.geometrySystem.createBufferGeometry({vertexCount:p});this.setMaterial(l),this.setGeometry(g),l.setCull({enable:!1,face:ae.BACK}).setUniform(u),this.setAttributes({dashArray:this.config.dashArray,dashOffset:this.config.dashOffset,dashRatio:this.config.dashRatio,thickness:this.config.thickness});var y=[],m=[];c.forEach(function(x){var _=x[0],S=x[1];y.push([_[0],_[1]]),m.push(S)}),g.setIndex(h.reduce(function(x,_){return[].concat(En(x),En(_))},[])),g.setAttribute("a_pos",Float32Array.from(d.reduce(function(x,_){return[].concat(En(x),En(_))},[])),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]});var b=new Array(p).fill(void 0).map(function(){return En(i.config.color)}).reduce(function(x,_){return[].concat(En(x),En(_))},[]);g.setAttribute("a_color",Float32Array.from(b),{arrayStride:4*4,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float4"}]}),g.setAttribute("a_line_miter",Float32Array.from(m),{arrayStride:4*1,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float"}]}),g.setAttribute("a_line_normal",Float32Array.from(y.reduce(function(x,_){return[].concat(En(x),En(_))},[])),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:3,offset:0,format:"float2"}]}),g.setAttribute("a_counters",Float32Array.from(v),{arrayStride:4*1,stepMode:"vertex",attributes:[{shaderLocation:4,offset:0,format:"float"}]})}}]),t}(Go),_D),mD=Pt(sc.prototype,"materialSystem",[hD,dD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bD=Pt(sc.prototype,"geometrySystem",[vD,pD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xD=Pt(sc.prototype,"shaderModuleService",[gD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sc))||yD);function _oe(r){return[r+1&255,r+1>>8&255,r+1>>8>>8&255]}var wD,SD,ED,CD,AD,TD,MD,uc,ID,kD,DD,PD;function ND(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function woe(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ND(Object(t),!0).forEach(function(n){Ce(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ND(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function Soe(r){var e=Eoe();return function(){var n=Tr(r),i;if(e){var a=Tr(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return si(this,i)}}function Eoe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(r){return!1}}var Coe=`uniform float u_blur : 0.05;
uniform float u_opacity : 0.7;
uniform float u_stroke_width : 0.01;
uniform vec4 u_stroke_color : [0, 0, 0, 0];
uniform float u_stroke_opacity : 1;

varying vec4 v_color;
varying vec4 v_data;
varying float v_radius;

#pragma include "sdf2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));

  float antialiasblur = v_data.z;
  float antialiased_blur = -max(u_blur, antialiasblur);
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  // if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  // } else if (shape == 1) {
  //   outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
  //   inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  // } else if (shape == 2) {
  //   outer_df = sdBox(v_data.xy, vec2(1.));
  //   inner_df = sdBox(v_data.xy, vec2(r));
  // } else if (shape == 3) {
  //   outer_df = sdPentagon(v_data.xy, 0.8);
  //   inner_df = sdPentagon(v_data.xy, r * 0.8);
  // } else if (shape == 4) {
  //   outer_df = sdHexagon(v_data.xy, 0.8);
  //   inner_df = sdHexagon(v_data.xy, r * 0.8);
  // } else if (shape == 5) {
  //   outer_df = sdOctogon(v_data.xy, 1.0);
  //   inner_df = sdOctogon(v_data.xy, r);
  // } else if (shape == 6) {
  //   outer_df = sdHexagram(v_data.xy, 0.52);
  //   inner_df = sdHexagram(v_data.xy, r * 0.52);
  // } else if (shape == 7) {
  //   outer_df = sdRhombus(v_data.xy, vec2(1.0));
  //   inner_df = sdRhombus(v_data.xy, vec2(r));
  // } else if (shape == 8) {
  //   outer_df = sdVesica(v_data.xy, 1.1, 0.8);
  //   inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  // }

  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiased_blur,
    0.0,
    inner_df
  );
  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;

  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor.a = gl_FragColor.a * opacity_t;

  gl_FragColor = filterColor(gl_FragColor);
}`,Aoe=`attribute vec2 position;
attribute vec4 color;
attribute float shape;
attribute vec2 offset;
attribute float size;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;

uniform float u_stroke_width : 0.01;
uniform float u_device_pixel_ratio;
uniform vec2 u_viewport;

varying vec4 v_color;
varying vec4 v_data;
varying float v_radius;

#pragma include "picking"

void main() {
  v_color = color;
  v_radius = size;

  lowp float antialiasblur = 1.0 / u_device_pixel_ratio * (size + u_stroke_width);

  // construct point coords
  v_data = vec4(position, antialiasblur, shape);

  gl_Position = projectionMatrix * modelViewMatrix
    * vec4(position * size + offset, 0.0, 1.0);

  setPickingColor(a_PickingColor);
}`,Toe=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],Moe=(wD=Ar(),SD=Nt(Le.Systems),ED=ka(Le.MaterialSystem),CD=Nt(Le.Systems),AD=ka(Le.GeometrySystem),TD=Nt(Le.ShaderModuleService),wD(MD=(uc=(PD=function(r){oi(t,r);var e=Soe(t);function t(){var n;wt(this,t);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=e.call.apply(e,[this].concat(a)),Dt(n,"materialSystem",ID,cn(n)),Dt(n,"geometrySystem",kD,cn(n)),Dt(n,"shaderModuleService",DD,cn(n)),n}return Bt(t,[{key:"onAttributeChanged",value:function(i){var a=i.name,o=i.data,s=this.getMeshComponent();s&&s.material&&(a==="strokeWidth"?s.material.setUniform("u_stroke_width",o):a==="strokeColor"?s.material.setUniform("u_stroke_color",o):a==="strokeOpacity"?s.material.setUniform("u_stroke_opacity",o):a==="opacity"?s.material.setUniform("u_opacity",o):a==="blur"&&s.material.setUniform("u_blur",o))}},{key:"onEntityCreated",value:function(){this.shaderModuleService.registerModule("grid",{vs:Aoe,fs:Coe});var i=this.shaderModuleService.getModule("grid"),a=i.vs,o=i.fs,s=i.uniforms,u=this.materialSystem.createShaderMaterial({vertexShader:a,fragmentShader:o,cull:{enable:!1},depth:{enable:!1},blend:{enable:!0,func:{srcRGB:ae.SRC_ALPHA,dstRGB:ae.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}});u.setUniform(woe({u_device_pixel_ratio:window.devicePixelRatio},s));var l=this.buildAttributes(),f=this.geometrySystem.createInstancedBufferGeometry({maxInstancedCount:l.instancedOffsets.length/2,vertexCount:6});f.setIndex([0,2,1,0,3,2]),f.setAttribute("position",Float32Array.from(l.positions),{arrayStride:4*2,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]}),f.setAttribute("offset",Float32Array.from(l.instancedOffsets),{arrayStride:4*2,stepMode:"instance",attributes:[{shaderLocation:1,offset:0,format:"float2"}]}),f.setAttribute("color",Float32Array.from(l.instancedColors),{arrayStride:4*4,stepMode:"instance",attributes:[{shaderLocation:2,offset:0,format:"float4"}]}),f.setAttribute("size",Float32Array.from(l.instancedSizes),{arrayStride:4,stepMode:"instance",attributes:[{shaderLocation:3,offset:0,format:"float"}]}),f.setAttribute("shape",Float32Array.from(l.instancedShapes),{arrayStride:4,stepMode:"instance",attributes:[{shaderLocation:4,offset:0,format:"float"}]}),f.setAttribute("a_PickingColor",Float32Array.from(l.instancedPickingColors),{arrayStride:4*3,stepMode:"instance",attributes:[{shaderLocation:6,offset:0,format:"float3"}]}),this.setMaterial(u),this.setGeometry(f)}},{key:"buildAttribute",value:function(i,a,o){var s,u,l,f;(s=a.instancedPickingColors).push.apply(s,En(_oe(i.id||o))),a.instancedShapes.push(Toe.indexOf(i.shape||"circle")),(u=a.instancedColors).push.apply(u,En(i.color||[1,0,0,1])),(l=a.instancedOffsets).push.apply(l,En(i.position||[0,0])),(f=a.instancedSizes).push.apply(f,En(i.size||[.2,.2]))}},{key:"buildAttributes",value:function(){var i=this,a={positions:[1,1,1,-1,-1,-1,-1,1],instancedOffsets:[],instancedColors:[],instancedSizes:[],instancedShapes:[],instancedPickingColors:[]};return Array.isArray(this.config)?this.config.forEach(function(o,s){i.buildAttribute(o,a,s)}):this.buildAttribute(this.config,a,0),a}}]),t}(Go),PD),ID=Pt(uc.prototype,"materialSystem",[SD,ED],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kD=Pt(uc.prototype,"geometrySystem",[CD,AD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DD=Pt(uc.prototype,"shaderModuleService",[TD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uc))||MD),LD,OD,RD,BD,GD,lc,FD,UD,zD,$D;function VD(r,e){var t;if(typeof Symbol=="undefined"||r[Symbol.iterator]==null){if(Array.isArray(r)||(t=Ioe(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){t=r[Symbol.iterator]()},n:function(){var l=t.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{!a&&t.return!=null&&t.return()}finally{if(o)throw s}}}}function Ioe(r,e){if(!!r){if(typeof r=="string")return WD(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return WD(r,e)}}function WD(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}var koe=`#ifdef USE_MAP
  uniform sampler2D map;
#endif`,Doe=`#ifdef USE_MAP
  vec4 texelColor = texture2D(map, vUv);
  // texelColor = mapTexelToLinear(texelColor);
  diffuseColor *= texelColor;
#endif`,Poe=`#if (defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ))
  varying vec2 vUv;
#endif`,Noe=`#ifdef USE_UV
  attribute vec2 uv;
	#ifdef UVS_VERTEX_ONLY
    vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,Loe=`#ifdef USE_UV
  vUv = (uvTransform * vec3(uv, 1)).xy;
#endif`,jD=(LD=Ar(),OD=Nt(Le.RenderEngine),RD=Nt(Le.ShaderModuleService),BD=Nt(Le.ConfigService),LD(GD=(lc=($D=function(){function r(){wt(this,r),this.container=void 0,Dt(this,"engine",FD,this),Dt(this,"shaderModule",UD,this),Dt(this,"configService",zD,this),this.inited=!1,this.rendering=!1,this.pendings=[],this.views=[],this.size=void 0}return Bt(r,[{key:"init",value:function(){var e=wr(bt.mark(function n(){var i,a,o,s,u;return bt.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this.shaderModule.registerBuiltinModules(),this.shaderModule.registerModule("uv.vert.declaration",{vs:Noe}),this.shaderModule.registerModule("uv.vert.main",{vs:Loe}),this.shaderModule.registerModule("uv.frag.declaration",{fs:Poe}),this.shaderModule.registerModule("map.frag.declaration",{fs:koe}),this.shaderModule.registerModule("map.frag.main",{fs:Doe}),i=this.container.getAll(Le.Systems),a=this.configService.get(),!a.canvas){f.next=30;break}return f.next=11,this.engine.init({canvas:a.canvas,swapChainFormat:rl.BGRA8Unorm,antialiasing:!1});case 11:o=VD(i),f.prev=12,o.s();case 14:if((s=o.n()).done){f.next=21;break}if(u=s.value,!u.initialize){f.next=19;break}return f.next=19,u.initialize();case 19:f.next=14;break;case 21:f.next=26;break;case 23:f.prev=23,f.t0=f.catch(12),o.e(f.t0);case 26:return f.prev=26,o.f(),f.finish(26);case 29:this.inited=!0;case 30:case"end":return f.stop()}},n,this,[[12,23,26,29]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"render",value:function(){var e=wr(bt.mark(function n(){var i,a,o,s,u,l,f,c=arguments;return bt.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!(!this.inited||this.rendering)){d.next=2;break}return d.abrupt("return");case 2:for(this.pendings.length&&this.pendings.forEach(function(v){v()}),this.rendering=!0,this.engine.beginFrame(),i=this.container.getAll(Le.Systems),a=c.length,o=new Array(a),s=0;s<a;s++)o[s]=c[s];u=VD(i),d.prev=8,u.s();case 10:if((l=u.n()).done){d.next=17;break}if(f=l.value,!f.execute){d.next=15;break}return d.next=15,f.execute(o);case 15:d.next=10;break;case 17:d.next=22;break;case 19:d.prev=19,d.t0=d.catch(8),u.e(d.t0);case 22:return d.prev=22,u.f(),d.finish(22);case 25:this.engine.endFrame(),this.rendering=!1;case 27:case"end":return d.stop()}},n,this,[[8,19,22,25]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"clear",value:function(t){var n=this;return this.inited?this.engine.clear(t):this.pendings.unshift(function(){n.engine.clear(t),n.pendings.shift()}),this}},{key:"setSize",value:function(t){var n=t.width,i=t.height,a=this.engine.getCanvas();return this.size={width:n,height:i},a.width=n,a.height=i,this}},{key:"getSize",value:function(){return this.size}}]),r}(),$D),FD=Pt(lc.prototype,"engine",[OD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UD=Pt(lc.prototype,"shaderModule",[RD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zD=Pt(lc.prototype,"configService",[BD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lc))||GD),XD,HD,YD,qD=(XD=Ar(),XD(HD=(YD=function(){function r(){wt(this,r),this.entities=[]}return Bt(r,[{key:"getEntities",value:function(){return this.entities}},{key:"addRenderable",value:function(t){return this.addEntity(t.getEntity()),this}},{key:"removeRenderable",value:function(t){return this.removeEntity(t.getEntity()),this}},{key:"addLight",value:function(){}},{key:"addEntity",value:function(t){return this.entities.indexOf(t)===-1&&this.entities.push(t),this}},{key:"removeEntity",value:function(t){var n=this.entities.indexOf(t);return this.entities.splice(n,1),this}}]),r}(),YD))||HD),KD,ZD,QD,JD=(KD=Ar(),KD(ZD=(QD=function(){function r(){wt(this,r),this.cache={}}return Bt(r,[{key:"get",value:function(t){return this.cache[t]}},{key:"set",value:function(t,n){this.cache[t]=n}}]),r}(),QD))||ZD),eP,tP,rP,nP,Ev,iP,aP,oP;function sP(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function uP(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?sP(Object(t),!0).forEach(function(n){Ce(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):sP(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var lP=(eP=Ar(),tP=Nt(JD),rP=Nt(Le.RenderEngine),eP(nP=(Ev=(oP=function(){function r(){wt(this,r),Dt(this,"textureCache",iP,this),Dt(this,"engine",aP,this),this.config=void 0,this.loaded=!1,this.texture=void 0}return Bt(r,[{key:"setConfig",value:function(t){this.config=t}},{key:"isLoaded",value:function(){return this.loaded}},{key:"load",value:function(){var e=wr(bt.mark(function n(){var i=this;return bt.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!this.config.url){o.next=4;break}return o.abrupt("return",new Promise(function(s,u){var l=i.textureCache.get(i.config.url);if(l)s(l);else{var f=new Image;f.crossOrigin="Anonymous",f.src=i.config.url,f.onload=function(){var c=i.engine.createTexture2D(uP(uP({},i.config),{},{data:f,width:f.width,height:f.height,flipY:!0}));i.textureCache.set(i.config.url,c),i.texture=c,i.loaded=!0,s(c)},f.onerror=function(){u()}}}));case 4:return this.loaded=!0,this.texture=this.engine.createTexture2D(this.config),o.abrupt("return",this.texture);case 7:case"end":return o.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()}]),r}(),oP),iP=Pt(Ev.prototype,"textureCache",[tP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aP=Pt(Ev.prototype,"engine",[rP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ev))||nP),fP,cP,hP,dP,y0,vP,pP,gP=(fP=Ar(),cP=Nt(Le.Systems),hP=ka(Le.RendererSystem),fP(dP=(y0=(pP=function(){function r(){wt(this,r),Dt(this,"rendererSystem",vP,this),this.camera=void 0,this.scene=void 0,this.viewport={x:0,y:0,width:0,height:0},this.clearColor=[1,1,1,1]}return Bt(r,[{key:"getCamera",value:function(){return this.camera}},{key:"getScene",value:function(){return this.scene}},{key:"getViewport",value:function(){return this.viewport}},{key:"getClearColor",value:function(){return this.clearColor}},{key:"setCamera",value:function(t){return this.camera=t,this}},{key:"setScene",value:function(t){return this.scene=t,this}},{key:"setViewport",value:function(t){return this.viewport=t,this}},{key:"setClearColor",value:function(t){return this.clearColor=t,this}},{key:"pick",value:function(t){return this.rendererSystem.pick(t,this)}}]),r}(),pP),vP=Pt(y0.prototype,"rendererSystem",[cP,hP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y0))||dP),yP,mP,bP,m0,xP,_P;function wP(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function Ooe(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?wP(Object(t),!0).forEach(function(n){Ce(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):wP(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}var Cv=(yP=Ar(),mP=Nt(Le.ConfigService),yP(bP=(m0=(_P=function(){function r(){wt(this,r),Dt(this,"configService",xP,this),this.container=void 0}return Bt(r,[{key:"getEngine",value:function(){var e=wr(bt.mark(function n(){var i,a,o,s;return bt.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return i=this.container.get(Le.RenderEngine),a=this.configService.get(),o=a.canvas,s=a.engineOptions,l.next=4,i.init(Ooe({canvas:o||PI(),swapChainFormat:rl.BGRA8Unorm,antialiasing:!1},s));case 4:return l.abrupt("return",i);case 5:case"end":return l.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getTransformComponent",value:function(t){var n=this.container.get(Le.TransformComponentManager);return n.getComponentByEntity(t)}},{key:"getMeshComponent",value:function(t){var n=this.container.get(Le.MeshComponentManager);return n.getComponentByEntity(t)}},{key:"setConfig",value:function(t){this.configService.set(t)}},{key:"setContainer",value:function(t){this.container=t}},{key:"getContainer",value:function(){return this.container}},{key:"createEntity",value:function(){return Ia()}},{key:"createScene",value:function(){return this.container.get(qD)}},{key:"createCamera",value:function(){return this.container.get(AI)}},{key:"createView",value:function(){return this.container.get(gP)}},{key:"createRenderable",value:function(t,n){var i=t?this.container.getNamed(Le.Renderable,t):this.container.get(Go),a=Ia();return i.setConfig(n||{}),i.setEntity(a),i}},{key:"createGeometry",value:function(t,n){var i=this.container.getNamed(Le.Geometry,t),a=Ia();return i.setConfig(n||{}),i.setEntity(a),i.getComponent()}},{key:"createMaterial",value:function(t,n){var i=this.container.getNamed(Le.Material,t),a=Ia();return i.setConfig(n||{}),i.setEntity(a,t),i.getComponent()}},{key:"createTexture2D",value:function(t){var n=this.container.get(lP);return n.setConfig(t),n}},{key:"createBufferGeometry",value:function(t){var n=this.container.getNamed(Le.Systems,Le.GeometrySystem);return n.createBufferGeometry(t)}},{key:"createInstancedBufferGeometry",value:function(t){var n=this.container.getNamed(Le.Systems,Le.GeometrySystem);return n.createInstancedBufferGeometry(t)}},{key:"createShaderMaterial",value:function(t){var n=this.container.getNamed(Le.Systems,Le.MaterialSystem);return n.createShaderMaterial(t)}},{key:"createKernel",value:function(t){var n=this.container.get(VI);return typeof t=="string"?n.setBundle(JSON.parse(t)):n.setBundle(t),n.init(),n}},{key:"createRenderer",value:function(){var t=this.container.get(jD);return t.container=this.container,t.init(),t}},{key:"destroy",value:function(){var t=this.container.getAll(Le.Systems);t.forEach(function(a){a.tearDown&&a.tearDown()});var n=this.container.get(Le.RenderEngine);n.destroy();var i=this.container.get(Le.InteractorService);i.destroy()}}],[{key:"create",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Mre(),i=navigator.gpu?Tie:uie;n.isBound(Le.RenderEngine)||n.bind(Le.RenderEngine).to(i).inSingletonScope(),n.bind(jD).toSelf(),n.bind(VI).toSelf(),n.bind(Go).toSelf(),n.bind(gP).toSelf(),n.bind(AI).toSelf(),n.bind(qD).toSelf(),n.bind(r).toSelf(),n.bind(JD).toSelf(),n.bind(lP).toSelf(),n.bind(Le.Geometry).to(kie).whenTargetNamed(Bo.BOX),n.bind(Le.Geometry).to(Uie).whenTargetNamed(Bo.SPHERE),n.bind(Le.Geometry).to(Bie).whenTargetNamed(Bo.PLANE),n.bind(Le.Geometry).to(Lie).whenTargetNamed(Bo.MERGED),n.bind(Le.Material).to(Hie).whenTargetNamed(KI.BASIC),n.bind(Le.Renderable).to(Moe).whenTargetNamed(Go.POINT),n.bind(Le.Renderable).to(xoe).whenTargetNamed(Go.LINE),n.bind(Le.Renderable).to(Qie).whenTargetNamed(Go.GRID);var a=n.get(r);return a.setContainer(n),a.setConfig(t),a}}]),r}(),_P),xP=Pt(m0.prototype,"configService",[mP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m0))||bP);const fl=(r,e)=>{let t;return r?ft(r)?t=()=>r:t=r:t=()=>e||1,t},Roe=(r,e)=>{const t=[],n=[],i={};let a=0;for(a=0;a<r.length;a++){const s=r[a];i[s.id]=a,t.push(s.x),t.push(s.y),t.push(0),t.push(0),n.push([])}for(a=0;a<e.length;a++){const s=e[a],u=_r(s,"source"),l=_r(s,"target");n[i[u]].push(i[l]),n[i[l]].push(i[u])}let o=0;for(a=0;a<r.length;a++){const s=t.length,u=n[a],l=u.length;t[a*4+2]=s,t[a*4+3]=u.length,o=Math.max(o,u.length);for(let f=0;f<l;++f){const c=u[f];t.push(+c)}}for(;t.length%4!=0;)t.push(0);return{maxEdgePerVetex:o,array:new Float32Array(t)}},Boe=(r,e,t,n)=>{const i=[],a=[],o={};let s=0;for(s=0;s<r.length;s++){const l=r[s];o[l.id]=s,i.push(l.x),i.push(l.y),i.push(0),i.push(0),a.push([])}for(s=0;s<e.length;s++){const l=e[s],f=_r(l,"source"),c=_r(l,"target");a[o[f]].push(o[c]),a[o[f]].push(t(l)),a[o[f]].push(n(l)),a[o[f]].push(0),a[o[c]].push(o[f]),a[o[c]].push(t(l)),a[o[c]].push(n(l)),a[o[c]].push(0)}let u=0;for(s=0;s<r.length;s++){const l=i.length,f=a[s],c=f.length;i[s*4+2]=l+1048576*c/4,i[s*4+3]=0,u=Math.max(u,c/4);for(let h=0;h<c;++h){const d=f[h];i.push(+d)}}for(;i.length%4!=0;)i.push(0);return{maxEdgePerVetex:u,array:new Float32Array(i)}},Goe=(r,e)=>{const t=[],n=r.length,i={};return e.forEach(a=>{r.forEach((o,s)=>{if(i[a[o]]===void 0&&(i[a[o]]=Object.keys(i).length),t.push(i[a[o]]),s===n-1)for(;t.length%4!=0;)t.push(0)})}),{array:new Float32Array(t),count:Object.keys(i).length}},SP=r=>{const e=[],t=r.length,n=r[0].length;for(let i=0;i<n;i++)r.forEach((a,o)=>{if(e.push(a[i]),o===t-1)for(;e.length%4!=0;)e.push(0)});return new Float32Array(e)},Foe='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_K : f32;\\n  [[offset 4]] u_K2 : f32;\\n  [[offset 8]] u_Center : vec2<f32>;\\n  [[offset 16]] u_Gravity : f32;\\n  [[offset 20]] u_ClusterGravity : f32;\\n  [[offset 24]] u_Speed : f32;\\n  [[offset 28]] u_MaxDisplace : f32;\\n  [[offset 32]] u_Clustering : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AttributeArray : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_ClusterCenters : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 3, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn calcRepulsive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {if (i != j) {var nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nvar xDist : f32 = currentNode.x - nextNode.x;\\nvar yDist : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nvar param : f32 = gWebGPUUniformParams.u_K2 / dist;\\nif (dist > 0.0) {dx = dx + param * xDist;\\ndy = dy + param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {var sign : f32 = select(1.0, -1.0, i < j);\\ndx = dx + param * std::sign;\\ndy = dy + param * std::sign;}}}}\\nreturn vec2<f32>(dx, dy);}\\nfn calcGravity(currentNode : vec4<f32>, nodeAttributes : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nvar vx : f32 = currentNode.x - gWebGPUUniformParams.u_Center.x;\\nvar vy : f32 = currentNode.y - gWebGPUUniformParams.u_Center.y;\\nvar gf : f32 = (0.01 * gWebGPUUniformParams.u_K) * gWebGPUUniformParams.u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (gWebGPUUniformParams.u_Clustering == 1.0) {var clusterIdx : i32 = i32(nodeAttributes.x);\\nvar center : vec4<f32> = gWebGPUBuffer2.u_ClusterCenters[clusterIdx];\\nvar cvx : f32 = currentNode.x - center.x;\\nvar cvy : f32 = currentNode.y - center.y;\\nvar dist : f32 = std::sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nvar parma : f32 = (gWebGPUUniformParams.u_K * gWebGPUUniformParams.u_ClusterGravity) / dist;\\ndx = dx + parma * cvx;\\ndy = dy + parma * cvy;}\\nreturn vec2<f32>(dx, dy);}\\nfn calcAttractive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nvar arr_offset : i32 = i32(std::floor(currentNode.z + 0.5));\\nvar length : i32 = i32(std::floor(currentNode.w + 0.5));\\nvar node_buffer : vec4<f32>;\\nfor (var p : i32 = 0; p < __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX; p = p + 1) {if (p >= length) {break;}\\nvar arr_idx : i32 = arr_offset + i32(p);\\nvar buf_offset : i32 = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[i32(arr_idx / 4)];}\\nvar float_j : f32 = select(node_buffer.x, select(node_buffer.y, select(node_buffer.z, node_buffer.w, buf_offset == 2), buf_offset == 1), buf_offset == 0);\\nvar nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[i32(float_j)];\\nvar xDist : f32 = currentNode.x - nextNode.x;\\nvar yDist : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = std::sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nvar attractiveF : f32 = dist / gWebGPUUniformParams.u_K;\\nif (dist > 0.0) {dx = dx - xDist * attractiveF;\\ndy = dy - yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {var sign : f32 = select(1.0, -1.0, i < i32(float_j));\\ndx = dx - std::sign * attractiveF;\\ndy = dy - std::sign * attractiveF;}}}\\nreturn vec2<f32>(dx, dy);}\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar currentNode : vec4<f32> = gWebGPUBuffer0.u_Data[i];\\nvar dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nif (i >= __DefineValuePlaceholder__VERTEX_COUNT) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvar nodeAttributes : vec4<f32> = gWebGPUBuffer1.u_AttributeArray[i];\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4<f32>(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w);\\nreturn ;}\\nvar repulsive : vec2<f32> = calcRepulsive(i, currentNode);\\ndx = dx + repulsive.x;\\ndy = dy + repulsive.y;\\nvar attractive : vec2<f32> = calcAttractive(i, currentNode);\\ndx = dx + attractive.x;\\ndy = dy + attractive.y;\\nvar gravity : vec2<f32> = calcGravity(currentNode, nodeAttributes);\\ndx = dx - gravity.x;\\ndy = dy - gravity.y;\\ndx = dx * gWebGPUUniformParams.u_Speed;\\ndy = dy * gWebGPUUniformParams.u_Speed;\\nvar distLength : f32 = std::sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {var limitedDist : f32 = std::min(gWebGPUUniformParams.u_MaxDisplace * gWebGPUUniformParams.u_Speed, distLength);\\ngWebGPUBuffer0.u_Data[i] = vec4<f32>(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w);}\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_K;\\n  float u_K2;\\n  vec2 u_Center;\\n  float u_Gravity;\\n  float u_ClusterGravity;\\n  float u_Speed;\\n  float u_MaxDisplace;\\n  float u_Clustering;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer   GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_AttributeArray[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 3) buffer readonly  GWebGPUBuffer2 {\\n  vec4 u_ClusterCenters[];\\n} gWebGPUBuffer2;\\n\\n\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nvec2 calcRepulsive(int i, vec4 currentNode) {float dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = gWebGPUBuffer0.u_Data[j];\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = gWebGPUUniformParams.u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {float dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - gWebGPUUniformParams.u_Center.x;\\nfloat vy = currentNode.y - gWebGPUUniformParams.u_Center.y;\\nfloat gf = (0.01 * gWebGPUUniformParams.u_K) * gWebGPUUniformParams.u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (gWebGPUUniformParams.u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = gWebGPUBuffer2.u_ClusterCenters[clusterIdx];\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (gWebGPUUniformParams.u_K * gWebGPUUniformParams.u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {float dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[int(arr_idx / 4)];}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = gWebGPUBuffer0.u_Data[int(float_j)];\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / gWebGPUUniformParams.u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {int i = globalInvocationID.x;\\nvec4 currentNode = gWebGPUBuffer0.u_Data[i];\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvec4 nodeAttributes = gWebGPUBuffer1.u_AttributeArray[i];\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w);\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= gWebGPUUniformParams.u_Speed;\\ndy *= gWebGPUUniformParams.u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(gWebGPUUniformParams.u_MaxDisplace * gWebGPUUniformParams.u_Speed, distLength);\\ngWebGPUBuffer0.u_Data[i] = vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w);}}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_K;\\nuniform float u_K2;\\nuniform vec2 u_Center;\\nuniform float u_Gravity;\\nuniform float u_ClusterGravity;\\nuniform float u_Speed;\\nuniform float u_MaxDisplace;\\nuniform float u_Clustering;\\nuniform sampler2D u_AttributeArray;\\nuniform vec2 u_AttributeArraySize;\\nvec4 getDatau_AttributeArray(vec2 address2D) {\\n  return vec4(texture2D(u_AttributeArray, address2D).rgba);\\n}\\nvec4 getDatau_AttributeArray(float address1D) {\\n  return getDatau_AttributeArray(addrTranslation_1Dto2D(address1D, u_AttributeArraySize));\\n}\\nvec4 getDatau_AttributeArray(int address1D) {\\n  return getDatau_AttributeArray(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - u_Center.x;\\nfloat vy = currentNode.y - u_Center.y;\\nfloat gf = (0.01 * u_K) * u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = getDatau_ClusterCenters(clusterIdx);\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (u_K * u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes = getDatau_AttributeArray(i);\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w));\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= u_Speed;\\ndy *= u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(u_MaxDisplace * u_Speed, distLength);\\ngl_FragColor = vec4(vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_K","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_K2","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Center","type":"vec2<f32>","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Gravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterGravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Speed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_MaxDisplace","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Clustering","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AttributeArray","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',Uoe='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\n\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 0, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributes : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_ClusterCenters : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar center : vec4<f32> = gWebGPUBuffer2.u_ClusterCenters[i];\\nvar sumx : f32 = 0.0;\\nvar sumy : f32 = 0.0;\\nvar count : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {var attributes : vec4<f32> = gWebGPUBuffer1.u_NodeAttributes[j];\\nvar clusterIdx : i32 = i32(attributes.x);\\nvar vertex : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nif (clusterIdx == i) {sumx = sumx + vertex.x;\\nsumy = sumy + vertex.y;\\ncount = count + 1.0;}}\\ngWebGPUBuffer2.u_ClusterCenters[i] = vec4<f32>(sumx / count, sumy / count, count, i);\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\n\\nlayout(std430, set = 0, binding = 0) buffer readonly  GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 1) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_NodeAttributes[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 2) buffer   GWebGPUBuffer2 {\\n  vec4 u_ClusterCenters[];\\n} gWebGPUBuffer2;\\n\\n\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\nvoid main() {int i = globalInvocationID.x;\\nvec4 center = gWebGPUBuffer2.u_ClusterCenters[i];\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = gWebGPUBuffer1.u_NodeAttributes[j];\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = gWebGPUBuffer0.u_Data[j];\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngWebGPUBuffer2.u_ClusterCenters[i] = vec4(sumx / count, sumy / count, count, i);}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributes;\\nuniform vec2 u_NodeAttributesSize;\\nvec4 getDatau_NodeAttributes(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributes, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributes(float address1D) {\\n  return getDatau_NodeAttributes(addrTranslation_1Dto2D(address1D, u_NodeAttributesSize));\\n}\\nvec4 getDatau_NodeAttributes(int address1D) {\\n  return getDatau_NodeAttributes(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 center = getDatau_ClusterCenters(i);\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = getDatau_NodeAttributes(j);\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = getDatau_Data(j);\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngl_FragColor = vec4(vec4(sumx / count, sumy / count, count, i));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"CLUSTER_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributes","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_ClusterCenters","size":[1,1],"length":1},"needPingpong":true}}';var Av=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function s(f){try{l(n.next(f))}catch(c){o(c)}}function u(f){try{l(n.throw(f))}catch(c){o(c)}}function l(f){f.done?a(f.value):i(f.value).then(s,u)}l((n=n.apply(r,e||[])).next())})};class zoe extends hi{constructor(e){super();this.maxIteration=1e3,this.gravity=10,this.speed=1,this.clustering=!1,this.clusterField="cluster",this.clusterGravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(e)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10}}execute(){return Av(this,void 0,void 0,function*(){const e=this,t=e.nodes;if(!t||t.length===0){e.onLayoutEnd&&e.onLayoutEnd();return}!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const n=e.center;if(t.length===1){t[0].x=n[0],t[0].y=n[1],e.onLayoutEnd&&e.onLayoutEnd();return}const i={},a={};t.forEach((o,s)=>{ft(o.x)||(o.x=Math.random()*this.width),ft(o.y)||(o.y=Math.random()*this.height),i[o.id]=o,a[o.id]=s}),e.nodeMap=i,e.nodeIdxMap=a,yield e.run()})}executeWithWorker(e,t){return Av(this,void 0,void 0,function*(){const n=this,i=n.nodes,a=n.center;if(!i||i.length===0)return;if(i.length===1){i[0].x=a[0],i[0].y=a[1];return}const o={},s={};i.forEach((u,l)=>{ft(u.x)||(u.x=Math.random()*this.width),ft(u.y)||(u.y=Math.random()*this.height),o[u.id]=u,s[u.id]=l}),n.nodeMap=o,n.nodeIdxMap=s,yield n.run(e,t)})}run(e,t){return Av(this,void 0,void 0,function*(){const n=this,i=n.nodes,a=n.edges,o=n.maxIteration,s=n.center,u=n.height*n.width;let l=Math.sqrt(u)/10;const f=u/(i.length+1),c=Math.sqrt(f),h=n.speed,d=n.clustering,{array:v,count:p}=Goe([n.clusterField],i);i.forEach((w,T)=>{let I=0,k=0;ft(w.fx)&&ft(w.fy)&&(I=w.fx||.001,k=w.fy||.001),v[4*T+1]=I,v[4*T+2]=k});const g=i.length,{maxEdgePerVetex:y,array:m}=Roe(i,a),b=n.workerEnabled;let x;b?x=Cv.create({canvas:e,engineOptions:{supportCompute:!0}}):x=Cv.create({engineOptions:{supportCompute:!0}});const _=n.onLayoutEnd,S=[];for(let w=0;w<p;w++)S.push(0,0,0,0);const E=x.createKernel(Foe).setDispatch([g,1,1]).setBinding({u_Data:m,u_K:c,u_K2:f,u_Gravity:n.gravity,u_ClusterGravity:n.clusterGravity||n.gravity||1,u_Speed:h,u_MaxDisplace:l,u_Clustering:d?1:0,u_Center:s,u_AttributeArray:v,u_ClusterCenters:S,MAX_EDGE_PER_VERTEX:y,VERTEX_COUNT:g});let C;d&&(C=x.createKernel(Uoe).setDispatch([p,1,1]).setBinding({u_Data:m,u_NodeAttributes:v,u_ClusterCenters:S,VERTEX_COUNT:g,CLUSTER_COUNT:p})),yield(()=>Av(this,void 0,void 0,function*(){for(let T=0;T<o;T++)yield E.execute(),d&&(C.setBinding({u_Data:E}),yield C.execute(),E.setBinding({u_ClusterCenters:C})),E.setBinding({u_MaxDisplace:l*=.99});const w=yield E.getOutput();e?t.postMessage({type:Jy.GPUEND,vertexEdgeData:w}):i.forEach((T,I)=>{const k=w[4*I],O=w[4*I+1];T.x=k,T.y=O}),_&&_()}))()})}getType(){return"fruchterman-gpu"}}const $oe='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_damping : f32;\\n  [[offset 4]] u_maxSpeed : f32;\\n  [[offset 8]] u_minMovement : f32;\\n  \\n  [[offset 12]] u_coulombDisScale : f32;\\n  [[offset 16]] u_factor : f32;\\n  \\n  \\n  [[offset 20]] u_interval : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AveMovement : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributeArray1 : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 3, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\ntype GWebGPUBuffer3 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributeArray2 : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 4, set 0]] var<storage_buffer> gWebGPUBuffer3 : GWebGPUBuffer3;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn unpack_float(packedValue : f32) -> vec2<i32> {var packedIntValue : i32 = i32(packedValue);\\nvar v0 : i32 = packedIntValue / 1048576;\\nreturn vec2<i32>(v0, packedIntValue - (v0 * 1048576));}\\nfn calcRepulsive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {if (i != j) {var nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nvar vx : f32 = currentNode.x - nextNode.x;\\nvar vy : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.01;\\nvar n_dist : f32 = (dist + 0.1) * gWebGPUUniformParams.u_coulombDisScale;\\nvar direx : f32 = vx / dist;\\nvar direy : f32 = vy / dist;\\nvar attributesi : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvar attributesj : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[j];\\nvar massi : f32 = attributesi.x;\\nvar nodeStrengthi : f32 = attributesi.z;\\nvar nodeStrengthj : f32 = attributesj.z;\\nvar nodeStrength : f32 = (nodeStrengthi + nodeStrengthj) / 2.0;\\nvar param : f32 = (nodeStrength * gWebGPUUniformParams.u_factor) / (n_dist * n_dist);\\nax = ax + direx * param;\\nay = ay + direy * param;}}\\nreturn vec2<f32>(ax, ay);}\\nfn calcGravity(i : i32, currentNode : vec4<f32>, attributes2 : vec4<f32>) -> vec2<f32> {var vx : f32 = currentNode.x - attributes2.x;\\nvar vy : f32 = currentNode.y - attributes2.y;\\nvar ax : f32 = vx * attributes2.z;\\nvar ay : f32 = vy * attributes2.z;\\nreturn vec2<f32>(ax, ay);}\\nfn calcAttractive(i : i32, currentNode : vec4<f32>, attributes1 : vec4<f32>) -> vec2<f32> {var mass : f32 = attributes1.x;\\nvar ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nvar compressed : vec2<i32> = unpack_float(currentNode.z);\\nvar length : i32 = compressed.x;\\nvar arr_offset : i32 = compressed.y;\\nvar node_buffer : vec4<f32>;\\nfor (var p : i32 = 0; p < __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX; p = p + 1) {if (p >= length) {break;}\\nvar arr_idx : i32 = arr_offset + (4 * p);\\nvar buf_offset : i32 = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[i32(arr_idx / 4)];}\\nvar float_j : f32 = node_buffer.x;\\nvar nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[i32(float_j)];\\nvar vx : f32 = nextNode.x - currentNode.x;\\nvar vy : f32 = nextNode.y - currentNode.y;\\nvar dist : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.01;\\nvar direx : f32 = vx / dist;\\nvar direy : f32 = vy / dist;\\nvar edgeLength : f32 = node_buffer.y;\\nvar edgeStrength : f32 = node_buffer.z;\\nvar diff : f32 = edgeLength - dist;\\nvar param : f32 = (diff * edgeStrength) / mass;\\nax = ax - direx * param;\\nay = ay - direy * param;}\\nreturn vec2<f32>(ax, ay);}\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar currentNode : vec4<f32> = gWebGPUBuffer0.u_Data[i];\\nvar movement : vec4<f32> = gWebGPUBuffer1.u_AveMovement[0];\\nvar ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nif ((i >= __DefineValuePlaceholder__VERTEX_COUNT) || (movement.x < gWebGPUUniformParams.u_minMovement)) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvar nodeAttributes1 : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvar nodeAttributes2 : vec4<f32> = gWebGPUBuffer3.u_NodeAttributeArray2[i];\\nvar repulsive : vec2<f32> = calcRepulsive(i, currentNode);\\nax = ax + repulsive.x;\\nay = ay + repulsive.y;\\nvar attractive : vec2<f32> = calcAttractive(i, currentNode, nodeAttributes1);\\nax = ax + attractive.x;\\nay = ay + attractive.y;\\nvar gravity : vec2<f32> = calcGravity(i, currentNode, nodeAttributes2);\\nax = ax - gravity.x;\\nay = ay - gravity.y;\\nvar param : f32 = gWebGPUUniformParams.u_interval * gWebGPUUniformParams.u_damping;\\nvar vx : f32 = ax * param;\\nvar vy : f32 = ay * param;\\nvar vlength : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > gWebGPUUniformParams.u_maxSpeed) {var param2 : f32 = gWebGPUUniformParams.u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nvar distx : f32 = vx * gWebGPUUniformParams.u_interval;\\nvar disty : f32 = vy * gWebGPUUniformParams.u_interval;\\nvar distLength : f32 = std::sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4<f32>(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0);}else {gWebGPUBuffer0.u_Data[i] = vec4<f32>(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength);}\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_damping;\\n  float u_maxSpeed;\\n  float u_minMovement;\\n  \\n  float u_coulombDisScale;\\n  float u_factor;\\n  \\n  \\n  float u_interval;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer   GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_AveMovement[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 3) buffer readonly  GWebGPUBuffer2 {\\n  vec4 u_NodeAttributeArray1[];\\n} gWebGPUBuffer2;\\n\\nlayout(std430, set = 0, binding = 4) buffer readonly  GWebGPUBuffer3 {\\n  vec4 u_NodeAttributeArray2[];\\n} gWebGPUBuffer3;\\n\\n\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nivec2 unpack_float(float packedValue) {int packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {float ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = gWebGPUBuffer0.u_Data[j];\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * gWebGPUUniformParams.u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvec4 attributesj = gWebGPUBuffer2.u_NodeAttributeArray1[j];\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * gWebGPUUniformParams.u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {float vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {float mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[int(arr_idx / 4)];}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = gWebGPUBuffer0.u_Data[int(float_j)];\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {int i = globalInvocationID.x;\\nvec4 currentNode = gWebGPUBuffer0.u_Data[i];\\nvec4 movement = gWebGPUBuffer1.u_AveMovement[0];\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < gWebGPUUniformParams.u_minMovement)) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvec4 nodeAttributes1 = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvec4 nodeAttributes2 = gWebGPUBuffer3.u_NodeAttributeArray2[i];\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = gWebGPUUniformParams.u_interval * gWebGPUUniformParams.u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > gWebGPUUniformParams.u_maxSpeed) {float param2 = gWebGPUUniformParams.u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nfloat distx = vx * gWebGPUUniformParams.u_interval;\\nfloat disty = vy * gWebGPUUniformParams.u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0);}else {gWebGPUBuffer0.u_Data[i] = vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength);}}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_damping;\\nuniform float u_maxSpeed;\\nuniform float u_minMovement;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nuniform float u_coulombDisScale;\\nuniform float u_factor;\\nuniform sampler2D u_NodeAttributeArray1;\\nuniform vec2 u_NodeAttributeArray1Size;\\nvec4 getDatau_NodeAttributeArray1(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray1, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray1(float address1D) {\\n  return getDatau_NodeAttributeArray1(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray1Size));\\n}\\nvec4 getDatau_NodeAttributeArray1(int address1D) {\\n  return getDatau_NodeAttributeArray1(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributeArray2;\\nuniform vec2 u_NodeAttributeArray2Size;\\nvec4 getDatau_NodeAttributeArray2(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray2, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray2(float address1D) {\\n  return getDatau_NodeAttributeArray2(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray2Size));\\n}\\nvec4 getDatau_NodeAttributeArray2(int address1D) {\\n  return getDatau_NodeAttributeArray2(float(address1D));\\n}\\nuniform float u_interval;\\nivec2 unpack_float(float packedValue) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = getDatau_NodeAttributeArray1(i);\\nvec4 attributesj = getDatau_NodeAttributeArray1(j);\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nvec4 movement = getDatau_AveMovement(0.0);\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < u_minMovement)) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes1 = getDatau_NodeAttributeArray1(i);\\nvec4 nodeAttributes2 = getDatau_NodeAttributeArray2(i);\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = u_interval * u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > u_maxSpeed) {float param2 = u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nfloat distx = vx * u_interval;\\nfloat disty = vy * u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0));}else {gl_FragColor = vec4(vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"SHIFT_20","type":"Float","value":1048576,"runtime":false}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_damping","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_maxSpeed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_minMovement","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_coulombDisScale","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_factor","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray1","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray2","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_interval","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',Voe='{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_iter : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AveMovement : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\n\\n\\n\\n\\n\\n\\n\\n\\nfn main() -> void {var movement : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {var vertex : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nmovement = movement + vertex.w;}\\nmovement = movement / f32(__DefineValuePlaceholder__VERTEX_COUNT);\\ngWebGPUBuffer1.u_AveMovement[0] = vec4<f32>(movement, 0.0, 0.0, 0.0);\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_iter;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer readonly  GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer   GWebGPUBuffer1 {\\n  vec4 u_AveMovement[];\\n} gWebGPUBuffer1;\\n\\n\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\nvoid main() {float movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = gWebGPUBuffer0.u_Data[j];\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngWebGPUBuffer1.u_AveMovement[0] = vec4(movement, 0.0, 0.0, 0.0);}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_iter;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = getDatau_Data(j);\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngl_FragColor = vec4(vec4(movement, 0.0, 0.0, 0.0));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_iter","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_AveMovement","size":[1,1],"length":1},"needPingpong":true}}';var b0=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function s(f){try{l(n.next(f))}catch(c){o(c)}}function u(f){try{l(n.throw(f))}catch(c){o(c)}}function l(f){f.done?a(f.value):i(f.value).then(s,u)}l((n=n.apply(r,e||[])).next())})};class Woe extends hi{constructor(e){super();this.maxIteration=1e3,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(e)}getDefaultCfg(){return{maxIteration:2e3,gravity:10,clustering:!1,clusterGravity:10}}execute(){return b0(this,void 0,void 0,function*(){const e=this,t=e.nodes;if(!t||t.length===0){e.onLayoutEnd&&e.onLayoutEnd();return}!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);const n=e.center;if(t.length===1){t[0].x=n[0],t[0].y=n[1],e.onLayoutEnd&&e.onLayoutEnd();return}const i={},a={};t.forEach((o,s)=>{ft(o.x)||(o.x=Math.random()*e.width),ft(o.y)||(o.y=Math.random()*e.height),i[o.id]=o,a[o.id]=s}),e.nodeMap=i,e.nodeIdxMap=a,e.nodeStrength=fl(e.nodeStrength,1),e.edgeStrength=fl(e.edgeStrength,1),yield e.run()})}executeWithWorker(e,t){const n=this,i=n.nodes,a=n.center;if(!i||i.length===0)return;if(i.length===1){i[0].x=a[0],i[0].y=a[1];return}const o={},s={};i.forEach((u,l)=>{ft(u.x)||(u.x=Math.random()*n.width),ft(u.y)||(u.y=Math.random()*n.height),o[u.id]=u,s[u.id]=l}),n.nodeMap=o,n.nodeIdxMap=s,n.nodeStrength=fl(n.nodeStrength,1),n.edgeStrength=fl(n.edgeStrength,1),n.run(e,t)}run(e,t){return b0(this,void 0,void 0,function*(){const n=this,i=n.nodes,a=n.edges,o=n.maxIteration;!n.width&&typeof window!="undefined"&&(n.width=window.innerWidth),!n.height&&typeof window!="undefined"&&(n.height=window.innerHeight);const s=i.length;n.linkDistance=fl(n.linkDistance),n.edgeStrength=fl(n.edgeStrength);const{maxEdgePerVetex:u,array:l}=Boe(i,a,n.linkDistance,n.edgeStrength);n.degrees=kf(i.length,n.nodeIdxMap,a);const f=[],c=[],h=[],d=[],v=[],p=[],g=[];n.getMass||(n.getMass=I=>n.degrees[n.nodeIdxMap[I.id]]||1);const y=n.gravity,m=n.center;i.forEach((I,k)=>{f.push(n.getMass(I)),c.push(n.nodeStrength(I)),n.degrees[k]||(n.degrees[k]=0);let O=[m[0],m[1],y];if(n.getCenter){const U=n.getCenter(I,n.degrees[k]);U&&ft(U[0])&&ft(U[1])&&ft(U[2])&&(O=U)}h.push(O[0]),d.push(O[1]),v.push(O[2]),ft(I.fx)&&ft(I.fy)?(p.push(I.fx||.001),g.push(I.fy||.001)):(p.push(0),g.push(0))});const b=SP([f,n.degrees,c,p]),x=SP([h,d,v,g]),_=n.workerEnabled;let S;_?S=Cv.create({canvas:e,engineOptions:{supportCompute:!0}}):S=Cv.create({engineOptions:{supportCompute:!0}});const E=n.onLayoutEnd,C=[];l.forEach(I=>{C.push(I)});for(let I=0;I<4;I++)C.push(0);const M=S.createKernel($oe).setDispatch([s,1,1]).setBinding({u_Data:l,u_damping:n.damping,u_maxSpeed:n.maxSpeed,u_minMovement:n.minMovement,u_coulombDisScale:n.coulombDisScale,u_factor:n.factor,u_NodeAttributeArray1:b,u_NodeAttributeArray2:x,MAX_EDGE_PER_VERTEX:u,VERTEX_COUNT:s,u_AveMovement:C,u_interval:n.interval}),w=S.createKernel(Voe).setDispatch([1,1,1]).setBinding({u_Data:l,VERTEX_COUNT:s,u_AveMovement:[0,0,0,0]});yield(()=>b0(this,void 0,void 0,function*(){for(let k=0;k<o;k++){yield M.execute(),w.setBinding({u_Data:M}),yield w.execute();const O=Math.max(.02,n.interval-k*.002);M.setBinding({u_interval:O,u_AveMovement:w})}const I=yield M.getOutput();e?t.postMessage({type:Jy.GPUEND,vertexEdgeData:I}):i.forEach((k,O)=>{const U=I[4*O],q=I[4*O+1];k.x=U,k.y=q}),E&&E()}))()})}getType(){return"gForce-gpu"}}class joe extends hi{constructor(e){super();this.center=[0,0],this.maxIteration=100,this.gravity=10,this.comboGravity=10,this.linkDistance=10,this.alpha=1,this.alphaMin=.001,this.alphaDecay=1-Math.pow(this.alphaMin,1/300),this.alphaTarget=0,this.velocityDecay=.6,this.edgeStrength=.6,this.nodeStrength=30,this.preventOverlap=!1,this.preventNodeOverlap=!1,this.preventComboOverlap=!1,this.collideStrength=void 0,this.nodeCollideStrength=.5,this.comboCollideStrength=.5,this.comboSpacing=20,this.comboPadding=10,this.optimizeRangeFactor=1,this.onTick=()=>{},this.onLayoutEnd=()=>{},this.depthAttractiveForceScale=1,this.depthRepulsiveForceScale=2,this.nodes=[],this.edges=[],this.combos=[],this.comboTrees=[],this.width=300,this.height=300,this.bias=[],this.nodeMap={},this.oriComboMap={},this.indexMap={},this.comboMap={},this.previousLayouted=!1,this.updateCfg(e)}getDefaultCfg(){return{maxIteration:100,center:[0,0],gravity:10,speed:1,comboGravity:30,preventOverlap:!1,preventComboOverlap:!0,preventNodeOverlap:!0,nodeSpacing:void 0,collideStrength:void 0,nodeCollideStrength:.5,comboCollideStrength:.5,comboSpacing:20,comboPadding:10,edgeStrength:.6,nodeStrength:30,linkDistance:10}}execute(){const e=this,t=e.nodes,n=e.center;if(e.comboTree={id:"comboTreeRoot",depth:-1,children:e.comboTrees},!t||t.length===0){e.onLayoutEnd&&e.onLayoutEnd();return}if(t.length===1){t[0].x=n[0],t[0].y=n[1],e.onLayoutEnd&&e.onLayoutEnd();return}e.initVals(),e.run(),e.onLayoutEnd&&e.onLayoutEnd()}run(){const e=this,t=e.nodes,n=e.previousLayouted?e.maxIteration/5:e.maxIteration;!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight);const i=e.center,a=e.velocityDecay,o=e.comboMap;e.previousLayouted||e.initPos(o);for(let l=0;l<n;l++){const f=[];t.forEach((c,h)=>{f[h]={x:0,y:0}}),e.applyCalculate(f),e.applyComboCenterForce(f),t.forEach((c,h)=>{!ft(c.x)||!ft(c.y)||(c.x+=f[h].x*a,c.y+=f[h].y*a)}),e.alpha+=(e.alphaTarget-e.alpha)*e.alphaDecay,e.onTick()}const s=[0,0];t.forEach(l=>{!ft(l.x)||!ft(l.y)||(s[0]+=l.x,s[1]+=l.y)}),s[0]/=t.length,s[1]/=t.length;const u=[i[0]-s[0],i[1]-s[1]];t.forEach((l,f)=>{!ft(l.x)||!ft(l.y)||(l.x+=u[0],l.y+=u[1])}),e.combos.forEach(l=>{const f=o[l.id];f&&f.empty&&(l.x=f.cx||l.x,l.y=f.cy||l.y)}),e.previousLayouted=!0}initVals(){const e=this,t=e.edges,n=e.nodes,i=e.combos,a={},o={},s={};n.forEach((w,T)=>{o[w.id]=w,s[w.id]=T}),e.nodeMap=o,e.indexMap=s;const u={};i.forEach(w=>{u[w.id]=w}),e.oriComboMap=u,e.comboMap=e.getComboMap();const l=e.preventOverlap;e.preventComboOverlap=e.preventComboOverlap||l,e.preventNodeOverlap=e.preventNodeOverlap||l;const f=e.collideStrength;f&&(e.comboCollideStrength=f,e.nodeCollideStrength=f),e.comboCollideStrength=e.comboCollideStrength?e.comboCollideStrength:0,e.nodeCollideStrength=e.nodeCollideStrength?e.nodeCollideStrength:0;for(let w=0;w<t.length;++w){const T=_r(t[w],"source"),I=_r(t[w],"target");a[T]?a[T]++:a[T]=1,a[I]?a[I]++:a[I]=1}const c=[];for(let w=0;w<t.length;++w){const T=_r(t[w],"source"),I=_r(t[w],"target");c[w]=a[T]/(a[T]+a[I])}this.bias=c;const h=e.nodeSize,d=e.nodeSpacing;let v,p;if(ft(d)?p=()=>d:To(d)?p=d:p=()=>0,this.nodeSpacing=p,!h)v=w=>w.size?qn(w.size)?(w.size[0]>w.size[1]?w.size[0]:w.size[1])/2:Ma(w.size)?(w.size.width>w.size.height?w.size.width:w.size.height)/2:w.size/2:10;else if(To(h))v=w=>h(w);else if(qn(h)){const T=(h[0]>h[1]?h[0]:h[1])/2;v=I=>T}else{const w=h/2;v=T=>w}this.nodeSize=v;const g=e.comboSpacing;let y;ft(g)?y=()=>g:To(g)?y=g:y=()=>0,this.comboSpacing=y;const m=e.comboPadding;let b;ft(m)?b=()=>m:qn(m)?b=()=>Math.max.apply(null,m):To(m)?b=m:b=()=>0,this.comboPadding=b;let x=this.linkDistance,_;x||(x=10),ft(x)?_=w=>x:_=x,this.linkDistance=_;let S=this.edgeStrength,E;S||(S=1),ft(S)?E=w=>S:E=S,this.edgeStrength=E;let C=this.nodeStrength,M;C||(C=30),ft(C)?M=w=>C:M=C,this.nodeStrength=M}initPos(e){this.nodes.forEach((i,a)=>{const o=i.comboId,s=e[o];o&&s?(i.x=s.cx+100/(a+1),i.y=s.cy+100/(a+1)):(i.x=100/(a+1),i.y=100/(a+1))})}getComboMap(){const e=this,t=e.nodeMap,n=e.indexMap,i=e.comboTrees,a=e.oriComboMap,o={};return(i||[]).forEach(s=>{const u=[];bd(s,l=>{if(l.itemType==="node"||!a[l.id])return!0;if(o[l.id]===void 0){const h={id:l.id,name:l.id,cx:0,cy:0,count:0,depth:e.oriComboMap[l.id].depth||0,children:[]};o[l.id]=h}const f=l.children;f&&f.forEach(h=>{if(!o[h.id]&&!t[h.id])return!0;u.push(h)});const c=o[l.id];if(c.cx=0,c.cy=0,u.length===0){c.empty=!0;const h=a[l.id],d=Object.keys(t).length,v=`${l.id}-visual-child-${d}`,p={id:v,x:h.x,y:h.y,depth:c.depth+1,itemType:"node"};e.nodes.push(p),t[v]=p,n[v]=d,c.cx=h.x,c.cy=h.y,u.push(p)}return u.forEach(h=>{if(c.count++,h.itemType!=="node"){const v=o[h.id];ft(v.cx)&&(c.cx+=v.cx),ft(v.cy)&&(c.cy+=v.cy);return}const d=t[h.id];!d||(ft(d.x)&&(c.cx+=d.x),ft(d.y)&&(c.cy+=d.y))}),c.cx/=c.count,c.cy/=c.count,c.children=u,!0})}),o}applyComboCenterForce(e){const t=this,n=t.gravity,i=t.comboGravity||n,a=this.alpha,o=t.comboTrees,s=t.indexMap,u=t.nodeMap,l=t.comboMap;(o||[]).forEach(f=>{bd(f,c=>{if(c.itemType==="node"||!l[c.id])return!0;const d=l[c.id],v=(d.depth+1)/10*.5,p=d.cx,g=d.cy;return d.cx=0,d.cy=0,d.children.forEach(y=>{if(y.itemType!=="node"){const C=l[y.id];C&&ft(C.cx)&&(d.cx+=C.cx),C&&ft(C.cy)&&(d.cy+=C.cy);return}const m=u[y.id],b=m.x-p||.005,x=m.y-g||.005,_=Math.sqrt(b*b+x*x),S=s[m.id],E=i*a/_*v;e[S].x-=b*E,e[S].y-=x*E,ft(m.x)&&(d.cx+=m.x),ft(m.y)&&(d.cy+=m.y)}),d.cx/=d.count,d.cy/=d.count,!0})})}applyCalculate(e){const t=this,n=t.comboMap,i=t.nodes,a={};i.forEach((s,u)=>{i.forEach((l,f)=>{if(u<f)return;const c=s.x-l.x||.005,h=s.y-l.y||.005;let d=c*c+h*h;const v=Math.sqrt(d);d<1&&(d=v),a[`${s.id}-${l.id}`]={vx:c,vy:h,vl2:d,vl:v},a[`${l.id}-${s.id}`]={vl2:d,vl:v,vx:-c,vy:-h}})}),t.updateComboSizes(n),t.calRepulsive(e,a),t.calAttractive(e,a),t.preventComboOverlap&&t.comboNonOverlapping(e,n)}updateComboSizes(e){const t=this,n=t.comboTrees,i=t.nodeMap,a=t.nodeSize,o=t.comboSpacing,s=t.comboPadding;(n||[]).forEach(u=>{const l=[];bd(u,f=>{if(f.itemType==="node")return!0;const c=e[f.id];if(!c)return!1;const h=f.children;h&&h.forEach(p=>{!e[p.id]&&!i[p.id]||l.push(p)}),c.minX=1/0,c.minY=1/0,c.maxX=-1/0,c.maxY=-1/0,l.forEach(p=>{if(p.itemType!=="node")return!0;const g=i[p.id];if(!g)return!0;const y=a(g),m=g.x-y,b=g.y-y,x=g.x+y,_=g.y+y;c.minX>m&&(c.minX=m),c.minY>b&&(c.minY=b),c.maxX<x&&(c.maxX=x),c.maxY<_&&(c.maxY=_)});let d=t.oriComboMap[f.id].size||10;qn(d)&&(d=d[0]);const v=Math.max(c.maxX-c.minX,c.maxY-c.minY,d);return c.r=v/2+o(c)/2+s(c),!0})})}comboNonOverlapping(e,t){const n=this,i=n.comboTree,a=n.comboCollideStrength,o=n.indexMap,s=n.nodeMap;bd(i,u=>{if(!t[u.id]&&!s[u.id]&&u.id!=="comboTreeRoot")return!1;const l=u.children;return l&&l.length>1&&l.forEach((f,c)=>{if(f.itemType==="node")return!1;const h=t[f.id];!h||l.forEach((d,v)=>{if(c<=v||d.itemType==="node")return!1;const p=t[d.id];if(!p)return!1;const g=h.cx-p.cx||.005,y=h.cy-p.cy||.005,m=g*g+y*y,b=h.r||1,x=p.r||1,_=b+x,S=x*x,E=b*b;if(m<_*_){const C=f.children;if(!C||C.length===0)return!1;const M=d.children;if(!M||M.length===0)return!1;const w=Math.sqrt(m),T=(_-w)/w*a,I=g*T,k=y*T,O=S/(E+S),U=1-O;C.forEach(q=>{if(q.itemType!=="node")return!1;if(!s[q.id])return;const K=o[q.id];M.forEach(le=>{if(le.itemType!=="node"||!s[le.id])return!1;const he=o[le.id];e[K].x+=I*O,e[K].y+=k*O,e[he].x-=I*U,e[he].y-=k*U})})}})}),!0})}calRepulsive(e,t){const n=this,i=n.nodes,a=n.width*n.optimizeRangeFactor,o=n.nodeStrength,s=n.alpha,u=n.nodeCollideStrength,l=n.preventNodeOverlap,f=n.nodeSize,c=n.nodeSpacing,h=n.depthRepulsiveForceScale,d=n.center;i.forEach((v,p)=>{if(!(!v.x||!v.y)){if(d){const g=n.gravity,y=v.x-d[0]||.005,m=v.y-d[1]||.005,b=Math.sqrt(y*y+m*m);e[p].x-=y*g*s/b,e[p].y-=m*g*s/b}i.forEach((g,y)=>{if(p===y||!g.x||!g.y)return;const{vl2:m,vl:b}=t[`${v.id}-${g.id}`];if(b>a)return;const{vx:x,vy:_}=t[`${v.id}-${g.id}`];let S=Math.log(Math.abs(g.depth-v.depth)/10)+1||1;S=S<1?1:S,g.comboId!==v.comboId&&(S+=1);const E=S?Math.pow(h,S):1,C=o(g)*s/m*E;if(e[p].x+=x*C,e[p].y+=_*C,p<y&&l){const M=f(v)+c(v)||1,w=f(g)+c(g)||1,T=M+w;if(m<T*T){const I=(T-b)/b*u,k=w*w;let O=k/(M*M+k);const U=x*I,q=_*I;e[p].x+=U*O,e[p].y+=q*O,O=1-O,e[y].x-=U*O,e[y].y-=q*O}}})}})}calAttractive(e,t){const n=this,i=n.edges,a=n.linkDistance,o=n.alpha,s=n.edgeStrength,u=n.bias,l=n.depthAttractiveForceScale;i.forEach((f,c)=>{const h=_r(f,"source"),d=_r(f,"target");if(!h||!d||h===d)return;const v=n.indexMap[h],p=n.indexMap[d],g=n.nodeMap[h],y=n.nodeMap[d];if(!g||!y)return;let m=g.depth===y.depth?0:Math.log(Math.abs(g.depth-y.depth)/10);g.comboId===y.comboId&&(m=m/2);let b=m?Math.pow(l,m):1;if(g.comboId!==y.comboId&&b===1?b=l/2:g.comboId===y.comboId&&(b=2),!ft(y.x)||!ft(g.x)||!ft(y.y)||!ft(g.y))return;const{vl:x,vx:_,vy:S}=t[`${d}-${h}`],E=(x-a(f))/x*o*s(f)*b,C=_*E,M=S*E,w=u[c];e[p].x-=C*w,e[p].y-=M*w,e[v].x+=C*(1-w),e[v].y+=M*(1-w)})}getType(){return"comboForce"}}class x0{constructor(e){this.id=e.id||0,this.rx=e.rx,this.ry=e.ry,this.fx=0,this.fy=0,this.mass=e.mass,this.degree=e.degree,this.g=e.g||0}distanceTo(e){const t=this.rx-e.rx,n=this.ry-e.ry;return Math.hypot(t,n)}setPos(e,t){this.rx=e,this.ry=t}resetForce(){this.fx=0,this.fy=0}addForce(e){const t=e.rx-this.rx,n=e.ry-this.ry;let i=Math.hypot(t,n);i=i<1e-4?1e-4:i;const a=this.g*(this.degree+1)*(e.degree+1)/i;this.fx+=a*t/i,this.fy+=a*n/i}in(e){return e.contains(this.rx,this.ry)}add(e){const t=this.mass+e.mass,n=(this.rx*this.mass+e.rx*e.mass)/t,i=(this.ry*this.mass+e.ry*e.mass)/t,a=this.degree+e.degree,o={rx:n,ry:i,mass:t,degree:a};return new x0(o)}}class cl{constructor(e){this.xmid=e.xmid,this.ymid=e.ymid,this.length=e.length,this.massCenter=e.massCenter||[0,0],this.mass=e.mass||1}getLength(){return this.length}contains(e,t){const n=this.length/2;return e<=this.xmid+n&&e>=this.xmid-n&&t<=this.ymid+n&&t>=this.ymid-n}NW(){const e=this.xmid-this.length/4,t=this.ymid+this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new cl(i)}NE(){const e=this.xmid+this.length/4,t=this.ymid+this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new cl(i)}SW(){const e=this.xmid-this.length/4,t=this.ymid-this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new cl(i)}SE(){const e=this.xmid+this.length/4,t=this.ymid-this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new cl(i)}}class hl{constructor(e){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,e!=null&&(this.quad=e)}insert(e){if(this.body==null){this.body=e;return}this._isExternal()?(this.quad&&(this.NW=new hl(this.quad.NW()),this.NE=new hl(this.quad.NE()),this.SW=new hl(this.quad.SW()),this.SE=new hl(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e))}_putBody(e){!this.quad||(e.in(this.quad.NW())&&this.NW?this.NW.insert(e):e.in(this.quad.NE())&&this.NE?this.NE.insert(e):e.in(this.quad.SW())&&this.SW?this.SW.insert(e):e.in(this.quad.SE())&&this.SE&&this.SE.insert(e))}_isExternal(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null}updateForce(e){if(!(this.body==null||e===this.body))if(this._isExternal())e.addForce(this.body);else{const t=this.quad?this.quad.getLength():0,n=this.body.distanceTo(e);t/n<this.theta?e.addForce(this.body):(this.NW&&this.NW.updateForce(e),this.NE&&this.NE.updateForce(e),this.SW&&this.SW.updateForce(e),this.SE&&this.SE.updateForce(e))}}}class Xoe extends hi{constructor(e){super();this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.kr=5,this.kg=1,this.mode="normal",this.preventOverlap=!1,this.dissuadeHubs=!1,this.barnesHut=void 0,this.maxIteration=0,this.ks=.1,this.ksmax=10,this.tao=.1,this.onLayoutEnd=()=>{},this.prune=void 0,this.updateCfg(e)}getDefaultCfg(){return{}}execute(){const e=this,{nodes:t,onLayoutEnd:n,prune:i}=e;let a=e.maxIteration;!e.width&&typeof window!="undefined"&&(e.width=window.innerWidth),!e.height&&typeof window!="undefined"&&(e.height=window.innerHeight);const o=[],s=t.length;for(let u=0;u<s;u+=1){const l=t[u];let f=10,c=10;ft(l.size)&&(f=l.size,c=l.size),qn(l.size)?(isNaN(l.size[0])||(f=l.size[0]),isNaN(l.size[1])||(c=l.size[1])):Ma(l.size)&&(f=l.size.width,c=l.size.height),e.getWidth&&!isNaN(e.getWidth(l))&&(c=e.getWidth(l)),e.getHeight&&!isNaN(e.getHeight(l))&&(f=e.getHeight(l));const h=Math.max(f,c);o.push(h)}e.barnesHut===void 0&&s>250&&(e.barnesHut=!0),e.prune===void 0&&s>100&&(e.prune=!0),this.maxIteration===0&&!e.prune?(a=250,s<=200&&s>100?a=1e3:s>200&&(a=1200),this.maxIteration=a):this.maxIteration===0&&i&&(a=100,s<=200&&s>100?a=500:s>200&&(a=950),this.maxIteration=a),e.kr||(e.kr=50,s>100&&s<=500?e.kr=20:s>500&&(e.kr=1)),e.kg||(e.kg=20,s>100&&s<=500?e.kg=10:s>500&&(e.kg=1)),this.nodes=e.updateNodesByForces(o),n()}updateNodesByForces(e){const t=this,{edges:n,maxIteration:i}=t;let a=t.nodes;const o=n.filter(v=>{const p=_r(v,"source"),g=_r(v,"target");return p!==g}),s=a.length,u=o.length,l=[],f={},c={},h=[];for(let v=0;v<s;v+=1)f[a[v].id]=v,l[v]=0,(a[v].x===void 0||isNaN(a[v].x))&&(a[v].x=Math.random()*1e3),(a[v].y===void 0||isNaN(a[v].y))&&(a[v].y=Math.random()*1e3),h.push({x:a[v].x,y:a[v].y});for(let v=0;v<u;v+=1){let p,g,y=0,m=0;for(let b=0;b<s;b+=1){const x=_r(o[v],"source"),_=_r(o[v],"target");a[b].id===x?(p=a[b],y=b):a[b].id===_&&(g=a[b],m=b),c[v]={sourceIdx:y,targetIdx:m}}p&&(l[f[p.id]]+=1),g&&(l[f[g.id]]+=1)}let d=i;if(a=this.iterate(d,f,c,u,l,e),t.prune){for(let v=0;v<u;v+=1)l[c[v].sourceIdx]<=1?(a[c[v].sourceIdx].x=a[c[v].targetIdx].x,a[c[v].sourceIdx].y=a[c[v].targetIdx].y):l[c[v].targetIdx]<=1&&(a[c[v].targetIdx].x=a[c[v].sourceIdx].x,a[c[v].targetIdx].y=a[c[v].sourceIdx].y);t.prune=!1,t.barnesHut=!1,d=100,a=this.iterate(d,f,c,u,l,e)}return a}iterate(e,t,n,i,a,o){const s=this;let{nodes:u}=s;const{kr:l,preventOverlap:f}=s,{barnesHut:c}=s,h=u.length;let d=0;const v=100;let p=e;const g=50;let y=[];const m=[],b=[];for(let x=0;x<h;x+=1)if(y[2*x]=0,y[2*x+1]=0,c){const _={id:x,rx:u[x].x,ry:u[x].y,mass:1,g:l,degree:a[x]};b[x]=new x0(_)}for(;p>0;){for(let _=0;_<h;_+=1)m[2*_]=y[2*_],m[2*_+1]=y[2*_+1],y[2*_]=0,y[2*_+1]=0;y=this.getAttrForces(p,g,i,t,n,a,o,y),c&&(f&&p>g||!f)?y=this.getOptRepGraForces(y,b,a):y=this.getRepGraForces(p,g,y,v,o,a);const x=this.updatePos(y,m,d,a);u=x.nodes,d=x.sg,p--,s.tick&&s.tick()}return u}getAttrForces(e,t,n,i,a,o,s,u){const l=this,{nodes:f,preventOverlap:c,dissuadeHubs:h,mode:d,prune:v}=l;for(let p=0;p<n;p+=1){const g=f[a[p].sourceIdx],y=a[p].sourceIdx,m=f[a[p].targetIdx],b=a[p].targetIdx;if(v&&(o[y]<=1||o[b]<=1))continue;const x=[m.x-g.x,m.y-g.y];let _=Math.hypot(x[0],x[1]);_=_<1e-4?1e-4:_,x[0]=x[0]/_,x[1]=x[1]/_,c&&e<t&&(_=_-s[y]-s[b]);let S=_,E=S;d==="linlog"&&(S=Math.log(1+_),E=S),h&&(S=_/o[y],E=_/o[b]),c&&e<t&&_<=0?(S=0,E=0):c&&e<t&&_>0&&(S=_,E=_),u[2*i[g.id]]+=S*x[0],u[2*i[m.id]]-=E*x[0],u[2*i[g.id]+1]+=S*x[1],u[2*i[m.id]+1]-=E*x[1]}return u}getRepGraForces(e,t,n,i,a,o){const s=this,{nodes:u,preventOverlap:l,kr:f,kg:c,center:h,prune:d}=s,v=u.length;for(let p=0;p<v;p+=1){for(let b=p+1;b<v;b+=1){if(d&&(o[p]<=1||o[b]<=1))continue;const x=[u[b].x-u[p].x,u[b].y-u[p].y];let _=Math.hypot(x[0],x[1]);_=_<1e-4?1e-4:_,x[0]=x[0]/_,x[1]=x[1]/_,l&&e<t&&(_=_-a[p]-a[b]);let S=f*(o[p]+1)*(o[b]+1)/_;l&&e<t&&_<0?S=i*(o[p]+1)*(o[b]+1):l&&e<t&&_===0?S=0:l&&e<t&&_>0&&(S=f*(o[p]+1)*(o[b]+1)/_),n[2*p]-=S*x[0],n[2*b]+=S*x[0],n[2*p+1]-=S*x[1],n[2*b+1]+=S*x[1]}const g=[u[p].x-h[0],u[p].y-h[1]],y=Math.hypot(g[0],g[1]);g[0]=g[0]/y,g[1]=g[1]/y;const m=c*(o[p]+1);n[2*p]-=m*g[0],n[2*p+1]-=m*g[1]}return n}getOptRepGraForces(e,t,n){const i=this,{nodes:a,kg:o,center:s,prune:u}=i,l=a.length;let f=9e10,c=-9e10,h=9e10,d=-9e10;for(let m=0;m<l;m+=1)u&&n[m]<=1||(t[m].setPos(a[m].x,a[m].y),a[m].x>=c&&(c=a[m].x),a[m].x<=f&&(f=a[m].x),a[m].y>=d&&(d=a[m].y),a[m].y<=h&&(h=a[m].y));const v=Math.max(c-f,d-h),p={xmid:(c+f)/2,ymid:(d+h)/2,length:v,massCenter:s,mass:l},g=new cl(p),y=new hl(g);for(let m=0;m<l;m+=1)u&&n[m]<=1||t[m].in(g)&&y.insert(t[m]);for(let m=0;m<l;m+=1){if(u&&n[m]<=1)continue;t[m].resetForce(),y.updateForce(t[m]),e[2*m]-=t[m].fx,e[2*m+1]-=t[m].fy;const b=[a[m].x-s[0],a[m].y-s[1]];let x=Math.hypot(b[0],b[1]);x=x<1e-4?1e-4:x,b[0]=b[0]/x,b[1]=b[1]/x;const _=o*(n[m]+1);e[2*m]-=_*b[0],e[2*m+1]-=_*b[1]}return e}updatePos(e,t,n,i){const a=this,{nodes:o,ks:s,tao:u,prune:l,ksmax:f}=a,c=o.length,h=[],d=[];let v=0,p=0;for(let y=0;y<c;y+=1){if(l&&i[y]<=1)continue;const m=[e[2*y]-t[2*y],e[2*y+1]-t[2*y+1]],b=Math.hypot(m[0],m[1]),x=[e[2*y]+t[2*y],e[2*y+1]+t[2*y+1]],_=Math.hypot(x[0],x[1]);h[y]=b,d[y]=_/2,v+=(i[y]+1)*h[y],p+=(i[y]+1)*d[y]}const g=n;n=u*p/v,g!==0&&(n=n>1.5*g?1.5*g:n);for(let y=0;y<c;y+=1){if(l&&i[y]<=1)continue;let m=s*n/(1+n*Math.sqrt(h[y])),b=Math.hypot(e[2*y],e[2*y+1]);b=b<1e-4?1e-4:b;const x=f/b;m=m>x?x:m;const _=m*e[2*y],S=m*e[2*y+1];o[y].x+=_,o[y].y+=S}return{nodes:o,sg:n}}}const _0=new Proxy({},{get:(r,e)=>V6(e),set:(r,e,t)=>(ai(e,t),!0)});var Hoe=sg.mix,ao={assign:Hoe};ao.assign;var w0=18,Yoe=w0*2,EP=w0,qoe={getId:function(e){return e.id||e.name},getPreH:function(e){return e.preH||0},getPreV:function(e){return e.preV||0},getHGap:function(e){return e.hgap||EP},getVGap:function(e){return e.vgap||EP},getChildren:function(e){return e.children},getHeight:function(e){return e.height||Yoe},getWidth:function(e){var t=e.label||" ";return e.width||t.split("").length*w0}};function Tv(r,e){var t=this;if(t.vgap=t.hgap=0,r instanceof Tv)return r;t.data=r;var n=e.getHGap(r),i=e.getVGap(r);return t.preH=e.getPreH(r),t.preV=e.getPreV(r),t.width=e.getWidth(r),t.height=e.getHeight(r),t.width+=t.preH,t.height+=t.preV,t.id=e.getId(r),t.x=t.y=0,t.depth=0,t.children||(t.children=[]),t.addGap(n,i),t}ao.assign(Tv.prototype,{isRoot:function(){return this.depth===0},isLeaf:function(){return this.children.length===0},addGap:function(e,t){var n=this;n.hgap+=e,n.vgap+=t,n.width+=2*e,n.height+=2*t},eachNode:function(e){for(var t=this,n=[t],i;i=n.shift();)e(i),n=i.children.concat(n)},DFTraverse:function(e){this.eachNode(e)},BFTraverse:function(e){for(var t=this,n=[t],i;i=n.shift();)e(i),n=n.concat(i.children)},getBoundingBox:function(){var e={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(function(t){e.left=Math.min(e.left,t.x),e.top=Math.min(e.top,t.y),e.width=Math.max(e.width,t.x+t.width),e.height=Math.max(e.height,t.y+t.height)}),e},translate:function(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.eachNode(function(n){n.x+=e,n.y+=t,n.x+=n.preH,n.y+=n.preV})},right2left:function(){var e=this,t=e.getBoundingBox();e.eachNode(function(n){n.x=n.x-(n.x-t.left)*2-n.width}),e.translate(t.width,0)},bottom2top:function(){var e=this,t=e.getBoundingBox();e.eachNode(function(n){n.y=n.y-(n.y-t.top)*2-n.height}),e.translate(0,t.height)}});function Koe(r,e,t){e===void 0&&(e={}),e=ao.assign({},qoe,e);var n=new Tv(r,e),i=[n],a;if(!t&&!r.collapsed){for(;a=i.shift();)if(!a.data.collapsed){var o=e.getChildren(a.data),s=o?o.length:0;if(a.children=new Array(s),o&&s)for(var u=0;u<s;u++){var l=new Tv(o[u],e);a.children[u]=l,i.push(l),l.parent=a,l.depth=a.depth+1}}}return n}var S0=Koe,Zoe=function(){function r(t,n){n===void 0&&(n={});var i=this;i.options=n,i.rootNode=S0(t,n)}var e=r.prototype;return e.execute=function(){throw new Error("please override this method")},r}(),Mv=Zoe;function fc(r,e,t,n){n===void 0&&(n=[]);var i=this;i.w=r||0,i.h=e||0,i.y=t||0,i.x=0,i.c=n||[],i.cs=n.length,i.prelim=0,i.mod=0,i.shift=0,i.change=0,i.tl=null,i.tr=null,i.el=null,i.er=null,i.msel=0,i.mser=0}fc.fromNode=function(r,e){if(!r)return null;var t=[];return r.children.forEach(function(n){t.push(fc.fromNode(n,e))}),e?new fc(r.height,r.width,r.x,t):new fc(r.width,r.height,r.y,t)};function CP(r,e,t){t?r.y+=e:r.x+=e,r.children.forEach(function(n){CP(n,e,t)})}function AP(r,e){var t=e?r.y:r.x;return r.children.forEach(function(n){t=Math.min(AP(n,e),t)}),t}function Qoe(r,e){var t=AP(r,e);CP(r,-t,e)}function TP(r,e,t){t?e.y=r.x:e.x=r.x,r.c.forEach(function(n,i){TP(n,e.children[i],t)})}function MP(r,e,t){t===void 0&&(t=0),e?(r.x=t,t+=r.width):(r.y=t,t+=r.height),r.children.forEach(function(n){MP(n,e,t)})}var Joe=function(r,e){e===void 0&&(e={});var t=e.isHorizontal;function n(m){if(m.cs===0){i(m);return}n(m.c[0]);for(var b=g(l(m.c[0].el),0,null),x=1;x<m.cs;++x){n(m.c[x]);var _=l(m.c[x].er);a(m,x,b),b=g(_,x,b)}h(m),i(m)}function i(m){m.cs===0?(m.el=m,m.er=m,m.msel=m.mser=0):(m.el=m.c[0].el,m.msel=m.c[0].msel,m.er=m.c[m.cs-1].er,m.mser=m.c[m.cs-1].mser)}function a(m,b,x){for(var _=m.c[b-1],S=_.mod,E=m.c[b],C=E.mod;_!==null&&E!==null;){l(_)>x.low&&(x=x.nxt);var M=S+_.prelim+_.w-(C+E.prelim);M>0&&(C+=M,o(m,b,x.index,M));var w=l(_),T=l(E);w<=T&&(_=u(_),_!==null&&(S+=_.mod)),w>=T&&(E=s(E),E!==null&&(C+=E.mod))}!_&&!!E?f(m,b,E,C):!!_&&!E&&c(m,b,_,S)}function o(m,b,x,_){m.c[b].mod+=_,m.c[b].msel+=_,m.c[b].mser+=_,v(m,b,x,_)}function s(m){return m.cs===0?m.tl:m.c[0]}function u(m){return m.cs===0?m.tr:m.c[m.cs-1]}function l(m){return m.y+m.h}function f(m,b,x,_){var S=m.c[0].el;S.tl=x;var E=_-x.mod-m.c[0].msel;S.mod+=E,S.prelim-=E,m.c[0].el=m.c[b].el,m.c[0].msel=m.c[b].msel}function c(m,b,x,_){var S=m.c[b].er;S.tr=x;var E=_-x.mod-m.c[b].mser;S.mod+=E,S.prelim-=E,m.c[b].er=m.c[b-1].er,m.c[b].mser=m.c[b-1].mser}function h(m){m.prelim=(m.c[0].prelim+m.c[0].mod+m.c[m.cs-1].mod+m.c[m.cs-1].prelim+m.c[m.cs-1].w)/2-m.w/2}function d(m,b){b+=m.mod,m.x=m.prelim+b,p(m);for(var x=0;x<m.cs;x++)d(m.c[x],b)}function v(m,b,x,_){if(x!==b-1){var S=b-x;m.c[x+1].shift+=_/S,m.c[b].shift-=_/S,m.c[b].change-=_-_/S}}function p(m){for(var b=0,x=0,_=0;_<m.cs;_++)b+=m.c[_].shift,x+=b+m.c[_].change,m.c[_].mod+=x}function g(m,b,x){for(;x!==null&&m>=x.low;)x=x.nxt;return{low:m,index:b,nxt:x}}MP(r,t);var y=fc.fromNode(r,t);return n(y),d(y,0),TP(y,r,t),Qoe(r,t),r},IP=function(r,e){for(var t=S0(r.data,e,!0),n=S0(r.data,e,!0),i=r.children.length,a=Math.round(i/2),o=e.getSide||function(f,c){return c<a?"right":"left"},s=0;s<i;s++){var u=r.children[s],l=o(u,s);l==="right"?n.children.push(u):t.children.push(u)}return t.eachNode(function(f){f.isRoot()||(f.side="left")}),n.eachNode(function(f){f.isRoot()||(f.side="right")}),{left:t,right:n}},Uo=["LR","RL","TB","BT","H","V"],ese=["LR","RL","H"],tse=function(e){return ese.indexOf(e)>-1},rse=Uo[0],E0=function(r,e,t){var n=e.direction||rse;if(e.isHorizontal=tse(n),n&&Uo.indexOf(n)===-1)throw new TypeError("Invalid direction: "+n);if(n===Uo[0])t(r,e);else if(n===Uo[1])t(r,e),r.right2left();else if(n===Uo[2])t(r,e);else if(n===Uo[3])t(r,e),r.bottom2top();else if(n===Uo[4]||n===Uo[5]){var i=IP(r,e),a=i.left,o=i.right;t(a,e),t(o,e),e.isHorizontal?a.right2left():a.bottom2top(),o.translate(a.x-o.x,a.y-o.y),r.x=a.x,r.y=o.y;var s=r.getBoundingBox();e.isHorizontal?s.top<0&&r.translate(0,-s.top):s.left<0&&r.translate(-s.left,0)}var u=e.fixedRoot;return u===void 0&&(u=!0),u&&r.translate(-(r.x+r.width/2+r.hgap),-(r.y+r.height/2+r.vgap)),r};function nse(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}var ise=function(r){nse(e,r);function e(){return r.apply(this,arguments)||this}var t=e.prototype;return t.execute=function(){var i=this;return E0(i.rootNode,i.options,Joe)},e}(Mv),ase={};function ose(r,e){return e=ao.assign({},ase,e),new ise(r,e).execute()}var sse=ose;function use(r,e){e===void 0&&(e=[]);var t=this;t.x=t.y=0,t.leftChild=t.rightChild=null,t.height=0,t.children=e}var lse={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function kP(r,e,t){t?(e.x=r.x,e.y=r.y):(e.x=r.y,e.y=r.x),r.children.forEach(function(n,i){kP(n,e.children[i],t)})}var fse=function(r,e){e===void 0&&(e={}),e=ao.assign({},lse,e);var t=0;function n(u){if(!u)return null;u.width=0,u.depth&&u.depth>t&&(t=u.depth);var l=u.children,f=l.length,c=new use(u.height,[]);return l.forEach(function(h,d){var v=n(h);c.children.push(v),d===0&&(c.leftChild=v),d===f-1&&(c.rightChild=v)}),c.originNode=u,c.isLeaf=u.isLeaf(),c}function i(u){if(u.isLeaf||u.children.length===0)u.drawingDepth=t;else{var l=u.children.map(function(c){return i(c)}),f=Math.min.apply(null,l);u.drawingDepth=f-1}return u.drawingDepth}var a;function o(u){u.x=u.drawingDepth*e.rankSep,u.isLeaf?(u.y=0,a&&(u.y=a.y+a.height+e.nodeSep,u.originNode.parent!==a.originNode.parent&&(u.y+=e.subTreeSep)),a=u):(u.children.forEach(function(l){o(l)}),u.y=(u.leftChild.y+u.rightChild.y)/2)}var s=n(r);return i(s),o(s),kP(s,r,e.isHorizontal),r};function cse(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}var hse=function(r){cse(e,r);function e(){return r.apply(this,arguments)||this}var t=e.prototype;return t.execute=function(){var i=this;return i.rootNode.width=0,E0(i.rootNode,i.options,fse)},e}(Mv),dse={};function vse(r,e){return e=ao.assign({},dse,e),new hse(r,e).execute()}var pse=vse;function gse(r,e,t,n){var i=typeof t=="function"?t(r):t*r.depth;if(!n)try{if(r.id===r.parent.children[0].id){r.x+=i,r.y=e?e.y:0;return}}catch(a){}r.x+=i,r.y=e?e.y+e.height:0}var Iv=function(r,e,t){var n=null;r.eachNode(function(i){gse(i,n,e,t),n=i})};function yse(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}var cc=["LR","RL","H"],mse=cc[0],bse=function(r){yse(e,r);function e(){return r.apply(this,arguments)||this}var t=e.prototype;return t.execute=function(){var i=this,a=i.options,o=i.rootNode;a.isHorizontal=!0;var s=a.indent,u=s===void 0?20:s,l=a.dropCap,f=l===void 0?!0:l,c=a.direction||mse;if(c&&cc.indexOf(c)===-1)throw new TypeError("Invalid direction: "+c);if(c===cc[0])Iv(o,u,f);else if(c===cc[1])Iv(o,u,f),o.right2left();else if(c===cc[2]){var h=IP(o,a),d=h.left,v=h.right;Iv(d,u,f),d.right2left(),Iv(v,u,f);var p=d.getBoundingBox();v.translate(p.width,0),o.x=v.x-o.width/2}return o},e}(Mv),xse={};function _se(r,e){return e=ao.assign({},xse,e),new bse(r,e).execute()}var wse=_se;function DP(r,e){var t=0;return r.children.length?r.children.forEach(function(n){t+=DP(n,e)}):t=r.height,r._subTreeSep=e.getSubTreeSep(r.data),r.totalHeight=Math.max(r.height,t)+2*r._subTreeSep,r.totalHeight}function PP(r){var e=r.children,t=e.length;if(t){e.forEach(function(u){PP(u)});var n=e[0],i=e[t-1],a=i.y-n.y+i.height,o=0;if(e.forEach(function(u){o+=u.totalHeight}),a>r.height)r.y=n.y+a/2-r.height/2;else if(e.length!==1||r.height>o){var s=r.y+(r.height-a)/2-n.y;e.forEach(function(u){u.translate(0,s)})}else r.y=(n.y+n.height/2+i.y+i.height/2)/2-r.height/2}}var Sse={getSubTreeSep:function(){return 0}},Ese=function(r,e){e===void 0&&(e={}),e=ao.assign({},Sse,e),r.parent={x:0,width:0,height:0,y:0},r.BFTraverse(function(t){t.x=t.parent.x+t.parent.width}),r.parent=null,DP(r,e),r.startY=0,r.y=r.totalHeight/2-r.height/2,r.eachNode(function(t){var n=t.children,i=n.length;if(i){var a=n[0];if(a.startY=t.startY+t._subTreeSep,i===1)a.y=t.y+t.height/2-a.height/2;else{a.y=a.startY+a.totalHeight/2-a.height/2;for(var o=1;o<i;o++){var s=n[o];s.startY=n[o-1].startY+n[o-1].totalHeight,s.y=s.startY+s.totalHeight/2-s.height/2}}}}),PP(r)};function Cse(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}var Ase=function(r){Cse(e,r);function e(){return r.apply(this,arguments)||this}var t=e.prototype;return t.execute=function(){var i=this;return E0(i.rootNode,i.options,Ese)},e}(Mv),Tse={};function Mse(r,e){return e=ao.assign({},Tse,e),new Ase(r,e).execute()}var Ise=Mse,kse={compactBox:sse,dendrogram:pse,indented:wse,mindmap:Ise},kv=kse,NP=ta.traverseTree,Dse=function(e,t){var n;return e?Lt(e)?n=function(a){return e}:n=e:n=function(a){return t||1},n},Pse=function(e,t){var n=[],i=[],a={},o=0;for(o=0;o<e.length;o++){var s=e[o];a[s.id]=o,n.push(s.x),n.push(s.y),n.push(0),n.push(0),i.push([])}for(o=0;o<t.length;o++){var u=t[o];i[a[u.source]].push(a[u.target]),i[a[u.target]].push(a[u.source])}var l=0;for(o=0;o<e.length;o++){var f=n.length,c=i[o],h=c.length;n[o*4+2]=f,n[o*4+3]=c.length,l=Math.max(l,c.length);for(var d=0;d<h;++d){var v=c[d];n.push(+v)}}for(;n.length%4!=0;)n.push(0);return{array:new Float32Array(n),maxEdgePerVetex:l}},Nse=function(e,t,n){var i=[],a=[],o={},s=0;for(s=0;s<e.length;s++){var u=e[s];o[u.id]=s,i.push(u.x),i.push(u.y),i.push(0),i.push(0),a.push([])}for(s=0;s<t.length;s++){var l=t[s];a[o[l.source]].push(o[l.target]),a[o[l.source]].push(n(l)),a[o[l.target]].push(o[l.source]),a[o[l.target]].push(n(l))}var f=0;for(s=0;s<e.length;s++){var c=i.length,h=a[s],d=h.length;i[s*4+2]=c,i[s*4+3]=d/2,f=Math.max(f,d/2);for(var v=0;v<d;++v){var p=h[v];i.push(+p)}}for(;i.length%4!=0;)i.push(0);return{array:new Float32Array(i),maxEdgePerVetex:f}},Lse=function(e,t,n,i){var a=[],o=[],s={},u=0;for(u=0;u<e.length;u++){var l=e[u];s[l.id]=u,a.push(l.x),a.push(l.y),a.push(0),a.push(0),o.push([])}for(u=0;u<t.length;u++){var f=t[u];o[s[f.source]].push(s[f.target]),o[s[f.source]].push(n(f)),o[s[f.source]].push(i(f)),o[s[f.source]].push(0),o[s[f.target]].push(s[f.source]),o[s[f.target]].push(n(f)),o[s[f.target]].push(i(f)),o[s[f.target]].push(0)}var c=0;for(u=0;u<e.length;u++){var h=a.length,d=o[u],v=d.length;a[u*4+2]=h+1048576*v/4,a[u*4+3]=0,c=Math.max(c,v/4);for(var p=0;p<v;++p){var g=d[p];a.push(+g)}}for(;a.length%4!=0;)a.push(0);return{array:new Float32Array(a),maxEdgePerVetex:c}},Ose=function(e,t){var n=[],i=e.length,a={};return t.forEach(function(o){e.forEach(function(s,u){if(a[o[s]]===void 0&&(a[o[s]]=Object.keys(a).length),n.push(a[o[s]]),u===i-1)for(;n.length%4!=0;)n.push(0)})}),{array:new Float32Array(n),count:Object.keys(a).length}},Rse=function(e){for(var t=[],n=e.length,i=e[0].length,a=function(u){e.forEach(function(l,f){if(t.push(l[u]),f===n-1)for(;t.length%4!=0;)t.push(0)})},o=0;o<i;o++)a(o);return new Float32Array(t)},Bse=function(e,t){var n=["V","TB","BT"],i={x:1/0,y:1/0},a={x:-1/0,y:-1/0},o="x",s="y";t&&n.indexOf(t)>=0&&(s="x",o="y");var u=0;NP(e,function(c){return u++,c.x>a.x&&(a.x=c.x),c.x<i.x&&(i.x=c.x),c.y>a.y&&(a.y=c.y),c.y<i.y&&(i.y=c.y),!0});var l=Math.PI*2/u,f=a[s]-i[s];return f===0||NP(e,function(c){var h=(c[s]-i[s])/f*(Math.PI*2-l)+l,d=Math.abs(o==="x"?c.x-e.x:c.y-e.y);return c.x=d*Math.cos(h),c.y=d*Math.sin(h),!0}),e},Gse=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",proccessToFunc:Dse,buildTextureData:Pse,buildTextureDataWithOneEdgeAttr:Nse,buildTextureDataWithTwoEdgeAttr:Lse,attributesToTextureData:Ose,arrayToTextureData:Rse,radialLayout:Bse}),LP=function r(){return typeof window=="undefined"||typeof document=="undefined"?{}:{canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var e=document.createElement("canvas");return!!(window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl")))}catch(t){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var t=document.createElement("div");return t.id="webgl-error-message",t.style.fontFamily="monospace",t.style.fontSize="13px",t.style.fontWeight="normal",t.style.textAlign="center",t.style.background="#fff",t.style.color="#000",t.style.padding="1.5em",t.style.width="400px",t.style.margin="5em auto 0",this.webgl||(t.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" rel="external nofollow" rel="external nofollow" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" rel="external nofollow" rel="external nofollow" style="color:#000">here</a>.'].join(`
`):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" rel="external nofollow" rel="external nofollow" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" rel="external nofollow" rel="external nofollow" style="color:#000">here</a>.'].join(`
`)),t},addGetWebGLMessage:function(t){t=t||{};var n=t.parent!==void 0?t.parent:document.body,i=t.id!==void 0?t.id:"oldie",a=r().getWebGLErrorMessage();a.id=i,n.appendChild(a)}}},Fse=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",gpuDetector:LP}),oo=L(L(L(L({},ta),O6),Gse),Fse),Use=oo.radialLayout,zse=function(){function r(e){this.type=e.type,this.radial=e.radial,this.config=e}return r.prototype.init=function(e){var t=this;if(this.data=e,this.radial){this.layoutMethod=function(n){var i=kv[t.type](n,t.config);return Use(i),i};return}this.layoutMethod=function(n){return kv[t.type](n,t.config)}},r.prototype.execute=function(){return this.layoutMethod(this.data,this.config)},r.prototype.layout=function(e){return this.init(e),this.execute()},r}();ai("grid",W6);ai("random",j6);ai("force",A8);ai("circular",P8);ai("dagre",uJ);ai("radial",VJ);ai("concentric",WJ);ai("mds",jJ);ai("fruchterman",HJ);ai("fruchterman-gpu",zoe);ai("gForce",X6);ai("gForce-gpu",Woe);ai("comboForce",joe);ai("forceAtlas2",Xoe);var $se=function(e,t){t.isCustomLayout=!0,ai(e,t)},Vse=function(){function r(e,t){var n=e.toString(),i=new Blob(["importScripts('"+t+"');("+n+")()"],{type:"text/javascript"});return new Worker(URL.createObjectURL(i))}return r}(),Wse=function(e){e===void 0&&(e="https://unpkg.com/@antv/layout@latest/dist/layout.min.js");function t(){var i={RUN:"LAYOUT_RUN",END:"LAYOUT_END",ERROR:"LAYOUT_ERROR",TICK:"LAYOUT_TICK",GPURUN:"GPU_LAYOUT_RUN",GPUEND:"GPU_LAYOUT_END"};layout.registerLayout("grid",layout.GridLayout),layout.registerLayout("random",layout.RandomLayout),layout.registerLayout("force",layout.ForceLayout),layout.registerLayout("circular",layout.CircularLayout),layout.registerLayout("dagre",layout.DagreLayout),layout.registerLayout("radial",layout.RadialLayout),layout.registerLayout("concentric",layout.ConcentricLayout),layout.registerLayout("mds",layout.MDSLayout),layout.registerLayout("fruchterman",layout.FruchtermanLayout),layout.registerLayout("fruchterman-gpu",layout.FruchtermanGPULayout),layout.registerLayout("gForce",layout.GForceLayout),layout.registerLayout("gForce-gpu",layout.GForceGPULayout),layout.registerLayout("comboForce",layout.ComboForceLayout),layout.registerLayout("forceAtlas2",layout.ForceAtlas2Layout);function a(s){var u=s.data.type;return u===i.RUN||u===i.GPURUN}function o(s){var u=this,l=s.data.type;switch(l){case i.RUN:{var f=s.data,c=f.nodes,h=f.edges,d=f.layoutCfg,v=d===void 0?{}:d,p=v.type,g=layout.getLayoutByName(p);if(!g){this.postMessage({type:i.ERROR,message:"layout "+p+" not found"});break}var y;v.onLayoutEnd=function(){u.postMessage({type:i.END,nodes:c}),y==null||y.destroy()},y=new g(v),y.init({nodes:c,edges:h}),y.execute();break}case i.GPURUN:{var m=s.data,b=m.nodes,h=m.edges,x=m.layoutCfg,v=x===void 0?{}:x,_=m.canvas,p=v.type,g=layout.getLayoutByName(p);if(!g){this.postMessage({type:i.ERROR,message:"layout "+p+" not found"});break}if(p.split("-")[1]!=="gpu"){this.postMessage({type:i.ERROR,message:"layout "+p+" does not support GPU"});break}var S=new g(v);S.init({nodes:b,edges:h}),S.executeWithWorker(_,this);break}}}onmessage=function(u){a(u)&&o(u)}}var n=new Vse(t,e);return n},dl={RUN:"LAYOUT_RUN",END:"LAYOUT_END",ERROR:"LAYOUT_ERROR",TICK:"LAYOUT_TICK",GPURUN:"GPU_LAYOUT_RUN",GPUEND:"GPU_LAYOUT_END"};function Dv(r){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Dv=function(t){return typeof t}:Dv=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dv(r)}var OP=function(e){return setTimeout(e,16)},RP=function(e){return clearTimeout(e)},Pv={requestAnimationFrame:function(e){var t=typeof window!="undefined"&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame)||OP;return t(e)},cancelAnimationFrame:function(e){var t=typeof window!="undefined"&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame)||RP;return t(e)}},jse=["fruchterman","gForce"],Xse=["force","grid","circular"],Hse=function(r){$t(e,r);function e(t){var n=r.call(this,t)||this;return n.graph=t,n.layoutCfg=t.get("layout")||{},n.layoutType=n.getLayoutType(),n.worker=null,n.workerData={},n.initLayout(),n}return e.prototype.initLayout=function(){},e.prototype.getWorker=function(){return this.worker?this.worker:(typeof Worker=="undefined"?(console.warn("Web worker is not supported in current browser."),this.worker=null):this.worker=Wse(this.layoutCfg.workerScriptURL),this.worker)},e.prototype.stopWorker=function(){var t=this.workerData;!this.worker||(this.worker.terminate(),this.worker=null,t.requestId&&(Pv.cancelAnimationFrame(t.requestId),t.requestId=null),t.requestId2&&(Pv.cancelAnimationFrame(t.requestId2),t.requestId2=null))},e.prototype.execLayoutMethod=function(t,n){var i=this;return new Promise(function(a,o){return ma(i,void 0,void 0,function(){var s,u,l,f,c,h,d,v,c,p;return ba(this,function(g){switch(g.label){case 0:if(s=this.graph,s.get("destroyed"))return[2];u=t.type,t.onLayoutEnd=function(){s.emit("aftersublayout",{type:u}),a()},u&&this.isGPU&&(this.hasGPUVersion(u)?u=u+"-gpu":console.warn("The '"+u+"' layout does not support GPU calculation for now, it will run in CPU.")),l=u==="force"||u==="g6force"||u==="gForce",l?(f=t.onTick,c=function(){f&&f(),s.refreshPositions()},t.tick=c):t.type==="comboForce"&&(t.comboTrees=s.get("comboTrees")),h=!1;try{d=new _0[u](t)}catch(y){console.warn("The layout method: '"+u+"' does not exist! Please specify it first."),o()}return h=d.enableTick,h&&(v=t.onTick,c=function(){v&&v(),s.refreshPositions()},d.tick=c),p=this.filterLayoutData(this.data,t),Kse(p,n),d.init(p),s.emit("beforesublayout",{type:u}),[4,d.execute()];case 1:return g.sent(),d.isCustomLayout&&t.onLayoutEnd&&t.onLayoutEnd(),this.layoutMethods[n]=d,[2]}})})})},e.prototype.updateLayoutMethod=function(t,n){var i=this;return new Promise(function(a,o){return ma(i,void 0,void 0,function(){var s,u,l;return ba(this,function(f){switch(f.label){case 0:return s=this.graph,u=n==null?void 0:n.type,n.onLayoutEnd=function(){s.emit("aftersublayout",{type:u}),a()},l=this.filterLayoutData(this.data,n),t.init(l),t.updateCfg(n),s.emit("beforesublayout",{type:u}),[4,t.execute()];case 1:return f.sent(),t.isCustomLayout&&n.onLayoutEnd&&n.onLayoutEnd(),[2]}})})})},e.prototype.layout=function(t){var n=this,i=this.graph;this.data=this.setDataFromGraph();var a=this.data,o=a.nodes,s=a.hiddenNodes;if(!o)return!1;var u=i.get("width"),l=i.get("height"),f={};Object.assign(f,{width:u,height:l,center:[u/2,l/2]},this.layoutCfg),this.layoutCfg=f,this.destoryLayoutMethods(),i.emit("beforelayout"),this.initPositions(f.center,o),this.initPositions(f.center,s);var c=f.type;c&&c.split("-")[1]==="gpu"&&(c=c.split("-")[0],f.gpuEnabled=!0);var h=!1;f.gpuEnabled&&(h=!0,LP().webgl||(console.warn("Your browser does not support webGL or GPGPU. The layout will run in CPU."),h=!1)),this.isGPU=h;var d=f.onLayoutEnd,v=f.layoutEndFormatted,p=f.adjust;if(v||(f.layoutEndFormatted=!0,f.onAllLayoutEnd=function(){return ma(n,void 0,void 0,function(){return ba(this,function(y){switch(y.label){case 0:return d&&d(),this.refreshLayout(),p&&f.pipes?[4,this.adjustPipesBox(this.data,p)]:[3,2];case 1:y.sent(),this.refreshLayout(),y.label=2;case 2:return i.emit("afterlayout"),[2]}})})}),this.stopWorker(),f.workerEnabled&&this.layoutWithWorker(this.data))return!0;var g=Promise.resolve();return f.type?g=g.then(function(){return ma(n,void 0,void 0,function(){return ba(this,function(y){switch(y.label){case 0:return[4,this.execLayoutMethod(f,0)];case 1:return[2,y.sent()]}})})}):f.pipes&&f.pipes.forEach(function(y,m){g=g.then(function(){return ma(n,void 0,void 0,function(){return ba(this,function(b){switch(b.label){case 0:return[4,this.execLayoutMethod(y,m)];case 1:return[2,b.sent()]}})})})}),g.then(function(){f.onAllLayoutEnd&&f.onAllLayoutEnd(),t&&t()}).catch(function(y){console.warn("graph layout failed,",y)}),!1},e.prototype.layoutWithWorker=function(t){var n=this,i=this,a=i.layoutCfg,o=i.graph,s=this.getWorker(),u=this.workerData;if(!s)return!1;u.requestId=null,u.requestId2=null,u.currentTick=null,u.currentTickData=null,o.emit("beforelayout");var l=Promise.resolve();if(a.type)l=l.then(function(){return n.runWebworker(s,t,a)});else if(a.pipes)for(var f=function(p){l=l.then(function(){return n.runWebworker(s,t,p)})},c=0,h=a.pipes;c<h.length;c++){var d=h[c];f(d)}return l.then(function(){a.onAllLayoutEnd&&a.onAllLayoutEnd()}).catch(function(v){console.error("layout failed",v)}),!0},e.prototype.runWebworker=function(t,n,i){var a=this,o=this.isGPU,s=this.filterLayoutData(n,i),u=s.nodes,l=s.edges,f=document.createElement("canvas"),c=o&&typeof window!="undefined"&&window.navigator&&!navigator.gpu&&"OffscreenCanvas"in window&&"transferControlToOffscreen"in f,h=Yse(i,function(v){return typeof v!="function"});if(!c)t.postMessage({type:dl.RUN,nodes:u,edges:l,layoutCfg:h});else{var d=f.transferControlToOffscreen();h.type=h.type+"-gpu",t.postMessage({type:dl.GPURUN,nodes:u,edges:l,layoutCfg:h,canvas:d},[d])}return new Promise(function(v,p){t.onmessage=function(g){a.handleWorkerMessage(v,p,g,s,i)}})},e.prototype.handleWorkerMessage=function(t,n,i,a,o){var s=this,u=s.graph,l=s.workerData,f=i.data,c=f.type,h=function(){o.onTick&&o.onTick()};switch(c){case dl.TICK:l.currentTick=f.currentTick,l.currentTickData=f,l.requestId||(l.requestId=Pv.requestAnimationFrame(function(){C0(a,f),u.refreshPositions(),h(),f.currentTick===f.totalTicks?t():l.currentTick===f.totalTicks&&(l.requestId2=Pv.requestAnimationFrame(function(){C0(a,l.currentTickData),u.refreshPositions(),l.requestId2=null,h(),t()})),l.requestId=null}));break;case dl.END:l.currentTick==null&&(C0(a,f),t());break;case dl.GPUEND:l.currentTick==null&&(qse(a,f),t());break;case dl.ERROR:console.warn("Web-Worker layout error!",f.message),n();break;default:n();break}},e.prototype.updateLayoutCfg=function(t){var n=this,i=this,a=i.graph,o=i.layoutMethods,s=St({},this.layoutCfg,t);if(this.layoutCfg=s,!(o==null?void 0:o.length)){this.layout();return}if(this.data=this.setDataFromGraph(),this.stopWorker(),!(t.workerEnabled&&this.layoutWithWorker(this.data))){a.emit("beforelayout");var u=Promise.resolve();o.length===1?u=u.then(function(){return ma(n,void 0,void 0,function(){return ba(this,function(l){switch(l.label){case 0:return[4,this.updateLayoutMethod(o[0],s)];case 1:return[2,l.sent()]}})})}):o==null||o.forEach(function(l,f){var c=s.pipes[f];u=u.then(function(){return ma(n,void 0,void 0,function(){return ba(this,function(h){switch(h.label){case 0:return[4,this.updateLayoutMethod(l,c)];case 1:return[2,h.sent()]}})})})}),u.then(function(){s.onAllLayoutEnd&&s.onAllLayoutEnd()}).catch(function(l){console.warn("layout failed",l)})}},e.prototype.adjustPipesBox=function(t,n){var i=this;return new Promise(function(a){var o=t.nodes;(o==null?void 0:o.length)||a(),Xse.includes(n)||(console.warn("The adjust type "+n+" is not supported yet, please assign it with 'force', 'grid', or 'circular'."),a());var s={center:i.layoutCfg.center,nodeSize:function(v){return Math.max(v.height,v.width)},preventOverlap:!0,onLayoutEnd:function(){}},u=i.getLayoutBBox(o),l=u.groupNodes,f=u.layoutNodes,c=Cr(f);s.onLayoutEnd=function(){f==null||f.forEach(function(d,v){var p,g,y,m=d.x-((p=c[v])===null||p===void 0?void 0:p.x),b=d.y-((g=c[v])===null||g===void 0?void 0:g.y);(y=l[v])===null||y===void 0||y.forEach(function(x){x.x+=m,x.y+=b})}),a()};var h=new _0[n](s);h.layout({nodes:f})})},e.prototype.hasGPUVersion=function(t){return jse.includes(t)},e.prototype.destroy=function(){this.destoryLayoutMethods();var t=this.worker;t&&(t.terminate(),this.worker=null),this.destroyed=!0,this.graph.set("layout",void 0),this.layoutCfg=void 0,this.layoutType=void 0,this.layoutMethods=void 0,this.graph=null},e}(AU);function C0(r,e){for(var t=r.nodes,n=e.nodes,i=t.length,a=0;a<i;a++){var o=t[a];o.x=n[a].x,o.y=n[a].y}}function Yse(r,e){var t={};return r&&Dv(r)==="object"?(Object.keys(r).forEach(function(n){r.hasOwnProperty(n)&&e(r[n])&&(t[n]=r[n])}),t):r}function qse(r,e){for(var t=r.nodes,n=e.vertexEdgeData,i=t.length,a=0;a<i;a++){var o=t[a],s=n[4*a],u=n[4*a+1];o.x=s,o.y=u}}function Kse(r,e){var t;if(!!((t=r==null?void 0:r.nodes)===null||t===void 0?void 0:t.length)){var n=r.nodes;n.forEach(function(i){i.layoutOrder=e})}}var BP=Yh,Zse="svg",GP=function(r){$t(e,r);function e(t){var n=r.call(this,t)||this,i=n.get("defaultNode");return i||n.set("defaultNode",{type:"circle"}),i.type||(i.type="circle",n.set("defaultNode",i)),n.destroyed=!1,n}return e.prototype.initLayoutController=function(){var t=new Hse(this);this.set({layoutController:t})},e.prototype.initEventController=function(){var t=new z6(this);this.set({eventController:t})},e.prototype.initCanvas=function(){var t=this.get("container");if(typeof t=="string"&&(t=document.getElementById(t),this.set("container",t)),!t)throw new Error("invalid container");var n=t.clientWidth,i=t.clientHeight,a=this.get("width")||n,o=this.get("height")||i;!this.get("width")&&!this.get("height")&&(this.set("width",n),this.set("height",i));var s=this.get("renderer"),u;if(s===Zse)u=new Ef({container:t,width:a,height:o});else{var l={container:t,width:a,height:o},f=this.get("pixelRatio");f&&(l.pixelRatio=f),u=new Ao(l)}this.set("canvas",u)},e.prototype.initPlugins=function(){var t=this;xe(t.get("plugins"),function(n){!n.destroyed&&n.initPlugin&&n.initPlugin(t)})},e.prototype.downloadImageWatermark=function(t,n,i,a){return ma(this,void 0,void 0,function(){var o,s,u;return ba(this,function(l){switch(l.label){case 0:return o=t.style.backgroundImage,s=o.slice(5,o.length-2),u=new Image,u.src=s,[4,new Promise(function(f){u.onload=function(){var c=n.createPattern(u,"repeat");n.rect(0,0,i,a),n.fillStyle=c,n.fill(),f("")}})];case 1:return l.sent(),[2]}})})},e.prototype.asyncToDataUrl=function(t,n,i,a,o,s){var u=this,l=document.querySelector(".g6-graph-watermarker"),f=this.get("canvas"),c=f.getRenderer(),h=s||f.get("el"),d="";t||(t="image/png"),setTimeout(function(){return ma(u,void 0,void 0,function(){var v,p,g,y,m,b,x,_,S,E;return ba(this,function(C){switch(C.label){case 0:return c!=="svg"?[3,1]:(v=h.cloneNode(!0),p=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),g=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",p),g.replaceChild(v,g.documentElement),y=new XMLSerializer().serializeToString(g),d="data:image/svg+xml;charset=utf8,"+encodeURIComponent(y),[3,4]);case 1:return m=void 0,b=h.getContext("2d"),x=a||this.get("width"),_=o||this.get("height"),S=void 0,l?[4,this.downloadImageWatermark(l,b,x,_)]:[3,3];case 2:C.sent(),C.label=3;case 3:if(n){E=typeof window!="undefined"?window.devicePixelRatio:1;try{m=b.getImageData(0,0,x*E,_*E),S=b.globalCompositeOperation,b.globalCompositeOperation="destination-over",b.fillStyle=n,b.fillRect(0,0,x,_)}catch(M){console.error("Download image failed. Out of memory at ImageData creation")}}d=h.toDataURL(t),n&&(b.clearRect(0,0,x,_),b.putImageData(m,0,0),b.globalCompositeOperation=S),C.label=4;case 4:return i&&i(d),[2]}})})},16)},e.prototype.toDataURL=function(t,n){var i=this.get("canvas"),a=i.getRenderer(),o=i.get("el");t||(t="image/png");var s="";if(a==="svg"){var u=o.cloneNode(!0),l=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),f=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",l);f.replaceChild(u,f.documentElement);var c=new XMLSerializer().serializeToString(f);s="data:image/svg+xml;charset=utf8,"+encodeURIComponent(c)}else{var h=void 0,d=o.getContext("2d"),v=this.get("width"),p=this.get("height"),g=void 0;if(n){var y=typeof window!="undefined"?window.devicePixelRatio:1;try{h=d.getImageData(0,0,v*y,p*y),g=d.globalCompositeOperation,d.globalCompositeOperation="destination-over",d.fillStyle=n,d.fillRect(0,0,v,p)}catch(m){console.error("Download image failed. Out of memory at ImageData creation")}}s=o.toDataURL(t),n&&(d.clearRect(0,0,v,p),d.putImageData(h,0,0),d.globalCompositeOperation=g)}return s},e.prototype.toFullDataURL=function(t,n,i){var a=this.get("group").getCanvasBBox(),o=a.height,s=a.width,u=this.get("renderer"),l=yn('<id="virtual-image"></div>'),f=i?i.backgroundColor:void 0,c=i?i.padding:void 0;c?Lt(c)&&(c=[c,c,c,c]):c=[0,0,0,0];var h=o+c[0]+c[2],d=s+c[1]+c[3],v={container:l,height:h,width:d,quickHit:!0},p=u==="svg"?new Ef(v):new Ao(v),g=this.get("group"),y=g.clone(),m=Cr(y.getMatrix());m||(m=[1,0,0,0,1,0,0,0,1]);var b=(a.maxX+a.minX)/2,x=(a.maxY+a.minY)/2;m=BP(m,[["t",-b,-x],["t",s/2+c[3],o/2+c[0]]]),y.resetMatrix(),y.setMatrix(m),p.add(y);var _=p.get("el"),S="";n||(n="image/png"),setTimeout(function(){if(u==="svg"){var E=_.cloneNode(!0),C=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),M=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",C);M.replaceChild(E,M.documentElement);var w=new XMLSerializer().serializeToString(M);S="data:image/svg+xml;charset=utf8,"+encodeURIComponent(w)}else{var T=void 0,I=_.getContext("2d"),k=void 0;if(f){var O=typeof window!="undefined"?window.devicePixelRatio:1;try{T=I.getImageData(0,0,d*O,h*O),k=I.globalCompositeOperation,I.globalCompositeOperation="destination-over",I.fillStyle=f,I.fillRect(0,0,d,h)}catch(U){console.error("Download image failed. Out of memory at ImageData creation")}}S=_.toDataURL(n),f&&(I.clearRect(0,0,d,h),I.putImageData(T,0,0),I.globalCompositeOperation=k)}t&&t(S)},16)},e.prototype.downloadFullImage=function(t,n,i){var a=this,o=this.get("group").getCanvasBBox(),s=o.height,u=o.width,l=this.get("renderer"),f=yn('<id="virtual-image"></div>'),c=document.querySelector(".g6-graph-watermarker"),h=i?i.backgroundColor:void 0,d=i?i.padding:void 0;d?Lt(d)&&(d=[d,d,d,d]):d=[0,0,0,0];var v=s+d[0]+d[2],p=u+d[1]+d[3];if(c){var g=this.get("graphWaterMarker").cfg||{},y=g.width,m=g.height;v=Math.ceil(v/m)*m,p=Math.ceil(p/y)*y}var b={container:f,height:v,width:p},x=l==="svg"?new Ef(b):new Ao(b),_=this.get("group"),S=_.clone(),E=Cr(S.getMatrix());E||(E=[1,0,0,0,1,0,0,0,1]);var C=(o.maxX+o.minX)/2,M=(o.maxY+o.minY)/2;E=BP(E,[["t",-C,-M],["t",u/2+d[3],s/2+d[0]]]),S.resetMatrix(),S.setMatrix(E),x.add(S);var w=x.get("el");n||(n="image/png"),this.asyncToDataUrl(n,h,function(T){var I=document.createElement("a"),k=(t||"graph")+(l==="svg"?".svg":"."+n.split("/")[1]);a.dataURLToImage(T,l,I,k);var O=document.createEvent("MouseEvents");O.initEvent("click",!1,!1),I.dispatchEvent(O)},p,v,w)},e.prototype.downloadImage=function(t,n,i){var a=this,o=this;o.isAnimating()&&o.stopAnimate();var s=o.get("canvas"),u=s.getRenderer();n||(n="image/png");var l=(t||"graph")+(u==="svg"?".svg":n.split("/")[1]),f=document.createElement("a");o.asyncToDataUrl(n,i,function(c){a.dataURLToImage(c,u,f,l);var h=document.createEvent("MouseEvents");h.initEvent("click",!1,!1),f.dispatchEvent(h)})},e.prototype.dataURLToImage=function(t,n,i,a){if(!t||t==="data:"){console.error("Download image failed. The graph is too large or there is invalid attribute values in graph items");return}if(typeof window!="undefined")if(window.Blob&&window.URL&&n!=="svg"){var o=t.split(","),s="";if(o&&o.length>0){var u=o[0].match(/:(.*?);/);u&&u.length>=2&&(s=u[1])}for(var l=atob(o[1]),f=l.length,c=new Uint8Array(f);f--;)c[f]=l.charCodeAt(f);var h=new Blob([c],{type:s});window.navigator.msSaveBlob?window.navigator.msSaveBlob(h,a):i.addEventListener("click",function(){i.download=a,i.href=window.URL.createObjectURL(h)})}else i.addEventListener("click",function(){i.download=a,i.href=t})},e.prototype.addPlugin=function(t){var n=this;t.destroyed||(n.get("plugins").push(t),t.initPlugin(n))},e.prototype.removePlugin=function(t){var n=this.get("plugins"),i=n.indexOf(t);i>=0&&(t.destroyPlugin(),n.splice(i,1))},e.prototype.setImageWaterMarker=function(t,n){t===void 0&&(t=Ts.waterMarkerImage);var i=this.get("container");Xe(i)&&(i=document.getElementById(i)),i.style.position||(i.style.position="relative");var a=this.get("graphWaterMarker"),o=Hr({},Ts.imageWaterMarkerConfig,n),s=o.width,u=o.height,l=o.compatible,f=o.image;if(!a){var c={container:i,width:s,height:u,capture:!1},h=this.get("pixelRatio");h&&(c.pixelRatio=h),a=new Ao(c),this.set("graphWaterMarker",a)}a.get("el").style.display="none";var d=a.get("context"),v=f.rotate,p=f.x,g=f.y;d.rotate(-v*Math.PI/180);var y=new Image;y.crossOrigin="anonymous",y.src=t,y.onload=function(){if(d.drawImage(y,p,g,f.width,f.height),d.rotate(v*Math.PI/180),l)i.style.cssText="background-image: url("+a.get("el").toDataURL("image/png")+");background-repeat:repeat;";else{var m=document.querySelector(".g6-graph-watermarker");m||(m=document.createElement("div"),m.className="g6-graph-watermarker"),m.className="g6-graph-watermarker",a.destroyed||(m.style.cssText="background-image: url("+a.get("el").toDataURL("image/png")+");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:-1;",i.appendChild(m))}}},e.prototype.setTextWaterMarker=function(t,n){var i=this.get("container");Xe(i)&&(i=document.getElementById(i)),i.style.position||(i.style.position="relative");var a=this.get("graphWaterMarker"),o=Hr({},Ts.textWaterMarkerConfig,n),s=o.width,u=o.height,l=o.compatible,f=o.text;if(!a){var c={container:i,width:s,height:u,capture:!1},h=this.get("pixelRatio");h&&(c.pixelRatio=h),a=new Ao(c),this.set("graphWaterMarker",a)}a.get("el").style.display="none";var d=a.get("context"),v=f.rotate,p=f.fill,g=f.fontFamily,y=f.fontSize,m=f.baseline,b=f.x,x=f.y,_=f.lineHeight;d.rotate(-v*Math.PI/180),d.font=y+"px "+g,d.fillStyle=p,d.textBaseline=m;for(var S=t.length-1;S>=0;S--)d.fillText(t[S],b,x+S*_);if(d.rotate(v*Math.PI/180),l)i.style.cssText="background-image: url("+a.get("el").toDataURL("image/png")+");background-repeat:repeat;";else{var E=document.querySelector(".g6-graph-watermarker");E||(E=document.createElement("div"),E.className="g6-graph-watermarker"),E.style.cssText="background-image: url("+a.get("el").toDataURL("image/png")+");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:99;",i.appendChild(E)}},e.prototype.destroy=function(){var t,n,i,a;xe(this.get("plugins"),function(f){f.destroyPlugin()});var o=this.get("tooltips");if(o)for(var s=0;s<o.length;s++){var u=o[s];if(!!u){var l=u.parentElement;!l||l.removeChild(u)}}(t=this.get("eventController"))===null||t===void 0||t.destroy(),(n=this.get("layoutController"))===null||n===void 0||n.destroy(),(i=this.get("graphWaterMarker"))===null||i===void 0||i.destroy(),(a=document.querySelector(".g6-graph-watermarker"))===null||a===void 0||a.remove(),r.prototype.destroy.call(this)},e}(cU),Qse=oo.radialLayout,Jse=oo.traverseTree,eue=function(r){$t(e,r);function e(t){var n=r.call(this,t)||this;return n.layoutAnimating=!1,n.set("removeList",[]),n.set("layoutMethod",n.getLayout()),n}return e.prototype.getLayout=function(){var t=this.get("layout");return t?typeof t=="function"?t:(t.type||(t.type="dendrogram"),t.direction||(t.direction="TB"),t.radial?function(n){var i=kv[t.type](n,t);return Qse(i),i}:function(n){return kv[t.type](n,t)}):null},e.indexOfChild=function(t,n){var i=-1;return xe(t,function(a,o){if(n===a.id)return i=o,!1}),i},e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return t.animate=!0,t},e.prototype.innerAddChild=function(t,n,i){var a=this,o=t.data;o&&(o.x=t.x,o.y=t.y,o.depth=t.depth);var s=a.addItem("node",o,!1);if(n){if(s.set("parent",n),i){var u=n.get("originAttrs");if(u)s.set("originAttrs",u);else{var l=n.getModel();s.set("originAttrs",{x:l.x,y:l.y})}}var f=n.get("children");f?f.push(s):n.set("children",[s]),a.addItem("edge",{source:n.get("id"),target:s.get("id"),id:n.get("id")+":"+s.get("id")},!1)}return xe(t.children||[],function(c){a.innerAddChild(c,s,i)}),a.emit("afteraddchild",{item:s,parent:n}),s},e.prototype.innerUpdateChild=function(t,n,i){var a=this,o=a.findById(t.id);if(!o){a.innerAddChild(t,n,i);return}xe(t.children||[],function(v){a.innerUpdateChild(v,o,i)});var s=o.get("children");if(s){var u=s.length;if(u>0)for(var l=s.length-1;l>=0;l--){var f=s[l].getModel();e.indexOfChild(t.children||[],f.id)===-1&&(a.innerRemoveChild(f.id,{x:t.x,y:t.y},i),s.splice(l,1))}}var c,h;o.get("originAttrs")&&(c=o.get("originAttrs").x,h=o.get("originAttrs").y);var d=o.getModel();i&&o.set("originAttrs",{x:d.x,y:d.y}),o.set("model",t.data),(c!==t.x||h!==t.y)&&o.updatePosition({x:t.x,y:t.y})},e.prototype.innerRemoveChild=function(t,n,i){var a=this,o=a.findById(t);if(!!o)if(xe(o.get("children"),function(u){a.innerRemoveChild(u.getModel().id,n,i)}),i){var s=o.getModel();o.set("to",n),o.set("originAttrs",{x:s.x,y:s.y}),a.get("removeList").push(o)}else a.removeItem(o,!1)},e.prototype.changeData=function(t){var n=this;this.getNodes().map(function(i){return n.clearItemStates(i)}),this.getEdges().map(function(i){return n.clearItemStates(i)}),t?(n.data(t),n.render()):n.layout(this.get("fitView"))},e.prototype.changeLayout=function(t){console.warn("Please call updateLayout instead of changeLayout. changeLayout will be discarded soon");var n=this;n.updateLayout(t)},e.prototype.updateLayout=function(t){var n=this;if(!t){console.warn("layout cannot be null");return}n.set("layout",t),n.set("layoutMethod",n.getLayout()),n.layout()},e.prototype.refreshLayout=function(t){console.warn("Please call layout instead of refreshLayout. refreshLayout will be discarded soon");var n=this;n.layout(t)},e.prototype.layout=function(t){var n=this,i=n.get("data"),a=n.get("layoutMethod"),o=a?a(i,n.get("layout")):i,s=n.get("animate");if(n.emit("beforerefreshlayout",{data:i,layoutData:o}),n.emit("beforelayout"),n.innerUpdateChild(o,void 0,s),t){var u=n.get("viewController");u.fitView()}s?n.layoutAnimate(o):(n.refresh(),n.paint()),n.emit("afterrefreshlayout",{data:i,layoutData:o}),n.emit("afterlayout")},e.prototype.addChild=function(t,n){var i=this;i.emit("beforeaddchild",{model:t,parent:n}),Xe(n)||(n=n.get("id"));var a=i.findDataById(n);a&&(a.children||(a.children=[]),a.children.push(t),i.changeData())},e.prototype.updateChildren=function(t,n){var i=this;if(!n||!i.findById(n)){console.warn("Update children failed! There is no node with id '"+n+"'");return}var a=i.findDataById(n);a.children=t,i.changeData()},e.prototype.updateChild=function(t,n){var i=this;if(!n||!i.findById(n)){i.changeData(t);return}var a=i.findDataById(n),o=i.findById(t.id);if(a.children||(a.children=[]),!o)a.children.push(t);else{var s=e.indexOfChild(a.children,t.id);a.children[s]=t}i.changeData()},e.prototype.removeChild=function(t){var n=this,i=n.findById(t);if(!!i){var a=i.get("parent");if(a&&!a.destroyed){var o=n.findDataById(a.get("id")),s=o&&o.children||[],u=i.getModel(),l=e.indexOfChild(s,u.id);s.splice(l,1)}n.changeData()}},e.prototype.findDataById=function(t,n){var i=this;if(n||(n=i.get("data")),t===n.id)return n;var a=null;return xe(n.children||[],function(o){if(o.id===t)return a=o,!1;if(a=i.findDataById(t,o),a)return!1}),a},e.prototype.layoutAnimate=function(t,n){var i=this,a=this.get("animateCfg");i.emit("beforeanimate",{data:t}),i.getEdges().forEach(function(o){var s=o.get("model");s.sourceAnchor||(s.sourceAnchor=o.get("sourceAnchorIndex"))}),this.get("canvas").animate(function(o){Jse(t,function(s){var u=i.findById(s.id);if(u){var l=u.get("originAttrs"),f=u.get("model");if(l||(l={x:f.x,y:f.y},u.set("originAttrs",l)),n){var c=n(u,o,l,t);u.set("model",Object.assign(f,c))}else f.x=l.x+(s.x-l.x)*o,f.y=l.y+(s.y-l.y)*o}return!0}),xe(i.get("removeList"),function(s){var u=s.getModel(),l=s.get("originAttrs"),f=s.get("to");u.x=l.x+(f.x-l.x)*o,u.y=l.y+(f.y-l.y)*o}),i.refreshPositions()},{duration:a.duration,easing:a.ease,callback:function(){xe(i.getNodes(),function(s){s.set("originAttrs",null)}),xe(i.get("removeList"),function(s){i.removeItem(s)}),i.set("removeList",[]),a.callback&&a.callback(),i.emit("afteranimate",{data:t})},delay:a.delay})},e.prototype.stopLayoutAnimate=function(){this.get("canvas").stopAnimate(),this.emit("layoutanimateend",{data:this.get("data")}),this.layoutAnimating=!1},e.prototype.isLayoutAnimating=function(){return this.layoutAnimating},e.prototype.render=function(){var t=this,n=t.get("data");if(!n||!ri(n)||!Object.keys(n).length)throw new Error("data must be defined first");t.clear(),t.emit("beforerender"),t.layout(this.get("fitView")),t.emit("afterrender")},e.prototype.save=function(){return this.get("data")},e}(GP),tue=function(){function r(e){this._cfgs=Hr(this.getDefaultCfgs(),e),this._events={},this.destroyed=!1}return r.prototype.getDefaultCfgs=function(){return{}},r.prototype.initPlugin=function(e){var t=this;t.set("graph",e);var n=t.getEvents(),i={};xe(n,function(a,o){var s=wu(t,a);i[o]=s,e.on(o,s)}),this._events=i,this.init()},r.prototype.getEvents=function(){return{}},r.prototype.get=function(e){var t;return(t=this._cfgs)===null||t===void 0?void 0:t[e]},r.prototype.set=function(e,t){this._cfgs[e]=t},r.prototype.destroy=function(){},r.prototype.destroyPlugin=function(){this.destroy();var e=this.get("graph"),t=this._events;xe(t,function(n,i){e.off(i,n)}),this._events=null,this._cfgs=null,this.destroyed=!0},r}(),Pi=tue,rue=function(){var r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=a[o])},r(t,n)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),FP="url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHBhdGggZD0iTSAwIDEwIEwgNDAgMTAgTSAxMCAwIEwgMTAgNDAgTSAwIDIwIEwgNDAgMjAgTSAyMCAwIEwgMjAgNDAgTSAwIDMwIEwgNDAgMzAgTSAzMCAwIEwgMzAgNDAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2UwZTBlMCIgb3BhY2l0eT0iMC4yIiBzdHJva2Utd2lkdGg9IjEiLz48cGF0aCBkPSJNIDQwIDAgTCAwIDAgMCA0MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZTBlMGUwIiBzdHJva2Utd2lkdGg9IjEiLz48L3BhdHRlcm4+PC9kZWZzPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JpZCkiLz48L3N2Zz4=)",nue=function(r){rue(e,r);function e(t){return r.call(this,t)||this}return e.prototype.getDefaultCfgs=function(){return{img:FP,follow:!0}},e.prototype.init=function(){var t=this.get("graph"),n=t.get("container"),i=t.get("canvas").get("el"),a=this.get("img")||FP,o=yn(`<div class='g6-grid-container' style="position:absolute;overflow:hidden;z-index: -1;"></div>`),s=yn(`<div
        class='g6-grid'
        style='position:absolute;
        background-image: `+a+`;
        user-select: none
        '></div>`);this.set("container",o),this.set("gridContainer",s),this.positionInit(),o.appendChild(s),n.insertBefore(o,i)},e.prototype.positionInit=function(){var t=this.get("graph"),n=t.get("minZoom"),i=t.get("width"),a=t.get("height");Lr(this.get("container"),{width:i+"px",height:a+"px"});var o=i*80/n,s=a*80/n;Lr(this.get("gridContainer"),{width:o+"px",height:s+"px",left:"-"+o/2+"px",top:"-"+s/2+"px"})},e.prototype.getEvents=function(){return{viewportchange:"updateGrid"}},e.prototype.updateGrid=function(t){var n=this.get("gridContainer"),i=t.matrix;i||(i=[1,0,0,0,1,0,0,0,1]);var a=this.get("follow"),o="matrix("+i[0]+", "+i[1]+", "+i[3]+", "+i[4]+", "+(a?i[6]:"0")+", "+(a?i[7]:"0")+")";Lr(n,{transform:o})},e.prototype.getContainer=function(){return this.get("container")},e.prototype.destroy=function(){var t=this.get("graph"),n=t.get("container"),i=this.get("container");n.removeChild(i)},e}(Pi),iue=nue,UP=[],hc=[],aue="insert-css: You need to provide a CSS string. Usage: insertCss(cssString[, options]).";function zP(r,e){if(e=e||{},r===void 0)throw new Error(aue);var t=e.prepend===!0?"prepend":"append",n=e.container!==void 0?e.container:document.querySelector("head"),i=UP.indexOf(n);i===-1&&(i=UP.push(n)-1,hc[i]={});var a;return hc[i]!==void 0&&hc[i][t]!==void 0?a=hc[i][t]:(a=hc[i][t]=oue(),t==="prepend"?n.insertBefore(a,n.childNodes[0]):n.appendChild(a)),r.charCodeAt(0)===65279&&(r=r.substr(1,r.length)),a.styleSheet?a.styleSheet.cssText+=r:a.textContent+=r,a}function oue(){var r=document.createElement("style");return r.setAttribute("type","text/css"),r}var Nv=zP,sue=zP;Nv.insertCss=sue;var uue=function(){var r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=a[o])},r(t,n)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();typeof document!="undefined"&&Nv(`
  .g6-component-contextmenu {
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    background-color: rgba(255, 255, 255, 0.9);
    padding: 10px 8px;
    box-shadow: rgb(174, 174, 174) 0px 0px 10px;
  }
  .g6-contextmenu-ul {
    padding: 0;
    margin: 0;
    list-style: none;
  }

`);var lue=function(r){uue(e,r);function e(t){return r.call(this,t)||this}return e.prototype.getDefaultCfgs=function(){return{offsetX:6,offsetY:6,handleMenuClick:void 0,getContent:function(n){return`
          <ul class='g6-contextmenu-ul'>
            <li>\u83DC\u5355\u98791</li>
            <li>\u83DC\u5355\u98792</li>
          </ul>
        `},shouldBegin:function(n){return!0},onHide:function(){return!0},itemTypes:["node","edge","combo"],trigger:"contextmenu"}},e.prototype.getEvents=function(){return this.get("trigger")==="click"?{click:"onMenuShow"}:{contextmenu:"onMenuShow"}},e.prototype.init=function(){var t=this.get("className"),n=yn("<div class="+(t||"g6-component-contextmenu")+"></div>");Lr(n,{top:"0px",position:"absolute",visibility:"hidden"});var i=this.get("container");i||(i=this.get("graph").get("container")),Xe(i)&&(i=document.getElementById(i)),i.appendChild(n),this.set("menu",n)},e.prototype.onMenuShow=function(t){var n=this;t.preventDefault();var i=this.get("itemTypes");if(t.item){if(t.item&&t.item.getType&&i.indexOf(t.item.getType())===-1){n.onMenuHide();return}}else if(i.indexOf("canvas")===-1){n.onMenuHide();return}var a=this.get("shouldBegin");if(!!a(t)){var o=this.get("menu"),s=this.get("getContent"),u=this.get("graph"),l=s(t,u);Xe(l)?o.innerHTML=l:o.innerHTML=l.outerHTML,this.removeMenuEventListener();var f=this.get("handleMenuClick");if(f){var c=function(C){f(C.target,t.item,u)};this.set("handleMenuClickWrapper",c),o.addEventListener("click",c)}var h=u.get("width"),d=u.get("height"),v=o.getBoundingClientRect(),p=this.get("offsetX")||0,g=this.get("offsetY")||0,y=u.getContainer().offsetTop,m=u.getContainer().offsetLeft,b=t.canvasX+m+p,x=t.canvasY+y+g;b+v.width>h&&(b=t.canvasX-v.width-p+m),x+v.height>d&&(x=t.canvasY-v.height-g+y),Lr(o,{top:x+"px",left:b+"px",visibility:"visible"});var _=this.get("trigger")==="click",S=function(C){if(_){_=!1;return}n.onMenuHide()};document.body.addEventListener("click",S),this.set("handler",S)}},e.prototype.removeMenuEventListener=function(){var t=this.get("handleMenuClickWrapper"),n=this.get("handler");if(t){var i=this.get("menu");i.removeEventListener("click",t),this.set("handleMenuClickWrapper",null)}n&&document.body.removeEventListener("click",n)},e.prototype.onMenuHide=function(){var t=this.get("menu");t&&Lr(t,{visibility:"hidden"}),this.removeMenuEventListener()},e.prototype.destroy=function(){var t=this.get("menu");if(this.removeMenuEventListener(),t){var n=this.get("container");n||(n=this.get("graph").get("container")),Xe(n)&&(n=document.getElementById(n)),n.removeChild(t)}},e}(Pi),fue=lue,cue=function(){var r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=a[o])},r(t,n)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),A0=function(){return A0=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},A0.apply(this,arguments)},$P=Math.max,hue=Yh,due="default",vue="keyShape",pue="delegate",VP="svg",gue=function(r){cue(e,r);function e(t){var n=r.call(this,t)||this;return n.handleUpdateCanvas=ig(function(i){var a=n;a.destroyed||a.updateCanvas()},100,!1),n}return e.prototype.getDefaultCfgs=function(){return{container:null,className:"g6-minimap",viewportClassName:"g6-minimap-viewport",type:"default",padding:50,size:[200,120],delegateStyle:{fill:"#40a9ff",stroke:"#096dd9"},refresh:!0}},e.prototype.getEvents=function(){return{beforepaint:"updateViewport",beforeanimate:"disableRefresh",afteranimate:"enableRefresh",viewportchange:"disableOneRefresh"}},e.prototype.disableRefresh=function(){this.set("refresh",!1)},e.prototype.enableRefresh=function(){this.set("refresh",!0),this.updateCanvas()},e.prototype.disableOneRefresh=function(){this.set("viewportChange",!0)},e.prototype.initViewport=function(){var t=this,n=this._cfgs,i=n.size,a=n.graph;if(!this.destroyed){var o=this.get("canvas"),s=o.get("container"),u=yn(`
      <div
        class=`+n.viewportClassName+`
        style='position:absolute;
          left:0;
          top:0;
          box-sizing:border-box;
          outline: 2px solid #1980ff'
        draggable=true>
      </div>`),l=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,f=0,c=0,h=!1,d=0,v=0,p=0,g=0,y=0,m=0;u.addEventListener("dragstart",function(b){var x,_;if(b.dataTransfer){var S=new Image;S.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' %3E%3Cpath /%3E%3C/svg%3E",(_=(x=b.dataTransfer).setDragImage)===null||_===void 0||_.call(x,S,0,0);try{b.dataTransfer.setData("text/html","view-port-minimap")}catch(C){b.dataTransfer.setData("text","view-port-minimap")}}if(n.refresh=!1,b.target===u){var E=u.style;d=parseInt(E.left,10),v=parseInt(E.top,10),p=parseInt(E.width,10),g=parseInt(E.height,10),!(p>i[0]||g>i[1])&&(m=a.getZoom(),y=t.get("ratio"),h=!0,f=b.clientX,c=b.clientY)}},!1),u.addEventListener(l?"dragover":"drag",function(b){if(!(!h||yt(b.clientX)||yt(b.clientY))){var x=f-b.clientX,_=c-b.clientY;(d-x<0||d-x+p>=i[0])&&(x=0),(v-_<0||v-_+g>=i[1])&&(_=0),d-=x,v-=_,Lr(u,{left:d+"px",top:v+"px"}),a.translate(x*m/y,_*m/y),f=b.clientX,c=b.clientY}},!1),u.addEventListener("dragend",function(){h=!1,n.refresh=!0},!1),this.set("viewport",u),s.appendChild(u)}},e.prototype.updateViewport=function(){if(!this.destroyed){var t=this.get("ratio");this.get("dx"),this.get("dy");var n=this.get("totaldx"),i=this.get("totaldy"),a=this.get("graph"),o=this.get("size"),s=a.get("width"),u=a.get("height"),l=a.getPointByCanvas(0,0),f=a.getPointByCanvas(s,u),c=this.get("viewport");c||this.initViewport();var h=(f.x-l.x)*t,d=(f.y-l.y)*t,v=l.x*t+n,p=l.y*t+i,g=v+h,y=p+d;v<0&&(h+=v,v=0),g>o[0]&&(h=h-(g-o[0])),p<0&&(d+=p,p=0),y>o[1]&&(d=d-(y-o[1])),this.set("ratio",t);var m=v+"px",b=p+"px";Lr(c,{left:m,top:b,width:h+"px",height:d+"px"})}},e.prototype.updateGraphShapes=function(){var t=this._cfgs.graph,n=this.get("canvas"),i=t.get("group");if(!i.destroyed){var a=i.clone();a.resetMatrix(),n.clear(),n.add(a);var o=t.get("renderer");o===VP&&this.updateVisible(a)}},e.prototype.updateVisible=function(t){var n=this;if(!t.isGroup()&&!t.get("visible"))t.hide();else{var i=t.get("children");if(!i||!i.length)return;i.forEach(function(a){a.get("visible")||a.hide(),n.updateVisible(a)})}},e.prototype.updateKeyShapes=function(){var t=this,n=this._cfgs.graph,i=this.get("canvas"),a=i.get("children")[0]||i.addGroup();xe(n.getEdges(),function(u){t.updateOneEdgeKeyShape(u,a)}),xe(n.getNodes(),function(u){t.updateOneNodeKeyShape(u,a)});var o=n.getCombos();if(o&&o.length){var s=a.find(function(u){return u.get("name")==="comboGroup"})||a.addGroup({name:"comboGroup"});setTimeout(function(){t.destroyed||(xe(o,function(u){t.updateOneComboKeyShape(u,s)}),s==null||s.sort(),s==null||s.toBack(),t.updateCanvas())},250)}this.clearDestroyedShapes()},e.prototype.updateOneComboKeyShape=function(t,n){if(!this.destroyed){var i=this.get("itemMap")||{},a=i[t.get("id")],o=t.getBBox(),s=t.get("keyShape").clone(),u=s.attr(),l={x:o.centerX,y:o.centerY};a?l=Object.assign(u,l):(a=s,n.add(a));var f=a.get("type");(f==="rect"||f==="image")&&(l.x=o.minX,l.y=o.minY),a.attr(l),t.isVisible()?a.show():a.hide(),a.exist=!0;var c=t.getModel().depth;isNaN(c)||a.set("zIndex",c),i[t.get("id")]=a,this.set("itemMap",i)}},e.prototype.updateOneNodeKeyShape=function(t,n){var i=this.get("itemMap")||{},a=i[t.get("id")],o=t.getBBox(),s=t.get("keyShape").clone(),u=s.attr(),l={x:o.centerX,y:o.centerY};a?l=Object.assign(u,l):(a=s,n.add(a));var f=a.get("type");(f==="rect"||f==="image")&&(l.x=o.minX,l.y=o.minY),a.attr(l),t.isVisible()?a.show():a.hide(),a.exist=!0;var c=t.getModel().depth;isNaN(c)||a.set("zIndex",c),i[t.get("id")]=a,this.set("itemMap",i)},e.prototype.updateDelegateShapes=function(){var t=this,n=this._cfgs.graph,i=this.get("canvas"),a=i.get("children")[0]||i.addGroup();xe(n.getEdges(),function(u){t.updateOneEdgeKeyShape(u,a)}),xe(n.getNodes(),function(u){t.updateOneNodeDelegateShape(u,a)});var o=n.getCombos();if(o&&o.length){var s=a.find(function(u){return u.get("name")==="comboGroup"})||a.addGroup({name:"comboGroup"});setTimeout(function(){t.destroyed||(xe(o,function(u){t.updateOneComboKeyShape(u,s)}),s==null||s.sort(),s==null||s.toBack(),t.updateCanvas())},250)}this.clearDestroyedShapes()},e.prototype.clearDestroyedShapes=function(){var t=this.get("itemMap")||{},n=Object.keys(t);if(!(!n||n.length===0))for(var i=n.length-1;i>=0;i--){var a=t[n[i]],o=a.exist;a.exist=!1,o||(a.remove(),delete t[n[i]])}},e.prototype.updateOneEdgeKeyShape=function(t,n){var i=this.get("itemMap")||{},a=i[t.get("id")];if(a){var o=t.get("keyShape").attr("path");a.attr("path",o)}else a=t.get("keyShape").clone(),n.add(a);t.isVisible()?a.show():a.hide(),a.exist=!0,i[t.get("id")]=a,this.set("itemMap",i)},e.prototype.updateOneNodeDelegateShape=function(t,n){var i=this.get("delegateStyle"),a=this.get("itemMap")||{},o=a[t.get("id")],s=t.getBBox();if(o){var u={x:s.minX,y:s.minY,width:s.width,height:s.height};o.attr(u)}else o=n.addShape("rect",{attrs:A0({x:s.minX,y:s.minY,width:s.width,height:s.height},i),name:"minimap-node-shape"});t.isVisible()?o.show():o.hide(),o.exist=!0,a[t.get("id")]=o,this.set("itemMap",a)},e.prototype.init=function(){this.initContainer(),this.get("graph").on("afterupdateitem",this.handleUpdateCanvas),this.get("graph").on("afteritemstatechange",this.handleUpdateCanvas),this.get("graph").on("afteradditem",this.handleUpdateCanvas),this.get("graph").on("afterremoveitem",this.handleUpdateCanvas),this.get("graph").on("afterrender",this.handleUpdateCanvas),this.get("graph").on("afterlayout",this.handleUpdateCanvas)},e.prototype.initContainer=function(){var t=this,n=t.get("graph"),i=t.get("size"),a=t.get("className"),o=t.get("container"),s=yn("<div class='"+a+"' style='width: "+i[0]+"px; height: "+i[1]+"px; overflow: hidden'></div>");Xe(o)&&(o=document.getElementById(o)),o?o.appendChild(s):n.get("container").appendChild(s),t.set("container",s);var u=yn('<div class="g6-minimap-container" style="position: relative;"></div>');s.appendChild(u),u.addEventListener("dragenter",function(c){c.preventDefault()}),u.addEventListener("dragover",function(c){c.preventDefault()});var l,f=n.get("renderer");f===VP?l=new Ef({container:u,width:i[0],height:i[1]}):l=new Ao({container:u,width:i[0],height:i[1]}),t.set("canvas",l),t.updateCanvas()},e.prototype.updateCanvas=function(){if(!this.destroyed){var t=this.get("refresh");if(!!t){var n=this.get("graph");if(!n.get("destroyed")){this.get("viewportChange")&&(this.set("viewportChange",!1),this.updateViewport());var i=this.get("size"),a=this.get("canvas"),o=this.get("type"),s=this.get("padding");if(!a.destroyed){switch(o){case due:this.updateGraphShapes();break;case vue:this.updateKeyShapes();break;case pue:this.updateDelegateShapes();break}var u=a.get("children")[0];if(!!u){u.resetMatrix();var l=u.getCanvasBBox(),f=n.get("canvas").getCanvasBBox(),c=n.getZoom()||1,h=f.width/c,d=f.height/c;Number.isFinite(l.width)&&(h=$P(l.width,h),d=$P(l.height,d)),h+=2*s,d+=2*s;var v=Math.min(i[0]/h,i[1]/d),p=[1,0,0,0,1,0,0,0,1],g=0,y=0;Number.isFinite(l.minX)&&(g=-l.minX),Number.isFinite(l.minY)&&(y=-l.minY);var m=(i[0]-(h-2*s)*v)/2,b=(i[1]-(d-2*s)*v)/2;p=hue(p,[["t",g,y],["s",v,v],["t",m,b]]),u.setMatrix(p),this.set("ratio",v),this.set("totaldx",m+g*v),this.set("totaldy",b+y*v),this.set("dx",m),this.set("dy",b),this.updateViewport()}}}}}},e.prototype.getCanvas=function(){return this.get("canvas")},e.prototype.getViewport=function(){return this.get("viewport")},e.prototype.getContainer=function(){return this.get("container")},e.prototype.destroy=function(){this.get("canvas").destroy();var t=this.get("container");t.parentNode.removeChild(t)},e}(Pi),yue=gue,mue=function(){var r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=a[o])},r(t,n)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function Oa(r,e,t){var n=r.x-e.x,i=r.y-e.y;return!t||Math.abs(n)>t||Math.abs(i)>t?Math.sqrt(n*n+i*i):t}function bue(r,e){return r.x*e.x+r.y*e.y}function WP(r,e){var t=(e.source.y-e.target.y)/(e.source.x-e.target.x),n=(t*t*e.source.x+t*(r.y-e.source.y)+r.x)/(t*t+1),i=t*(n-e.source.x)+e.source.y;return{x:n,y:i}}var xue=function(r){mue(e,r);function e(t){return r.call(this,t)||this}return e.prototype.getDefaultCfgs=function(){return{edgeBundles:[],edgePoints:[],K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:.6666667,bundleThreshold:.6,eps:1e-6,onLayoutEnd:function(){},onTick:function(){}}},e.prototype.init=function(){var t=this.get("graph"),n=this.get("onTick"),i=function(){n&&n(),t.refreshPositions()};this.set("tick",i)},e.prototype.bundling=function(t){var n=this;if(n.set("data",t),!n.isTicking()){var i=t.edges||[],a=t.nodes||[],o={},s=!1;if(a.forEach(function(x){(x.x===null||!x.y===null||x.x===void 0||!x.y===void 0)&&(s=!0),o[x.id]=x}),s)throw new Error("please layout the graph or assign x and y for nodes first");n.set("nodeIdMap",o);var u=n.get("divisions"),l=n.get("divRate"),f=n.divideEdges(u);n.set("edgePoints",f);var c=n.getEdgeBundles();n.set("edgeBundles",c);for(var h=n.get("cycles"),d=n.get("iterations"),v=n.get("iterRate"),p=n.get("lambda"),g=0;g<h;g++){for(var y=function(_){var S=[];i.forEach(function(E,C){if(E.source!==E.target){var M=o[E.source],w=o[E.target];S[C]=n.getEdgeForces({source:M,target:w},C,u,p);for(var T=0;T<u+1;T++)f[C][T].x+=S[C][T].x,f[C][T].y+=S[C][T].y}})},m=0;m<d;m++)y(m);p=p/2,u*=l,d*=v,f=n.divideEdges(u),n.set("edgePoints",f)}i.forEach(function(x,_){x.source!==x.target&&(x.type="polyline",x.controlPoints=f[_].slice(1,f[_].length-1))});var b=n.get("graph");b.refresh()}},e.prototype.updateBundling=function(t){var n=this,i=t.data;if(i&&n.set("data",i),n.get("ticking")&&n.set("ticking",!1),Object.keys(t).forEach(function(o){n.set(o,t[o])}),t.onTick){var a=this.get("graph");n.set("tick",function(){t.onTick(),a.refresh()})}n.bundling(i)},e.prototype.divideEdges=function(t){var n=this,i=n.get("data").edges,a=n.get("nodeIdMap"),o=n.get("edgePoints");return(!o||o===void 0)&&(o=[]),i.forEach(function(s,u){(!o[u]||o[u]===void 0)&&(o[u]=[]);var l=a[s.source],f=a[s.target];if(t===1)o[u].push({x:l.x,y:l.y}),o[u].push({x:.5*(l.x+f.x),y:.5*(l.y+f.y)}),o[u].push({x:f.x,y:f.y});else{var c=0;!o[u]||o[u]===[]?c=Oa({x:l.x,y:l.y},{x:f.x,y:f.y}):c=n.getEdgeLength(o[u]);var h=c/(t+1),d=h,v=[{x:l.x,y:l.y}];o[u].forEach(function(p,g){if(g!==0){for(var y=Oa(p,o[u][g-1]);y>d;){var m=d/y,b={x:o[u][g-1].x,y:o[u][g-1].y};b.x+=m*(p.x-o[u][g-1].x),b.y+=m*(p.y-o[u][g-1].y),v.push(b),y-=d,d=h}d-=y}}),v.push({x:f.x,y:f.y}),o[u]=v}}),o},e.prototype.getEdgeLength=function(t){var n=0;return t.forEach(function(i,a){a!==0&&(n+=Oa(i,t[a-1]))}),n},e.prototype.getEdgeBundles=function(){var t=this,n=t.get("data"),i=n.edges||[],a=t.get("bundleThreshold"),o=t.get("nodeIdMap"),s=t.get("edgeBundles");return s||(s=[]),i.forEach(function(u,l){(!s[l]||s[l]===void 0)&&(s[l]=[])}),i.forEach(function(u,l){var f=o[u.source],c=o[u.target];i.forEach(function(h,d){if(!(d<=l)){var v=o[h.source],p=o[h.target],g=t.getBundleScore({source:f,target:c},{source:v,target:p});g>=a&&(s[l].push(d),s[d].push(l))}})}),s},e.prototype.getBundleScore=function(t,n){var i=this;t.vx=t.target.x-t.source.x,t.vy=t.target.y-t.source.y,n.vx=n.target.x-n.source.x,n.vy=n.target.y-n.source.y,t.length=Oa({x:t.source.x,y:t.source.y},{x:t.target.x,y:t.target.y}),n.length=Oa({x:n.source.x,y:n.source.y},{x:n.target.x,y:n.target.y});var a=i.getAngleScore(t,n),o=i.getScaleScore(t,n),s=i.getPositionScore(t,n),u=i.getVisibilityScore(t,n);return a*o*s*u},e.prototype.getAngleScore=function(t,n){var i=bue({x:t.vx,y:t.vy},{x:n.vx,y:n.vy});return i/(t.length*n.length)},e.prototype.getScaleScore=function(t,n){var i=(t.length+n.length)/2,a=2/(i/Math.min(t.length,n.length)+Math.max(t.length,n.length)/i);return a},e.prototype.getPositionScore=function(t,n){var i=(t.length+n.length)/2,a={x:(t.source.x+t.target.x)/2,y:(t.source.y+t.target.y)/2},o={x:(n.source.x+n.target.x)/2,y:(n.source.y+n.target.y)/2},s=Oa(a,o);return i/(i+s)},e.prototype.getVisibilityScore=function(t,n){var i=this.getEdgeVisibility(t,n),a=this.getEdgeVisibility(n,t);return i<a?i:a},e.prototype.getEdgeVisibility=function(t,n){var i=WP(n.source,t),a=WP(n.target,t),o={x:(i.x+a.x)/2,y:(i.y+a.y)/2},s={x:(t.source.x+t.target.x)/2,y:(t.source.y+t.target.y)/2};return Math.max(0,1-2*Oa(o,s)/Oa(i,a))},e.prototype.getEdgeForces=function(t,n,i,a){for(var o=this,s=o.get("edgePoints"),u=o.get("K"),l=u/(Oa(t.source,t.target)*(i+1)),f=[{x:0,y:0}],c=1;c<i;c++){var h={x:0,y:0},d=o.getSpringForce({pre:s[n][c-1],cur:s[n][c],next:s[n][c+1]},l),v=o.getElectrostaticForce(c,n);h.x=a*(d.x+v.x),h.y=a*(d.y+v.y),f.push(h)}return f.push({x:0,y:0}),f},e.prototype.getSpringForce=function(t,n){var i=t.pre.x+t.next.x-2*t.cur.x,a=t.pre.y+t.next.y-2*t.cur.y;return i*=n,a*=n,{x:i,y:a}},e.prototype.getElectrostaticForce=function(t,n){var i=this,a=i.get("eps"),o=i.get("edgeBundles"),s=i.get("edgePoints"),u=o[n],l={x:0,y:0};return u.forEach(function(f){var c={x:s[f][t].x-s[n][t].x,y:s[f][t].y-s[n][t].y};if(Math.abs(c.x)>a||Math.abs(c.y)>a){var h=Oa(s[f][t],s[n][t]),d=1/h;l.x+=c.x*d,l.y+=c.y*d}}),l},e.prototype.isTicking=function(){return this.get("ticking")},e.prototype.getSimulation=function(){return this.get("forceSimulation")},e.prototype.destroy=function(){this.get("ticking")&&this.getSimulation().stop(),r.prototype.destroy.call(this)},e}(Pi),_ue=xue,wue=function(){var r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=a[o])},r(t,n)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),T0=function(){return T0=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},T0.apply(this,arguments)},Lv=.05,jP={stroke:"#000",strokeOpacity:.8,lineWidth:2,fillOpacity:.1,fill:"#ccc"},Sue=function(r){wue(e,r);function e(t){return r.call(this,t)||this}return e.prototype.getDefaultCfgs=function(){return{trigger:"mousemove",d:1.5,r:300,delegateStyle:Cr(jP),showLabel:!1,maxD:5,minD:0,scaleRBy:"unset",scaleDBy:"unset",showDPercent:!0}},e.prototype.getEvents=function(){var t;switch(this.get("trigger")){case"click":t={click:"magnify"};break;case"drag":t={click:"createDelegate"};break;default:t={mousemove:"magnify"};break}return t},e.prototype.init=function(){var t=this,n=t.get("r");t.set("cachedMagnifiedModels",[]),t.set("cachedOriginPositions",{}),t.set("r2",n*n);var i=t.get("d");t.set("molecularParam",(i+1)*n)},e.prototype.createDelegate=function(t){var n=this,i=this,a=i.get("delegate");(!a||a.destroyed)&&(i.magnify(t),a=i.get("delegate"),a.on("dragstart",function(o){i.set("delegateCenterDiff",{x:a.attr("x")-o.x,y:a.attr("y")-o.y})}),a.on("drag",function(o){i.magnify(o)}),this.get("scaleDBy")==="wheel"&&a.on("mousewheel",function(o){n.scaleDByWheel(o)}),this.get("scaleRBy")==="wheel"&&a.on("mousewheel",function(o){i.scaleRByWheel(o)}))},e.prototype.scaleRByWheel=function(t){var n=this;if(!(!t||!t.originalEvent)){t.preventDefault&&t.preventDefault();var i=n.get("graph"),a,o=n.get("delegate"),s=o?{x:o.attr("x"),y:o.attr("y")}:void 0,u=s||i.getPointByClient(t.clientX,t.clientY);t.originalEvent.wheelDelta<0?a=1-Lv:a=1/(1-Lv);var l=n.get("maxR"),f=n.get("minR"),c=n.get("r");(c>(l||i.get("height"))&&a>1||c<(f||i.get("height")*.05)&&a<1)&&(a=1),c*=a,n.set("r",c),n.set("r2",c*c);var h=n.get("d");n.set("molecularParam",(h+1)*c),n.set("delegateCenterDiff",void 0),n.magnify(t,u)}},e.prototype.scaleRByDrag=function(t){var n=this;if(!!t){var i=n.get("dragPrePos"),a=n.get("graph"),o,s=a.getPointByClient(t.clientX,t.clientY);t.x-i.x<0?o=1-Lv:o=1/(1-Lv);var u=n.get("maxR"),l=n.get("minR"),f=n.get("r");(f>(u||a.get("height"))&&o>1||f<(l||a.get("height")*.05)&&o<1)&&(o=1),f*=o,n.set("r",f),n.set("r2",f*f);var c=n.get("d");n.set("molecularParam",(c+1)*f),n.magnify(t,s),n.set("dragPrePos",{x:t.x,y:t.y})}},e.prototype.scaleDByWheel=function(t){var n=this;if(!(!t&&!t.originalEvent)){t.preventDefault&&t.preventDefault();var i=0;t.originalEvent.wheelDelta<0?i=-.1:i=.1;var a=n.get("d"),o=a+i,s=n.get("maxD"),u=n.get("minD");if(o<s&&o>u){n.set("d",o);var l=n.get("r");n.set("molecularParam",(o+1)*l);var f=n.get("delegate"),c=f?{x:f.attr("x"),y:f.attr("y")}:void 0;n.set("delegateCenterDiff",void 0),n.magnify(t,c)}}},e.prototype.scaleDByDrag=function(t){var n=this,i=n.get("dragPrePos"),a=t.x-i.x>0?.1:-.1,o=n.get("d"),s=o+a,u=n.get("maxD"),l=n.get("minD");if(s<u&&s>l){n.set("d",s);var f=n.get("r");n.set("molecularParam",(s+1)*f),n.magnify(t)}n.set("dragPrePos",{x:t.x,y:t.y})},e.prototype.magnify=function(t,n){var i=this;i.restoreCache();var a=i.get("graph"),o=i.get("cachedMagnifiedModels"),s=i.get("cachedOriginPositions"),u=i.get("showLabel"),l=i.get("r"),f=i.get("r2"),c=i.get("d"),h=i.get("molecularParam"),d=a.getNodes(),v=d.length,p=n?{x:n.x,y:n.y}:{x:t.x,y:t.y};i.get("dragging")&&(i.get("trigger")==="mousemove"||i.get("trigger")==="click")&&(p=i.get("cacheCenter"));var g=i.get("delegateCenterDiff");g&&(p.x+=g.x,p.y+=g.y),i.updateDelegate(p,l);for(var y=0;y<v;y++){var m=d[y].getModel(),b=m.x,x=m.y;if(!(isNaN(b)||isNaN(x))){var _=(b-p.x)*(b-p.x)+(x-p.y)*(x-p.y);if(!isNaN(_)&&_<f&&_!==0){var S=Math.sqrt(_),E=h*S/(c*S+l),C=(b-p.x)/S,M=(x-p.y)/S;if(m.x=C*E+p.x,m.y=M*E+p.y,s[m.id]||(s[m.id]={x:b,y:x,texts:[]}),o.push(m),u&&2*S<l)for(var w=d[y],T=w.getContainer(),I=T.getChildren(),k=I.length,O=0;O<k;O++){var U=I[O];U.get("type")==="text"&&(s[m.id].texts.push({visible:U.get("visible"),shape:U}),U.set("visible",!0))}}}}a.refreshPositions()},e.prototype.restoreCache=function(){for(var t=this,n=t.get("cachedMagnifiedModels"),i=t.get("cachedOriginPositions"),a=n.length,o=0;o<a;o++){var s=n[o],u=s.id,l=i[u];s.x=l.x,s.y=l.y;for(var f=l.texts.length,c=0;c<f;c++){var h=l.texts[c];h.shape.set("visible",h.visible)}}t.set("cachedMagnifiedModels",[]),t.set("cachedOriginPositions",{})},e.prototype.updateParams=function(t){var n=this,i=t.r,a=t.d,o=t.trigger,s=t.minD,u=t.maxD,l=t.minR,f=t.maxR,c=t.scaleDBy,h=t.scaleRBy;isNaN(t.r)||(n.set("r",i),n.set("r2",i*i)),isNaN(a)||n.set("d",a),isNaN(u)||n.set("maxD",u),isNaN(s)||n.set("minD",s),isNaN(f)||n.set("maxR",f),isNaN(l)||n.set("minR",l);var d=n.get("d"),v=n.get("r");if(n.set("molecularParam",(d+1)*v),(o==="mousemove"||o==="click"||o==="drag")&&n.set("trigger",o),c==="drag"||c==="wheel"||c==="unset"){n.set("scaleDBy",c),n.get("delegate").remove(),n.get("delegate").destroy();var p=n.get("dPercentText");p&&(p.remove(),p.destroy())}if(h==="drag"||h==="wheel"||h==="unset"){n.set("scaleRBy",h),n.get("delegate").remove(),n.get("delegate").destroy();var p=n.get("dPercentText");p&&(p.remove(),p.destroy())}},e.prototype.updateDelegate=function(t,n){var i=this,a=this,o=a.get("graph"),s=a.get("delegate");if(!s||s.destroyed){var u=o.get("group"),l=a.get("delegateStyle")||jP;s=u.addShape("circle",{attrs:T0({r:n/1.5,x:t.x,y:t.y},l),name:"lens-shape",draggable:!0}),this.get("trigger")!=="drag"&&(this.get("scaleRBy")==="wheel"?s.on("mousewheel",function(v){a.scaleRByWheel(v)}):this.get("scaleRBy")==="drag"&&(s.on("dragstart",function(v){a.set("dragging",!0),a.set("cacheCenter",{x:v.x,y:v.y}),a.set("dragPrePos",{x:v.x,y:v.y})}),s.on("drag",function(v){a.scaleRByDrag(v)}),s.on("dragend",function(v){a.set("dragging",!1)})),this.get("scaleDBy")==="wheel"?s.on("mousewheel",function(v){i.scaleDByWheel(v)}):this.get("scaleDBy")==="drag"&&(s.on("dragstart",function(v){a.set("dragging",!0),a.set("cacheCenter",{x:v.x,y:v.y}),a.set("dragPrePos",{x:v.x,y:v.y})}),s.on("drag",function(v){i.scaleDByDrag(v)}),s.on("dragend",function(v){a.set("dragging",!1)})))}else s.attr({x:t.x,y:t.y,r:n/1.5});if(a.get("showDPercent")){var f=Math.round((a.get("d")-a.get("minD"))/(a.get("maxD")-a.get("minD"))*100),c=a.get("dPercentText"),h=t.y+n/1.5+16;if(!c||c.destroyed){var d=o.get("group");c=d.addShape("text",{attrs:{text:f+"%",x:t.x,y:h,fill:"#aaa",stroke:"#fff",lineWidth:1,fontSize:12}}),a.set("dPercentText",c)}else c.attr({text:f+"%",x:t.x,y:h})}a.set("delegate",s)},e.prototype.clear=function(){var t=this.get("graph");this.restoreCache(),t.refreshPositions();var n=this.get("delegate");n&&!n.destroyed&&(n.remove(),n.destroy());var i=this.get("dPercentText");i&&!i.destroyed&&(i.remove(),i.destroy())},e.prototype.destroy=function(){this.clear()},e}(Pi),Eue=Sue,Cue=function(){var r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=a[o])},r(t,n)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),XP=.05;typeof document!="undefined"&&Nv(`
  .g6-component-toolbar {
    position: absolute;
    list-style-type: none;
    padding: 6px;
    left: 0px;
    top: 0px;
    background-color: rgba(255, 255, 255, 0.9);
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    margin: 0;
  }
  .g6-component-toolbar li {
    float: left;
    text-align: center;
    width: 35px;
    height: 24px;
    cursor: pointer;
		list-style-type:none;
    list-style: none;
    margin-left: 0px;
  }
  .g6-component-toolbar li .icon {
    opacity: 0.7;
  }
  .g6-component-toolbar li .icon:hover {
    opacity: 1;
  }
`);var Aue=function(e){if(!e)return[];if(e.composedPath)return e.composedPath();for(var t=[],n=e.target;n;){if(t.push(n),n.tagName==="HTML")return t.push(document,window),t;n=n.parentElement}return t},Tue=function(r){Cue(e,r);function e(t){return r.call(this,t)||this}return e.prototype.getDefaultCfgs=function(){return{handleClick:void 0,getContent:function(n){return`
          <ul class='g6-component-toolbar'>
            <li code='redo'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M256 682.666667c0-102.741333 66.730667-213.333333 213.333333-213.333334 107.008 0 190.762667 56.576 230.570667 125.354667L611.968 682.666667H853.333333v-241.365334l-91.562666 91.562667C704.768 448.469333 601.130667 384 469.333333 384c-196.096 0-298.666667 150.229333-298.666666 298.666667h85.333333z" fill="" p-id="2041"></path>
              </svg>
            </li>
            <li code='undo'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M170.666667 682.666667h241.365333l-87.936-87.978667C363.904 525.909333 447.658667 469.333333 554.666667 469.333333c146.602667 0 213.333333 110.592 213.333333 213.333334h85.333333c0-148.437333-102.570667-298.666667-298.666666-298.666667-131.797333 0-235.392 64.469333-292.48 148.821333L170.666667 441.301333V682.666667z" fill="" p-id="2764"></path>
              </svg>
            </li>
            <li  code='zoomOut'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M658.432 428.736a33.216 33.216 0 0 1-33.152 33.152H525.824v99.456a33.216 33.216 0 0 1-66.304 0V461.888H360.064a33.152 33.152 0 0 1 0-66.304H459.52V296.128a33.152 33.152 0 0 1 66.304 0V395.52H625.28c18.24 0 33.152 14.848 33.152 33.152z m299.776 521.792a43.328 43.328 0 0 1-60.864-6.912l-189.248-220.992a362.368 362.368 0 0 1-215.36 70.848 364.8 364.8 0 1 1 364.8-364.736 363.072 363.072 0 0 1-86.912 235.968l192.384 224.64a43.392 43.392 0 0 1-4.8 61.184z m-465.536-223.36a298.816 298.816 0 0 0 298.432-298.432 298.816 298.816 0 0 0-298.432-298.432A298.816 298.816 0 0 0 194.24 428.8a298.816 298.816 0 0 0 298.432 298.432z"></path>
              </svg>
            </li>
            <li code='zoomIn'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M639.936 416a32 32 0 0 1-32 32h-256a32 32 0 0 1 0-64h256a32 32 0 0 1 32 32z m289.28 503.552a41.792 41.792 0 0 1-58.752-6.656l-182.656-213.248A349.76 349.76 0 0 1 480 768 352 352 0 1 1 832 416a350.4 350.4 0 0 1-83.84 227.712l185.664 216.768a41.856 41.856 0 0 1-4.608 59.072zM479.936 704c158.784 0 288-129.216 288-288S638.72 128 479.936 128a288.32 288.32 0 0 0-288 288c0 158.784 129.216 288 288 288z" p-id="3853"></path>
              </svg>
            </li>
            <li code='realZoom'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="24">
                <path d="M384 320v384H320V320h64z m256 0v384H576V320h64zM512 576v64H448V576h64z m0-192v64H448V384h64z m355.968 576H92.032A28.16 28.16 0 0 1 64 931.968V28.032C64 12.608 76.608 0 95.168 0h610.368L896 192v739.968a28.16 28.16 0 0 1-28.032 28.032zM704 64v128h128l-128-128z m128 192h-190.464V64H128v832h704V256z"></path>
              </svg>
            </li>
            <li code='autoZoom'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="24">
                <path d="M684.288 305.28l0.128-0.64-0.128-0.64V99.712c0-19.84 15.552-35.904 34.496-35.712a35.072 35.072 0 0 1 34.56 35.776v171.008h170.944c19.648 0 35.84 15.488 35.712 34.432a35.072 35.072 0 0 1-35.84 34.496h-204.16l-0.64-0.128a32.768 32.768 0 0 1-20.864-7.552c-1.344-1.024-2.816-1.664-3.968-2.816-0.384-0.32-0.512-0.768-0.832-1.088a33.472 33.472 0 0 1-9.408-22.848zM305.28 64a35.072 35.072 0 0 0-34.56 35.776v171.008H99.776A35.072 35.072 0 0 0 64 305.216c0 18.944 15.872 34.496 35.84 34.496h204.16l0.64-0.128a32.896 32.896 0 0 0 20.864-7.552c1.344-1.024 2.816-1.664 3.904-2.816 0.384-0.32 0.512-0.768 0.768-1.088a33.024 33.024 0 0 0 9.536-22.848l-0.128-0.64 0.128-0.704V99.712A35.008 35.008 0 0 0 305.216 64z m618.944 620.288h-204.16l-0.64 0.128-0.512-0.128c-7.808 0-14.72 3.2-20.48 7.68-1.28 1.024-2.752 1.664-3.84 2.752-0.384 0.32-0.512 0.768-0.832 1.088a33.664 33.664 0 0 0-9.408 22.912l0.128 0.64-0.128 0.704v204.288c0 19.712 15.552 35.904 34.496 35.712a35.072 35.072 0 0 0 34.56-35.776V753.28h170.944c19.648 0 35.84-15.488 35.712-34.432a35.072 35.072 0 0 0-35.84-34.496z m-593.92 11.52c-0.256-0.32-0.384-0.768-0.768-1.088-1.088-1.088-2.56-1.728-3.84-2.688a33.088 33.088 0 0 0-20.48-7.68l-0.512 0.064-0.64-0.128H99.84a35.072 35.072 0 0 0-35.84 34.496 35.072 35.072 0 0 0 35.712 34.432H270.72v171.008c0 19.84 15.552 35.84 34.56 35.776a35.008 35.008 0 0 0 34.432-35.712V720l-0.128-0.64 0.128-0.704a33.344 33.344 0 0 0-9.472-22.848zM512 374.144a137.92 137.92 0 1 0 0.128 275.84A137.92 137.92 0 0 0 512 374.08z"></path>
              </svg>
            </li>
          </ul>
        `},zoomSensitivity:2}},e.prototype.init=function(){var t=this,n=this.get("graph"),i=this.get("getContent"),a=i(n),o=a;Xe(a)&&(o=yn(a));var s=this.get("className");o.setAttribute("class",s||"g6-component-toolbar");var u=this.get("container");u||(u=this.get("graph").get("container")),Xe(u)&&(u=document.getElementById(u)),u.appendChild(o),this.set("toolBar",o);var l=this.get("handleClick");o.addEventListener("click",function(c){var h=Aue(c).filter(function(v){return v.nodeName==="LI"});if(h.length!==0){var d=h[0].getAttribute("code");!d||(l?l(d,n):t.handleDefaultOperator(d,n))}});var f=this.get("position");f&&Lr(o,{top:f.y+"px",left:f.x+"px"}),this.bindUndoRedo()},e.prototype.bindUndoRedo=function(){var t=this.get("graph"),n=document.querySelector('.g6-component-toolbar li[code="undo"]'),i=document.querySelector('.g6-component-toolbar li[code="undo"] svg'),a=document.querySelector('.g6-component-toolbar li[code="redo"]'),o=document.querySelector('.g6-component-toolbar li[code="redo"] svg');!n||!i||!a||!o||t.on("stackchange",function(s){var u=s.undoStack,l=s.redoStack,f=u.length,c=l.length;f===1?(n.setAttribute("style","cursor: not-allowed"),i.setAttribute("style","opacity: 0.4")):(n.removeAttribute("style"),i.removeAttribute("style")),c===0?(a.setAttribute("style","cursor: not-allowed"),o.setAttribute("style","opacity: 0.4")):(a.removeAttribute("style"),o.removeAttribute("style"))})},e.prototype.undo=function(){var t=this.get("graph"),n=t.getUndoStack();if(!(!n||n.length===1)){var i=n.pop();if(i){var a=i.action;t.pushStack(a,Cr(i.data),"redo");var o=i.data.before;if(a==="add"&&(o=i.data.after),!o)return;switch(a){case"visible":{Object.keys(o).forEach(function(s){var u=o[s];!u||u.forEach(function(l){var f=t.findById(l.id);l.visible?t.showItem(f,!1):t.hideItem(f,!1)})});break}case"render":case"update":Object.keys(o).forEach(function(s){var u=o[s];!u||u.forEach(function(l){t.updateItem(l.id,l,!1)})});break;case"changedata":t.changeData(o,!1);break;case"delete":{Object.keys(o).forEach(function(s){var u=o[s];!u||u.forEach(function(l){var f=l.itemType;delete l.itemType,t.addItem(f,l,!1)})});break}case"add":Object.keys(o).forEach(function(s){var u=o[s];!u||u.forEach(function(l){t.removeItem(l.id,!1)})});break;case"updateComboTree":Object.keys(o).forEach(function(s){var u=o[s];!u||u.forEach(function(l){t.updateComboTree(l.id,l.parentId,!1)})});break}}}},e.prototype.redo=function(){var t=this.get("graph"),n=t.getRedoStack();if(!(!n||n.length===0)){var i=n.pop();if(i){var a=i.action,o=i.data.after;if(t.pushStack(a,Cr(i.data)),a==="delete"&&(o=i.data.before),!o)return;switch(a){case"visible":{Object.keys(o).forEach(function(s){var u=o[s];!u||u.forEach(function(l){var f=t.findById(l.id);l.visible?t.showItem(f,!1):t.hideItem(f,!1)})});break}case"render":case"update":Object.keys(o).forEach(function(s){var u=o[s];!u||u.forEach(function(l){t.updateItem(l.id,l,!1)})});break;case"changedata":t.changeData(o,!1);break;case"delete":o.edges&&o.edges.forEach(function(s){t.removeItem(s.id,!1)}),o.nodes&&o.nodes.forEach(function(s){t.removeItem(s.id,!1)}),o.combos&&o.combos.forEach(function(s){t.removeItem(s.id,!1)});break;case"add":{Object.keys(o).forEach(function(s){var u=o[s];!u||u.forEach(function(l){var f=l.itemType;delete l.itemType,t.addItem(f,l,!1)})});break}case"updateComboTree":Object.keys(o).forEach(function(s){var u=o[s];!u||u.forEach(function(l){t.updateComboTree(l.id,l.parentId,!1)})});break}}}},e.prototype.handleDefaultOperator=function(t,n){var i=n.getZoom();switch(t){case"redo":this.redo();break;case"undo":this.undo();break;case"zoomOut":{var a=1/(1-XP*this.get("zoomSensitivity")),o=this.get("maxZoom")||n.get("maxZoom");if(a*i>o)return;n.zoomTo(i*a);break}case"zoomIn":{var s=1-XP*this.get("zoomSensitivity"),u=this.get("minZoom")||n.get("minZoom");if(s*i<u)return;n.zoomTo(i*s);break}case"realZoom":n.zoomTo(1);break;case"autoZoom":n.fitView([20,20]);break}},e.prototype.destroy=function(){var t=this.get("toolBar");if(t){var n=this.get("container");n||(n=this.get("graph").get("container")),Xe(n)&&(n=document.getElementById(n)),n.removeChild(t)}var i=this.get("handleClick");i&&t.removeEventListener("click",i)},e}(Pi),Mue=Tue,Iue=function(){var r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=a[o])},r(t,n)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();typeof document!="undefined"&&Nv(`
  .g6-component-tooltip {
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    background-color: rgba(255, 255, 255, 0.9);
    padding: 10px 8px;
    box-shadow: rgb(174, 174, 174) 0px 0px 10px;
  }
  .tooltip-type {
    padding: 0;
    margin: 0;
  }
  .tooltip-id {
    color: #531dab;
  }
`);var kue=function(r){Iue(e,r);function e(t){return r.call(this,t)||this}return e.prototype.getDefaultCfgs=function(){return{offsetX:6,offsetY:6,getContent:function(n){return`
          <h4 class='tooltip-type'>\u7C7B\u578B\uFF1A`+n.item.getType()+`</h4>
          <span class='tooltip-id'>ID\uFF1A`+n.item.getID()+`</span>
        `},shouldBegin:function(n){return!0},itemTypes:["node","edge","combo"],trigger:"mouseenter",fixToNode:void 0}},e.prototype.getEvents=function(){return this.get("trigger")==="click"?{"node:click":"onClick","edge:click":"onClick","combo:click":"onClick","canvas:click":"onMouseLeave",afterremoveitem:"onMouseLeave",contextmenu:"onMouseLeave",drag:"onMouseLeave"}:{"node:mouseenter":"onMouseEnter","node:mouseleave":"onMouseLeave","node:mousemove":"onMouseMove","edge:mouseenter":"onMouseEnter","edge:mouseleave":"onMouseLeave","edge:mousemove":"onMouseMove","combo:mouseenter":"onMouseEnter","combo:mouseleave":"onMouseLeave","combo:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave",contextmenu:"onMouseLeave","node:drag":"onMouseLeave"}},e.prototype.init=function(){var t=this,n=t.get("className")||"g6-component-tooltip",i=yn("<div class="+n+"></div>"),a=t.get("container");a||(a=t.get("graph").get("container")),Xe(a)&&(a=document.getElementById(a)),Lr(i,{position:"absolute",visibility:"hidden",display:"none"}),a.appendChild(i),t.get("trigger")!=="click"&&(i.addEventListener("mouseenter",function(o){Lr(i,{visibility:"visible",display:"unset"})}),i.addEventListener("mouseleave",function(o){t.hideTooltip()})),t.set("tooltip",i)},e.prototype.onClick=function(t){var n=this.get("itemTypes");if(!(t.item&&t.item.getType&&n.indexOf(t.item.getType())===-1)){var i=t.item,a=this.get("graph");this.currentTarget===i?(this.currentTarget=null,this.hideTooltip(),a.emit("tooltipchange",{item:t.item,action:"hide"})):(this.currentTarget=i,this.showTooltip(t),a.emit("tooltipchange",{item:t.item,action:"show"}))}},e.prototype.onMouseEnter=function(t){var n=this.get("itemTypes");if(!(t.item&&t.item.getType&&n.indexOf(t.item.getType())===-1)){var i=t.item,a=this.get("graph");this.currentTarget=i,this.showTooltip(t),a.emit("tooltipchange",{item:t.item,action:"show"})}},e.prototype.onMouseMove=function(t){var n=this.get("itemTypes");t.item&&t.item.getType&&n.indexOf(t.item.getType())===-1||!this.currentTarget||t.item!==this.currentTarget||this.showTooltip(t)},e.prototype.onMouseLeave=function(){this.hideTooltip();var t=this.get("graph");t.emit("tooltipchange",{item:this.currentTarget,action:"hide"}),this.currentTarget=null},e.prototype.showTooltip=function(t){if(!!t.item){var n=this.get("itemTypes");if(!(t.item.getType&&n.indexOf(t.item.getType())===-1)){var i=this.get("tooltip"),a=this.get("getContent"),o=a(t);Xe(o)?i.innerHTML=o:i.innerHTML=o.outerHTML,this.updatePosition(t)}}},e.prototype.hideTooltip=function(){var t=this.get("tooltip");t&&Lr(t,{visibility:"hidden",display:"none"})},e.prototype.updatePosition=function(t){var n=this.get("shouldBegin"),i=this.get("tooltip");if(!n(t)){Lr(i,{visibility:"hidden",display:"none"});return}var a=this.get("graph"),o=a.get("width"),s=a.get("height"),u=this.get("offsetX")||0,l=this.get("offsetY")||0,f=a.getPointByClient(t.clientX,t.clientY),c=this.get("fixToNode"),h=t.item;if(h.getType&&h.getType()==="node"&&c&&At(c)&&c.length>=2){var d=h.getBBox();f={x:d.minX+d.width*c[0],y:d.minY+d.height*c[1]}}var v=a.getCanvasByPoint(f.x,f.y),p=v.x,g=v.y,y=a.getContainer(),m={x:p+y.offsetLeft+u,y:g+y.offsetTop+l};Lr(i,{visibility:"visible",display:"unset"});var b=i.getBoundingClientRect();p+b.width+u>o&&(m.x-=b.width+u),g+b.height+l>s&&(m.y-=b.height+l),Lr(i,{left:m.x+"px",top:m.y+"px"})},e.prototype.hide=function(){this.onMouseLeave()},e.prototype.destroy=function(){var t=this.get("tooltip");if(t){var n=this.get("container");n||(n=this.get("graph").get("container")),Xe(n)&&(n=document.getElementById(n)),n.removeChild(t)}},e}(Pi),Due=kue,HP={};function Pue(r){return HP[r]}function Ra(r,e){HP[r]=e}var M0=function(){function r(e){this.type="base",this.isCategory=!1,this.isLinear=!1,this.isContinuous=!1,this.isIdentity=!1,this.values=[],this.range=[0,1],this.ticks=[],this.__cfg__=e,this.initCfg(),this.init()}return r.prototype.translate=function(e){return e},r.prototype.change=function(e){St(this.__cfg__,e),this.init()},r.prototype.clone=function(){return this.constructor(this.__cfg__)},r.prototype.getTicks=function(){var e=this;return fs(this.ticks,function(t,n){return ri(t)?t:{text:e.getText(t,n),tickValue:t,value:e.scale(t)}})},r.prototype.getText=function(e,t){var n=this.formatter,i=n?n(e,t):e;return yt(i)||!Kr(i.toString)?"":i.toString()},r.prototype.getConfig=function(e){return this.__cfg__[e]},r.prototype.init=function(){St(this,this.__cfg__),this.setDomain(),vx(this.getConfig("ticks"))&&(this.ticks=this.calculateTicks())},r.prototype.initCfg=function(){},r.prototype.setDomain=function(){},r.prototype.calculateTicks=function(){var e=this.tickMethod,t=[];if(Xe(e)){var n=Pue(e);if(!n)throw new Error("There is no method to to calculate ticks!");t=n(this)}else Kr(e)&&(t=e(this));return t},r.prototype.rangeMin=function(){return this.range[0]},r.prototype.rangeMax=function(){return this.range[1]},r.prototype.calcPercent=function(e,t,n){return Lt(e)?(e-t)/(n-t):NaN},r.prototype.calcValue=function(e,t,n){return t+e*(n-t)},r}(),dc=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="cat",t.isCategory=!0,t}return e.prototype.buildIndexMap=function(){if(!this.translateIndexMap){this.translateIndexMap=new Map;for(var t=0;t<this.values.length;t++)this.translateIndexMap.set(this.values[t],t)}},e.prototype.translate=function(t){this.buildIndexMap();var n=this.translateIndexMap.get(t);return n===void 0&&(n=Lt(t)?t:NaN),n},e.prototype.scale=function(t){var n=this.translate(t),i=this.calcPercent(n,this.min,this.max);return this.calcValue(i,this.rangeMin(),this.rangeMax())},e.prototype.invert=function(t){var n=this.max-this.min,i=this.calcPercent(t,this.rangeMin(),this.rangeMax()),a=Math.round(n*i)+this.min;return a<this.min||a>this.max?NaN:this.values[a]},e.prototype.getText=function(t){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var a=t;return Lt(t)&&!this.values.includes(t)&&(a=this.values[a]),r.prototype.getText.apply(this,Jp([a],n))},e.prototype.initCfg=function(){this.tickMethod="cat"},e.prototype.setDomain=function(){if(yt(this.getConfig("min"))&&(this.min=0),yt(this.getConfig("max"))){var t=this.values.length;this.max=t>1?t-1:t}this.translateIndexMap&&(this.translateIndexMap=void 0)},e}(M0),YP=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,zo="[1-9]\\d?",$o="\\d\\d",Nue="\\d{3}",Lue="\\d{4}",vc="[^\\s]+",qP=/\[([^]*?)\]/gm;function KP(r,e){for(var t=[],n=0,i=r.length;n<i;n++)t.push(r[n].substr(0,e));return t}var ZP=function(r){return function(e,t){var n=t[r].map(function(a){return a.toLowerCase()}),i=n.indexOf(e.toLowerCase());return i>-1?i:null}};function Vo(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var n=0,i=e;n<i.length;n++){var a=i[n];for(var o in a)r[o]=a[o]}return r}var QP=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],JP=["January","February","March","April","May","June","July","August","September","October","November","December"],Oue=KP(JP,3),Rue=KP(QP,3),I0={dayNamesShort:Rue,dayNames:QP,monthNamesShort:Oue,monthNames:JP,amPm:["am","pm"],DoFn:function(r){return r+["th","st","nd","rd"][r%10>3?0:(r-r%10!=10?1:0)*r%10]}},Ov=Vo({},I0),eN=function(r){return Ov=Vo(Ov,r)},tN=function(r){return r.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},Si=function(r,e){for(e===void 0&&(e=2),r=String(r);r.length<e;)r="0"+r;return r},Bue={D:function(r){return String(r.getDate())},DD:function(r){return Si(r.getDate())},Do:function(r,e){return e.DoFn(r.getDate())},d:function(r){return String(r.getDay())},dd:function(r){return Si(r.getDay())},ddd:function(r,e){return e.dayNamesShort[r.getDay()]},dddd:function(r,e){return e.dayNames[r.getDay()]},M:function(r){return String(r.getMonth()+1)},MM:function(r){return Si(r.getMonth()+1)},MMM:function(r,e){return e.monthNamesShort[r.getMonth()]},MMMM:function(r,e){return e.monthNames[r.getMonth()]},YY:function(r){return Si(String(r.getFullYear()),4).substr(2)},YYYY:function(r){return Si(r.getFullYear(),4)},h:function(r){return String(r.getHours()%12||12)},hh:function(r){return Si(r.getHours()%12||12)},H:function(r){return String(r.getHours())},HH:function(r){return Si(r.getHours())},m:function(r){return String(r.getMinutes())},mm:function(r){return Si(r.getMinutes())},s:function(r){return String(r.getSeconds())},ss:function(r){return Si(r.getSeconds())},S:function(r){return String(Math.round(r.getMilliseconds()/100))},SS:function(r){return Si(Math.round(r.getMilliseconds()/10),2)},SSS:function(r){return Si(r.getMilliseconds(),3)},a:function(r,e){return r.getHours()<12?e.amPm[0]:e.amPm[1]},A:function(r,e){return r.getHours()<12?e.amPm[0].toUpperCase():e.amPm[1].toUpperCase()},ZZ:function(r){var e=r.getTimezoneOffset();return(e>0?"-":"+")+Si(Math.floor(Math.abs(e)/60)*100+Math.abs(e)%60,4)},Z:function(r){var e=r.getTimezoneOffset();return(e>0?"-":"+")+Si(Math.floor(Math.abs(e)/60),2)+":"+Si(Math.abs(e)%60,2)}},rN=function(r){return+r-1},nN=[null,zo],iN=[null,vc],aN=["isPm",vc,function(r,e){var t=r.toLowerCase();return t===e.amPm[0]?0:t===e.amPm[1]?1:null}],oN=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(r){var e=(r+"").match(/([+-]|\d\d)/gi);if(e){var t=+e[1]*60+parseInt(e[2],10);return e[0]==="+"?t:-t}return 0}],Gue={D:["day",zo],DD:["day",$o],Do:["day",zo+vc,function(r){return parseInt(r,10)}],M:["month",zo,rN],MM:["month",$o,rN],YY:["year",$o,function(r){var e=new Date,t=+(""+e.getFullYear()).substr(0,2);return+(""+(+r>68?t-1:t)+r)}],h:["hour",zo,void 0,"isPm"],hh:["hour",$o,void 0,"isPm"],H:["hour",zo],HH:["hour",$o],m:["minute",zo],mm:["minute",$o],s:["second",zo],ss:["second",$o],YYYY:["year",Lue],S:["millisecond","\\d",function(r){return+r*100}],SS:["millisecond",$o,function(r){return+r*10}],SSS:["millisecond",Nue],d:nN,dd:nN,ddd:iN,dddd:iN,MMM:["month",vc,ZP("monthNamesShort")],MMMM:["month",vc,ZP("monthNames")],a:aN,A:aN,ZZ:oN,Z:oN},Rv={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},sN=function(r){return Vo(Rv,r)},uN=function(r,e,t){if(e===void 0&&(e=Rv.default),t===void 0&&(t={}),typeof r=="number"&&(r=new Date(r)),Object.prototype.toString.call(r)!=="[object Date]"||isNaN(r.getTime()))throw new Error("Invalid Date pass to format");e=Rv[e]||e;var n=[];e=e.replace(qP,function(a,o){return n.push(o),"@@@"});var i=Vo(Vo({},Ov),t);return e=e.replace(YP,function(a){return Bue[a](r,i)}),e.replace(/@@@/g,function(){return n.shift()})};function lN(r,e,t){if(t===void 0&&(t={}),typeof e!="string")throw new Error("Invalid format in fecha parse");if(e=Rv[e]||e,r.length>1e3)return null;var n=new Date,i={year:n.getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},a=[],o=[],s=e.replace(qP,function(x,_){return o.push(tN(_)),"@@@"}),u={},l={};s=tN(s).replace(YP,function(x){var _=Gue[x],S=_[0],E=_[1],C=_[3];if(u[S])throw new Error("Invalid format. "+S+" specified twice in format");return u[S]=!0,C&&(l[C]=!0),a.push(_),"("+E+")"}),Object.keys(l).forEach(function(x){if(!u[x])throw new Error("Invalid format. "+x+" is required in specified format")}),s=s.replace(/@@@/g,function(){return o.shift()});var f=r.match(new RegExp(s,"i"));if(!f)return null;for(var c=Vo(Vo({},Ov),t),h=1;h<f.length;h++){var d=a[h-1],v=d[0],p=d[2],g=p?p(f[h],c):+f[h];if(g==null)return null;i[v]=g}i.isPm===1&&i.hour!=null&&+i.hour!=12?i.hour=+i.hour+12:i.isPm===0&&+i.hour==12&&(i.hour=0);for(var y=new Date(i.year,i.month,i.day,i.hour,i.minute,i.second,i.millisecond),m=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],h=0,b=m.length;h<b;h++)if(u[m[h][0]]&&i[m[h][0]]!==y[m[h][1]]())return null;return i.timezoneOffset==null?y:new Date(Date.UTC(i.year,i.month,i.day,i.hour,i.minute-i.timezoneOffset,i.second,i.millisecond))}var fN={format:uN,parse:lN,defaultI18n:I0,setGlobalDateI18n:eN,setGlobalDateMasks:sN},Fue=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:fN,assign:Vo,format:uN,parse:lN,defaultI18n:I0,setGlobalDateI18n:eN,setGlobalDateMasks:sN});function Uue(r){return function(e,t,n,i){for(var a=yt(n)?0:n,o=yt(i)?e.length:i;a<o;){var s=a+o>>>1;r(e[s])>t?o=s:a=s+1}return a}}var cN="format";function hN(r,e){var t=Fue[cN]||fN[cN];return t(r,e)}function Bv(r){return Xe(r)&&(r.indexOf("T")>0?r=new Date(r).getTime():r=new Date(r.replace(/-/gi,"/")).getTime()),rg(r)&&(r=r.getTime()),r}var ca=1e3,qs=60*ca,Ks=60*qs,so=24*Ks,pc=so*31,dN=so*365,gc=[["HH:mm:ss",ca],["HH:mm:ss",ca*10],["HH:mm:ss",ca*30],["HH:mm",qs],["HH:mm",qs*10],["HH:mm",qs*30],["HH",Ks],["HH",Ks*6],["HH",Ks*12],["YYYY-MM-DD",so],["YYYY-MM-DD",so*4],["YYYY-WW",so*7],["YYYY-MM",pc],["YYYY-MM",pc*4],["YYYY-MM",pc*6],["YYYY",so*380]];function zue(r,e,t){var n=(e-r)/t,i=Uue(function(o){return o[1]})(gc,n)-1,a=gc[i];return i<0?a=gc[0]:i>=gc.length&&(a=Gi(gc)),a}var $ue=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="timeCat",t}return e.prototype.translate=function(t){t=Bv(t);var n=this.values.indexOf(t);return n===-1&&(Lt(t)&&t<this.values.length?n=t:n=NaN),n},e.prototype.getText=function(t,n){var i=this.translate(t);if(i>-1){var a=this.values[i],o=this.formatter;return a=o?o(a,n):hN(a,this.mask),a}return t},e.prototype.initCfg=function(){this.tickMethod="time-cat",this.mask="YYYY-MM-DD",this.tickCount=7},e.prototype.setDomain=function(){var t=this.values;xe(t,function(n,i){t[i]=Bv(n)}),t.sort(function(n,i){return n-i}),r.prototype.setDomain.call(this)},e}(dc),Gv=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.isContinuous=!0,t}return e.prototype.scale=function(t){if(yt(t))return NaN;var n=this.rangeMin(),i=this.rangeMax(),a=this.max,o=this.min;if(a===o)return n;var s=this.getScalePercent(t);return n+s*(i-n)},e.prototype.init=function(){r.prototype.init.call(this);var t=this.ticks,n=_a(t),i=Gi(t);n<this.min&&(this.min=n),i>this.max&&(this.max=i),yt(this.minLimit)||(this.min=n),yt(this.maxLimit)||(this.max=i)},e.prototype.setDomain=function(){var t=Jb(this.values),n=t.min,i=t.max;yt(this.min)&&(this.min=n),yt(this.max)&&(this.max=i),this.min>this.max&&(this.min=n,this.max=i)},e.prototype.calculateTicks=function(){var t=this,n=r.prototype.calculateTicks.call(this);return this.nice||(n=Ol(n,function(i){return i>=t.min&&i<=t.max})),n},e.prototype.getScalePercent=function(t){var n=this.max,i=this.min;return(t-i)/(n-i)},e.prototype.getInvertPercent=function(t){return(t-this.rangeMin())/(this.rangeMax()-this.rangeMin())},e}(M0),Vue=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="linear",t.isLinear=!0,t}return e.prototype.invert=function(t){var n=this.getInvertPercent(t);return this.min+n*(this.max-this.min)},e.prototype.initCfg=function(){this.tickMethod="wilkinson-extended",this.nice=!1},e}(Gv),yc=Vue;function Wo(r,e){var t=Math.E,n;return e>=0?n=Math.pow(t,Math.log(e)/r):n=Math.pow(t,Math.log(-e)/r)*-1,n}function Hi(r,e){return r===1?1:Math.log(e)/Math.log(r)}function vN(r,e,t){yt(t)&&(t=Math.max.apply(null,r));var n=t;return xe(r,function(i){i>0&&i<n&&(n=i)}),n===t&&(n=t/e),n>1&&(n=1),n}var Wue=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="log",t}return e.prototype.invert=function(t){var n=this.base,i=Hi(n,this.max),a=this.rangeMin(),o=this.rangeMax()-a,s,u=this.positiveMin;if(u){if(t===0)return 0;s=Hi(n,u/n);var l=1/(i-s)*o;if(t<l)return t/l*u}else s=Hi(n,this.min);var f=(t-a)/o,c=f*(i-s)+s;return Math.pow(n,c)},e.prototype.initCfg=function(){this.tickMethod="log",this.base=10,this.tickCount=6,this.nice=!0},e.prototype.setDomain=function(){r.prototype.setDomain.call(this);var t=this.min;if(t<0)throw new Error("When you use log scale, the minimum value must be greater than zero!");t===0&&(this.positiveMin=vN(this.values,this.base,this.max))},e.prototype.getScalePercent=function(t){var n=this.max,i=this.min;if(n===i||t<=0)return 0;var a=this.base,o=this.positiveMin;o&&(i=o*1/a);var s;return t<o?s=t/o/(Hi(a,n)-Hi(a,i)):s=(Hi(a,t)-Hi(a,i))/(Hi(a,n)-Hi(a,i)),s},e}(Gv),jue=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="pow",t}return e.prototype.invert=function(t){var n=this.getInvertPercent(t),i=this.exponent,a=Wo(i,this.max),o=Wo(i,this.min),s=n*(a-o)+o,u=s>=0?1:-1;return Math.pow(s,i)*u},e.prototype.initCfg=function(){this.tickMethod="pow",this.exponent=2,this.tickCount=5,this.nice=!0},e.prototype.getScalePercent=function(t){var n=this.max,i=this.min;if(n===i)return 0;var a=this.exponent,o=(Wo(a,t)-Wo(a,i))/(Wo(a,n)-Wo(a,i));return o},e}(Gv),Xue=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="time",t}return e.prototype.getText=function(t,n){var i=this.translate(t),a=this.formatter;return a?a(i,n):hN(i,this.mask)},e.prototype.scale=function(t){var n=t;return(Xe(n)||rg(n))&&(n=this.translate(n)),r.prototype.scale.call(this,n)},e.prototype.translate=function(t){return Bv(t)},e.prototype.initCfg=function(){this.tickMethod="time-pretty",this.mask="YYYY-MM-DD",this.tickCount=7,this.nice=!1},e.prototype.setDomain=function(){var t=this.values,n=this.getConfig("min"),i=this.getConfig("max");if((!yt(n)||!Lt(n))&&(this.min=this.translate(this.min)),(!yt(i)||!Lt(i))&&(this.max=this.translate(this.max)),t&&t.length){var a=[],o=1/0,s=o,u=0;xe(t,function(l){var f=Bv(l);if(isNaN(f))throw new TypeError("Invalid Time: "+l+" in time scale!");o>f?(s=o,o=f):s>f&&(s=f),u<f&&(u=f),a.push(f)}),t.length>1&&(this.minTickInterval=s-o),yt(n)&&(this.min=o),yt(i)&&(this.max=u)}},e}(yc),pN=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="quantize",t}return e.prototype.invert=function(t){var n=this.ticks,i=n.length,a=this.getInvertPercent(t),o=Math.floor(a*(i-1));if(o>=i-1)return Gi(n);if(o<0)return _a(n);var s=n[o],u=n[o+1],l=o/(i-1),f=(o+1)/(i-1);return s+(a-l)/(f-l)*(u-s)},e.prototype.initCfg=function(){this.tickMethod="r-pretty",this.tickCount=5,this.nice=!0},e.prototype.calculateTicks=function(){var t=r.prototype.calculateTicks.call(this);return this.nice||(Gi(t)!==this.max&&t.push(this.max),_a(t)!==this.min&&t.unshift(this.min)),t},e.prototype.getScalePercent=function(t){var n=this.ticks;if(t<_a(n))return 0;if(t>Gi(n))return 1;var i=0;return xe(n,function(a,o){if(t>=a)i=o;else return!1}),i/(n.length-1)},e}(Gv),Hue=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="quantile",t}return e.prototype.initCfg=function(){this.tickMethod="quantile",this.tickCount=5,this.nice=!0},e}(pN),gN={};function Yue(r){return gN[r]}function Ba(r,e){if(Yue(r))throw new Error("type '"+r+"' existed.");gN[r]=e}var que=function(r){$t(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="identity",t.isIdentity=!0,t}return e.prototype.calculateTicks=function(){return this.values},e.prototype.scale=function(t){return this.values[0]!==t&&Lt(t)?t:this.range[0]},e.prototype.invert=function(t){var n=this.range;return t<n[0]||t>n[1]?NaN:this.values[0]},e}(M0);function yN(r){return Math.abs(r)<1e-15?r:parseFloat(r.toFixed(15))}var Kue=[1,5,2,2.5,4,3],mN=Number.EPSILON*100;function Zue(r,e){return(r%e+e)%e}function Que(r,e,t,n,i,a){var o=ph(e),s=ag(e,r),u=0,l=Zue(n,a);return(l<mN||a-l<mN)&&n<=0&&i>=0&&(u=1),1-s/(o-1)-t+u}function Jue(r,e,t){var n=ph(e),i=ag(e,r),a=1;return 1-i/(n-1)-t+a}function ele(r,e,t,n,i,a){var o=(r-1)/(a-i),s=(e-1)/(Math.max(a,n)-Math.min(t,i));return 2-Math.max(o/s,s/o)}function tle(r,e){return r>=e?2-(r-1)/(e-1):1}function rle(r,e,t,n){var i=e-r;return 1-.5*(Math.pow(e-n,2)+Math.pow(r-t,2))/Math.pow(.1*i,2)}function nle(r,e,t){var n=e-r;if(t>n){var i=(t-n)/2;return 1-Math.pow(i,2)/Math.pow(.1*n,2)}return 1}function ile(){return 1}function bN(r,e,t,n,i,a){t===void 0&&(t=5),n===void 0&&(n=!0),i===void 0&&(i=Kue),a===void 0&&(a=[.25,.2,.5,.05]);var o=t<0?0:Math.round(t);if(Number.isNaN(r)||Number.isNaN(e)||typeof r!="number"||typeof e!="number"||!o)return{min:0,max:0,ticks:[]};if(e-r<1e-15||o===1)return{min:r,max:e,ticks:[r]};for(var s={score:-2,lmin:0,lmax:0,lstep:0},u=1;u<1/0;){for(var l=0;l<i.length;l+=1){var f=i[l],c=Jue(f,i,u);if(a[0]*c+a[1]+a[2]+a[3]<s.score){u=1/0;break}for(var h=2;h<1/0;){var d=tle(h,o);if(a[0]*c+a[1]+a[2]*d+a[3]<s.score)break;for(var v=(e-r)/(h+1)/u/f,p=Math.ceil(Math.log10(v));p<1/0;){var g=u*f*Math.pow(10,p),y=nle(r,e,g*(h-1));if(a[0]*c+a[1]*y+a[2]*d+a[3]<s.score)break;var m=Math.floor(e/g)*u-(h-1)*u,b=Math.ceil(r/g)*u;if(m<=b)for(var x=b-m,_=0;_<=x;_+=1){var S=m+_,E=S*(g/u),C=E+g*(h-1),M=g,w=Que(f,i,u,E,C,M),T=rle(r,e,E,C),I=ele(h,o,r,e,E,C),k=ile(),O=a[0]*w+a[1]*T+a[2]*I+a[3]*k;O>s.score&&(!n||E<=r&&C>=e)&&(s.lmin=E,s.lmax=C,s.lstep=M,s.score=O)}p+=1}h+=1}}u+=1}for(var U=s.lmax,q=s.lmin,K=s.lstep,le=Math.floor((U-q)/K)+1,he=new Array(le),l=0;l<le;l++)he[l]=yN(q+l*K);return{min:Math.min(r,_a(he)),max:Math.max(e,Gi(he)),ticks:he}}function xN(r){var e=r.values,t=r.tickInterval,n=r.tickCount,i=e;if(Lt(t))return Ol(i,function(l,f){return f%t==0});var a=r.min,o=r.max;if(yt(a)&&(a=0),yt(o)&&(o=e.length-1),Lt(n)&&n<o-a){var s=bN(a,o,n,!1,[1,2,5,3,4,7,6,8,9]).ticks,u=Ol(s,function(l){return l>=a&&l<=o});return u.map(function(l){return e[l]})}return e.slice(a,o+1)}function ale(r){var e=r.min,t=r.max,n=r.nice,i=r.tickCount,a=new ole;return a.domain([e,t]),n&&a.nice(i),a.ticks(i)}var k0=5,_N=Math.sqrt(50),wN=Math.sqrt(10),SN=Math.sqrt(2),ole=function(){function r(){this._domain=[0,1]}return r.prototype.domain=function(e){return e?(this._domain=Array.from(e,Number),this):this._domain.slice()},r.prototype.nice=function(e){var t,n;e===void 0&&(e=k0);var i=this._domain.slice(),a=0,o=this._domain.length-1,s=this._domain[a],u=this._domain[o],l;return u<s&&(t=[u,s],s=t[0],u=t[1],n=[o,a],a=n[0],o=n[1]),l=Fv(s,u,e),l>0?(s=Math.floor(s/l)*l,u=Math.ceil(u/l)*l,l=Fv(s,u,e)):l<0&&(s=Math.ceil(s*l)/l,u=Math.floor(u*l)/l,l=Fv(s,u,e)),l>0?(i[a]=Math.floor(s/l)*l,i[o]=Math.ceil(u/l)*l,this.domain(i)):l<0&&(i[a]=Math.ceil(s*l)/l,i[o]=Math.floor(u*l)/l,this.domain(i)),this},r.prototype.ticks=function(e){return e===void 0&&(e=k0),sle(this._domain[0],this._domain[this._domain.length-1],e||k0)},r}();function sle(r,e,t){var n,i=-1,a,o,s;if(e=+e,r=+r,t=+t,r===e&&t>0)return[r];if((n=e<r)&&(a=r,r=e,e=a),(s=Fv(r,e,t))===0||!isFinite(s))return[];if(s>0)for(r=Math.ceil(r/s),e=Math.floor(e/s),o=new Array(a=Math.ceil(e-r+1));++i<a;)o[i]=(r+i)*s;else for(r=Math.floor(r*s),e=Math.ceil(e*s),o=new Array(a=Math.ceil(r-e+1));++i<a;)o[i]=(r-i)/s;return n&&o.reverse(),o}function Fv(r,e,t){var n=(e-r)/Math.max(0,t),i=Math.floor(Math.log(n)/Math.LN10),a=n/Math.pow(10,i);return i>=0?(a>=_N?10:a>=wN?5:a>=SN?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=_N?10:a>=wN?5:a>=SN?2:1)}function EN(r,e,t){var n;return t==="ceil"?n=Math.ceil(r/e):t==="floor"?n=Math.floor(r/e):n=Math.round(r/e),n*e}function D0(r,e,t){var n=EN(r,t,"floor"),i=EN(e,t,"ceil");n=ch(n,t),i=ch(i,t);for(var a=[],o=n;o<=i;o=o+t){var s=ch(o,t);a.push(s)}return{min:n,max:i,ticks:a}}function P0(r,e,t){var n,i=r.minLimit,a=r.maxLimit,o=r.min,s=r.max,u=r.tickCount,l=u===void 0?5:u,f=yt(i)?yt(e)?o:e:i,c=yt(a)?yt(t)?s:t:a;if(f>c&&(n=[f,c],c=n[0],f=n[1]),l<=2)return[f,c];for(var h=(c-f)/(l-1),d=[],v=0;v<l;v++)d.push(f+h*v);return d}function ule(r){var e=r.min,t=r.max,n=r.tickInterval,i=r.minLimit,a=r.maxLimit,o=ale(r);return!yt(i)||!yt(a)?P0(r,_a(o),Gi(o)):n?D0(e,t,n).ticks:o}function lle(r){var e=r.min,t=r.max,n=r.tickCount,i=r.nice,a=r.tickInterval,o=r.minLimit,s=r.maxLimit,u=bN(e,t,n,i).ticks;return!yt(o)||!yt(s)?P0(r,_a(u),Gi(u)):a?D0(e,t,a).ticks:u}function fle(r){var e=r.base,t=r.tickCount,n=r.min,i=r.max,a=r.values,o,s=Hi(e,i);if(n>0)o=Math.floor(Hi(e,n));else{var u=vN(a,e,i);o=Math.floor(Hi(e,u))}for(var l=s-o,f=Math.ceil(l/t),c=[],h=o;h<s+f;h=h+f)c.push(Math.pow(e,h));return n<=0&&c.unshift(0),c}function CN(r,e,t){if(t===void 0&&(t=5),r===e)return{max:e,min:r,ticks:[r]};var n=t<0?0:Math.round(t);if(n===0)return{max:e,min:r,ticks:[]};var i=1.5,a=.5+1.5*i,o=e-r,s=o/n,u=Math.pow(10,Math.floor(Math.log10(s))),l=u;2*u-s<i*(s-l)&&(l=2*u,5*u-s<a*(s-l)&&(l=5*u,10*u-s<i*(s-l)&&(l=10*u)));for(var f=Math.ceil(e/l),c=Math.floor(r/l),h=Math.max(f*l,e),d=Math.min(c*l,r),v=Math.floor((h-d)/l)+1,p=new Array(v),g=0;g<v;g++)p[g]=yN(d+g*l);return{min:d,max:h,ticks:p}}function cle(r){var e=r.exponent,t=r.tickCount,n=Math.ceil(Wo(e,r.max)),i=Math.floor(Wo(e,r.min)),a=CN(i,n,t).ticks;return a.map(function(o){var s=o>=0?1:-1;return Math.pow(o,e)*s})}function hle(r,e){var t=r.length*e;return e===1?r[r.length-1]:e===0?r[0]:t%1!=0?r[Math.ceil(t)-1]:r.length%2==0?(r[t-1]+r[t])/2:r[t]}function dle(r){var e=r.tickCount,t=r.values;if(!t||!t.length)return[];for(var n=t.slice().sort(function(s,u){return s-u}),i=[],a=0;a<e;a++){var o=a/(e-1);i.push(hle(n,o))}return i}function vle(r){var e=r.min,t=r.max,n=r.tickCount,i=r.tickInterval,a=r.minLimit,o=r.maxLimit,s=CN(e,t,n).ticks;return!yt(a)||!yt(o)?P0(r,_a(s),Gi(s)):i?D0(e,t,i).ticks:s}function ple(r){var e=r.min,t=r.max,n=r.minTickInterval,i=r.tickInterval,a=r.tickCount;if(i)a=Math.ceil((t-e)/i);else{i=zue(e,t,a)[1];var o=(t-e)/i,s=o/a;s>1&&(i=i*Math.ceil(s)),n&&i<n&&(i=n)}for(var u=[],l=e;l<t+i;l+=i)u.push(l);return u}function gle(r){var e=xN(r),t=Gi(r.values);return t!==Gi(e)&&e.push(t),e}function Uv(r){return new Date(r).getFullYear()}function yle(r){return new Date(r,0,1).getTime()}function N0(r){return new Date(r).getMonth()}function mle(r,e){var t=Uv(r),n=Uv(e),i=N0(r),a=N0(e);return(n-t)*12+(a-i)%12}function ble(r,e){return new Date(r,e,1).getTime()}function xle(r,e){return Math.ceil((e-r)/so)}function _le(r,e){return Math.ceil((e-r)/Ks)}function wle(r,e){return Math.ceil((e-r)/(60*1e3))}function Sle(r){var e=r.min,t=r.max,n=r.minTickInterval,i=r.tickCount,a=r.tickInterval,o=[];a||(a=(t-e)/i,n&&a<n&&(a=n));var s=Uv(e);if(a>dN)for(var u=Uv(t),l=Math.ceil(a/dN),f=s;f<=u+l;f=f+l)o.push(yle(f));else if(a>pc)for(var c=Math.ceil(a/pc),h=N0(e),d=mle(e,t),f=0;f<=d+c;f=f+c)o.push(ble(s,f+h));else if(a>so)for(var v=new Date(e),p=v.getFullYear(),g=v.getMonth(),y=v.getDate(),m=Math.ceil(a/so),b=xle(e,t),f=0;f<b+m;f=f+m)o.push(new Date(p,g,y+f).getTime());else if(a>Ks)for(var v=new Date(e),p=v.getFullYear(),g=v.getMonth(),m=v.getDate(),x=v.getHours(),_=Math.ceil(a/Ks),S=_le(e,t),f=0;f<=S+_;f=f+_)o.push(new Date(p,g,m,x+f).getTime());else if(a>qs)for(var E=wle(e,t),C=Math.ceil(a/qs),f=0;f<=E+C;f=f+C)o.push(e+f*qs);else{var M=a;M<ca&&(M=ca);for(var w=Math.floor(e/ca)*ca,T=Math.ceil((t-e)/ca),I=Math.ceil(M/ca),f=0;f<T+I;f=f+I)o.push(w+f*ca)}return o.length>=512&&console.warn("Notice: current ticks length("+o.length+') >= 512, may cause performance issues, even out of memory. Because of the configure "tickInterval"(in milliseconds, current is '+a+") is too small, increase the value to solve the problem!"),o}Ra("cat",xN);Ra("time-cat",gle);Ra("wilkinson-extended",lle);Ra("r-pretty",vle);Ra("time",ple);Ra("time-pretty",Sle);Ra("log",fle);Ra("pow",cle);Ra("quantile",dle);Ra("d3-linear",ule);Ba("cat",dc);Ba("category",dc);Ba("identity",que);Ba("linear",yc);Ba("log",Wue);Ba("pow",jue);Ba("time",Xue);Ba("timeCat",$ue);Ba("quantize",pN);Ba("quantile",Hue);var Ele=function(r,e){for(var t=0,n=e.length,i=r.length;t<n;t++,i++)r[i]=e[t];return r};function Cle(r){return fs(r,function(e,t){var n=t===0?"M":"L",i=e[0],a=e[1];return[n,i,a]})}function AN(r){return Cle(r)}function Ale(r){if(r.length<=2)return AN(r);var e=[];xe(r,function(o){ls(o,e.slice(e.length-2))||e.push(o[0],o[1])});var t=fS(e,!1),n=_a(r),i=n[0],a=n[1];return t.unshift(["M",i,a]),t}function Tle(r,e,t,n){n===void 0&&(n=!0);var i=new yc({values:r}),a=new dc({values:fs(r,function(s,u){return u})}),o=fs(r,function(s,u){return[a.scale(u)*e,t-i.scale(s)*t]});return n?Ale(o):AN(o)}function Mle(r,e,t,n){n===void 0&&(n=5);for(var i=new yc({values:r}),a=new dc({values:fs(r,function(h,d){return d})}),o=fs(r,function(h,d){return[a.scale(d)*e,t-i.scale(h)*t]}),s=[],u=0;u<o.length;u++){var l=o[u],f={x:l[0],y:l[1],y0:t,size:n},c=Dle(f);s.push.apply(s,c)}return Ple(s)}function Ile(r,e){var t=new yc({values:r}),n=Math.max(0,t.min);return e-t.scale(n)*e}function kle(r,e,t,n){var i=Ele([],r),a=Ile(n,t);return i.push(["L",e,a]),i.push(["L",0,a]),i.push(["Z"]),i}function Dle(r){var e=r.x,t=r.y,n=r.y0,i=r.size,a,o;At(t)?(a=t[0],o=t[1]):(a=n,o=t);var s,u;At(e)?(s=e[0],u=e[1]):(s=e-i/2,u=e+i/2);var l=[{x:s,y:a},{x:s,y:o}];return l.push({x:u,y:o},{x:u,y:a}),l}function Ple(r,e){e===void 0&&(e=!0);var t=[],n=r[0];t.push(["M",n.x,n.y]);for(var i=1,a=r.length;i<a;i++)t.push(["L",r[i].x,r[i].y]);return e&&(t.push(["L",n.x,n.y]),t.push(["z"])),t}var mc=function(){return mc=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},mc.apply(this,arguments)},Nle={stroke:"#C5C5C5",strokeOpacity:.85},Lle={fill:"#CACED4",opacity:.85},Ole=function(){function r(e){var t=e.x,n=t===void 0?0:t,i=e.y,a=i===void 0?0:i,o=e.width,s=o===void 0?200:o,u=e.height,l=u===void 0?26:u,f=e.smooth,c=f===void 0?!0:f,h=e.isArea,d=h===void 0?!1:h,v=e.data,p=v===void 0?[]:v,g=e.lineStyle,y=e.areaStyle,m=e.group,b=e.interval,x=b===void 0?null:b;this.group=m,this.x=n,this.y=a,this.width=s,this.height=l,this.data=p,this.smooth=c,this.isArea=d,this.lineStyle=Object.assign({},Nle,g),this.areaStyle=Object.assign({},Lle,y),this.intervalConfig=x,this.renderLine()}return r.prototype.renderLine=function(){var e=this,t=e.x,n=e.y,i=e.width,a=e.height;e.barWidth;var o=e.data,s=e.smooth,u=e.isArea,l=e.lineStyle,f=e.areaStyle,c=this.group.addGroup({name:"trend-group"});if(o){var h=Tle(o,i,a,s);if(c.addShape("path",{attrs:mc({path:h},l)}),u){var d=kle(h,i,a,o);c.addShape("path",{attrs:mc({path:d},f)})}}this.intervalConfig&&c.addShape("path",{attrs:mc({path:Mle(this.intervalConfig.data,i,a,this.intervalConfig.style.barWidth)},this.intervalConfig.style)}),c.move(t,n)},r.prototype.destory=function(){this.group.destroy()},r}(),Rle=Ole,vl=function(){return vl=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},vl.apply(this,arguments)},Ble={fill:"#1890ff",stroke:"#1890ff",type:"trend",radius:2,opacity:1,cursor:"ew-resize",highLightFill:"#0050b3"},Gle={fill:"#fff",stroke:"#1890ff",radius:2,opacity:1,cursor:"ew-resize"},Fle=function(){function r(e){var t=e.group,n=e.name,i=e.type,a=e.x,o=a===void 0?0:a,s=e.y,u=s===void 0?0:s,l=e.width,f=l===void 0?2:l,c=e.height,h=c===void 0?24:c,d=e.style,v=d===void 0?{}:d;this.group=t,this.name=n,this.handleType=i,this.x=o,this.y=u,this.width=f,this.height=h,i==="trend"?this.style=vl(vl({},Ble),v):i==="simple"&&(this.style=vl(vl({},Gle),v)),this.renderHandle()}return r.prototype.setX=function(e){this.setXY(e,void 0)},r.prototype.setY=function(e){this.setXY(void 0,e)},r.prototype.setXY=function(e,t){Lt(e)&&(this.x=e),Lt(t)&&(this.y=t),this.updateXY()},r.prototype.renderHandle=function(){var e=this,t=e.width,n=e.height,i=e.style,a=e.name,o=i.fill,s=i.stroke,u=i.radius,l=i.opacity,f=i.cursor;this.handleGroup=this.group.addGroup(),this.handleType==="trend"?(this.verticalLine=this.handleGroup.addShape("rect",{attrs:{x:0,y:0,width:t,height:n,fill:o,stroke:s,radius:u,opacity:l,cursor:f},name:a+"-handler"}),this.topCircle=this.handleGroup.addShape("circle",{attrs:{x:t/2,y:0,r:2*t,fill:o,stroke:s,radius:u,opacity:l,cursor:f},name:a+"-handler"}),this.bottomCircle=this.handleGroup.addShape("circle",{attrs:{x:t/2,y:n,r:2*t,fill:o,stroke:s,radius:u,opacity:l,cursor:f},name:a+"-handler"})):this.handleType==="simple"&&(this.topCircle=this.handleGroup.addShape("circle",{attrs:{x:t/2,y:n/2,r:2*t,fill:o,stroke:s,radius:u,opacity:l,cursor:f,lineWidth:2},name:a+"-handler"})),this.updateXY(),this.handleType==="trend"?this.bindTrendEvents():this.handleType==="simple"&&this.bindSimpleEvents()},r.prototype.bindSimpleEvents=function(){var e=this,t=this.name;this.handleGroup.on(t+"-handler:mouseenter",function(){var n=e.style.highLightFill;e.topCircle.attr("fill",n)}),this.handleGroup.on(t+"-handler:mouseleave",function(){var n=e.style.fill;e.topCircle.attr("fill",n)})},r.prototype.bindTrendEvents=function(){var e=this,t=this.name;this.handleGroup.on(t+"-handler:mouseenter",function(){var n=e.style.highLightFill;e.verticalLine.attr("fill",n),e.topCircle.attr("fill",n),e.bottomCircle.attr("fill",n)}),this.handleGroup.on(t+"-handler:mouseleave",function(){var n=e.style.fill;e.verticalLine.attr("fill",n),e.topCircle.attr("fill",n),e.bottomCircle.attr("fill",n)})},r.prototype.show=function(){this.handleGroup.show()},r.prototype.hide=function(){this.handleGroup.hide()},r.prototype.updateXY=function(){this.handleGroup.setMatrix([1,0,0,0,1,0,this.x,this.y,1])},r}(),TN=Fle,MN="timebarstartplay",IN="timebarendplay",Ga="valuechange",Zs="timebarConfigChanged",jo="playPauseBtn",bc="nextStepBtn",xc="preStepBtn",L0=function(){return L0=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},L0.apply(this,arguments)},Ule=function(){function r(e){this.config=Hr({},e),this.init()}return r.prototype.update=function(e){this.config=Hr({},this.config,e),this.updateElement(),this.renderMarker()},r.prototype.init=function(){this.initElement(),this.renderMarker()},r.prototype.initElement=function(){var e=this.config,t=e.group,n=e.style,i=n.scale,a=i===void 0?1:i,o=n.offsetX,s=o===void 0?0:o,u=n.offsetY,l=u===void 0?0:u,f=this.config.x+s,c=this.config.y+l,h=t.addGroup({name:jo});this.startMarkerGroup=h.addGroup({name:jo}),this.circle=t.addShape("circle",{attrs:L0({x:f,y:c,r:this.config.r*a},n),name:jo}),this.startMarker=this.startMarkerGroup.addShape("path",{attrs:{path:this.getStartMarkerPath(f,c,a),fill:n.stroke||"#aaa"}}),this.pauseMarkerGroup=h.addGroup({name:jo});var d=.25*this.config.r*a,v=.5*this.config.r*Math.sqrt(3)*a;this.pauseLeftMarker=this.pauseMarkerGroup.addShape("rect",{attrs:{x:f-.375*this.config.r*a,y:c-v/2,width:d,height:v,fill:n.stroke||"#aaa",lineWidth:0}}),this.pauseRightMarker=this.pauseMarkerGroup.addShape("rect",{attrs:{x:f+1/8*this.config.r*a,y:c-v/2,width:d,height:v,fill:n.stroke||"#aaa",lineWidth:0}})},r.prototype.updateElement=function(){var e=this.config.style,t=e.scale,n=t===void 0?1:t,i=e.offsetX,a=i===void 0?0:i,o=e.offsetY,s=o===void 0?0:o,u=this.config.x+a,l=this.config.y+s;this.circle.attr("x",u),this.circle.attr("y",l),this.circle.attr("r",this.config.r*n),this.startMarker.attr("path",this.getStartMarkerPath(u,l,n));var f=.25*this.config.r*n,c=.5*this.config.r*Math.sqrt(3)*n;this.pauseLeftMarker.attr("x",u-(1/4+1/8)*this.config.r*n),this.pauseLeftMarker.attr("y",l-c/2),this.pauseLeftMarker.attr("width",f),this.pauseLeftMarker.attr("height",c),this.pauseRightMarker.attr("x",u+1/8*this.config.r*n),this.pauseRightMarker.attr("y",l-c/2),this.pauseRightMarker.attr("width",f),this.pauseRightMarker.attr("height",c)},r.prototype.renderMarker=function(){this.config.isPlay?(this.startMarkerGroup.hide(),this.pauseMarkerGroup.show()):(this.startMarkerGroup.show(),this.pauseMarkerGroup.hide())},r.prototype.getStartMarkerPath=function(e,t,n){var i=.5*this.config.r*Math.sqrt(3)*n;return[["M",e-i/Math.sqrt(3)/2,t-i/2],["L",e+i/Math.sqrt(3),t],["L",e-i/Math.sqrt(3)/2,t+i/2]]},r}(),zle=Ule,Mn=function(){return Mn=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},Mn.apply(this,arguments)},_c=Yh,$le="#aaa",Vle="green",Wle={fill:"#aaa",fillOpacity:.35,stroke:"#aaa"},jle={fill:"#fff"},Xle={fill:"green"},kN={pointer:{fill:"#aaa",lineWidth:0},scroller:{stroke:"#aaa",fill:"#aaa",lineWidth:1,lineAppendWidth:5,cursor:"pointer"},text:{fill:"#aaa",textBaseline:"top"}},DN={check:{stroke:"green",lineWidth:3},box:{fill:"#fff",stroke:"#aaa",lineWidth:2,radius:3,width:12,height:12},text:{fill:"#aaa",fontSize:12,textBaseline:"top"}},Hle={speed:1,loop:!1,fill:"#fff",stroke:"#fff",hideTimeTypeController:!1,preBtnStyle:{fill:"#aaa",stroke:"#aaa"},nextBtnStyle:{fill:"#aaa",stroke:"#aaa"},playBtnStyle:{fill:"#aaa",stroke:"#aaa",fillOpacity:.05},speedControllerStyle:kN,timeTypeControllerStyle:DN},O0=110,Xo=50,Yle=function(){function r(e){this.controllerCfg=Hr({},Hle,e),this.group=e.group,this.controllerGroup=this.group.addGroup({name:"controller-group"}),this.speedAxisY=[],this.currentSpeed=this.controllerCfg.speed,this.currentType="range",this.fontFamily=e.fontFamily||"Arial, sans-serif",this.init()}return r.prototype.init=function(){this.renderPlayButton()},r.prototype.getNextMarkerPath=function(e,t,n){return[["M",e,t-n],["L",e+n,t],["L",e,t+n],["Z",e,t-n],["M",e,t],["L",e-n,t-n],["L",e-n,t+n],["Z"]]},r.prototype.getPreMarkerPath=function(e,t,n){return[["M",e,t-n],["L",e-n,t],["L",e,t+n],["L",e,t-n],["M",e,t],["L",e+n,t-n],["L",e+n,t+n],["Z"]]},r.prototype.renderPlayButton=function(){var e=this.controllerCfg,t=e.width,n=e.height,i=e.x,a=e.y,o=e.hideTimeTypeController,s=e.fill,u=s===void 0?$le:s,l=e.stroke,f=l===void 0?Vle:l,c=Mn(Mn({},Wle),e.playBtnStyle||{}),h=Mn(Mn({},jle),e.preBtnStyle||{}),d=Mn(Mn({},Xle),e.nextBtnStyle||{}),v=n/2-5,p=a+10,g=this.controllerGroup.addShape("rect",{attrs:{x:i,y:p,width:t,height:n,stroke:f,fill:u},name:"container-rect"});this.playButton?this.playButton.update({x:t/2,y:p,r:v}):this.playButton=new zle({group:this.controllerGroup,x:t/2,y:p+v+5,r:v,isPlay:this.isPlay,style:c});var y=h.offsetX||0,m=h.offsetY||0,b=(h.scale||1)*v;this.controllerGroup.addShape("path",{attrs:Mn({path:this.getPreMarkerPath(t/2-5*v+y,p+v+5+m,b*.5)},h),name:xc});var x=d.offsetX||0,_=d.offsetY||0,S=(d.scale||1)*v;this.controllerGroup.addShape("path",{attrs:Mn({path:this.getNextMarkerPath(t/2+5*v+x,p+v+5+_,S*.5)},d),name:bc}),g.toBack(),this.renderSpeedBtn(),o||this.renderToggleTime(),this.bindEvent();var E=this.controllerCfg.scale,C=E===void 0?1:E,M=this.controllerGroup.getCanvasBBox(),w=(M.maxX+M.minX)/2,T=(M.maxY+M.minY)/2,I=_c([1,0,0,0,1,0,0,0,1],[["t",-w,-T],["s",C,C],["t",w,T]]);this.controllerGroup.setMatrix(I)},r.prototype.renderSpeedBtn=function(){var e=this.controllerCfg,t=e.y,n=e.width,i=e.hideTimeTypeController,a=Mn(Mn({},kN),this.controllerCfg.speedControllerStyle||{}),o=a.scroller,s=o===void 0?{}:o,u=a.text,l=u===void 0?{}:u,f=a.pointer,c=f===void 0?{}:f,h=a.scale,d=h===void 0?1:h,v=a.offsetX,p=v===void 0?0:v,g=a.offsetY,y=g===void 0?0:g,m=this.controllerGroup.addGroup({name:"speed-group"});this.speedGroup=m;var b=5;this.speedAxisY=[19,22,26,32,39];for(var x=0;x<5;x++){var _=t+this.speedAxisY[x],S=n-(i?Xo:O0);m.addShape("line",{attrs:Mn({x1:S,x2:S+15,y1:_,y2:_},s),speed:b,name:"speed-rect"}),this.speedAxisY[x]=_,b=b-1}this.speedText=m.addShape("text",{attrs:Mn({x:n-(i?Xo:O0)+20,y:this.speedAxisY[0]+4,text:"1.0X",fontFamily:this.fontFamily||"Arial, sans-serif"},l)}),this.speedPoint=m.addShape("path",{attrs:Mn({path:this.getPointerPath(n-(i?Xo:O0),0),matrix:[1,0,0,0,1,0,0,this.speedAxisY[4],1]},c)});var E=this.speedGroup.getCanvasBBox(),C=(E.maxX+E.minX)/2,M=(E.maxY+E.minY)/2,w=this.speedGroup.getMatrix()||[1,0,0,0,1,0,0,0,1];w=_c(w,[["t",-C,-M],["s",d,d],["t",C+p*d,M+y*d]]),this.speedGroup.setMatrix(w)},r.prototype.getPointerPath=function(e,t){return[["M",e,t],["L",e-10,t-4],["L",e-10,t+4],["Z"]]},r.prototype.renderToggleTime=function(){var e,t=this.controllerCfg.width,n=Mn(Mn({},DN),this.controllerCfg.timeTypeControllerStyle||{}),i=n.scale,a=i===void 0?1:i,o=n.offsetX,s=o===void 0?0:o,u=n.offsetY,l=u===void 0?0:u,f=n.box,c=f===void 0?{}:f,h=n.check,d=h===void 0?{}:h,v=n.text,p=v===void 0?{}:v;this.toggleGroup=this.controllerGroup.addGroup({name:"toggle-group"}),this.toggleGroup.addShape("rect",{attrs:Mn({x:t-Xo,y:this.speedAxisY[0]+3.5},c),isChecked:!1,name:"toggle-model"}),this.checkedIcon=this.toggleGroup.addShape("path",{attrs:Mn({path:[["M",t-Xo+3,this.speedAxisY[1]+6],["L",t-Xo+7,this.speedAxisY[1]+10],["L",t-Xo+12,this.speedAxisY[1]+4]]},d),capture:!1}),this.checkedIcon.hide(),this.checkedText=this.toggleGroup.addShape("text",{attrs:Mn({text:((e=this.controllerCfg)===null||e===void 0?void 0:e.timePointControllerText)||"\u5355\u4E00\u65F6\u95F4",x:t-Xo+15,y:this.speedAxisY[0]+4,fontFamily:typeof window!="undefined"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif"},p)});var g=this.toggleGroup.getCanvasBBox(),y=(g.maxX+g.minX)/2,m=(g.maxY+g.minY)/2,b=this.toggleGroup.getMatrix()||[1,0,0,0,1,0,0,0,1];b=_c(b,[["t",-y,-m],["s",a,a],["t",y+s*a,m+l*a]]),this.toggleGroup.setMatrix(b)},r.prototype.bindEvent=function(){var e=this;this.speedGroup.on("speed-rect:click",function(t){var n=t.target.attr("y1"),i=e.speedPoint.attr("matrix"),a=e.speedAxisY.indexOf(i[7]||0),o=e.speedAxisY.indexOf(n),s=e.speedAxisY[o]-e.speedAxisY[a];i=_c(i,[["t",0,s]]),e.speedPoint.setMatrix(i),e.currentSpeed=e.speedAxisY.length-o,e.speedText.attr("text",e.currentSpeed+".0X"),e.group.emit(Zs,{speed:e.currentSpeed,type:e.currentType})}),this.speedGroup.on("mousewheel",function(t){t.preventDefault();var n=e.speedPoint.attr("matrix")||[1,0,0,0,1,0,0,0,1],i=n[7],a=e.speedAxisY.indexOf(i);if(a===-1){var o=1/0;e.speedAxisY.forEach(function(u,l){var f=Math.abs(u-i);o>f&&(o=f,a=l)})}t.originalEvent.deltaY>0?a=Math.max(0,a-1):a=Math.min(e.speedAxisY.length-1,a+1);var s=e.speedAxisY[a]-i;n=_c(n,[["t",0,s]]),e.speedPoint.setMatrix(n),e.currentSpeed=e.speedAxisY.length-a,e.speedText.attr("text",e.currentSpeed+".0X"),e.group.emit(Zs,{speed:e.currentSpeed,type:e.currentType})}),this.toggleGroup&&this.toggleGroup.on("toggle-model:click",function(t){var n,i,a=t.target.get("isChecked");a?(e.checkedIcon.hide(),e.checkedText.attr("text",((i=e.controllerCfg)===null||i===void 0?void 0:i.timePointControllerText)||"\u5355\u4E00\u65F6\u95F4"),e.currentType="range"):(e.checkedIcon.show(),e.checkedText.attr("text",((n=e.controllerCfg)===null||n===void 0?void 0:n.timeRangeControllerText)||"\u65F6\u95F4\u8303\u56F4"),e.currentType="single"),t.target.set("isChecked",!a),e.group.emit(Zs,{type:e.currentType,speed:e.currentSpeed})})},r.prototype.destroy=function(){this.speedGroup.off("speed-rect:click"),this.toggleGroup&&(this.toggleGroup.off("toggle-model:click"),this.toggleGroup.destroy()),this.speedGroup.destroy()},r}(),PN=Yle,Yr=function(){return Yr=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},Yr.apply(this,arguments)},qle={fill:"#416180",opacity:.05},Kle={fill:"#416180",opacity:.15,radius:5},Zle={fill:"#5B8FF9",opacity:.3,cursor:"grab"},R0=2,Qle={width:R0,height:24},Jle={textBaseline:"middle",fill:"#000",opacity:.45},efe={textAlign:"center",textBaseline:"top",fill:"#607889",opacity:.35},tfe={lineWidth:1,stroke:"#ccc"},rfe=function(){function r(e){var t=this;this.prevX=0,this.onMouseDown=function(se){return function(ge){t.currentHandler=se;var Se=ge.originalEvent;Se.stopPropagation(),Se.preventDefault(),t.prevX=$a(Se,"touches.0.pageX",Se.pageX);var ne=t.canvas.get("container");ne.addEventListener("mousemove",t.onMouseMove),ne.addEventListener("mouseup",t.onMouseUp),ne.addEventListener("mouseleave",t.onMouseUp),ne.addEventListener("touchmove",t.onMouseMove),ne.addEventListener("touchend",t.onMouseUp),ne.addEventListener("touchcancel",t.onMouseUp)}},this.onMouseMove=function(se){se.stopPropagation(),se.preventDefault();var ge=$a(se,"touches.0.pageX",se.pageX),Se=ge-t.prevX,ne=t.adjustOffsetRange(Se/t.width);t.updateStartEnd(ne),t.updateUI(),t.prevX=ge},this.onMouseUp=function(){t.currentHandler&&(t.currentHandler=void 0);var se=t.canvas.get("container");se&&(se.removeEventListener("mousemove",t.onMouseMove),se.removeEventListener("mouseup",t.onMouseUp),se.removeEventListener("mouseleave",t.onMouseUp),se.removeEventListener("touchmove",t.onMouseMove),se.removeEventListener("touchend",t.onMouseUp),se.removeEventListener("touchcancel",t.onMouseUp))};var n=e.x,i=n===void 0?0:n,a=e.y,o=a===void 0?0:a,s=e.width,u=s===void 0?100:s,l=e.height,f=e.padding,c=f===void 0?10:f,h=e.trendCfg,d=e.controllerCfg,v=d===void 0?{speed:1}:d,p=e.backgroundStyle,g=p===void 0?{}:p,y=e.foregroundStyle,m=y===void 0?{}:y,b=e.handlerStyle,x=b===void 0?{}:b,_=e.textStyle,S=_===void 0?{}:_,E=e.start,C=E===void 0?0:E,M=e.end,w=M===void 0?1:M,T=e.minText,I=T===void 0?"":T,k=e.maxText,O=k===void 0?"":k,U=e.group,q=e.graph,K=e.canvas,le=e.tick,he=le===void 0?{tickLabelStyle:{},tickLineStyle:{},tickLabelFormatter:function(ge){return ge},ticks:[]}:le,te=e.type;this.graph=q,this.canvas=K,this.group=U,this.timeBarType=te,this.x=i,this.y=o,this.width=u,this.height=l,this.padding=c,this.ticks=he.ticks,this.trendCfg=h,this.controllerCfg=v,this.currentSpeed=v.speed||1,this.tickLabelFormatter=he.tickLabelFormatter,te==="trend"?this.backgroundStyle=Yr(Yr({},qle),g):te==="simple"&&(this.backgroundStyle=Yr(Yr({},Kle),g)),this.foregroundStyle=Yr(Yr({},Zle),m),this.handlerStyle=Yr(Yr({},Qle),x),this.textStyle=Yr(Yr({},Jle),S),this.tickLabelStyle=Yr(Yr({},efe),he.tickLabelStyle),this.tickLineStyle=Yr(Yr({},tfe),he.tickLineStyle),this.currentMode="range",this.start=C,this.end=w,this.minText=I,this.maxText=O,this.fontFamily=typeof window!="undefined"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif",this.renderSlider()}return r.prototype.update=function(e){var t=e.x,n=e.y,i=e.width,a=e.height,o=e.minText,s=e.maxText,u=e.start,l=e.end;this.start=Math.min(1,Math.max(u,0)),this.end=Math.min(1,Math.max(l,0)),St(this,{x:t,y:n,width:i,height:a,minText:o,maxText:s}),this.updateUI()},r.prototype.setText=function(e,t){this.minTextShape.attr("text",e),this.maxTextShape.attr("text",t)},r.prototype.renderSlider=function(){var e=this,t=this,n=t.width,i=t.height,a=t.timeBarType;if(a==="trend"&&ph($a(this.trendCfg,"data"))){var o=new Rle(Yr(Yr({x:this.x,y:this.y,width:n,height:i},this.trendCfg),{group:this.group}));this.trendComponent=o}var s=this.group.addGroup({name:"slider-group"});s.addShape("rect",{attrs:Yr({x:0,y:0,width:n,height:i},this.backgroundStyle)});var u=this.group.addGroup();a==="trend"?(this.minTextShape=u.addShape("text",{attrs:Yr({x:0,y:i/2+this.y,textAlign:"right",text:this.minText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif"},this.textStyle),capture:!1}),this.maxTextShape=u.addShape("text",{attrs:Yr({y:i/2+this.y,textAlign:"left",text:this.maxText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif"},this.textStyle),capture:!1})):(this.minTextShape=u.addShape("text",{attrs:Yr({x:0,y:this.y-10,textAlign:"center",text:this.minText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif"},this.textStyle),capture:!1}),this.maxTextShape=u.addShape("text",{attrs:Yr({y:this.y-10,textAlign:"center",text:this.maxText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif"},this.textStyle),capture:!1})),this.foregroundShape=this.group.addGroup().addShape("rect",{attrs:Yr({x:0,y:this.y,height:i},this.foregroundStyle)}),this.foregroundShape.on("mousedown",function(g){g.target.attr("cursor","grabbing")}),this.foregroundShape.on("mouseup",function(g){g.target.attr("cursor",e.foregroundStyle.cursor||"grab")});var l=$a(this.handlerStyle,"width",2),f=$a(this.handlerStyle,"height",24),c=this.group.addGroup({name:"minHandlerShape"});this.minHandlerShape=new TN({name:"minHandlerShape",group:c,type:a,x:this.x,y:this.y,width:l,height:f,style:this.handlerStyle});var h=this.group.addGroup({name:"maxHandlerShape"});this.maxHandlerShape=new TN({name:"maxHandlerShape",group:h,type:a,x:this.x,y:this.y,width:l,height:f,style:this.handlerStyle});var d=this.ticks,v=n/(d.length-1);this.tickPosList=[],this.textList&&this.textList.length&&this.textList.forEach(function(g){g.destroy()});var p=-1/0;this.textList=d.map(function(g,y){e.tickPosList.push(e.x+y*v);var m;e.tickLabelFormatter?(m=e.tickLabelFormatter(g),!Xe(m)&&m&&(m=g.date)):m=g.date;var b=e.group.addShape("text",{attrs:Yr({x:e.x+y*v,y:e.y+i+5,text:m,fontFamily:e.fontFamily||"Arial, sans-serif"},e.tickLabelStyle)}),x=e.group.addShape("line",{attrs:Yr({x1:e.x+y*v,y1:e.y+i+2,x2:e.x+y*v,y2:e.y+i+6},e.tickLineStyle)});x.toBack();var _=b.getBBox();return _.minX>p?(b.show(),x.show(),p=_.minX+_.width+10):(b.hide(),x.hide()),b}),this.controllerBtnGroup=new PN(Yr({group:this.group,x:this.x,y:this.y+i+25,width:n,height:35},this.controllerCfg)),this.updateStartEnd(0),this.updateUI(),s.move(this.x,this.y),this.bindEvents()},r.prototype.bindEvents=function(){var e=this,t=this.group.find(function(i){return i.get("name")==="minHandlerShape"});t&&(t.on("minHandlerShape-handler:mousedown",this.onMouseDown(this.minHandlerShape)),t.on("minHandlerShape-handler:touchstart",this.onMouseDown(this.minHandlerShape)));var n=this.group.find(function(i){return i.get("name")==="maxHandlerShape"});n&&(n.on("maxHandlerShape-handler:mousedown",this.onMouseDown(this.maxHandlerShape)),n.on("maxHandlerShape-handler:touchstart",this.onMouseDown(this.maxHandlerShape))),this.foregroundShape.on("mousedown",this.onMouseDown(this.foregroundShape)),this.foregroundShape.on("touchstart",this.onMouseDown(this.foregroundShape)),this.group.on(jo+":click",function(){e.isPlay=!e.isPlay,e.currentHandler=e.maxHandlerShape,e.changePlayStatus()}),this.group.on(bc+":click",function(){e.currentHandler=e.maxHandlerShape,e.updateStartEnd(.01),e.updateUI()}),this.group.on(xc+":click",function(){e.currentHandler=e.maxHandlerShape,e.updateStartEnd(-.01),e.updateUI()}),this.group.on(Zs,function(i){var a=i.type,o=i.speed;e.currentSpeed=o,e.currentMode=a,a==="single"?(e.minHandlerShape.hide(),e.foregroundShape.hide(),e.minTextShape.hide()):a==="range"&&(e.minHandlerShape.show(),e.foregroundShape.show(),e.minTextShape.show())})},r.prototype.adjustTickIndex=function(e){for(var t=0;t<this.tickPosList.length-1;t++)if(this.tickPosList[t]<=e&&e<=this.tickPosList[t+1])return Math.abs(this.tickPosList[t]-e)<Math.abs(e-this.tickPosList[t+1])?t:t+1;return 0},r.prototype.adjustOffsetRange=function(e){switch(this.currentHandler){case this.minHandlerShape:{var t=0-this.start,n=1-this.start;return Math.min(n,Math.max(t,e))}case this.maxHandlerShape:{var t=0-this.end,n=1-this.end;return Math.min(n,Math.max(t,e))}case this.foregroundShape:{var t=0-this.start,n=1-this.end;return Math.min(n,Math.max(t,e))}default:return 0}},r.prototype.updateStartEnd=function(e){var t=this.ticks[this.adjustTickIndex(this.start*this.width)],n=this.ticks[this.adjustTickIndex(this.end*this.width)];if(!this.currentHandler){this.minText=this.tickLabelFormatter?this.tickLabelFormatter(t):t.date,this.maxText=this.tickLabelFormatter?this.tickLabelFormatter(n):n.date;return}switch(this.currentHandler){case this.minHandlerShape:this.maxText=this.maxTextShape.attr("text"),this.start+=e,this.minText=this.tickLabelFormatter?this.tickLabelFormatter(t):t.date;break;case this.maxHandlerShape:this.minText=this.minTextShape.attr("text"),this.end+=e,this.maxText=this.tickLabelFormatter?this.tickLabelFormatter(n):n.date;break;case this.foregroundShape:this.start+=e,this.end+=e,this.minText=this.tickLabelFormatter?this.tickLabelFormatter(t):t.date,this.maxText=this.tickLabelFormatter?this.tickLabelFormatter(n):n.date;break}},r.prototype.updateUI=function(){var e=this;this.start<0&&(this.start=0),this.end>1&&(this.end=1);var t=this.x+this.start*this.width,n=this.x+this.end*this.width;this.foregroundShape.attr("x",t),this.foregroundShape.attr("width",n-t);var i=$a(this.handlerStyle,"width",R0);this.setText(this.minText,this.maxText);var a=this.dodgeText([t,n]),o=a[0],s=a[1];this.minHandlerShape.setX(t-i/2),xe(o,function(u,l){return e.minTextShape.attr(l,u)}),this.maxHandlerShape.setX(n-i/2),xe(s,function(u,l){return e.maxTextShape.attr(l,u)}),this.currentMode==="range"?this.graph.emit(Ga,{value:[this.start,this.end].sort()}):this.currentMode==="single"&&this.graph.emit(Ga,{value:[this.end,this.end]})},r.prototype.dodgeText=function(e){var t,n,i=2,a=$a(this.handlerStyle,"width",R0),o=this.minTextShape,s=this.maxTextShape,u=e[0],l=e[1],f=!1;u>l&&(t=[l,u],u=t[0],l=t[1],n=[s,o],o=n[0],s=n[1],f=!0);var c=o.getBBox(),h=s.getBBox(),d=null,v=null;return this.timeBarType==="trend"?(d=u-c.width<this.x+i?{x:u+a/2+i,textAlign:"left"}:{x:u-a/2-i,textAlign:"right"},v=l+h.width>this.x+this.width?{x:l-a/2-i,textAlign:"right"}:{x:l+a/2+i,textAlign:"left"}):this.timeBarType==="simple"&&(d=c.width>u-i?{x:u+a/2+i,textAlign:"center"}:{x:u-a/2-i,textAlign:"center"},v=h.width>this.width-l-i?{x:l-a/2-i,textAlign:"center"}:{x:l+a/2+i,textAlign:"center"}),f?[v,d]:[d,v]},r.prototype.startPlay=function(){var e=this;return typeof window!="undefined"?window.requestAnimationFrame(function(){var t=e,n=t.ticks,i=t.width,a=e.currentSpeed,o=i/n.length,s=o/((10-a)*1e3/60),u=e.adjustOffsetRange(s/e.width);e.updateStartEnd(u),e.updateUI(),e.isPlay&&(e.playHandler=e.startPlay())}):void 0},r.prototype.changePlayStatus=function(e){e===void 0&&(e=!0),this.controllerBtnGroup.playButton.update({isPlay:this.isPlay}),this.isPlay?(this.playHandler=this.startPlay(),this.graph.emit(MN,null)):this.playHandler&&(typeof window!="undefined"&&window.cancelAnimationFrame(this.playHandler),e&&this.graph.emit(IN,null))},r.prototype.destory=function(){this.graph.off(Ga);var e=this.group,t=e.find(function(i){return i.get("name")==="minHandlerShape"});t&&(t.off("minHandlerShape-handler:mousedown"),t.off("minHandlerShape-handler:touchstart"),t.destroy());var n=e.find(function(i){return i.get("name")==="maxHandlerShape"});n&&(n.off("maxHandlerShape-handler:mousedown"),n.off("maxHandlerShape-handler:touchstart"),n.destroy()),this.foregroundShape.off("mousedown"),this.foregroundShape.off("touchstart"),this.foregroundShape.destroy(),e.off(jo+":click"),e.off(bc+":click"),e.off(xc+":click"),e.off(Zs),e.destroy(),this.trendComponent&&this.trendComponent.destory()},r}(),nfe=rfe,ife=function(){function r(e){var t=e.x,n=t===void 0?0:t,i=e.y,a=i===void 0?0:i,o=e.container,s=e.text,u=e.padding,l=u===void 0?[4,4,4,4]:u,f=e.className,c=f===void 0?"g6-component-timebar-tooltip":f,h=e.backgroundColor,d=h===void 0?"#000":h,v=e.textColor,p=v===void 0?"#fff":v,g=e.opacity,y=g===void 0?.8:g,m=e.fontSize,b=m===void 0?12:m;this.container=o,this.className=c,this.backgroundColor=d,this.textColor=p,this.x=n,this.y=a,this.text=s,this.padding=l,this.opacity=y,this.fontSize=b,this.render()}return r.prototype.render=function(){var e=this,t=e.className;e.x,e.y;var n=e.backgroundColor,i=e.textColor,a=e.text,o=e.padding,s=e.opacity,u=e.fontSize,l=e.container,f=yn("<div class='"+t+`' style="position: absolute; width: fit-content; height: fit-content; opacity: `+s+'"></div>');Xe(l)&&(l=document.getElementById(l)),l.appendChild(f),e.parentHeight=l.offsetHeight,e.parentWidth=l.offsetWidth,Lr(f,{visibility:"hidden",top:0,left:0});var c=yn(`
      <div style='position: absolute; white-space:nowrap; background-color: `+n+"; font-size: "+u+"px; border-radius: 4px; width: fit-content; height: fit-content; color: "+i+"; padding: "+o[0]+"px "+o[1]+"px "+o[2]+"px "+o[3]+"px'></div>");c.innerHTML=a,f.appendChild(c),e.backgroundDOM=c;var h=yn("<div style='position: absolute; width: 0px; height: 0px; border-left: 5px solid transparent; border-right: 5px solid transparent; border-top: 10px solid "+n+"'></div>");f.appendChild(h),e.arrowDOM=h,e.container=f},r.prototype.show=function(e){var t=this,n=e.text,i=e.x;e.y,e.clientX,e.clientY,t.backgroundDOM.innerHTML=n;var a=t.backgroundDOM.offsetWidth,o=t.backgroundDOM.offsetHeight,s=t.arrowDOM.offsetWidth,u=t.arrowDOM.offsetHeight;Lr(t.container,{top:-o-u+"px",left:i+"px",visibility:"visible"}),Lr(t.backgroundDOM,{marginLeft:-a/2+"px"}),Lr(t.arrowDOM,{marginLeft:-s/2+"px",top:o+"px"});var l=i-a/2,f=i+a/2;l<0?Lr(t.backgroundDOM,{marginLeft:-a/2-l+"px"}):f>t.parentWidth&&Lr(t.backgroundDOM,{marginLeft:-a/2-f+t.parentWidth+12+"px"})},r.prototype.hide=function(){Lr(this.container,{top:0,left:0,visibility:"hidden"})},r}(),afe=ife,B0=function(){return B0=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},B0.apply(this,arguments)},ofe={fill:"#5B8FF9"},sfe={fill:"#e6e8e9"},ufe=function(){function r(e){this.frameCount=0,this.fontFamily="Arial, sans-serif";var t=e.graph,n=e.canvas,i=e.group,a=e.width,o=e.height,s=e.padding,u=e.data,l=e.start,f=e.end,c=e.x,h=c===void 0?0:c,d=e.y,v=d===void 0?0:d,p=e.tickLabelFormatter,g=e.selectedTickStyle,y=g===void 0?ofe:g,m=e.unselectedTickStyle,b=m===void 0?sfe:m,x=e.tooltipBackgroundColor,_=e.tooltipFomatter;this.graph=t,this.group=i,this.sliceGroup=i.addGroup({name:"slice-group"}),this.canvas=n,this.width=a,this.height=o,this.padding=s,this.data=u,this.start=l,this.end=f,this.tickLabelFormatter=p,this.selectedTickStyle=y,this.unselectedTickStyle=b,this.x=h,this.y=v,this.tooltipBackgroundColor=x,this.tooltipFomatter=_,this.fontFamily=typeof window!="undefined"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif",this.renderSlices(),this.initEvent()}return r.prototype.renderSlices=function(){var e=this,t=this,n=t.width,i=t.height,a=t.padding,o=t.data,s=t.start,u=t.end,l=t.tickLabelFormatter,f=t.selectedTickStyle,c=t.unselectedTickStyle,h=n-2*a,d=10,v=4,p=3*a+v+d,g=i-p-2*a,y=2,m=o.length,b=(h-y*(m-1))/m;this.tickWidth=b;var x=this.sliceGroup,_=[],S=Math.round(m*s),E=Math.round(m*u);this.startTickRectId=S,this.endTickRectId=E,o.forEach(function(M,w){var T=w>=S&&w<=E,I=T?f:c,k=x.addShape("rect",{attrs:B0({x:a+w*(b+y),y:a,width:b,height:g},I),draggable:!0,name:"tick-rect-"+w}),O=x.addShape("rect",{attrs:{x:a+w*b+y*(2*w-1)/2,y:a,width:w===0||w===m-1?b+y/2:b+y,height:g,fill:"#fff",opacity:0},draggable:!0,name:"pick-rect-"+w});O.toFront();var U=k.getBBox(),q=(U.minX+U.maxX)/2;_.push({rect:k,pickRect:O,value:M.date,x:q,y:U.minY});var K;if(l?(K=l(M),!Xe(K)&&K&&(K=M.date)):w%Math.round(m/10)==0&&(K=M.date),K){var le=U.maxY+a*2;x.addShape("line",{attrs:{stroke:"#BFBFBF",x1:q,y1:le,x2:q,y2:le+v}});var he=le+v+a,te=x.addShape("text",{attrs:{fill:"#8c8c8c",stroke:"#fff",lineWidth:1,x:q,y:he,textAlign:"center",text:K,textBaseline:"top",fontSize:10,fontFamily:e.fontFamily||"Arial, sans-serif"},capture:!1}),se=te.getBBox();se.maxX>n?te.attr("textAlign","right"):se.minX<0&&te.attr("textAlign","left")}}),this.tickRects=_;var C=this.group;this.currentSpeed=1,this.controllerBtnGroup=new PN({group:C,x:this.x,y:this.y+i+5,width:n,height:40,hideTimeTypeController:!0,speed:this.currentSpeed,fontFamily:this.fontFamily||"Arial, sans-serif"})},r.prototype.initEvent=function(){var e=this,t=this.sliceGroup;t.on("click",function(f){var c=f.target;if(!(c.get("type")!=="rect"||!c.get("name"))){var h=parseInt(c.get("name").split("-")[2],10);if(!isNaN(h)){var d=e.tickRects,v=e.unselectedTickStyle;d.forEach(function(m){m.rect.attr(v)});var p=e.selectedTickStyle;d[h].rect.attr(p),e.startTickRectId=h,e.endTickRectId=h;var g=d.length,y=h/g;e.graph.emit(Ga,{value:[y,y]})}}}),t.on("dragstart",function(f){var c=e.tickRects,h=e.unselectedTickStyle;c.forEach(function(m){m.rect.attr(h)});var d=f.target,v=parseInt(d.get("name").split("-")[2],10),p=e.selectedTickStyle;c[v].rect.attr(p),e.startTickRectId=v;var g=c.length,y=v/g;e.graph.emit(Ga,{value:[y,y]}),e.dragging=!0}),t.on("dragover",function(f){if(!!e.dragging&&f.target.get("type")==="rect"){for(var c=parseInt(f.target.get("name").split("-")[2],10),h=e.startTickRectId,d=e.tickRects,v=e.selectedTickStyle,p=e.unselectedTickStyle,g=0;g<d.length;g++){var y=g>=h&&g<=c?v:p;d[g].rect.attr(y)}var m=d.length;e.endTickRectId=c;var b=h/m,x=c/m;e.graph.emit(Ga,{value:[b,x]})}}),t.on("drop",function(f){if(!!e.dragging&&(e.dragging=!1,f.target.get("type")==="rect")){var c=e.startTickRectId,h=parseInt(f.target.get("name").split("-")[2],10);if(!(h<c)){var d=e.selectedTickStyle,v=e.tickRects;v[h].rect.attr(d),e.endTickRectId=h;var p=v.length,g=c/p,y=h/p;e.graph.emit(Ga,{value:[g,y]})}}});var n=this,i=n.tooltipBackgroundColor,a=n.tooltipFomatter,o=n.canvas,s=new afe({container:o.get("container"),backgroundColor:i}),u=this.tickRects;u.forEach(function(f){var c=f.pickRect;c.on("mouseenter",function(h){var d=h.target;if(d.get("type")==="rect"){var v=parseInt(d.get("name").split("-")[2],10),p=o.getClientByPoint(u[v].x,u[v].y);s.show({x:u[v].x,y:u[v].y,clientX:p.x,clientY:p.y,text:a?a(u[v].value):u[v].value})}}),c.on("mouseleave",function(h){s.hide()})});var l=this.group;l.on(jo+":click",function(){e.isPlay=!e.isPlay,e.changePlayStatus()}),l.on(bc+":click",function(){e.updateStartEnd(1)}),l.on(xc+":click",function(){e.updateStartEnd(-1)}),l.on(Zs,function(f){f.type;var c=f.speed;e.currentSpeed=c})},r.prototype.changePlayStatus=function(e){e===void 0&&(e=!0),this.controllerBtnGroup.playButton.update({isPlay:this.isPlay}),this.isPlay?(this.playHandler=this.startPlay(),this.graph.emit(MN,null)):this.playHandler&&(typeof window!="undefined"&&window.cancelAnimationFrame(this.playHandler),e&&this.graph.emit(IN,null))},r.prototype.startPlay=function(){var e=this;return typeof window!="undefined"?window.requestAnimationFrame(function(){var t=e.currentSpeed;e.frameCount%(60/t)==0&&(e.frameCount=0,e.updateStartEnd(1)),e.frameCount++,e.isPlay&&(e.playHandler=e.startPlay())}):void 0},r.prototype.updateStartEnd=function(e){var t=this,n=this.tickRects,i=n.length,a=this.unselectedTickStyle,o=this.selectedTickStyle,s=t.endTickRectId;if(e>0?t.endTickRectId++:(n[t.endTickRectId].rect.attr(a),t.endTickRectId--),s!==t.startTickRectId)t.endTickRectId<t.startTickRectId&&(t.startTickRectId=t.endTickRectId);else{for(var u=t.startTickRectId;u<=t.endTickRectId-1;u++)n[u].rect.attr(a);t.startTickRectId=t.endTickRectId}if(n[t.endTickRectId]){n[t.endTickRectId].rect.attr(o);var l=t.startTickRectId/i,f=t.endTickRectId/i;this.graph.emit(Ga,{value:[l,f]})}},r.prototype.destory=function(){this.graph.off(Ga);var e=this.sliceGroup;e.off("click"),e.off("dragstart"),e.off("dragover"),e.off("drop"),this.tickRects.forEach(function(t){var n=t.pickRect;n.off("mouseenter"),n.off("mouseleave")}),this.tickRects.length=0,e.off(jo+":click"),e.off(bc+":click"),e.off(xc+":click"),e.off(Zs),this.sliceGroup.destroy()},r}(),lfe=ufe,ffe=function(){var r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=a[o])},r(t,n)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),uo=function(){return uo=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},uo.apply(this,arguments)},cfe=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t},hfe=4,dfe=26,vfe=function(r){ffe(e,r);function e(t){return r.call(this,t)||this}return e.prototype.getDefaultCfgs=function(){return{container:null,className:"g6-component-timebar",padding:10,type:"trend",trend:{data:[],isArea:!1,smooth:!0},controllerCfg:{speed:1,loop:!1},slider:{start:.1,end:.9,minText:"min",maxText:"max"},tick:{start:.1,end:.9,data:[]},textStyle:{},filterEdge:!1}},e.prototype.initContainer=function(){var t=this.get("graph"),n=this._cfgs,i=n.width,a=n.height,o=this.get("className")||"g6-component-timebar",s=this.get("container"),u=this.get("graph").get("container"),l;s?(Xe(s)&&(s=document.getElementById(s)),l=s):(l=yn("<div class='"+o+"'></div>"),Lr(l,{position:"relative"})),u.appendChild(l),this.set("timeBarContainer",l);var f,c=t.get("renderer");c==="SVG"?f=new Ef({container:l,width:i,height:a}):f=new Ao({container:l,width:i,height:a}),this.set("canvas",f)},e.prototype.init=function(){this.initContainer();var t=this.get("canvas"),n=t.addGroup({name:"timebar-group"});this.set("timeBarGroup",n),this.renderTrend(),this.initEvent();var i=typeof window!="undefined"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif";this.set("fontFamily",i)},e.prototype.renderTrend=function(){var t=this._cfgs,n=t.width,i=t.x,a=t.y,o=t.padding,s=t.type,u=t.trend,l=t.slider,f=t.controllerCfg,c=t.textStyle,h=t.tick,d=t.backgroundStyle,v=t.foregroundStyle,p=u.data,g=cfe(u,["data"]),y=n-2*o,m=s==="trend"?dfe:hfe,b=this.get("graph"),x=this.get("timeBarGroup"),_=this.get("canvas"),S=null;s==="trend"||s==="simple"?S=new nfe(uo(uo({graph:b,canvas:_,group:x,type:s,x:i+o,y:s==="trend"?a+o:a+o+15,width:y,height:m,padding:o,backgroundStyle:d,foregroundStyle:v,trendCfg:uo(uo({},g),{data:p.map(function(E){return E.value})})},l),{tick:{ticks:p,tickLabelFormatter:h.tickLabelFormatter,tickLabelStyle:h.tickLabelStyle,tickLineStyle:h.tickLineStyle},handlerStyle:uo(uo({},l.handlerStyle),{height:l.height||m}),controllerCfg:f,textStyle:c})):s==="tick"&&(S=new lfe(uo({graph:b,canvas:_,group:x,x:i+o,y:a+o},h))),this.set("timebar",S)},e.prototype.filterData=function(t){var n,i=t.value,a=null,o=this._cfgs.type;if(o==="trend"||o==="simple"?a=this._cfgs.trend.data:o==="tick"&&(a=this._cfgs.tick.data),!a||a.length===0){console.warn("\u8BF7\u914D\u7F6E TimeBar \u7EC4\u4EF6\u7684\u6570\u636E");return}var s=this.get("rangeChange"),u=this.get("graph"),l=Math.round(a.length*i[0]),f=Math.round(a.length*i[1]);f=f>=a.length?a.length-1:f,l=l>=a.length?a.length-1:l;var c=(n=this._cfgs.tick)===null||n===void 0?void 0:n.tickLabelFormatter,h=c?c(a[l]):a[l].date,d=c?c(a[f]):a[f].date;if(o!=="tick"){var v=this.get("timebar");v.setText(h,d)}if(s)s(u,h,d);else{(!this.cacheGraphData||this.cacheGraphData.nodes&&this.cacheGraphData.nodes.length===0)&&(this.cacheGraphData=u.get("data"));var p=this.cacheGraphData.nodes.filter(function(m){return m.date>=a[l].date&&m.date<=a[f].date}),g=p.map(function(m){return m.id}),y=[];this.cacheGraphData.edges&&(y=this.cacheGraphData.edges.filter(function(m){return g.includes(m.source)&&g.includes(m.target)}),this.get("filterEdge")&&(y=y.filter(function(m){return m.date>=a[l].date&&m.date<=a[f].date}))),u.changeData({nodes:p,edges:y})}},e.prototype.initEvent=function(){var t=this,n=0,i=0,a=this._cfgs.type;!a||a==="trend"||a==="simple"?(n=this._cfgs.slider.start,i=this._cfgs.slider.end):a==="tick"&&(n=this._cfgs.tick.start,i=this._cfgs.tick.end);var o=this.get("graph");o.on("afterrender",function(s){t.filterData({value:[n,i]})}),o.on(Ga,og(function(s){t.filterData(s)},200,{trailing:!0,leading:!0}))},e.prototype.destroy=function(){var t=this.get("timebar");t&&t.destory&&t.destory(),r.prototype.destroy.call(this);var n=this.get("timeBarContainer");if(n){var i=this.get("container");i||(i=this.get("graph").get("container")),Xe(i)&&(i=document.getElementById(i)),i.removeChild(n)}},e}(Pi),pfe=vfe,gfe=function(){var r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=a[o])},r(t,n)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),yfe=ta.applyMatrix;function mfe(r,e){var t,n;if(r.naturalWidth)t=r.naturalWidth,n=r.naturalHeight;else{var i=new Image;i.src=r.src,i.onload=function(){e&&e(i.width,i.height)}}return[t,n]}var bfe=function(r){gfe(e,r);function e(t){return r.call(this,t)||this}return e.prototype.getDefaultCfgs=function(){return{container:null,className:"g6-minimap",viewportClassName:"g6-minimap-viewport",width:200,delegateStyle:{fill:"#40a9ff",stroke:"#096dd9"},refresh:!0}},e.prototype.getEvents=function(){return{beforepaint:"updateViewport",beforeanimate:"disableRefresh",afteranimate:"enableRefresh",viewportchange:"disableOneRefresh"}},e.prototype.disableRefresh=function(){this.set("refresh",!1)},e.prototype.enableRefresh=function(){this.set("refresh",!0),this.updateCanvas()},e.prototype.disableOneRefresh=function(){this.set("viewportChange",!0)},e.prototype.initViewport=function(){var t=this,n=this._cfgs,i=n.graph;if(!this.destroyed){var a=this.get("container");Xe(a)&&(a=document.getElementById(a));var o=yn("<div class="+n.viewportClassName+`
      style='position:absolute;
        left:0;
        top:0;
        box-sizing:border-box;
        border: 2px solid #1980ff'>
      </div>`),s=0,u=0,l=!1,f=0,c=0,h=0,d=0,v=0,p=0;a.addEventListener("mousedown",function(g){if(n.refresh=!1,g.target===o){var y=o.style;h=parseInt(y.width,10),d=parseInt(y.height,10);var m=t.get("width"),b=t.get("height");h>m||d>b||(p=i.getZoom(),v=t.get("ratio"),l=!0,s=g.clientX,u=g.clientY)}},!1),a.addEventListener("mousemove",function(g){if(!(!l||yt(g.clientX)||yt(g.clientY))){var y=t.get("width"),m=t.get("height"),b=o.style;f=parseInt(b.left,10),c=parseInt(b.top,10),h=parseInt(b.width,10),d=parseInt(b.height,10);var x=s-g.clientX,_=u-g.clientY;f-x<0?x=f:f-x+h>=y&&(x=0),c-_<0?_=c:c-_+d>=m&&(_=0),f-=x,c-=_,Lr(o,{left:f+"px",top:c+"px"}),i.translate(x*p/v,_*p/v),s=g.clientX,u=g.clientY}},!1),a.addEventListener("mouseleave",function(){l=!1,n.refresh=!0},!1),a.addEventListener("mouseup",function(){l=!1,n.refresh=!0},!1),this.set("viewport",o),a.appendChild(o)}},e.prototype.updateViewport=function(){if(!this.destroyed){var t=this.get("ratio"),n=this.get("width"),i=this.get("height"),a=this.get("graph"),o=a.get("width"),s=a.get("height"),u=o/s,l=a.getGroup(),f=l.getCanvasBBox(),c=[(f.minX+f.maxX)/2,(f.minY+f.maxY)/2],h=[f.maxX-f.minX,f.maxY-f.minY],d={centerX:c[0],centerY:c[1],width:0,height:0,minX:0,minY:0};f[0]/f[1]>u?(d.width=h[0],d.height=d.width/u):(d.height=h[1],d.width=d.height*u),d.minX=c[0]-d.width/2,d.minY=c[1]-d.height/2;var v=l.getMatrix();v||(v=[1,0,0,0,1,0,0,0,1]);var p=ug([1,0,0,0,1,0,0,0,1],v),g=yfe({x:d.minX,y:d.minY},p),y=a.getCanvasByPoint(g.x,g.y),m=this.get("viewport");m||this.initViewport();var b=o/d.width,x=b*n,_=b*i,S=n*-y.x/d.width,E=i*-y.y/d.height,C=S+x,M=E+_;S<0&&(x+=S,S=0),C>n&&(x=x-(C-n)),E<0&&(_+=E,E=0),M>i&&(_=_-(M-i)),this.set("ratio",t);var w=S+"px",T=E+"px";Lr(m,{left:w,top:T,width:x+"px",height:_+"px"})}},e.prototype.init=function(){this.initContainer()},e.prototype.initContainer=function(){var t=this,n=t.get("graph"),i=n.get("width"),a=n.get("height"),o=a/i,s=t.get("className"),u=t.get("container"),l=t.get("width"),f=t.get("height");!l&&!f&&(l=200),l?(f=o*l,t.set("height",f)):(l=1/o*f,t.set("width",l));var c=yn("<div class='"+s+"' style='width: "+l+"px; height: "+f+"px; overflow: hidden; position: relative;'></div>");Xe(u)&&(u=document.getElementById(u)),u?u.appendChild(c):n.get("container").appendChild(c),t.set("container",c);var h=yn('<div class="g6-minimap-container" style="position: relative; width: 100%; height: 100%; text-align: center; display: table;"></div>');c.appendChild(h);var d=yn('<span style="display: table-cell; vertical-align: middle; "></span>');h.appendChild(d),t.set("containerDOM",h),t.set("containerSpan",d);var v=yn('<img alt="" src="'+this.get("graphImg")+'" style="display: inline-block; user-select: none;" draggable="false" />');t.set("imgDOM",v),t.updateImgSize(),d.appendChild(v),t.updateCanvas()},e.prototype.updateImgSize=function(){var t=this,n=t.get("imgDOM"),i=t.get("width"),a=t.get("height");n.onload=function(){var o=mfe(n);o[0]>o[1]?n.width=i:n.height=a}},e.prototype.updateCanvas=function(){var t=this.get("refresh");if(!!t){var n=this.get("graph");if(!n.get("destroyed")){this.get("viewportChange")&&(this.set("viewportChange",!1),this.updateViewport());var i=this.get("width"),a=n.get("canvas").getCanvasBBox(),o=a.width,s=i/o;this.set("ratio",s),this.updateViewport()}}},e.prototype.getViewport=function(){return this.get("viewport")},e.prototype.getContainer=function(){return this.get("container")},e.prototype.updateGraphImg=function(t){var n=this,i=n.get("imgDOM");i.remove(),n.set("graphImg",t);var a=yn('<img alt="" src="'+t+'" style="display: inline-block;" ondragstart="return false;" onselectstart="return false;"/>');n.set("imgDOM",a),a.src=t,n.updateImgSize();var o=n.get("containerSpan");o.appendChild(a),n.updateCanvas()},e.prototype.destroy=function(){var t=this.get("container");t.parentNode.removeChild(t)},e}(Pi),xfe=bfe,_fe=function(){var r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=a[o])},r(t,n)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),G0=function(){return G0=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},G0.apply(this,arguments)},wfe=ta.distance,NN=.05,LN={stroke:"#000",strokeOpacity:.8,lineWidth:2,fillOpacity:1,fill:"#fff"},Sfe=function(r){_fe(e,r);function e(t){return r.call(this,t)||this}return e.prototype.getDefaultCfgs=function(){return{type:"both",trigger:"mousemove",r:60,delegateStyle:Cr(LN),showLabel:"edge",scaleRBy:"wheel"}},e.prototype.getEvents=function(){var t;switch(this.get("trigger")){case"click":t={click:"filter"};break;case"drag":t={click:"createDelegate"};break;default:t={mousemove:"filter"};break}return t},e.prototype.init=function(){var t=this,n=t.get("showLabel"),i=n==="node"||n==="both",a=n==="edge"||n==="both";t.set("showNodeLabel",i),t.set("showEdgeLabel",a);var o=t.get("shouldShow");o||t.set("shouldShow",function(){return!0})},e.prototype.createDelegate=function(t){var n=this,i=n.get("delegate");(!i||i.destroyed)&&(n.filter(t),i=n.get("delegate"),i.on("dragstart",function(a){}),i.on("drag",function(a){n.filter(a)}),this.get("scaleRBy")==="wheel"&&i.on("mousewheel",function(a){n.scaleRByWheel(a)}))},e.prototype.scaleRByWheel=function(t){var n=this;if(!(!t||!t.originalEvent)){t.preventDefault&&t.preventDefault();var i=n.get("graph"),a,o=n.get("delegate"),s=o?{x:o.attr("x"),y:o.attr("y")}:void 0;s||i.getPointByClient(t.clientX,t.clientY),t.originalEvent.wheelDelta<0?a=1-NN:a=1/(1-NN);var u=n.get("maxR"),l=n.get("minR"),f=n.get("r");(f>(u||i.get("height"))&&a>1||f<(l||i.get("height")*.05)&&a<1)&&(a=1),f*=a,n.set("r",f),n.filter(t)}},e.prototype.filter=function(t){var n=this,i=n.get("graph"),a=i.getNodes(),o={},s=n.get("r"),u=n.get("type"),l={x:t.x,y:t.y};n.updateDelegate(l,s);var f=n.get("shouldShow"),c=n.get("vShapes");c&&c.forEach(function(y){y.remove(),y.destroy()}),c=[],a.forEach(function(y){var m=y.getModel(),b=m.x,x=m.y;wfe({x:b,y:x},l)<s&&(o[m.id]=y)});var h=i.getEdges(),d=[];h.forEach(function(y){var m=y.getModel(),b=m.source,x=m.target;f(m)&&(u==="only-source"||u==="one"?o[b]&&!o[x]&&d.push(y):u==="only-target"||u==="one"?o[x]&&!o[b]&&d.push(y):u==="both"&&o[b]&&o[x]&&d.push(y))});var v=n.get("showNodeLabel"),p=n.get("showEdgelabel"),g=i.get("group");d.forEach(function(y){var m=y.get("group").get("children");m.forEach(function(b){var x=b.get("type"),_=g.addShape(x,{attrs:b.attr()});c.push(_),v&&x==="text"&&_.set("visible",!0)})}),Object.keys(o).forEach(function(y){var m=o[y],b=m.get("group").clone();if(g.add(b),c.push(b),p)for(var x=b.get("children"),_=0;_<x.length;_++){var S=x[_];S.get("type")==="text"&&S.set("visible",!0)}}),n.set("vShapes",c)},e.prototype.updateParams=function(t){var n=this,i=t.r,a=t.trigger,o=t.minR,s=t.maxR,u=t.scaleRBy,l=t.showLabel,f=t.shouldShow;if(isNaN(t.r)||n.set("r",i),isNaN(s)||n.set("maxR",s),isNaN(o)||n.set("minR",o),(a==="mousemove"||a==="click")&&n.set("trigger",a),u==="wheel"||u==="unset"){n.set("scaleRBy",u),n.get("delegate").remove(),n.get("delegate").destroy();var c=n.get("dPercentText");c&&(c.remove(),c.destroy())}(l==="node"||l==="both")&&n.set("showNodeLabel",!0),(l==="edge"||l==="both")&&n.set("showEdgeLabel",!0),f&&n.set("shouldShow",f)},e.prototype.updateDelegate=function(t,n){var i=this,a=i.get("graph"),o=i.get("delegate");if(!o||o.destroyed){var s=a.get("group"),u=i.get("delegateStyle")||LN;o=s.addShape("circle",{attrs:G0({r:n,x:t.x,y:t.y},u),name:"lens-shape",draggable:!0}),this.get("trigger")!=="drag"&&this.get("scaleRBy")==="wheel"&&o.on("mousewheel",function(l){i.scaleRByWheel(l)})}else o.attr({x:t.x,y:t.y,r:n});i.set("delegate",o)},e.prototype.clear=function(){var t=this,n=t.get("vShapes");n&&n.forEach(function(a){a.remove(),a.destroy()}),n=[],t.set("vShapes",n);var i=t.get("delegate");i&&!i.destroyed&&(i.remove(),i.destroy())},e.prototype.destroy=function(){this.clear()},e}(Pi),Efe=Sfe,Cfe=function(){var r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=a[o])},r(t,n)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Afe=ta.pointLineDistance,Tfe={stroke:"#FA8C16",lineWidth:1},Mfe=function(r){Cfe(e,r);function e(t){return r.call(this,t)||this}return e.prototype.getDefaultCfgs=function(){return{line:Tfe,itemAlignType:"center",tolerance:5,horizontalLines:{},verticalLines:{},alignLines:[]}},e.prototype.init=function(){},e.prototype.getEvents=function(){return{"node:dragstart":"onDragStart","node:drag":"onDrag","node:dragend":"onDragEnd"}},e.prototype.onDragStart=function(){this.initBoxLine()},e.prototype.onDrag=function(t){var n=t.item,i=n.get("delegateShape")||n,a=i.getBBox(),o=n.getModel(),s=o.x-a.x,u=o.y-a.y;this.show({x:a.minX+s,y:a.minY+u},{width:a.width,height:a.height})},e.prototype.onDragEnd=function(){this.destory()},e.prototype.initBoxLine=function(){var t=this._cfgs,n=t.horizontalLines,i=t.verticalLines,a=t.itemAlignType,o=this.get("graph"),s=o.getNodes();s.forEach(function(u){var l=u.getBBox(),f=u.get("id");a===!0||a==="horizontal"?(n[f+"tltr"]=[l.minX,l.minY,l.maxX,l.minY,u],n[f+"lcrc"]=[l.minX,l.centerY,l.maxX,l.centerY,u],n[f+"blbr"]=[l.minX,l.maxY,l.maxX,l.maxY,u]):a==="center"&&(n[f+"lcrc"]=[l.minX,l.centerY,l.maxX,l.centerY,u]),a===!0||a==="vertical"?(i[f+"tlbl"]=[l.minX,l.minY,l.minX,l.maxY,u],i[f+"tcbc"]=[l.centerX,l.minY,l.centerX,l.maxY,u],i[f+"trbr"]=[l.maxX,l.minY,l.maxX,l.maxY,u]):a==="center"&&(i[f+"tcbc"]=[l.centerX,l.minY,l.centerX,l.maxY,u])})},e.prototype.show=function(t,n){var i=St({},t);return this.itemAlign(t,n,i),t},e.prototype.itemAlign=function(t,n,i){var a=this,o=this._cfgs,s=o.horizontalLines,u=o.verticalLines,l=o.tolerance,f={x:i.x+n.width/2,y:i.y},c={x:i.x+n.width/2,y:i.y+n.height/2},h={x:i.x+n.width/2,y:i.y+n.height},d={x:i.x,y:i.y+n.height/2},v={x:i.x+n.width,y:i.y+n.height/2},p=[],g=[],y=null;if(this.clearAlignLine(),xe(s,function(b){b[4].isVisible&&(p.push(a.getLineDisObject(b,f)),p.push(a.getLineDisObject(b,c)),p.push(a.getLineDisObject(b,h)))}),xe(u,function(b){b[4].isVisible&&(g.push(a.getLineDisObject(b,d)),g.push(a.getLineDisObject(b,c)),g.push(a.getLineDisObject(b,v)))}),p.sort(function(b,x){return b.dis-x.dis}),g.sort(function(b,x){return b.dis-x.dis}),p.length!==0&&p[0].dis<l){t.y=p[0].line[1]-p[0].point.y+i.y,y={type:"item",horizontals:[p[0]]};for(var m=1;m<3;m++)p[0].dis===p[m].dis&&y.horizontals.push(p[m])}if(g.length!==0&&g[0].dis<l){t.x=g[0].line[0]-g[0].point.x+i.x,y?y.verticals=[g[0]]:y={type:"item",verticals:[g[0]]};for(var m=1;m<3;m++)g[0].dis===g[m].dis&&y.verticals.push(g[m])}y&&(y.bbox=n,this.addAlignLine(y))},e.prototype.addAlignLine=function(t){var n=t.bbox,i=t.type,a=t.horizontals,o=t.verticals,s=this._cfgs,u=s.line,l=s.alignLines,f=this.get("graph"),c=f.get("group");i==="item"&&(a&&xe(a,function(h){var d=h.line,v=h.point,p=(d[0]+d[2])/2,g,y;v.x<p?(g=v.x-n.width/2,y=Math.max(d[0],d[2])):(g=v.x+n.width/2,y=Math.min(d[0],d[2]));var m=St({x1:g,y1:d[1],x2:y,y2:d[1]},u),b=c.addShape("line",{attrs:m,capture:!1});l.push(b)}),o&&xe(o,function(h){var d=h.line,v=h.point,p=(d[1]+d[3])/2,g,y;v.y<p?(g=v.y-n.height/2,y=Math.max(d[1],d[3])):(g=v.y+n.height/2,y=Math.min(d[1],d[3]));var m=St({x1:d[0],y1:g,x2:d[0],y2:y},u),b=c.addShape("line",{attrs:m,capture:!1});l.push(b)}))},e.prototype.getLineDisObject=function(t,n){return{line:t,point:n,dis:Afe(t,n)}},e.prototype.getContainer=function(){return this.get("container")},e.prototype.clearAlignLine=function(){var t=this._cfgs.alignLines;xe(t,function(n){n.remove()}),t.length=0},e.prototype.destory=function(){var t=this._cfgs,n=t.horizontalLines,i=t.verticalLines,a=this.get("graph"),o=a.getNodes();o.forEach(function(s){var u=s.get("id");delete n[u+"tltr"],delete n[u+"lcrc"],delete n[u+"blbr"],delete i[u+"tlbl"],delete i[u+"tcbc"],delete i[u+"trbr"]}),this.clearAlignLine()},e}(Pi),Ife=Mfe,kfe=function(){var r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=a[o])},r(t,n)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),on=function(){return on=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},on.apply(this,arguments)},Dfe=["click","mouseenter"],Pfe=function(r){kfe(e,r);function e(t){return r.call(this,t)||this}return e.prototype.getDefaultCfgs=function(){return{data:{},position:"top",padding:8,margin:8,offsetX:0,offsetY:0,layout:"horizontal",flipPage:!1,containerStyle:{},align:void 0,horiSep:8,vertiSep:8,filter:{enable:!1,trigger:"click"}}},e.prototype.init=function(){this.formatArray("padding"),this.formatArray("margin");var t=this.get("filter")||{},n=t.multiple;n&&t.trigger==="mouseenter"&&this.set("multiple",!1);var i=this.get("align");if(!i){var a=this.get("position").split("-");a.includes("left")&&(i="left"),a.includes("right")?i="right":i="center",this.set("align",i)}var o=this.get("graph"),s=o.get("container"),u=yn(`<div class='g6-legend-container' style="position: absolute;"></div>`);s.appendChild(u),this.set("container",u);var l=this.render();Lr(u,this.getContainerPos(l)),this.bindEvents()},e.prototype.getContainerPos=function(t){t===void 0&&(t=[0,0]);var n=this,i=n.get("graph"),a=this.get("offsetX"),o=this.get("offsetY"),s=this.get("margin"),u=this.get("position").split("-"),l={top:0,right:1,bottom:2,left:3},f=0,c=0,h={left:(i.getWidth()-t[0])/2+f,top:(i.getHeight()-t[1])/2+c};return u.forEach(function(d){var v=s[l[d]],p=d;switch(d){case"top":v+=c;break;case"left":v+=f;break;case"bottom":v=i.getHeight()-t[1]-v+c,p="top";break;default:v=i.getWidth()-t[0]-v+f,p="left";break}h[p]=v}),h.top+=o+i.getContainer().offsetTop,h.left+=a+i.getContainer().offsetLeft,Object.keys(h).forEach(function(d){h[d]=h[d]+"px"}),h},e.prototype.bindEvents=function(){var t=this,n=t.get("filter");if(!(!n||!n.enable)){var i=n.trigger||"click";Dfe.includes(i)||(console.warn("Trigger for legend filterling must be 'click' or 'mouseenter', 'click' will take effect by default."),i="click");var a=t.get("legendCanvas");i==="mouseenter"?(a.on("node-container:mouseenter",function(o){return t.filterData(o)}),a.on("node-container:mouseleave",function(o){t.clearFilter(),t.clearActiveLegend()})):(a.on("node-container:click",function(o){return t.filterData(o)}),a.on("click",function(o){o.target&&o.target.isCanvas&&o.target.isCanvas()&&(t.clearFilter(),t.clearActiveLegend())}))}},e.prototype.changeData=function(t){this.set("data",t);var n=this.render();Lr(this.get("container"),this.getContainerPos(n))},e.prototype.activateLegend=function(t){var n=this.get("filter"),i=n==null?void 0:n.multiple;i||this.clearActiveLegend();var a=t.get("parent");a.get("active")?(a.set("active",!1),this.findLegendItemsByState("active").length&&a.set("inactive",!0)):(a.set("inactive",!1),a.set("active",!0)),this.findLegendItemsByState("active").length?this.findLegendItemsByState("active","all",!1).forEach(function(c){c.set("inactive",!0)}):this.clearActiveLegend();var o=(n==null?void 0:n.lengedStateStyles)||{},s=(o==null?void 0:o.inactive)||{opacity:.5,"text-shape":{opacity:.5}},u=s["text-shape"]||{};this.findLegendItemsByState("inactive").forEach(function(c){var h=c.get("children"),d=h[0],v=h[1];d.attr(on(on({},d.get("oriAttrs")),s)),v.attr(on(on({},v.get("oriAttrs")),u))});var l=(o==null?void 0:o.active)||{stroke:"#000",lineWidth:2,"text-shape":{fontWeight:"bold"}},f=l["text-shape"]||{};this.findLegendItemsByState("active").forEach(function(c){var h=c.get("children"),d=h[0],v=h[1];d.attr(on(on({},d.get("oriAttrs")),l)),v.attr(on(on({},v.get("oriAttrs")),f))})},e.prototype.findLegendItemsByState=function(t,n,i){n===void 0&&(n="all"),i===void 0&&(i=!0);var a=this.get("legendCanvas").find(function(u){return u.get("name")==="root"}),o=a.find(function(u){return u.get("name")==="node-group"}),s=a.find(function(u){return u.get("name")==="edge-group"});return n==="node"?o.get("children").filter(function(u){return!!u.get(t)===i}):n==="edge"?s.get("children").filter(function(u){return!!u.get(t)===i}):o.get("children").filter(function(u){return!!u.get(t)===i}).concat(s.get("children").filter(function(u){return!!u.get(t)===i}))},e.prototype.clearActiveLegend=function(){var t=this.get("legendCanvas"),n=t.find(function(a){return a.get("name")==="root"}),i=[n.find(function(a){return a.get("name")==="node-group"}),n.find(function(a){return a.get("name")==="edge-group"})];i.forEach(function(a){a.get("children").forEach(function(o){o.set("active",!1),o.set("inactive",!1);var s=o.get("children"),u=s[0],l=s[1];u.attr(u.get("oriAttrs")),l.attr(l.get("oriAttrs"))})})},e.prototype.filterData=function(t){var n=this.get("filter"),i=n==null?void 0:n.filterFunctions;if(!(!n||!i)){var a=this.get("legendCanvas"),o=this.get("graph"),s=n.graphActiveState||"active",u=n.graphInactiveState||"inactive",l=n.multiple;this.clearFilter(),l||this.clearActiveLegend(),this.activateLegend(t.target);var f=a.find(function(y){return y.get("name")==="root"}),c=f.find(function(y){return y.get("name")==="node-group"}),h=f.find(function(y){return y.get("name")==="edge-group"}),d=c.get("children").filter(function(y){return y.get("active")}),v=h.get("children").filter(function(y){return y.get("active")}),p=0,g=["getNodes","getEdges"];g.forEach(function(y){o[y]().forEach(function(m){var b=!1,x=y==="getNodes"?d:v;x.forEach(function(_){var S=i[_.get("id")];b=b||S(m.getModel())}),b?(o.setItemState(m,u,!1),o.setItemState(m,s,!0),p++):(o.setItemState(m,s,!1),o.setItemState(m,u,!0))})}),p||g.forEach(function(y){o[y]().forEach(function(m){o.clearItemStates(m,[u])})})}},e.prototype.clearFilter=function(){var t=this.get("graph"),n=this.get("filter");if(!!n){var i=n.graphActiveState||"active",a=n.graphInactiveState||"inactive";t.getNodes().forEach(function(o){t.clearItemStates(o,[i,a])}),t.getEdges().forEach(function(o){t.clearItemStates(o,[i,a])})}},e.prototype.render=function(){var t=this;this.processData();var n=this.get("legendCanvas");if(!n){n=new Ao({container:this.get("container"),width:200,height:200});var i=n.addGroup({name:"root"});i.addGroup({name:"node-group"}),i.addGroup({name:"edge-group"}),this.set("legendCanvas",n)}var a=n.find(function(K){return K.get("name")==="root"}),o=a.find(function(K){return K.get("name")==="node-group"}),s=a.find(function(K){return K.get("name")==="edge-group"}),u=this.get("itemsData"),l=["nodes","edges"],f=[o,s];l.forEach(function(K,le){u[K].forEach(function(he){var te,se=f[le].addGroup({id:he.id,name:"node-container"}),ge,Se=he.type,ne=t.getShapeSize(he),pe=ne.width,Ge=ne.height,ke=ne.r,rt=t.getStyle(K.substr(0,4),he);switch(he.type){case"circle":ge={r:ke,x:0,y:0};break;case"rect":ge={width:pe,height:Ge,x:-pe/2,y:-Ge/2};break;case"ellipse":ge={r1:pe,r2:Ge,x:0,y:0};break;case"line":ge={x1:-pe/2,y1:0,x2:pe/2,y2:0},Se="line";break;case"quadratic":ge={path:[["M",-pe/2,0],["Q",0,pe/2,pe/2,0]]},Se="path";break;case"cubic":ge={path:[["M",-pe/2,0],["C",-pe/6,pe/2,pe/6,-pe/2,pe/2,0]]},Se="path";break;default:ge={r:ke,x:0,y:0};break}var $e=se.addShape(Se,{attrs:on(on({},ge),rt),name:he.type+"-node-keyShape",oriAttrs:on({opacity:1},rt)});if(he.label){var ut=$e.getBBox(),pt=((te=he.labelCfg)===null||te===void 0?void 0:te.style)||{},qt=on({textAlign:"begin",fontSize:12,textBaseline:"middle",fill:"#000",opacity:1,fontWeight:"normal"},pt);se.addShape("text",{attrs:on({x:ut.maxX+4,y:0,text:he.label},qt),className:"legend-label",name:he.type+"-node-text",oriAttrs:qt})}})});var c=this.get("padding"),h,d=a.find(function(K){return K.get("name")==="title-container"}),v={height:0,maxY:0,width:0};if(this.get("title")){d||(d=a.addGroup({name:"title-container"}));var p={fontSize:20,fontFamily:"Arial",fontWeight:300,textBaseline:"top",textAlign:"center",fill:"#000",x:0,y:c[0]},g=this.get("titleConfig")||{},y=Object.assign(p,g.style||{});h=d.addShape("text",{attrs:on({text:this.get("title")},y)}),v=d.getCanvasBBox(),d.setMatrix([1,0,0,0,1,0,g.offsetX,g.offsetY,1])}this.layoutItems();var m=a.getCanvasBBox(),b=o.getCanvasBBox(),x=b.minX<0?Math.abs(b.minX)+c[3]:c[3],_=v.maxY<b.minY?Math.abs(v.maxY-b.minY)+c[0]:v.maxY+c[0],S=[1,0,0,0,1,0,x,_,1];o.setMatrix(S),m=a.getCanvasBBox();var E=[m.minX+m.width+c[1],m.minY+m.height+c[2]];if(h){var g=on({position:"center",offsetX:0,offsetY:0},this.get("titleConfig"));v=d.getCanvasBBox();var C=d.getMatrix()||[1,0,0,0,1,0,0,0,1];g.position==="center"?C[6]=E[0]/2+g.offsetX:g.position==="right"?(C[6]=E[0]-c[3]+g.offsetX,h.attr({textAlign:"right"})):(C[6]=c[3]+g.offsetX,h.attr({textAlign:"left"})),d.setMatrix(C),v=d.getCanvasBBox(),x=b.minX<0?Math.abs(b.minX)+c[3]:c[3],_=b.minY<v.maxY?Math.abs(v.maxY-b.minY)+c[0]:v.maxY+c[0],S=[1,0,0,0,1,0,x,_,1],o.setMatrix(S);var M=[1,0,0,0,1,0,x,_,1];this.get("layout")==="vertical"?M[6]+=b.maxX+this.get("horiSep"):M[7]+=b.maxY+this.get("vertiSep"),s.setMatrix(M)}else{b=o.getCanvasBBox();var w=[1,0,0,0,1,0,0,0,1];this.get("layout")==="vertical"?w[6]+=S[6]+b.maxX+this.get("horiSep"):w[7]+=S[7]+b.maxY+this.get("vertiSep"),s.setMatrix(w)}m=a.getCanvasBBox(),b=o.getCanvasBBox(),S=o.getMatrix()||[1,0,0,0,1,0,0,0,1];var T=s.getMatrix()||[1,0,0,0,1,0,0,0,1],I=s.getCanvasBBox();E=[Math.max(b.width+S[6],I.width+T[6])+c[1],Math.max(b.height+S[7],I.height+T[7])+c[2]],n.changeSize(E[0],E[1]);var k=this.get("containerStyle"),O=a.getMatrix()||[1,0,0,0,1,0,0,0,1],U=ta.invertMatrix({x:0,y:0},O),q=a.addShape("rect",{attrs:on({x:U.x+(k.lineWidth||1),y:U.y+(k.lineWidth||1),width:E[0]-2*(k.lineWidth||1),height:E[1]-2*(k.lineWidth||1),fill:"#f00",stroke:"#000",lineWidth:1,opacity:.5},k),name:"legend-back-rect",capture:!1});return q.toBack(),E},e.prototype.layoutItems=function(){var t=this.get("legendCanvas"),n=this.get("horiSep"),i=this.get("vertiSep"),a=this.get("layout"),o=this.get("align"),s=[0,0],u=t.find(function(b){return b.get("name")==="root"}),l=u.find(function(b){return b.get("name")==="node-group"}),f=u.find(function(b){return b.get("name")==="edge-group"}),c={min:0,max:-1/0};l.get("children").forEach(function(b,x){x===0&&(c.min=s[0]);var _=b.get("children")[0],S=b.getCanvasBBox(),E=_.getBBox(),C=E.width,M=E.height,w=0,T=0;a==="vertical"?(w=s[1],T=s[0]+C/2,s[0]=T+S.height+i,S.maxX+w+C/2):(w=s[0]+C/2,T=s[1],s[0]=w+S.width+n,S.maxY+T+M/2),s[0]>c.max&&(c.max=s[0]),b.setMatrix([1,0,0,0,1,0,w,T,1])});var h=c.max-c.min,d={min:0,max:-1/0},v=l.getCanvasBBox();s[0]=0,s[1]=a==="vertical"?v.maxX+n:v.maxY+i,f.get("children").forEach(function(b,x){x===0&&(d.min=s[0]);var _=b.get("children")[0],S=b.getCanvasBBox(),E=_.getBBox(),C=E.width,M=E.height,w=0,T=0;a==="vertical"?(w=s[1],T=s[0],s[0]=T+S.height+i,b.setMatrix([1,0,0,0,1,0,0,T+M/2,1])):(w=s[0],T=s[1],s[0]=w+S.width+n,b.setMatrix([1,0,0,0,1,0,w+C/2,0,1])),s[0]>d.max&&(d.max=s[0])});var p=d.max-d.min;if(o&&o!==""&&o!=="left"){var g=h-p,y=o==="center"?Math.abs(g)/2:Math.abs(g),m=g<0?l:f;m.get("children").forEach(function(b){var x=b.getMatrix()||[1,0,0,0,1,0,0,0,1];a==="vertical"?x[7]+=y:x[6]+=y,b.setMatrix(x)})}},e.prototype.processData=function(){var t=this.get("data"),n={nodes:[],edges:[]};t.nodes&&(t.nodes.sort(function(i,a){return i.order-a.order}),t.nodes.forEach(function(i){var a,o,s,u,l,f=i.size||[((a=i.style)===null||a===void 0?void 0:a.width)||((o=i.style)===null||o===void 0?void 0:o.r)||8,((s=i.style)===null||s===void 0?void 0:s.height)||((u=i.style)===null||u===void 0?void 0:u.r)||8],c=((l=i.labelCfg)===null||l===void 0?void 0:l.style)||{};n.nodes.push({id:i.id||wa(),type:i.type||"circle",style:on({},i.style),order:i.order,label:i.label,itemType:"node",size:f,labelCfg:{position:"right",style:on({fontFamily:"Arial"},c)}})})),t.edges&&(t.edges.sort(function(i,a){return i.order-a.order}),t.edges.forEach(function(i){var a,o,s=i.type||"line";i.type==="cubic-horizontal"&&(s="cubic");var u=((a=i.labelCfg)===null||a===void 0?void 0:a.style)||{},l=i.size||[((o=i.style)===null||o===void 0?void 0:o.width)||8,1];n.edges.push({id:i.id||wa(),type:s,size:l,style:on({lineWidth:At(l)?l[1]:1},i.style),order:i.order,label:i.label,itemType:"edge",labelCfg:{position:"right",style:on({fontFamily:"Arial"},u)}})})),this.set("itemsData",n)},e.prototype.getContainer=function(){return this.get("container")},e.prototype.formatArray=function(t){var n=this.get(t);if(Lt(n))this.set(t,[n,n,n,n]);else if(At(n))switch(n.length){case 0:this.set(t,[0,0,0,0]);break;case 1:this.set(t,[n[0],n[0],n[0],n[0]]);break;case 2:this.set(t,[n[0],n[1],n[0],n[1]]);break;case 3:this.set(t,[n[0],n[1],n[2],n[1]]);break}return this.get(t)},e.prototype.getShapeSize=function(t){var n,i,a;return t.size&&(At(t.size)?(n=t.size[0],i=t.size[1]||t.size[0],a=t.size[0]/2):Lt(t.size)&&(n=t.size,i=t.size,a=t.size/2)),t.style&&(t.style.width&&(n=t.style.width),t.style.height&&(i=t.style.height),t.style.r&&(a=t.style.r)),a||(a=5),n||(n=a),i||(i=a),{width:n,height:i,r:a}},e.prototype.getStyle=function(t,n){var i=t==="node"?{fill:"#ccc",lineWidth:0}:{stroke:"#000",lineWidth:1};return on(on({},i),n.style||{})},e.prototype.destroy=function(){var t=this.get("graph"),n=t.get("container"),i=this.get("container");n.removeChild(i)},e}(Pi),Nfe=Pfe,Lfe={PluginBase:Pi,Menu:fue,Grid:iue,Minimap:yue,Bundling:_ue,ToolBar:Mue,Tooltip:Due,Fisheye:Eue,TimeBar:pfe,ImageMinimap:xfe,EdgeFilterLens:Efe,SnapLine:Ife,Legend:Nfe},Ln=Lfe;Ha("circle",{options:{size:lt.defaultNode.size,style:{x:0,y:0,stroke:lt.defaultNode.style.stroke,fill:lt.defaultNode.style.fill,lineWidth:lt.defaultNode.style.lineWidth},labelCfg:{style:{fill:lt.nodeLabel.style.fill,fontSize:lt.nodeLabel.style.fontSize}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:lt.defaultNode.linkPoints.size,lineWidth:lt.defaultNode.linkPoints.lineWidth,fill:lt.defaultNode.linkPoints.fill,stroke:lt.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:L({},lt.nodeStateStyles)},shapeType:"circle",labelPosition:"center",drawShape:function(e,t){var n=this.getOptions(e).icon,i=n===void 0?{}:n,a=this.getShapeStyle(e),o=Hr({},i,e.icon),s=t.addShape("circle",{attrs:a,className:this.type+"-keyShape",draggable:!0}),u=o.width,l=o.height,f=o.show,c=o.text;return f&&(c?t.addShape("text",{attrs:L({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},o),className:this.type+"-icon",name:this.type+"-icon",draggable:!0}):t.addShape("image",{attrs:L({x:-u/2,y:-l/2},o),className:this.type+"-icon",name:this.type+"-icon",draggable:!0})),this.drawLinkPoints(e,t),s},drawLinkPoints:function(e,t){var n=this.getOptions(e).linkPoints,i=n===void 0?{}:n,a=i.top,o=i.left,s=i.right,u=i.bottom,l=i.size,f=i.r,c=ti(i,["top","left","right","bottom","size","r"]),h=this.getSize(e),d=h[0]/2;o&&t.addShape("circle",{attrs:L(L({},c),{x:-d,y:0,r:l/2||f||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0}),s&&t.addShape("circle",{attrs:L(L({},c),{x:d,y:0,r:l/2||f||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0}),a&&t.addShape("circle",{attrs:L(L({},c),{x:0,y:-d,r:l/2||f||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0}),u&&t.addShape("circle",{attrs:L(L({},c),{x:0,y:d,r:l/2||f||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0})},getShapeStyle:function(e){var t=this.getOptions(e).style,n={stroke:e.color},i=Hr({},t,n),a=this.getSize(e),o=a[0]/2,s=L({x:0,y:0,r:o},i);return s},update:function(e,t){var n=t.getContainer(),i=this.getSize(e),a={stroke:e.color,r:i[0]/2},o=t.get("keyShape"),s=Hr({},o.attr(),a,e.style);this.updateShape(e,t,s,!0),this.updateLinkPoints(e,n)}},"single-node");Ha("rect",{options:{size:[100,30],style:{radius:0,stroke:lt.defaultNode.style.stroke,fill:lt.defaultNode.style.fill,lineWidth:lt.defaultNode.style.lineWidth},labelCfg:{style:{fill:lt.nodeLabel.style.fill,fontSize:lt.nodeLabel.style.fontSize}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:lt.defaultNode.linkPoints.size,lineWidth:lt.defaultNode.linkPoints.lineWidth,fill:lt.defaultNode.linkPoints.fill,stroke:lt.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},anchorPoints:[[0,.5],[1,.5]],stateStyles:L({},lt.nodeStateStyles)},shapeType:"rect",labelPosition:"center",drawShape:function(e,t){var n=this.getShapeStyle(e),i=t.addShape("rect",{attrs:n,className:this.type+"-keyShape",name:this.type+"-keyShape",draggable:!0});return this.drawLinkPoints(e,t),i},drawLinkPoints:function(e,t){var n=this.getOptions(e).linkPoints,i=n===void 0?{}:n,a=i.top,o=i.left,s=i.right,u=i.bottom,l=i.size,f=i.r,c=ti(i,["top","left","right","bottom","size","r"]),h=this.getSize(e),d=h[0],v=h[1];o&&t.addShape("circle",{attrs:L(L({},c),{x:-d/2,y:0,r:l/2||f||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0}),s&&t.addShape("circle",{attrs:L(L({},c),{x:d/2,y:0,r:l/2||f||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0}),a&&t.addShape("circle",{attrs:L(L({},c),{x:0,y:-v/2,r:l/2||f||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0}),u&&t.addShape("circle",{attrs:L(L({},c),{x:0,y:v/2,r:l/2||f||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0})},getShapeStyle:function(e){var t=this.getOptions(e).style,n={stroke:e.color},i=St({},t,n),a=this.getSize(e),o=i.width||a[0],s=i.height||a[1],u=L({x:-o/2,y:-s/2,width:o,height:s},i);return u},update:function(e,t){var n=t.getContainer(),i=this.getOptions({}).style,a=this.getSize(e),o=t.get("keyShape");e.size||(a[0]=o.attr("width")||i.width,a[1]=o.attr("height")||i.height);var s={stroke:e.color,x:-a[0]/2,y:-a[1]/2,width:a[0],height:a[1]},u=St({},i,o.attr(),s);u=St(u,e.style),this.updateShape(e,t,u,!1),this.updateLinkPoints(e,n)}},"single-node");Ha("ellipse",{options:{size:[80,40],style:{x:0,y:0,stroke:lt.defaultNode.style.stroke,fill:lt.defaultNode.style.fill,lineWidth:lt.defaultNode.style.lineWidth},labelCfg:{style:{fill:lt.nodeLabel.style.fill,fontSize:lt.nodeLabel.style.fontSize}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:lt.defaultNode.linkPoints.size,lineWidth:lt.defaultNode.linkPoints.lineWidth,fill:lt.defaultNode.linkPoints.fill,stroke:lt.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:L({},lt.nodeStateStyles)},shapeType:"ellipse",labelPosition:"center",drawShape:function(e,t){var n=this.getOptions(e).icon,i=n===void 0?{}:n,a=this.getShapeStyle(e),o=t.addShape("ellipse",{attrs:a,className:"ellipse-keyShape",name:"ellipse-keyShape",draggable:!0}),s=i.width,u=i.height,l=i.show,f=i.text;return l&&(f?t.addShape("text",{attrs:L({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},i),className:this.type+"-icon",name:this.type+"-icon",draggable:!0}):t.addShape("image",{attrs:L({x:-s/2,y:-u/2},i),className:this.type+"-icon",name:this.type+"-icon",draggable:!0})),this.drawLinkPoints(e,t),o},drawLinkPoints:function(e,t){var n=this.getOptions(e).linkPoints,i=n===void 0?{}:n,a=i.top,o=i.left,s=i.right,u=i.bottom,l=i.size,f=i.r,c=ti(i,["top","left","right","bottom","size","r"]),h=this.getSize(e),d=h[0]/2,v=h[1]/2;o&&t.addShape("circle",{attrs:L(L({},c),{x:-d,y:0,r:l/2||f||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0}),s&&t.addShape("circle",{attrs:L(L({},c),{x:d,y:0,r:l/2||f||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0}),a&&t.addShape("circle",{attrs:L(L({},c),{x:0,y:-v,r:l/2||f||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0}),u&&t.addShape("circle",{attrs:L(L({},c),{x:0,y:v,r:l/2||f||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0})},getShapeStyle:function(e){var t=this.getOptions(e).style,n={stroke:e.color},i=St({},t,n),a=this.getSize(e),o=a[0]/2,s=a[1]/2,u=L({x:0,y:0,rx:o,ry:s},i);return u},update:function(e,t){var n=t.getContainer(),i=this.getOptions({}).style,a=this.getSize(e),o={stroke:e.color,rx:a[0]/2,ry:a[1]/2},s=t.get("keyShape"),u=St({},i,s.attr(),o);u=St(u,e.style),this.updateShape(e,t,u,!0),this.updateLinkPoints(e,n)}},"single-node");Ha("diamond",{options:{size:[80,80],style:{stroke:lt.defaultNode.style.stroke,fill:lt.defaultNode.style.fill,lineWidth:lt.defaultNode.style.lineWidth},labelCfg:{style:{fill:lt.nodeLabel.style.fill,fontSize:lt.nodeLabel.style.fontSize}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:lt.defaultNode.linkPoints.size,lineWidth:lt.defaultNode.linkPoints.lineWidth,fill:lt.defaultNode.linkPoints.fill,stroke:lt.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:L({},lt.nodeStateStyles)},shapeType:"diamond",labelPosition:"center",drawShape:function(e,t){var n=this.getOptions(e).icon,i=n===void 0?{}:n,a=this.getShapeStyle(e),o=t.addShape("path",{attrs:a,className:this.type+"-keyShape",name:this.type+"-keyShape",draggable:!0}),s=i.width,u=i.height,l=i.show,f=i.text;return l&&(f?t.addShape("text",{attrs:L({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},i),className:this.type+"-icon",name:this.type+"-icon",draggable:!0}):t.addShape("image",{attrs:L({x:-s/2,y:-u/2},i),className:this.type+"-icon",name:this.type+"-icon",draggable:!0})),this.drawLinkPoints(e,t),o},drawLinkPoints:function(e,t){var n=this.getOptions(e).linkPoints,i=n===void 0?{}:n,a=i.top,o=i.left,s=i.right,u=i.bottom,l=i.size,f=i.r,c=ti(i,["top","left","right","bottom","size","r"]),h=this.getSize(e),d=h[0],v=h[1];o&&t.addShape("circle",{attrs:L(L({},c),{x:-d/2,y:0,r:l/2||f||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0}),s&&t.addShape("circle",{attrs:L(L({},c),{x:d/2,y:0,r:l/2||f||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0}),a&&t.addShape("circle",{attrs:L(L({},c),{x:0,y:-v/2,r:l/2||f||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0}),u&&t.addShape("circle",{attrs:L(L({},c),{x:0,y:v/2,r:l/2||f||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0})},getPath:function(e){var t=this.getSize(e),n=t[0],i=t[1],a=[["M",0,-i/2],["L",n/2,0],["L",0,i/2],["L",-n/2,0],["Z"]];return a},getShapeStyle:function(e){var t=this.getOptions(e).style,n={stroke:e.color},i=St({},t,n),a=this.getPath(e),o=L({path:a},i);return o},update:function(e,t){var n=t.getContainer(),i=this.getOptions({}).style,a=this.getPath(e),o={stroke:e.color,path:a},s=t.get("keyShape"),u=St({},i,s.attr(),o);u=St(u,e.style),this.updateShape(e,t,u,!0),this.updateLinkPoints(e,n)}},"single-node");Ha("triangle",{options:{size:40,direction:"up",style:{stroke:lt.defaultNode.style.stroke,fill:lt.defaultNode.style.fill,lineWidth:lt.defaultNode.style.lineWidth},labelCfg:{style:{fill:lt.nodeLabel.style.fill,fontSize:lt.nodeLabel.style.fontSize},offset:15},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:lt.defaultNode.linkPoints.size,lineWidth:lt.defaultNode.linkPoints.lineWidth,fill:lt.defaultNode.linkPoints.fill,stroke:lt.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20,offset:6},stateStyles:L({},lt.nodeStateStyles)},shapeType:"triangle",labelPosition:"bottom",drawShape:function(e,t){var n=this.getOptions(e),i=n.icon,a=i===void 0?{}:i,o=n.direction,s=this.getShapeStyle(e),u=e.direction||o,l=t.addShape("path",{attrs:s,className:this.type+"-keyShape",name:this.type+"-keyShape",draggable:!0}),f=a.width,c=a.height,h=a.show,d=a.offset,v=a.text;if(h)if(v)t.addShape("text",{attrs:L({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},a),className:this.type+"-icon",name:this.type+"-icon",draggable:!0});else{var p=-f/2,g=-c/2;(u==="up"||u==="down")&&(g+=d),(u==="left"||u==="right")&&(p+=d),t.addShape("image",{attrs:L({x:p,y:g},a),className:this.type+"-icon",name:this.type+"-icon",draggable:!0})}return this.drawLinkPoints(e,t),l},drawLinkPoints:function(e,t){var n=this.getOptions(e),i=n.linkPoints,a=i===void 0?{}:i,o=n.direction,s=e.direction||o,u=a.top,l=a.left,f=a.right,c=a.bottom,h=a.size,d=a.r,v=ti(a,["top","left","right","bottom","size","r"]),p=this.getSize(e),g=p[0];if(l){var y=null,m=g*Math.sin(1/3*Math.PI),b=g*Math.sin(1/3*Math.PI);s==="up"?y=[-b,m]:s==="down"?y=[-b,-m]:s==="left"&&(y=[-b,b-m]),y&&t.addShape("circle",{attrs:L(L({},v),{x:y[0],y:y[1],r:h/2||d||5}),className:"link-point-left",name:"link-point-left"})}if(f){var x=null,m=g*Math.sin(1/3*Math.PI),b=g*Math.sin(1/3*Math.PI);s==="up"?x=[b,m]:s==="down"?x=[b,-m]:s==="right"&&(x=[b,b-m]),x&&t.addShape("circle",{attrs:L(L({},v),{x:x[0],y:x[1],r:h/2||d||5}),className:"link-point-right",name:"link-point-right"})}if(u){var _=null,m=g*Math.sin(1/3*Math.PI),b=g*Math.sin(1/3*Math.PI);s==="up"?_=[b-m,-m]:s==="left"?_=[b,-m]:s==="right"&&(_=[-b,-m]),_&&t.addShape("circle",{attrs:L(L({},v),{x:_[0],y:_[1],r:h/2||d||5}),className:"link-point-top",name:"link-point-top"})}if(c){var S=null,m=g*Math.sin(1/3*Math.PI),b=g*Math.sin(1/3*Math.PI);s==="down"?S=[-b+m,m]:s==="left"?S=[b,m]:s==="right"&&(S=[-b,m]),S&&t.addShape("circle",{attrs:L(L({},v),{x:S[0],y:S[1],r:h/2||d||5}),className:"link-point-bottom",name:"link-point-bottom"})}},getPath:function(e){var t=this.getOptions(e).direction,n=e.direction||t,i=this.getSize(e),a=i[0],o=a*Math.sin(1/3*Math.PI),s=a*Math.sin(1/3*Math.PI),u=[["M",-s,o],["L",0,-o],["L",s,o],["Z"]];return n==="down"?u=[["M",-s,-o],["L",s,-o],["L",0,o],["Z"]]:n==="left"?u=[["M",-s,s-o],["L",s,-s],["L",s,s],["Z"]]:n==="right"&&(u=[["M",s,s-o],["L",-s,s],["L",-s,-s],["Z"]]),u},getShapeStyle:function(e){var t=this.getOptions(e).style,n={stroke:e.color},i=St({},t,n),a=this.getPath(e),o=L({path:a},i);return o},update:function(e,t){var n=t.getContainer(),i=this.getOptions({}).style,a=this.getPath(e),o={stroke:e.color,path:a},s=t.get("keyShape"),u=St({},i,s.attr(),o);u=St(u,e.style),this.updateShape(e,t,u,!0),this.updateLinkPoints(e,n)},updateLinkPoints:function(e,t){var n=this.getOptions({}),i=n.linkPoints,a=n.direction,o=e.direction||a,s=t.find(function(q){return q.get("className")==="link-point-left"}),u=t.find(function(q){return q.get("className")==="link-point-right"}),l=t.find(function(q){return q.get("className")==="link-point-top"}),f=t.find(function(q){return q.get("className")==="link-point-bottom"}),c=i,h=s||u||l||f;h&&(c=h.attr());var d=St({},c,e.linkPoints),v=d.fill,p=d.stroke,g=d.lineWidth,y=d.size/2;y||(y=d.r);var m=e.linkPoints?e.linkPoints:{left:void 0,right:void 0,top:void 0,bottom:void 0},b=m.left,x=m.right,_=m.top,S=m.bottom,E=this.getSize(e),C=E[0],M={r:y,fill:v,stroke:p,lineWidth:g},w=null,T=C*Math.sin(1/3*Math.PI),I=C*Math.sin(1/3*Math.PI);o==="up"?w=[-I,T]:o==="down"?w=[-I,-T]:o==="left"&&(w=[-I,I-T]),w&&(s?!b&&b!==void 0?s.remove():s.attr(L(L({},M),{x:w[0],y:w[1]})):b&&t.addShape("circle",{attrs:L(L({},M),{x:w[0],y:w[1]}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0}));var k=null;o==="up"?k=[I,T]:o==="down"?k=[I,-T]:o==="right"&&(k=[I,I-T]),k&&(u?!x&&x!==void 0?u.remove():u.attr(L(L({},M),{x:k[0],y:k[1]})):x&&t.addShape("circle",{attrs:L(L({},M),{x:k[0],y:k[1]}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0}));var O=null;o==="up"?O=[I-T,-T]:o==="left"?O=[I,-T]:o==="right"&&(O=[-I,-T]),O&&(l?!_&&_!==void 0?l.remove():l.attr(L(L({},M),{x:O[0],y:O[1]})):_&&t.addShape("circle",{attrs:L(L({},M),{x:O[0],y:O[1]}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0}));var U=null;o==="down"?U=[-I+T,T]:o==="left"?U=[I,T]:o==="right"&&(U=[-I,T]),U&&(f?!S&&S!==void 0?f.remove():f.attr(L(L({},M),{x:U[0],y:U[1]})):S&&t.addShape("circle",{attrs:L(L({},M),{x:U[0],y:U[1]}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))}},"single-node");Ha("modelRect",{options:{size:[185,70],style:{radius:5,stroke:"#69c0ff",fill:"#ffffff",lineWidth:lt.defaultNode.style.lineWidth,fillOpacity:1},labelCfg:{style:{fill:"#595959",fontSize:14},offset:30},descriptionCfg:{style:{fontSize:12,fill:"#bfbfbf"},paddingTop:0},preRect:{show:!0,width:4,fill:"#40a9ff",radius:2},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:10,lineWidth:1,fill:"#72CC4A",stroke:"#72CC4A"},logoIcon:{show:!0,x:0,y:0,img:"https://gw.alipayobjects.com/zos/basement_prod/4f81893c-1806-4de4-aff3-9a6b266bc8a2.svg",width:16,height:16,offset:0},stateIcon:{show:!0,x:0,y:0,img:"https://gw.alipayobjects.com/zos/basement_prod/300a2523-67e0-4cbf-9d4a-67c077b40395.svg",width:16,height:16,offset:-5},anchorPoints:[[0,.5],[1,.5]]},shapeType:"modelRect",drawShape:function(e,t){var n=this.getOptions(e).preRect,i=n===void 0?{}:n,a=this.getShapeStyle(e),o=this.getSize(e),s=o[0],u=o[1],l=t.addShape("rect",{attrs:a,className:this.type+"-keyShape",name:this.type+"-keyShape",draggable:!0}),f=i.show,c=ti(i,["show"]);return f&&t.addShape("rect",{attrs:L({x:-s/2,y:-u/2,height:u},c),className:"pre-rect",name:"pre-rect",draggable:!0}),this.drawLogoIcon(e,t),this.drawStateIcon(e,t),this.drawLinkPoints(e,t),l},drawLogoIcon:function(e,t){var n=this.getOptions(e).logoIcon,i=n===void 0?{}:n,a=this.getSize(e),o=a[0];if(i.show){var s=i.width,u=i.height,l=i.x,f=i.y,c=i.offset,h=i.text,d=ti(i,["width","height","x","y","offset","text"]);h?t.addShape("text",{attrs:L({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},d),className:"rect-logo-icon",name:"rect-logo-icon",draggable:!0}):t.addShape("image",{attrs:L(L({},d),{x:l||-o/2+s+c,y:f||-u/2,width:s,height:u}),className:"rect-logo-icon",name:"rect-logo-icon",draggable:!0})}},drawStateIcon:function(e,t){var n=this.getOptions(e).stateIcon,i=n===void 0?{}:n,a=this.getSize(e),o=a[0];if(i.show){var s=i.width,u=i.height,l=i.x,f=i.y,c=i.offset,h=i.text,d=ti(i,["width","height","x","y","offset","text"]);h?t.addShape("text",{attrs:L({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},d),className:"rect-state-icon",name:"rect-state-icon",draggable:!0}):t.addShape("image",{attrs:L(L({},d),{x:l||o/2-s+c,y:f||-u/2,width:s,height:u}),className:"rect-state-icon",name:"rect-state-icon",draggable:!0})}},drawLinkPoints:function(e,t){var n=this.getOptions(e).linkPoints,i=n===void 0?{}:n,a=i.top,o=i.left,s=i.right,u=i.bottom,l=i.size,f=i.r,c=ti(i,["top","left","right","bottom","size","r"]),h=this.getSize(e),d=h[0],v=h[1];o&&t.addShape("circle",{attrs:L(L({},c),{x:-d/2,y:0,r:l/2||f||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0}),s&&t.addShape("circle",{attrs:L(L({},c),{x:d/2,y:0,r:l/2||f||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0}),a&&t.addShape("circle",{attrs:L(L({},c),{x:0,y:-v/2,r:l/2||f||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0}),u&&t.addShape("circle",{attrs:L(L({},c),{x:0,y:v/2,r:l/2||f||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0})},drawLabel:function(e,t){var n=this.getOptions(e),i=n.labelCfg,a=i===void 0?{}:i,o=n.logoIcon,s=o===void 0?{}:o,u=n.descriptionCfg,l=u===void 0?{}:u,f=this.getSize(e),c=f[0],h=null,d=s.show,v=s.width,p=-c/2+a.offset;d&&(p=-c/2+v+a.offset);var g=a.style,y=l.style,m=l.paddingTop;return Xe(e.description)?(h=t.addShape("text",{attrs:L(L({},g),{x:p,y:-5,text:e.label}),className:"text-shape",name:"text-shape",draggable:!0}),t.addShape("text",{attrs:L(L({},y),{x:p,y:17+(m||0),text:e.description}),className:"rect-description",name:"rect-description",draggable:!0})):h=t.addShape("text",{attrs:L(L({},g),{x:p,y:7,text:e.label}),className:"text-shape",name:"text-shape",draggable:!0}),h},getShapeStyle:function(e){var t=this.getOptions(e).style,n={stroke:e.color},i=St({},t,n),a=this.getSize(e),o=i.width||a[0],s=i.height||a[1],u=L({x:-o/2,y:-s/2,width:o,height:s},i);return u},update:function(e,t){var n=this.getOptions(e),i=n.style,a=i===void 0?{}:i,o=n.labelCfg,s=o===void 0?{}:o,u=n.descriptionCfg,l=u===void 0?{}:u,f=this.getSize(e),c=f[0],h=f[1],d=t.get("keyShape");d.attr(L(L({},a),{x:-c/2,y:-h/2,width:c,height:h}));var v=t.getContainer(),p=v.find(function(Ge){return Ge.get("className")==="rect-logo-icon"}),g=p?p.attr():{},y=St({},g,e.logoIcon),m=y.width;m===void 0&&(m=this.options.logoIcon.width);var b=e.logoIcon?e.logoIcon.show:void 0,x=s.offset,_=-c/2+m+x;!b&&b!==void 0&&(_=-c/2+x);var S=v.find(function(Ge){return Ge.get("className")==="node-label"}),E=v.find(function(Ge){return Ge.get("className")==="rect-description"});if(e.label)if(!S)v.addShape("text",{attrs:L(L({},s.style),{x:_,y:e.description?-5:7,text:e.label}),className:"node-label",name:"node-label",draggable:!0});else{var C=e.labelCfg?e.labelCfg.style:{},M=St({},S.attr(),C);e.label&&(M.text=e.label),M.x=_,Xe(e.description)&&(M.y=-5),E&&(E.resetMatrix(),E.attr({x:_})),S.resetMatrix(),S.attr(M)}if(Xe(e.description)){var w=l.paddingTop;if(!E)v.addShape("text",{attrs:L(L({},l.style),{x:_,y:17+(w||0),text:e.description}),className:"rect-description",name:"rect-description",draggable:!0});else{var C=e.descriptionCfg?e.descriptionCfg.style:{},T=St({},E.attr(),C);Xe(e.description)&&(T.text=e.description),T.x=_,E.resetMatrix(),E.attr(L(L({},T),{y:17+(w||0)}))}}var I=v.find(function(Ge){return Ge.get("className")==="pre-rect"});if(I){var k=St({},I.attr(),e.preRect);I.attr(L(L({},k),{x:-c/2,y:-h/2,height:h}))}if(p)if(!b&&b!==void 0)p.remove();else{var O=y.width,U=y.height,q=y.x,K=y.y,le=y.offset,he=ti(y,["width","height","x","y","offset"]);p.attr(L(L({},he),{x:q||-c/2+O+le,y:K||-U/2,width:O,height:U}))}else b&&this.drawLogoIcon(e,v);var te=v.find(function(Ge){return Ge.get("className")==="rect-state-icon"}),se=te?te.attr():{},ge=St({},se,e.stateIcon);if(te){!ge.show&&ge.show!==void 0&&te.remove();var Se=ge.width,U=ge.height,q=ge.x,K=ge.y,ne=ge.offset,pe=ti(ge,["width","height","x","y","offset"]);te.attr(L(L({},pe),{x:q||c/2-Se+ne,y:K||-U/2,width:Se,height:U}))}else ge.show&&this.drawStateIcon(e,v);this.updateLinkPoints(e,v)}},"single-node");Ha("star",{options:{size:60,style:{stroke:lt.defaultNode.style.stroke,fill:lt.defaultNode.style.fill,lineWidth:lt.defaultNode.style.lineWidth},labelCfg:{style:{fill:lt.nodeLabel.style.fill,fontSize:lt.nodeLabel.style.fontSize}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:lt.defaultNode.linkPoints.size,lineWidth:lt.defaultNode.linkPoints.lineWidth,fill:lt.defaultNode.linkPoints.fill,stroke:lt.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:L({},lt.nodeStateStyles)},shapeType:"star",labelPosition:"center",drawShape:function(e,t){var n=this.getOptions(e).icon,i=n===void 0?{}:n,a=this.getShapeStyle(e),o=t.addShape("path",{attrs:a,className:this.type+"-keyShape",name:this.type+"-keyShape",draggable:!0}),s=i.width,u=i.height,l=i.show,f=i.text;return l&&(f?t.addShape("text",{attrs:L({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},i),className:this.type+"-icon",name:this.type+"-icon",draggable:!0}):t.addShape("image",{attrs:L({x:-s/2,y:-u/2},i),className:this.type+"-icon",name:this.type+"-icon",draggable:!0})),this.drawLinkPoints(e,t),o},drawLinkPoints:function(e,t){var n=this.getOptions(e).linkPoints,i=n===void 0?{}:n,a=i.top,o=i.left,s=i.right,u=i.leftBottom,l=i.rightBottom,f=i.size,c=i.r,h=ti(i,["top","left","right","leftBottom","rightBottom","size","r"]),d=this.getSize(e),v=d[0];if(s){var p=Math.cos((18+72*0)/180*Math.PI)*v,g=Math.sin((18+72*0)/180*Math.PI)*v;t.addShape("circle",{attrs:L(L({},h),{x:p,y:-g,r:f/2||c||5}),className:"link-point-right",name:"link-point-right"})}if(a){var p=Math.cos((18+72*1)/180*Math.PI)*v,g=Math.sin((18+72*1)/180*Math.PI)*v;t.addShape("circle",{attrs:L(L({},h),{x:p,y:-g,r:f/2||c||5}),className:"link-point-top",name:"link-point-top"})}if(o){var p=Math.cos((18+72*2)/180*Math.PI)*v,g=Math.sin((18+72*2)/180*Math.PI)*v;t.addShape("circle",{attrs:L(L({},h),{x:p,y:-g,r:f/2||c||5}),className:"link-point-left",name:"link-point-left"})}if(u){var p=Math.cos((18+72*3)/180*Math.PI)*v,g=Math.sin((18+72*3)/180*Math.PI)*v;t.addShape("circle",{attrs:L(L({},h),{x:p,y:-g,r:f/2||c||5}),className:"link-point-left-bottom",name:"link-point-left-bottom"})}if(l){var p=Math.cos((18+72*4)/180*Math.PI)*v,g=Math.sin((18+72*4)/180*Math.PI)*v;t.addShape("circle",{attrs:L(L({},h),{x:p,y:-g,r:f/2||c||5}),className:"link-point-right-bottom",name:"link-point-right-bottom"})}},getPath:function(e){for(var t=this.getSize(e),n=t[0],i=n*3/8,a=e.innerR||i,o=[],s=0;s<5;s++){var u=Math.cos((18+72*s)/180*Math.PI)*n,l=Math.sin((18+72*s)/180*Math.PI)*n,f=Math.cos((54+72*s)/180*Math.PI)*a,c=Math.sin((54+72*s)/180*Math.PI)*a;s===0?o.push(["M",u,-l]):o.push(["L",u,-l]),o.push(["L",f,-c])}return o.push(["Z"]),o},getShapeStyle:function(e){var t=this.getOptions(e).style,n={stroke:e.color},i=St({},t,n),a=this.getPath(e),o=L({path:a},i);return o},update:function(e,t){var n=t.getContainer(),i=this.getOptions({}).style,a=this.getPath(e),o={stroke:e.color,path:a},s=t.get("keyShape"),u=St({},i,s.attr(),o);u=St(u,e.style),this.updateShape(e,t,u,!0),this.updateLinkPoints(e,n)},updateLinkPoints:function(e,t){var n=this.getOptions({}).linkPoints,i=t.find(function(T){return T.get("className")==="link-point-left"}),a=t.find(function(T){return T.get("className")==="link-point-right"}),o=t.find(function(T){return T.get("className")==="link-point-top"}),s=t.find(function(T){return T.get("className")==="link-point-left-bottom"}),u=t.find(function(T){return T.get("className")==="link-point-right-bottom"}),l=n,f=i||a||o||s||u;f&&(l=f.attr());var c=St({},l,e.linkPoints),h=c.fill,d=c.stroke,v=c.lineWidth,p=c.size/2;p||(p=c.r);var g=e.linkPoints?e.linkPoints:{left:void 0,right:void 0,top:void 0,leftBottom:void 0,rightBottom:void 0},y=g.left,m=g.right,b=g.top,x=g.leftBottom,_=g.rightBottom,S=this.getSize(e),E=S[0],C={r:p,fill:h,stroke:d,lineWidth:v},M=Math.cos((18+72*0)/180*Math.PI)*E,w=Math.sin((18+72*0)/180*Math.PI)*E;a?!m&&m!==void 0?a.remove():a.attr(L(L({},C),{x:M,y:-w})):m&&t.addShape("circle",{attrs:L(L({},C),{x:M,y:-w}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0}),M=Math.cos((18+72*1)/180*Math.PI)*E,w=Math.sin((18+72*1)/180*Math.PI)*E,o?!b&&b!==void 0?o.remove():o.attr(L(L({},C),{x:M,y:-w})):b&&t.addShape("circle",{attrs:L(L({},C),{x:M,y:-w}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0}),M=Math.cos((18+72*2)/180*Math.PI)*E,w=Math.sin((18+72*2)/180*Math.PI)*E,i?!y&&y!==void 0?i.remove():i.attr(L(L({},C),{x:M,y:-w})):y&&t.addShape("circle",{attrs:L(L({},C),{x:M,y:-w}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0}),M=Math.cos((18+72*3)/180*Math.PI)*E,w=Math.sin((18+72*3)/180*Math.PI)*E,s?!x&&x!==void 0?s.remove():s.attr(L(L({},C),{x:M,y:-w})):x&&t.addShape("circle",{attrs:L(L({},C),{x:M,y:-w}),className:"link-point-left-bottom",name:"link-point-left-bottom",isAnchorPoint:!0}),M=Math.cos((18+72*4)/180*Math.PI)*E,w=Math.sin((18+72*4)/180*Math.PI)*E,u?!_&&_!==void 0?s.remove():u.attr(L(L({},C),{x:M,y:-w})):_&&t.addShape("circle",{attrs:L(L({},C),{x:M,y:-w}),className:"link-point-right-bottom",name:"link-point-right-bottom",isAnchorPoint:!0})}},"single-node");var wc=ta.defaultSubjectColors;Ha("donut",{options:{size:lt.defaultNode.size,style:{x:0,y:0,stroke:lt.defaultNode.style.stroke,fill:lt.defaultNode.style.fill,lineWidth:lt.defaultNode.style.lineWidth},labelCfg:{style:{fill:lt.nodeLabel.style.fill,fontSize:lt.nodeLabel.style.fontSize}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:lt.defaultNode.linkPoints.size,lineWidth:lt.defaultNode.linkPoints.lineWidth,fill:lt.defaultNode.linkPoints.fill,stroke:lt.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:L({},lt.nodeStateStyles)},shapeType:"circle",labelPosition:"center",drawShape:function(e,t){var n=this.getOptions(e).icon,i=n===void 0?{}:n,a=this.getShapeStyle(e),o=Hr({},i,e.icon),s=t.addShape("circle",{attrs:a,className:this.type+"-keyShape",draggable:!0,name:this.type+"-keyShape"}),u=o.width,l=o.height,f=o.show,c=o.text;f&&(c?t.addShape("text",{attrs:L({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},o),className:this.type+"-icon",name:this.type+"-icon",draggable:!0}):t.addShape("image",{attrs:L({x:-u/2,y:-l/2},o),className:this.type+"-icon",name:this.type+"-icon",draggable:!0}));var h=s.attr("r"),d=.6*h,v=(h+d)/2,p=e,g=p.donutAttrs,y=g===void 0?{}:g,m=p.donutColorMap,b=m===void 0?{}:m,x=Object.keys(y).length;if(y&&x>1){var _=[],S=0;if(Object.keys(y).forEach(function(w){var T=y[w]||0;!Lt(T)||(_.push({key:w,value:T,color:b[w]}),S+=T)}),S){var E=h-d;if(x===1){t.addShape("circle",{attrs:{r:v,x:0,y:0,stroke:_[0].color||wc[0],lineWidth:E},name:"fan-shape-0"});return}var C=[v,0],M=0;_.forEach(function(w,T){var I=w.value/S;if(!(I<.001)){if(I>.999&&(I=1),I===1){t.addShape("circle",{attrs:{r:v,x:0,y:0,stroke:w.color||wc[T%wc.length],lineWidth:E},name:"fan-shape-"+T});return}w.percent=I,w.angle=I*Math.PI*2,w.beginAgnle=M,M+=w.angle,w.endAngle=M,w.arcBegin=C,w.arcEnd=[v*Math.cos(w.endAngle),-v*Math.sin(w.endAngle)];var k=w.angle>Math.PI?1:0,O=[["M",w.arcBegin[0],w.arcBegin[1]],["A",v,v,0,k,0,w.arcEnd[0],w.arcEnd[1]],["L",w.arcEnd[0],w.arcEnd[1]]];t.addShape("path",{attrs:{path:O,lineWidth:E,stroke:w.color||wc[T%wc.length]},name:"fan-shape-"+T}),C=w.arcEnd}})}}return this.drawLinkPoints(e,t),s},update:void 0},"circle");var zv=function(e){var t=e.x,n=e.y;return{x:t,y:n,centerX:t,centerY:n,minX:t,minY:n,maxX:t,maxY:n,height:0,width:0}},Ofe=function(e){e===void 0&&(e=[]);var t=[],n=[];e.forEach(function(u){t.push(u.x),n.push(u.y)});var i=Math.min.apply(Math,t),a=Math.max.apply(Math,t),o=Math.min.apply(Math,n),s=Math.max.apply(Math,n);return{centerX:(i+a)/2,centerY:(o+s)/2,maxX:a,maxY:s,minX:i,minY:o,height:s-o,width:a-i}},F0=function(e){for(var t=[],n={},i=e.length,a=i-1;a>=0;a--){var o=e[a];o.id=o.x+"|||"+o.y,n[o.id]=o,t.push(o)}return t},ON=function(e){return F0(e)},$v=function(e,t){return e.width||e.height?{centerX:e.centerX,centerY:e.centerY,minX:e.minX-t,minY:e.minY-t,maxX:e.maxX+t,maxY:e.maxY+t,height:e.height+2*t,width:e.width+2*t}:e},Rfe=function(e,t){var n=Math.abs(e.x-t.centerX),i=Math.abs(e.y-t.centerY);return n===0&&i===0?0:n/t.width>i/t.height},U0=function(e,t,n){var i=Rfe(t,e);if(i===0){var a=e.centerX,o=e.centerY;return n.y<t.y?o=e.minY:n.x>t.x?a=e.maxX:n.x<t.x?a=e.minX:n.x===t.x&&(o=e.maxY),{x:a,y:o}}return i?{x:t.x>e.centerX?e.maxX:e.minX,y:t.y}:{x:t.x,y:t.y>e.centerY?e.maxY:e.minY}},RN=function(e,t){var n=Math.min(e.minX,t.minX),i=Math.min(e.minY,t.minY),a=Math.max(e.maxX,t.maxX),o=Math.max(e.maxY,t.maxY);return{centerX:(n+a)/2,centerY:(i+o)/2,minX:n,minY:i,maxX:a,maxY:o,height:o-i,width:a-n}},z0=function(e){return[{x:e.minX,y:e.minY},{x:e.maxX,y:e.minY},{x:e.maxX,y:e.maxY},{x:e.minX,y:e.maxY}]},Vv=function(e,t){var n=e.x,i=e.y;return n<t.minX||n>t.maxX||i<t.minY||i>t.maxY},Bfe=function(e,t){return t<e.minX||t>e.maxX?[]:[{x:t,y:e.minY},{x:t,y:e.maxY}]},Gfe=function(e,t){return t<e.minY||t>e.maxY?[]:[{x:e.minX,y:t},{x:e.maxX,y:t}]},Ffe=function(e,t){return Bfe(e,t.x).concat(Gfe(e,t.y))},Sc=function(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},Ufe=function(e,t){var n=-2,i=0;return t.forEach(function(a){a&&(e.x===a.x&&(i+=n),e.y===a.y&&(i+=n))}),i},BN=function(e,t,n,i,a){return Sc(e,t)+Sc(e,n)+Ufe(e,[t,n,i,a])},zfe=function r(e,t,n,i,a){a===void 0&&(a=0),e.unshift(t[i]),n[i]&&n[i]!==i&&a<=100&&r(e,t,n,n[i],a+1)},$fe=function(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)},Wv=function(e,t,n,i){var a=n.x-e.x,o=n.y-e.y,s=i.x-e.x,u=i.y-e.y,l=n.x-t.x,f=n.y-t.y,c=i.x-t.x,h=i.y-t.y,d=a*u-o*s,v=l*h-f*c,p=a*f-o*l,g=s*h-u*c;return d*v<=0&&p*g<=0},$0=function(e,t,n){if(n.width||n.height){var i=z0(n),a=i[0],o=i[1],s=i[2],u=i[3];return Wv(e,t,a,o)||Wv(e,t,a,u)||Wv(e,t,o,s)||Wv(e,t,s,u)}return!1},Vfe=function(e,t,n,i){var a=[];return e.forEach(function(o){if(o!==t&&(o.x===t.x||o.y===t.y)){if($0(o,t,n)||$0(o,t,i))return;a.push(o)}}),F0(a)},Wfe=function(e,t,n,i,a,o,s){var u=[],l=[t],f={},c={},h={};c[t.id]=0,h[t.id]=BN(t,n,t);var d={};e.forEach(function(y){d[y.id]=y});for(var v,p;l.length;){if(v=void 0,p=1/0,l.forEach(function(y){h[y.id]<=p&&(p=h[y.id],v=y)}),v===n){var g=[];return zfe(g,d,f,n.id),g}$fe(l,v),u.push(v),Vfe(e,v,i,a).forEach(function(y){if(u.indexOf(y)===-1){l.indexOf(y)===-1&&l.push(y);var m=h[v.id]+Sc(v,y);c[y.id]&&m>=c[y.id]||(f[y.id]=v.id,c[y.id]=m,h[y.id]=c[y.id]+BN(y,n,t,o,s))}})}return[t,n]},jfe=function(e,t,n){return!(e.x===t.x&&t.x===n.x||e.y===t.y&&t.y===n.y)},Xfe=function(e,t,n,i){var a=Sc(e,t),o=Sc(n,t);a<i&&(i=a),o<i&&(i=o);var s={x:t.x-i/a*(t.x-e.x),y:t.y-i/a*(t.y-e.y)},u={x:t.x-i/o*(t.x-n.x),y:t.y-i/o*(t.y-n.y)};return[s,u]},GN=function(e,t){var n=[],i=e[0];return n.push("M"+i.x+" "+i.y),e.forEach(function(a,o){var s=e[o+1],u=e[o+2];if(s&&u)if(jfe(a,s,u)){var l=Xfe(a,s,u,t),f=l[0],c=l[1];n.push("L"+f.x+" "+f.y),n.push("Q"+s.x+" "+s.y+" "+c.x+" "+c.y),n.push("L"+c.x+" "+c.y)}else n.push("L"+s.x+" "+s.y);else s&&n.push("L"+s.x+" "+s.y)}),n.join("")},FN=function(e,t,n,i,a){var o,s;if(!n||!n.getType())o=zv(e);else if(n.getType()==="combo"){var u=n.getKeyShape();o=u.getCanvasBBox()||zv(e),o.centerX=(o.minX+o.maxX)/2,o.centerY=(o.minY+o.maxY)/2}else o=n.getBBox();if(!i||!i.getType())s=zv(t);else if(i.getType()==="combo"){var l=i.getKeyShape().getBBox();if(l){var f=i.getModel(),c=f.x,h=f.y;s={x:c,y:h,width:l.width,height:l.height,minX:l.minX+c,maxX:l.maxX+c,minY:l.minY+h,maxY:l.maxY+h},s.centerX=(s.minX+s.maxX)/2,s.centerY=(s.minY+s.maxY)/2}else s=zv(t)}else s=i&&i.getBBox();var d=$v(o,a),v=$v(s,a),p=U0(d,e,t),g=U0(v,t,e),y=Ofe([p,g]),m=RN(d,y),b=RN(v,y),x=[];x=x.concat(z0(m)).concat(z0(b));var _={x:(e.x+t.x)/2,y:(e.y+t.y)/2};[y,m,b].forEach(function(E){x=x.concat(Ffe(E,_).filter(function(C){return Vv(C,d)&&Vv(C,v)}))}),[{x:p.x,y:g.y},{x:g.x,y:p.y}].forEach(function(E){Vv(E,d)&&Vv(E,v)&&x.push(E)}),x.unshift(p),x.push(g),x=F0(x);var S=Wfe(x,p,g,o,s,e,t);return S.unshift(e),S.push(t),ON(S)},Hfe=function(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},Yfe=function(e,t,n,i,a){return ON(FN(e,t,n,i,a.offset))},qfe={offset:20,maxAllowedDirectionChange:Math.PI/2,maximumLoops:2e3,gridSize:10,directions:[{stepX:1,stepY:0},{stepX:-1,stepY:0},{stepX:0,stepY:1},{stepX:0,stepY:-1}],get penalties(){return{0:0,45:this.gridSize/2,90:this.gridSize/2}},distFunc:Hfe,fallbackRoute:Yfe},lo=function(e,t){var n=Math.round(Math.abs(e/t)),i=e<0?-1:1;return n<0?0:i*n},Kfe=function(e,t,n){var i={};return e.forEach(function(a){if(!!a)for(var o=$v(a.getBBox(),n),s=lo(o.minX,t);s<=lo(o.maxX,t);s+=1)for(var u=lo(o.minY,t);u<=lo(o.maxY,t);u+=1)i[s+"|||"+u]=!0}),i},V0=function(e,t){var n=t.x-e.x,i=t.y-e.y;return n||i?Math.atan2(i,n):0},UN=function(e,t){var n=Math.abs(e-t);return n>Math.PI?2*Math.PI-n:n},zN=function(e,t,n){for(var i=1/0,a=0,o=t.length;a<o;a++){var s=n(e,t[a]);s<i&&(i=s)}return i},$N=function(e,t,n,i,a){var o=[];if(!n)return[e];var s=a.directions,u=a.offset,l=n.getBBox(),f=t.x>l.minX&&t.x<l.maxX&&t.y>l.minY&&t.y<l.maxY,c=$v(l,u);for(var h in c)c[h]=lo(c[h],a.gridSize);if(f){for(var d=0,v=s;d<v.length;d++)for(var p=v[d],g=[[{x:c.minX,y:c.minY},{x:c.maxX,y:c.minY}],[{x:c.minX,y:c.minY},{x:c.minX,y:c.maxY}],[{x:c.maxX,y:c.minY},{x:c.maxX,y:c.maxY}],[{x:c.minX,y:c.maxY},{x:c.maxX,y:c.maxY}]],h=0;h<4;h++){var y=g[h],m=ta.getLineIntersect(e,{x:e.x+p.stepX*c.width,y:e.y+p.stepY*c.height},y[0],y[1]);m&&!$0(e,m,l)&&(m.id=m.x+"|||"+m.y,o.push(m))}return o}var b=U0(c,e,i);return b.id=b.x+"|||"+b.y,[b]},W0=function(e,t,n,i){var a=V0(e,t);if(!n[e.id]){var o=V0(i,e);return UN(o,a)}var s=V0({x:n[e.id].x,y:n[e.id].y},e);return UN(s,a)},Zfe=function(e,t,n,i,a,o,s){var u=[i],l=e.id,f=e.x,c=e.y,h={x:f,y:c,id:l};for(W0(h,o,t,n)&&u.unshift({x:o.x===i.x?i.x:h.x*s,y:o.y===i.y?i.y:h.y*s});t[l]&&t[l].id!==l;){var d={x:f,y:c,id:l},v=t[l].id,p=t[l].x,g=t[l].y,y={x:p,y:g,id:v},m=W0(y,d,t,n);m&&u.unshift({x:y.x===d.x?u[0].x:y.x*s,y:y.y===d.y?u[0].y:y.y*s}),l=v,f=p,c=g}var b={x:f,y:c,id:l};return u[0].x=b.x===n.x?a.x:u[0].x,u[0].y=b.y===n.y?a.y:u[0].y,u.unshift(a),u},Qfe=function(e,t,n,i,a){if(isNaN(e.x)||isNaN(t.x))return[];var o=Hr(qfe,a);o.obstacles=o.obstacles||[];var s=o.gridSize,u=Kfe(o.obstacles.concat([n,i]),s,o.offset),l={x:lo(e.x,s),y:lo(e.y,s)},f={x:lo(t.x,s),y:lo(t.y,s)};e.id=l.x+"|||"+l.y,t.id=f.x+"|||"+f.y;var c=$N(l,e,n,f,o),h=$N(f,t,i,l,o);c.forEach(function(k){delete u[k.id]}),h.forEach(function(k){delete u[k.id]});for(var d={},v={},p={},g={},y={},m=0;m<c.length;m++){var b=c[m];d[b.id]=b,g[b.id]=0,y[b.id]=zN(b,h,o.distFunc)}for(var x=o.maximumLoops,_=o.penalties,S,E,C,M,w,T,I;Object.keys(d).length>0&&x>0&&(S=void 0,E=1/0,Object.keys(d).forEach(function(k){var O=d[k].id;y[O]<=E&&(E=y[O],S=d[O])}),!!S);){if(h.findIndex(function(k){return k.x===S.x&&k.y===S.y})>-1)return Zfe(S,p,l,t,e,f,s);delete d[S.id],v[S.id]=!0;for(var m=0;m<o.directions.length;m++)C=o.directions[m],M={x:S.x+C.stepX,y:S.y+C.stepY,id:Math.round(S.x)+C.stepX+"|||"+(Math.round(S.y)+C.stepY)},!v[M.id]&&(I=W0(S,M,p,l),!(I>o.maxAllowedDirectionChange)&&(u[M.id]||(d[M.id]||(d[M.id]=M),w=o.distFunc(S,M)+(isNaN(_[I])?s:_[I]),T=g[S.id]+w,!(g[M.id]&&T>=g[M.id])&&(p[M.id]=S,g[M.id]=T,y[M.id]=T+zN(M,h,o.distFunc)))));x-=1}return o.fallbackRoute(e,t,n,i,o)};zS("polyline",{options:{color:lt.defaultEdge.color,size:lt.defaultEdge.size,style:{radius:0,offset:15,x:0,y:0,stroke:lt.defaultEdge.style.stroke,lineAppendWidth:lt.defaultEdge.style.lineAppendWidth},labelCfg:{style:{fill:lt.edgeLabel.style.fill,fontSize:lt.edgeLabel.style.fontSize}},routeCfg:{obstacles:[],maxAllowedDirectionChange:Math.PI,maximumLoops:500,gridSize:10},stateStyles:L({},lt.edgeStateStyles)},shapeType:"polyline",labelPosition:"center",drawShape:function(e,t){var n=this.getShapeStyle(e);n.radius===0&&delete n.radius;var i=t.addShape("path",{className:"edge-shape",name:"edge-shape",attrs:n});return i},getShapeStyle:function(e){var t=this.options.style,n={stroke:e.color},i=St({},t,n,e.style);e=this.getPathPoints(e),this.radius=i.radius,this.offset=i.offset;var a=e.startPoint,o=e.endPoint,s=this.getControlPoints(e),u=[a];s&&(u=u.concat(s)),u.push(o);var l=e.sourceNode,f=e.targetNode,c=i.radius,h=this.options.routeCfg,d=St({},h,e.routeCfg);d.offset=i.offset;var v=this.getPath(u,l,f,c,d);(At(v)&&v.length<=1||Xe(v)&&v.indexOf("L")===-1)&&(v="M0 0, L0 0"),(isNaN(a.x)||isNaN(a.y)||isNaN(o.x)||isNaN(o.y))&&(v="M0 0, L0 0");var p=St({},lt.defaultEdge.style,i,{lineWidth:e.size,path:v});return p},updateShapeStyle:function(e,t){var n=t.getContainer();if(!!t.isVisible()){var i={stroke:e.color},a=n.find(function(x){return x.get("className")==="edge-shape"})||t.getKeyShape(),o=e.size;e=this.getPathPoints(e);var s=e.startPoint,u=e.endPoint,l=this.getControlPoints(e),f=[s];l&&(f=f.concat(l)),f.push(u);var c=a.attr(),h=St({},i,c,e.style),d=e.sourceNode,v=e.targetNode,p=h.radius,g=this.options.routeCfg,y=St({},g,e.routeCfg);y.offset=h.offset;var m=this.getPath(f,d,v,p,y);(At(m)&&m.length<=1||Xe(m)&&m.indexOf("L")===-1)&&(m="M0 0, L0 0"),(isNaN(s.x)||isNaN(s.y)||isNaN(u.x)||isNaN(u.y))&&(m="M0 0, L0 0"),c.endArrow&&h.endArrow===!1&&(e.style.endArrow={path:""}),c.startArrow&&h.startArrow===!1&&(e.style.startArrow={path:""});var b=St(i,a.attr(),{lineWidth:o,path:m},e.style);a&&a.attr(b)}},getPath:function(e,t,n,i,a){var o=a.offset,s=a.simple;if(!o||e.length>2){if(i)return GN(e,i);var u=[];return xe(e,function(h,d){d===0?u.push(["M",h.x,h.y]):u.push(["L",h.x,h.y])}),u}var l=s?FN(e[e.length-1],e[0],n,t,o):Qfe(e[0],e[e.length-1],t,n,a);if(!l||!l.length)return"M0 0, L0 0";if(i){var f=GN(l,i);return f}var c=ta.pointsToPolygon(l);return c}},"single-edge");var VN=oo.cloneEvent,WN=oo.isNaN,jN=Math.abs,Jfe=10,ece=["shift","ctrl","alt","control"],tce={getDefaultCfg:function(){return{direction:"both",enableOptimize:!1,scalableRange:0,allowDragOnItem:!1}},getEvents:function(){return{dragstart:"onMouseDown",drag:"onMouseMove",dragend:"onMouseUp","canvas:click":"onMouseUp",keyup:"onKeyUp",focus:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onMouseUp"}},updateViewport:function(e){var t=this.origin,n=+e.clientX,i=+e.clientY;if(!(WN(n)||WN(i))){var a=n-t.x,o=i-t.y;this.get("direction")==="x"?o=0:this.get("direction")==="y"&&(a=0),this.origin={x:n,y:i};var s=this.graph.get("width"),u=this.graph.get("height"),l=this.graph.get("canvas").getCanvasBBox(),f=this.scalableRange,c=this.scalableRange;f<1&&f>-1&&(f=s*f,c=u*c),(l.minX<=s+f&&l.minX+a>s+f||l.maxX+f>=0&&l.maxX+f+a<0)&&(a=0),(l.minY<=u+c&&l.minY+o>u+c||l.maxY+c>=0&&l.maxY+c+o<0)&&(o=0),this.graph.translate(a,o)}},onTouchStart:function(e){var t=this,n=e.originalEvent.touches,i=n[0],a=n[1];i&&a||(e.preventDefault(),t.onMouseDown(e))},onMouseDown:function(e){var t=this,n=e.originalEvent;if(!(n&&e.name!==od.TOUCHSTART&&n.button!==0)&&!(e.name!==od.TOUCHSTART&&typeof window!="undefined"&&window.event&&!window.event.buttons&&!window.event.button)&&!!this.shouldBegin.call(this,e)&&!t.keydown){var i=e.target,a=i&&i.isCanvas&&i.isCanvas();if(!(!this.allowDragOnItem&&!a)&&(t.origin={x:e.clientX,y:e.clientY},t.dragging=!1,this.enableOptimize)){for(var o=this.graph,s=o.getEdges(),u=0,l=s.length;u<l;u++){var f=s[u].get("group").get("children");!f||f.forEach(function(x){x.set("ori-visibility",x.get("ori-visibility")||x.get("visible")),x.hide()})}for(var c=o.getNodes(),h=0,d=c.length;h<d;h++)for(var v=c[h].getContainer(),p=v.get("children"),g=0,y=p;g<y.length;g++){var m=y[g],b=m.get("isKeyShape");b||(m.set("ori-visibility",m.get("ori-visibility")||m.get("visible")),m.hide())}}}},onTouchMove:function(e){var t=this,n=e.originalEvent.touches,i=n[0],a=n[1];if(i&&a){this.onMouseUp(e);return}e.preventDefault(),t.onMouseMove(e)},onMouseMove:function(e){var t=this.graph;if(!this.keydown){var n=e.target,i=n&&n.isCanvas&&n.isCanvas();if(!(!this.allowDragOnItem&&!i)&&(e=VN(e),!!this.origin)){if(this.dragging)e.type="drag",t.emit("canvas:drag",e);else{if(jN(this.origin.x-e.clientX)+jN(this.origin.y-e.clientY)<Jfe)return;this.shouldBegin.call(this,e)&&(e.type="dragstart",t.emit("canvas:dragstart",e),this.dragging=!0)}this.shouldUpdate.call(this,e)&&this.updateViewport(e)}}},onMouseUp:function(e){var t,n,i=this.graph;if(!this.keydown){var a=i.getZoom(),o=i.get("modeController"),s=(n=(t=o==null?void 0:o.modes[o.mode])===null||t===void 0?void 0:t.filter(function(E){return E.type==="zoom-canvas"}))===null||n===void 0?void 0:n[0],u=s?s.optimizeZoom||.1:0;if(this.enableOptimize){for(var l=i.getEdges(),f=0,c=l.length;f<c;f++){var h=l[f].get("group").get("children");!h||h.forEach(function(E){var C=E.get("ori-visibility");C&&E.show()})}if(a>u)for(var d=i.getNodes(),v=0,p=d.length;v<p;v++)for(var g=d[v].getContainer(),y=g.get("children"),m=0,b=y;m<b.length;m++){var x=b[m],_=x.get("isKeyShape");if(!_){var S=x.get("ori-visibility");S&&x.show()}}}if(!this.dragging){this.origin=null;return}e=VN(e),this.shouldEnd.call(this,e)&&this.updateViewport(e),e.type="dragend",i.emit("canvas:dragend",e),this.endDrag()}},endDrag:function(){this.origin=null,this.dragging=!1,this.dragbegin=!1},onKeyDown:function(e){var t=this,n=e.key;!n||(ece.indexOf(n.toLowerCase())>-1?t.keydown=!0:t.keydown=!1)},onKeyUp:function(){this.keydown=!1,this.origin=null,this.dragging=!1,this.dragbegin=!1}},rce={getDefaultCfg:function(){return{updateEdge:!0,delegateStyle:{},enableDelegate:!1,onlyChangeComboSize:!1,comboActiveState:"",selectedState:"selected",enableOptimize:!1,enableDebounce:!1,enableStack:!0}},getEvents:function(){return{"node:dragstart":"onDragStart","node:drag":"onDrag","node:dragend":"onDragEnd","combo:dragenter":"onDragEnter","combo:dragleave":"onDragLeave","combo:drop":"onDropCombo","node:drop":"onDropNode","canvas:drop":"onDropCanvas",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onDragEnd"}},validationCombo:function(e){if(!this.origin||!e||e.destroyed)return!1;var t=e.getType();return t==="combo"},onTouchStart:function(e){if(!!e.item){var t=this;try{var n=e.originalEvent.touches,i=n[0],a=n[1];if(i&&a)return;e.preventDefault()}catch(o){console.warn("Touch original event not exist!")}t.onDragStart(e)}},onTouchMove:function(e){var t=this;try{var n=e.originalEvent.touches,i=n[0],a=n[1];if(i&&a){t.onDragEnd(e);return}e.preventDefault()}catch(o){console.warn("Touch original event not exist!")}t.onDrag(e)},onDragStart:function(e){var t=this;if(this.currentShouldEnd=!0,!!this.shouldBegin.call(this,e)){var n=e.item;if(!(!n||n.destroyed||n.hasLocked())){var i=n.getContainer();i.set("capture",!1),this.cachedCaptureItems||(this.cachedCaptureItems=[]),this.cachedCaptureItems.push(n);var a=e.target;if(a){var o=a.get("isAnchorPoint");if(o)return}var s=this.graph;this.targets=[],this.targetCombo=null;var u=s.findAllByState("node",this.selectedState),l=n.get("id"),f=u.filter(function(h){var d=h.get("id");return l===d});f.length===0?this.targets.push(n):u.length>1?u.forEach(function(h){var d=h.hasLocked();d||t.targets.push(h)}):this.targets.push(n);var c=[];this.targets.forEach(function(h){c.push(Cr(h.getModel()))}),this.set("beforeDragNodes",c),this.hidenEdge={},this.get("updateEdge")&&this.enableOptimize&&!this.enableDelegate&&this.targets.forEach(function(h){var d=h.getEdges();d.forEach(function(v){!v.isVisible()||(t.hidenEdge[v.getID()]=!0,v.hide())})}),this.origin={x:e.x,y:e.y},this.point={},this.originPoint={}}}},onDrag:function(e){var t=this;!this.origin||!this.shouldUpdate(this,e)||(this.get("enableDelegate")?this.updateDelegate(e):this.enableDebounce?this.debounceUpdate({targets:this.targets,graph:this.graph,point:this.point,origin:this.origin,evt:e,updateEdge:this.get("updateEdge")}):this.targets.map(function(n){t.update(n,e)}))},onDragEnd:function(e){var t=this,n;if(!!this.origin){(n=this.cachedCaptureItems)===null||n===void 0||n.forEach(function(o){var s=o.getContainer();s.set("capture",!0)}),this.cachedCaptureItems=[],this.delegateRect&&(this.delegateRect.remove(),this.delegateRect=null),this.get("updateEdge")&&this.enableOptimize&&!this.enableDelegate&&this.targets.forEach(function(o){var s=o.getEdges();s.forEach(function(u){t.hidenEdge[u.getID()]&&u.show(),u.refresh()})}),this.hidenEdge={};var i=this.graph;if(i.get("enabledStack")&&this.enableStack){var a={before:{nodes:[],edges:[],combos:[]},after:{nodes:[],edges:[],combos:[]}};this.get("beforeDragNodes").forEach(function(o){a.before.nodes.push({id:o.id,x:o.x,y:o.y})}),this.targets.forEach(function(o){var s=o.getModel();a.after.nodes.push({id:s.id,x:s.x,y:s.y})}),i.pushStack("update",Cr(a))}i.emit("dragnodeend",{items:this.targets,targetItem:null}),this.point={},this.origin=null,this.originPoint={},this.targets.length=0,this.targetCombo=null}},onDropCombo:function(e){var t=e.item;if(this.currentShouldEnd=this.shouldEnd.call(this,e,t),this.updatePositions(e,!this.currentShouldEnd),!(!this.currentShouldEnd||!this.validationCombo(t))){var n=this.graph;if(this.comboActiveState&&n.setItemState(t,this.comboActiveState,!1),this.targetCombo=t,this.onlyChangeComboSize)n.updateCombos();else{var i=t.getModel();this.targets.map(function(a){var o=a.getModel();o.comboId!==i.id&&n.updateComboTree(a,i.id)}),n.updateCombo(t)}n.emit("dragnodeend",{items:this.targets,targetItem:this.targetCombo})}},onDropCanvas:function(e){var t=this.graph;this.currentShouldEnd=this.shouldEnd.call(this,e,void 0),this.updatePositions(e,!this.currentShouldEnd),!(!this.targets||this.targets.length===0||!this.currentShouldEnd)&&(this.onlyChangeComboSize?t.updateCombos():this.targets.map(function(n){var i=n.getModel();i.comboId&&t.updateComboTree(n)}))},onDropNode:function(e){if(!(!this.targets||this.targets.length===0)){var t=this,n=e.item,i=t.graph,a=n.getModel().comboId,o=a?i.findById(a):void 0;if(this.currentShouldEnd=this.shouldEnd.call(this,e,o),this.updatePositions(e,!this.currentShouldEnd),!!this.currentShouldEnd){if(this.onlyChangeComboSize)i.updateCombos();else if(a){var s=i.findById(a);t.comboActiveState&&i.setItemState(s,t.comboActiveState,!1),this.targets.map(function(u){var l=u.getModel();a!==l.comboId&&i.updateComboTree(u,a)}),i.updateCombo(s)}else this.targets.map(function(u){var l=u.getModel();l.comboId&&i.updateComboTree(u)});i.emit("dragnodeend",{items:this.targets,targetItem:n})}}},onDragEnter:function(e){var t=e.item;if(!!this.validationCombo(t)){var n=this.graph;this.comboActiveState&&n.setItemState(t,this.comboActiveState,!0)}},onDragLeave:function(e){var t=e.item;if(!!this.validationCombo(t)){var n=this.graph;this.comboActiveState&&n.setItemState(t,this.comboActiveState,!1)}},updatePositions:function(e,t){var n=this;!this.targets||this.targets.length===0||(this.get("enableDelegate")?this.enableDebounce?this.debounceUpdate({targets:this.targets,graph:this.graph,point:this.point,origin:this.origin,evt:e,updateEdge:this.get("updateEdge"),updateFunc:this.update}):t||this.targets.map(function(i){return n.update(i,e)}):this.targets.map(function(i){return n.update(i,e,t)}))},update:function(e,t,n){var i=this.origin,a=e.get("model"),o=e.get("id");this.point[o]||(this.point[o]={x:a.x||0,y:a.y||0});var s=t.x-i.x+this.point[o].x,u=t.y-i.y+this.point[o].y;n&&(s+=i.x-t.x,u+=i.y-t.y);var l={x:s,y:u};this.get("updateEdge")?this.graph.updateItem(e,l,!1):e.updatePosition(l)},debounceUpdate:ig(function(r){var e=r.targets,t=r.graph,n=r.point,i=r.origin,a=r.evt,o=r.updateEdge;r.updateFunc,e.map(function(s){var u=s.get("model"),l=s.get("id");n[l]||(n[l]={x:u.x||0,y:u.y||0});var f=a.x-i.x+n[l].x,c=a.y-i.y+n[l].y,h={x:f,y:c};o?t.updateItem(s,h,!1):s.updatePosition(h)})},50,!0),updateDelegate:function(e){var t=this.graph;if(this.delegateRect){var h=e.x-this.origin.x+this.originPoint.minX,d=e.y-this.origin.y+this.originPoint.minY;this.delegateRect.attr({x:h,y:d})}else{var n=t.get("group"),i=Hr({},Ts.delegateStyle,this.delegateStyle),a=this.calculationGroupPosition(e),o=a.x,s=a.y,u=a.width,l=a.height,f=a.minX,c=a.minY;this.originPoint={x:o,y:s,width:u,height:l,minX:f,minY:c},this.delegateRect=n.addShape("rect",{attrs:L({width:u,height:l,x:o,y:s},i),name:"rect-delegate-shape"}),this.delegate=this.delegateRect,this.delegateRect.set("capture",!1)}},calculationGroupPosition:function(e){var t=this.targets;t.length===0&&t.push(e.item);for(var n=1/0,i=-1/0,a=1/0,o=-1/0,s=0;s<t.length;s++){var u=t[s],l=u.getBBox(),f=l.minX,c=l.minY,h=l.maxX,d=l.maxY;f<n&&(n=f),c<a&&(a=c),h>i&&(i=h),d>o&&(o=d)}var v=Math.floor(n),p=Math.floor(a),g=Math.ceil(i)-Math.floor(n),y=Math.ceil(o)-Math.floor(a);return{x:v,y:p,width:g,height:y,minX:n,minY:a}}},nce={getDefaultCfg:function(){return{trigger:"mouseenter",activeState:"active",inactiveState:"inactive",resetSelected:!1,shouldUpdate:function(){return!0}}},getEvents:function(){return this.get("trigger")==="mouseenter"?{"node:mouseenter":"setAllItemStates","combo:mouseenter":"setAllItemStates","node:mouseleave":"clearActiveState","combo:mouseleave":"clearActiveState"}:{"node:click":"setAllItemStates","combo:click":"setAllItemStates","canvas:click":"clearActiveState","node:touchstart":"setOnTouchStart","combo:touchstart":"setOnTouchStart","canvas:touchstart":"clearOnTouchStart"}},setOnTouchStart:function(e){var t=this;try{var n=e.originalEvent.touches,i=n[0],a=n[1];if(i&&a)return;e.preventDefault()}catch(o){console.warn("Touch original event not exist!")}t.setAllItemStates(e)},clearOnTouchStart:function(e){var t=this;try{var n=e.originalEvent.touches,i=n[0],a=n[1];if(i&&a)return;e.preventDefault()}catch(o){console.warn("Touch original event not exist!")}t.clearActiveState(e)},setAllItemStates:function(e){var t=e.item,n=this.graph;if(this.item=t,!!this.shouldUpdate(e.item,{event:e,action:"activate"})){for(var i=this,a=this.activeState,o=this.inactiveState,s=n.getNodes(),u=n.getCombos(),l=n.getEdges(),f=n.get("vedges"),c=s.length,h=u.length,d=l.length,v=f.length,p=0;p<c;p++){var g=s[p],y=g.hasState("selected");i.resetSelected&&y&&n.setItemState(g,"selected",!1),n.setItemState(g,a,!1),o&&n.setItemState(g,o,!0)}for(var p=0;p<h;p++){var m=u[p],y=m.hasState("selected");i.resetSelected&&y&&n.setItemState(m,"selected",!1),n.setItemState(m,a,!1),o&&n.setItemState(m,o,!0)}for(var p=0;p<d;p++){var b=l[p];n.setItemState(b,a,!1),o&&n.setItemState(b,o,!0)}for(var p=0;p<v;p++){var x=f[p];n.setItemState(x,a,!1),o&&n.setItemState(x,o,!0)}o&&n.setItemState(t,o,!1),n.setItemState(t,a,!0);for(var _=t.getEdges(),S=_.length,p=0;p<S;p++){var b=_[p],E=void 0;b.getSource()===t?E=b.getTarget():E=b.getSource(),o&&n.setItemState(E,o,!1),n.setItemState(E,a,!0),n.setItemState(b,o,!1),n.setItemState(b,a,!0),b.toFront()}n.emit("afteractivaterelations",{item:e.item,action:"activate"})}},clearActiveState:function(e){var t=this,n=t.get("graph");if(!!t.shouldUpdate(e.item,{event:e,action:"deactivate"})){var i=this.activeState,a=this.inactiveState,o=n.get("autoPaint");n.setAutoPaint(!1);for(var s=n.getNodes()||[],u=n.getCombos()||[],l=n.getEdges()||[],f=n.get("vedges")||[],c=s.length,h=u.length,d=l.length,v=f.length,p=0;p<c;p++){var g=s[p];n.clearItemStates(g,[i,a])}for(var p=0;p<h;p++){var y=u[p];n.clearItemStates(y,[i,a])}for(var p=0;p<d;p++){var m=l[p];n.clearItemStates(m,[i,a,"deactivate"])}for(var p=0;p<v;p++){var b=f[p];n.clearItemStates(b,[i,a,"deactivate"])}n.paint(),n.setAutoPaint(o),n.emit("afteractivaterelations",{item:e.item||t.get("item"),action:"deactivate"})}}},jv=Math.min,XN=Math.max,HN=Math.abs,YN="shift",ice=["drag","shift","ctrl","alt","control"],ace={getDefaultCfg:function(){return{brushStyle:{fill:"#EEF6FF",fillOpacity:.4,stroke:"#DDEEFE",lineWidth:1},onSelect:function(){},onDeselect:function(){},selectedState:"selected",trigger:YN,includeEdges:!0,selectedEdges:[],selectedNodes:[]}},getEvents:function(){return ice.indexOf(this.trigger.toLowerCase())>-1||(this.trigger=YN,console.warn("Behavior brush-select \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'drag'\u3001'shift'\u3001'ctrl' \u6216 'alt'")),this.trigger==="drag"?{dragstart:"onMouseDown",drag:"onMouseMove",dragend:"onMouseUp","canvas:click":"clearStates"}:{dragstart:"onMouseDown",drag:"onMouseMove",dragend:"onMouseUp","canvas:click":"clearStates",keyup:"onKeyUp",keydown:"onKeyDown"}},onMouseDown:function(e){var t=e.item,n=this.brush;t||this.trigger!=="drag"&&!this.keydown||(this.selectedNodes&&this.selectedNodes.length!==0&&this.clearStates(),n||(n=this.createBrush()),this.originPoint={x:e.canvasX,y:e.canvasY},n.attr({width:0,height:0}),n.show(),this.dragging=!0)},onMouseMove:function(e){!this.dragging||this.trigger!=="drag"&&!this.keydown||this.updateBrush(e)},onMouseUp:function(e){this.graph,!(!this.brush&&!this.dragging)&&(this.trigger!=="drag"&&!this.keydown||(this.brush.remove(!0),this.brush=null,this.getSelectedNodes(e),this.dragging=!1))},clearStates:function(){var e=this,t=e.graph,n=e.selectedState,i=t.findAllByState("node",n),a=t.findAllByState("edge",n);i.forEach(function(o){return t.setItemState(o,n,!1)}),a.forEach(function(o){return t.setItemState(o,n,!1)}),this.selectedNodes=[],this.selectedEdges=[],this.onDeselect&&this.onDeselect(this.selectedNodes,this.selectedEdges),t.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[]},select:!1})},getSelectedNodes:function(e){var t=this,n=this,i=n.graph,a=n.originPoint,o=n.shouldUpdate,s=this.selectedState,u={x:e.x,y:e.y},l=i.getPointByCanvas(a.x,a.y),f=jv(u.x,l.x),c=XN(u.x,l.x),h=jv(u.y,l.y),d=XN(u.y,l.y),v=[],p=[];i.getNodes().forEach(function(y){if(!!y.isVisible()){var m=y.getBBox();if(m.centerX>=f&&m.centerX<=c&&m.centerY>=h&&m.centerY<=d&&o(y,"select")){v.push(y);var b=y.getModel();p.push(b.id),i.setItemState(y,s,!0)}}});var g=[];this.includeEdges&&v.forEach(function(y){var m=y.getOutEdges();m.forEach(function(b){if(!!b.isVisible()){var x=b.getModel(),_=x.source,S=x.target;p.includes(_)&&p.includes(S)&&o(b,"select")&&(g.push(b),i.setItemState(b,t.selectedState,!0))}})}),this.selectedEdges=g,this.selectedNodes=v,this.onSelect&&this.onSelect(v,g),i.emit("nodeselectchange",{selectedItems:{nodes:v,edges:g},select:!0})},createBrush:function(){var e=this,t=e.graph.get("canvas").addShape("rect",{attrs:e.brushStyle,capture:!1,name:"brush-shape"});return this.brush=t,this.delegate=t,t},updateBrush:function(e){var t=this.originPoint;this.brush.attr({width:HN(e.canvasX-t.x),height:HN(e.canvasY-t.y),x:jv(e.canvasX,t.x),y:jv(e.canvasY,t.y)})},onKeyDown:function(e){var t=e.key;if(!!t){var n=this.trigger.toLowerCase(),i=t.toLowerCase();i===n||i==="control"&&n==="ctrl"||i==="ctrl"&&n==="control"?this.keydown=!0:this.keydown=!1}},onKeyUp:function(){this.brush&&(this.brush.remove(!0),this.brush=null,this.dragging=!1),this.keydown=!1}},qN="shift",oce=["shift","ctrl","alt","control"],sce={getDefaultCfg:function(){return{multiple:!0,trigger:qN,selectedState:"selected"}},getEvents:function(){var e=this;return oce.indexOf(e.trigger.toLowerCase())>-1||(e.trigger=qN,console.warn("Behavior brush-select \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'drag'\u3001'shift'\u3001'ctrl' \u6216 'alt'")),e.multiple?{"node:click":"onClick","combo:click":"onClick","canvas:click":"onCanvasClick",keyup:"onKeyUp",keydown:"onKeyDown"}:{"node:click":"onClick","combo:click":"onClick","canvas:click":"onCanvasClick"}},onClick:function(e){var t=this,n=e.item;if(!(!n||n.destroyed)){n.getType();var i=t.graph,a=t.keydown,o=t.multiple,s=t.shouldUpdate,u=t.shouldBegin;if(!!u.call(t,e)){if(!a||!o){var l=i.findAllByState("node",t.selectedState).concat(i.findAllByState("combo",t.selectedState));xe(l,function(h){h!==n&&i.setItemState(h,t.selectedState,!1)})}if(n.hasState(t.selectedState)){s.call(t,e)&&i.setItemState(n,t.selectedState,!1);var f=i.findAllByState("node",t.selectedState),c=i.findAllByState("combo",t.selectedState);i.emit("nodeselectchange",{target:n,selectedItems:{nodes:f,combos:c},select:!1})}else{s.call(t,e)&&i.setItemState(n,t.selectedState,!0);var f=i.findAllByState("node",t.selectedState),c=i.findAllByState("combo",t.selectedState);i.emit("nodeselectchange",{target:n,selectedItems:{nodes:f,combos:c},select:!0})}}}},onCanvasClick:function(){var e=this,t=this.graph,n=t.findAllByState("node",this.selectedState);xe(n,function(a){t.setItemState(a,e.selectedState,!1)});var i=t.findAllByState("combo",this.selectedState);xe(i,function(a){t.setItemState(a,e.selectedState,!1)}),t.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[],combos:[]},select:!1})},onKeyDown:function(e){var t=this,n=e.key;!n||(n.toLowerCase()===this.trigger.toLowerCase()||n.toLowerCase()==="control"?t.keydown=!0:t.keydown=!1)},onKeyUp:function(){var e=this;e.keydown=!1}},uce=Yh,KN=.05,lce={getDefaultCfg:function(){return{sensitivity:2,minZoom:void 0,maxZoom:void 0,enableOptimize:!1,optimizeZoom:.1,fixSelectedItems:{fixAll:!1,fixLineWidth:!1,fixLabel:!1,fixState:"selected"}}},getEvents:function(){var e=this.fixSelectedItems;return e.fixState||(e.fixState="selected"),e.fixAll&&(e.fixLineWidth=!0,e.fixLabel=!0),{wheel:"onWheel",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd"}},onTouchStart:function(e){var t=e.originalEvent.touches,n=t[0],i=t[1];e.preventDefault(),!!i&&(this.shouldBegin&&!this.shouldBegin.call(this,e)||(this.startPoint={pageX:n.pageX,pageY:n.pageY},this.moveable=!0,i&&(this.endPoint={pageX:i.pageX,pageY:i.pageY}),this.originScale=this.graph.getZoom()||this.currentScale||1))},onTouchMove:function(e){if(!!this.moveable){e.preventDefault();var t=e.originalEvent.touches,n=t[0],i=t[1];if(!!i){this.endPoint||(this.endPoint={pageX:i.pageX,pageY:i.pageY});var a=function(d,v){return Math.hypot(v.x-d.x,v.y-d.y)},o=a({x:n.pageX,y:n.pageY},{x:i.pageX,y:i.pageY})/a({x:this.startPoint.pageX,y:this.startPoint.pageY},{x:this.endPoint.pageX,y:this.endPoint.pageY}),s=this.originScale*o;this.currentScale=s;var u=this.get("minZoom")||this.graph.get("minZoom"),l=this.get("maxZoom")||this.graph.get("maxZoom");if(!(s>l||s<u)){var f=this.graph.get("canvas"),c=f.getPointByClient(e.clientX,e.clientY);this.graph.zoomTo(s,{x:c.x,y:c.y}),this.graph.emit("wheelzoom",e)}}}},onTouchEnd:function(){this.moveable=!1,this.endPoint=null},onWheel:function(e){var t=this,n=this,i=n.graph,a=n.fixSelectedItems;if(!(this.shouldBegin&&!this.shouldBegin.call(this,e))&&!!this.shouldUpdate.call(this,e)){e.preventDefault();var o=i.get("canvas"),s=o.getPointByClient(e.clientX,e.clientY),u=this.get("sensitivity"),l=i.getZoom(),f=l,c=l;e.wheelDelta<0?f=1-KN*u:f=1/(1-KN*u),c=l*f;var h=this.get("minZoom")||i.get("minZoom"),d=this.get("maxZoom")||i.get("maxZoom");if(!(c>d||c<h)){var v=this.get("enableOptimize");if(v){var p=this.get("optimizeZoom"),g=this.get("optimized"),y=i.getNodes(),m=i.getEdges(),b=y.length,x=m.length;if(!g){for(var _=0;_<b;_++){var S=y[_];if(!S.destroyed)for(var E=S.get("group").get("children"),C=E.length,M=0;M<C;M++){var w=E[M];!w.destoryed&&!w.get("isKeyShape")&&(w.set("ori-visibility",w.get("ori-visibility")||w.get("visible")),w.hide())}}for(var T=0;T<x;T++)for(var I=m[T],E=I.get("group").get("children"),C=E.length,M=0;M<C;M++){var w=E[M];w.set("ori-visibility",w.get("ori-visibility")||w.get("visible")),w.hide()}this.set("optimized",!0)}clearTimeout(this.get("timeout"));var k=setTimeout(function(){var ct=i.getZoom(),Ye=t.get("optimized");if(Ye){t.set("optimized",!1);for(var nt=0;nt<b;nt++){var Et=y[nt],D=Et.get("group").get("children"),ee=D.length;if(ct<p){var be=Et.getKeyShape(),we=be.get("ori-visibility");we&&be.show()}else for(var Oe=0;Oe<ee;Oe++){var qe=D[Oe],we=qe.get("ori-visibility");!qe.get("visible")&&we&&we&&qe.show()}}for(var Jt=0;Jt<x;Jt++){var gt=m[Jt],D=gt.get("group").get("children"),ee=D.length;if(ct<p){var be=gt.getKeyShape(),we=be.get("ori-visibility");we&&be.show()}else for(var Oe=0;Oe<ee;Oe++){var qe=D[Oe];if(!qe.get("visible")){var we=qe.get("ori-visibility");we&&qe.show()}}}}},100);this.set("timeout",k)}if(l<=1){var O=void 0,U=void 0;if(a.fixAll||a.fixLineWidth||a.fixLabel){O=i.findAllByState("node",a.fixState),U=i.findAllByState("edge",a.fixState);for(var q=l/c,K=O.length,le=0;le<K;le++){var S=O[le],he=S.getContainer(),te=S.getModel(),se=S.getOriginStyle(),ge=S.getStateStyle(a.fixState),Se=S.get("shapeFactory").getShape(te.type).getStateStyle(a.fixState,S)[a.fixState];if(a.fixAll){if(c<=1){var ne=Cr(he.getMatrix());ne||(ne=[1,0,0,0,1,0,0,0,1]);var pe=S.getModel(),Ge=pe.x,ke=pe.y;ne=uce(ne,[["t",-Ge,-ke],["s",q,q],["t",Ge,ke]]),he.setMatrix(ne)}}else for(var E=he.get("children"),C=E.length,M=0;M<C;M++){var w=E[M],rt=void 0,$e=void 0;if(a.fixLabel){var ut=w.get("type");if(ut==="text"){rt=w.attr("fontSize")||12;var pt=ge[w.get("name")],qt=Se[w.get("name")],F=pt?pt.fontSize:12,Z=qt?qt.fontSize:12,V=F||Z||12;if(c<=1&&w.attr("fontSize",V/c),$e)break}}if(a.fixLineWidth&&w.get("isKeyShape")){$e=w.attr("lineWidth")||0;var Fe=ge.lineWidth||Se.lineWidth||se.lineWidth||0;if(c<=1&&w.attr("lineWidth",Fe/c),rt)break}}}for(var at=U.length,Me=0;Me<at;Me++)for(var I=U[Me],he=I.getContainer(),E=he.get("children"),te=I.getModel(),ge=I.getStateStyle(a.fixState),Se=I.get("shapeFactory").getShape(te.type).getStateStyle(a.fixState,I)[a.fixState],C=E.length,M=0;M<C;M++){var w=E[M],rt=void 0,$e=void 0;if(a.fixLabel||a.fixAll){var ut=w.get("type");if(ut==="text"){rt=w.attr("fontSize")||12;var pt=ge[w.get("name")],qt=Se[w.get("name")],F=pt?pt.fontSize:12,Z=qt?qt.fontSize:12,V=F||Z||12;if(c<=1&&w.attr("fontSize",V/c),$e)break}}if((a.fixLineWidth||a.fixAll)&&w.get("isKeyShape")){$e=w.attr("lineWidth")||0;var Fe=ge.lineWidth||Se.lineWidth||1;if(c<=1&&w.attr("lineWidth",Fe/c),rt)break}}}}i.zoomTo(c,{x:s.x,y:s.y}),i.emit("wheelzoom",e)}}}},ZN={onMouseEnter:function(e){var t=e.item;this.currentTarget=t,this.showTooltip(e),this.graph.emit("tooltipchange",{item:e.item,action:"show"})},onMouseMove:function(e){if(!this.shouldUpdate(e)){this.hideTooltip();return}!this.currentTarget||e.item!==this.currentTarget||this.updatePosition(e)},onMouseLeave:function(e){!this.shouldEnd(e)||(this.hideTooltip(),this.graph.emit("tooltipchange",{item:this.currentTarget,action:"hide"}),this.currentTarget=null)},showTooltip:function(e){var t=this.container;if(!(!e.item||e.item.destroyed)){t||(t=this.createTooltip(this.graph.get("canvas")),this.container=t);var n=this.formatText(e.item.get("model"),e);t.innerHTML=n,Lr(this.container,{visibility:"visible"}),this.updatePosition(e)}},hideTooltip:function(){Lr(this.container,{visibility:"hidden"})},updatePosition:function(e){var t=this.get("shouldBegin"),n=this,i=n.width,a=n.height,o=n.container,s=n.graph;if(!t(e)){Lr(o,{visibility:"hidden"});return}var u=s.getPointByClient(e.clientX,e.clientY),l=s.getCanvasByPoint(u.x,u.y),f=l.x,c=l.y,h=o.getBoundingClientRect();f>i/2?f-=h.width:f+=this.offset,c>a/2?c-=h.height:c+=this.offset;var d=f+"px",v=c+"px";Lr(this.container,{left:d,top:v,visibility:"visible"})},createTooltip:function(e){var t=e.get("el");t.style.position="relative";var n=yn('<div class="g6-tooltip g6-'+this.item+'-tooltip"></div>');return t.parentNode.appendChild(n),Lr(n,{position:"absolute",visibility:"visible"}),this.width=e.get("width"),this.height=e.get("height"),this.container=n,this.graph.get("tooltips").push(n),n}},fce=L({getDefaultCfg:function(){return{item:"node",offset:12,formatText:function(t){return t.label}}},getEvents:function(){return{"node:mouseenter":"onMouseEnter","node:mouseleave":"onMouseLeave","node:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave"}}},ZN),cce=L({getDefaultCfg:function(){return{item:"edge",offset:12,formatText:function(t){return"source: "+t.source+" target: "+t.target}}},getEvents:function(){return{"edge:mouseenter":"onMouseEnter","edge:mouseleave":"onMouseLeave","edge:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave"}}},ZN),QN="click",hce=["click","dblclick"],dce={getDefaultCfg:function(){return{trigger:QN,onChange:function(){}}},getEvents:function(){var e,t;return hce.includes(this.trigger)?t=this.trigger:(t=QN,console.warn("Behavior collapse-expand \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'click' \u6216 'dblclick'")),e={},e["node:"+t]="onNodeClick",e.touchstart="onNodeClick",e},onNodeClick:function(e){var t=e.item;if(!!t){var n=this.graph.findDataById(t.get("id"));if(!!n){var i=n.children;if(!(!i||i.length===0)){var a=!n.collapsed;!this.shouldBegin(e,a)||(n.collapsed=a,t.getModel().collapsed=a,this.graph.emit("itemcollapsed",{item:e.item,collapsed:a}),!!this.shouldUpdate(e,a)&&(this.onChange(t,a),this.graph.layout()))}}}}},vce=oo.calculationItemsBBox,pce=function r(e,t){if(t(e)!==!1&&e){var n=e.get("combos");if(n.length===0)return!1;xe(n,function(i){r(i,t)})}},gce={getDefaultCfg:function(){return{enableDelegate:!1,delegateStyle:{},onlyChangeComboSize:!1,activeState:"",selectedState:"selected"}},getEvents:function(){return{"combo:dragstart":"onDragStart","combo:drag":"onDrag","combo:dragend":"onDragEnd","combo:drop":"onDrop","node:drop":"onNodeDrop","combo:dragenter":"onDragEnter","combo:dragleave":"onDragLeave"}},validationCombo:function(e){var t=e.item;if(!t||t.destroyed||!this.shouldUpdate(this,e))return!1;var n=t.getType();return n==="combo"},onDragStart:function(e){var t=this,n=this.graph,i=e.item;if(this.currentShouldEnd=!0,!!this.validationCombo(e)){this.targets=[];var a=n.findAllByState("combo",this.selectedState),o=i.get("id"),s=a.filter(function(u){var l=u.get("id");return o===l});s.length===0?this.targets.push(i):this.targets=a,this.activeState&&this.targets.map(function(u){var l=u.getModel();if(l.parentId){var f=n.findById(l.parentId);f&&n.setItemState(f,t.activeState,!0)}}),this.point={},this.originPoint={},this.origin={x:e.x,y:e.y},this.currentItemChildCombos=[],pce(i,function(u){if(u.destroyed)return!1;var l=u.getModel();return t.currentItemChildCombos.push(l.id),!0})}},onDrag:function(e){var t=this;if(!!this.origin&&!!this.validationCombo(e))if(this.enableDelegate)this.updateDelegate(e);else{if(this.activeState){var n=this.graph,i=e.item,a=i.getModel(),o=n.getCombos(),s=i.getBBox(),u=s.centerX,l=s.centerY,f=s.width,c=o.filter(function(h){var d=h.getModel();return a.parentId,d.id!==a.id&&!t.currentItemChildCombos.includes(d.id)});c.map(function(h){var d=h.getBBox(),v=d.centerX,p=d.centerY,g=d.width,y=u-v,m=l-p,b=2*Math.sqrt(y*y+m*m);f+g-b>.8*f?n.setItemState(h,t.activeState,!0):n.setItemState(h,t.activeState,!1)})}xe(this.targets,function(h){t.updateCombo(h,e)})}},updatePositions:function(e,t){var n=this;(this.enableDelegate||t)&&xe(this.targets,function(i){n.updateCombo(i,e,t)})},onDrop:function(e){var t=this,n=e.item;if(this.currentShouldEnd=this.shouldEnd.call(this,e,n),this.updatePositions(e,!this.currentShouldEnd),!(!this.currentShouldEnd||!n||!this.targets||n.destroyed)){var i=this.graph,a=n.getModel();this.targets.map(function(o){var s=o.getModel();s.parentId!==a.id?(t.activeState&&i.setItemState(n,t.activeState,!1),t.onlyChangeComboSize?i.updateCombo(o):i.updateComboTree(o,a.id)):i.updateCombo(n)}),this.end(n,e),this.endComparison=!0}},onNodeDrop:function(e){var t=this;if(!(!this.targets||this.targets.length===0)){var n=this.graph,i=e.item,a=i.getModel().comboId,o=a?n.findById(a):void 0;if(this.currentShouldEnd=this.shouldEnd.call(this,e,o),this.updatePositions(e,!this.currentShouldEnd),!!this.currentShouldEnd){var s;if(a){if(this.activeState){var u=n.findById(a);n.setItemState(u,this.activeState,!1)}this.targets.map(function(l){t.onlyChangeComboSize?n.updateCombo(l):a!==l.getID()&&(s=n.findById(a),a!==l.getModel().parentId&&n.updateComboTree(l,a))})}else this.targets.map(function(l){if(t.onlyChangeComboSize)n.updateCombo(l);else{var f=l.getModel();f.comboId&&n.updateComboTree(l)}});this.endComparison=!0,this.end(s,e)}}},onDragEnter:function(e){if(!!this.origin&&!!this.validationCombo(e)){var t=e.item,n=this.graph;this.activeState&&n.setItemState(t,this.activeState,!0)}},onDragLeave:function(e){if(!!this.origin&&!!this.validationCombo(e)){var t=e.item,n=this.graph;this.activeState&&n.setItemState(t,this.activeState,!1)}},onDragEnd:function(e){if(!(!this.targets||this.targets.length===0)){var t=e.item;this.currentShouldEnd&&this.updatePositions(e);var n=this.getParentCombo(t.getModel().parentId),i=this.graph;n&&this.activeState&&i.setItemState(n,this.activeState,!1),this.end(void 0,e)}},end:function(e,t){var n=this;if(!!this.origin){var i=this.graph;if(this.delegateShape){var a=i.get("delegateGroup");a.clear(),this.delegateShape=null}e&&this.activeState&&i.setItemState(e,this.activeState,!1),e||this.targets.map(function(o){n.onlyChangeComboSize?i.updateCombo(o):i.updateComboTree(o)}),this.point=[],this.origin=null,this.originPoint=null,this.targets.length=0}},traverse:function(e,t){var n=this;if(t(e)!==!1&&e){var i=e.get("combos");xe(i,function(o){n.traverse(o,t)});var a=e.get("nodes");xe(a,function(o){n.traverse(o,t)})}},updateCombo:function(e,t,n){var i=this;this.traverse(e,function(a){return a.destroyed?!1:(i.updateSignleItem(a,t,n),!0)})},updateSignleItem:function(e,t,n){var i=this.origin,a=this.graph,o=e.getModel(),s=e.get("id");this.point[s]||(this.point[s]={x:o.x,y:o.y});var u=t.x-i.x+this.point[s].x,l=t.y-i.y+this.point[s].y;n&&(u+=i.x-t.x,l+=i.y-t.y),a.updateItem(e,{x:u,y:l})},getParentCombo:function(e){var t=this.graph;if(!!e){var n=t.findById(e);if(!!n)return n}},updateDelegate:function(e){var t=this.graph;if(this.delegateShape){var h=e.x-this.origin.x+this.originPoint.minX,d=e.y-this.origin.y+this.originPoint.minY;this.delegateShape.attr({x:h,y:d})}else{var n=t.get("delegateGroup"),i=null;this.targets.length>1?i=vce(this.targets):i=this.targets[0].getBBox();var a=i.x,o=i.y,s=i.width,u=i.height,l=i.minX,f=i.minY;this.originPoint={x:a,y:o,width:s,height:u,minX:l,minY:f};var c=L(L({},Ts.delegateStyle),this.delegateStyle);this.delegateShape=n.addShape("rect",{attrs:L({width:i.width,height:i.height,x:i.x,y:i.y},c),name:"combo-delegate-shape"}),this.delegateShape.set("capture",!1),this.delegate=this.delegateShape}}},JN="dblclick",yce=["click","dblclick"],mce={getDefaultCfg:function(){return{trigger:JN,relayout:!0}},getEvents:function(){var e,t;return yce.includes(this.trigger)?t=this.trigger:(t=JN,console.warn("Behavior collapse-expand-group \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'click' \u6216 'dblclick'")),e={},e["combo:"+t]="onComboClick",e},onComboClick:function(e){var t=e.item,n=this,i=n.graph,a=n.relayout;if(!(!t||t.destroyed||t.getType()!=="combo")){var o=t.getModel(),s=o.id;!s||(i.collapseExpandCombo(s),a&&i.get("layout")?i.layout():i.refreshPositions())}}},bce=oo.isPolygonsIntersect,xce=oo.pathToPoints,eL="shift",_ce=["drag","shift","ctrl","alt","control"],wce=function(e,t){var n,i=e.getKeyShape();if(e.get("type")==="path")n=xce(i.attr("path"));else{var a=i.getCanvasBBox();n=[[a.minX,a.minY],[a.maxX,a.minY],[a.maxX,a.maxY],[a.minX,a.maxY]]}return bce(t,n)},Sce={getDefaultCfg:function(){return{delegateStyle:{fill:"#EEF6FF",fillOpacity:.4,stroke:"#DDEEFE",lineWidth:1},onSelect:function(){},onDeselect:function(){},selectedState:"selected",trigger:eL,includeEdges:!0,selectedEdges:[],selectedNodes:[]}},getEvents:function(){return _ce.indexOf(this.trigger.toLowerCase())>-1||(this.trigger=eL,console.warn("Behavior lasso-select \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'drag'\u3001'shift'\u3001'ctrl' \u6216 'alt'")),this.trigger==="drag"?{dragstart:"onDragStart",drag:"onDragMove",dragend:"onDragEnd","canvas:click":"clearStates"}:{dragstart:"onDragStart",drag:"onDragMove",dragend:"onDragEnd",keyup:"onKeyUp",keydown:"onKeyDown","canvas:click":"clearStates"}},onDragStart:function(e){var t=this.lasso,n=e.item;n||this.trigger!=="drag"&&!this.keydown||(this.selectedNodes&&this.selectedNodes.length!==0&&this.clearStates(),t||(t=this.createLasso()),this.dragging=!0,this.originPoint={x:e.x,y:e.y},this.points.push(this.originPoint),t.show())},onDragMove:function(e){!this.dragging||this.trigger!=="drag"&&!this.keydown||(this.points.push({x:e.x,y:e.y}),this.updateLasso(e))},onDragEnd:function(e){!this.lasso&&!this.dragging||this.trigger!=="drag"&&!this.keydown||(this.points.push(this.originPoint),this.getSelectedItems(),this.lasso.remove(!0),this.lasso=null,this.points=[],this.dragging=!1)},getLassoPath:function(){var e=this.points,t=[];return e.length&&(e.forEach(function(n,i){i===0?t.push(["M",n.x,n.y]):t.push(["L",n.x,n.y])}),t.push(["L",e[0].x,e[0].y])),t},clearStates:function(){var e=this,t=e.graph,n=e.selectedState,i=t.findAllByState("node",n),a=t.findAllByState("edge",n);i.forEach(function(o){return t.setItemState(o,n,!1)}),a.forEach(function(o){return t.setItemState(o,n,!1)}),this.onDeselect&&this.onDeselect(this.selectedNodes,this.selectedEdges),this.selectedNodes=[],this.selectedEdges=[],t.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[]},select:!1})},getSelectedItems:function(){var e=this,t=this,n=t.graph,i=t.shouldUpdate,a=this.points.map(function(f){return[n.getCanvasByPoint(f.x,f.y).x,n.getCanvasByPoint(f.x,f.y).y]}),o=this.selectedState,s=[],u=[];n.getNodes().forEach(function(f){if(!!f.isVisible()&&wce(f,a)&&i(f,"select")){s.push(f);var c=f.getModel();u.push(c.id),n.setItemState(f,o,!0)}});var l=[];this.includeEdges&&s.forEach(function(f){var c=f.getOutEdges();c.forEach(function(h){if(!!h.isVisible()){var d=h.getModel(),v=d.source,p=d.target;u.includes(v)&&u.includes(p)&&i(h,"select")&&(l.push(h),n.setItemState(h,e.selectedState,!0))}})}),this.selectedEdges=l,this.selectedNodes=s,this.onSelect&&this.onSelect(s,l),n.emit("nodeselectchange",{selectedItems:{nodes:s,edges:l},select:!0})},createLasso:function(){var e=this,t=e.graph.get("delegateGroup").addShape("path",{attrs:L({path:[]},e.delegateStyle),capture:!1,name:"lasso-shape"});return this.lasso=t,this.delegate=t,this.points=[],t},updateLasso:function(e){var t=this;this.lasso.attr({path:t.getLassoPath()})},onKeyDown:function(e){var t=e.key;!t||(t.toLowerCase()===this.trigger.toLowerCase()?this.keydown=!0:this.keydown=!1)},onKeyUp:function(){this.lasso&&(this.lasso.remove(!0),this.lasso=null,this.points=[],this.dragging=!1),this.keydown=!1}},tL="click",Ece=["click","drag"],rL=void 0,Cce=["shift","ctrl","control","alt","meta",void 0],Ace={getDefaultCfg:function(){return{trigger:tL,key:rL,edgeConfig:{},getEdgeConfig:void 0}},getEvents:function(){var e=this;Ece.indexOf(e.trigger.toLowerCase())>-1||(e.trigger=tL,console.warn("Behavior create-edge \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'click'\uFF0C'drag'")),e.key&&Cce.indexOf(e.key.toLowerCase())===-1&&(e.trigger=rL,console.warn("Behavior create-edge \u7684 key \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'shift'\uFF0C'ctrl'\uFF0C'alt'\uFF0C'control'\uFF0C\u6216 undefined"));var t;return e.trigger==="drag"?t={"node:dragstart":"onClick","combo:dragstart":"onClick",drag:"updateEndPoint","node:drop":"onClick","combo:drop":"onClick",dragend:"onDragEnd"}:e.trigger==="click"&&(t={"node:click":"onClick",mousemove:"updateEndPoint","edge:click":"cancelCreating","canvas:click":"cancelCreating","combo:click":"onClick"}),e.key&&(t.keydown="onKeyDown",t.keyup="onKeyUp"),t},onDragEnd:function(e){var t=this;if(!(t.key&&!t.keydown)){var n=e.item;(!n||n.getID()===t.source||n.getType()!=="node")&&t.cancelCreating({item:t.edge,x:e.x,y:e.y})}},onClick:function(e){var t=this;if(!(t.key&&!t.keydown)){var n=e.item,i=t.graph,a=n.getModel(),o=t.getEdgeConfig;if(t.addingEdge&&t.edge){if(!t.shouldEnd.call(t,e))return;var s=void 0;o&&Kr(o)?s=o({source:t.source,target:a.id}):s=t.edgeConfig;var u=L({target:a.id},s);if(t.source===a.id&&(u.type="loop"),i.emit("beforecreateedge",{}),i.updateItem(t.edge,u,!1),i.get("enabledStack")){var l=L(L({},t.edge.getModel()),{itemType:"edge"}),f={};f.edges=[l],i.pushStack("add",{before:{},after:f})}i.emit("aftercreateedge",{edge:t.edge}),t.edge.getKeyShape().set("capture",!0),t.edge=null,t.addingEdge=!1}else{if(!t.shouldBegin.call(t,e))return;var s=void 0;o&&Kr(o)?s=o({source:a.id,target:a.id}):s=t.edgeConfig,t.edge=i.addItem("edge",L({source:a.id,target:a.id},s),!1),t.source=a.id,t.addingEdge=!0,t.edge.getKeyShape().set("capture",!1)}}},updateEndPoint:function(e){var t=this;if(!(t.key&&!t.keydown)){var n={x:e.x,y:e.y};if(!t.graph.findById(t.source)){t.addingEdge=!1;return}t.addingEdge&&t.edge&&t.graph.updateItem(t.edge,{target:n},!1)}},cancelCreating:function(e){var t=this;if(!(t.key&&!t.keydown)){var n=t.graph,i=e.item;if(t.addingEdge&&e.target&&e.target.isCanvas&&e.target.isCanvas()){n.removeItem(t.edge,!1),t.edge=null,t.addingEdge=!1;return}t.addingEdge&&t.edge===i&&(n.removeItem(t.edge,!1),t.edge=null,t.addingEdge=!1)}},onKeyDown:function(e){var t=this,n=e.key;!n||(n.toLowerCase()===t.key.toLowerCase()?t.keydown=!0:t.keydown=!1)},onKeyUp:function(){var e=this;e.addingEdge&&e.edge&&(e.graph.removeItem(e.edge,!1),e.addingEdge=!1,e.edge=null),this.keydown=!1}},nL="ctrl",Tce=["shift","ctrl","alt","control"],Mce="1",Ice={getDefaultCfg:function(){return{trigger:nL,combinedKey:Mce,functionName:"fitView",functionParams:[]}},getEvents:function(){return Tce.indexOf(this.trigger.toLowerCase())>-1||(this.trigger=nL,console.warn("Behavior shortcuts-fit-view \u7684 trigger \u53C2\u6570 '"+this.trigger+"' \u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'drag'\u3001'shift'\u3001'ctrl' \u6216 'alt'")),this.combinedKey===this.trigger&&(this.combinedKey=void 0),{keyup:"onKeyUp",keydown:"onKeyDown"}},onKeyDown:function(e){var t=e.key;if(!!t){var n=this.trigger.toLowerCase(),i=t.toLowerCase();this.triggerKeydown||(i===n||i==="control"&&n==="ctrl"||i==="ctrl"&&n==="control"?this.triggerKeydown=!0:this.triggerKeydown=!1);var a=this.graph;if(!a[this.functionName])return console.warn("Behavior shortcuts-fit-view \u7684 functionName \u53C2\u6570 '"+this.functionName+"' \u4E0D\u5408\u6CD5\uFF0C\u5B83\u4E0D\u662F Graph \u7684\u4E00\u4E2A\u51FD\u6570\u540D"),{};if(this.triggerKeydown&&!this.combinedKey){this.functionParams&&this.functionParams.length?a[this.functionName].apply(a,this.functionParams):a[this.functionName]();return}var o=this.combinedKey.toLowerCase();this.triggerKeydown&&(i===o||i==="control"&&o==="ctrl"||i==="ctrl"&&o==="control")&&(this.functionParams&&this.functionParams.length?a[this.functionName].apply(a,this.functionParams):a[this.functionName]())}},onKeyUp:function(){this.brush&&(this.brush.remove(!0),this.brush=null,this.dragging=!1),this.triggerKeydown=!1}},kce=["shift","ctrl","alt","control"],Dce={getDefaultCfg:function(){return{direction:"both",enableOptimize:!1,zoomKey:"ctrl",scalableRange:0}},getEvents:function(){return(!this.zoomKey||kce.indexOf(this.zoomKey)===-1)&&(this.zoomKey="ctrl"),{wheel:"onWheel"}},onWheel:function(e){var t=this,n=this.graph,i=e[this.zoomKey+"Key"];if(this.zoomKey==="control"&&(i=e.ctrlKey),i){var a=n.get("canvas"),o=a.getPointByClient(e.clientX,e.clientY),s=n.getZoom();e.wheelDelta>0?s=s+s*.05:s=s-s*.05,n.zoomTo(s,{x:o.x,y:o.y})}else{var u=e.deltaX||e.movementX,l=e.deltaY||e.movementY;!l&&navigator.userAgent.indexOf("Firefox")>-1&&(l=-e.wheelDelta*125/3);var f=this.graph.get("width"),c=this.graph.get("height"),h=this.graph.get("canvas").getCanvasBBox(),d=this.scalableRange,v=this.scalableRange;d<1&&d>-1&&(d=f*d,v=c*v);var p=h.minX,g=h.maxX,y=h.minY,m=h.maxY;u>0?g<-d?u=0:g-u<-d&&(u=g+d):u<0&&(p>f+d?u=0:p-u>f+d&&(u=p-(f+d))),l>0?m<-v?l=0:m-l<-v&&(l=m+v):l<0&&(y>c+v?l=0:y-l>c+v&&(l=y-(c+v))),this.get("direction")==="x"?l=0:this.get("direction")==="y"&&(u=0),n.translate(-u,-l)}e.preventDefault();var b=this.get("enableOptimize");if(b){var x=this.get("optimizeZoom"),_=this.get("optimized"),S=n.getNodes(),E=n.getEdges(),C=S.length,M=E.length;if(!_){for(var w=0;w<C;w++){var T=S[w];if(!T.destroyed)for(var I=T.get("group").get("children"),k=I.length,O=0;O<k;O++){var U=I[O];!U.destoryed&&!U.get("isKeyShape")&&(U.set("ori-visibility",U.get("ori-visibility")||U.get("visible")),U.hide())}}for(var q=0;q<M;q++)for(var K=E[q],I=K.get("group").get("children"),k=I.length,O=0;O<k;O++){var U=I[O];U.set("ori-visibility",U.get("ori-visibility")||U.get("visible")),U.hide()}this.set("optimized",!0)}clearTimeout(this.get("timeout"));var le=setTimeout(function(){var he=n.getZoom(),te=t.get("optimized");if(te){t.set("optimized",!1);for(var se=0;se<C;se++){var ge=S[se],Se=ge.get("group").get("children"),ne=Se.length;if(he<x){var pe=ge.getKeyShape(),Ge=pe.get("ori-visibility");Ge&&pe.show()}else for(var ke=0;ke<ne;ke++){var rt=Se[ke],Ge=rt.get("ori-visibility");!rt.get("visible")&&Ge&&Ge&&rt.show()}}for(var $e=0;$e<M;$e++){var ut=E[$e],Se=ut.get("group").get("children"),ne=Se.length;if(he<x){var pe=ut.getKeyShape(),Ge=pe.get("ori-visibility");Ge&&pe.show()}else for(var ke=0;ke<ne;ke++){var rt=Se[ke];if(!rt.get("visible")){var Ge=rt.get("ori-visibility");Ge&&rt.show()}}}}},100);this.set("timeout",le)}}},Pce={"drag-canvas":tce,"zoom-canvas":lce,"drag-node":rce,"activate-relations":nce,"brush-select":ace,"click-select":sce,"lasso-select":Sce,tooltip:fce,"edge-tooltip":cce,"collapse-expand":dce,"drag-combo":gce,"collapse-expand-combo":mce,"create-edge":Ace,"shortcuts-call":Ice,"scroll-canvas":Dce};xe(Pce,function(r,e){$S(e,r)});var Nce=L(L({},O5),DU);Ln.Grid;Ln.Minimap;Ln.Bundling;Ln.Menu;var Lce=Ln.Fisheye;Ln.ToolBar;Ln.Tooltip;var Oce=Ln.TimeBar,Rce=Ln.ImageMinimap,Bce=Ln.EdgeFilterLens,Gce=Ln.SnapLine;Ln.Legend;var Qs={version:Ts.version,Graph:GP,TreeGraph:eue,Util:oo,Layout:_0,TreeLayout:zse,registerLayout:$se,Global:Ts,registerBehavior:$S,registerCombo:MU,registerEdge:zS,registerNode:Ha,Minimap:Ln.Minimap,Grid:Ln.Grid,Bundling:Ln.Bundling,Menu:Ln.Menu,ToolBar:Ln.ToolBar,Tooltip:Ln.Tooltip,Legend:Ln.Legend,TimeBar:Oce,SnapLine:Gce,Fisheye:Lce,ImageMinimap:Rce,EdgeFilterLens:Bce,Algorithm:Nce,Arrow:_U,Marker:wU,Shape:nn};Qs.version="4.3.11";var j0={id:"r1c1",label:"\u51C0\u8D44\u4EA7\u6536\u76CA\u7387",value:"",children:[{id:"r2c1",label:"\u603B\u8D44\u4EA7\u51C0\u5229\u7387",value:"",rightIconText:"\u2716\uFE0F",children:[{id:"r3c1",label:"\u8425\u4E1A\u51C0\u5229\u6DA6\u7387",value:"",rightIconText:"\u2716\uFE0F",children:[{id:"r4c1",label:"\u51C0\u5229\u6DA6",value:"",rightIconText:"\u2797",children:[{id:"r5c1",label:"\u6536\u5165\u603B\u989D",value:"",rightIconText:"\u2796",children:[{id:"r6-1",label:[[{id:"r6c1",title:"\u8425\u4E1A\u603B\u6536\u5165",value:""},{id:"r7c1",title:"\u516C\u5141\u4EF7\u503C\u53D8\u52A8\u6536\u76CA",value:""},{id:"r8c1",title:"\u8425\u4E1A\u5916\u6536\u5165",value:""},{id:"r9c1",title:"\u6295\u8D44\u6536\u76CA",value:""}]]}]},{id:"r5c2",label:"\u6210\u672C\u603B\u989D",value:"",children:[{id:"r6-2",label:[[{id:"r6c2",title:"\u8425\u4E1A\u6210\u672C",value:""},{id:"r7c2",title:"\u8425\u4E1A\u7A0E\u91D1\u53CA\u9644\u52A0",value:""},{id:"r8c2",title:"\u6240\u5F97\u7A0E\u8D39\u7528",value:""},{id:"r9c2",title:"\u8D44\u4EA7\u51CF\u503C\u635F\u5931",value:""},{id:"r10c2",title:"\u8425\u4E1A\u5916\u652F\u51FA",value:""}],[{id:"r6c3",title:"\u671F\u95F4\u8D39\u7528",value:""},{id:"r7c3",title:"\u8D22\u52A1\u8D39\u7528",value:""},{id:"r8c3",title:"\u9500\u552E\u8D39\u7528",value:""},{id:"r9c3",title:"\u7BA1\u7406\u8D39\u7528",value:""}]]}]}]},{id:"r4c2",label:"\u8425\u4E1A\u603B\u6536\u5165",value:""}]},{id:"r3c2",label:"\u603B\u8D44\u4EA7\u5468\u8F6C\u7387",value:"",children:[{id:"r4c3",label:"\u8425\u4E1A\u603B\u6536\u5165",value:"",rightIconText:"\u2797"},{id:"r4c4",label:"\u8D44\u4EA7\u603B\u989D",value:"",children:[{id:"r5c3",label:"\u6D41\u52A8\u8D44\u4EA7",value:"",rightIconText:"\u2795",children:[{id:"r6-3",label:[[{id:"r6c4",title:"\u8D27\u5E01\u8D44\u91D1",value:""},{id:"r7c4",title:"\u4EA4\u6613\u6027\u91D1\u878D\u8D44\u4EA7",value:""},{id:"r8c4",title:"\u5E94\u6536\u8D26\u6B3E",value:""},{id:"r9c4",title:"\u9884\u4ED8\u8D26\u6B3E",value:""},{id:"r10c4",title:"\u5176\u4ED6\u5E94\u6536\u8D26\u6B3E",value:""},{id:"r11c4",title:"\u5B58\u8D27",value:""}]]}]},{id:"r5c4",label:"\u975E\u6D41\u52A8\u8D44\u4EA7",value:"",children:[{id:"r6-4",label:[[{id:"r6c5",title:"\u53EF\u4F9B\u51FA\u552E\u91D1\u878D\u8D44\u4EA7",value:""},{id:"r7c5",title:"\u6301\u6709\u81F3\u5230\u671F\u6295\u8D44",value:""},{id:"r8c5",title:"\u957F\u671F\u80A1\u6743\u6295\u8D44",value:""},{id:"r9c5",title:"\u6295\u8D44\u6027\u623F\u5730\u4EA7",value:""},{id:"r10c5",title:"\u56FA\u5B9A\u8D44\u4EA7",value:""},{id:"r11c5",title:"\u5728\u5EFA\u5DE5\u7A0B",value:""}],[{id:"r6c6",title:"\u65E0\u5F62\u8D44\u4EA7",value:""},{id:"r7c6",title:"\u5F00\u53D1\u652F\u51FA",value:""},{id:"r8c6",title:"\u5546\u8A89",value:""},{id:"r9c6",title:"\u957F\u671F\u5F85\u644A\u8D39\u7528",value:""},{id:"r10c6",title:"\u9012\u5EF6\u6240\u5F97\u7A0E\u8D44\u4EA7",value:""},{id:"r11c6",title:"\u5176\u4ED6\u975E\u6D41\u52A8\u8D44\u4EA7",value:""}]]}]}]}]}]},{id:"r2c2",label:"\u5F52\u5C5E\u6BCD\u516C\u53F8\u80A1\u4E1C\u7684\u51C0\u5229\u6DA6\u5360\u6BD4",value:"",rightIconText:"\u2716\uFE0F"},{id:"r2c3",label:"\u6743\u76CA\u4E58\u6570",value:"",children:[{id:"r3c3",label:"\u8D44\u4EA7\u8D1F\u503A\u7387",value:"",leftIconText:"1 \u2797 ( 1 \u2796",rightIconText:" )",children:[{id:"r4c5",label:"\u8D1F\u503A\u603B\u989D",value:"",rightIconText:"\u2797"},{id:"r4c6",label:"\u8D44\u4EA7\u603B\u989D",value:""}]}]}]},iL=pa({name:"duPontu",setup(r,{attrs:e,slots:t,emit:n}){const{ctx:i,proxy:a}=is(),o=16,s=Qt(!1);let u={};const l=p=>p.split("").reduce((g,y)=>g+Qs.Util.getLetterWidth(y,o),0),f=p=>-l(p)/2,c=p=>Array.isArray(p)?p.reduce((g,y)=>Math.max(g,y.length),0):1,h=(p,g)=>{const y=p.reduce((b,x)=>{const _=x.reduce((S,E)=>S.length>E.title.length?S:E.title,"");return b.concat(_)},[]);return y.reduce((b,x)=>b+Math.max(l(x),g),0)+20+(y.length-1)*10},d=()=>{a.$faithApi.getCusDupontInfo({}).then(p=>{p.success&&Array.isArray(p.data)&&Object.keys(p.data[0]).length!=0?(u=p.data[0],v()):(s.value=!0,a.$toast.error(p.resultInfo.statusText),u={})}).catch(p=>{console.log(p)})},v=()=>{Qs.Util.traverseTree(j0,C=>{if(typeof C.label=="string"){const M=C.id.replace("r","row").replace("c","Cell");u[M]&&(C.value=u[M])}return Array.isArray(C.label)&&C.label.forEach(M=>{M=M.map(w=>{const T=w.id.replace("r","row").replace("c","Cell");return u[T]&&(w.value=u[T]),w})}),!0}),Qs.registerNode("card-node",{draw(C,M){const w=this.getShapeStyle(C),{labelCfg:T={}}=C,I=Array.isArray(C.label),O=c(C.label)*w.height,U=I?h(C.label,w.width):Math.max(w.width,l(C.label)+30);if(!I){const he=M.addShape("rect",{attrs:Ji(Qi({},w),{fill:"#fff",width:U,height:O,x:-U/2,y:0,radius:0}),name:"main-box"});return M.addShape("rect",{attrs:Ji(Qi({},w),{fill:"#eee",width:U,height:20,x:-U/2,y:0}),name:"title-box"}),typeof C.label=="string"&&(M.addShape("text",{attrs:Ji(Qi({},T.style),{text:C.label,x:f(C.label),y:20})}),M.addShape("text",{attrs:Ji(Qi({},T.style),{text:C.value,x:f(C.value),y:20+20})})),C.leftIconText&&M.addShape("text",{attrs:Ji(Qi({},T.style),{text:C.leftIconText,fontSize:20,fill:"#aaa",x:-U-l(C.leftIconText),y:20+20})}),he}const q=O+30,K=-U/2,le=M.addShape("rect",{attrs:Ji(Qi({},w),{fill:"#fff",stroke:"#c2a50e",width:U,height:q,x:K,y:0,radius:0}),name:"main-box"});return C.label.forEach((he,te)=>{const se=he.reduce((ne,pe)=>ne.length>pe.title.length?ne:pe.title,""),ge=Math.max(w.width,l(se)),Se=K+ge*te+(te+1)*10;M.addShape("rect",{attrs:Ji(Qi({},w),{fill:"#fff",stroke:"#ccc",width:ge,height:O,x:Se,y:15,radius:0}),name:`panel-box-${te}`}),he.forEach((ne,pe)=>{const{title:Ge,value:ke}=ne;M.addShape("rect",{attrs:Ji(Qi({},w),{fill:"#eee",width:ge,height:20,x:Se,y:40*pe+10}),name:`title-box-${pe}`}),M.addShape("text",{attrs:Ji(Qi({},T.style),{text:Ge,x:Se+ge/2-l(Ge)/2,y:40*pe+30})}),M.addShape("text",{attrs:Ji(Qi({},T.style),{text:ke,x:Se+ge/2-l(ke)/2,y:40*pe+50})})})}),le}},"rect"),Qs.registerEdge("flow-line",{draw(C,M){const w=C.startPoint,T=C.endPoint,{style:I}=C;return M.addShape("path",{attrs:{stroke:I.stroke,path:[["M",w.x,w.y],["L",w.x,(w.y+T.y)/2],["L",T.x,(w.y+T.y)/2],["L",T.x,T.y]]}})}});const p={hover:{stroke:"#1890ff",lineWidth:2}},g={fill:"#eee",stroke:"#ccc"},y={stroke:"#ccc",endArrow:{path:"M 0,0 L 12, 6 L 9,0 L 12, -6 Z",fill:"#ccc",d:-20}},m={type:"compactBox",direction:"TB",getId:function(M){return M.id},getHeight:function(){return 32},getWidth:function(){return 16},getVGap:function(){return 40},getHGap:function(){return 120}},b={style:{fill:"black",fontSize:16}},x=document.getElementById("container"),_=1e3,S=x.scrollHeight||800,E=new Qs.TreeGraph({container:"container",width:_,height:S,linkCenter:!0,modes:{default:["drag-canvas","zoom-canvas"]},defaultNode:{type:"card-node",size:[120,40],style:g,labelCfg:b},defaultEdge:{type:"flow-line",style:y},fitCenter:[0,0],fitView:!0,fitViewPadding:10,nodeStateStyles:p,edgeStateStyles:p,layout:m});E.data(j0),E.render(),E.fitView(),setTimeout(()=>{Qs.Util.traverseTree(j0,C=>{if(typeof C.rightIconText=="string"){const M=C.id,w=E.findById(M),T=w.get("model"),I=w.get("group"),O=w.get("parent")._cfg.children,q=O.findIndex(ge=>ge._cfg.id===M)+1,K=O[q],{rightIconText:le}=T,he=w.get("bboxCache").x;let te=-w.get("bboxCache").width;K&&(te=K.get("bboxCache").x);const se=Math.abs(he-te)/2;I.addShape("text",{attrs:{fill:"#aaa",text:le,fontSize:20,x:se-l(le),y:15+20}})}return!0})},600)};return RR(()=>{d()}),{getCusDupontInfo:d,simpleImage:ah.PRESENTED_IMAGE_SIMPLE,dataFlag:s}}});const Fce={key:1},Uce=mt("div",{id:"container"},null,-1);function zce(r,e){const t=Gr("bdo-a-empty");return r.dataFlag?(Dr(),Pr(t,{key:0,image:r.simpleImage},null,8,["image"])):(Dr(),Pr("div",Fce,[Uce]))}iL.render=zce;var X0=pa({components:{},props:["id","data"],data(){return{height:300,width:200}},watch:{data:{handler(r){r&&this.randerChart(r.data,r.footer,null,r.width,r.height,r.title,r.chartDisp)},immediate:!0}},methods:{randerChart(r,e,t,n,i,a,o){this.tooltip=o,this.width=n,this.height=i,this.$nextTick(()=>{Xb(document.getElementById(this.id+"chart")).setOption({title:{text:a,textStyle:{fontSize:14}},tooltip:{trigger:"axis",formatter(u){var l=`${u[0].name} <br/>`;for(let f of u)f.value!=0&&(l+=`<span style="background: ${f.color}; height:10px; width: 10px; border-radius: 50%;display: inline-block;margin-right:10px;"></span> ${a} \uFF1A${f.value}<br/>`);return l}},legend:{data:t,top:20},grid:{left:"5%",right:"10%",bottom:"10%",containLabel:!0},toolbox:{feature:{saveAsImage:{title:"\u4FDD\u5B58"}}},xAxis:{type:"category",data:e,nameTextStyle:{fontSize:14,lineHeight:20,fontWeight:"bold",verticalAlign:"top",width:50,align:"middle"},name:"",nameLocation:"middle",axisLabel:{interVal:0,rotate:-40}},yAxis:{type:"value",axisLabel:{formatter:"{value}"}},series:r})})}},created(){},mounted(){}});const $ce=yo();xu("data-v-2bedbc40");const Vce={class:"broken"},Wce={class:"main1"};_u();const jce=$ce((r,e,t,n,i,a)=>(Dr(),Pr("div",Vce,[mt("div",Wce,[mt("div",null,[mt("div",{id:r.id+"chart",style:{height:r.height+"px",width:r.width+"px"}},null,12,["id"]),mt("p",{class:"tool",innerHTML:r.tooltip},null,8,["innerHTML"])])])])));X0.render=jce;X0.__scopeId="data-v-2bedbc40";var H0=pa({components:{armaLine:X0},mixins:[Wp],setup(r,{attrs:e,slots:t,emit:n}){const{ctx:i,proxy:a}=is(),o=Qt([]),s=Qt([]),u=()=>{a.$faithApi.getAlManInfo({}).then(l=>{let f=[];l.success&&Array.isArray(l.data)?(s.value=l.data[0].chartList[0].chartList,l.data.map(c=>{let h=[],d=[],v=c.chartName,p=c.chartDisp;c.chartList.map((g,y)=>{let m=[],b=g.type;g.chartList.map(x=>{y===0&&d.push(x.label),m.push(x.value)}),h.push({name:b,data:m,type:"line"})}),f.push({data:h,footer:d,title:v,chartDisp:p,width:800,height:300})})):a.$toast.error(l.resultInfo.statusText),o.value=f}).catch(l=>{console.log(l)})};return u(),{data:o,titleList:s,getAlManInfo:u,simpleImage:ah.PRESENTED_IMAGE_SIMPLE}}});const Y0=yo();xu("data-v-3959554b");const Xce={key:1,class:"armanfix"},Hce=mt("table",{width:"100%"},[mt("tr",null,[mt("td",null,"\u5236\u9020\u4E1A"),mt("td",null,"\u5176\u4ED6\u4F01\u4E1A"),mt("td",{style:{"padding-left":"5px"}},"\u89E3\u91CA")]),mt("tr",null,[mt("td",null,"\u5C0F\u4E8E1.81"),mt("td",null,"\u5C0F\u4E8E1.21"),mt("td",{style:{"padding-left":"5px"}},"\u5B58\u5728\u4E25\u91CD\u8D22\u52A1\u5371\u673A\uFF0C\u7834\u4EA7\u51E0\u7387\u9AD8")]),mt("tr",null,[mt("td",{style:{"padding-right":"5px"}},"1.81~2.99"),mt("td",null,"1.21~2.99"),mt("td",{style:{"padding-left":"5px"}},"\u8D22\u52A1\u72B6\u51B5\u4E0D\u7A33\u5B9A\uFF0C\u4ECD\u6709\u53EF\u80FD\u51FA\u73B0\u8D22\u52A1\u56F0\u96BE")]),mt("tr",null,[mt("td",null,"\u5927\u4E8E2.99"),mt("td",null,"\u5927\u4E8E2.99"),mt("td",{style:{"padding-left":"5px"}},"\u8D22\u52A1\u72B6\u51B5\u826F\u597D")])],-1);_u();const Yce=Y0((r,e)=>{const t=Gr("bdo-a-empty"),n=Gr("armaLine"),i=Gr("bdo-icon"),a=Gr("bdo-a-tooltip");return r.data.length==0?(Dr(),Pr(t,{key:0,image:r.simpleImage},null,8,["image"])):(Dr(),Pr("div",Xce,[mt("div",null,[(Dr(!0),Pr(os,null,as(r.data,(o,s)=>(Dr(),Pr(n,{class:"armitem",id:"armaLine"+s,data:o,key:s},null,8,["id","data"]))),128)),(Dr(!0),Pr(os,null,as(r.titleList,(o,s)=>(Dr(),Pr("p",{key:s},[ga(ya(o.label)+"\u7684Z\u503C\u662F"+ya(o.value)+" \xA0 ",1),mt("a",{innerHTML:o.type},null,8,["innerHTML"])]))),128))]),mt(a,{placement:"left",overlayClassName:"bgc_tooltip"},{title:Y0(()=>[Hce]),default:Y0(()=>[BR(mt(i,{src:"QuestionCircleOutlined"},null,512),[[GR,r.titleList.length!=0]])]),_:1})]))});H0.render=Yce;H0.__scopeId="data-v-3959554b";var q0=pa({components:{abnormalList:UR},mixins:[Wp],setup(r,{attrs:e,slots:t,emit:n}){const{ctx:i,proxy:a}=is(),o=Qt([]),s=Qt([]),u=Qt(""),l=Qt(""),f=Qt("");return{data:o,titleList:s,getAnalysisQuotaInfo:(h,d,v,p)=>{u.value=h,l.value=d,f.value=v,a.$faithApi.getAnalysisQuotaInfo({param1:u.value,param2:l.value,param3:f.value.toString(),jsonData:p}).then(g=>{let y=[];g.success&&Array.isArray(g.data)?g.data.map(m=>{let b=[],x=[],_=m.chartName,S=m.chartDisp;m.chartList.map((E,C)=>{let M=[],w=E.chartName;E.chartList.map(T=>{C===0&&x.push(T.label),M.push(T.value)}),b.push({name:w,data:M,type:"line"})}),y.push({data:b,footer:x,title:_,chartDisp:S,width:(window.innerWidth-100)/4,height:300})}):a.$toast.error(g.resultInfo.statusText),o.value=y}).catch(g=>{console.log(g)})},simpleImage:ah.PRESENTED_IMAGE_SIMPLE,typeval:u,select1val:l,search1val:f}}});const qce=yo(),Kce=qce((r,e)=>{const t=Gr("bdo-a-empty"),n=Gr("abnormalList");return r.data.length==0?(Dr(),Pr(t,{key:0,image:r.simpleImage},null,8,["image"])):(Dr(!0),Pr(os,{key:1},as(r.data,(i,a)=>(Dr(),Pr(n,{class:"item",id:"abnormalList"+a,data:i,key:a},null,8,["id","data"]))),128))});q0.render=Kce;q0.__scopeId="data-v-f8444476";var aL=pa({components:{itemTitle:jb,industryChart:q0},setup(r,{attrs:e,slots:t,emit:n}){const{ctx:i,proxy:a}=is();return{init:(s,u,l,f)=>{Hb(()=>{a.$refs.industrys.getAnalysisQuotaInfo(s,u,l,f)})}}}});function Zce(r,e){const t=Gr("industryChart");return Dr(),Pr("div",null,[mt(t,{ref:"industrys"},null,512)])}aL.render=Zce;var K0=pa({setup(r,{attrs:e,slots:t,emit:n}){const{ctx:i,proxy:a}=is(),o=Qt([{title:"\u4E8B\u9879",dataIndex:"columnNameChi",key:"columnNameChi",width:120,slots:{customRender:"columnNameChi"}}]),s=Qt([]),u=Qt([]),l=()=>{a.$faithApi.getAnalysisReport({}).then(c=>{if(c.success){let h=[],d=0;for(let v in c.data[0].title)d++;for(let v=0;v<d;v++)c.data[0].title["columnValue"+v]&&h.push({title:c.data[0].title["columnValue"+v],dataIndex:"columnValue"+v,key:"columnValue"+v,align:"right",slots:{customRender:"columnValue"}}),c.data[0].title["rateValue"+v]&&h.push({title:c.data[0].title["rateValue"+v],dataIndex:"rateValue"+v,key:"rateValue"+v,align:"right",slots:{customRender:"rate"}});h.map(v=>{o.value.push(v)}),h.value=h,s.value=c.data[0].content}else a.$toast.error(c.resultInfo.statusText)}).catch(c=>{console.log(c)})};return l(),{rateClick:(c,h)=>{},data:s,columns:o,getAnalysisReport:l,titleList:u}}});const Z0=yo();xu("data-v-96ac77e2");const Qce={class:"analysisTitle"},Jce={key:2};_u();const ehe=Z0((r,e)=>{const t=Gr("bdo-icon"),n=Gr("bdo-a-table");return Dr(),Pr(n,{columns:r.columns,"data-source":r.data,rowKey:(i,a)=>a},{columnNameChi:Z0(({text:i})=>[mt("span",Qce,ya(i),1)]),rate:Z0(({text:i,record:a})=>[(i||"").replace("%","")*1/100>0?(Dr(),Pr("span",{key:0,onClick:o=>r.rateClick(o,a)},[ga(ya(i)+"%",1),mt(t,{class:"up",src:"ArrowUpOutlined",title:"\u4E0A\u5347"})],8,["onClick"])):(i||"").replace("%","")*1/100<0?(Dr(),Pr("span",{key:1,onClick:o=>r.rateClick(o,a)},[ga(ya(i)+"%",1),mt(t,{class:"down",src:"ArrowDownOutlined",title:"\u4E0B\u964D"})],8,["onClick"])):(Dr(),Pr("span",Jce,"-"))]),_:1},8,["columns","data-source","rowKey"])});K0.render=ehe;K0.__scopeId="data-v-96ac77e2";var Q0=pa({props:{loading:{loadingType:Boolean,default:!1}},setup(){}});const the=yo();xu("data-v-71d7f556");const rhe={key:0,class:"loading__wrapper"};_u();const nhe=the((r,e,t,n,i,a)=>{const o=Gr("bdo-a-spin");return r.loading?(Dr(),Pr("div",rhe,[mt(o,{class:"text--white"})])):Yb("",!0)});Q0.render=nhe;Q0.__scopeId="data-v-71d7f556";const ihe=[{title:"\u8BC1\u5238\u540D\u79F0",dataIndex:"label",key:"label",slots:{customRender:"label"}},{title:"\u677F\u5757",dataIndex:"industryPalte",key:"industryPalte",slots:{customRender:"industryPalte"}},{title:"\u5730\u7406\u5206\u533A",dataIndex:"industryRegion",key:"industryRegion"},{title:"\u4E2D\u56FD\u7701\u5E02",dataIndex:"industryArea",key:"industryArea"},{title:"\u884C\u4E1A\u540D\u79F0",dataIndex:"industryName",key:"industryName"}];var oL=pa({components:{itemTitle:jb,lineChart:qp,duPontu:iL,analysisList:K0,industryLine:aL,armanAnalysis:H0,LoadingPage:Q0},setup(r,{attrs:e,slots:t,emit:n}){const{ctx:i,proxy:a}=is(),o=Qt("0.3"),s=Qt({}),u=Qt(""),l=Qt(""),f=Qt(""),c=Qt(""),h=Qt(!1),d=Qt(!1),v=Qt([]),p=Qt(-1),g=Qt(-2),y=Qt([]),m=Qt([]),b=Qt(""),x=Qt(!1),_=Qt({pageSize:10,defaultCurrent:1,showQuickJumper:!0,hideOnSinglePage:!1,showSizeChanger:!0,pageSizeOptions:["10","50","100"],total:0,showTotal:Ye=>`\u5171 ${Ye} \u6761`}),S=Qt(!1),E=Qt(ihe),C=Qt([]),M=(Ye,nt)=>nt.some(Et=>Et.label.toLowerCase().indexOf(Ye.toLowerCase())>-1);FR(x,()=>{zR.emit("getSidebarNum")});const w=Ye=>{if(Ye.length===0)u.value="",q(),at(Se.value);else{u.value=Ye,q();let nt=v.value.find(Et=>Et.value==Ye);b.value=nt.label}},T=()=>{Se.value=l.value,he.value=!0},I=()=>{S.value=!0},k=()=>{te.value=!1,se.value=!1,ne.value=[],Se.value="",p.value=-1,g.value=-2,y.value=[],m.value=[]},O=Ye=>{g.value=-1,m.value=[],p.value==Ye?p.value=-1:p.value=Ye;let nt=[];nt.push(Ge.value[Ye]),y.value=nt},U=Ye=>{p.value=-1,y.value=[],g.value==Ye?g.value=-1:g.value=Ye;let nt=[];nt.push(ke.value[Ye]),m.value=nt},q=Ye=>{Hb(()=>{const nt={industryPalte:ne.value.toString(),industryCode:Se.value,industryRegion:y.value.toString(),industryArea:m.value.toString()};let Et=JSON.stringify(nt);a.$refs.profitability.getCusQuotaInfo("Q100000",o.value,u.value,Et),a.$refs.profitQuality.getCusQuotaInfo("Q200000",o.value,u.value,Et),a.$refs.solvency.getCusQuotaInfo("Q300000",o.value,u.value,Et),a.$refs.debtservice.getCusQuotaInfo("Q400000",o.value,u.value,Et),a.$refs.operatingCapacity.getCusQuotaInfo("Q500000",o.value,u.value,Et),a.$refs.developmentCapacity.getCusQuotaInfo("Q600000",o.value,u.value,Et),a.$refs.industryCompare.init("Q910000",o.value,u.value,Et)})},K=Ye=>{o.value=Ye,q()},le=(Ye,nt)=>nt.props.value.toLowerCase().indexOf(Ye.toLowerCase())>=0,he=Qt(!1),te=Qt(!1),se=Qt(!1),ge=Qt([]),Se=Qt(""),ne=Qt([]),pe=Qt(""),Ge=Qt([]),ke=Qt([]),rt=Qt(""),$e=Qt(1),ut=Qt(10),pt=()=>{he.value=!0},qt=(Ye,nt)=>{Ye==!0&&nt==1?(ne.value=[],ne.value.push("1"),se.value=!1):Ye==!0&&nt==2&&(ne.value=[],ne.value.push("2"),te.value=!1)},F=()=>{a.$faithApi.getIndustry().then(Ye=>{Ye.success&&Array.isArray(Ye.data)?(Ye.data.map(nt=>{(nt.title=="\u8BC1\u76D1\u4F1A"||nt.title=="\u4E07\u5F97")&&(nt.disabled=!0)}),ge.value=Ye.data):a.$toast.error(Ye.resultInfo.statusText)}).catch(Ye=>{console.log(Ye)})},Z=()=>{a.$faithApi.getLocalData().then(Ye=>{l.value=sessionStorage.getItem("Name"),rt.value=sessionStorage.getItem("Code"),Me(rt.value),Ye?(s.value=Ye.\u6307\u6807\u9608\u503C,Ge.value=Object.keys(Ye.\u5730\u7406\u5206\u533A),ke.value=Object.keys(Ye.\u4E2D\u56FD\u7701\u5E02)):a.$toast.error("\u6570\u636E\u5F02\u5E38")}).catch(Ye=>{console.log(Ye)})},V=(Ye,nt)=>{Se.value=Ye,pe.value=nt[0]},Fe=Ye=>{if(Se.value.trim()=="")return a.$toast.warning("\u60A8\u672A\u9009\u62E9\u884C\u4E1A"),!1;Se.value==l.value?(Se.value=rt.value,l.value=sessionStorage.getItem("Name")):l.value=pe.value,q(),he.value=!1,d.value=!0,h.value=!0,Me(Se.value),at(Se.value)},at=Ye=>{let nt=Ye;a.$faithApi.getCompanyByIndustry({param3:nt}).then(Et=>{Et.success&&Array.isArray(Et.data)?(C.value=Et.data,v.value=Et.data.slice(0,10)):a.$toast.error(Et.resultInfo.statusText)}).catch(Et=>{console.log(Et)})},Me=Ye=>{new RegExp("^C.*$").test(Ye)||new RegExp("^c.*$").test(Ye)?x.value=!0:x.value=!1},ct=()=>{d.value=!1};return q(),F(),Z(),at(sessionStorage.getItem("Code")),{init:q,analysisChange:K,analysisList:s,analysisValue:o,filterOption:le,pagination:_,companysValue:u,value2:f,industryValue:l,companyOptions:v,filter:M,companyChange:w,selectModal:T,indValue:c,alyVisible:he,analyModal:pt,analyOk:Fe,plateChange:qt,checked1:te,checked2:se,isActive:p,isCitys:g,getIndustry:F,tradeValue:Se,treeData:ge,tradeChange:V,saveTrade1:ne,selectClear:k,tradeName:pe,showWait:h,isWait:ct,getLocalData:Z,division:Ge,provinces:ke,geograPhical:O,changeCities:U,regionsList:y,areaList:m,loading:d,corporateTitle:b,tradeFlag:x,tradeJudge:Me,code:rt,Start:$e,Limit:ut,companyVisible:S,selectCompnays:I,companyData:C,companyColumns:E,getCompanyByIndustry:at}}});const yr=yo();xu("data-v-dbbbaff0");const ahe={class:"analysisIndex"},ohe=ga(" \u67E5\u770B\u884C\u4E1A\u516C\u53F8 "),she={key:0},uhe={key:1},lhe={class:"companyKind"},fhe=ga("\u4E0A\u5E02\u516C\u53F8"),che=ga("\u65B0\u4E09\u677F");_u();const hhe=yr((r,e)=>{const t=Gr("bdo-a-tag"),n=Gr("bdo-a-table"),i=Gr("bdo-a-modal"),a=Gr("bdo-a-checkable-tag"),o=Gr("bdo-a-form-item"),s=Gr("bdo-a-tree-select"),u=Gr("bdo-a-form"),l=Gr("bdo-a-select-option"),f=Gr("bdo-a-select"),c=Gr("bdo-a-cascader"),h=Gr("lineChart"),d=Gr("itemTitle"),v=Gr("armanAnalysis"),p=Gr("duPontu"),g=Gr("analysisList"),y=Gr("industryLine"),m=Gr("loading-page");return Dr(),Pr("div",ahe,[mt(t,{onClick:r.selectCompnays,class:"compnysInput"},{default:yr(()=>[ohe]),_:1},8,["onClick"]),mt(t,{onClick:r.selectModal,class:"analyInput",title:r.industryValue},{default:yr(()=>[ga(ya(r.industryValue),1)]),_:1},8,["onClick","title"]),mt("div",null,[mt(i,{visible:r.companyVisible,"onUpdate:visible":e[1]||(e[1]=b=>r.companyVisible=b),title:"\u67E5\u770B\u884C\u4E1A\u516C\u53F8",width:"50%",footer:!1},{default:yr(()=>[mt(n,{pagination:r.pagination,columns:r.companyColumns,"data-source":r.companyData,scroll:{y:"calc(100vh - 286px)"},rowKey:(b,x)=>x},{industryPalte:yr(({record:b})=>[b.industryPalte==1?(Dr(),Pr("span",she,"\u4E0A\u5E02\u516C\u53F8")):(Dr(),Pr("span",uhe,"\u65B0\u4E09\u677F"))]),label:yr(({text:b})=>[mt("span",lhe,ya(b),1)]),_:1},8,["pagination","columns","data-source","scroll","rowKey"])]),_:1},8,["visible"]),mt(i,{visible:r.alyVisible,"onUpdate:visible":e[7]||(e[7]=b=>r.alyVisible=b),title:"\u8BF7\u9009\u62E9\u884C\u4E1A",onOk:r.analyOk},{default:yr(()=>[mt(u,null,{default:yr(()=>[mt(o,{label:"\u677F\u5757"},{default:yr(()=>[mt(a,{class:"plateJob",checked:r.checked1,"onUpdate:checked":e[2]||(e[2]=b=>r.checked1=b),onChange:e[3]||(e[3]=b=>r.plateChange(r.checked1,1))},{default:yr(()=>[fhe]),_:1},8,["checked"]),mt(a,{class:"plateJob",checked:r.checked2,"onUpdate:checked":e[4]||(e[4]=b=>r.checked2=b),onChange:e[5]||(e[5]=b=>r.plateChange(r.checked2,2))},{default:yr(()=>[che]),_:1},8,["checked"])]),_:1}),mt(o,{label:"\u5730\u7406\u5206\u533A"},{default:yr(()=>[(Dr(!0),Pr(os,null,as(r.division,(b,x)=>(Dr(),Pr(a,{class:["plateJob",r.isActive==x?"plateJob1":""],onClick:_=>r.geograPhical(x),key:x},{default:yr(()=>[ga(ya(b),1)]),_:2},1032,["class","onClick"]))),128))]),_:1}),mt(o,{label:"\u4E2D\u56FD\u7701\u5E02"},{default:yr(()=>[(Dr(!0),Pr(os,null,as(r.provinces,(b,x)=>(Dr(),Pr(a,{class:["plateJob",r.isCitys==x?"plateJob1":""],onClick:_=>r.changeCities(x),key:x},{default:yr(()=>[ga(ya(b),1)]),_:2},1032,["class","onClick"]))),128))]),_:1}),mt(o,{label:"\u884C\u4E1A"},{default:yr(()=>[mt(s,{value:r.tradeValue,"onUpdate:value":e[6]||(e[6]=b=>r.tradeValue=b),treeNodeFilterProp:"title",onChange:r.tradeChange,class:"tradeSelect","dropdown-style":{width:"400px",maxHeight:"300px",overflow:"auto"},"tree-data":r.treeData,"tree-default-expand-all":""},null,8,["value","onChange","tree-data"])]),_:1})]),_:1})]),_:1},8,["visible","onOk"])]),mt(f,{class:"selectAnalysis",onChange:e[8]||(e[8]=b=>r.analysisChange(r.analysisValue)),value:r.analysisValue,"onUpdate:value":e[9]||(e[9]=b=>r.analysisValue=b)},{default:yr(()=>[(Dr(!0),Pr(os,null,as(r.analysisList,(b,x,_)=>(Dr(),Pr(l,{value:x,key:_},{default:yr(()=>[ga(ya(b),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),mt(c,{class:"searchCascader",value:r.value2,"onUpdate:value":e[10]||(e[10]=b=>r.value2=b),onChange:e[11]||(e[11]=b=>r.companyChange(r.value2)),options:r.companyOptions,"show-search":{filter:r.filter},title:r.corporateTitle,placeholder:"\u641C\u7D22\u516C\u53F8"},null,8,["value","options","show-search","title"]),mt(d,{title:"\u76C8\u5229\u80FD\u529B",id:"profitability"},{itemTop:yr(()=>[]),content:yr(()=>[mt(h,{ref:"profitability",onHelloEmit:r.isWait,showWait:r.showWait},null,8,["onHelloEmit","showWait"])]),_:1}),mt(d,{title:"\u6536\u76CA\u8D28\u91CF",id:"profitQuality"},{itemTop:yr(()=>[]),content:yr(()=>[mt(h,{ref:"profitQuality"},null,512)]),_:1}),mt(d,{title:"\u77ED\u671F\u507F\u503A",id:"solvency"},{itemTop:yr(()=>[]),content:yr(()=>[mt(h,{ref:"solvency"},null,512)]),_:1}),mt(d,{title:"\u957F\u671F\u507F\u503A",id:"debtservice"},{itemTop:yr(()=>[]),content:yr(()=>[mt(h,{ref:"debtservice"},null,512)]),_:1}),mt(d,{title:"\u8425\u8FD0\u80FD\u529B",id:"operatingCapacity"},{itemTop:yr(()=>[]),content:yr(()=>[mt(h,{ref:"operatingCapacity"},null,512)]),_:1}),mt(d,{title:"\u53D1\u5C55\u80FD\u529B",id:"developmentCapacity"},{itemTop:yr(()=>[]),content:yr(()=>[mt(h,{ref:"developmentCapacity"},null,512)]),_:1}),r.tradeFlag?(Dr(),Pr(d,{key:0,title:"\u963F\u5C14\u66FC\u5206\u6790",id:"Huffman"},{itemTop:yr(()=>[]),content:yr(()=>[mt(v,{ref:"Huffman"},null,512)]),_:1})):Yb("",!0),mt(d,{title:"\u675C\u90A6\u5206\u6790",id:"duPontAnalysis"},{itemTop:yr(()=>[]),content:yr(()=>[mt(p)]),_:1}),mt(d,{title:"\u6307\u6807\u5206\u6790",id:"analysisIndex"},{itemTop:yr(()=>[]),content:yr(()=>[mt(g)]),_:1}),mt(d,{title:"\u884C\u4E1A\u6BD4\u8F83",id:"industryCompare"},{itemTop:yr(()=>[]),content:yr(()=>[mt(y,{ref:"industryCompare"},null,512)]),_:1}),mt(m,{loading:r.loading},null,8,["loading"])])});oL.render=hhe;oL.__scopeId="data-v-dbbbaff0";export{oL as default};
